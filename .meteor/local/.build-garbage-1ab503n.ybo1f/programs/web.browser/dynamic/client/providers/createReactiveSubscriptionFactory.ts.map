{"version":3,"sources":["meteor://ðŸ’»app/client/providers/createReactiveSubscriptionFactory.ts"],"names":[],"mappings":";;;;;;;;AAAA,OAAO,MAAP,CAAS;AAAA,mCAAgC;AAAhC,CAAT;AAAyC;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAOlC,MAAM,iCAAiC,GACzC,uBAAJ,IACA,YAAoC;AAAA,oCAAhC,IAAgC;AAAhC,QAAgC;AAAA;;AACnC,QAAM,mBAAmB,GAAG,MAAS,uBAAuB,CAAC,GAAG,IAAJ,CAA5D;;AAEA,QAAM,SAAS,GAAG,IAAI,GAAJ,EAAlB;AAEA,MAAI,YAAY,GAAG,mBAAmB,EAAtC;AAEA,MAAI,WAAJ;AACA,QAAM,OAAO,GAAG,UAAU,CAAC,MAAK;AAC/B,eAAW,GAAG,OAAO,CAAC,OAAR,CAAgB,MAAK;AAClC,kBAAY,GAAG,mBAAmB,EAAlC;AACA,eAAS,CAAC,OAAV,CAAmB,QAAD,IAAa;AAC9B,gBAAQ;AACR,OAFD;AAGA,KALa,CAAd;AAMA,GAPyB,EAOvB,CAPuB,CAA1B;AASA,SAAO;AACN,mBAAe,EAAE,MAAS,YADpB;AAEN,aAAS,EAAG,QAAD,IAA0B;AACpC,eAAS,CAAC,GAAV,CAAc,QAAd;AAEA,aAAO,MAAW;AACjB,oBAAY,CAAC,OAAD,CAAZ;AAEA,iBAAS,CAAC,MAAV,CAAiB,QAAjB;;AAEA,YAAI,SAAS,CAAC,IAAV,KAAmB,CAAvB,EAA0B;AAAA;;AACzB,qCAAW,UAAX,oDAAa,IAAb;AACA;AACD,OARD;AASA;AAdK,GAAP;AAgBA,CAnCK,C","file":"dynamic/client/providers/createReactiveSubscriptionFactory.ts","sourcesContent":["import { Tracker } from 'meteor/tracker';\nimport { Subscription, Unsubscribe } from 'use-subscription';\n\ninterface ISubscriptionFactory<T> {\n\t(...args: any[]): Subscription<T>;\n}\n\nexport const createReactiveSubscriptionFactory =\n\t<T>(computeCurrentValueWith: (...args: any[]) => T): ISubscriptionFactory<T> =>\n\t(...args: any[]): Subscription<T> => {\n\t\tconst computeCurrentValue = (): T => computeCurrentValueWith(...args);\n\n\t\tconst callbacks = new Set<Unsubscribe>();\n\n\t\tlet currentValue = computeCurrentValue();\n\n\t\tlet computation: Tracker.Computation | undefined;\n\t\tconst timeout = setTimeout(() => {\n\t\t\tcomputation = Tracker.autorun(() => {\n\t\t\t\tcurrentValue = computeCurrentValue();\n\t\t\t\tcallbacks.forEach((callback) => {\n\t\t\t\t\tcallback();\n\t\t\t\t});\n\t\t\t});\n\t\t}, 0);\n\n\t\treturn {\n\t\t\tgetCurrentValue: (): T => currentValue,\n\t\t\tsubscribe: (callback): Unsubscribe => {\n\t\t\t\tcallbacks.add(callback);\n\n\t\t\t\treturn (): void => {\n\t\t\t\t\tclearTimeout(timeout);\n\n\t\t\t\t\tcallbacks.delete(callback);\n\n\t\t\t\t\tif (callbacks.size === 0) {\n\t\t\t\t\t\tcomputation?.stop();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t};\n\t};\n"]}