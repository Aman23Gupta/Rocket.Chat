{"version":3,"sources":["meteor://ðŸ’»app/client/sidebar/RoomList/SideBarItemTemplateWithData.js"],"names":["Badge","Sidebar","module","link","v","React","memo","default","roomTypes","RoomIcon","useLayout","RoomMenu","normalizeSidebarMessage","getMessage","room","lastMessage","t","u","username","uids","length","name","SideBarItemTemplateWithData","id","extended","selected","SideBarItemTemplate","AvatarTemplate","style","isAnonymous","sidebar","href","getRouteLink","title","getRoomName","hideUnreadStatus","unread","alert","userMentions","groupMentions","tunread","tunreadUser","rid","type","cl","highlighted","icon","isQueued","status","threadUnread","message","subtitle","__html","variant","isUnread","badges","flexShrink","toggle","ts","propsAreEqual","prevProps","nextProps","some","key","_id","_updatedAt","toISOString","teamMain","exportDefault"],"mappings":"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","file":"dynamic/client/sidebar/RoomList/SideBarItemTemplateWithData.js","sourcesContent":["import { Badge, Sidebar } from '@rocket.chat/fuselage';\nimport React, { memo } from 'react';\n\nimport { roomTypes } from '../../../app/utils/client';\nimport { RoomIcon } from '../../components/RoomIcon';\nimport { useLayout } from '../../contexts/LayoutContext';\nimport RoomMenu from '../RoomMenu';\nimport { normalizeSidebarMessage } from './normalizeSidebarMessage';\n\nconst getMessage = (room, lastMessage, t) => {\n\tif (!lastMessage) {\n\t\treturn t('No_messages_yet');\n\t}\n\tif (!lastMessage.u) {\n\t\treturn normalizeSidebarMessage(lastMessage, t);\n\t}\n\tif (lastMessage.u?.username === room.u?.username) {\n\t\treturn `${t('You')}: ${normalizeSidebarMessage(lastMessage, t)}`;\n\t}\n\tif (room.t === 'd' && room.uids && room.uids.length <= 2) {\n\t\treturn normalizeSidebarMessage(lastMessage, t);\n\t}\n\treturn `${lastMessage.u.name || lastMessage.u.username}: ${normalizeSidebarMessage(lastMessage, t)}`;\n};\n\nfunction SideBarItemTemplateWithData({\n\troom,\n\tid,\n\textended,\n\tselected,\n\tSideBarItemTemplate,\n\tAvatarTemplate,\n\tt,\n\tstyle,\n\t// sidebarViewMode,\n\tisAnonymous,\n}) {\n\tconst { sidebar } = useLayout();\n\n\tconst href = roomTypes.getRouteLink(room.t, room);\n\tconst title = roomTypes.getRoomName(room.t, room);\n\n\tconst {\n\t\tlastMessage,\n\t\thideUnreadStatus,\n\t\tunread = 0,\n\t\talert,\n\t\tuserMentions,\n\t\tgroupMentions,\n\t\ttunread = [],\n\t\ttunreadUser = [],\n\t\trid,\n\t\tt: type,\n\t\tcl,\n\t} = room;\n\n\tconst highlighted = !hideUnreadStatus && (alert || unread);\n\tconst icon = (\n\t\t<Sidebar.Item.Icon highlighted={highlighted}>\n\t\t\t<RoomIcon highlighted={highlighted} room={room} placement='sidebar' />\n\t\t</Sidebar.Item.Icon>\n\t);\n\n\tconst isQueued = room.status === 'queued';\n\n\tconst threadUnread = tunread.length > 0;\n\tconst message = extended && getMessage(room, lastMessage, t);\n\n\tconst subtitle = message ? <span className='message-body--unstyled' dangerouslySetInnerHTML={{ __html: message }} /> : null;\n\tconst variant =\n\t\t((userMentions || tunreadUser.length) && 'danger') || (threadUnread && 'primary') || (groupMentions && 'warning') || 'ghost';\n\tconst isUnread = unread > 0 || threadUnread;\n\tconst badges =\n\t\t!hideUnreadStatus && isUnread ? (\n\t\t\t<Badge style={{ flexShrink: 0 }} variant={variant}>\n\t\t\t\t{unread + tunread?.length}\n\t\t\t</Badge>\n\t\t) : null;\n\n\treturn (\n\t\t<SideBarItemTemplate\n\t\t\tis='a'\n\t\t\tid={id}\n\t\t\tdata-qa='sidebar-item'\n\t\t\taria-level='2'\n\t\t\tunread={highlighted}\n\t\t\tthreadUnread={threadUnread}\n\t\t\tselected={selected}\n\t\t\thref={href}\n\t\t\tonClick={() => !selected && sidebar.toggle()}\n\t\t\taria-label={title}\n\t\t\ttitle={title}\n\t\t\ttime={lastMessage?.ts}\n\t\t\tsubtitle={subtitle}\n\t\t\ticon={icon}\n\t\t\tstyle={style}\n\t\t\tbadges={badges}\n\t\t\tavatar={AvatarTemplate && <AvatarTemplate {...room} />}\n\t\t\tmenu={\n\t\t\t\t!isAnonymous &&\n\t\t\t\t!isQueued &&\n\t\t\t\t(() => (\n\t\t\t\t\t<RoomMenu\n\t\t\t\t\t\talert={alert}\n\t\t\t\t\t\tthreadUnread={threadUnread}\n\t\t\t\t\t\trid={rid}\n\t\t\t\t\t\tunread={!!unread}\n\t\t\t\t\t\troomOpen={false}\n\t\t\t\t\t\ttype={type}\n\t\t\t\t\t\tcl={cl}\n\t\t\t\t\t\tname={title}\n\t\t\t\t\t\tstatus={room.status}\n\t\t\t\t\t/>\n\t\t\t\t))\n\t\t\t}\n\t\t/>\n\t);\n}\n\nconst propsAreEqual = (prevProps, nextProps) => {\n\tif (\n\t\t['id', 'style', 'extended', 'selected', 'SideBarItemTemplate', 'AvatarTemplate', 't', 'sidebarViewMode'].some(\n\t\t\t(key) => prevProps[key] !== nextProps[key],\n\t\t)\n\t) {\n\t\treturn false;\n\t}\n\n\tif (prevProps.room === nextProps.room) {\n\t\treturn true;\n\t}\n\n\tif (prevProps.room._id !== nextProps.room._id) {\n\t\treturn false;\n\t}\n\tif (prevProps.room._updatedAt?.toISOString() !== nextProps.room._updatedAt?.toISOString()) {\n\t\treturn false;\n\t}\n\tif (prevProps.room.lastMessage?._updatedAt?.toISOString() !== nextProps.room.lastMessage?._updatedAt?.toISOString()) {\n\t\treturn false;\n\t}\n\tif (prevProps.room.alert !== nextProps.room.alert) {\n\t\treturn false;\n\t}\n\tif (prevProps.room.v?.status !== nextProps.room.v?.status) {\n\t\treturn false;\n\t}\n\tif (prevProps.room.teamMain !== nextProps.room.teamMain) {\n\t\treturn false;\n\t}\n\n\treturn true;\n};\n\nexport default memo(SideBarItemTemplateWithData, propsAreEqual);\n"]}