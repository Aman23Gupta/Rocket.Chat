{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/RoomMembers/InviteUsers/WrappedInviteUsers.js"],"names":["useMutableCallback","module","link","v","React","useState","useEffect","default","useEndpoint","useTranslation","useFormatDateAndTime","useTabBarClose","EditInvite","InviteUsers","WrappedInviteUsers","rid","tabBar","onClickBack","editing","setEditing","format","t","onClickClose","handleEdit","onClickBackEditing","findOrCreateInvite","days","maxUses","setDayAndMaxUses","setParams","args","state","setState","linkExpirationText","data","expires","expiration","Date","usesLeft","uses","date","url","caption","error","exportDefault"],"mappings":"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","file":"dynamic/client/views/room/contextualBar/RoomMembers/InviteUsers/WrappedInviteUsers.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, useEffect } from 'react';\n\nimport { useEndpoint } from '../../../../../contexts/ServerContext';\nimport { useTranslation } from '../../../../../contexts/TranslationContext';\nimport { useFormatDateAndTime } from '../../../../../hooks/useFormatDateAndTime';\nimport { useTabBarClose } from '../../../providers/ToolboxProvider';\nimport EditInvite from '../EditInvite';\nimport InviteUsers from './InviteUsers';\n\nconst WrappedInviteUsers = ({ rid, tabBar, onClickBack }) => {\n\tconst [editing, setEditing] = useState(false);\n\tconst format = useFormatDateAndTime();\n\tconst t = useTranslation();\n\n\tconst onClickClose = useTabBarClose();\n\n\tconst handleEdit = useMutableCallback(() => setEditing(true));\n\tconst onClickBackEditing = useMutableCallback(() => setEditing(false));\n\n\tconst findOrCreateInvite = useEndpoint('POST', 'findOrCreateInvite');\n\n\tconst [{ days = 1, maxUses = 0 }, setDayAndMaxUses] = useState({});\n\n\tconst setParams = useMutableCallback((args) => {\n\t\tsetDayAndMaxUses(args);\n\t\tsetEditing(false);\n\t});\n\n\tconst [state, setState] = useState();\n\n\tconst linkExpirationText = useMutableCallback((data) => {\n\t\tif (!data) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (data.expires) {\n\t\t\tconst expiration = new Date(data.expires);\n\t\t\tif (data.maxUses) {\n\t\t\t\tconst usesLeft = data.maxUses - data.uses;\n\t\t\t\treturn t('Your_invite_link_will_expire_on__date__or_after__usesLeft__uses', {\n\t\t\t\t\tdate: format(expiration),\n\t\t\t\t\tusesLeft,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn t('Your_invite_link_will_expire_on__date__', { date: format(expiration) });\n\t\t}\n\n\t\tif (data.maxUses) {\n\t\t\tconst usesLeft = data.maxUses - data.uses;\n\t\t\treturn t('Your_invite_link_will_expire_after__usesLeft__uses', { usesLeft });\n\t\t}\n\n\t\treturn t('Your_invite_link_will_never_expire');\n\t});\n\n\tuseEffect(() => {\n\t\tif (editing) {\n\t\t\treturn;\n\t\t}\n\t\t(async () => {\n\t\t\ttry {\n\t\t\t\tconst data = await findOrCreateInvite({ rid, days, maxUses });\n\t\t\t\tsetState({\n\t\t\t\t\turl: data.url,\n\t\t\t\t\tcaption: linkExpirationText(data),\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tsetState({ error });\n\t\t\t}\n\t\t})();\n\t}, [findOrCreateInvite, editing, linkExpirationText, rid, days, maxUses]);\n\n\tif (editing) {\n\t\treturn (\n\t\t\t<EditInvite\n\t\t\t\tonClickBack={onClickBackEditing}\n\t\t\t\tlinkText={state?.url}\n\t\t\t\tcaptionText={state?.caption}\n\t\t\t\t{...{ rid, tabBar, error: state?.error, setParams, days, maxUses }}\n\t\t\t/>\n\t\t);\n\t}\n\n\treturn (\n\t\t<InviteUsers\n\t\t\terror={state?.error}\n\t\t\tonClickClose={onClickClose}\n\t\t\tonClickBack={onClickBack}\n\t\t\tonClickEdit={handleEdit}\n\t\t\tlinkText={state?.url}\n\t\t\tcaptionText={state?.caption}\n\t\t/>\n\t);\n};\n\nexport default WrappedInviteUsers;\n"]}