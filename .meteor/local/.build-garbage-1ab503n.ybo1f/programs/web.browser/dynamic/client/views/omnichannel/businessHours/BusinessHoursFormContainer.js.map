{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/businessHours/BusinessHoursFormContainer.js"],"names":["_objectSpread","module","link","default","v","FieldGroup","Box","useMutableCallback","React","useEffect","useState","useSubscription","businessHourManager","useForm","useReactiveValue","formsSubscription","BusinessHourForm","useChangeHandler","name","ref","val","current","getInitalData","workHours","daysOpen","filter","open","map","day","daysTime","reduce","acc","start","time","finish","cleanFunc","BusinessHoursFormContainer","data","saveRef","onChange","forms","hasChangesMultiple","setHasChangesMultiple","hasChangesTimeZone","setHasChangesTimeZone","useBusinessHoursTimeZone","useBusinessHoursMultiple","TimezoneForm","MultipleBHForm","showTimezone","showTimezoneTemplate","showMultipleBHForm","showCustomTemplate","onChangeTimezone","onChangeMultipleBHForm","values","handlers","hasUnsavedChanges","form","timezone","timezoneName","exportDefault"],"mappings":"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","file":"dynamic/client/views/omnichannel/businessHours/BusinessHoursFormContainer.js","sourcesContent":["import { FieldGroup, Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useEffect, useState } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { businessHourManager } from '../../../../app/livechat/client/views/app/business-hours/BusinessHours';\nimport { useForm } from '../../../hooks/useForm';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport { formsSubscription } from '../additionalForms';\nimport BusinessHourForm from './BusinessHoursForm';\n\nconst useChangeHandler = (name, ref) =>\n\tuseMutableCallback((val) => {\n\t\tref.current[name] = { ...ref.current[name], ...val };\n\t});\n\nconst getInitalData = ({ workHours }) => ({\n\tdaysOpen: workHours.filter(({ open }) => !!open).map(({ day }) => day),\n\tdaysTime: workHours.reduce((acc, { day, start: { time: start }, finish: { time: finish } }) => {\n\t\tacc = { ...acc, [day]: { start, finish } };\n\t\treturn acc;\n\t}, {}),\n});\n\nconst cleanFunc = () => {};\n\nconst BusinessHoursFormContainer = ({ data, saveRef, onChange = () => {} }) => {\n\tconst forms = useSubscription(formsSubscription);\n\n\tconst [hasChangesMultiple, setHasChangesMultiple] = useState(false);\n\tconst [hasChangesTimeZone, setHasChangesTimeZone] = useState(false);\n\n\tconst { useBusinessHoursTimeZone = cleanFunc, useBusinessHoursMultiple = cleanFunc } = forms;\n\n\tconst TimezoneForm = useBusinessHoursTimeZone();\n\tconst MultipleBHForm = useBusinessHoursMultiple();\n\n\tconst showTimezone = useReactiveValue(useMutableCallback(() => businessHourManager.showTimezoneTemplate()));\n\tconst showMultipleBHForm = useReactiveValue(useMutableCallback(() => businessHourManager.showCustomTemplate(data)));\n\n\tconst onChangeTimezone = useChangeHandler('timezone', saveRef);\n\tconst onChangeMultipleBHForm = useChangeHandler('multiple', saveRef);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm(getInitalData(data));\n\n\tsaveRef.current.form = values;\n\n\tuseEffect(() => {\n\t\tonChange(hasUnsavedChanges || (showMultipleBHForm && hasChangesMultiple) || (showTimezone && hasChangesTimeZone));\n\t});\n\n\treturn (\n\t\t<Box maxWidth='600px' w='full' alignSelf='center'>\n\t\t\t<FieldGroup>\n\t\t\t\t{showMultipleBHForm && MultipleBHForm && (\n\t\t\t\t\t<MultipleBHForm onChange={onChangeMultipleBHForm} data={data} hasChangesAndIsValid={setHasChangesMultiple} />\n\t\t\t\t)}\n\t\t\t\t{showTimezone && TimezoneForm && (\n\t\t\t\t\t<TimezoneForm onChange={onChangeTimezone} data={data?.timezone?.name ?? data?.timezoneName} hasChanges={setHasChangesTimeZone} />\n\t\t\t\t)}\n\t\t\t\t<BusinessHourForm values={values} handlers={handlers} />\n\t\t\t</FieldGroup>\n\t\t</Box>\n\t);\n};\n\nexport default BusinessHoursFormContainer;\n"]}