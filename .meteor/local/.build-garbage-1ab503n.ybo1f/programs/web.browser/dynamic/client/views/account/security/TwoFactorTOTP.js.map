{"version":3,"sources":["meteor://ðŸ’»app/client/views/account/security/TwoFactorTOTP.js"],"names":["_extends","module","link","default","v","Box","Button","TextInput","Margins","useSafely","React","useState","useCallback","useEffect","qrcode","TextCopy","TwoFactorTotpModal","useSetModal","useMethod","useToastMessageDispatch","useTranslation","useUser","useForm","BackupCodesModal","TwoFactorTOTP","props","t","dispatchToastMessage","user","setModal","enableTotpFn","disableTotpFn","verifyCodeFn","checkCodesRemainingFn","regenerateCodesFn","registeringTotp","setRegisteringTotp","qrCode","setQrCode","totpSecret","setTotpSecret","codesRemaining","setCodesRemaining","values","handlers","authCode","handleAuthCode","totpEnabled","services","totp","enabled","closeModal","updateCodesRemaining","result","remaining","handleEnableTotp","secret","url","size","error","type","message","handleDisableTotp","onDisable","handleVerifyCode","codes","handleRegenerateCodes","onRegenerate","number","exportDefault"],"mappings":"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","file":"dynamic/client/views/account/security/TwoFactorTOTP.js","sourcesContent":["import { Box, Button, TextInput, Margins } from '@rocket.chat/fuselage';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, useCallback, useEffect } from 'react';\nimport qrcode from 'yaqrcode';\n\nimport TextCopy from '../../../components/TextCopy';\nimport TwoFactorTotpModal from '../../../components/TwoFactorModal/TwoFactorTotpModal';\nimport { useSetModal } from '../../../contexts/ModalContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useUser } from '../../../contexts/UserContext';\nimport { useForm } from '../../../hooks/useForm';\nimport BackupCodesModal from './BackupCodesModal';\n\nconst TwoFactorTOTP = (props) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst user = useUser();\n\tconst setModal = useSetModal();\n\n\tconst enableTotpFn = useMethod('2fa:enable');\n\tconst disableTotpFn = useMethod('2fa:disable');\n\tconst verifyCodeFn = useMethod('2fa:validateTempToken');\n\tconst checkCodesRemainingFn = useMethod('2fa:checkCodesRemaining');\n\tconst regenerateCodesFn = useMethod('2fa:regenerateCodes');\n\n\tconst [registeringTotp, setRegisteringTotp] = useSafely(useState(false));\n\tconst [qrCode, setQrCode] = useSafely(useState());\n\tconst [totpSecret, setTotpSecret] = useSafely(useState());\n\tconst [codesRemaining, setCodesRemaining] = useSafely(useState());\n\n\tconst { values, handlers } = useForm({ authCode: '' });\n\n\tconst { authCode } = values;\n\tconst { handleAuthCode } = handlers;\n\n\tconst totpEnabled = user && user.services && user.services.totp && user.services.totp.enabled;\n\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\n\tuseEffect(() => {\n\t\tconst updateCodesRemaining = async () => {\n\t\t\tif (!totpEnabled) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst result = await checkCodesRemainingFn();\n\t\t\tsetCodesRemaining(result.remaining);\n\t\t};\n\t\tupdateCodesRemaining();\n\t}, [checkCodesRemainingFn, setCodesRemaining, totpEnabled]);\n\n\tconst handleEnableTotp = useCallback(async () => {\n\t\ttry {\n\t\t\tconst result = await enableTotpFn();\n\n\t\t\tsetTotpSecret(result.secret);\n\t\t\tsetQrCode(qrcode(result.url, { size: 200 }));\n\n\t\t\tsetRegisteringTotp(true);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [dispatchToastMessage, enableTotpFn, setQrCode, setRegisteringTotp, setTotpSecret]);\n\n\tconst handleDisableTotp = useCallback(async () => {\n\t\tconst onDisable = async (authCode) => {\n\t\t\ttry {\n\t\t\t\tconst result = await disableTotpFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Two-factor_authentication_disabled') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tcloseModal();\n\t\t};\n\n\t\tsetModal(<TwoFactorTotpModal onConfirm={onDisable} onClose={closeModal} />);\n\t}, [closeModal, disableTotpFn, dispatchToastMessage, setModal, t]);\n\n\tconst handleVerifyCode = useCallback(async () => {\n\t\ttry {\n\t\t\tconst result = await verifyCodeFn(authCode);\n\n\t\t\tif (!result) {\n\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t}\n\t\t\tsetModal(<BackupCodesModal codes={result.codes} onClose={closeModal} />);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [authCode, closeModal, dispatchToastMessage, setModal, t, verifyCodeFn]);\n\n\tconst handleRegenerateCodes = useCallback(() => {\n\t\tconst onRegenerate = async (authCode) => {\n\t\t\ttry {\n\t\t\t\tconst result = await regenerateCodesFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\t\t\t\tsetModal(<BackupCodesModal codes={result.codes} onClose={closeModal} />);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<TwoFactorTotpModal onConfirm={onRegenerate} onClose={closeModal} />);\n\t}, [closeModal, dispatchToastMessage, regenerateCodesFn, setModal, t]);\n\n\treturn (\n\t\t<Box display='flex' flexDirection='column' alignItems='flex-start' {...props}>\n\t\t\t<Margins blockEnd='x8'>\n\t\t\t\t<Box fontScale='h4'>{t('Two-factor_authentication')}</Box>\n\t\t\t\t{!totpEnabled && !registeringTotp && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Box>{t('Two-factor_authentication_is_currently_disabled')}</Box>\n\t\t\t\t\t\t<Button primary onClick={handleEnableTotp}>\n\t\t\t\t\t\t\t{t('Enable_two-factor_authentication')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t\t{!totpEnabled && registeringTotp && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Box>{t('Scan_QR_code')}</Box>\n\t\t\t\t\t\t<Box>{t('Scan_QR_code_alternative_s')}</Box>\n\t\t\t\t\t\t<TextCopy text={totpSecret} />\n\t\t\t\t\t\t<Box is='img' size='x200' src={qrCode} aria-hidden='true' />\n\t\t\t\t\t\t<Box display='flex' flexDirection='row' w='full'>\n\t\t\t\t\t\t\t<TextInput placeholder={t('Enter_authentication_code')} value={authCode} onChange={handleAuthCode} />\n\t\t\t\t\t\t\t<Button primary onClick={handleVerifyCode}>\n\t\t\t\t\t\t\t\t{t('Verify')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t\t{totpEnabled && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Button primary danger onClick={handleDisableTotp}>\n\t\t\t\t\t\t\t{t('Disable_two-factor_authentication')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Box fontScale='p2m' mbs='x8'>\n\t\t\t\t\t\t\t{t('Backup_codes')}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<Box>{t('You_have_n_codes_remaining', { number: codesRemaining })}</Box>\n\t\t\t\t\t\t<Button onClick={handleRegenerateCodes}>{t('Regenerate_codes')}</Button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</Margins>\n\t\t</Box>\n\t);\n};\n\nexport default TwoFactorTOTP;\n"]}