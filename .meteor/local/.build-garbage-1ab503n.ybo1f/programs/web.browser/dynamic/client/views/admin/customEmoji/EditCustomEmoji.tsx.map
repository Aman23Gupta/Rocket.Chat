{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/customEmoji/EditCustomEmoji.tsx"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAAc,MAAQ,KAAR,CAAQ,sCAAR,EAAsD;AAAA,UAAU,CAAV,EAAY;AAAA,iBAAM,IAAN;AAAM;;AAAlB,CAAtD,EAAwE,CAAxE;;AAAwE;;AAAwB;AAAA;AAAA;AAAA;;AAAA;AAA9G,SAAO,MAAP,EAAc,WAAd,EAAsB,OAAtB,EAAmC,SAAnC,EAA4C,KAA5C,EAA4C,IAA5C,EAAuD,UAAvD;AAAkE,MAAE,KAAF,CAAY,uBAAZ,EAAoB;AAAA,SAAwB;AAAA;AAAA,GAAxB;;AAAwB;AAAA;AAAA,GAAxB;;AAAwB;AAAA;AAAA,GAAxB;;AAAwB;AAAA;AAAA,GAAxB;;AAAwB;AAAA;AAAA,GAAxB;;AAAwB;AAAA;AAAA,GAAxB;;AAAwB;AAAA;AAAA,GAAxB;;AAAwB;AAAA;AAAA;;AAAxB,CAApB,EAA4C,CAA5C;AAA4C;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAwB9G,MAAM,eAAe,GAA6B,QAAwC;AAAA,MAAvC;AAAE,SAAF;AAAS,YAAT;AAAmB;AAAnB,GAAuC;AAAA,MAAX,KAAW;;AACzF,QAAM,CAAC,GAAG,cAAc,EAAxB;AACA,QAAM,oBAAoB,GAAG,uBAAuB,EAApD;AACA,QAAM,QAAQ,GAAG,WAAW,EAA5B;AACA,QAAM,WAAW,GAAG,cAAc,EAAlC;AACA,QAAM,CAAC,MAAD,EAAS,SAAT,IAAsB,QAAQ,CAAC;AAAE,QAAI,EAAE,KAAR;AAAe,WAAO,EAAE;AAAxB,GAAD,CAApC;AAEA,QAAM;AAAE,OAAF;AAAO,QAAI,EAAE,YAAb;AAA2B,WAAO,EAAE;AAApC,MAAwD,IAAI,IAAI,EAAtE;AAEA,QAAM,CAAC,IAAD,EAAO,OAAP,IAAkB,QAAQ,CAAC;AAAA;;AAAA,yBAAM,IAAN,aAAM,IAAN,uBAAM,IAAI,CAAE,IAAZ,mDAAoB,EAApB;AAAA,GAAD,CAAhC;AACA,QAAM,CAAC,OAAD,EAAU,UAAV,IAAwB,QAAQ,CAAC;AAAA;;AAAA,iCAAM,IAAN,aAAM,IAAN,wCAAM,IAAI,CAAE,OAAZ,kDAAM,cAAe,IAAf,CAAoB,IAApB,CAAN,mEAAmC,EAAnC;AAAA,GAAD,CAAtC;AACA,QAAM,CAAC,SAAD,EAAY,YAAZ,IAA4B,QAAQ,EAA1C;AACA,QAAM,eAAe,GAAG,OAAO,CAAC,MAAK;AACpC,QAAI,SAAJ,EAAe;AACd,aAAO,GAAG,CAAC,eAAJ,CAAoB,SAApB,CAAP;AACA;;AAED,QAAI,IAAJ,EAAU;AACT,aAAO,WAAW,yBAAkB,kBAAkB,CAAC,IAAI,CAAC,IAAN,CAApC,cAAmD,IAAI,CAAC,SAAxD,EAAlB;AACA;;AAED,WAAO,IAAP;AACA,GAV8B,EAU5B,CAAC,WAAD,EAAc,IAAd,EAAoB,SAApB,CAV4B,CAA/B;AAYA,WAAS,CAAC,MAAK;AACd,WAAO,CAAC,YAAY,IAAI,EAAjB,CAAP;AACA,cAAU,CAAC,gBAAe,SAAf,mBAAe,WAAf,2BAAe,CAAE,IAAjB,CAAsB,IAAtB,MAA+B,EAAhC,CAAV;AACA,GAHQ,EAGN,CAAC,YAAD,EAAe,eAAf,EAAgC,GAAhC,CAHM,CAAT;AAKA,QAAM,iBAAiB,GAAG,OAAO,CAChC,MAAM,YAAY,KAAK,IAAjB,IAAyB,OAAO,KAAK,eAAe,CAAC,IAAhB,CAAqB,IAArB,CAArC,IAAmE,CAAC,CAAC,SAD3C,EAEhC,CAAC,YAAD,EAAe,IAAf,EAAqB,OAArB,EAA8B,eAA9B,EAA+C,SAA/C,CAFgC,CAAjC;AAKA,QAAM,UAAU,GAAG,iBAAiB,CAAC,qBAAD,EAAwB,EAAxB,EAA4B,CAAC,CAAC,mCAAD,CAA7B,CAApC;AAEA,QAAM,UAAU,GAAG,WAAW,CAAC,YAAW;AACzC,QAAI,CAAC,IAAL,EAAW;AACV,aAAO,SAAS,CAAE,SAAD,oCAAqB,SAArB;AAAgC,YAAI,EAAE;AAAtC,QAAD,CAAhB;AACA;;AAED,QAAI,IAAI,KAAK,OAAb,EAAsB;AACrB,aAAO,SAAS,CAAE,SAAD,oCAAqB,SAArB;AAAgC,eAAO,EAAE;AAAzC,QAAD,CAAhB;AACA;;AAED,QAAI,CAAC,SAAD,IAAc,CAAC,eAAnB,EAAoC;AACnC;AACA;;AAED,UAAM,QAAQ,GAAG,IAAI,QAAJ,EAAjB;AACA,aAAS,IAAI,QAAQ,CAAC,MAAT,CAAgB,OAAhB,EAAyB,SAAzB,CAAb;AACA,YAAQ,CAAC,MAAT,CAAgB,KAAhB,EAAuB,GAAvB;AACA,YAAQ,CAAC,MAAT,CAAgB,MAAhB,EAAwB,IAAxB;AACA,YAAQ,CAAC,MAAT,CAAgB,SAAhB,EAA2B,OAA3B;AACA,UAAM,MAAM,GAAI,MAAM,UAAU,CAAC,QAAD,CAAhC;;AACA,QAAI,MAAM,CAAC,OAAX,EAAoB;AACnB,cAAQ;AACR,WAAK;AACL;AACD,GAvB6B,EAuB3B,CAAC,SAAD,EAAY,GAAZ,EAAiB,IAAjB,EAAuB,OAAvB,EAAgC,UAAhC,EAA4C,QAA5C,EAAsD,KAAtD,EAA6D,eAA7D,CAvB2B,CAA9B;AAyBA,QAAM,YAAY,GAAG,iBAAiB,CACrC,MADqC,EAErC,qBAFqC,EAGrC,OAAO,CAAC,OAAO;AAAE,WAAO,EAAE;AAAX,GAAP,CAAD,EAA2B,CAAC,GAAD,CAA3B,CAH8B,CAAtC;AAMA,QAAM,uBAAuB,GAAG,WAAW,CAAC,MAAK;AAChD,UAAM,YAAY,GAAG,YAA0B;AAC9C,UAAI;AACH,cAAM,YAAY,EAAlB;AACA,4BAAoB,CAAC;AAAE,cAAI,EAAE,SAAR;AAAmB,iBAAO,EAAE,CAAC,CAAC,+BAAD;AAA7B,SAAD,CAApB;AACA,OAHD,CAGE,OAAO,KAAP,EAAc;AACf,4BAAoB,CAAC;AAAE,cAAI,EAAE,OAAR;AAAiB,iBAAO,EAAE;AAA1B,SAAD,CAApB;AACA,OALD,SAKU;AACT,gBAAQ;AACR,gBAAQ,CAAC,IAAD,CAAR;AACA,aAAK;AACL;AACD,KAXD;;AAaA,UAAM,YAAY,GAAG,MAAW;AAC/B,cAAQ,CAAC,IAAD,CAAR;AACA,KAFD;;AAIA,YAAQ,CAAC,mBACR,oBAAC,YAAD;AAAc,aAAO,EAAC,QAAtB;AAA+B,eAAS,EAAE,YAA1C;AAAwD,cAAQ,EAAE,YAAlE;AAAgF,aAAO,EAAE,YAAzF;AAAuG,iBAAW,EAAE,CAAC,CAAC,QAAD;AAArH,OACE,CAAC,CAAC,6BAAD,CADH,CADO,CAAR;AAKA,GAvB0C,EAuBxC,CAAC,YAAD,EAAe,KAAf,EAAsB,oBAAtB,EAA4C,QAA5C,EAAsD,QAAtD,EAAgE,CAAhE,CAvBwC,CAA3C;AAyBA,QAAM,mBAAmB,GAAG,WAAW,CACrC,CAAD,IAAM;AACL,QAAI,CAAC,CAAC,aAAF,CAAgB,KAAhB,KAA0B,IAA9B,EAAoC;AACnC,eAAS,CAAE,SAAD,oCAAqB,SAArB;AAAgC,eAAO,EAAE;AAAzC,QAAD,CAAT;AACA;;AAED,WAAO,UAAU,CAAC,CAAC,CAAC,aAAF,CAAgB,KAAjB,CAAjB;AACA,GAPqC,EAQtC,CAAC,UAAD,EAAa,IAAb,CARsC,CAAvC;AAWA,QAAM,CAAC,WAAD,IAAgB,YAAY,CAAC,YAAD,EAAe,OAAf,CAAlC;;AAEA,QAAM,gBAAgB,GAAI,CAAD,IAA2C;AACnE,QAAI,CAAC,CAAC,aAAF,CAAgB,KAAhB,KAA0B,EAA9B,EAAkC;AACjC,eAAS,CAAE,SAAD,oCAAqB,SAArB;AAAgC,YAAI,EAAE;AAAtC,QAAD,CAAT;AACA;;AAED,WAAO,OAAO,CAAC,CAAC,CAAC,aAAF,CAAgB,KAAjB,CAAd;AACA,GAND;;AAQA,sBACC,oBAAC,WAAD,CAAa,iBAAb,EAAoC,KAApC,eACC,oBAAC,UAAD,qBACC,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,KAAP,QAAc,CAAC,CAAC,MAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AAAW,SAAK,EAAE,IAAlB;AAAwB,YAAQ,EAAE,gBAAlC;AAAoD,eAAW,EAAE,CAAC,CAAC,MAAD;AAAlE,IADD,CAFD,EAKE,MAAM,CAAC,IAAP,iBAAe,oBAAC,KAAD,CAAO,KAAP,QAAc,CAAC,CAAC,6BAAD,EAAgC;AAAE,SAAK,EAAE,CAAC,CAAC,MAAD;AAAV,GAAhC,CAAf,CALjB,CADD,eAQC,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,KAAP,QAAc,CAAC,CAAC,SAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AAAW,SAAK,EAAE,OAAlB;AAA2B,YAAQ,EAAE,mBAArC;AAA0D,eAAW,EAAE,CAAC,CAAC,SAAD;AAAxE,IADD,CAFD,EAKE,MAAM,CAAC,OAAP,iBAAkB,oBAAC,KAAD,CAAO,KAAP,QAAc,CAAC,CAAC,wCAAD,CAAf,CALpB,CARD,eAeC,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,KAAP;AAAa,aAAS,EAAC,SAAvB;AAAiC,WAAO,EAAC,MAAzC;AAAgD,kBAAc,EAAC,eAA/D;AAA+E,cAAU,EAAC;AAA1F,KACE,CAAC,CAAC,cAAD,CADH,eAEC,oBAAC,MAAD;AAAQ,UAAM,MAAd;AAAe,WAAO,EAAE;AAAxB,kBACC,oBAAC,IAAD;AAAM,QAAI,EAAC,QAAX;AAAoB,QAAI,EAAC;AAAzB,IADD,CAFD,CADD,EAOE,eAAe,iBACf,oBAAC,GAAD;AAAK,WAAO,EAAC,MAAb;AAAoB,iBAAa,EAAC,KAAlC;AAAwC,OAAG,EAAC,MAA5C;AAAmD,kBAAc,EAAC;AAAlE,kBACC,oBAAC,OAAD;AAAS,UAAM,EAAC;AAAhB,kBACC,oBAAC,GAAD;AAAK,MAAE,EAAC,KAAR;AAAc,SAAK,EAAE;AAAE,eAAS,EAAE;AAAb,KAArB;AAA+C,KAAC,EAAC,MAAjD;AAAwD,KAAC,EAAC,MAA1D;AAAiE,OAAG,EAAE;AAAtE,IADD,CADD,CARF,CAfD,CADD,eAgCC,oBAAC,WAAD;AAAa,WAAO,MAApB;AAAqB,KAAC,EAAC;AAAvB,kBACC,oBAAC,MAAD;AAAQ,WAAO,EAAE;AAAjB,KAAyB,CAAC,CAAC,QAAD,CAA1B,CADD,eAEC,oBAAC,MAAD;AAAQ,WAAO,MAAf;AAAgB,WAAO,EAAE,UAAzB;AAAqC,YAAQ,EAAE,CAAC;AAAhD,KACE,CAAC,CAAC,MAAD,CADH,CAFD,CAhCD,eAuCC,oBAAC,WAAD;AAAa,WAAO,MAApB;AAAqB,KAAC,EAAC;AAAvB,kBACC,oBAAC,MAAD;AAAQ,WAAO,MAAf;AAAgB,UAAM,MAAtB;AAAuB,WAAO,EAAE;AAAhC,kBACC,oBAAC,IAAD;AAAM,QAAI,EAAC,OAAX;AAAmB,OAAG,EAAC;AAAvB,IADD,EAEE,CAAC,CAAC,QAAD,CAFH,CADD,CAvCD,CADD;AAgDA,CAjKD;;AAxBA,OAAO,aAAP,CA2Le,eA3Lf,E","file":"dynamic/client/views/admin/customEmoji/EditCustomEmoji.tsx","sourcesContent":["import { Box, Button, ButtonGroup, Margins, TextInput, Field, Icon, FieldGroup } from '@rocket.chat/fuselage';\nimport React, { useCallback, useState, useMemo, useEffect, FC, ChangeEvent } from 'react';\n\nimport GenericModal from '../../../components/GenericModal';\nimport VerticalBar from '../../../components/VerticalBar';\nimport { useSetModal } from '../../../contexts/ModalContext';\nimport { useAbsoluteUrl } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useEndpointAction } from '../../../hooks/useEndpointAction';\nimport { useEndpointUpload } from '../../../hooks/useEndpointUpload';\nimport { useFileInput } from '../../../hooks/useFileInput';\n\ntype EditCustomEmojiProps = {\n\tclose: () => void;\n\tonChange: () => void;\n\tdata: {\n\t\t_id: string;\n\t\tname: string;\n\t\taliases: string[];\n\t\textension: string;\n\t};\n};\n\nconst EditCustomEmoji: FC<EditCustomEmojiProps> = ({ close, onChange, data, ...props }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst absoluteUrl = useAbsoluteUrl();\n\tconst [errors, setErrors] = useState({ name: false, aliases: false });\n\n\tconst { _id, name: previousName, aliases: previousAliases } = data || {};\n\n\tconst [name, setName] = useState(() => data?.name ?? '');\n\tconst [aliases, setAliases] = useState(() => data?.aliases?.join(', ') ?? '');\n\tconst [emojiFile, setEmojiFile] = useState<Blob>();\n\tconst newEmojiPreview = useMemo(() => {\n\t\tif (emojiFile) {\n\t\t\treturn URL.createObjectURL(emojiFile);\n\t\t}\n\n\t\tif (data) {\n\t\t\treturn absoluteUrl(`/emoji-custom/${encodeURIComponent(data.name)}.${data.extension}`);\n\t\t}\n\n\t\treturn null;\n\t}, [absoluteUrl, data, emojiFile]);\n\n\tuseEffect(() => {\n\t\tsetName(previousName || '');\n\t\tsetAliases(previousAliases?.join(', ') || '');\n\t}, [previousName, previousAliases, _id]);\n\n\tconst hasUnsavedChanges = useMemo(\n\t\t() => previousName !== name || aliases !== previousAliases.join(', ') || !!emojiFile,\n\t\t[previousName, name, aliases, previousAliases, emojiFile],\n\t);\n\n\tconst saveAction = useEndpointUpload('emoji-custom.update', {}, t('Custom_Emoji_Updated_Successfully'));\n\n\tconst handleSave = useCallback(async () => {\n\t\tif (!name) {\n\t\t\treturn setErrors((prevState) => ({ ...prevState, name: true }));\n\t\t}\n\n\t\tif (name === aliases) {\n\t\t\treturn setErrors((prevState) => ({ ...prevState, aliases: true }));\n\t\t}\n\n\t\tif (!emojiFile && !newEmojiPreview) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst formData = new FormData();\n\t\temojiFile && formData.append('emoji', emojiFile);\n\t\tformData.append('_id', _id);\n\t\tformData.append('name', name);\n\t\tformData.append('aliases', aliases);\n\t\tconst result = (await saveAction(formData)) as { success: boolean };\n\t\tif (result.success) {\n\t\t\tonChange();\n\t\t\tclose();\n\t\t}\n\t}, [emojiFile, _id, name, aliases, saveAction, onChange, close, newEmojiPreview]);\n\n\tconst deleteAction = useEndpointAction(\n\t\t'POST',\n\t\t'emoji-custom.delete',\n\t\tuseMemo(() => ({ emojiId: _id }), [_id]),\n\t);\n\n\tconst handleDeleteButtonClick = useCallback(() => {\n\t\tconst handleDelete = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait deleteAction();\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Custom_Emoji_Has_Been_Deleted') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tonChange();\n\t\t\t\tsetModal(null);\n\t\t\t\tclose();\n\t\t\t}\n\t\t};\n\n\t\tconst handleCancel = (): void => {\n\t\t\tsetModal(null);\n\t\t};\n\n\t\tsetModal(() => (\n\t\t\t<GenericModal variant='danger' onConfirm={handleDelete} onCancel={handleCancel} onClose={handleCancel} confirmText={t('Delete')}>\n\t\t\t\t{t('Custom_Emoji_Delete_Warning')}\n\t\t\t</GenericModal>\n\t\t));\n\t}, [deleteAction, close, dispatchToastMessage, onChange, setModal, t]);\n\n\tconst handleChangeAliases = useCallback(\n\t\t(e) => {\n\t\t\tif (e.currentTarget.value !== name) {\n\t\t\t\tsetErrors((prevState) => ({ ...prevState, aliases: false }));\n\t\t\t}\n\n\t\t\treturn setAliases(e.currentTarget.value);\n\t\t},\n\t\t[setAliases, name],\n\t);\n\n\tconst [clickUpload] = useFileInput(setEmojiFile, 'emoji');\n\n\tconst handleChangeName = (e: ChangeEvent<HTMLInputElement>): void => {\n\t\tif (e.currentTarget.value !== '') {\n\t\t\tsetErrors((prevState) => ({ ...prevState, name: false }));\n\t\t}\n\n\t\treturn setName(e.currentTarget.value);\n\t};\n\n\treturn (\n\t\t<VerticalBar.ScrollableContent {...(props as any)}>\n\t\t\t<FieldGroup>\n\t\t\t\t<Field>\n\t\t\t\t\t<Field.Label>{t('Name')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput value={name} onChange={handleChangeName} placeholder={t('Name')} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t\t{errors.name && <Field.Error>{t('error-the-field-is-required', { field: t('Name') })}</Field.Error>}\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<Field.Label>{t('Aliases')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput value={aliases} onChange={handleChangeAliases} placeholder={t('Aliases')} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t\t{errors.aliases && <Field.Error>{t('Custom_Emoji_Error_Same_Name_And_Alias')}</Field.Error>}\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<Field.Label alignSelf='stretch' display='flex' justifyContent='space-between' alignItems='center'>\n\t\t\t\t\t\t{t('Custom_Emoji')}\n\t\t\t\t\t\t<Button square onClick={clickUpload}>\n\t\t\t\t\t\t\t<Icon name='upload' size='x20' />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Field.Label>\n\t\t\t\t\t{newEmojiPreview && (\n\t\t\t\t\t\t<Box display='flex' flexDirection='row' mbs='none' justifyContent='center'>\n\t\t\t\t\t\t\t<Margins inline='x4'>\n\t\t\t\t\t\t\t\t<Box is='img' style={{ objectFit: 'contain' }} w='x120' h='x120' src={newEmojiPreview} />\n\t\t\t\t\t\t\t</Margins>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t)}\n\t\t\t\t</Field>\n\t\t\t</FieldGroup>\n\t\t\t<ButtonGroup stretch w='full'>\n\t\t\t\t<Button onClick={close}>{t('Cancel')}</Button>\n\t\t\t\t<Button primary onClick={handleSave} disabled={!hasUnsavedChanges}>\n\t\t\t\t\t{t('Save')}\n\t\t\t\t</Button>\n\t\t\t</ButtonGroup>\n\n\t\t\t<ButtonGroup stretch w='full'>\n\t\t\t\t<Button primary danger onClick={handleDeleteButtonClick}>\n\t\t\t\t\t<Icon name='trash' mie='x4' />\n\t\t\t\t\t{t('Delete')}\n\t\t\t\t</Button>\n\t\t\t</ButtonGroup>\n\t\t</VerticalBar.ScrollableContent>\n\t);\n};\n\nexport default EditCustomEmoji;\n"]}