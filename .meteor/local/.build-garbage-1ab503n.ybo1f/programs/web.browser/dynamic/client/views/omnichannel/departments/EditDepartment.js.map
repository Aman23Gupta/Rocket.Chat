{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/departments/EditDepartment.js"],"names":["FieldGroup","Field","TextInput","Chip","Box","Icon","Divider","ToggleSwitch","TextAreaInput","ButtonGroup","Button","PaginatedSelectFiltered","module","link","v","useMutableCallback","useUniqueId","React","useMemo","useState","useRef","default","useSubscription","validateEmail","Page","useRoomsList","useRoute","useMethod","useEndpoint","useToastMessageDispatch","useTranslation","useRecordList","useComponentDidUpdate","useForm","AsyncStatePhase","formsSubscription","DepartmentsAgentsTable","withDefault","key","defaultValue","EditDepartment","data","id","title","reload","allowedToForwardData","t","departmentsRoute","useEeNumberInput","useEeTextInput","useEeTextAreaInput","useDepartmentForwarding","useDepartmentBusinessHours","useSelectForwardDepartment","initialAgents","agents","MaxChats","VisitorInactivity","WaitingQueueMessageInput","AbandonedMessageInput","DepartmentForwarding","DepartmentBusinessHours","AutoCompleteDepartment","agentList","setAgentList","agentsRemoved","setAgentsRemoved","agentsAdded","setAgentsAdded","department","tags","tagsText","setTagsState","chatClosingTags","values","handlers","hasUnsavedChanges","name","email","description","enabled","maxNumberSimultaneousChat","showOnRegistration","showOnOfflineForm","abandonedRoomsCloseCustomMessage","requestTagBeforeClosingChat","offlineMessageChannelName","visitorInactivityTimeoutInSeconds","waitingQueueMessage","departmentsAllowedToForward","departments","map","dep","label","value","_id","fallbackForwardDepartment","handleName","handleEmail","handleDescription","handleEnabled","handleMaxNumberSimultaneousChat","handleShowOnRegistration","handleShowOnOfflineForm","handleAbandonedRoomsCloseCustomMessage","handleRequestTagBeforeClosingChat","handleOfflineMessageChannelName","handleVisitorInactivityTimeoutInSeconds","handleWaitingQueueMessage","handleDepartmentsAllowedToForward","handleFallbackForwardDepartment","itemsList","RoomsList","loadMoreItems","loadMoreRooms","text","phase","roomsPhase","items","roomsItems","itemCount","roomsTotal","handleTagChipClick","tag","filter","_tag","handleTagTextSubmit","state","includes","handleTagTextChange","e","target","saveDepartmentInfo","saveDepartmentAgentsInfoOnEdit","dispatchToastMessage","nameError","setNameError","emailError","setEmailError","tagError","setTagError","length","handleSubmit","preventDefault","error","payload","join","agentListPayload","upsert","agent","current","some","initialAgent","count","order","remove","type","message","push","handleReturn","invalidForm","formId","hasNewAgent","agentsHaveChanged","hasChanges","forEach","existingAgent","find","initial","agentId","LOADING","start","Math","min","i","businessHourId","exportDefault"],"mappings":"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","file":"dynamic/client/views/omnichannel/departments/EditDepartment.js","sourcesContent":["import {\n\tFieldGroup,\n\tField,\n\tTextInput,\n\tChip,\n\tBox,\n\tIcon,\n\tDivider,\n\tToggleSwitch,\n\tTextAreaInput,\n\tButtonGroup,\n\tButton,\n\tPaginatedSelectFiltered,\n} from '@rocket.chat/fuselage';\nimport { useMutableCallback, useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo, useState, useRef } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { validateEmail } from '../../../../lib/emailValidator';\nimport Page from '../../../components/Page';\nimport { useRoomsList } from '../../../components/RoomAutoComplete/hooks/useRoomsList';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod, useEndpoint } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useRecordList } from '../../../hooks/lists/useRecordList';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\nimport { useForm } from '../../../hooks/useForm';\nimport { AsyncStatePhase } from '../../../lib/asyncState';\nimport { formsSubscription } from '../additionalForms';\nimport DepartmentsAgentsTable from './DepartmentsAgentsTable';\n\nfunction withDefault(key, defaultValue) {\n\treturn key || defaultValue;\n}\n\nfunction EditDepartment({ data, id, title, reload, allowedToForwardData }) {\n\tconst t = useTranslation();\n\tconst departmentsRoute = useRoute('omnichannel-departments');\n\n\tconst {\n\t\tuseEeNumberInput = () => {},\n\t\tuseEeTextInput = () => {},\n\t\tuseEeTextAreaInput = () => {},\n\t\tuseDepartmentForwarding = () => {},\n\t\tuseDepartmentBusinessHours = () => {},\n\t\tuseSelectForwardDepartment = () => {},\n\t} = useSubscription(formsSubscription);\n\n\tconst initialAgents = useRef((data && data.agents) || []);\n\n\tconst MaxChats = useEeNumberInput();\n\tconst VisitorInactivity = useEeNumberInput();\n\tconst WaitingQueueMessageInput = useEeTextAreaInput();\n\tconst AbandonedMessageInput = useEeTextInput();\n\tconst DepartmentForwarding = useDepartmentForwarding();\n\tconst DepartmentBusinessHours = useDepartmentBusinessHours();\n\tconst AutoCompleteDepartment = useSelectForwardDepartment();\n\tconst [agentList, setAgentList] = useState([]);\n\tconst [agentsRemoved, setAgentsRemoved] = useState([]);\n\tconst [agentsAdded, setAgentsAdded] = useState([]);\n\n\tconst { department } = data || { department: {} };\n\n\tconst [[tags, tagsText], setTagsState] = useState(() => [department?.chatClosingTags ?? [], '']);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm({\n\t\tname: withDefault(department?.name, ''),\n\t\temail: withDefault(department?.email, ''),\n\t\tdescription: withDefault(department?.description, ''),\n\t\tenabled: !!department?.enabled,\n\t\tmaxNumberSimultaneousChat: department?.maxNumberSimultaneousChat,\n\t\tshowOnRegistration: !!department?.showOnRegistration,\n\t\tshowOnOfflineForm: !!department?.showOnOfflineForm,\n\t\tabandonedRoomsCloseCustomMessage: withDefault(department?.abandonedRoomsCloseCustomMessage, ''),\n\t\trequestTagBeforeClosingChat: !!department?.requestTagBeforeClosingChat,\n\t\tofflineMessageChannelName: withDefault(department?.offlineMessageChannelName, ''),\n\t\tvisitorInactivityTimeoutInSeconds: department?.visitorInactivityTimeoutInSeconds,\n\t\twaitingQueueMessage: withDefault(department?.waitingQueueMessage, ''),\n\t\tdepartmentsAllowedToForward: allowedToForwardData?.departments?.map((dep) => ({ label: dep.name, value: dep._id })) || [],\n\t\tfallbackForwardDepartment: withDefault(department?.fallbackForwardDepartment, ''),\n\t});\n\tconst {\n\t\thandleName,\n\t\thandleEmail,\n\t\thandleDescription,\n\t\thandleEnabled,\n\t\thandleMaxNumberSimultaneousChat,\n\t\thandleShowOnRegistration,\n\t\thandleShowOnOfflineForm,\n\t\thandleAbandonedRoomsCloseCustomMessage,\n\t\thandleRequestTagBeforeClosingChat,\n\t\thandleOfflineMessageChannelName,\n\t\thandleVisitorInactivityTimeoutInSeconds,\n\t\thandleWaitingQueueMessage,\n\t\thandleDepartmentsAllowedToForward,\n\t\thandleFallbackForwardDepartment,\n\t} = handlers;\n\n\tconst {\n\t\tname,\n\t\temail,\n\t\tdescription,\n\t\tenabled,\n\t\tmaxNumberSimultaneousChat,\n\t\tshowOnRegistration,\n\t\tshowOnOfflineForm,\n\t\tabandonedRoomsCloseCustomMessage,\n\t\trequestTagBeforeClosingChat,\n\t\tofflineMessageChannelName,\n\t\tvisitorInactivityTimeoutInSeconds,\n\t\twaitingQueueMessage,\n\t\tdepartmentsAllowedToForward,\n\t\tfallbackForwardDepartment,\n\t} = values;\n\n\tconst { itemsList: RoomsList, loadMoreItems: loadMoreRooms } = useRoomsList(\n\t\tuseMemo(() => ({ text: offlineMessageChannelName }), [offlineMessageChannelName]),\n\t);\n\n\tconst { phase: roomsPhase, items: roomsItems, itemCount: roomsTotal } = useRecordList(RoomsList);\n\n\tconst handleTagChipClick = (tag) => () => {\n\t\tsetTagsState(([tags, tagsText]) => [tags.filter((_tag) => _tag !== tag), tagsText]);\n\t};\n\n\tconst handleTagTextSubmit = useMutableCallback(() => {\n\t\tsetTagsState((state) => {\n\t\t\tconst [tags, tagsText] = state;\n\n\t\t\tif (tags.includes(tagsText)) {\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\treturn [[...tags, tagsText], ''];\n\t\t});\n\t});\n\n\tconst handleTagTextChange = (e) => {\n\t\tsetTagsState(([tags]) => [tags, e.target.value]);\n\t};\n\n\tconst saveDepartmentInfo = useMethod('livechat:saveDepartment');\n\tconst saveDepartmentAgentsInfoOnEdit = useEndpoint('POST', `livechat/department/${id}/agents`);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [nameError, setNameError] = useState();\n\tconst [emailError, setEmailError] = useState();\n\tconst [tagError, setTagError] = useState();\n\n\tuseComponentDidUpdate(() => {\n\t\tsetNameError(!name ? t('The_field_is_required', 'name') : '');\n\t}, [t, name]);\n\tuseComponentDidUpdate(() => {\n\t\tsetEmailError(!email ? t('The_field_is_required', 'email') : '');\n\t}, [t, email]);\n\tuseComponentDidUpdate(() => {\n\t\tsetEmailError(!validateEmail(email) ? t('Validate_email_address') : '');\n\t}, [t, email]);\n\tuseComponentDidUpdate(() => {\n\t\tsetTagError(requestTagBeforeClosingChat && (!tags || tags.length === 0) ? t('The_field_is_required', 'name') : '');\n\t}, [requestTagBeforeClosingChat, t, tags]);\n\n\tconst handleSubmit = useMutableCallback(async (e) => {\n\t\te.preventDefault();\n\t\tlet error = false;\n\t\tif (!name) {\n\t\t\tsetNameError(t('The_field_is_required', 'name'));\n\t\t\terror = true;\n\t\t}\n\t\tif (!email) {\n\t\t\tsetEmailError(t('The_field_is_required', 'email'));\n\t\t\terror = true;\n\t\t}\n\t\tif (!validateEmail(email)) {\n\t\t\tsetEmailError(t('Validate_email_address'));\n\t\t\terror = true;\n\t\t}\n\t\tif (requestTagBeforeClosingChat && (!tags || tags.length === 0)) {\n\t\t\tsetTagError(t('The_field_is_required', 'tags'));\n\t\t\terror = true;\n\t\t}\n\n\t\tif (error) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst payload = {\n\t\t\tenabled,\n\t\t\tname,\n\t\t\tdescription,\n\t\t\tshowOnRegistration,\n\t\t\tshowOnOfflineForm,\n\t\t\trequestTagBeforeClosingChat,\n\t\t\temail,\n\t\t\tchatClosingTags: tags,\n\t\t\tofflineMessageChannelName,\n\t\t\tmaxNumberSimultaneousChat,\n\t\t\tvisitorInactivityTimeoutInSeconds,\n\t\t\tabandonedRoomsCloseCustomMessage,\n\t\t\twaitingQueueMessage,\n\t\t\tdepartmentsAllowedToForward: departmentsAllowedToForward?.map((dep) => dep.value).join(),\n\t\t\tfallbackForwardDepartment: fallbackForwardDepartment.value,\n\t\t};\n\n\t\tconst agentListPayload = {\n\t\t\tupsert: agentList.filter(\n\t\t\t\t(agent) =>\n\t\t\t\t\t!initialAgents.current.some(\n\t\t\t\t\t\t(initialAgent) => initialAgent._id === agent._id && agent.count === initialAgent.count && agent.order === initialAgent.order,\n\t\t\t\t\t),\n\t\t\t),\n\t\t\tremove: initialAgents.current.filter((initialAgent) => !agentList.some((agent) => initialAgent._id === agent._id)),\n\t\t};\n\n\t\ttry {\n\t\t\tif (id) {\n\t\t\t\tawait saveDepartmentInfo(id, payload, []);\n\t\t\t\tif (agentListPayload.upsert.length > 0 || agentListPayload.remove.length > 0) {\n\t\t\t\t\tawait saveDepartmentAgentsInfoOnEdit(agentListPayload);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tawait saveDepartmentInfo(id, payload, agentList);\n\t\t\t}\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\tdepartmentsRoute.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleReturn = useMutableCallback(() => {\n\t\tdepartmentsRoute.push({});\n\t});\n\n\tconst invalidForm =\n\t\t!name || !email || !validateEmail(email) || !hasUnsavedChanges || (requestTagBeforeClosingChat && (!tags || tags.length === 0));\n\n\tconst formId = useUniqueId();\n\n\tconst hasNewAgent = useMemo(() => data.agents.length === agentList.length, [data.agents, agentList]);\n\n\tconst agentsHaveChanged = () => {\n\t\tlet hasChanges = false;\n\t\tif (agentList.length !== initialAgents.current.length) {\n\t\t\thasChanges = true;\n\t\t}\n\n\t\tif (agentsAdded.length > 0 && agentsRemoved.length > 0) {\n\t\t\thasChanges = true;\n\t\t}\n\n\t\tagentList.forEach((agent) => {\n\t\t\tconst existingAgent = initialAgents.current.find((initial) => initial.agentId === agent.agentId);\n\t\t\tif (existingAgent) {\n\t\t\t\tif (agent.count !== existingAgent.count) {\n\t\t\t\t\thasChanges = true;\n\t\t\t\t}\n\t\t\t\tif (agent.order !== existingAgent.order) {\n\t\t\t\t\thasChanges = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn hasChanges;\n\t};\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={title}>\n\t\t\t\t\t<ButtonGroup>\n\t\t\t\t\t\t<Button onClick={handleReturn}>\n\t\t\t\t\t\t\t<Icon name='back' /> {t('Back')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button type='submit' form={formId} primary disabled={invalidForm && hasNewAgent && !(id && agentsHaveChanged())}>\n\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t\t<FieldGroup w='full' alignSelf='center' maxWidth='x600' id={formId} is='form' autoComplete='off' onSubmit={handleSubmit}>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Enabled')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={enabled} onChange={handleEnabled} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Name')}*</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<TextInput flexGrow={1} error={nameError} value={name} onChange={handleName} placeholder={t('Name')} />\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Description')}</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<TextAreaInput flexGrow={1} value={description} onChange={handleDescription} placeholder={t('Description')} />\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Show_on_registration_page')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={showOnRegistration} onChange={handleShowOnRegistration} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Email')}*</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\terror={emailError}\n\t\t\t\t\t\t\t\t\tvalue={email}\n\t\t\t\t\t\t\t\t\taddon={<Icon name='mail' size='x20' />}\n\t\t\t\t\t\t\t\t\tonChange={handleEmail}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Email')}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Show_on_offline_page')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={showOnOfflineForm} onChange={handleShowOnOfflineForm} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Livechat_DepartmentOfflineMessageToChannel')}</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<PaginatedSelectFiltered\n\t\t\t\t\t\t\t\t\tvalue={offlineMessageChannelName}\n\t\t\t\t\t\t\t\t\tonChange={handleOfflineMessageChannelName}\n\t\t\t\t\t\t\t\t\tflexShrink={0}\n\t\t\t\t\t\t\t\t\tfilter={offlineMessageChannelName}\n\t\t\t\t\t\t\t\t\tsetFilter={handleOfflineMessageChannelName}\n\t\t\t\t\t\t\t\t\toptions={roomsItems}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Channel_name')}\n\t\t\t\t\t\t\t\t\tendReached={roomsPhase === AsyncStatePhase.LOADING ? () => {} : (start) => loadMoreRooms(start, Math.min(50, roomsTotal))}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t{MaxChats && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<MaxChats\n\t\t\t\t\t\t\t\t\tvalue={maxNumberSimultaneousChat}\n\t\t\t\t\t\t\t\t\thandler={handleMaxNumberSimultaneousChat}\n\t\t\t\t\t\t\t\t\tlabel={'Max_number_of_chats_per_agent'}\n\t\t\t\t\t\t\t\t\tplaceholder='Max_number_of_chats_per_agent_description'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{VisitorInactivity && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<VisitorInactivity\n\t\t\t\t\t\t\t\t\tvalue={visitorInactivityTimeoutInSeconds}\n\t\t\t\t\t\t\t\t\thandler={handleVisitorInactivityTimeoutInSeconds}\n\t\t\t\t\t\t\t\t\tlabel={'How_long_to_wait_to_consider_visitor_abandonment_in_seconds'}\n\t\t\t\t\t\t\t\t\tplaceholder='Number_in_seconds'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{AbandonedMessageInput && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<AbandonedMessageInput\n\t\t\t\t\t\t\t\t\tvalue={abandonedRoomsCloseCustomMessage}\n\t\t\t\t\t\t\t\t\thandler={handleAbandonedRoomsCloseCustomMessage}\n\t\t\t\t\t\t\t\t\tlabel={'Livechat_abandoned_rooms_closed_custom_message'}\n\t\t\t\t\t\t\t\t\tplaceholder='Enter_a_custom_message'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{WaitingQueueMessageInput && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<WaitingQueueMessageInput value={waitingQueueMessage} handler={handleWaitingQueueMessage} label={'Waiting_queue_message'} />\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{DepartmentForwarding && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<DepartmentForwarding\n\t\t\t\t\t\t\t\t\tdepartmentId={id}\n\t\t\t\t\t\t\t\t\tvalue={departmentsAllowedToForward}\n\t\t\t\t\t\t\t\t\thandler={handleDepartmentsAllowedToForward}\n\t\t\t\t\t\t\t\t\tlabel={'List_of_departments_for_forward'}\n\t\t\t\t\t\t\t\t\tplaceholder='Enter_a_department_name'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{AutoCompleteDepartment && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Fallback_forward_department')}</Field.Label>\n\t\t\t\t\t\t\t\t<AutoCompleteDepartment\n\t\t\t\t\t\t\t\t\thaveNone\n\t\t\t\t\t\t\t\t\texcludeDepartmentId={department?._id}\n\t\t\t\t\t\t\t\t\tvalue={fallbackForwardDepartment}\n\t\t\t\t\t\t\t\t\tonChange={handleFallbackForwardDepartment}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Fallback_forward_department')}\n\t\t\t\t\t\t\t\t\tlabel={t('Fallback_forward_department')}\n\t\t\t\t\t\t\t\t\tonlyMyDepartments\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Request_tag_before_closing_chat')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={requestTagBeforeClosingChat} onChange={handleRequestTagBeforeClosingChat} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t{requestTagBeforeClosingChat && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Field.Label alignSelf='stretch'>{t('Conversation_closing_tags')}*</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<TextInput error={tagError} value={tagsText} onChange={handleTagTextChange} placeholder={t('Enter_a_tag')} />\n\t\t\t\t\t\t\t\t\t<Button mis='x8' title={t('add')} onClick={handleTagTextSubmit}>\n\t\t\t\t\t\t\t\t\t\t{t('Add')}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t\t<Field.Hint>{t('Conversation_closing_tags_description')}</Field.Hint>\n\t\t\t\t\t\t\t\t{tags?.length > 0 && (\n\t\t\t\t\t\t\t\t\t<Field.Row justifyContent='flex-start'>\n\t\t\t\t\t\t\t\t\t\t{tags.map((tag, i) => (\n\t\t\t\t\t\t\t\t\t\t\t<Chip key={i} onClick={handleTagChipClick(tag)} mie='x8'>\n\t\t\t\t\t\t\t\t\t\t\t\t{tag}\n\t\t\t\t\t\t\t\t\t\t\t</Chip>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{DepartmentBusinessHours && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<DepartmentBusinessHours bhId={department?.businessHourId} />\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Divider mb='x16' />\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label mb='x4'>{t('Agents')}:</Field.Label>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='column' height='50vh'>\n\t\t\t\t\t\t\t\t<DepartmentsAgentsTable\n\t\t\t\t\t\t\t\t\tagents={data && data.agents}\n\t\t\t\t\t\t\t\t\tsetAgentListFinal={setAgentList}\n\t\t\t\t\t\t\t\t\tsetAgentsAdded={setAgentsAdded}\n\t\t\t\t\t\t\t\t\tsetAgentsRemoved={setAgentsRemoved}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t</Page>\n\t\t</Page>\n\t);\n}\n\nexport default EditDepartment;\n"]}