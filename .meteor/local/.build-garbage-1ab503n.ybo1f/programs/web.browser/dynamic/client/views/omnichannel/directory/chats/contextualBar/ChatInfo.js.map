{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/directory/chats/contextualBar/ChatInfo.js"],"names":["Box","Margins","Tag","Button","Icon","ButtonGroup","module","link","v","useMutableCallback","Meteor","moment","default","React","useEffect","useState","hasPermission","VerticalBar","useRoute","useToastMessageDispatch","useTranslation","useUserSubscription","useEndpointData","useFormatDateAndTime","useFormatDuration","useOmnichannelRoom","CustomField","Field","Info","Label","AgentField","ContactField","DepartmentField","PriorityField","SourceField","VisitorClientInfo","ChatInfo","id","route","t","formatDateAndTime","value","allCustomFields","phase","stateCustomFields","customFields","setCustomFields","formatDuration","room","ts","tags","closedAt","departmentId","servedBy","metrics","topic","waitingResponse","responseBy","priorityId","livechatData","source","queuedAt","routePath","canViewCustomFields","subscription","hasGlobalEditRoomPermission","hasLocalEditRoomPermission","_id","userId","visitorId","queueStartedAt","dispatchToastMessage","customFieldsAPI","checkIsVisibleAndScopeRoom","key","field","find","visibility","scope","onEditClick","hasEditAccess","type","message","push","tab","context","page","bar","length","map","tag","display","from","fromNow","response","avg","lastMessageTs","Object","keys","exportDefault"],"mappings":"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","file":"dynamic/client/views/omnichannel/directory/chats/contextualBar/ChatInfo.js","sourcesContent":["import { Box, Margins, Tag, Button, Icon, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { Meteor } from 'meteor/meteor';\nimport moment from 'moment';\nimport React, { useEffect, useState } from 'react';\n\nimport { hasPermission } from '../../../../../../app/authorization/client';\nimport VerticalBar from '../../../../../components/VerticalBar';\nimport { useRoute } from '../../../../../contexts/RouterContext';\nimport { useToastMessageDispatch } from '../../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../../contexts/TranslationContext';\nimport { useUserSubscription } from '../../../../../contexts/UserContext';\nimport { useEndpointData } from '../../../../../hooks/useEndpointData';\nimport { useFormatDateAndTime } from '../../../../../hooks/useFormatDateAndTime';\nimport { useFormatDuration } from '../../../../../hooks/useFormatDuration';\nimport { useOmnichannelRoom } from '../../../../room/contexts/RoomContext';\nimport CustomField from '../../../components/CustomField';\nimport Field from '../../../components/Field';\nimport Info from '../../../components/Info';\nimport Label from '../../../components/Label';\nimport AgentField from './AgentField';\nimport ContactField from './ContactField';\nimport DepartmentField from './DepartmentField';\nimport PriorityField from './PriorityField';\nimport SourceField from './SourceField';\nimport VisitorClientInfo from './VisitorClientInfo';\n\n// TODO: Remove moment we are mixing moment and our own formatters :sadface:\nfunction ChatInfo({ id, route }) {\n\tconst t = useTranslation();\n\n\tconst formatDateAndTime = useFormatDateAndTime();\n\tconst { value: allCustomFields, phase: stateCustomFields } = useEndpointData('livechat/custom-fields');\n\tconst [customFields, setCustomFields] = useState([]);\n\tconst formatDuration = useFormatDuration();\n\n\tconst room = useOmnichannelRoom();\n\n\tconst {\n\t\tts,\n\t\ttags,\n\t\tclosedAt,\n\t\tdepartmentId,\n\t\tv,\n\t\tservedBy,\n\t\tmetrics,\n\t\ttopic,\n\t\twaitingResponse,\n\t\tresponseBy,\n\t\tpriorityId,\n\t\tlivechatData,\n\t\tsource,\n\t\tqueuedAt,\n\t} = room || { room: { v: {} } };\n\n\tconst routePath = useRoute(route || 'omnichannel-directory');\n\t// TODO: use hook instead\n\tconst canViewCustomFields = () => hasPermission('view-livechat-room-customfields');\n\tconst subscription = useUserSubscription(id);\n\t// TODO: use hook instead\n\tconst hasGlobalEditRoomPermission = hasPermission('save-others-livechat-room-info');\n\tconst hasLocalEditRoomPermission = servedBy?._id === Meteor.userId();\n\tconst visitorId = v?._id;\n\tconst queueStartedAt = queuedAt || ts;\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tuseEffect(() => {\n\t\tif (allCustomFields) {\n\t\t\tconst { customFields: customFieldsAPI } = allCustomFields;\n\t\t\tsetCustomFields(customFieldsAPI);\n\t\t}\n\t}, [allCustomFields, stateCustomFields]);\n\n\tconst checkIsVisibleAndScopeRoom = (key) => {\n\t\tconst field = customFields.find(({ _id }) => _id === key);\n\t\tif (field && field.visibility === 'visible' && field.scope === 'room') {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\tconst onEditClick = useMutableCallback(() => {\n\t\tconst hasEditAccess = !!subscription || hasLocalEditRoomPermission || hasGlobalEditRoomPermission;\n\t\tif (!hasEditAccess) {\n\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Not_authorized') });\n\t\t}\n\n\t\troutePath.push(\n\t\t\troute\n\t\t\t\t? {\n\t\t\t\t\t\ttab: 'room-info',\n\t\t\t\t\t\tcontext: 'edit',\n\t\t\t\t\t\tid,\n\t\t\t\t  }\n\t\t\t\t: {\n\t\t\t\t\t\tpage: 'chats',\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tbar: 'edit',\n\t\t\t\t  },\n\t\t);\n\t});\n\n\treturn (\n\t\t<>\n\t\t\t<VerticalBar.ScrollableContent p='x24'>\n\t\t\t\t<Margins block='x4'>\n\t\t\t\t\t{source && <SourceField room={room} />}\n\t\t\t\t\t{room && v && <ContactField contact={v} room={room} />}\n\t\t\t\t\t{visitorId && <VisitorClientInfo uid={visitorId} />}\n\t\t\t\t\t{servedBy && <AgentField agent={servedBy} />}\n\t\t\t\t\t{departmentId && <DepartmentField departmentId={departmentId} />}\n\t\t\t\t\t{tags && tags.length > 0 && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Tags')}</Label>\n\t\t\t\t\t\t\t<Info>\n\t\t\t\t\t\t\t\t{tags.map((tag) => (\n\t\t\t\t\t\t\t\t\t<Box key={tag} mie='x4' display='inline'>\n\t\t\t\t\t\t\t\t\t\t<Tag style={{ display: 'inline' }} disabled>\n\t\t\t\t\t\t\t\t\t\t\t{tag}\n\t\t\t\t\t\t\t\t\t\t</Tag>\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{topic && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Topic')}</Label>\n\t\t\t\t\t\t\t<Info>{topic}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{queueStartedAt && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Queue_Time')}</Label>\n\t\t\t\t\t\t\t{servedBy ? (\n\t\t\t\t\t\t\t\t<Info>{moment(servedBy.ts).from(moment(queueStartedAt), true)}</Info>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<Info>{moment(queueStartedAt).fromNow(true)}</Info>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{closedAt && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Chat_Duration')}</Label>\n\t\t\t\t\t\t\t<Info>{moment(closedAt).from(moment(ts), true)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{ts && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Created_at')}</Label>\n\t\t\t\t\t\t\t<Info>{formatDateAndTime(ts)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{closedAt && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Closed_At')}</Label>\n\t\t\t\t\t\t\t<Info>{formatDateAndTime(closedAt)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{servedBy?.ts && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Taken_at')}</Label>\n\t\t\t\t\t\t\t<Info>{formatDateAndTime(servedBy.ts)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{metrics?.response?.avg && formatDuration(metrics.response.avg) && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Avg_response_time')}</Label>\n\t\t\t\t\t\t\t<Info>{formatDuration(metrics.response.avg)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{!waitingResponse && responseBy?.lastMessageTs && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Inactivity_Time')}</Label>\n\t\t\t\t\t\t\t<Info>{moment(responseBy.lastMessageTs).fromNow(true)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{canViewCustomFields() &&\n\t\t\t\t\t\tlivechatData &&\n\t\t\t\t\t\tObject.keys(livechatData).map(\n\t\t\t\t\t\t\t(key) => checkIsVisibleAndScopeRoom(key) && livechatData[key] && <CustomField key={key} id={key} value={livechatData[key]} />,\n\t\t\t\t\t\t)}\n\t\t\t\t\t{priorityId && <PriorityField id={priorityId} />}\n\t\t\t\t</Margins>\n\t\t\t</VerticalBar.ScrollableContent>\n\t\t\t<VerticalBar.Footer>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button onClick={onEditClick}>\n\t\t\t\t\t\t<Icon name='pencil' size='x20' /> {t('Edit')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</VerticalBar.Footer>\n\t\t</>\n\t);\n}\n\nexport default ChatInfo;\n"]}