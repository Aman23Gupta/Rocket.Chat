{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/permissions/PermissionsTable.js"],"names":["Margins","Icon","Tabs","Button","module","link","v","useMutableCallback","React","useState","useCallback","default","GenericTable","Page","usePermission","useRoute","useMethod","useTranslation","FilterComponent","PermissionRow","PermissionsContextBar","RoleHeader","usePermissionsAndRoles","PermissionsTable","t","filter","setFilter","canViewPermission","canViewSettingPermission","defaultType","type","setType","params","setParams","limit","skip","router","grantRole","removeRole","permissionsData","permissions","total","roleList","handleParams","current","itemsPerPage","handlePermissionsTab","handleSettingsTab","handleAdd","push","context","map","_id","name","description","permission","exportDefault"],"mappings":"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","file":"dynamic/client/views/admin/permissions/PermissionsTable.js","sourcesContent":["import { Margins, Icon, Tabs, Button } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, useCallback } from 'react';\n\nimport GenericTable from '../../../components/GenericTable';\nimport Page from '../../../components/Page';\nimport { usePermission } from '../../../contexts/AuthorizationContext';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport FilterComponent from './FilterComponent';\nimport PermissionRow from './PermissionRow';\nimport PermissionsContextBar from './PermissionsContextBar';\nimport RoleHeader from './RoleHeader';\nimport { usePermissionsAndRoles } from './hooks/usePermissionsAndRoles';\n\nconst PermissionsTable = () => {\n\tconst t = useTranslation();\n\tconst [filter, setFilter] = useState('');\n\tconst canViewPermission = usePermission('access-permissions');\n\tconst canViewSettingPermission = usePermission('access-setting-permissions');\n\tconst defaultType = canViewPermission ? 'permissions' : 'settings';\n\tconst [type, setType] = useState(defaultType);\n\tconst [params, setParams] = useState({ limit: 25, skip: 0 });\n\n\tconst router = useRoute('admin-permissions');\n\n\tconst grantRole = useMethod('authorization:addPermissionToRole');\n\tconst removeRole = useMethod('authorization:removeRoleFromPermission');\n\n\tconst permissionsData = usePermissionsAndRoles(type, filter, params.limit, params.skip);\n\n\tconst [permissions, total, roleList] = permissionsData;\n\n\tconst handleParams = useMutableCallback(({ current, itemsPerPage }) => {\n\t\tsetParams({ skip: current, limit: itemsPerPage });\n\t});\n\n\tconst handlePermissionsTab = useMutableCallback(() => {\n\t\tif (type === 'permissions') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('permissions');\n\t});\n\n\tconst handleSettingsTab = useMutableCallback(() => {\n\t\tif (type === 'settings') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('settings');\n\t});\n\n\tconst handleAdd = useMutableCallback(() => {\n\t\trouter.push({\n\t\t\tcontext: 'new',\n\t\t});\n\t});\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Permissions')}>\n\t\t\t\t\t<Button primary onClick={handleAdd} aria-label={t('New')}>\n\t\t\t\t\t\t<Icon name='plus' /> {t('New_role')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Margins blockEnd='x16'>\n\t\t\t\t\t<Tabs>\n\t\t\t\t\t\t<Tabs.Item selected={type === 'permissions'} onClick={handlePermissionsTab} disabled={!canViewPermission}>\n\t\t\t\t\t\t\t{t('Permissions')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t<Tabs.Item selected={type === 'settings'} onClick={handleSettingsTab} disabled={!canViewSettingPermission}>\n\t\t\t\t\t\t\t{t('Settings')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t</Tabs>\n\t\t\t\t</Margins>\n\t\t\t\t<Page.Content mb='neg-x8'>\n\t\t\t\t\t<Margins block='x8'>\n\t\t\t\t\t\t<FilterComponent onChange={setFilter} />\n\t\t\t\t\t\t<GenericTable\n\t\t\t\t\t\t\theader={\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<GenericTable.HeaderCell width='x120'>{t('Name')}</GenericTable.HeaderCell>\n\t\t\t\t\t\t\t\t\t{roleList.map(({ _id, name, description }) => (\n\t\t\t\t\t\t\t\t\t\t<RoleHeader key={_id} _id={_id} name={name} description={description} router={router} />\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttotal={total}\n\t\t\t\t\t\t\tresults={permissions}\n\t\t\t\t\t\t\tparams={params}\n\t\t\t\t\t\t\tsetParams={handleParams}\n\t\t\t\t\t\t\tfixed={false}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{useCallback(\n\t\t\t\t\t\t\t\t(permission) => (\n\t\t\t\t\t\t\t\t\t<PermissionRow\n\t\t\t\t\t\t\t\t\t\tkey={permission._id}\n\t\t\t\t\t\t\t\t\t\tpermission={permission}\n\t\t\t\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\t\t\t\troleList={roleList}\n\t\t\t\t\t\t\t\t\t\tonGrant={grantRole}\n\t\t\t\t\t\t\t\t\t\tonRemove={removeRole}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t[grantRole, removeRole, roleList, t],\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</GenericTable>\n\t\t\t\t\t</Margins>\n\t\t\t\t</Page.Content>\n\t\t\t</Page>\n\t\t\t<PermissionsContextBar />\n\t\t</Page>\n\t);\n};\n\nexport default PermissionsTable;\n"]}