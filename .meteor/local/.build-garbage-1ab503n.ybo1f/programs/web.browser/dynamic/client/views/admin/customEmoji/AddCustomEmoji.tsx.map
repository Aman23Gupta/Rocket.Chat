{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/customEmoji/AddCustomEmoji.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/admin/customEmoji/AddCustomEmoji.tsx","sourcesContent":["import { Box, Button, ButtonGroup, Margins, TextInput, Field, Icon } from '@rocket.chat/fuselage';\nimport React, { useCallback, useState, ReactElement, ChangeEvent } from 'react';\n\nimport VerticalBar from '../../../components/VerticalBar';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useEndpointUpload } from '../../../hooks/useEndpointUpload';\nimport { useFileInput } from '../../../hooks/useFileInput';\n\ntype AddCustomEmojiProps = {\n\tclose: () => void;\n\tonChange: () => void;\n};\n\nconst AddCustomEmoji = ({ close, onChange, ...props }: AddCustomEmojiProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst [name, setName] = useState('');\n\tconst [aliases, setAliases] = useState('');\n\tconst [emojiFile, setEmojiFile] = useState<Blob>();\n\tconst [newEmojiPreview, setNewEmojiPreview] = useState('');\n\tconst [errors, setErrors] = useState({ name: false, emoji: false, aliases: false });\n\n\tconst setEmojiPreview = useCallback(\n\t\tasync (file) => {\n\t\t\tsetEmojiFile(file);\n\t\t\tsetNewEmojiPreview(URL.createObjectURL(file));\n\t\t\tsetErrors((prevState) => ({ ...prevState, emoji: false }));\n\t\t},\n\t\t[setEmojiFile],\n\t);\n\n\tconst saveAction = useEndpointUpload('emoji-custom.create', {}, t('Custom_Emoji_Added_Successfully'));\n\n\tconst handleSave = useCallback(async () => {\n\t\tif (!name) {\n\t\t\treturn setErrors((prevState) => ({ ...prevState, name: true }));\n\t\t}\n\n\t\tif (name === aliases) {\n\t\t\treturn setErrors((prevState) => ({ ...prevState, aliases: true }));\n\t\t}\n\n\t\tif (!emojiFile) {\n\t\t\treturn setErrors((prevState) => ({ ...prevState, emoji: true }));\n\t\t}\n\n\t\tconst formData = new FormData();\n\t\tformData.append('emoji', emojiFile);\n\t\tformData.append('name', name);\n\t\tformData.append('aliases', aliases);\n\t\tconst result = (await saveAction(formData)) as { success: boolean };\n\n\t\tif (result.success) {\n\t\t\tonChange();\n\t\t\tclose();\n\t\t}\n\t}, [emojiFile, name, aliases, saveAction, onChange, close]);\n\n\tconst [clickUpload] = useFileInput(setEmojiPreview, 'emoji');\n\n\tconst handleChangeName = (e: ChangeEvent<HTMLInputElement>): void => {\n\t\tif (e.currentTarget.value !== '') {\n\t\t\tsetErrors((prevState) => ({ ...prevState, name: false }));\n\t\t}\n\n\t\treturn setName(e.currentTarget.value);\n\t};\n\n\tconst handleChangeAliases = (e: ChangeEvent<HTMLInputElement>): void => {\n\t\tif (e.currentTarget.value !== name) {\n\t\t\tsetErrors((prevState) => ({ ...prevState, aliases: false }));\n\t\t}\n\n\t\treturn setAliases(e.currentTarget.value);\n\t};\n\n\treturn (\n\t\t<VerticalBar.ScrollableContent {...props}>\n\t\t\t<Field>\n\t\t\t\t<Field.Label>{t('Name')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={name} onChange={handleChangeName} placeholder={t('Name')} />\n\t\t\t\t</Field.Row>\n\t\t\t\t{errors.name && <Field.Error>{t('error-the-field-is-required', { field: t('Name') })}</Field.Error>}\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<Field.Label>{t('Aliases')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={aliases} onChange={handleChangeAliases} placeholder={t('Aliases')} />\n\t\t\t\t</Field.Row>\n\t\t\t\t{errors.aliases && <Field.Error>{t('Custom_Emoji_Error_Same_Name_And_Alias')}</Field.Error>}\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<Field.Label alignSelf='stretch' display='flex' justifyContent='space-between' alignItems='center'>\n\t\t\t\t\t{t('Custom_Emoji')}\n\t\t\t\t\t<Button square onClick={clickUpload}>\n\t\t\t\t\t\t<Icon name='upload' size='x20' />\n\t\t\t\t\t</Button>\n\t\t\t\t</Field.Label>\n\t\t\t\t{errors.emoji && <Field.Error>{t('error-the-field-is-required', { field: t('Custom_Emoji') })}</Field.Error>}\n\t\t\t\t{newEmojiPreview && (\n\t\t\t\t\t<Box display='flex' flexDirection='row' mi='neg-x4' justifyContent='center'>\n\t\t\t\t\t\t<Margins inline='x4'>\n\t\t\t\t\t\t\t<Box is='img' style={{ objectFit: 'contain' }} w='x120' h='x120' src={newEmojiPreview} />\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<ButtonGroup stretch w='full'>\n\t\t\t\t\t\t<Button onClick={close}>{t('Cancel')}</Button>\n\t\t\t\t\t\t<Button primary onClick={handleSave}>\n\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Field.Row>\n\t\t\t</Field>\n\t\t</VerticalBar.ScrollableContent>\n\t);\n};\n\nexport default AddCustomEmoji;\n"]}