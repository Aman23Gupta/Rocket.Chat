{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/triggers/TriggersForm.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/omnichannel/triggers/TriggersForm.tsx","sourcesContent":["import { Box, Field, TextInput, ToggleSwitch, Select, TextAreaInput, SelectOptions } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { ComponentProps, FC, FormEvent, useMemo, useState } from 'react';\n\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\n\ntype TriggerConditions = {\n\tname: string;\n\tvalue: string | number;\n};\n\ntype TriggerActions = {\n\tname: string;\n\tparams: {\n\t\tsender: string | undefined;\n\t\tmsg: string;\n\t\tname: string;\n\t};\n};\n\ntype TriggersFormProps = {\n\tvalues: {\n\t\tname: string;\n\t\tdescription: string;\n\t\tenabled: boolean;\n\t\trunOnce: boolean;\n\t\t// In the future, this will be an array\n\t\tconditions: TriggerConditions;\n\t\t// In the future, this will be an array\n\t\tactions: TriggerActions;\n\t};\n\thandlers: {\n\t\thandleName: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleDescription: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleEnabled: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleRunOnce: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleConditions: (value: TriggerConditions) => void;\n\t\thandleActions: (value: TriggerActions) => void;\n\t};\n\tclassName?: ComponentProps<typeof Field>['className'];\n};\n\nconst TriggersForm: FC<TriggersFormProps> = ({ values, handlers, className }) => {\n\tconst [nameError, setNameError] = useState('');\n\tconst [msgError, setMsgError] = useState('');\n\tconst t = useTranslation();\n\tconst { name, description, enabled, runOnce, conditions, actions } = values;\n\n\tconst { handleName, handleDescription, handleEnabled, handleRunOnce, handleConditions, handleActions } = handlers;\n\n\tconst { name: conditionName, value: conditionValue } = conditions;\n\n\tconst {\n\t\tparams: { sender: actionSender, msg: actionMsg, name: actionAgentName },\n\t} = actions;\n\n\tconst conditionOptions: SelectOptions = useMemo(\n\t\t() => [\n\t\t\t['page-url', t('Visitor_page_URL')],\n\t\t\t['time-on-site', t('Visitor_time_on_site')],\n\t\t\t['chat-opened-by-visitor', t('Chat_opened_by_visitor')],\n\t\t],\n\t\t[t],\n\t);\n\n\tconst conditionValuePlaceholders: { [conditionName: string]: string } = useMemo(\n\t\t() => ({\n\t\t\t'page-url': t('Enter_a_regex'),\n\t\t\t'time-on-site': t('Time_in_seconds'),\n\t\t}),\n\t\t[t],\n\t);\n\n\tconst conditionValuePlaceholder = conditionValuePlaceholders[conditionName];\n\n\tconst senderOptions: SelectOptions = useMemo(\n\t\t() => [\n\t\t\t['queue', t('Impersonate_next_agent_from_queue')],\n\t\t\t['custom', t('Custom_agent')],\n\t\t],\n\t\t[t],\n\t);\n\n\tconst handleConditionName = useMutableCallback((name) => {\n\t\thandleConditions({\n\t\t\tname,\n\t\t\tvalue: '',\n\t\t});\n\t});\n\n\tconst handleConditionValue = useMutableCallback(({ currentTarget: { value } }) => {\n\t\thandleConditions({\n\t\t\t...conditions,\n\t\t\tvalue,\n\t\t});\n\t});\n\n\tconst handleActionAgentName = useMutableCallback(({ currentTarget: { value: name } }) => {\n\t\thandleActions({\n\t\t\t...actions,\n\t\t\tparams: {\n\t\t\t\t...actions.params,\n\t\t\t\tname,\n\t\t\t},\n\t\t});\n\t});\n\n\tconst handleActionSender = useMutableCallback((sender) => {\n\t\thandleActions({\n\t\t\t...actions,\n\t\t\tparams: {\n\t\t\t\t...actions.params,\n\t\t\t\tsender,\n\t\t\t},\n\t\t});\n\t});\n\n\tconst handleActionMessage = useMutableCallback(({ currentTarget: { value: msg } }) => {\n\t\thandleActions({\n\t\t\t...actions,\n\t\t\tparams: {\n\t\t\t\t...actions.params,\n\t\t\t\tmsg,\n\t\t\t},\n\t\t});\n\t});\n\tuseComponentDidUpdate(() => {\n\t\tsetNameError(!name ? t('The_field_is_required', t('Name')) : '');\n\t}, [t, name]);\n\tuseComponentDidUpdate(() => {\n\t\tsetMsgError(!actionMsg ? t('The_field_is_required', t('Message')) : '');\n\t}, [t, actionMsg]);\n\treturn (\n\t\t<>\n\t\t\t<Field className={className}>\n\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t<Field.Label>{t('Enabled')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<ToggleSwitch checked={enabled} onChange={handleEnabled} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t</Box>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t<Field.Label>{t('Run_only_once_for_each_visitor')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<ToggleSwitch checked={runOnce} onChange={handleRunOnce} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t</Box>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Name')}*</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={name} error={nameError} onChange={handleName} placeholder={t('Name')} />\n\t\t\t\t</Field.Row>\n\t\t\t\t<Field.Error>{nameError}</Field.Error>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Description')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={description} onChange={handleDescription} placeholder={t('Description')} />\n\t\t\t\t</Field.Row>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Condition')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<Select options={conditionOptions} value={conditionName} onChange={handleConditionName} />\n\t\t\t\t</Field.Row>\n\t\t\t\t{conditionValuePlaceholder && (\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput value={conditionValue} onChange={handleConditionValue} placeholder={conditionValuePlaceholder} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t)}\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Action')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={t('Send_a_message')} disabled />\n\t\t\t\t</Field.Row>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<Select options={senderOptions} value={actionSender} onChange={handleActionSender} placeholder={t('Select_an_option')} />\n\t\t\t\t</Field.Row>\n\t\t\t\t{actionSender === 'custom' && (\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput value={actionAgentName} onChange={handleActionAgentName} placeholder={t('Name_of_agent')} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t)}\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextAreaInput rows={3} value={actionMsg} onChange={handleActionMessage} placeholder={`${t('Message')}*`} />\n\t\t\t\t</Field.Row>\n\t\t\t\t<Field.Error>{msgError}</Field.Error>\n\t\t\t</Field>\n\t\t</>\n\t);\n};\n\nexport default TriggersForm;\n"]}