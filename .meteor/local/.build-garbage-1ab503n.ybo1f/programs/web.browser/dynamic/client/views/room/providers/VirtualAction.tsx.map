{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/providers/VirtualAction.tsx"],"names":[],"mappings":";;;;;;;;AAAA,qBAAS,IAAT;AAAwB,MAAM,CAAE,IAAR,CAAQ,OAAR,EAAqB;AAAC;AAAA;AAAA,GAAD;;AAAC;AAAA;AAAA;;AAAD,CAArB,EAAsB,CAAtB;AAMxB,MAAM,UAAU,GAAG;AAClB,GAAC,EAAE,MADe;AAElB,GAAC,EAAE,QAFe;AAGlB,GAAC,EAAE,OAHe;AAIlB,GAAC,EAAE;AAJe,CAAnB;;AAOA,MAAM,QAAQ,GAAI,IAAD,IAAwB;AACxC,QAAM,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,CAAN,CAAxB;;AACA,MAAI,IAAI,CAAC,QAAT,EAAmB;AAClB,WAAO,MAAP;AACA;;AAED,MAAI,KAAK,KAAK,UAAU,CAAC,CAArB,IAA0B,IAAI,CAAC,IAAL,CAAU,MAAV,GAAmB,CAAjD,EAAoD;AACnD,WAAO,iBAAP;AACA;;AAED,SAAO,KAAP;AACA,CAXD;;AAaA,MAAM,aAAa,GAAG,QAUX;AAAA,MAVY;AACtB,gBADsB;AAEtB,QAFsB;AAGtB,UAHsB;AAItB;AAJsB,GAUZ;AACV,QAAM,MAAM,GAAG,OAAO,MAAP,KAAkB,UAAlB,GAA+B,MAAM,CAAC;AAAE;AAAF,GAAD,CAArC,GAAkD,MAAjE;AAEA,QAAM,KAAK,GAAG,QAAQ,CAAC,IAAD,CAAtB;AAEA,QAAM,OAAO,GAAG,MAAM,KAAK,CAAC,MAAM,CAAC,MAAR,IAAmB,UAAU,CAAC,IAAI,CAAC,CAAN,CAAV,IAAsB,MAAM,CAAC,MAAP,CAAc,QAAd,CAAuB,KAAvB,CAA9C,CAAtB;AAEA,iBAAe,CAAC,MAAK;AACpB,gBAAY,CAAE,IAAD,IAA+B;AAC3C,aAAO,IAAI,MAAX,GAAoB,IAAI,CAAC,GAAL,CAAS,EAAT,MAAiB,MAAjB,IAA2B,IAAI,CAAC,GAAL,CAAS,EAAT,EAAa,MAAb,CAA/C,GAAsE,IAAI,CAAC,MAAL,CAAY,EAAZ,CAAtE;AACA,KAFW,CAAZ;AAGA,WAAO,MAAW;AACjB,kBAAY,CAAE,IAAD,IAAgC,IAAI,CAAC,MAAL,CAAY,EAAZ,CAAjC,CAAZ;AACA,KAFD;AAGA,GAPc,EAOZ,CAAC,MAAD,EAAS,OAAT,EAAkB,YAAlB,EAAgC,EAAhC,CAPY,CAAf;AASA,SAAO,IAAP;AACA,CA3BD;;AA1BA,OAAO,aAAP,eAuDe,IAAI,CAAC,aAAD,CAvDnB,E","file":"dynamic/client/views/room/providers/VirtualAction.tsx","sourcesContent":["import { useLayoutEffect, memo } from 'react';\n\nimport { IRoom } from '../../../../definition/IRoom';\nimport { Store } from '../lib/Toolbox/generator';\nimport { ToolboxAction } from '../lib/Toolbox/index';\n\nconst groupsDict = {\n\tl: 'live',\n\td: 'direct',\n\tp: 'group',\n\tc: 'channel',\n};\n\nconst getGroup = (room: IRoom): string => {\n\tconst group = groupsDict[room.t];\n\tif (room.teamMain) {\n\t\treturn 'team';\n\t}\n\n\tif (group === groupsDict.d && room.uids.length > 2) {\n\t\treturn 'direct_multiple';\n\t}\n\n\treturn group;\n};\n\nconst VirtualAction = ({\n\thandleChange,\n\troom,\n\taction,\n\tid,\n}: {\n\tid: string;\n\taction: ToolboxAction;\n\troom: IRoom;\n\thandleChange: Function;\n}): null => {\n\tconst config = typeof action === 'function' ? action({ room }) : action;\n\n\tconst group = getGroup(room);\n\n\tconst visible = config && (!config.groups || (groupsDict[room.t] && config.groups.includes(group as any)));\n\n\tuseLayoutEffect(() => {\n\t\thandleChange((list: Store<ToolboxAction>) => {\n\t\t\tvisible && config ? list.get(id) !== config && list.set(id, config) : list.delete(id);\n\t\t});\n\t\treturn (): void => {\n\t\t\thandleChange((list: Store<ToolboxAction>) => list.delete(id));\n\t\t};\n\t}, [config, visible, handleChange, id]);\n\n\treturn null;\n};\n\nexport default memo(VirtualAction);\n"]}