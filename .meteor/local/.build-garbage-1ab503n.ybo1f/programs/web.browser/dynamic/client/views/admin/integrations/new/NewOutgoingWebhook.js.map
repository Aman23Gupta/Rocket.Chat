{"version":3,"sources":["meteor://ğŸ’»app/client/views/admin/integrations/new/NewOutgoingWebhook.js"],"names":["_extends","module","link","default","v","_objectSpread","_objectWithoutProperties","export","NewOutgoingWebhook","Field","Button","useUniqueId","React","useMemo","useCallback","useRoute","useTranslation","useEndpointAction","useForm","OutgoingWebhookForm","triggerWordsToArray","defaultData","type","enabled","impersonateUser","event","urls","triggerWords","targetRoom","channel","username","name","alias","avatar","emoji","scriptEnabled","script","retryFailedCalls","retryCount","retryDelay","triggerWordAnywhere","runOnEdits","data","onChange","setSaveAction","props","t","router","values","formValues","handlers","formHandlers","token","params","split","saveIntegration","handleSave","result","success","push","id","integration","_id","context","saveButton"],"mappings":"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","file":"dynamic/client/views/admin/integrations/new/NewOutgoingWebhook.js","sourcesContent":["import { Field, Button } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo, useCallback } from 'react';\n\nimport { useRoute } from '../../../../contexts/RouterContext';\nimport { useTranslation } from '../../../../contexts/TranslationContext';\nimport { useEndpointAction } from '../../../../hooks/useEndpointAction';\nimport { useForm } from '../../../../hooks/useForm';\nimport OutgoingWebhookForm from '../OutgoiongWebhookForm';\nimport { triggerWordsToArray } from '../helpers/triggerWords';\n\nconst defaultData = {\n\ttype: 'webhook-outgoing',\n\tenabled: true,\n\timpersonateUser: false,\n\tevent: 'sendMessage',\n\turls: '',\n\ttriggerWords: '',\n\ttargetRoom: '',\n\tchannel: '',\n\tusername: '',\n\tname: '',\n\talias: '',\n\tavatar: '',\n\temoji: '',\n\tscriptEnabled: false,\n\tscript: '',\n\tretryFailedCalls: true,\n\tretryCount: 6,\n\tretryDelay: 'powers-of-ten',\n\ttriggerWordAnywhere: false,\n\trunOnEdits: true,\n};\n\nexport default function NewOutgoingWebhook({ data = defaultData, onChange, setSaveAction, ...props }) {\n\tconst t = useTranslation();\n\tconst router = useRoute('admin-integrations');\n\n\tconst { values: formValues, handlers: formHandlers } = useForm({ ...data, token: useUniqueId() });\n\n\tconst { urls, triggerWords } = formValues;\n\n\tconst params = useMemo(\n\t\t() => ({\n\t\t\t...formValues,\n\t\t\turls: urls.split('\\n'),\n\t\t\ttriggerWords: triggerWordsToArray(triggerWords),\n\t\t}),\n\t\t[formValues, triggerWords, urls],\n\t);\n\tconst saveIntegration = useEndpointAction('POST', 'integrations.create', params, t('Integration_added'));\n\n\tconst handleSave = useCallback(async () => {\n\t\tconst result = await saveIntegration();\n\t\tif (result.success) {\n\t\t\trouter.push({ id: result.integration._id, context: 'edit', type: 'outgoing' });\n\t\t}\n\t}, [saveIntegration, router]);\n\n\tconst saveButton = useMemo(\n\t\t() => (\n\t\t\t<Field>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<Button w='full' mie='none' flexGrow={1} onClick={handleSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Field.Row>\n\t\t\t</Field>\n\t\t),\n\t\t[handleSave, t],\n\t);\n\n\treturn <OutgoingWebhookForm formValues={formValues} formHandlers={formHandlers} append={saveButton} {...props} />;\n}\n"]}