{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/triggers/NewTriggerPage.js"],"names":["_objectSpread","module","link","default","v","_objectWithoutProperties","Button","FieldGroup","Box","Margins","useMutableCallback","React","useMemo","useRoute","useMethod","useToastMessageDispatch","useTranslation","useForm","TriggersForm","NewTriggerPage","onSave","dispatchToastMessage","t","router","save","values","handlers","name","description","enabled","runOnce","conditions","value","actions","params","sender","msg","handleSave","restValues","type","message","push","error","canSave","exportDefault"],"mappings":"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","file":"dynamic/client/views/omnichannel/triggers/NewTriggerPage.js","sourcesContent":["import { Button, FieldGroup, Box, Margins } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo } from 'react';\n\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useForm } from '../../../hooks/useForm';\nimport TriggersForm from './TriggersForm';\n\nconst NewTriggerPage = ({ onSave }) => {\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst router = useRoute('omnichannel-triggers');\n\n\tconst save = useMethod('livechat:saveTrigger');\n\n\tconst { values, handlers } = useForm({\n\t\tname: '',\n\t\tdescription: '',\n\t\tenabled: true,\n\t\trunOnce: false,\n\t\tconditions: {\n\t\t\tname: 'page-url',\n\t\t\tvalue: '',\n\t\t},\n\t\tactions: {\n\t\t\tname: '',\n\t\t\tparams: {\n\t\t\t\tsender: 'queue',\n\t\t\t\tmsg: '',\n\t\t\t\tname: '',\n\t\t\t},\n\t\t},\n\t});\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tconst {\n\t\t\t\tactions: {\n\t\t\t\t\tparams: { sender, msg, name },\n\t\t\t\t},\n\t\t\t\t...restValues\n\t\t\t} = values;\n\t\t\tawait save({\n\t\t\t\t...restValues,\n\t\t\t\tconditions: [values.conditions],\n\t\t\t\tactions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'send-message',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tsender,\n\t\t\t\t\t\t\tmsg,\n\t\t\t\t\t\t\t...(sender === 'custom' && { name }),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\tonSave();\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst {\n\t\tname,\n\t\tactions: {\n\t\t\tparams: { msg },\n\t\t},\n\t} = values;\n\n\tconst canSave = useMemo(() => name && msg, [name, msg]);\n\n\treturn (\n\t\t<>\n\t\t\t<FieldGroup>\n\t\t\t\t<TriggersForm values={values} handlers={handlers} />\n\t\t\t</FieldGroup>\n\t\t\t<Box display='flex' flexDirection='row' justifyContent='space-between' w='full'>\n\t\t\t\t<Margins inlineEnd='x4'>\n\t\t\t\t\t<Button flexGrow={1} primary onClick={handleSave} disabled={!canSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Margins>\n\t\t\t</Box>\n\t\t</>\n\t);\n};\n\nexport default NewTriggerPage;\n"]}