{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/inputs/RoomPickSettingInput.js"],"names":["Box","Field","Flex","Icon","module","link","v","Blaze","Template","React","useRef","useEffect","useLayoutEffect","default","ResetSettingButton","RoomPickSettingInput","_id","label","value","placeholder","readonly","autocomplete","disabled","hasResetButton","onChangeValue","onResetButtonClick","wrapperRef","valueRef","handleRemoveRoomButtonClick","rid","filter","current","view","renderWithData","inputAutocomplete","id","name","class","undefined","readOnly","settings","limit","rules","collection","endpoint","field","template","roomSearch","noMatchTemplate","roomSearchEmpty","matchAll","selector","match","sort","$","on","event","doc","currentTarget","focus","remove","position","map","exportDefault"],"mappings":"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","file":"dynamic/client/views/admin/settings/inputs/RoomPickSettingInput.js","sourcesContent":["import { Box, Field, Flex, Icon } from '@rocket.chat/fuselage';\nimport { Blaze } from 'meteor/blaze';\nimport { Template } from 'meteor/templating';\nimport React, { useRef, useEffect, useLayoutEffect } from 'react';\n\nimport ResetSettingButton from '../ResetSettingButton';\n\nfunction RoomPickSettingInput({\n\t_id,\n\tlabel,\n\tvalue,\n\tplaceholder,\n\treadonly,\n\tautocomplete,\n\tdisabled,\n\thasResetButton,\n\tonChangeValue,\n\tonResetButtonClick,\n}) {\n\tvalue = value || [];\n\n\tconst wrapperRef = useRef();\n\tconst valueRef = useRef(value);\n\n\tconst handleRemoveRoomButtonClick = (rid) => () => {\n\t\tonChangeValue(value.filter(({ _id }) => _id !== rid));\n\t};\n\n\tuseLayoutEffect(() => {\n\t\tvalueRef.current = value;\n\t});\n\n\tuseEffect(() => {\n\t\tconst view = Blaze.renderWithData(\n\t\t\tTemplate.inputAutocomplete,\n\t\t\t{\n\t\t\t\tid: _id,\n\t\t\t\tname: _id,\n\t\t\t\tclass: 'search autocomplete rc-input__element',\n\t\t\t\tautocomplete: autocomplete === false ? 'off' : undefined,\n\t\t\t\treadOnly: readonly,\n\t\t\t\tplaceholder,\n\t\t\t\tdisabled,\n\t\t\t\tsettings: {\n\t\t\t\t\tlimit: 10,\n\t\t\t\t\t// inputDelay: 300\n\t\t\t\t\trules: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// @TODO maybe change this 'collection' and/or template\n\t\t\t\t\t\t\tcollection: 'CachedChannelList',\n\t\t\t\t\t\t\tendpoint: 'rooms.autocomplete.channelAndPrivate',\n\t\t\t\t\t\t\tfield: 'name',\n\t\t\t\t\t\t\ttemplate: Template.roomSearch,\n\t\t\t\t\t\t\tnoMatchTemplate: Template.roomSearchEmpty,\n\t\t\t\t\t\t\tmatchAll: true,\n\t\t\t\t\t\t\tselector: (match) => ({ name: match }),\n\t\t\t\t\t\t\tsort: 'name',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t},\n\t\t\twrapperRef.current,\n\t\t);\n\n\t\t$('.autocomplete', wrapperRef.current).on('autocompleteselect', (event, doc) => {\n\t\t\tconst { current: value } = valueRef;\n\t\t\tonChangeValue([...value.filter(({ _id }) => _id !== doc._id), doc]);\n\t\t\tevent.currentTarget.value = '';\n\t\t\tevent.currentTarget.focus();\n\t\t});\n\n\t\treturn () => {\n\t\t\tBlaze.remove(view);\n\t\t};\n\t}, [_id, autocomplete, disabled, onChangeValue, placeholder, readonly, valueRef]);\n\n\treturn (\n\t\t<>\n\t\t\t<Flex.Container>\n\t\t\t\t<Box>\n\t\t\t\t\t<Field.Label htmlFor={_id} title={_id}>\n\t\t\t\t\t\t{label}\n\t\t\t\t\t</Field.Label>\n\t\t\t\t\t{hasResetButton && <ResetSettingButton data-qa-reset-setting-id={_id} onClick={onResetButtonClick} />}\n\t\t\t\t</Box>\n\t\t\t</Flex.Container>\n\t\t\t<div style={{ position: 'relative' }} ref={wrapperRef} />\n\t\t\t<ul className='selected-rooms'>\n\t\t\t\t{value.map(({ _id, name }) => (\n\t\t\t\t\t<li key={_id} className='remove-room' onClick={handleRemoveRoomButtonClick(_id)}>\n\t\t\t\t\t\t{name} <Icon name='cross' />\n\t\t\t\t\t</li>\n\t\t\t\t))}\n\t\t\t</ul>\n\t\t</>\n\t);\n}\n\nexport default RoomPickSettingInput;\n"]}