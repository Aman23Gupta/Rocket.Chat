{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/users/UserInfoActions.js"],"names":["_objectWithoutProperties","module","link","default","v","_objectSpread","_extends","export","UserInfoActions","ButtonGroup","Menu","Option","React","useCallback","useMemo","ConfirmOwnerChangeWarningModal","GenericModal","usePermission","useSetModal","useRoute","useMethod","useEndpoint","useSetting","useToastMessageDispatch","useTranslation","useActionSpread","UserInfo","username","_id","isActive","isAdmin","onChange","onReload","t","setModal","directRoute","userRoute","dispatchToastMessage","canDirectMessage","canEditOtherUserInfo","canAssignAdminRole","canResetE2EEKey","canResetTOTP","canEditOtherUserActiveStatus","canDeleteUser","enforcePassword","handleClose","handleDeletedUser","push","confirmOwnerChanges","action","modalProps","error","xhr","responseJSON","errorType","shouldChangeOwner","shouldBeRemoved","details","type","message","deleteUserQuery","userId","deleteUserEndpoint","erasureType","deleteUser","confirm","confirmRelinquish","result","success","contentTitle","confirmLabel","confirmDeleteUser","setAdminStatus","changeAdminStatus","resetE2EEKeyRequest","resetTOTPRequest","resetE2EEKey","resetTOTP","confirmResetE2EEKey","confirmResetTOTP","activeStatusQuery","activeStatus","changeActiveStatusMessage","changeActiveStatusRequest","changeActiveStatus","directMessageClick","rid","editUserClick","context","id","options","directMessage","icon","label","editUser","makeAdmin","delete","actions","actionsDefinition","menu","menuOptions","props","mapAction","key","map","filter","Boolean"],"mappings":"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","file":"dynamic/client/views/admin/users/UserInfoActions.js","sourcesContent":["import { ButtonGroup, Menu, Option } from '@rocket.chat/fuselage';\nimport React, { useCallback, useMemo } from 'react';\n\nimport ConfirmOwnerChangeWarningModal from '../../../components/ConfirmOwnerChangeWarningModal';\nimport GenericModal from '../../../components/GenericModal';\nimport { usePermission } from '../../../contexts/AuthorizationContext';\nimport { useSetModal } from '../../../contexts/ModalContext';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod, useEndpoint } from '../../../contexts/ServerContext';\nimport { useSetting } from '../../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useActionSpread } from '../../hooks/useActionSpread';\nimport UserInfo from '../../room/contextualBar/UserInfo';\n\nexport const UserInfoActions = ({ username, _id, isActive, isAdmin, onChange, onReload }) => {\n\tconst t = useTranslation();\n\tconst setModal = useSetModal();\n\n\tconst directRoute = useRoute('direct');\n\tconst userRoute = useRoute('admin-users');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst canDirectMessage = usePermission('create-d');\n\tconst canEditOtherUserInfo = usePermission('edit-other-user-info');\n\tconst canAssignAdminRole = usePermission('assign-admin-role');\n\tconst canResetE2EEKey = usePermission('edit-other-user-e2ee');\n\tconst canResetTOTP = usePermission('edit-other-user-totp');\n\tconst canEditOtherUserActiveStatus = usePermission('edit-other-user-active-status');\n\tconst canDeleteUser = usePermission('delete-user');\n\n\tconst enforcePassword = useSetting('Accounts_TwoFactorAuthentication_Enforce_Password_Fallback');\n\n\tconst handleClose = useCallback(() => {\n\t\tsetModal();\n\t\tonChange();\n\t}, [setModal, onChange]);\n\n\tconst handleDeletedUser = () => {\n\t\tsetModal();\n\t\tuserRoute.push({});\n\t\tonReload();\n\t};\n\n\tconst confirmOwnerChanges =\n\t\t(action, modalProps = {}) =>\n\t\tasync () => {\n\t\t\ttry {\n\t\t\t\treturn await action();\n\t\t\t} catch (error) {\n\t\t\t\tif (error.xhr?.responseJSON?.errorType === 'user-last-owner') {\n\t\t\t\t\tconst { shouldChangeOwner, shouldBeRemoved } = error.xhr.responseJSON.details;\n\t\t\t\t\tsetModal(\n\t\t\t\t\t\t<ConfirmOwnerChangeWarningModal\n\t\t\t\t\t\t\tshouldChangeOwner={shouldChangeOwner}\n\t\t\t\t\t\t\tshouldBeRemoved={shouldBeRemoved}\n\t\t\t\t\t\t\t{...modalProps}\n\t\t\t\t\t\t\tonConfirm={async () => {\n\t\t\t\t\t\t\t\tawait action(true);\n\t\t\t\t\t\t\t\tsetModal();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonCancel={() => {\n\t\t\t\t\t\t\t\tsetModal();\n\t\t\t\t\t\t\t\tonChange();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>,\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\tconst deleteUserQuery = useMemo(() => ({ userId: _id }), [_id]);\n\tconst deleteUserEndpoint = useEndpoint('POST', 'users.delete');\n\n\tconst erasureType = useSetting('Message_ErasureType');\n\n\tconst deleteUser = confirmOwnerChanges(\n\t\tasync (confirm = false) => {\n\t\t\tif (confirm) {\n\t\t\t\tdeleteUserQuery.confirmRelinquish = confirm;\n\t\t\t}\n\n\t\t\tconst result = await deleteUserEndpoint(deleteUserQuery);\n\t\t\tif (result.success) {\n\t\t\t\thandleDeletedUser();\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_deleted') });\n\t\t\t} else {\n\t\t\t\tsetModal();\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tcontentTitle: t(`Delete_User_Warning_${erasureType}`),\n\t\t\tconfirmLabel: t('Delete'),\n\t\t},\n\t);\n\n\tconst confirmDeleteUser = useCallback(() => {\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={deleteUser} onCancel={() => setModal()} confirmText={t('Delete')}>\n\t\t\t\t{t(`Delete_User_Warning_${erasureType}`)}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, [deleteUser, erasureType, setModal, t]);\n\n\tconst setAdminStatus = useMethod('setAdminStatus');\n\tconst changeAdminStatus = useCallback(async () => {\n\t\ttry {\n\t\t\tawait setAdminStatus(_id, !isAdmin);\n\t\t\tconst message = isAdmin ? 'User_is_no_longer_an_admin' : 'User_is_now_an_admin';\n\t\t\tdispatchToastMessage({ type: 'success', message: t(message) });\n\t\t\tonChange();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [_id, dispatchToastMessage, isAdmin, onChange, setAdminStatus, t]);\n\n\tconst resetE2EEKeyRequest = useEndpoint('POST', 'users.resetE2EKey');\n\tconst resetTOTPRequest = useEndpoint('POST', 'users.resetTOTP');\n\tconst resetE2EEKey = useCallback(async () => {\n\t\tsetModal();\n\t\tconst result = await resetE2EEKeyRequest({ userId: _id });\n\n\t\tif (result) {\n\t\t\tsetModal(\n\t\t\t\t<GenericModal variant='success' onClose={handleClose} onConfirm={handleClose}>\n\t\t\t\t\t{t('Users_key_has_been_reset')}\n\t\t\t\t</GenericModal>,\n\t\t\t);\n\t\t}\n\t}, [resetE2EEKeyRequest, setModal, t, _id, handleClose]);\n\n\tconst resetTOTP = useCallback(async () => {\n\t\tsetModal();\n\t\tconst result = await resetTOTPRequest({ userId: _id });\n\n\t\tif (result) {\n\t\t\tsetModal(\n\t\t\t\t<GenericModal variant='success' onClose={handleClose} onConfirm={handleClose}>\n\t\t\t\t\t{t('Users_TOTP_has_been_reset')}\n\t\t\t\t</GenericModal>,\n\t\t\t);\n\t\t}\n\t}, [resetTOTPRequest, setModal, t, _id, handleClose]);\n\n\tconst confirmResetE2EEKey = useCallback(() => {\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={resetE2EEKey} onCancel={() => setModal()} confirmText={t('Reset')}>\n\t\t\t\t{t('E2E_Reset_Other_Key_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, [resetE2EEKey, t, setModal]);\n\n\tconst confirmResetTOTP = useCallback(() => {\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={resetTOTP} onCancel={() => setModal()} confirmText={t('Reset')}>\n\t\t\t\t{t('TOTP_Reset_Other_Key_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, [resetTOTP, t, setModal]);\n\n\tconst activeStatusQuery = useMemo(\n\t\t() => ({\n\t\t\tuserId: _id,\n\t\t\tactiveStatus: !isActive,\n\t\t}),\n\t\t[_id, isActive],\n\t);\n\tconst changeActiveStatusMessage = isActive ? 'User_has_been_deactivated' : 'User_has_been_activated';\n\tconst changeActiveStatusRequest = useEndpoint('POST', 'users.setActiveStatus');\n\n\tconst changeActiveStatus = confirmOwnerChanges(\n\t\tasync (confirm = false) => {\n\t\t\tif (confirm) {\n\t\t\t\tactiveStatusQuery.confirmRelinquish = confirm;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst result = await changeActiveStatusRequest(activeStatusQuery);\n\t\t\t\tif (result.success) {\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t(changeActiveStatusMessage) });\n\t\t\t\t\tonChange();\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tconfirmLabel: t('Yes_deactivate_it'),\n\t\t},\n\t);\n\n\tconst directMessageClick = useCallback(\n\t\t() =>\n\t\t\tdirectRoute.push({\n\t\t\t\trid: username,\n\t\t\t}),\n\t\t[directRoute, username],\n\t);\n\n\tconst editUserClick = useCallback(\n\t\t() =>\n\t\t\tuserRoute.push({\n\t\t\t\tcontext: 'edit',\n\t\t\t\tid: _id,\n\t\t\t}),\n\t\t[_id, userRoute],\n\t);\n\n\tconst options = useMemo(\n\t\t() => ({\n\t\t\t...(canDirectMessage && {\n\t\t\t\tdirectMessage: {\n\t\t\t\t\ticon: 'balloon',\n\t\t\t\t\tlabel: t('Direct_Message'),\n\t\t\t\t\taction: directMessageClick,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(canEditOtherUserInfo && {\n\t\t\t\teditUser: {\n\t\t\t\t\ticon: 'edit',\n\t\t\t\t\tlabel: t('Edit'),\n\t\t\t\t\taction: editUserClick,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(canAssignAdminRole &&\n\t\t\t\tusername && {\n\t\t\t\t\tmakeAdmin: {\n\t\t\t\t\t\ticon: 'key',\n\t\t\t\t\t\tlabel: isAdmin ? t('Remove_Admin') : t('Make_Admin'),\n\t\t\t\t\t\taction: changeAdminStatus,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t...(canResetE2EEKey &&\n\t\t\t\tenforcePassword && {\n\t\t\t\t\tresetE2EEKey: {\n\t\t\t\t\t\ticon: 'key',\n\t\t\t\t\t\tlabel: t('Reset_E2E_Key'),\n\t\t\t\t\t\taction: confirmResetE2EEKey,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t...(canResetTOTP &&\n\t\t\t\tenforcePassword && {\n\t\t\t\t\tresetTOTP: {\n\t\t\t\t\t\ticon: 'key',\n\t\t\t\t\t\tlabel: t('Reset_TOTP'),\n\t\t\t\t\t\taction: confirmResetTOTP,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t...(canDeleteUser && {\n\t\t\t\tdelete: {\n\t\t\t\t\ticon: 'trash',\n\t\t\t\t\tlabel: t('Delete'),\n\t\t\t\t\taction: confirmDeleteUser,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(canEditOtherUserActiveStatus && {\n\t\t\t\tchangeActiveStatus: {\n\t\t\t\t\ticon: 'user',\n\t\t\t\t\tlabel: isActive ? t('Deactivate') : t('Activate'),\n\t\t\t\t\taction: changeActiveStatus,\n\t\t\t\t},\n\t\t\t}),\n\t\t}),\n\t\t[\n\t\t\tt,\n\t\t\tcanDirectMessage,\n\t\t\tdirectMessageClick,\n\t\t\tcanEditOtherUserInfo,\n\t\t\teditUserClick,\n\t\t\tcanAssignAdminRole,\n\t\t\tisAdmin,\n\t\t\tchangeAdminStatus,\n\t\t\tcanDeleteUser,\n\t\t\tconfirmDeleteUser,\n\t\t\tcanEditOtherUserActiveStatus,\n\t\t\tisActive,\n\t\t\tchangeActiveStatus,\n\t\t\tenforcePassword,\n\t\t\tcanResetE2EEKey,\n\t\t\tcanResetTOTP,\n\t\t\tconfirmResetE2EEKey,\n\t\t\tconfirmResetTOTP,\n\t\t\tusername,\n\t\t],\n\t);\n\n\tconst { actions: actionsDefinition, menu: menuOptions } = useActionSpread(options);\n\n\tconst menu = useMemo(() => {\n\t\tif (!menuOptions) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Menu\n\t\t\t\tmi='x4'\n\t\t\t\tplacement='bottom-start'\n\t\t\t\tsmall={false}\n\t\t\t\tghost={false}\n\t\t\t\tflexShrink={0}\n\t\t\t\tkey='menu'\n\t\t\t\trenderItem={({ label: { label, icon }, ...props }) => <Option label={label} title={label} icon={icon} {...props} />}\n\t\t\t\toptions={menuOptions}\n\t\t\t/>\n\t\t);\n\t}, [menuOptions]);\n\n\tconst actions = useMemo(() => {\n\t\tconst mapAction = ([key, { label, icon, action }]) => (\n\t\t\t<UserInfo.Action key={key} title={label} label={label} onClick={action} icon={icon} />\n\t\t);\n\t\treturn [...actionsDefinition.map(mapAction), menu].filter(Boolean);\n\t}, [actionsDefinition, menu]);\n\n\treturn (\n\t\t<ButtonGroup flexGrow={0} justifyContent='center'>\n\t\t\t{actions}\n\t\t</ButtonGroup>\n\t);\n};\n"]}