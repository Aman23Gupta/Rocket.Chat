{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/inputs/AssetSettingInput.js"],"names":["Button","Field","Icon","module","link","v","Random","React","default","useMethod","useToastMessageDispatch","useTranslation","AssetSettingInput","_id","label","value","asset","fileConstraints","t","dispatchToastMessage","setAsset","unsetAsset","handleUpload","event","originalEvent","files","target","length","dataTransfer","Object","values","forEach","blob","type","message","reader","FileReader","readAsBinaryString","onloadend","result","error","handleDeleteButtonClick","url","backgroundImage","id","extensions","join","exportDefault"],"mappings":"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","file":"dynamic/client/views/admin/settings/inputs/AssetSettingInput.js","sourcesContent":["import { Button, Field, Icon } from '@rocket.chat/fuselage';\nimport { Random } from 'meteor/random';\nimport React from 'react';\n\nimport { useMethod } from '../../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../contexts/TranslationContext';\nimport './AssetSettingInput.css';\n\nfunction AssetSettingInput({ _id, label, value = {}, asset, fileConstraints = {} }) {\n\tconst t = useTranslation();\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setAsset = useMethod('setAsset');\n\tconst unsetAsset = useMethod('unsetAsset');\n\n\tconst handleUpload = (event) => {\n\t\tevent = event.originalEvent || event;\n\n\t\tlet { files } = event.target;\n\t\tif (!files || files.length === 0) {\n\t\t\tif (event.dataTransfer && event.dataTransfer.files) {\n\t\t\t\tfiles = event.dataTransfer.files;\n\t\t\t} else {\n\t\t\t\tfiles = [];\n\t\t\t}\n\t\t}\n\n\t\tObject.values(files).forEach((blob) => {\n\t\t\tdispatchToastMessage({ type: 'info', message: t('Uploading_file') });\n\t\t\tconst reader = new FileReader();\n\t\t\treader.readAsBinaryString(blob);\n\t\t\treader.onloadend = async () => {\n\t\t\t\ttry {\n\t\t\t\t\tawait setAsset(reader.result, blob.type, asset);\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('File_uploaded') });\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t};\n\n\tconst handleDeleteButtonClick = async () => {\n\t\ttry {\n\t\t\tawait unsetAsset(asset);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<Field.Label htmlFor={_id} title={_id}>\n\t\t\t\t{label}\n\t\t\t</Field.Label>\n\t\t\t<Field.Row>\n\t\t\t\t<div className='settings-file-preview'>\n\t\t\t\t\t{value.url ? (\n\t\t\t\t\t\t<div className='preview' style={{ backgroundImage: `url(${value.url}?_dc=${Random.id()})` }} />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className='preview no-file background-transparent-light secondary-font-color'>\n\t\t\t\t\t\t\t<Icon name='upload' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t<div className='action'>\n\t\t\t\t\t\t{value.url ? (\n\t\t\t\t\t\t\t<Button onClick={handleDeleteButtonClick}>\n\t\t\t\t\t\t\t\t<Icon name='trash' />\n\t\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div className='rc-button rc-button--primary'>\n\t\t\t\t\t\t\t\t{t('Select_file')}\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclassName='AssetSettingInput__input'\n\t\t\t\t\t\t\t\t\ttype='file'\n\t\t\t\t\t\t\t\t\taccept={fileConstraints.extensions && fileConstraints.extensions.length && `.${fileConstraints.extensions.join(', .')}`}\n\t\t\t\t\t\t\t\t\tonChange={handleUpload}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Field.Row>\n\t\t</>\n\t);\n}\n\nexport default AssetSettingInput;\n"]}