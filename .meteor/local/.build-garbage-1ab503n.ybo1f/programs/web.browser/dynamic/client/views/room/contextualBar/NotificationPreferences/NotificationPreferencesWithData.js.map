{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/NotificationPreferences/NotificationPreferencesWithData.js"],"names":["useMutableCallback","module","link","v","React","memo","default","useCustomSound","useTranslation","useUserSubscription","useEndpointActionExperimental","useForm","useTabBarClose","NotificationPreferences","NotificationPreferencesWithData","rid","t","subscription","customSound","handleClose","saveSettings","values","handlers","hasUnsavedChanges","commit","turnOn","disableNotifications","muteGroupMentions","showCounter","hideUnreadStatus","desktopAlert","desktopPrefOrigin","desktopNotifications","desktopSound","audioNotificationValue","mobileAlert","mobilePrefOrigin","mobilePushNotifications","emailAlert","emailPrefOrigin","emailNotifications","defaultOption","customSoundAsset","Object","entries","list","get","map","value","name","handleOptions","alerts","audio","sound","handlePlaySound","play","handleSaveButton","notifications","roomId","exportDefault"],"mappings":"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","file":"dynamic/client/views/room/contextualBar/NotificationPreferences/NotificationPreferencesWithData.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { memo } from 'react';\n\nimport { useCustomSound } from '../../../../contexts/CustomSoundContext';\nimport { useTranslation } from '../../../../contexts/TranslationContext';\nimport { useUserSubscription } from '../../../../contexts/UserContext';\nimport { useEndpointActionExperimental } from '../../../../hooks/useEndpointActionExperimental';\nimport { useForm } from '../../../../hooks/useForm';\nimport { useTabBarClose } from '../../providers/ToolboxProvider';\nimport NotificationPreferences from './NotificationPreferences';\n\nconst NotificationPreferencesWithData = ({ rid }) => {\n\tconst t = useTranslation();\n\n\tconst subscription = useUserSubscription(rid);\n\n\tconst customSound = useCustomSound();\n\tconst handleClose = useTabBarClose();\n\tconst saveSettings = useEndpointActionExperimental('POST', 'rooms.saveNotification', t('Room_updated_successfully'));\n\n\tconst { values, handlers, hasUnsavedChanges, commit } = useForm({\n\t\tturnOn: !subscription?.disableNotifications,\n\t\tmuteGroupMentions: subscription?.muteGroupMentions,\n\t\tshowCounter: !subscription?.hideUnreadStatus,\n\t\tdesktopAlert: (subscription?.desktopPrefOrigin === 'subscription' && subscription.desktopNotifications) || 'default',\n\t\tdesktopSound: subscription?.audioNotificationValue || 'default',\n\t\tmobileAlert: (subscription?.mobilePrefOrigin === 'subscription' && subscription.mobilePushNotifications) || 'default',\n\t\temailAlert: (subscription?.emailPrefOrigin === 'subscription' && subscription.emailNotifications) || 'default',\n\t});\n\n\tconst defaultOption = [\n\t\t['default', t('Default')],\n\t\t['all', t('All_messages')],\n\t\t['mentions', t('Mentions')],\n\t\t['nothing', t('Nothing')],\n\t];\n\n\tconst customSoundAsset = Object.entries(customSound.list.get()).map((value) => [value[0], value[1].name]);\n\n\tconst handleOptions = {\n\t\talerts: defaultOption,\n\t\taudio: defaultOption,\n\t\tsound: [['none None', t('None')], ['default', t('Default')], ...customSoundAsset],\n\t};\n\n\tconst handlePlaySound = () => customSound.play(values.desktopSound);\n\n\tconst handleSaveButton = useMutableCallback(() => {\n\t\tconst notifications = {};\n\n\t\tnotifications.disableNotifications = values.turnOn ? '0' : '1';\n\t\tnotifications.muteGroupMentions = values.muteGroupMentions ? '1' : '0';\n\t\tnotifications.hideUnreadStatus = values.showCounter ? '0' : '1';\n\t\tnotifications.desktopNotifications = values.desktopAlert;\n\t\tnotifications.audioNotificationValue = values.desktopSound;\n\t\tnotifications.mobilePushNotifications = values.mobileAlert;\n\t\tnotifications.emailNotifications = values.emailAlert;\n\n\t\tsaveSettings({\n\t\t\troomId: rid,\n\t\t\tnotifications,\n\t\t});\n\n\t\tcommit();\n\t});\n\n\treturn (\n\t\t<NotificationPreferences\n\t\t\thandleClose={handleClose}\n\t\t\tformValues={values}\n\t\t\tformHandlers={handlers}\n\t\t\tformHasUnsavedChanges={hasUnsavedChanges}\n\t\t\thandlePlaySound={handlePlaySound}\n\t\t\thandleOptions={handleOptions}\n\t\t\thandleSaveButton={handleSaveButton}\n\t\t/>\n\t);\n};\n\nexport default memo(NotificationPreferencesWithData);\n"]}