{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/inputs/CodeMirror.js"],"names":["_extends","module","link","default","v","_objectWithoutProperties","useMutableCallback","React","useEffect","useRef","useState","defaultGutters","CodeMirror","lineNumbers","lineWrapping","mode","gutters","foldGutter","matchBrackets","autoCloseBrackets","matchTags","showTrailingSpace","highlightSelectionMatches","readOnly","value","valueProp","defaultValue","onChange","props","setValue","textAreaRef","editorRef","handleChange","current","setupCodeMirror","fromTextArea","on","doc","getValue","toTextArea","display","exportDefault"],"mappings":"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","file":"dynamic/client/views/admin/settings/inputs/CodeMirror.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useEffect, useRef, useState } from 'react';\n\nconst defaultGutters = ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'];\n\nfunction CodeMirror({\n\tlineNumbers = true,\n\tlineWrapping = true,\n\tmode = 'javascript',\n\tgutters = defaultGutters,\n\tfoldGutter = true,\n\tmatchBrackets = true,\n\tautoCloseBrackets = true,\n\tmatchTags = true,\n\tshowTrailingSpace = true,\n\thighlightSelectionMatches = true,\n\treadOnly,\n\tvalue: valueProp,\n\tdefaultValue,\n\tonChange,\n\t...props\n}) {\n\tconst [value, setValue] = useState(valueProp || defaultValue);\n\n\tconst textAreaRef = useRef();\n\tconst editorRef = useRef();\n\tconst handleChange = useMutableCallback(onChange);\n\n\tuseEffect(() => {\n\t\tif (editorRef.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst setupCodeMirror = async () => {\n\t\t\tconst CodeMirror = await import('codemirror/lib/codemirror.js');\n\t\t\tawait import('../../../../../app/ui/client/lib/codeMirror/codeMirror');\n\t\t\tawait import('codemirror/lib/codemirror.css');\n\n\t\t\tif (!textAreaRef.current) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditorRef.current = CodeMirror.fromTextArea(textAreaRef.current, {\n\t\t\t\tlineNumbers,\n\t\t\t\tlineWrapping,\n\t\t\t\tmode,\n\t\t\t\tgutters,\n\t\t\t\tfoldGutter,\n\t\t\t\tmatchBrackets,\n\t\t\t\tautoCloseBrackets,\n\t\t\t\tmatchTags,\n\t\t\t\tshowTrailingSpace,\n\t\t\t\thighlightSelectionMatches,\n\t\t\t\treadOnly,\n\t\t\t});\n\n\t\t\teditorRef.current.on('change', (doc) => {\n\t\t\t\tconst value = doc.getValue();\n\t\t\t\tsetValue(value);\n\t\t\t\thandleChange(value);\n\t\t\t});\n\t\t};\n\n\t\tsetupCodeMirror();\n\n\t\treturn () => {\n\t\t\tif (!editorRef.current) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditorRef.current.toTextArea();\n\t\t};\n\t}, [\n\t\tautoCloseBrackets,\n\t\tfoldGutter,\n\t\tgutters,\n\t\thighlightSelectionMatches,\n\t\tlineNumbers,\n\t\tlineWrapping,\n\t\tmatchBrackets,\n\t\tmatchTags,\n\t\tmode,\n\t\thandleChange,\n\t\treadOnly,\n\t\ttextAreaRef,\n\t\tshowTrailingSpace,\n\t]);\n\n\tuseEffect(() => {\n\t\tsetValue(valueProp);\n\t}, [valueProp]);\n\n\tuseEffect(() => {\n\t\tif (!editorRef.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (value !== editorRef.current.getValue()) {\n\t\t\teditorRef.current.setValue(value);\n\t\t}\n\t}, [textAreaRef, value]);\n\n\treturn <textarea readOnly ref={textAreaRef} style={{ display: 'none' }} value={value} {...props} />;\n}\n\nexport default CodeMirror;\n"]}