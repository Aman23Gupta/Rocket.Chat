{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/mailer/MailerRoute.js"],"names":["module","export","default","MailerRoute","React","link","v","NotAuthorizedPage","usePermission","useMethod","useToastMessageDispatch","useTranslation","Mailer","useSendMail","meteorSendMail","t","dispatchToastMessage","fromEmail","subject","emailBody","dryRun","query","error","type","message","length","indexOf","value","canAccessMailer","sendMail"],"mappings":"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","file":"dynamic/client/views/admin/mailer/MailerRoute.js","sourcesContent":["import React from 'react';\n\nimport NotAuthorizedPage from '../../../components/NotAuthorizedPage';\nimport { usePermission } from '../../../contexts/AuthorizationContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { Mailer } from './Mailer';\n\nconst useSendMail = () => {\n\tconst meteorSendMail = useMethod('Mailer.sendMail');\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\treturn ({ fromEmail, subject, emailBody, dryRun, query }) => {\n\t\tif (query.error) {\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: t('Query_is_not_valid_JSON'),\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (fromEmail.error || fromEmail.length < 1) {\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: t('error-invalid-from-address'),\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (emailBody.indexOf('[unsubscribe]') === -1) {\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: t('error-missing-unsubscribe-link'),\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tmeteorSendMail(fromEmail.value, subject, emailBody, dryRun, query.value);\n\t\tdispatchToastMessage({\n\t\t\ttype: 'success',\n\t\t\tmessage: t('The_emails_are_being_sent'),\n\t\t});\n\t};\n};\n\nexport default function MailerRoute() {\n\tconst canAccessMailer = usePermission('access-mailer');\n\tconst sendMail = useSendMail();\n\n\tif (!canAccessMailer) {\n\t\treturn <NotAuthorizedPage />;\n\t}\n\n\treturn <Mailer sendMail={sendMail} />;\n}\n"]}