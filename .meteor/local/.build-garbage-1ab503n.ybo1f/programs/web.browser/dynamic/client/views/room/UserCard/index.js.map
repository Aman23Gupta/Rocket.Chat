{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/UserCard/index.js"],"names":["_extends","module","link","default","v","_objectWithoutProperties","PositionAnimated","AnimatedVisibility","Menu","Option","useMutableCallback","React","useMemo","useRef","Backdrop","LocalTime","UserCard","ReactiveUserStatus","useRolesDescription","useSetting","useTranslation","AsyncStatePhase","useEndpointData","useActionSpread","useUserInfoActions","UserCardWithData","username","onClose","target","open","rid","ref","getRoles","t","showRealNames","query","value","data","phase","state","current","user","loading","LOADING","defaultValue","undefined","_id","name","roles","status","statusText","bio","utcOffset","nickname","avatarETag","map","role","index","etag","localTime","Number","isInteger","customStatus","handleOpen","e","actions","actionsDefinition","menu","menuOptions","label","icon","props","mapAction","key","action","filter","Boolean","UNHIDING","exportDefault"],"mappings":";;;;;;;;;;AAAA,IAAIA,QAAJ;;AAAaC,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACC,SAAO,CAACC,CAAD,EAAG;AAACJ,YAAQ,GAACI,CAAT;AAAW;;AAAvB,CAA7C,EAAsE,CAAtE;;AAAyE,IAAIC,wBAAJ;;AAA6BJ,MAAM,CAACC,IAAP,CAAY,gDAAZ,EAA6D;AAACC,SAAO,CAACC,CAAD,EAAG;AAACC,4BAAwB,GAACD,CAAzB;AAA2B;;AAAvC,CAA7D,EAAsG,CAAtG;AAAnH,IAAIE,gBAAJ,EAAqBC,kBAArB,EAAwCC,IAAxC,EAA6CC,MAA7C;AAAoDR,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACI,kBAAgB,CAACF,CAAD,EAAG;AAACE,oBAAgB,GAACF,CAAjB;AAAmB,GAAxC;;AAAyCG,oBAAkB,CAACH,CAAD,EAAG;AAACG,sBAAkB,GAACH,CAAnB;AAAqB,GAApF;;AAAqFI,MAAI,CAACJ,CAAD,EAAG;AAACI,QAAI,GAACJ,CAAL;AAAO,GAApG;;AAAqGK,QAAM,CAACL,CAAD,EAAG;AAACK,UAAM,GAACL,CAAP;AAAS;;AAAxH,CAApC,EAA8J,CAA9J;AAAiK,IAAIM,kBAAJ;AAAuBT,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACQ,oBAAkB,CAACN,CAAD,EAAG;AAACM,sBAAkB,GAACN,CAAnB;AAAqB;;AAA5C,CAA1C,EAAwF,CAAxF;AAA2F,IAAIO,KAAJ,EAAUC,OAAV,EAAkBC,MAAlB;AAAyBZ,MAAM,CAACC,IAAP,CAAY,OAAZ,EAAoB;AAACC,SAAO,CAACC,CAAD,EAAG;AAACO,SAAK,GAACP,CAAN;AAAQ,GAApB;;AAAqBQ,SAAO,CAACR,CAAD,EAAG;AAACQ,WAAO,GAACR,CAAR;AAAU,GAA1C;;AAA2CS,QAAM,CAACT,CAAD,EAAG;AAACS,UAAM,GAACT,CAAP;AAAS;;AAA9D,CAApB,EAAoF,CAApF;AAAuF,IAAIU,QAAJ;AAAab,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAACY,UAAQ,CAACV,CAAD,EAAG;AAACU,YAAQ,GAACV,CAAT;AAAW;;AAAxB,CAA3C,EAAqE,CAArE;AAAwE,IAAIW,SAAJ;AAAcd,MAAM,CAACC,IAAP,CAAY,+BAAZ,EAA4C;AAACC,SAAO,CAACC,CAAD,EAAG;AAACW,aAAS,GAACX,CAAV;AAAY;;AAAxB,CAA5C,EAAsE,CAAtE;AAAyE,IAAIY,QAAJ;AAAaf,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAACC,SAAO,CAACC,CAAD,EAAG;AAACY,YAAQ,GAACZ,CAAT;AAAW;;AAAvB,CAA3C,EAAoE,CAApE;AAAuE,IAAIa,kBAAJ;AAAuBhB,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACe,oBAAkB,CAACb,CAAD,EAAG;AAACa,sBAAkB,GAACb,CAAnB;AAAqB;;AAA5C,CAA7C,EAA2F,CAA3F;AAA8F,IAAIc,mBAAJ;AAAwBjB,MAAM,CAACC,IAAP,CAAY,wCAAZ,EAAqD;AAACgB,qBAAmB,CAACd,CAAD,EAAG;AAACc,uBAAmB,GAACd,CAApB;AAAsB;;AAA9C,CAArD,EAAqG,CAArG;AAAwG,IAAIe,UAAJ;AAAelB,MAAM,CAACC,IAAP,CAAY,mCAAZ,EAAgD;AAACiB,YAAU,CAACf,CAAD,EAAG;AAACe,cAAU,GAACf,CAAX;AAAa;;AAA5B,CAAhD,EAA8E,CAA9E;AAAiF,IAAIgB,cAAJ;AAAmBnB,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACkB,gBAAc,CAAChB,CAAD,EAAG;AAACgB,kBAAc,GAAChB,CAAf;AAAiB;;AAApC,CAAnD,EAAyF,CAAzF;AAA4F,IAAIiB,eAAJ;AAAoBpB,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAACmB,iBAAe,CAACjB,CAAD,EAAG;AAACiB,mBAAe,GAACjB,CAAhB;AAAkB;;AAAtC,CAA3C,EAAmF,EAAnF;AAAuF,IAAIkB,eAAJ;AAAoBrB,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACoB,iBAAe,CAAClB,CAAD,EAAG;AAACkB,mBAAe,GAAClB,CAAhB;AAAkB;;AAAtC,CAA7C,EAAqF,EAArF;AAAyF,IAAImB,eAAJ;AAAoBtB,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACqB,iBAAe,CAACnB,CAAD,EAAG;AAACmB,mBAAe,GAACnB,CAAhB;AAAkB;;AAAtC,CAA1C,EAAkF,EAAlF;AAAsF,IAAIoB,kBAAJ;AAAuBvB,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACsB,oBAAkB,CAACpB,CAAD,EAAG;AAACoB,sBAAkB,GAACpB,CAAnB;AAAqB;;AAA5C,CAA1C,EAAwF,EAAxF;;AAgBp9C,MAAMqB,gBAAgB,GAAG,QAA8C;AAAA,MAA7C;AAAEC,YAAF;AAAYC,WAAZ;AAAqBC,UAArB;AAA6BC,QAA7B;AAAmCC;AAAnC,GAA6C;AACtE,QAAMC,GAAG,GAAGlB,MAAM,CAACe,MAAD,CAAlB;AAEA,QAAMI,QAAQ,GAAGd,mBAAmB,EAApC;AAEA,QAAMe,CAAC,GAAGb,cAAc,EAAxB;AAEA,QAAMc,aAAa,GAAGf,UAAU,CAAC,kBAAD,CAAhC;AAEA,QAAMgB,KAAK,GAAGvB,OAAO,CAAC,OAAO;AAAEc;AAAF,GAAP,CAAD,EAAuB,CAACA,QAAD,CAAvB,CAArB;AAEA,QAAM;AAAEU,SAAK,EAAEC,IAAT;AAAeC,SAAK,EAAEC;AAAtB,MAAgCjB,eAAe,CAAC,YAAD,EAAea,KAAf,CAArD;AAEAJ,KAAG,CAACS,OAAJ,GAAcZ,MAAd;AAEA,QAAMa,IAAI,GAAG7B,OAAO,CAAC,MAAM;AAC1B,UAAM8B,OAAO,GAAGH,KAAK,KAAKlB,eAAe,CAACsB,OAA1C;AACA,UAAMC,YAAY,GAAGF,OAAO,GAAGG,SAAH,GAAe,IAA3C;AAEA,UAAM;AAAEJ;AAAF,QAAWJ,IAAI,IAAI;AAAEI,UAAI,EAAE;AAAR,KAAzB;AAEA,UAAM;AACLK,SADK;AAELC,UAAI,GAAGrB,QAFF;AAGLsB,WAAK,GAAGJ,YAHH;AAILK,YAAM,GAAG,IAJJ;AAKLC,gBAAU,GAAGD,MALR;AAMLE,SAAG,GAAGP,YAND;AAOLQ,eAAS,GAAGR,YAPP;AAQLS,cARK;AASLC;AATK,QAUFb,IAVJ;AAYA,WAAO;AACNK,SADM;AAENC,UAAI,EAAEb,aAAa,GAAGa,IAAH,GAAUrB,QAFvB;AAGNA,cAHM;AAINsB,WAAK,EAAEA,KAAK,IAAIhB,QAAQ,CAACgB,KAAD,CAAR,CAAgBO,GAAhB,CAAoB,CAACC,IAAD,EAAOC,KAAP,kBAAiB,oBAAC,QAAD,CAAU,IAAV;AAAe,WAAG,EAAEA;AAApB,SAA4BD,IAA5B,CAArC,CAJV;AAKNL,SALM;AAMNO,UAAI,EAAEJ,UANA;AAONK,eAAS,EAAEC,MAAM,CAACC,SAAP,CAAiBT,SAAjB,kBAA+B,oBAAC,SAAD;AAAW,iBAAS,EAAEA;AAAtB,QAPpC;AAQNH,YAAM,eAAE,oBAAC,kBAAD;AAAoB,WAAG,EAAEH;AAAzB,QARF;AASNgB,kBAAY,EAAEZ,UATR;AAUNG;AAVM,KAAP;AAYA,GA9BmB,EA8BjB,CAAChB,IAAD,EAAOX,QAAP,EAAiBQ,aAAjB,EAAgCK,KAAhC,EAAuCP,QAAvC,CA9BiB,CAApB;AAgCA,QAAM+B,UAAU,GAAGrD,kBAAkB,CAAEsD,CAAD,IAAO;AAC5CnC,QAAI,IAAIA,IAAI,CAACmC,CAAD,CAAZ;AACArC,WAAO,IAAIA,OAAO,EAAlB;AACA,GAHoC,CAArC;AAKA,QAAM;AAAEsC,WAAO,EAAEC,iBAAX;AAA8BC,QAAI,EAAEC;AAApC,MAAoD7C,eAAe,CAACC,kBAAkB,CAACiB,IAAD,EAAOX,GAAP,CAAnB,CAAzE;AAEA,QAAMqC,IAAI,GAAGvD,OAAO,CAAC,MAAM;AAC1B,QAAI,CAACwD,WAAL,EAAkB;AACjB,aAAO,IAAP;AACA;;AAED,wBACC,oBAAC,IAAD;AACC,gBAAU,EAAE,CADb;AAEC,QAAE,EAAC,IAFJ;AAGC,SAAG,EAAC,MAHL;AAIC,WAAK,EAAE,KAJR;AAKC,gBAAU,EAAE;AAAA,YAAC;AAAEC,eAAK,EAAE;AAAEA,iBAAF;AAASC;AAAT;AAAT,SAAD;AAAA,YAA8BC,KAA9B;;AAAA,4BAA0C,oBAAC,MAAD,eAAYA,KAAZ;AAAmB,eAAK,EAAEF,KAA1B;AAAiC,cAAI,EAAEC;AAAvC,WAA1C;AAAA,OALb;AAMC,aAAO,EAAEF;AANV,MADD;AAUA,GAfmB,EAejB,CAACA,WAAD,CAfiB,CAApB;AAiBA,QAAMH,OAAO,GAAGrD,OAAO,CAAC,MAAM;AAC7B,UAAM4D,SAAS,GAAG;AAAA,UAAC,CAACC,GAAD,EAAM;AAAEJ,aAAF;AAASC,YAAT;AAAeI;AAAf,OAAN,CAAD;AAAA,0BACjB,oBAAC,QAAD,CAAU,MAAV;AAAiB,WAAG,EAAED,GAAtB;AAA2B,aAAK,EAAEJ,KAAlC;AAAyC,sBAAYA,KAArD;AAA4D,eAAO,EAAEK,MAArE;AAA6E,YAAI,EAAEJ;AAAnF,QADiB;AAAA,KAAlB;;AAIA,WAAO,CAAC,GAAGJ,iBAAiB,CAACX,GAAlB,CAAsBiB,SAAtB,CAAJ,EAAsCL,IAAtC,EAA4CQ,MAA5C,CAAmDC,OAAnD,CAAP;AACA,GANsB,EAMpB,CAACV,iBAAD,EAAoBC,IAApB,CANoB,CAAvB;AAQA,sBACC,uDACC,oBAAC,QAAD;AAAU,MAAE,EAAC,aAAb;AAA2B,WAAO,EAAExC;AAApC,IADD,eAEC,oBAAC,gBAAD;AAAkB,UAAM,EAAEI,GAA1B;AAA+B,aAAS,EAAC,WAAzC;AAAqD,UAAM,EAAE,CAA7D;AAAgE,WAAO,EAAExB,kBAAkB,CAACsE;AAA5F,kBACC,oBAAC,QAAD,eAAcpC,IAAd;AAAoB,WAAO,EAAEd,OAA7B;AAAsC,QAAI,EAAEoC,UAA5C;AAAwD,WAAO,EAAEE,OAAjE;AAA0E,KAAC,EAAEhC;AAA7E,KADD,CAFD,CADD;AAQA,CAvFD;;AAhBAhC,MAAM,CAAC6E,aAAP,CAyGerD,gBAzGf,E","file":"dynamic/client/views/room/UserCard/index.js","sourcesContent":["import { PositionAnimated, AnimatedVisibility, Menu, Option } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo, useRef } from 'react';\n\nimport { Backdrop } from '../../../components/Backdrop';\nimport LocalTime from '../../../components/LocalTime';\nimport UserCard from '../../../components/UserCard';\nimport { ReactiveUserStatus } from '../../../components/UserStatus';\nimport { useRolesDescription } from '../../../contexts/AuthorizationContext';\nimport { useSetting } from '../../../contexts/SettingsContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { AsyncStatePhase } from '../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../hooks/useEndpointData';\nimport { useActionSpread } from '../../hooks/useActionSpread';\nimport { useUserInfoActions } from '../hooks/useUserInfoActions';\n\nconst UserCardWithData = ({ username, onClose, target, open, rid }) => {\n\tconst ref = useRef(target);\n\n\tconst getRoles = useRolesDescription();\n\n\tconst t = useTranslation();\n\n\tconst showRealNames = useSetting('UI_Use_Real_Name');\n\n\tconst query = useMemo(() => ({ username }), [username]);\n\n\tconst { value: data, phase: state } = useEndpointData('users.info', query);\n\n\tref.current = target;\n\n\tconst user = useMemo(() => {\n\t\tconst loading = state === AsyncStatePhase.LOADING;\n\t\tconst defaultValue = loading ? undefined : null;\n\n\t\tconst { user } = data || { user: {} };\n\n\t\tconst {\n\t\t\t_id,\n\t\t\tname = username,\n\t\t\troles = defaultValue,\n\t\t\tstatus = null,\n\t\t\tstatusText = status,\n\t\t\tbio = defaultValue,\n\t\t\tutcOffset = defaultValue,\n\t\t\tnickname,\n\t\t\tavatarETag,\n\t\t} = user;\n\n\t\treturn {\n\t\t\t_id,\n\t\t\tname: showRealNames ? name : username,\n\t\t\tusername,\n\t\t\troles: roles && getRoles(roles).map((role, index) => <UserCard.Role key={index}>{role}</UserCard.Role>),\n\t\t\tbio,\n\t\t\tetag: avatarETag,\n\t\t\tlocalTime: Number.isInteger(utcOffset) && <LocalTime utcOffset={utcOffset} />,\n\t\t\tstatus: <ReactiveUserStatus uid={_id} />,\n\t\t\tcustomStatus: statusText,\n\t\t\tnickname,\n\t\t};\n\t}, [data, username, showRealNames, state, getRoles]);\n\n\tconst handleOpen = useMutableCallback((e) => {\n\t\topen && open(e);\n\t\tonClose && onClose();\n\t});\n\n\tconst { actions: actionsDefinition, menu: menuOptions } = useActionSpread(useUserInfoActions(user, rid));\n\n\tconst menu = useMemo(() => {\n\t\tif (!menuOptions) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Menu\n\t\t\t\tflexShrink={0}\n\t\t\t\tmi='x2'\n\t\t\t\tkey='menu'\n\t\t\t\tghost={false}\n\t\t\t\trenderItem={({ label: { label, icon }, ...props }) => <Option {...props} label={label} icon={icon} />}\n\t\t\t\toptions={menuOptions}\n\t\t\t/>\n\t\t);\n\t}, [menuOptions]);\n\n\tconst actions = useMemo(() => {\n\t\tconst mapAction = ([key, { label, icon, action }]) => (\n\t\t\t<UserCard.Action key={key} title={label} aria-label={label} onClick={action} icon={icon} />\n\t\t);\n\n\t\treturn [...actionsDefinition.map(mapAction), menu].filter(Boolean);\n\t}, [actionsDefinition, menu]);\n\n\treturn (\n\t\t<>\n\t\t\t<Backdrop bg='transparent' onClick={onClose} />\n\t\t\t<PositionAnimated anchor={ref} placement='top-start' margin={8} visible={AnimatedVisibility.UNHIDING}>\n\t\t\t\t<UserCard {...user} onClose={onClose} open={handleOpen} actions={actions} t={t} />\n\t\t\t</PositionAnimated>\n\t\t</>\n\t);\n};\n\nexport default UserCardWithData;\n"]}