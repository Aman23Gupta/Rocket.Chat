{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/apps/hooks/useFilteredApps.ts"],"names":[],"mappings":"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","file":"dynamic/client/views/admin/apps/hooks/useFilteredApps.ts","sourcesContent":["import { useMemo, ContextType } from 'react';\n\nimport { PaginatedResult } from '../../../../../definition/rest/helpers/PaginatedResult';\nimport { AsyncState, AsyncStatePhase } from '../../../../lib/asyncState';\nimport type { AppsContext } from '../AppsContext';\nimport { filterAppByCategories } from '../helpers/filterAppByCategories';\nimport { filterAppByText } from '../helpers/filterAppByText';\nimport { App } from '../types';\n\ntype appsDataType = ContextType<typeof AppsContext>['installedApps'] | ContextType<typeof AppsContext>['marketplaceApps'];\n\nexport const useFilteredApps = ({\n\tappsData,\n\ttext,\n\tsortDirection,\n\tcurrent,\n\tcategories = [],\n\titemsPerPage,\n}: {\n\tappsData: appsDataType;\n\ttext: string;\n\tsortDirection: 'asc' | 'desc';\n\tcurrent: number;\n\titemsPerPage: number;\n\tcategories?: string[];\n}): AsyncState<{ items: App[] } & { shouldShowSearchText: boolean } & PaginatedResult> => {\n\tconst value = useMemo(() => {\n\t\tif (appsData.value === undefined) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst { apps } = appsData.value;\n\n\t\tlet filtered: App[] = apps;\n\t\tlet shouldShowSearchText = true;\n\n\t\tif (Boolean(categories.length) && Boolean(text)) {\n\t\t\tfiltered = apps.filter((app) => filterAppByCategories(app, categories)).filter(({ name }) => filterAppByText(name, text));\n\t\t\tshouldShowSearchText = true;\n\t\t}\n\n\t\tif (Boolean(categories.length) && !text) {\n\t\t\tfiltered = apps.filter((app) => filterAppByCategories(app, categories));\n\t\t\tshouldShowSearchText = false;\n\t\t}\n\n\t\tif (!categories.length && Boolean(text)) {\n\t\t\tfiltered = apps.filter(({ name }) => filterAppByText(name, text));\n\t\t\tshouldShowSearchText = true;\n\t\t}\n\n\t\tif (sortDirection === 'desc') {\n\t\t\tfiltered.reverse();\n\t\t}\n\n\t\tconst total = filtered.length;\n\t\tconst offset = current > total ? 0 : current;\n\t\tconst end = current + itemsPerPage;\n\t\tconst slice = filtered.slice(offset, end);\n\n\t\treturn { items: slice, offset, total: apps.length, count: slice.length, shouldShowSearchText };\n\t}, [categories, current, appsData, itemsPerPage, sortDirection, text]);\n\n\tif (appsData.phase === AsyncStatePhase.RESOLVED) {\n\t\tif (!value) {\n\t\t\tthrow new Error('useFilteredApps - Unexpected state');\n\t\t}\n\t\treturn {\n\t\t\t...appsData,\n\t\t\tvalue,\n\t\t};\n\t}\n\n\tif (appsData.phase === AsyncStatePhase.UPDATING) {\n\t\tthrow new Error('useFilteredApps - Unexpected state');\n\t}\n\n\treturn {\n\t\t...appsData,\n\t\tvalue: undefined,\n\t};\n};\n"]}