{"version":3,"sources":["meteor://ðŸ’»app/client/views/teams/contextualBar/channels/AddExistingModal/AddExistingModal.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/teams/contextualBar/channels/AddExistingModal/AddExistingModal.tsx","sourcesContent":["import { ButtonGroup, Button, Field, Modal } from '@rocket.chat/fuselage';\nimport React, { memo, FC, useCallback } from 'react';\n\nimport { IRoom } from '../../../../../../definition/IRoom';\nimport { Serialized } from '../../../../../../definition/Serialized';\nimport { useEndpoint } from '../../../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../../contexts/TranslationContext';\nimport { useForm } from '../../../../../hooks/useForm';\nimport RoomsInput from './RoomsInput';\n\ntype AddExistingModalState = {\n\tonAdd: any;\n\trooms: Serialized<IRoom>[];\n\tonChange: (value: Serialized<IRoom>, action: 'remove' | undefined) => void;\n\thasUnsavedChanges: boolean;\n};\n\ntype AddExistingModalProps = {\n\tonClose: () => void;\n\tteamId: string;\n\treload: () => void;\n};\n\nconst useAddExistingModalState = (onClose: () => void, teamId: string, reload: () => void): AddExistingModalState => {\n\tconst t = useTranslation();\n\tconst addRoomEndpoint = useEndpoint('POST', 'teams.addRooms');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm({\n\t\trooms: [] as Serialized<IRoom>[],\n\t});\n\n\tconst { rooms } = values as { rooms: Serialized<IRoom>[] };\n\tconst { handleRooms } = handlers;\n\n\tconst onChange = useCallback<AddExistingModalState['onChange']>(\n\t\t(value, action) => {\n\t\t\tif (!action) {\n\t\t\t\tif (rooms.some((current) => current._id === value._id)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn handleRooms([...rooms, value]);\n\t\t\t}\n\n\t\t\thandleRooms(rooms.filter((current: any) => current._id !== value._id));\n\t\t},\n\t\t[handleRooms, rooms],\n\t);\n\n\tconst onAdd = useCallback(async () => {\n\t\ttry {\n\t\t\tawait addRoomEndpoint({\n\t\t\t\trooms: rooms.map((room) => room._id),\n\t\t\t\tteamId,\n\t\t\t});\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Channels_added') });\n\t\t\tonClose();\n\t\t\treload();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [addRoomEndpoint, rooms, teamId, onClose, dispatchToastMessage, t, reload]);\n\n\treturn { onAdd, rooms, onChange, hasUnsavedChanges };\n};\n\nconst AddExistingModal: FC<AddExistingModalProps> = ({ onClose, teamId, reload }) => {\n\tconst t = useTranslation();\n\tconst { rooms, onAdd, onChange, hasUnsavedChanges } = useAddExistingModalState(onClose, teamId, reload);\n\n\tconst isAddButtonEnabled = hasUnsavedChanges;\n\n\treturn (\n\t\t<Modal>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Title>{t('Team_Add_existing_channels')}</Modal.Title>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content>\n\t\t\t\t<Field mbe='x24'>\n\t\t\t\t\t<Field.Label>{t('Channels')}</Field.Label>\n\t\t\t\t\t<RoomsInput value={rooms} onChange={onChange} />\n\t\t\t\t</Field>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button onClick={onClose}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button disabled={!isAddButtonEnabled} onClick={onAdd} primary>\n\t\t\t\t\t\t{t('Add')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default memo(AddExistingModal);\n"]}