{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Discussions/useDiscussionsList.ts"],"names":[],"mappings":";;;;;;;;AAAA,OAAO,MAAP,CAAS;AAAA,oBAAsB,QAAM;AAA5B,CAAT;AAA6C;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAStC,MAAM,kBAAkB,GAAG,CACjC,OADiC,EAEjC,GAFiC,KAO9B;AACH,QAAM,eAAe,GAAG,OAAO,CAAC,MAAM,IAAI,eAAJ,CAAoB,OAApB,CAAP,EAAqC,CAAC,OAAD,CAArC,CAA/B;AAEA,QAAM,cAAc,GAAG,WAAW,CAAC,KAAD,EAAQ,qBAAR,CAAlC;AAEA,QAAM,aAAa,GAAG,WAAW,CAChC,OAAO,KAAP,EAAc,GAAd,KAAqB;AACpB,UAAM;AAAE,cAAF;AAAY;AAAZ,QAAsB,MAAM,cAAc,CAAC;AAChD,YAAM,EAAE,OAAO,CAAC,GADgC;AAEhD,UAAI,EAAE,OAAO,CAAC,IAFkC;AAGhD,YAAM,EAAE,KAHwC;AAIhD,WAAK,EAAE;AAJyC,KAAD,CAAhD;AAOA,WAAO;AACN,WAAK,EAAE,QADD;AAEN,eAAS,EAAE;AAFL,KAAP;AAIA,GAb+B,EAchC,CAAC,cAAD,EAAiB,OAAO,CAAC,GAAzB,EAA8B,OAAO,CAAC,IAAtC,CAdgC,CAAjC;AAiBA,QAAM;AAAE,iBAAF;AAAiB;AAAjB,MAAsC,wBAAwB,CACnE,eADmE,EAEnE,aAFmE,EAGnE,OAAO,CAAC,MAAK;AACZ,UAAM,kBAAkB,GAAG,SAAS,CAAC,oBAAD,CAApC;AACA,WAAO,kBAAkB,GAAG,QAAQ,CAAC,kBAAD,EAAqB,EAArB,CAAX,GAAsC,SAA/D;AACA,GAHM,EAGJ,EAHI,CAH4D,CAApE;AAQA,gCAA8B,CAAC,eAAD,EAAkB,GAAlB,EAAuB,OAAO,CAAC,GAA/B,CAA9B;AAEA,SAAO;AACN,mBADM;AAEN,iBAFM;AAGN;AAHM,GAAP;AAKA,CA5CM,C","file":"dynamic/client/views/room/contextualBar/Discussions/useDiscussionsList.ts","sourcesContent":["import { useCallback, useMemo } from 'react';\n\nimport { IUser } from '../../../../../definition/IUser';\nimport { useEndpoint } from '../../../../contexts/ServerContext';\nimport { useScrollableMessageList } from '../../../../hooks/lists/useScrollableMessageList';\nimport { useStreamUpdatesForMessageList } from '../../../../hooks/lists/useStreamUpdatesForMessageList';\nimport { DiscussionsList, DiscussionsListOptions } from '../../../../lib/lists/DiscussionsList';\nimport { getConfig } from '../../../../lib/utils/getConfig';\n\nexport const useDiscussionsList = (\n\toptions: DiscussionsListOptions,\n\tuid: IUser['_id'],\n): {\n\tdiscussionsList: DiscussionsList;\n\tinitialItemCount: number;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst discussionsList = useMemo(() => new DiscussionsList(options), [options]);\n\n\tconst getDiscussions = useEndpoint('GET', 'chat.getDiscussions');\n\n\tconst fetchMessages = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { messages, total } = await getDiscussions({\n\t\t\t\troomId: options.rid,\n\t\t\t\ttext: options.text,\n\t\t\t\toffset: start,\n\t\t\t\tcount: end,\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\titems: messages,\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[getDiscussions, options.rid, options.text],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableMessageList(\n\t\tdiscussionsList,\n\t\tfetchMessages,\n\t\tuseMemo(() => {\n\t\t\tconst discussionListSize = getConfig('discussionListSize');\n\t\t\treturn discussionListSize ? parseInt(discussionListSize, 10) : undefined;\n\t\t}, []),\n\t);\n\tuseStreamUpdatesForMessageList(discussionsList, uid, options.rid);\n\n\treturn {\n\t\tdiscussionsList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n"]}