{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/users/UserInfo.js"],"names":["_extends","module","link","default","v","_objectSpread","_objectWithoutProperties","export","UserInfoWithData","Box","useMutableCallback","React","useMemo","getUserEmailAddress","FormSkeleton","UserCard","UserStatus","useRolesDescription","useSetting","useTranslation","AsyncStatePhase","useEndpointData","getUserEmailVerified","UserInfo","UserInfoActions","uid","username","onReload","props","t","showRealNames","getRoles","approveManuallyUsers","value","data","phase","state","error","reload","reloadUserInfo","userId","onChange","user","name","roles","status","statusText","bio","utcOffset","lastLogin","nickname","map","role","index","phone","customFields","active","reason","Reason","verified","email","createdAt","customStatus","LOADING","admin","includes","_id"],"mappings":"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","file":"dynamic/client/views/admin/users/UserInfo.js","sourcesContent":["import { Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo } from 'react';\n\nimport { getUserEmailAddress } from '../../../../lib/getUserEmailAddress';\nimport { FormSkeleton } from '../../../components/Skeleton';\nimport UserCard from '../../../components/UserCard';\nimport { UserStatus } from '../../../components/UserStatus';\nimport { useRolesDescription } from '../../../contexts/AuthorizationContext';\nimport { useSetting } from '../../../contexts/SettingsContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { AsyncStatePhase } from '../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../hooks/useEndpointData';\nimport { getUserEmailVerified } from '../../../lib/utils/getUserEmailVerified';\nimport UserInfo from '../../room/contextualBar/UserInfo/UserInfo';\nimport { UserInfoActions } from './UserInfoActions';\n\nexport function UserInfoWithData({ uid, username, onReload, ...props }) {\n\tconst t = useTranslation();\n\tconst showRealNames = useSetting('UI_Use_Real_Name');\n\tconst getRoles = useRolesDescription();\n\tconst approveManuallyUsers = useSetting('Accounts_ManuallyApproveNewUsers');\n\n\tconst {\n\t\tvalue: data,\n\t\tphase: state,\n\t\terror,\n\t\treload: reloadUserInfo,\n\t} = useEndpointData(\n\t\t'users.info',\n\t\tuseMemo(() => ({ ...(uid && { userId: uid }), ...(username && { username }) }), [uid, username]),\n\t);\n\n\tconst onChange = useMutableCallback(() => {\n\t\tonReload();\n\t\treloadUserInfo();\n\t});\n\n\tconst user = useMemo(() => {\n\t\tconst { user } = data || { user: {} };\n\n\t\tconst { name, username, roles = [], status, statusText, bio, utcOffset, lastLogin, nickname } = user;\n\n\t\treturn {\n\t\t\tname,\n\t\t\tusername,\n\t\t\tlastLogin,\n\t\t\tshowRealNames,\n\t\t\troles: roles && getRoles(roles).map((role, index) => <UserCard.Role key={index}>{role}</UserCard.Role>),\n\t\t\tbio,\n\t\t\tphone: user.phone,\n\t\t\tutcOffset,\n\t\t\tcustomFields: {\n\t\t\t\t...user.customFields,\n\t\t\t\t...(approveManuallyUsers && user.active === false && user.reason && { Reason: user.reason }),\n\t\t\t},\n\t\t\tverified: getUserEmailVerified(user),\n\t\t\temail: getUserEmailAddress(user),\n\t\t\tcreatedAt: user.createdAt,\n\t\t\tstatus: <UserStatus status={status} />,\n\t\t\tcustomStatus: statusText,\n\t\t\tnickname,\n\t\t};\n\t}, [approveManuallyUsers, data, showRealNames, getRoles]);\n\n\tif (state === AsyncStatePhase.LOADING) {\n\t\treturn (\n\t\t\t<Box p='x24'>\n\t\t\t\t<FormSkeleton />\n\t\t\t</Box>\n\t\t);\n\t}\n\n\tif (error) {\n\t\treturn <Box mbs='x16'>{t('User_not_found')}</Box>;\n\t}\n\n\tconst admin = data.user?.roles?.includes('admin');\n\n\treturn (\n\t\t<UserInfo\n\t\t\t{...user}\n\t\t\tdata={data.user}\n\t\t\tonChange={onChange}\n\t\t\tactions={\n\t\t\t\tdata &&\n\t\t\t\tdata.user && (\n\t\t\t\t\t<UserInfoActions\n\t\t\t\t\t\tisActive={data.user.active}\n\t\t\t\t\t\tisAdmin={admin}\n\t\t\t\t\t\t_id={data.user._id}\n\t\t\t\t\t\tusername={data.user.username}\n\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\tonReload={onReload}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t}\n\t\t\t{...props}\n\t\t/>\n\t);\n}\n"]}