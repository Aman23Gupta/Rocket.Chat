{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.js"],"names":["useMutableCallback","module","link","v","moment","default","React","useCallback","useEffect","useState","GenericModal","useSetModal","useEndpoint","useToastMessageDispatch","useTranslation","useUserRoom","useForm","PruneMessages","getTimeZoneOffset","offset","Date","getTimezoneOffset","absOffset","Math","abs","floor","slice","initialValues","newerDate","newerTime","olderDate","olderTime","users","inclusive","pinned","discussion","threads","attached","PruneMessagesWithData","rid","tabBar","t","room","type","name","usernames","setModal","onClickClose","close","closeModal","dispatchToastMessage","pruneMessages","fromDate","setFromDate","toDate","setToDate","callOutText","setCallOutText","validateText","setValidateText","counter","setCounter","values","handlers","reset","handleNewerDate","handleNewerTime","handleOlderDate","handleOlderTime","handleUsers","handleInclusive","handlePinned","handleDiscussion","handleThreads","handleAttached","onChangeUsers","value","action","includes","filter","current","handlePrune","limit","count","roomId","latest","oldest","excludePinned","filesOnly","ignoreDiscussion","ignoreThreads","Error","message","error","handleModal","exceptPinned","ifFrom","length","postProcess","sprintf","map","element","join","filesOrMessages","format","isNaN","getTime","date","time","exportDefault"],"mappings":"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","file":"dynamic/client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport moment from 'moment';\nimport React, { useCallback, useEffect, useState } from 'react';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport { useSetModal } from '../../../../contexts/ModalContext';\nimport { useEndpoint } from '../../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../contexts/TranslationContext';\nimport { useUserRoom } from '../../../../contexts/UserContext';\nimport { useForm } from '../../../../hooks/useForm';\nimport PruneMessages from './PruneMessages';\n\nconst getTimeZoneOffset = function () {\n\tconst offset = new Date().getTimezoneOffset();\n\tconst absOffset = Math.abs(offset);\n\treturn `${offset < 0 ? '+' : '-'}${`00${Math.floor(absOffset / 60)}`.slice(-2)}:${`00${absOffset % 60}`.slice(-2)}`;\n};\n\nconst initialValues = {\n\tnewerDate: '',\n\tnewerTime: '',\n\tolderDate: '',\n\tolderTime: '',\n\tusers: [],\n\tinclusive: false,\n\tpinned: false,\n\tdiscussion: false,\n\tthreads: false,\n\tattached: false,\n};\n\nconst PruneMessagesWithData = ({ rid, tabBar }) => {\n\tconst t = useTranslation();\n\tconst room = useUserRoom(rid);\n\troom.type = room.t;\n\troom.rid = rid;\n\tconst { name, usernames } = room;\n\n\tconst setModal = useSetModal();\n\tconst onClickClose = useMutableCallback(() => tabBar && tabBar.close());\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst pruneMessages = useEndpoint('POST', 'rooms.cleanHistory');\n\n\tconst [fromDate, setFromDate] = useState(new Date('0001-01-01T00:00:00Z'));\n\tconst [toDate, setToDate] = useState(new Date('9999-12-31T23:59:59Z'));\n\tconst [callOutText, setCallOutText] = useState();\n\tconst [validateText, setValidateText] = useState();\n\tconst [counter, setCounter] = useState(0);\n\n\tconst { values, handlers, reset } = useForm(initialValues);\n\tconst { newerDate, newerTime, olderDate, olderTime, users, inclusive, pinned, discussion, threads, attached } = values;\n\n\tconst {\n\t\thandleNewerDate,\n\t\thandleNewerTime,\n\t\thandleOlderDate,\n\t\thandleOlderTime,\n\t\thandleUsers,\n\t\thandleInclusive,\n\t\thandlePinned,\n\t\thandleDiscussion,\n\t\thandleThreads,\n\t\thandleAttached,\n\t} = handlers;\n\n\tconst onChangeUsers = useMutableCallback((value, action) => {\n\t\tif (!action) {\n\t\t\tif (users.includes(value)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleUsers([...users, value]);\n\t\t}\n\t\thandleUsers(users.filter((current) => current !== value));\n\t});\n\n\tconst handlePrune = useMutableCallback(async () => {\n\t\tconst limit = 2000;\n\n\t\ttry {\n\t\t\tif (counter === limit) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { count } = await pruneMessages({\n\t\t\t\troomId: rid,\n\t\t\t\tlatest: toDate,\n\t\t\t\toldest: fromDate,\n\t\t\t\tinclusive,\n\t\t\t\tlimit,\n\t\t\t\texcludePinned: pinned,\n\t\t\t\tfilesOnly: attached,\n\t\t\t\tignoreDiscussion: discussion,\n\t\t\t\tignoreThreads: threads,\n\t\t\t\tusers,\n\t\t\t});\n\n\t\t\tsetCounter(count);\n\n\t\t\tif (count < 1) {\n\t\t\t\tthrow new Error(t('No_messages_found_to_prune'));\n\t\t\t}\n\n\t\t\tdispatchToastMessage({ type: 'success', message: `${count} ${t('messages_pruned')}` });\n\t\t\tcloseModal();\n\t\t\treset();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\tcloseModal();\n\t\t}\n\t});\n\n\tconst handleModal = () => {\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onClose={closeModal} onCancel={closeModal} onConfirm={handlePrune} confirmText={t('Yes_prune_them')}>\n\t\t\t\t{t('Prune_Modal')}\n\t\t\t</GenericModal>,\n\t\t);\n\t};\n\n\tuseEffect(() => {\n\t\tif (newerDate) {\n\t\t\tsetFromDate(new Date(`${newerDate}T${newerTime || '00:00'}:00${getTimeZoneOffset()}`));\n\t\t}\n\n\t\tif (olderDate) {\n\t\t\tsetToDate(new Date(`${olderDate}T${olderTime || '24:00'}:00${getTimeZoneOffset()}`));\n\t\t}\n\t}, [newerDate, newerTime, olderDate, olderTime]);\n\n\tuseEffect(() => {\n\t\tconst exceptPinned = pinned ? ` ${t('except_pinned', {})}` : '';\n\t\tconst ifFrom = users.length\n\t\t\t? ` ${t('if_they_are_from', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [users.map((element) => element).join(', ')],\n\t\t\t  })}`\n\t\t\t: '';\n\t\tconst filesOrMessages = t(attached ? 'files' : 'messages', {});\n\n\t\tif (newerDate && olderDate) {\n\t\t\tsetCallOutText(\n\t\t\t\tt('Prune_Warning_between', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(fromDate).format('L LT'), moment(toDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\t\texceptPinned +\n\t\t\t\t\tifFrom,\n\t\t\t);\n\t\t} else if (newerDate) {\n\t\t\tsetCallOutText(\n\t\t\t\tt('Prune_Warning_after', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(fromDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\t\texceptPinned +\n\t\t\t\t\tifFrom,\n\t\t\t);\n\t\t} else if (olderDate) {\n\t\t\tsetCallOutText(\n\t\t\t\tt('Prune_Warning_before', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(toDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\t\texceptPinned +\n\t\t\t\t\tifFrom,\n\t\t\t);\n\t\t} else {\n\t\t\tsetCallOutText(\n\t\t\t\tt('Prune_Warning_all', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name || usernames?.join(' x ')],\n\t\t\t\t}) +\n\t\t\t\t\texceptPinned +\n\t\t\t\t\tifFrom,\n\t\t\t);\n\t\t}\n\n\t\tif (fromDate > toDate) {\n\t\t\treturn setValidateText(\n\t\t\t\tt('Newer_than_may_not_exceed_Older_than', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t\tif (isNaN(fromDate.getTime()) || isNaN(toDate.getTime())) {\n\t\t\treturn setValidateText(\n\t\t\t\tt('error-invalid-date', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tsetValidateText();\n\t}, [newerDate, olderDate, fromDate, toDate, attached, name, t, pinned, users, usernames]);\n\n\treturn (\n\t\t<PruneMessages\n\t\t\tcallOutText={callOutText}\n\t\t\tvalidateText={validateText}\n\t\t\tnewerDateTime={{ date: newerDate, time: newerTime }}\n\t\t\thandleNewerDateTime={{ date: handleNewerDate, time: handleNewerTime }}\n\t\t\tolderDateTime={{ date: olderDate, time: olderTime }}\n\t\t\thandleOlderDateTime={{ date: handleOlderDate, time: handleOlderTime }}\n\t\t\tusers={users}\n\t\t\tinclusive={inclusive}\n\t\t\tpinned={pinned}\n\t\t\tdiscussion={discussion}\n\t\t\tthreads={threads}\n\t\t\tattached={attached}\n\t\t\thandleInclusive={handleInclusive}\n\t\t\thandlePinned={handlePinned}\n\t\t\thandleDiscussion={handleDiscussion}\n\t\t\thandleThreads={handleThreads}\n\t\t\thandleAttached={handleAttached}\n\t\t\tonClickClose={onClickClose}\n\t\t\tonClickPrune={handleModal}\n\t\t\tonChangeUsers={onChangeUsers}\n\t\t/>\n\t);\n};\n\nexport default PruneMessagesWithData;\n"]}