{"version":3,"sources":["meteor://ðŸ’»app/client/components/Omnichannel/modals/TranscriptModal.tsx"],"names":[],"mappings":"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","file":"dynamic/client/components/Omnichannel/modals/TranscriptModal.tsx","sourcesContent":["import { Field, Button, TextInput, Icon, ButtonGroup, Modal } from '@rocket.chat/fuselage';\nimport { useAutoFocus } from '@rocket.chat/fuselage-hooks';\nimport React, { FC, useCallback, useEffect, useState, useMemo } from 'react';\n\nimport { IOmnichannelRoom } from '../../../../definition/IRoom';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\nimport { useForm } from '../../../hooks/useForm';\n\ntype TranscriptModalProps = {\n\temail: string;\n\troom: IOmnichannelRoom;\n\tonRequest: (email: string, subject: string) => void;\n\tonSend?: (email: string, subject: string, token: string) => void;\n\tonCancel: () => void;\n\tonDiscard: () => void;\n};\n\nconst TranscriptModal: FC<TranscriptModalProps> = ({\n\temail: emailDefault = '',\n\troom,\n\tonRequest,\n\tonSend,\n\tonCancel,\n\tonDiscard,\n\t...props\n}) => {\n\tconst t = useTranslation();\n\n\tconst inputRef = useAutoFocus(true);\n\n\tconst { values, handlers } = useForm({\n\t\temail: emailDefault || '',\n\t\tsubject: t('Transcript_of_your_livechat_conversation'),\n\t});\n\n\tconst { email, subject } = values as { email: string; subject: string };\n\tconst { handleEmail, handleSubject } = handlers;\n\tconst [emailError, setEmailError] = useState('');\n\tconst [subjectError, setSubjectError] = useState('');\n\tconst { transcriptRequest } = room;\n\tconst roomOpen = room?.open;\n\tconst token = room?.v?.token;\n\n\tconst handleRequest = useCallback(() => {\n\t\tonRequest(email, subject);\n\t}, [email, onRequest, subject]);\n\n\tconst handleSend = useCallback(() => {\n\t\tonSend && token && onSend(email, subject, token);\n\t}, [email, onSend, subject, token]);\n\n\tconst handleDiscard = useCallback(() => onDiscard(), [onDiscard]);\n\n\tuseComponentDidUpdate(() => {\n\t\tsetEmailError(!email ? t('The_field_is_required', t('Email')) : '');\n\t}, [t, email]);\n\n\tuseComponentDidUpdate(() => {\n\t\tsetSubjectError(!subject ? t('The_field_is_required', t('Subject')) : '');\n\t}, [t, subject]);\n\n\tconst canSave = useMemo(() => !!subject, [subject]);\n\n\tuseEffect(() => {\n\t\tif (transcriptRequest) {\n\t\t\thandleEmail(transcriptRequest.email);\n\t\t\thandleSubject(transcriptRequest.subject);\n\t\t}\n\t});\n\n\treturn (\n\t\t<Modal {...props}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Icon name='mail-arrow-top-right' size={20} />\n\t\t\t\t<Modal.Title>{t('Transcript')}</Modal.Title>\n\t\t\t\t<Modal.Close onClick={onCancel} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content fontScale='p2'>\n\t\t\t\t{!!transcriptRequest && <p>{t('Livechat_transcript_already_requested_warning')}</p>}\n\t\t\t\t<Field marginBlock='x15'>\n\t\t\t\t\t<Field.Label>{t('Email')}*</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\tdisabled={!!emailDefault || !!transcriptRequest}\n\t\t\t\t\t\t\terror={emailError}\n\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\tvalue={email}\n\t\t\t\t\t\t\tonChange={handleEmail}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Field.Row>\n\t\t\t\t\t<Field.Error>{emailError}</Field.Error>\n\t\t\t\t</Field>\n\t\t\t\t<Field marginBlock='x15'>\n\t\t\t\t\t<Field.Label>{t('Subject')}*</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\tref={inputRef}\n\t\t\t\t\t\t\tdisabled={!!transcriptRequest}\n\t\t\t\t\t\t\terror={subjectError}\n\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\tvalue={subject}\n\t\t\t\t\t\t\tonChange={handleSubject}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Field.Row>\n\t\t\t\t\t<Field.Error>{subjectError}</Field.Error>\n\t\t\t\t</Field>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button onClick={onCancel}>{t('Cancel')}</Button>\n\t\t\t\t\t{roomOpen && transcriptRequest ? (\n\t\t\t\t\t\t<Button primary danger onClick={handleDiscard}>\n\t\t\t\t\t\t\t{t('Discard')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Button disabled={!canSave} primary onClick={handleRequest}>\n\t\t\t\t\t\t\t{t('Request')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{!roomOpen && (\n\t\t\t\t\t\t<Button disabled={!canSave} primary onClick={handleSend}>\n\t\t\t\t\t\t\t{t('Send')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</ButtonGroup>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default TranscriptModal;\n"]}