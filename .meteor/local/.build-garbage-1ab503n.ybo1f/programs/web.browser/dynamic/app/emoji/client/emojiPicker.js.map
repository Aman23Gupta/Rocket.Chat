{"version":3,"sources":["meteor://ðŸ’»app/app/emoji/client/emojiPicker.js"],"names":["module","export","updateRecentEmoji","_","link","default","v","ReactiveVar","ReactiveDict","FlowRouter","Template","escapeRegExp","t","EmojiPicker","emoji","ESCAPE","emojiListByCategory","getEmojiElement","image","createEmojiList","category","actualTone","html","Object","values","packages","map","emojiPackage","emojisByCategory","current","tone","toneList","hasOwnProperty","renderPicker","join","set","createPickerEmojis","instance","categories","categoriesList","forEach","key","getEmojisBySearchTerm","searchTerm","currentCategory","searchRegExp","RegExp","replace","list","test","emojiObject","shortnames","alias","undefined","emojiFound","contents","searchValArray","split","indexOf","includes","emojiPicker","helpers","emojiCategories","emojiByCategory","concat","searching","currentSearchTerm","get","length","searchResults","emojiList","currentTone","activeCategory","events","event","stopPropagation","preventDefault","go","close","showCategory","currentTarget","hash","substr","throttle","scrollingToCategory","container","$","scrollTop","last","getCategoryPositions","filter","pos","top","pop","el","id","toggleClass","parseInt","dataset","newTone","_emoji","render","setTone","setCurrentTone","input","val","pickEmoji","keyCode","value","target","trim","cst","onCreated","getTone","recent","getRecent","categoryIndex","splice","base","push","removeClass","addClass"],"mappings":"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","file":"dynamic/app/emoji/client/emojiPicker.js","sourcesContent":["import _ from 'underscore';\nimport { ReactiveVar } from 'meteor/reactive-var';\nimport { ReactiveDict } from 'meteor/reactive-dict';\nimport { FlowRouter } from 'meteor/kadira:flow-router';\nimport { Template } from 'meteor/templating';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\n\nimport '../../theme/client/imports/components/emojiPicker.css';\nimport { t } from '../../utils/client';\nimport { EmojiPicker } from './lib/EmojiPicker';\nimport { emoji } from '../lib/rocketchat';\nimport './emojiPicker.html';\n\nconst ESCAPE = 27;\n\nconst emojiListByCategory = new ReactiveDict('emojiList');\n\nconst getEmojiElement = (emoji, image) =>\n\timage && `<li class=\"emoji-${emoji} emoji-picker-item\" data-emoji=\"${emoji}\" title=\"${emoji}\">${image}</li>`;\n\nconst createEmojiList = (category, actualTone) => {\n\tconst html =\n\t\tObject.values(emoji.packages)\n\t\t\t.map((emojiPackage) => {\n\t\t\t\tif (!emojiPackage.emojisByCategory || !emojiPackage.emojisByCategory[category]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn emojiPackage.emojisByCategory[category]\n\t\t\t\t\t.map((current) => {\n\t\t\t\t\t\tconst tone = actualTone > 0 && emojiPackage.toneList.hasOwnProperty(current) ? `_tone${actualTone}` : '';\n\t\t\t\t\t\treturn getEmojiElement(current, emojiPackage.renderPicker(`:${current}${tone}:`));\n\t\t\t\t\t})\n\t\t\t\t\t.join('');\n\t\t\t})\n\t\t\t.join('') || `<li>${t('No_emojis_found')}</li>`;\n\n\treturn html;\n};\n\nexport function updateRecentEmoji(category) {\n\temojiListByCategory.set(category, createEmojiList(category));\n}\n\nconst createPickerEmojis = (instance) => {\n\tconst categories = instance.categoriesList;\n\tconst actualTone = instance.tone;\n\n\tcategories.forEach((category) => emojiListByCategory.set(category.key, createEmojiList(category.key, actualTone)));\n};\n\nfunction getEmojisBySearchTerm(searchTerm) {\n\tlet html = '<ul class=\"emoji-list\">';\n\tconst t = Template.instance();\n\tconst actualTone = t.tone;\n\n\tEmojiPicker.currentCategory.set('');\n\n\tconst searchRegExp = new RegExp(escapeRegExp(searchTerm.replace(/:/g, '')), 'i');\n\n\tfor (let current in emoji.list) {\n\t\tif (!emoji.list.hasOwnProperty(current)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (searchRegExp.test(current)) {\n\t\t\tconst emojiObject = emoji.list[current];\n\t\t\tconst { emojiPackage, shortnames = [] } = emojiObject;\n\t\t\tlet tone = '';\n\t\t\tcurrent = current.replace(/:/g, '');\n\t\t\tconst alias = shortnames[0] !== undefined ? shortnames[0].replace(/:/g, '') : shortnames[0];\n\n\t\t\tif (actualTone > 0 && emoji.packages[emojiPackage].toneList.hasOwnProperty(emoji)) {\n\t\t\t\ttone = `_tone${actualTone}`;\n\t\t\t}\n\n\t\t\tlet emojiFound = false;\n\n\t\t\tfor (const key in emoji.packages[emojiPackage].emojisByCategory) {\n\t\t\t\tif (emoji.packages[emojiPackage].emojisByCategory.hasOwnProperty(key)) {\n\t\t\t\t\tconst contents = emoji.packages[emojiPackage].emojisByCategory[key];\n\t\t\t\t\tconst searchValArray = alias !== undefined ? alias.replace(/:/g, '').split('_') : alias;\n\t\t\t\t\tif (contents.indexOf(current) !== -1 || (searchValArray !== undefined && searchValArray.includes(searchTerm))) {\n\t\t\t\t\t\temojiFound = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (emojiFound) {\n\t\t\t\tconst image = emoji.packages[emojiPackage].renderPicker(`:${current}${tone}:`);\n\t\t\t\thtml += getEmojiElement(current, image);\n\t\t\t}\n\t\t}\n\t}\n\thtml += '</ul>';\n\n\treturn html;\n}\n\nTemplate.emojiPicker.helpers({\n\temojiCategories() {\n\t\treturn Template.instance().categoriesList;\n\t},\n\temojiByCategory(category) {\n\t\tlet emojisByCategory = [];\n\t\tfor (const emojiPackage in emoji.packages) {\n\t\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\t\tif (emoji.packages[emojiPackage].emojisByCategory.hasOwnProperty(category)) {\n\t\t\t\t\temojisByCategory = emojisByCategory.concat(emoji.packages[emojiPackage].emojisByCategory[category]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn emojisByCategory;\n\t},\n\tsearching() {\n\t\treturn Template.instance().currentSearchTerm.get().length > 0;\n\t},\n\tsearchResults() {\n\t\treturn getEmojisBySearchTerm(Template.instance().currentSearchTerm.get());\n\t},\n\temojiList(category) {\n\t\treturn emojiListByCategory.get(category);\n\t},\n\tcurrentTone() {\n\t\treturn `tone-${Template.instance().tone}`;\n\t},\n\t/**\n\t * Returns true if a given emoji category is active\n\t *\n\t * @param {string} category hash\n\t * @return {boolean} true if active, false otherwise\n\t */\n\tactiveCategory(category) {\n\t\treturn EmojiPicker.currentCategory.get() === category ? 'active' : '';\n\t},\n\t/**\n\t * Returns currently active emoji category hash\n\t *\n\t * @return {string} category hash\n\t */\n\tcurrentCategory() {\n\t\treturn EmojiPicker.currentCategory.get();\n\t},\n});\n\nTemplate.emojiPicker.events({\n\t'click .emoji-picker'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t},\n\t'click .add-custom'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t\tFlowRouter.go('/admin/emoji-custom');\n\t\tEmojiPicker.close();\n\t},\n\t'click .category-link'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tEmojiPicker.showCategory(event.currentTarget.hash.substr(1));\n\n\t\treturn false;\n\t},\n\t'scroll .emojis': _.throttle((event, instance) => {\n\t\tif (EmojiPicker.scrollingToCategory) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst container = instance.$(event.currentTarget);\n\t\tconst scrollTop = container.scrollTop() + 8;\n\n\t\tconst last = EmojiPicker.getCategoryPositions()\n\t\t\t.filter((pos) => pos.top <= scrollTop)\n\t\t\t.pop();\n\n\t\tif (!last) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { el } = last;\n\n\t\tconst category = el.id.replace('emoji-list-category-', '');\n\n\t\tEmojiPicker.currentCategory.set(category);\n\t}, 300),\n\t'click .change-tone > a'(event, instance) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tinstance.$('.tone-selector').toggleClass('show');\n\t},\n\t'click .tone-selector .tone'(event, instance) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tconst tone = parseInt(event.currentTarget.dataset.tone);\n\t\tlet newTone;\n\n\t\tif (tone > 0) {\n\t\t\tnewTone = `_tone${tone}`;\n\t\t} else {\n\t\t\tnewTone = '';\n\t\t}\n\n\t\tfor (const emojiPackage in emoji.packages) {\n\t\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\t\tif (emoji.packages[emojiPackage].hasOwnProperty('toneList')) {\n\t\t\t\t\tfor (const _emoji in emoji.packages[emojiPackage].toneList) {\n\t\t\t\t\t\tif (emoji.packages[emojiPackage].toneList.hasOwnProperty(_emoji)) {\n\t\t\t\t\t\t\t$(`.emoji-${_emoji}`).html(emoji.packages[emojiPackage].render(`:${_emoji}${newTone}:`));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tEmojiPicker.setTone(tone);\n\n\t\tinstance.setCurrentTone(tone);\n\n\t\t$('.tone-selector').toggleClass('show');\n\t},\n\t'click .emoji-list .emoji-picker-item'(event, instance) {\n\t\tevent.stopPropagation();\n\n\t\tconst _emoji = event.currentTarget.dataset.emoji;\n\t\tconst actualTone = instance.tone;\n\t\tlet tone = '';\n\n\t\tfor (const emojiPackage in emoji.packages) {\n\t\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\t\tif (actualTone > 0 && emoji.packages[emojiPackage].toneList.hasOwnProperty(_emoji)) {\n\t\t\t\t\ttone = `_tone${actualTone}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst input = $('.emoji-picker .js-emojipicker-search');\n\t\tif (input) {\n\t\t\tinput.val('');\n\t\t}\n\t\tinstance.currentSearchTerm.set('');\n\n\t\tEmojiPicker.pickEmoji(_emoji + tone);\n\t},\n\t'keyup .js-emojipicker-search, change .js-emojipicker-search'(event, instance) {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif (event.keyCode === ESCAPE) {\n\t\t\treturn EmojiPicker.close();\n\t\t}\n\n\t\tconst value = event.target.value.trim();\n\t\tconst cst = instance.currentSearchTerm;\n\t\tif (value === cst.get()) {\n\t\t\treturn;\n\t\t}\n\t\tcst.set(value);\n\t},\n});\n\nTemplate.emojiPicker.onCreated(function () {\n\tthis.tone = EmojiPicker.getTone();\n\tconst recent = EmojiPicker.getRecent();\n\n\tthis.currentSearchTerm = new ReactiveVar('');\n\n\tthis.categoriesList = [];\n\tfor (const emojiPackage in emoji.packages) {\n\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\tif (emoji.packages[emojiPackage].emojiCategories) {\n\t\t\t\tif (typeof emoji.packages[emojiPackage].categoryIndex !== 'undefined') {\n\t\t\t\t\tthis.categoriesList.splice(emoji.packages[emojiPackage].categoryIndex, 0, ...emoji.packages[emojiPackage].emojiCategories);\n\t\t\t\t} else {\n\t\t\t\t\tthis.categoriesList = this.categoriesList.concat(emoji.packages[emojiPackage].emojiCategories);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trecent.forEach((_emoji) => {\n\t\temoji.packages.base.emojisByCategory.recent.push(_emoji);\n\t});\n\n\tthis.setCurrentTone = (newTone) => {\n\t\t$('.current-tone').removeClass(`tone-${this.tone}`);\n\t\t$('.current-tone').addClass(`tone-${newTone}`);\n\t\tthis.tone = newTone;\n\t};\n\n\tcreatePickerEmojis(this);\n});\n"]}