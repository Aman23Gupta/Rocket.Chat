{"version":3,"sources":["meteor://ðŸ’»app/ee/client/views/admin/engagementDashboard/messages/MessagesSentSection.tsx"],"names":[],"mappings":"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","file":"dynamic/ee/client/views/admin/engagementDashboard/messages/MessagesSentSection.tsx","sourcesContent":["import { ResponsiveBar } from '@nivo/bar';\nimport { Box, Flex, Skeleton } from '@rocket.chat/fuselage';\nimport colors from '@rocket.chat/fuselage-tokens/colors.json';\nimport moment from 'moment';\nimport React, { ReactElement, useMemo } from 'react';\n\nimport CounterSet from '../../../../../../client/components/data/CounterSet';\nimport { useTranslation } from '../../../../../../client/contexts/TranslationContext';\nimport Section from '../Section';\nimport DownloadDataButton from '../data/DownloadDataButton';\nimport PeriodSelector from '../data/PeriodSelector';\nimport { usePeriodLabel } from '../data/usePeriodLabel';\nimport { usePeriodSelectorState } from '../data/usePeriodSelectorState';\nimport { useMessagesSent } from './useMessagesSent';\n\nconst MessagesSentSection = (): ReactElement => {\n\tconst [period, periodSelectorProps] = usePeriodSelectorState('last 7 days', 'last 30 days', 'last 90 days');\n\tconst periodLabel = usePeriodLabel(period);\n\n\tconst t = useTranslation();\n\n\tconst { data } = useMessagesSent({ period });\n\n\tconst [countFromPeriod, variatonFromPeriod, countFromYesterday, variationFromYesterday, values] = useMemo(() => {\n\t\tif (!data) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst values = Array.from({ length: moment(data.end).diff(data.start, 'days') + 1 }, (_, i) => ({\n\t\t\tdate: moment(data.start).add(i, 'days').toISOString(),\n\t\t\tnewMessages: 0,\n\t\t}));\n\n\t\tfor (const { day, messages } of data.days ?? []) {\n\t\t\tconst i = moment(day).diff(data.start, 'days');\n\t\t\tif (i >= 0) {\n\t\t\t\tvalues[i].newMessages += messages;\n\t\t\t}\n\t\t}\n\n\t\treturn [data.period?.count, data.period?.variation, data.yesterday?.count, data.yesterday?.variation, values];\n\t}, [data]);\n\n\treturn (\n\t\t<Section\n\t\t\ttitle={t('Messages_sent')}\n\t\t\tfilter={\n\t\t\t\t<>\n\t\t\t\t\t<PeriodSelector {...periodSelectorProps} />\n\t\t\t\t\t<DownloadDataButton\n\t\t\t\t\t\tattachmentName={`MessagesSentSection_start_${data?.start}_end_${data?.end}`}\n\t\t\t\t\t\theaders={['Date', 'Messages']}\n\t\t\t\t\t\tdataAvailable={!!data}\n\t\t\t\t\t\tdataExtractor={(): unknown[][] | undefined => values?.map(({ date, newMessages }) => [date, newMessages])}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t}\n\t\t>\n\t\t\t<CounterSet\n\t\t\t\tcounters={[\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countFromPeriod ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: variatonFromPeriod ?? 0,\n\t\t\t\t\t\tdescription: periodLabel,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countFromYesterday ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: variationFromYesterday ?? 0,\n\t\t\t\t\t\tdescription: t('Yesterday'),\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t/>\n\t\t\t<Flex.Container>\n\t\t\t\t{values ? (\n\t\t\t\t\t<Box style={{ height: 240 }}>\n\t\t\t\t\t\t<Flex.Item align='stretch' grow={1} shrink={0}>\n\t\t\t\t\t\t\t<Box style={{ position: 'relative' }}>\n\t\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ResponsiveBar\n\t\t\t\t\t\t\t\t\t\tdata={values}\n\t\t\t\t\t\t\t\t\t\tindexBy='date'\n\t\t\t\t\t\t\t\t\t\tkeys={['newMessages']}\n\t\t\t\t\t\t\t\t\t\tgroupMode='grouped'\n\t\t\t\t\t\t\t\t\t\tpadding={0.25}\n\t\t\t\t\t\t\t\t\t\tmargin={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\tbottom: 20,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tcolors={[\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\tcolors.b500,\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\tenableLabel={false}\n\t\t\t\t\t\t\t\t\t\tenableGridY={false}\n\t\t\t\t\t\t\t\t\t\taxisTop={null}\n\t\t\t\t\t\t\t\t\t\taxisRight={null}\n\t\t\t\t\t\t\t\t\t\taxisBottom={\n\t\t\t\t\t\t\t\t\t\t\t(values.length === 7 && {\n\t\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\t\tformat: (date): string => moment(date).format('dddd'),\n\t\t\t\t\t\t\t\t\t\t\t}) ||\n\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\taxisLeft={null}\n\t\t\t\t\t\t\t\t\t\tanimate={true}\n\t\t\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\t\t\tmotionStiffness={90}\n\t\t\t\t\t\t\t\t\t\tmotionDamping={15}\n\t\t\t\t\t\t\t\t\t\ttheme={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\taxis: {\n\t\t\t\t\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill: colors.n600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Inter, -apple-system, system-ui, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Helvetica Neue\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Meiryo UI\", Arial, sans-serif',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: '10px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontStyle: 'normal',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: '0.2px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlineHeight: '12px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\ttooltip: {\n\t\t\t\t\t\t\t\t\t\t\t\tcontainer: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: colors.n900,\n\t\t\t\t\t\t\t\t\t\t\t\t\tboxShadow: '0px 0px 12px rgba(47, 52, 61, 0.12), 0px 0px 2px rgba(47, 52, 61, 0.08)',\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderRadius: 2,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ttooltip={({ value }): ReactElement => (\n\t\t\t\t\t\t\t\t\t\t\t<Box fontScale='p1m' color='alternative'>\n\t\t\t\t\t\t\t\t\t\t\t\t{t('Value_messages', { value })}\n\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Flex.Item>\n\t\t\t\t\t</Box>\n\t\t\t\t) : (\n\t\t\t\t\t<Skeleton variant='rect' height={240} />\n\t\t\t\t)}\n\t\t\t</Flex.Container>\n\t\t</Section>\n\t);\n};\n\nexport default MessagesSentSection;\n"]}