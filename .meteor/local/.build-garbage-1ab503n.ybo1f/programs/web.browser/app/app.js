var require = meteorInstall({"app":{"ui":{"client":{"lib":{"codeMirror":{"codeMirrorComponent.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/codeMirror/codeMirrorComponent.html                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.codeMirrorComponent.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.codeMirrorComponent.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/codeMirror/template.codeMirrorComponent.js                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("CodeMirror");
Template["CodeMirror"] = new Template("Template.CodeMirror", (function() {
  var view = this;
  return HTML.TEXTAREA({
    id: function() {
      return Spacebars.mustache(view.lookup("editorId"));
    },
    name: function() {
      return Spacebars.mustache(view.lookup("editorName"));
    },
    style: "display: none",
    value: function() {
      return Spacebars.mustache(view.lookup("code"));
    }
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"codeMirror.js":[
  "codemirror/addon/fold/brace-fold.js",
  "codemirror/addon/fold/comment-fold.js",
  "codemirror/addon/fold/foldcode.js",
  "codemirror/addon/fold/foldgutter.css",
  "codemirror/addon/fold/foldgutter.js",
  "codemirror/addon/fold/indent-fold.js",
  "codemirror/addon/fold/markdown-fold.js",
  "codemirror/addon/fold/xml-fold.js",
  "codemirror/addon/selection/active-line.js",
  "codemirror/addon/search/search.js",
  "codemirror/addon/search/searchcursor.js",
  "codemirror/addon/dialog/dialog.js",
  "codemirror/addon/dialog/dialog.css",
  "codemirror/addon/mode/overlay.js",
  "codemirror/addon/edit/continuelist.js",
  "codemirror/mode/apl/apl.js",
  "codemirror/mode/asterisk/asterisk.js",
  "codemirror/mode/clike/clike.js",
  "codemirror/mode/clojure/clojure.js",
  "codemirror/mode/cobol/cobol.js",
  "codemirror/mode/commonlisp/commonlisp.js",
  "codemirror/mode/coffeescript/coffeescript.js",
  "codemirror/mode/css/css.js",
  "codemirror/mode/cypher/cypher.js",
  "codemirror/mode/d/d.js",
  "codemirror/mode/diff/diff.js",
  "codemirror/mode/django/django.js",
  "codemirror/mode/dockerfile/dockerfile.js",
  "codemirror/mode/dtd/dtd.js",
  "codemirror/mode/dylan/dylan.js",
  "codemirror/mode/ecl/ecl.js",
  "codemirror/mode/eiffel/eiffel.js",
  "codemirror/mode/erlang/erlang.js",
  "codemirror/mode/fortran/fortran.js",
  "codemirror/mode/gas/gas.js",
  "codemirror/mode/gfm/gfm.js",
  "codemirror/mode/gherkin/gherkin.js",
  "codemirror/mode/go/go.js",
  "codemirror/mode/groovy/groovy.js",
  "codemirror/mode/haml/haml.js",
  "codemirror/mode/haskell/haskell.js",
  "codemirror/mode/haxe/haxe.js",
  "codemirror/mode/htmlembedded/htmlembedded.js",
  "codemirror/mode/htmlmixed/htmlmixed.js",
  "codemirror/mode/http/http.js",
  "codemirror/mode/idl/idl.js",
  "codemirror/mode/javascript/javascript.js",
  "codemirror/mode/jinja2/jinja2.js",
  "codemirror/mode/julia/julia.js",
  "codemirror/mode/livescript/livescript.js",
  "codemirror/mode/lua/lua.js",
  "codemirror/mode/markdown/markdown.js",
  "codemirror/mode/mirc/mirc.js",
  "codemirror/mode/mllike/mllike.js",
  "codemirror/mode/modelica/modelica.js",
  "codemirror/mode/nginx/nginx.js",
  "codemirror/mode/ntriples/ntriples.js",
  "codemirror/mode/octave/octave.js",
  "codemirror/mode/pascal/pascal.js",
  "codemirror/mode/pegjs/pegjs.js",
  "codemirror/mode/perl/perl.js",
  "codemirror/mode/php/php.js",
  "codemirror/mode/pig/pig.js",
  "codemirror/mode/properties/properties.js",
  "codemirror/mode/puppet/puppet.js",
  "codemirror/mode/python/python.js",
  "codemirror/mode/q/q.js",
  "codemirror/mode/r/r.js",
  "codemirror/mode/rpm/rpm.js",
  "codemirror/mode/rst/rst.js",
  "codemirror/mode/ruby/ruby.js",
  "codemirror/mode/rust/rust.js",
  "codemirror/mode/sass/sass.js",
  "codemirror/mode/scheme/scheme.js",
  "codemirror/mode/shell/shell.js",
  "codemirror/mode/sieve/sieve.js",
  "codemirror/mode/slim/slim.js",
  "codemirror/mode/smalltalk/smalltalk.js",
  "codemirror/mode/smarty/smarty.js",
  "codemirror/mode/solr/solr.js",
  "codemirror/mode/sparql/sparql.js",
  "codemirror/mode/sql/sql.js",
  "codemirror/mode/stex/stex.js",
  "codemirror/mode/tcl/tcl.js",
  "codemirror/mode/textile/textile.js",
  "codemirror/mode/tiddlywiki/tiddlywiki.js",
  "codemirror/mode/tiki/tiki.js",
  "codemirror/mode/toml/toml.js",
  "codemirror/mode/tornado/tornado.js",
  "codemirror/mode/turtle/turtle.js",
  "codemirror/mode/vb/vb.js",
  "codemirror/mode/vbscript/vbscript.js",
  "codemirror/mode/velocity/velocity.js",
  "codemirror/mode/verilog/verilog.js",
  "codemirror/mode/xml/xml.js",
  "codemirror/mode/xquery/xquery.js",
  "codemirror/mode/yaml/yaml.js",
  "codemirror/mode/z80/z80.js",
  "codemirror/keymap/sublime.js"
],"codeMirrorComponent.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/codeMirror/codeMirrorComponent.js                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
module.link("./codeMirrorComponent.html");
const CodeMirrors = {};
Template.CodeMirror.onRendered(async function () {
  const CodeMirror = await module.dynamicImport('codemirror/lib/codemirror.js');
  await module.dynamicImport('./codeMirror');
  await module.dynamicImport('codemirror/lib/codemirror.css');
  const options = this.data.options || {
    lineNumbers: true
  };
  const textarea = this.find('textarea');
  const editor = CodeMirror.fromTextArea(textarea, options);
  this.autorun(c => {
    const {
      code
    } = Template.currentData();

    if (code === undefined) {
      return;
    }

    c.stop();
    editor.setValue(code);
  });
  CodeMirrors[this.data.id || 'code-mirror-textarea'] = editor;

  if (this.data && this.data.editorOnBlur) {
    this.data.editorOnBlur(this.data.name);
  }

  const self = this;
  editor.on('change', function (doc) {
    const val = doc.getValue();
    textarea.value = val;

    if (self.data.reactiveVar) {
      Session.set(self.data.reactiveVar, val);
    }
  });

  if (this.data.reactiveVar) {
    this.autorun(function () {
      const val = Session.get(self.data.reactiveVar) || '';

      if (val !== editor.getValue()) {
        editor.setValue(val);
      }
    });
  }

  Meteor.defer(function () {
    editor.refresh();
  });
});

Template.CodeMirror.destroyed = function () {
  delete CodeMirrors[this.data.id || 'code-mirror-textarea'];
  this.$("#".concat(this.data.id || 'code-mirror-textarea')).next('.CodeMirror').remove();
};

Template.CodeMirror.helpers({
  editorId() {
    return this.id || 'code-mirror-textarea';
  },

  editorName() {
    return this.name || 'code-mirror-textarea';
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/codeMirror/index.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./codeMirrorComponent");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"recorderjs":{"audioEncoder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/recorderjs/audioEncoder.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AudioEncoder: () => AudioEncoder
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 1);
let settings;
module.link("../../../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);

class AudioEncoder extends Emitter {
  constructor(source) {
    let {
      bufferLen = 4096,
      numChannels = 1,
      bitRate = settings.get('Message_Audio_bitRate') || 32
    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    super();

    this.handleWorkerMessage = event => {
      switch (event.data.command) {
        case 'end':
          {
            const blob = new Blob(event.data.buffer, {
              type: 'audio/mpeg'
            });
            this.emit('encoded', blob);
            this.worker.terminate();
            break;
          }
      }
    };

    this.handleAudioProcess = event => {
      for (let channel = 0; channel < event.inputBuffer.numberOfChannels; channel++) {
        const buffer = event.inputBuffer.getChannelData(channel);
        this.worker.postMessage({
          command: 'encode',
          buffer
        });
      }
    };

    const workerPath = Meteor.absoluteUrl('workers/mp3-encoder/index.js');
    this.worker = new Worker(workerPath);
    this.worker.onmessage = this.handleWorkerMessage;
    this.worker.postMessage({
      command: 'init',
      config: {
        sampleRate: source.context.sampleRate,
        numChannels,
        bitRate
      }
    });
    this.scriptNode = (source.context.createScriptProcessor || source.context.createJavaScriptNode).call(source.context, bufferLen, numChannels, numChannels);
    this.scriptNode.onaudioprocess = this.handleAudioProcess;
    source.connect(this.scriptNode);
    this.scriptNode.connect(source.context.destination);
  }

  close() {
    this.worker.postMessage({
      command: 'finish'
    });
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"audioRecorder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/recorderjs/audioRecorder.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AudioRecorder: () => instance
});
let AudioEncoder;
module.link("./audioEncoder", {
  AudioEncoder(v) {
    AudioEncoder = v;
  }

}, 0);

const getUserMedia = (navigator => {
  if (navigator.mediaDevices) {
    return navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
  }

  const legacyGetUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;

  if (legacyGetUserMedia) {
    return options => new Promise((resolve, reject) => {
      legacyGetUserMedia.call(navigator, options, resolve, reject);
    });
  }
})(window.navigator);

const AudioContext = window.AudioContext || window.webkitAudioContext;

class AudioRecorder {
  isSupported() {
    return Boolean(getUserMedia) && Boolean(AudioContext);
  }

  createAudioContext() {
    if (this.audioContext) {
      return;
    }

    this.audioContext = new AudioContext();
  }

  destroyAudioContext() {
    if (!this.audioContext) {
      return;
    }

    this.audioContext.close();
    delete this.audioContext;
  }

  async createStream() {
    if (this.stream) {
      return;
    }

    this.stream = await getUserMedia({
      audio: true
    });
  }

  destroyStream() {
    if (!this.stream) {
      return;
    }

    this.stream.getAudioTracks().forEach(track => track.stop());
    delete this.stream;
  }

  async createEncoder() {
    if (this.encoder) {
      return;
    }

    const input = this.audioContext.createMediaStreamSource(this.stream);
    this.encoder = new AudioEncoder(input);
  }

  destroyEncoder() {
    if (!this.encoder) {
      return;
    }

    this.encoder.close();
    delete this.encoder;
  }

  async start(cb) {
    try {
      await this.createAudioContext();
      await this.createStream();
      await this.createEncoder();
      cb && cb.call(this, true);
    } catch (error) {
      console.error(error);
      this.destroyEncoder();
      this.destroyStream();
      this.destroyAudioContext();
      cb && cb.call(this, false);
    }
  }

  stop(cb) {
    this.encoder.on('encoded', cb);
    this.encoder.close();
    this.destroyEncoder();
    this.destroyStream();
    this.destroyAudioContext();
  }

}

const instance = new AudioRecorder();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"videoRecorder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/recorderjs/videoRecorder.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  VideoRecorder: () => VideoRecorder
});
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
const VideoRecorder = new class VideoRecorder {
  constructor() {
    this.started = false;
    this.cameraStarted = new ReactiveVar(false);
    this.recording = new ReactiveVar(false);
    this.recordingAvailable = new ReactiveVar(false);
  }

  start(videoel, cb) {
    this.videoel = videoel;

    const handleSuccess = stream => {
      this.startUserMedia(stream);
      cb && cb.call(this, true);
    };

    const handleError = error => {
      console.error(error);
      cb && cb.call(this, false);
    };

    const oldGetUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;

    if (navigator.mediaDevices) {
      navigator.mediaDevices.getUserMedia({
        audio: true,
        video: true
      }).then(handleSuccess, handleError);
      return;
    }

    if (oldGetUserMedia) {
      oldGetUserMedia.call(navigator, {
        audio: true,
        video: true
      }, handleSuccess, handleError);
      return;
    }

    cb && cb.call(this, false);
  }

  record() {
    this.chunks = [];

    if (this.stream == null) {
      return;
    }

    this.mediaRecorder = new MediaRecorder(this.stream, {
      type: 'video/webm'
    });

    this.mediaRecorder.ondataavailable = blobev => {
      this.chunks.push(blobev.data);

      if (!this.recordingAvailable.get()) {
        return this.recordingAvailable.set(true);
      }
    };

    this.mediaRecorder.start();
    return this.recording.set(true);
  }

  startUserMedia(stream) {
    this.stream = stream;

    try {
      this.videoel.srcObject = stream;
    } catch (error) {
      const URL = window.URL || window.webkitURL;
      this.videoel.src = URL.createObjectURL(stream);
    }

    this.videoel.muted = true;

    this.videoel.onloadedmetadata = () => {
      this.videoel && this.videoel.play();
    };

    this.started = true;
    return this.cameraStarted.set(true);
  }

  stop(cb) {
    if (!this.started) {
      return;
    }

    this.stopRecording();

    if (this.stream) {
      const vtracks = this.stream.getVideoTracks();

      for (const vtrack of Array.from(vtracks)) {
        vtrack.stop();
      }

      const atracks = this.stream.getAudioTracks();

      for (const atrack of Array.from(atracks)) {
        atrack.stop();
      }
    }

    if (this.videoel) {
      this.videoel.pause;
      this.videoel.src = '';
    }

    this.started = false;
    this.cameraStarted.set(false);
    this.recordingAvailable.set(false);

    if (cb && this.chunks) {
      const blob = new Blob(this.chunks, {
        type: 'video/webm'
      });
      cb(blob);
    }

    delete this.recorder;
    delete this.stream;
    delete this.videoel;
  }

  stopRecording() {
    if (!this.started || !this.recording || !this.mediaRecorder) {
      return;
    }

    this.mediaRecorder.stop();
    this.recording.set(false);
    delete this.mediaRecorder;
  }

}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"Tooltip.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/Tooltip.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  closeTooltip: () => closeTooltip,
  openToolTip: () => openToolTip
});
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 0);
let createEphemeralPortal;
module.link("../../../../client/lib/portals/createEphemeralPortal", {
  createEphemeralPortal(v) {
    createEphemeralPortal = v;
  }

}, 1);
let createAnchor;
module.link("../../../../client/lib/utils/createAnchor", {
  createAnchor(v) {
    createAnchor = v;
  }

}, 2);
const Dep = new Tracker.Dependency();
let state;
let dom;
let unregister;

const props = () => {
  Dep.depend();
  return state;
};

const closeTooltip = () => {
  if (!dom) {
    return;
  }

  unregister = unregister && unregister();
};

const openToolTip = (title, anchor) => {
  dom = dom || createAnchor('react-tooltip');
  state = {
    title,
    anchor
  };
  Dep.changed();
  unregister = unregister || createEphemeralPortal(() => module.dynamicImport('../../../../client/components/TooltipComponent'), props, dom);
};

window.matchMedia('(hover: none)').matches || document.body.addEventListener('mouseover', (() => {
  let timeout;
  return e => {
    timeout = timeout && clearTimeout(timeout);
    timeout = setTimeout(() => {
      var _e$dataset;

      const element = e.target.title || (_e$dataset = e.dataset) !== null && _e$dataset !== void 0 && _e$dataset.title ? e.target : e.target.closest('[title], [data-title]');

      if (element) {
        element.dataset.title = element.title || element.dataset.title;
        element.removeAttribute('title');
        openToolTip(element.dataset.title, element);
      }
    }, 300);
    closeTooltip();
  };
})());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserAction.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/UserAction.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  USER_ACTIVITY: () => USER_ACTIVITY,
  USER_ACTIVITIES: () => USER_ACTIVITIES,
  UserAction: () => UserAction
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveDict;
module.link("meteor/reactive-dict", {
  ReactiveDict(v) {
    ReactiveDict = v;
  }

}, 1);
let debounce;
module.link("lodash", {
  debounce(v) {
    debounce = v;
  }

}, 2);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let Notifications;
module.link("../../../notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 4);
const TIMEOUT = 15000;
const RENEW = TIMEOUT / 3;
const USER_ACTIVITY = 'user-activity';
const USER_ACTIVITIES = {
  USER_RECORDING: 'user-recording',
  USER_TYPING: 'user-typing',
  USER_UPLOADING: 'user-uploading'
};
const activityTimeouts = new Map();
const activityRenews = new Map();
const continuingIntervals = new Map();
const roomActivities = new Map();
const rooms = new Map();
const performingUsers = new ReactiveDict();

const shownName = function (user) {
  if (!user) {
    return;
  }

  if (settings.get('UI_Use_Real_Name')) {
    return user.name;
  }

  return user.username;
};

const emitActivities = debounce((rid, extras) => {
  const activities = roomActivities.get((extras === null || extras === void 0 ? void 0 : extras.tmid) || rid) || new Set();
  Notifications.notifyRoom(rid, USER_ACTIVITY, shownName(Meteor.user()), [...activities], extras);
}, 500);

function handleStreamAction(rid, username, activityTypes, extras) {
  rid = (extras === null || extras === void 0 ? void 0 : extras.tmid) || rid;
  const roomActivities = performingUsers.get(rid) || {};

  for (const [, activity] of Object.entries(USER_ACTIVITIES)) {
    roomActivities[activity] = roomActivities[activity] || new Map();
    const users = roomActivities[activity];
    const timeout = users[username];

    if (timeout) {
      clearTimeout(timeout);
    }

    if (activityTypes.includes(activity)) {
      activityTypes.splice(activityTypes.indexOf(activity), 1);
      users[username] = setTimeout(() => handleStreamAction(rid, username, activityTypes, extras), TIMEOUT);
    } else {
      delete users[username];
    }
  }

  performingUsers.set(rid, roomActivities);
}

const UserAction = new class {
  addStream(rid) {
    if (rooms.get(rid)) {
      return;
    }

    const handler = function (username, activityType, extras) {
      const user = Meteor.users.findOne(Meteor.userId() || undefined, {
        fields: {
          name: 1,
          username: 1
        }
      });

      if (username === shownName(user)) {
        return;
      }

      handleStreamAction(rid, username, activityType, extras);
    };

    rooms.set(rid, handler);
    Notifications.onRoom(rid, USER_ACTIVITY, handler);
  }

  performContinuously(rid, activityType) {
    let extras = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
    const trid = (extras === null || extras === void 0 ? void 0 : extras.tmid) || rid;
    const key = "".concat(activityType, "-").concat(trid);

    if (continuingIntervals.get(key)) {
      return;
    }

    this.start(rid, activityType, extras);
    continuingIntervals.set(key, setInterval(() => {
      this.start(rid, activityType, extras);
    }, RENEW));
  }

  start(rid, activityType) {
    let extras = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
    const trid = (extras === null || extras === void 0 ? void 0 : extras.tmid) || rid;
    const key = "".concat(activityType, "-").concat(trid);

    if (activityRenews.get(key)) {
      return;
    }

    activityRenews.set(key, setTimeout(() => {
      clearTimeout(activityRenews.get(key));
      activityRenews.delete(key);
    }, RENEW));
    const activities = roomActivities.get(trid) || new Set();
    activities.add(activityType);
    roomActivities.set(trid, activities);
    emitActivities(rid, extras);

    if (activityTimeouts.get(key)) {
      clearTimeout(activityTimeouts.get(key));
      activityTimeouts.delete(key);
    }

    activityTimeouts.set(key, setTimeout(() => this.stop(trid, activityType, extras), TIMEOUT));
    activityTimeouts.get(key);
  }

  stop(rid, activityType, extras) {
    const trid = (extras === null || extras === void 0 ? void 0 : extras.tmid) || rid;
    const key = "".concat(activityType, "-").concat(trid);

    if (activityTimeouts.get(key)) {
      clearTimeout(activityTimeouts.get(key));
      activityTimeouts.delete(key);
    }

    if (activityRenews.get(key)) {
      clearTimeout(activityRenews.get(key));
      activityRenews.delete(key);
    }

    if (continuingIntervals.get(key)) {
      clearInterval(continuingIntervals.get(key));
      continuingIntervals.delete(key);
    }

    const activities = roomActivities.get(trid) || new Set();
    activities.delete(activityType);
    roomActivities.set(trid, activities);
    emitActivities(rid, extras);
  }

  cancel(rid) {
    if (!rooms.get(rid)) {
      return;
    }

    Notifications.unRoom(rid, USER_ACTIVITY, rooms.get(rid));
    rooms.delete(rid);
  }

  get(roomId) {
    return performingUsers.get(roomId);
  }

}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserCard.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/UserCard.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  closeUserCard: () => closeUserCard,
  openUserCard: () => openUserCard
});
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let createEphemeralPortal;
module.link("../../../../client/lib/portals/createEphemeralPortal", {
  createEphemeralPortal(v) {
    createEphemeralPortal = v;
  }

}, 2);
const Dep = new Tracker.Dependency();
let container;
let routeComputation;
let props;
let unregister;

const createContainer = () => {
  const div = document.createElement('div');
  div.id = 'react-user-card';
  document.body.appendChild(div);
  return div;
};

const closeUserCard = () => {
  if (!container) {
    return;
  }

  if (routeComputation) {
    routeComputation.stop();
    routeComputation = undefined;
  }

  Tracker.afterFlush(() => {
    if (unregister) {
      unregister();
      unregister = undefined;
    }
  });
};

const openUserCard = args => {
  props = _objectSpread(_objectSpread({}, args), {}, {
    onClose: closeUserCard
  });
  Dep.changed();
  container = container || createContainer();
  unregister = unregister || createEphemeralPortal(() => module.dynamicImport('../../../../client/views/room/UserCard'), () => {
    Dep.depend();
    return props;
  }, container);
  routeComputation = routeComputation || Tracker.autorun(c => {
    FlowRouter.watchPathChange();

    if (!c.firstRun) {
      closeUserCard();
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"accounts.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/accounts.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
let t;
module.link("../../../utils", {
  t(v) {
    t = v;
  }

}, 2);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 3);
Accounts.onEmailVerificationLink(function (token, done) {
  Accounts.verifyEmail(token, function (error) {
    if (error == null) {
      dispatchToastMessage({
        type: 'success',
        message: t('Email_verified')
      });
      Meteor.call('afterVerifyEmail');
    } else {
      dispatchToastMessage({
        type: 'error',
        message: error.message
      });
    }

    return done();
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"chatMessages.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/chatMessages.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  ChatMessages: () => ChatMessages
});
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 1);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 2);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 3);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 4);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 5);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 6);
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 7);
let KonchatNotification;
module.link("./notification", {
  KonchatNotification(v) {
    KonchatNotification = v;
  }

}, 8);
let UserAction, USER_ACTIVITIES;
module.link("../index", {
  UserAction(v) {
    UserAction = v;
  },

  USER_ACTIVITIES(v) {
    USER_ACTIVITIES = v;
  }

}, 9);
let fileUpload;
module.link("./fileUpload", {
  fileUpload(v) {
    fileUpload = v;
  }

}, 10);
let t, slashCommands;
module.link("../../../utils/client", {
  t(v) {
    t = v;
  },

  slashCommands(v) {
    slashCommands = v;
  }

}, 11);
let messageProperties, MessageTypes, readMessage;
module.link("../../../ui-utils/client", {
  messageProperties(v) {
    messageProperties = v;
  },

  MessageTypes(v) {
    MessageTypes = v;
  },

  readMessage(v) {
    readMessage = v;
  }

}, 12);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 13);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 14);
let hasAtLeastOnePermission;
module.link("../../../authorization/client", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 15);
let Messages, Rooms, ChatMessage, ChatSubscription;
module.link("../../../models/client", {
  Messages(v) {
    Messages = v;
  },

  Rooms(v) {
    Rooms = v;
  },

  ChatMessage(v) {
    ChatMessage = v;
  },

  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 16);
let emoji;
module.link("../../../emoji/client", {
  emoji(v) {
    emoji = v;
  }

}, 17);
let generateTriggerId;
module.link("../../../ui-message/client/ActionManager", {
  generateTriggerId(v) {
    generateTriggerId = v;
  }

}, 18);
let imperativeModal;
module.link("../../../../client/lib/imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 19);
let GenericModal;
module.link("../../../../client/components/GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 20);
let keyCodes;
module.link("../../../../client/lib/utils/keyCodes", {
  keyCodes(v) {
    keyCodes = v;
  }

}, 21);
let prependReplies;
module.link("../../../../client/lib/utils/prependReplies", {
  prependReplies(v) {
    prependReplies = v;
  }

}, 22);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 23);
let handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 24);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 25);
let onClientBeforeSendMessage;
module.link("../../../../client/lib/onClientBeforeSendMessage", {
  onClientBeforeSendMessage(v) {
    onClientBeforeSendMessage = v;
  }

}, 26);
const messageBoxState = {
  saveValue: _.debounce((_ref, value) => {
    let {
      rid,
      tmid
    } = _ref;
    const key = ['messagebox', rid, tmid].filter(Boolean).join('_');
    value ? Meteor._localStorage.setItem(key, value) : Meteor._localStorage.removeItem(key);
  }, 1000),
  restoreValue: _ref2 => {
    let {
      rid,
      tmid
    } = _ref2;
    const key = ['messagebox', rid, tmid].filter(Boolean).join('_');
    return Meteor._localStorage.getItem(key);
  },
  restore: (_ref3, input) => {
    let {
      rid,
      tmid
    } = _ref3;
    const value = messageBoxState.restoreValue({
      rid,
      tmid
    });

    if (typeof value === 'string') {
      messageBoxState.set(input, value);
    }
  },
  save: (_ref4, input) => {
    let {
      rid,
      tmid
    } = _ref4;
    messageBoxState.saveValue({
      rid,
      tmid
    }, input.value);
  },
  set: (input, value) => {
    input.value = value;
    $(input).trigger('change').trigger('input');
  },
  purgeAll: () => {
    Object.keys(Meteor._localStorage).filter(key => key.indexOf('messagebox_') === 0).forEach(key => Meteor._localStorage.removeItem(key));
  }
};
callbacks.add('afterLogoutCleanUp', messageBoxState.purgeAll, callbacks.priority.MEDIUM, 'chatMessages-after-logout-cleanup');

class ChatMessages {
  constructor() {
    let collection = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ChatMessage;
    this.editing = {};
    this.records = {};
    this.collection = collection;
  }

  initializeWrapper(wrapper) {
    this.wrapper = wrapper;
  }

  initializeInput(input, _ref5) {
    let {
      rid,
      tmid
    } = _ref5;
    this.input = input;
    this.$input = $(this.input);

    if (!input || !rid) {
      return;
    }

    messageBoxState.restore({
      rid,
      tmid
    }, input);
    this.restoreReplies();
    this.requestInputFocus();
  }

  async restoreReplies() {
    const mid = FlowRouter.getQueryParam('reply');

    if (!mid) {
      return;
    }

    const message = Messages.findOne(mid) || (await callWithErrorHandling('getSingleMessage', mid));

    if (!message) {
      return;
    }

    this.$input.data('reply', [message]).trigger('dataChange');
  }

  requestInputFocus() {
    setTimeout(() => {
      if (this.input && window.matchMedia('screen and (min-device-width: 500px)').matches) {
        this.input.focus();
      }
    }, 200);
  }

  recordInputAsDraft() {
    const message = this.collection.findOne(this.editing.id);
    const record = this.records[this.editing.id] || {};
    const draft = this.input.value;

    if (draft === message.msg) {
      this.clearCurrentDraft();
      return;
    }

    record.draft = draft;
    this.records[this.editing.id] = record;
  }

  clearCurrentDraft() {
    const hasValue = this.records[this.editing.id];
    delete this.records[this.editing.id];
    return !!hasValue;
  }

  resetToDraft(id) {
    const message = this.collection.findOne(id);
    const oldValue = this.input.value;
    messageBoxState.set(this.input, message.msg);
    return oldValue !== message.msg;
  }

  toPrevMessage() {
    const {
      element
    } = this.editing;

    if (!element) {
      const messages = Array.from(this.wrapper.querySelectorAll('.own:not(.system)'));
      const message = messages.pop();
      return message && this.edit(message, false);
    }

    for (let previous = element.previousElementSibling; previous; previous = previous.previousElementSibling) {
      if (previous.matches('.own:not(.system)')) {
        return this.edit(previous, false);
      }
    }

    this.clearEditing();
  }

  toNextMessage() {
    const {
      element
    } = this.editing;

    if (element) {
      let next;

      for (next = element.nextElementSibling; next; next = next.nextElementSibling) {
        if (next.matches('.own:not(.system)')) {
          break;
        }
      }

      next ? this.edit(next, true) : this.clearEditing();
    } else {
      this.clearEditing();
    }
  }

  edit(element, isEditingTheNextOne) {
    const message = this.collection.findOne(element.dataset.id);
    const hasPermission = hasAtLeastOnePermission('edit-message', message.rid);
    const editAllowed = settings.get('Message_AllowEditing');
    const editOwn = message && message.u && message.u._id === Meteor.userId();

    if (!hasPermission && (!editAllowed || !editOwn)) {
      return;
    }

    if (element.classList.contains('system')) {
      return;
    }

    const blockEditInMinutes = settings.get('Message_AllowEditing_BlockEditInMinutes');

    if (blockEditInMinutes && blockEditInMinutes !== 0) {
      let currentTsDiff;
      let msgTs;

      if (message.ts) {
        msgTs = moment(message.ts);
      }

      if (msgTs) {
        currentTsDiff = moment().diff(msgTs, 'minutes');
      }

      if (currentTsDiff > blockEditInMinutes) {
        return;
      }
    }

    const draft = this.records[message._id];
    let msg = draft && draft.draft;
    msg = msg || message.msg;
    this.clearEditing();
    this.editing.element = element;
    this.editing.id = message._id;
    this.input.parentElement.classList.add('editing');
    element.classList.add('editing');

    if (message.attachments && message.attachments[0].description) {
      messageBoxState.set(this.input, message.attachments[0].description);
    } else {
      messageBoxState.set(this.input, msg);
    }

    const cursorPosition = isEditingTheNextOne ? 0 : -1;
    this.input.focus();
    this.$input.setCursorPosition(cursorPosition);
  }

  clearEditing() {
    if (!this.editing.element) {
      this.editing.saved = this.input.value;
      this.editing.savedCursor = this.input.selectionEnd;
      return;
    }

    this.recordInputAsDraft();
    this.input.parentElement.classList.remove('editing');
    this.editing.element.classList.remove('editing');
    delete this.editing.id;
    delete this.editing.element;
    messageBoxState.set(this.input, this.editing.saved || '');
    const cursorPosition = this.editing.savedCursor ? this.editing.savedCursor : -1;
    this.$input.setCursorPosition(cursorPosition);
  }

  async send(event, _ref6) {
    let {
      rid,
      tmid,
      value,
      tshow
    } = _ref6;
    let done = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : () => {};
    const threadsEnabled = settings.get('Threads_enabled');
    UserAction.stop(rid, USER_ACTIVITIES.USER_TYPING, {
      tmid
    });

    if (!ChatSubscription.findOne({
      rid
    })) {
      await callWithErrorHandling('joinRoom', rid);
    }

    messageBoxState.save({
      rid,
      tmid
    }, this.input);
    let msg = value.trim();

    if (msg) {
      const mention = this.$input.data('mention-user') || false;
      const replies = this.$input.data('reply') || [];

      if (!mention || !threadsEnabled) {
        msg = await prependReplies(msg, replies, mention);
      }

      if (mention && threadsEnabled && replies.length) {
        tmid = replies[0]._id;
      }
    } // don't add tmid or tshow if the message isn't part of a thread (it can happen if editing the main message of a thread)


    const originalMessage = this.collection.findOne({
      _id: this.editing.id
    }, {
      fields: {
        tmid: 1
      },
      reactive: false
    });

    if (originalMessage && tmid && !originalMessage.tmid) {
      tmid = undefined;
      tshow = undefined;
    }

    if (msg) {
      readMessage.readNow(rid);
      readMessage.refreshUnreadMark(rid);
      const message = await onClientBeforeSendMessage({
        _id: Random.id(),
        rid,
        tshow,
        tmid,
        msg
      });

      try {
        await this.processMessageSend(message);
        this.$input.removeData('reply').trigger('dataChange');
      } catch (error) {
        handleError(error);
      }

      return done();
    }

    if (this.editing.id) {
      const message = this.collection.findOne(this.editing.id);
      const isDescription = message.attachments && message.attachments[0] && message.attachments[0].description;

      try {
        if (isDescription) {
          await this.processMessageEditing({
            _id: this.editing.id,
            rid,
            msg: ''
          });
          return done();
        }

        this.resetToDraft(this.editing.id);
        this.confirmDeleteMsg(message, done);
        return;
      } catch (error) {
        handleError(error);
      }
    }

    return done();
  }

  async processMessageSend(message) {
    if (await this.processSetReaction(message)) {
      return;
    }

    this.clearCurrentDraft();

    if (await this.processTooLongMessage(message)) {
      return;
    }

    if (await this.processMessageEditing(_objectSpread(_objectSpread({}, message), {}, {
      _id: this.editing.id
    }))) {
      return;
    }

    KonchatNotification.removeRoomNotification(message.rid);

    if (await this.processSlashCommand(message)) {
      return;
    }

    await callWithErrorHandling('sendMessage', message);
  }

  async processSetReaction(_ref7) {
    let {
      rid,
      tmid,
      msg
    } = _ref7;

    if (msg.slice(0, 2) !== '+:') {
      return false;
    }

    const reaction = msg.slice(1).trim();

    if (!emoji.list[reaction]) {
      return false;
    }

    const lastMessage = this.collection.findOne({
      rid,
      tmid
    }, {
      fields: {
        ts: 1
      },
      sort: {
        ts: -1
      }
    });
    await callWithErrorHandling('setReaction', reaction, lastMessage._id);
    return true;
  }

  async processTooLongMessage(_ref8) {
    let {
      msg,
      rid,
      tmid
    } = _ref8;
    const adjustedMessage = messageProperties.messageWithoutEmojiShortnames(msg);

    if (messageProperties.length(adjustedMessage) <= settings.get('Message_MaxAllowedSize') && msg) {
      return false;
    }

    if (!settings.get('FileUpload_Enabled') || !settings.get('Message_AllowConvertLongMessagesToAttachment') || this.editing.id) {
      throw new Error({
        error: 'Message_too_long'
      });
    }

    const onConfirm = () => {
      const contentType = 'text/plain';
      const messageBlob = new Blob([msg], {
        type: contentType
      });
      const fileName = "".concat(Meteor.user().username, " - ").concat(new Date(), ".txt");
      const file = new File([messageBlob], fileName, {
        type: contentType,
        lastModified: Date.now()
      });
      fileUpload([{
        file,
        name: fileName
      }], this.input, {
        rid,
        tmid
      });
      imperativeModal.close();
    };

    const onClose = () => {
      messageBoxState.set(this.input, msg);
      imperativeModal.close();
    };

    imperativeModal.open({
      component: GenericModal,
      props: {
        title: t('Message_too_long'),
        children: t('Send_it_as_attachment_instead_question'),
        onConfirm,
        onClose,
        onCancel: onClose,
        variant: 'warning'
      }
    });
    return true;
  }

  async processMessageEditing(message) {
    if (!message._id) {
      return false;
    }

    if (MessageTypes.isSystemMessage(message)) {
      return false;
    }

    this.clearEditing();
    await callWithErrorHandling('updateMessage', message);
    return true;
  }

  async processSlashCommand(msgObject) {
    if (msgObject.msg[0] === '/') {
      const match = msgObject.msg.match(/^\/([^\s]+)(?:\s+(.*))?$/m);

      if (match) {
        let command;

        if (slashCommands.commands[match[1]]) {
          const commandOptions = slashCommands.commands[match[1]];
          command = match[1];
          const param = match[2] || '';

          if (!commandOptions.permission || hasAtLeastOnePermission(commandOptions.permission, Session.get('openedRoom'))) {
            if (commandOptions.clientOnly) {
              commandOptions.callback(command, param, msgObject);
            } else {
              const triggerId = generateTriggerId(slashCommands.commands[command].appId);
              Meteor.call('slashCommand', {
                cmd: command,
                params: param,
                msg: msgObject,
                triggerId
              }, (err, result) => {
                typeof commandOptions.result === 'function' && commandOptions.result(err, result, {
                  cmd: command,
                  params: param,
                  msg: msgObject
                });
              });
            }

            return true;
          }
        }

        if (!settings.get('Message_AllowUnrecognizedSlashCommand')) {
          const invalidCommandMsg = {
            _id: Random.id(),
            rid: msgObject.rid,
            ts: new Date(),
            msg: TAPi18n.__('No_such_command', {
              command: escapeHTML(match[1])
            }),
            u: {
              username: settings.get('InternalHubot_Username') || 'rocket.cat'
            },
            private: true
          };
          this.collection.upsert({
            _id: invalidCommandMsg._id
          }, invalidCommandMsg);
          return true;
        }
      }
    }

    return false;
  }

  confirmDeleteMsg(message) {
    let done = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => {};

    if (MessageTypes.isSystemMessage(message)) {
      return done();
    }

    const room = message.drid && Rooms.findOne({
      _id: message.drid,
      prid: {
        $exists: true
      }
    });

    const onConfirm = () => {
      if (this.editing.id === message._id) {
        this.clearEditing();
      }

      this.deleteMsg(message);
      this.$input.focus();
      done();
      imperativeModal.close();
      dispatchToastMessage({
        type: 'success',
        message: t('Your_entry_has_been_deleted')
      });
    };

    const onCloseModal = () => {
      imperativeModal.close();

      if (this.editing.id === message._id) {
        this.clearEditing();
      }

      this.$input.focus();
      done();
    };

    imperativeModal.open({
      component: GenericModal,
      props: {
        title: t('Are_you_sure'),
        children: room ? t('The_message_is_a_discussion_you_will_not_be_able_to_recover') : t('You_will_not_be_able_to_recover'),
        variant: 'danger',
        confirmText: t('Yes_delete_it'),
        onConfirm,
        onClose: onCloseModal,
        onCancel: onCloseModal
      }
    });
  }

  async deleteMsg(_ref9) {
    let {
      _id,
      rid,
      ts
    } = _ref9;
    const forceDelete = hasAtLeastOnePermission('force-delete-message', rid);
    const blockDeleteInMinutes = settings.get('Message_AllowDeleting_BlockDeleteInMinutes');

    if (blockDeleteInMinutes && forceDelete === false) {
      let msgTs;

      if (ts) {
        msgTs = moment(ts);
      }

      let currentTsDiff;

      if (msgTs) {
        currentTsDiff = moment().diff(msgTs, 'minutes');
      }

      if (currentTsDiff > blockDeleteInMinutes) {
        dispatchToastMessage({
          type: 'error',
          message: t('Message_deleting_blocked')
        });
        return;
      }
    }

    await callWithErrorHandling('deleteMessage', {
      _id
    });
  }

  keydown(event) {
    const {
      currentTarget: input,
      which: keyCode
    } = event;

    if (keyCode === keyCodes.ESCAPE && this.editing.element) {
      event.preventDefault();
      event.stopPropagation();

      if (!this.resetToDraft(this.editing.id)) {
        this.clearCurrentDraft();
        this.clearEditing();
        return true;
      }

      return;
    }

    if (keyCode === keyCodes.ARROW_UP || keyCode === keyCodes.ARROW_DOWN) {
      if (event.shiftKey) {
        return;
      }

      const cursorPosition = input.selectionEnd;

      if (keyCode === keyCodes.ARROW_UP) {
        if (cursorPosition === 0) {
          this.toPrevMessage();
        } else if (!event.altKey) {
          return;
        }

        if (event.altKey) {
          this.$input.setCursorPosition(0);
        }
      } else {
        if (cursorPosition === input.value.length) {
          this.toNextMessage();
        } else if (!event.altKey) {
          return;
        }

        if (event.altKey) {
          this.$input.setCursorPosition(-1);
        }
      }

      event.preventDefault();
      event.stopPropagation();
    }
  }

  keyup(event, _ref10) {
    let {
      rid,
      tmid
    } = _ref10;
    const {
      currentTarget: input,
      which: keyCode
    } = event;

    if (!Object.values(keyCodes).includes(keyCode)) {
      if (input.value.trim()) {
        UserAction.start(rid, USER_ACTIVITIES.USER_TYPING, {
          tmid
        });
      } else {
        UserAction.stop(rid, USER_ACTIVITIES.USER_TYPING, {
          tmid
        });
      }
    }

    messageBoxState.save({
      rid,
      tmid
    }, input);
  }

  onDestroyed(rid, tmid) {
    var _this$input, _this$input$parentEle;

    UserAction.cancel(rid); // TODO: check why we need too many ?. here :(

    if (((_this$input = this.input) === null || _this$input === void 0 ? void 0 : (_this$input$parentEle = _this$input.parentElement) === null || _this$input$parentEle === void 0 ? void 0 : _this$input$parentEle.classList.contains('editing')) === true) {
      if (!tmid) {
        this.clearCurrentDraft();
        this.clearEditing();
      }

      messageBoxState.set(this.input, '');
      messageBoxState.save({
        rid,
        tmid
      }, this.$input);
    }
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"collections.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/collections.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);
let CachedChatRoom, CachedChatSubscription;
module.link("../../../models", {
  CachedChatRoom(v) {
    CachedChatRoom = v;
  },

  CachedChatSubscription(v) {
    CachedChatSubscription = v;
  }

}, 3);
Meteor.startup(() => {
  Tracker.autorun(() => {
    if (!Meteor.userId() && settings.get('Accounts_AllowAnonymousRead') === true) {
      CachedChatRoom.init();
      CachedChatSubscription.ready.set(true);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"fileUpload.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/fileUpload.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  uploadFileWithMessage: () => uploadFileWithMessage,
  fileUpload: () => fileUpload
});
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 2);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let UserAction, USER_ACTIVITIES;
module.link("../index", {
  UserAction(v) {
    UserAction = v;
  },

  USER_ACTIVITIES(v) {
    USER_ACTIVITIES = v;
  }

}, 4);
let fileUploadIsValidContentType, APIClient;
module.link("../../../utils", {
  fileUploadIsValidContentType(v) {
    fileUploadIsValidContentType = v;
  },

  APIClient(v) {
    APIClient = v;
  }

}, 5);
let imperativeModal;
module.link("../../../../client/lib/imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 6);
let FileUploadModal;
module.link("../../../../client/views/room/modals/FileUploadModal", {
  default(v) {
    FileUploadModal = v;
  }

}, 7);
let prependReplies;
module.link("../../../../client/lib/utils/prependReplies", {
  prependReplies(v) {
    prependReplies = v;
  }

}, 8);

const uploadFileWithMessage = async (rid, tmid, _ref) => {
  let {
    description,
    fileName,
    msg,
    file
  } = _ref;
  const data = new FormData();
  description && data.append('description', description);
  msg && data.append('msg', msg);
  tmid && data.append('tmid', tmid);
  data.append('file', file.file, fileName);
  const uploads = Session.get('uploading') || [];
  const upload = {
    id: Random.id(),
    name: fileName,
    percentage: 0
  };
  uploads.push(upload);
  Session.set('uploading', uploads);
  const {
    xhr,
    promise
  } = APIClient.upload("v1/rooms.upload/".concat(rid), {}, data, {
    progress(progress) {
      const uploads = Session.get('uploading') || [];

      if (progress === 100) {
        return;
      }

      uploads.filter(u => u.id === upload.id).forEach(u => {
        u.percentage = Math.round(progress) || 0;
      });
      Session.set('uploading', uploads);
    },

    error(error) {
      const uploads = Session.get('uploading') || [];
      uploads.filter(u => u.id === upload.id).forEach(u => {
        u.error = error.message;
        u.percentage = 0;
      });
      Session.set('uploading', uploads);
    }

  });

  if (Session.get('uploading').length) {
    UserAction.performContinuously(rid, USER_ACTIVITIES.USER_UPLOADING, {
      tmid
    });
  }

  Tracker.autorun(computation => {
    const isCanceling = Session.get("uploading-cancel-".concat(upload.id));

    if (!isCanceling) {
      return;
    }

    computation.stop();
    Session.delete("uploading-cancel-".concat(upload.id));
    xhr.abort();
    const uploads = Session.get('uploading') || {};
    Session.set('uploading', uploads.filter(u => u.id !== upload.id));
  });

  try {
    await promise;
    const uploads = Session.get('uploading') || [];
    const remainingUploads = Session.set('uploading', uploads.filter(u => u.id !== upload.id));

    if (!Session.get('uploading').length) {
      UserAction.stop(rid, USER_ACTIVITIES.USER_UPLOADING, {
        tmid
      });
    }

    return remainingUploads;
  } catch (error) {
    const uploads = Session.get('uploading') || [];
    uploads.filter(u => u.id === upload.id).forEach(u => {
      u.error = error.xhr && error.xhr.responseJSON && error.xhr.responseJSON.error || error.message;
      u.percentage = 0;
    });

    if (!uploads.length) {
      UserAction.stop(rid, USER_ACTIVITIES.USER_UPLOADING, {
        tmid
      });
    }

    Session.set('uploading', uploads);
  }
};

const fileUpload = async (files, input, _ref2) => {
  let {
    rid,
    tmid
  } = _ref2;
  const threadsEnabled = settings.get('Threads_enabled');
  files = [].concat(files);
  const replies = $(input).data('reply') || [];
  const mention = $(input).data('mention-user') || false;
  let msg = '';

  if (!mention || !threadsEnabled) {
    msg = await prependReplies('', replies, mention);
  }

  if (mention && threadsEnabled && replies.length) {
    tmid = replies[0]._id;
  }

  const uploadNextFile = () => {
    const file = files.pop();

    if (!file) {
      return;
    }

    imperativeModal.open({
      component: FileUploadModal,
      props: {
        file: file.file,
        fileName: file.name,
        onClose: () => {
          imperativeModal.close();
          uploadNextFile();
        },
        onSubmit: (fileName, description) => {
          uploadFileWithMessage(rid, tmid, {
            description,
            fileName,
            msg: msg || undefined,
            file
          });
          imperativeModal.close();
          uploadNextFile();
        },
        invalidContentType: file.file.type && !fileUploadIsValidContentType(file.file.type)
      }
    });
  };

  uploadNextFile();
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"iframeCommands.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/iframeCommands.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 1);
let ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration(v) {
    ServiceConfiguration = v;
  }

}, 2);
let s;
module.link("underscore.string", {
  default(v) {
    s = v;
  }

}, 3);
let escapeRegExp;
module.link("@rocket.chat/string-helpers", {
  escapeRegExp(v) {
    escapeRegExp = v;
  }

}, 4);
let AccountBox;
module.link("../../../ui-utils", {
  AccountBox(v) {
    AccountBox = v;
  }

}, 5);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 6);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 7);
let add, remove;
module.link("../../../../client/views/room/lib/Toolbox/IframeButtons", {
  add(v) {
    add = v;
  },

  remove(v) {
    remove = v;
  }

}, 8);
let baseURI;
module.link("../../../../client/lib/baseURI", {
  baseURI(v) {
    baseURI = v;
  }

}, 9);
const commands = {
  'go'(data) {
    if (typeof data.path !== 'string' || data.path.trim().length === 0) {
      return console.error('`path` not defined');
    }

    const newUrl = new URL("".concat(s.rtrim(baseURI, '/'), "/").concat(s.ltrim(data.path, '/')));
    const newParams = Array.from(newUrl.searchParams.entries()).reduce((ret, _ref) => {
      let [key, value] = _ref;
      ret[key] = value;
      return ret;
    }, {});
    const newPath = newUrl.pathname.replace(new RegExp("^".concat(escapeRegExp(__meteor_runtime_config__.ROOT_URL_PATH_PREFIX))), '');
    FlowRouter.go(newPath, null, _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), newParams));
  },

  'set-user-status'(data) {
    AccountBox.setStatus(data.status);
  },

  'call-custom-oauth-login'(data, event) {
    const customOAuthCallback = response => {
      event.source.postMessage({
        event: 'custom-oauth-callback',
        response
      }, event.origin);
    };

    const siteUrl = "".concat(Meteor.settings.Site_Url, "/");

    if (typeof data.redirectUrl !== 'string' || !data.redirectUrl.startsWith(siteUrl)) {
      data.redirectUrl = null;
    }

    if (typeof data.service === 'string' && window.ServiceConfiguration) {
      const customOauth = ServiceConfiguration.configurations.findOne({
        service: data.service
      });

      if (customOauth) {
        const customLoginWith = Meteor["loginWith".concat(s.capitalize(customOauth.service, true))];
        const customRedirectUri = data.redirectUrl || siteUrl;
        customLoginWith.call(Meteor, {
          redirectUrl: customRedirectUri
        }, customOAuthCallback);
      }
    }
  },

  'login-with-token'(data) {
    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    if (typeof data.token === 'string') {
      Meteor.loginWithToken(data.token, function () {
        console.log('Iframe command [login-with-token]: result', [data, ...args]);
      });
    }
  },

  'logout'() {
    const user = Meteor.user();
    Meteor.logout(() => {
      callbacks.run('afterLogoutCleanUp', user);
      Meteor.call('logoutCleanUp', user);
      return FlowRouter.go('home');
    });
  },

  'set-toolbar-button'(_ref2) {
    let {
      id,
      icon,
      label
    } = _ref2;
    add(id, {
      id,
      icon,
      label
    });
  },

  'remove-toolbar-button'(_ref3) {
    let {
      id
    } = _ref3;
    remove(id);
  }

};
window.addEventListener('message', e => {
  if (settings.get('Iframe_Integration_receive_enable') !== true) {
    return;
  }

  if (typeof e.data !== 'object' || typeof e.data.externalCommand !== 'string') {
    return;
  }

  const origins = settings.get('Iframe_Integration_receive_origin');

  if (origins !== '*' && origins.split(',').indexOf(e.origin) === -1) {
    return console.error('Origin not allowed', e.origin);
  }

  const command = commands[e.data.externalCommand];

  if (command) {
    command(e.data, e);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"menu.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/menu.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let menu;
module.link("../../../ui-utils", {
  menu(v) {
    menu = v;
  }

}, 1);
window.addEventListener('resize', _.debounce((() => {
  let lastState = window.matchMedia('(min-width: 780px)').matches ? 'mini' : 'large';
  menu.close();
  return () => {
    const futureState = window.matchMedia('(min-width: 780px)').matches ? 'mini' : 'large';

    if (lastState !== futureState) {
      lastState = futureState;
      menu.close();
    }
  };
})(), 100));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"notification.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/notification.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  KonchatNotification: () => KonchatNotification
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 4);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 5);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 6);
let s;
module.link("underscore.string", {
  default(v) {
    s = v;
  }

}, 7);
let e2e;
module.link("../../../e2e/client", {
  e2e(v) {
    e2e = v;
  }

}, 8);
let Users, ChatSubscription;
module.link("../../../models", {
  Users(v) {
    Users = v;
  },

  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 9);
let getUserPreference;
module.link("../../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 10);
let getUserAvatarURL;
module.link("../../../utils/lib/getUserAvatarURL", {
  getUserAvatarURL(v) {
    getUserAvatarURL = v;
  }

}, 11);
let CustomSounds;
module.link("../../../custom-sounds/client/lib/CustomSounds", {
  CustomSounds(v) {
    CustomSounds = v;
  }

}, 12);
let getAvatarAsPng;
module.link("../../../../client/lib/utils/getAvatarAsPng", {
  getAvatarAsPng(v) {
    getAvatarAsPng = v;
  }

}, 13);
let onClientMessageReceived;
module.link("../../../../client/lib/onClientMessageReceived", {
  onClientMessageReceived(v) {
    onClientMessageReceived = v;
  }

}, 14);
const KonchatNotification = {
  notificationStatus: new ReactiveVar(),

  // notificacoes HTML5
  getDesktopPermission() {
    if (window.Notification && Notification.permission !== 'granted') {
      return Notification.requestPermission(function (status) {
        KonchatNotification.notificationStatus.set(status);

        if (Notification.permission !== status) {
          Notification.permission = status;
        }
      });
    }
  },

  notify(notification) {
    if (window.Notification && Notification.permission === 'granted') {
      const message = {
        rid: notification.payload != null ? notification.payload.rid : undefined,
        msg: notification.text,
        notification: true
      };
      return onClientMessageReceived(message).then(function (message) {
        const requireInteraction = getUserPreference(Meteor.userId(), 'desktopNotificationRequireInteraction');
        const n = new Notification(notification.title, {
          icon: notification.icon || getUserAvatarURL(notification.payload.sender.username),
          body: s.stripTags(message.msg),
          tag: notification.payload._id,
          canReply: true,
          silent: true,
          requireInteraction
        });
        const notificationDuration = !requireInteraction && (notification.duration - 0 || 10);

        if (notificationDuration > 0) {
          setTimeout(() => n.close(), notificationDuration * 1000);
        }

        if (notification.payload && notification.payload.rid) {
          if (n.addEventListener) {
            n.addEventListener('reply', _ref => {
              let {
                response
              } = _ref;
              return Meteor.call('sendMessage', {
                _id: Random.id(),
                rid: notification.payload.rid,
                msg: response
              });
            });
          }

          n.onclick = function () {
            this.close();
            window.focus();

            switch (notification.payload.type) {
              case 'd':
                return FlowRouter.go('direct', _objectSpread({
                  rid: notification.payload.rid
                }, notification.payload.tmid && {
                  tab: 'thread',
                  context: notification.payload.tmid
                }), _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), {}, {
                  jump: notification.payload._id
                }));

              case 'c':
                return FlowRouter.go('channel', _objectSpread({
                  name: notification.payload.name
                }, notification.payload.tmid && {
                  tab: 'thread',
                  context: notification.payload.tmid
                }), _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), {}, {
                  jump: notification.payload._id
                }));

              case 'p':
                return FlowRouter.go('group', _objectSpread({
                  name: notification.payload.name
                }, notification.payload.tmid && {
                  tab: 'thread',
                  context: notification.payload.tmid
                }), _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), {}, {
                  jump: notification.payload._id
                }));
            }
          };
        }
      });
    }
  },

  async showDesktop(notification) {
    if (notification.payload.rid === Session.get('openedRoom') && (typeof window.document.hasFocus === 'function' ? window.document.hasFocus() : undefined)) {
      return;
    }

    if (Meteor.user().status === 'busy') {
      return;
    }

    if (notification.payload.message && notification.payload.message.t === 'e2e') {
      const e2eRoom = await e2e.getInstanceByRoomId(notification.payload.rid);

      if (e2eRoom) {
        notification.text = (await e2eRoom.decrypt(notification.payload.message.msg)).text;
      }
    }

    return getAvatarAsPng(notification.payload.sender.username, function (avatarAsPng) {
      notification.icon = avatarAsPng;
      return KonchatNotification.notify(notification);
    });
  },

  newMessage(rid) {
    if (Session.equals("user_".concat(Meteor.user().username, "_status"), 'busy')) {
      return;
    }

    const userId = Meteor.userId();
    const newMessageNotification = getUserPreference(userId, 'newMessageNotification');
    const audioVolume = getUserPreference(userId, 'notificationsSoundVolume');
    const sub = ChatSubscription.findOne({
      rid
    }, {
      fields: {
        audioNotificationValue: 1
      }
    });

    if (!sub || sub.audioNotificationValue === 'none') {
      return;
    }

    try {
      if (sub.audioNotificationValue && sub.audioNotificationValue !== '0') {
        CustomSounds.play(sub.audioNotificationValue, {
          volume: Number((audioVolume / 100).toPrecision(2))
        });
        return;
      }

      if (newMessageNotification !== 'none') {
        CustomSounds.play(newMessageNotification, {
          volume: Number((audioVolume / 100).toPrecision(2))
        });
      }
    } catch (e) {// do nothing
    }
  },

  newRoom(rid
  /* , withSound = true*/
  ) {
    Tracker.nonreactive(function () {
      let newRoomSound = Session.get('newRoomSound');

      if (newRoomSound != null) {
        newRoomSound = _.union(newRoomSound, [rid]);
      } else {
        newRoomSound = [rid];
      }

      return Session.set('newRoomSound', newRoomSound);
    });
  },

  // $('.link-room-' + rid).addClass('new-room-highlight')
  removeRoomNotification(rid) {
    let newRoomSound = Session.get('newRoomSound');
    newRoomSound = _.without(newRoomSound, rid);
    Tracker.nonreactive(() => Session.set('newRoomSound', newRoomSound));
    return $(".link-room-".concat(rid)).removeClass('new-room-highlight');
  }

};
Meteor.startup(() => {
  Tracker.autorun(function () {
    const user = Users.findOne(Meteor.userId(), {
      fields: {
        'settings.preferences.newRoomNotification': 1,
        'settings.preferences.notificationsSoundVolume': 1
      }
    });
    const newRoomNotification = getUserPreference(user, 'newRoomNotification');
    const audioVolume = getUserPreference(user, 'notificationsSoundVolume');

    if ((Session.get('newRoomSound') || []).length > 0) {
      Meteor.defer(function () {
        if (newRoomNotification !== 'none') {
          CustomSounds.play(newRoomNotification, {
            volume: Number((audioVolume / 100).toPrecision(2))
          });
        }
      });
    } else {
      CustomSounds.pause(newRoomNotification);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"parentTemplate.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/parentTemplate.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 0);

/**
 * Get the parent template instance
 * @param {Number} [levels] How many levels to go up. Default is 1
 * @returns {Blaze.TemplateInstance}
 */
Blaze.TemplateInstance.prototype.parentTemplate = function (levels) {
  let view = Blaze.currentView;

  if (typeof levels === 'undefined') {
    levels = 1;
  }

  while (view) {
    if (view.name.substring(0, 9) === 'Template.' && !levels--) {
      return view.templateInstance();
    }

    view = view.parentView;
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocket.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/rocket.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Login: () => Login,
  Button: () => Button
});

const Login = function () {
  function onClick(el) {
    const $el = $(el);

    if ($el.length) {
      $el.addClass('active');
      return $el.find('input').focus();
    }
  }

  function onBlur(input) {
    const $input = $(input);

    if ($input.length) {
      if (input.value === '') {
        return $input.parents('.input-text').removeClass('active');
      }
    }
  }

  function check(form) {
    const $form = $(form);

    if ($form.length) {
      const inputs = $form.find('input');
      return inputs.each(function () {
        if (this.value !== '') {
          console.log(this.value);
          return $(this).parents('.input-text').addClass('active');
        }
      });
    }
  }

  return {
    check,
    onClick,
    onBlur
  };
}();

const Button = function () {
  let time = undefined;

  const loading = function (el) {
    const next = el.attr('data-loading-text');
    const html = el.find('span').html();
    el.addClass('-progress').attr('data-def-text', html).find('span').html(next);
    time = setTimeout(() => el.addClass('going'), 1);
    return time;
  };

  const done = function (el) {
    return el.addClass('done');
  };

  const reset = function (el) {
    if (time) {
      clearTimeout(time);
    }

    const $el = $(el);
    const html = $el.attr('data-def-text');

    if (html) {
      $el.find('span').html(html);
    }

    return $el.removeClass('-progress going done');
  };

  return {
    done,
    loading,
    reset
  };
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"textarea-cursor.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/textarea-cursor.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// http://stackoverflow.com/a/499158
$.fn.setCursorPosition = function (pos) {
  this.each((index, element) => {
    const p = pos < 0 ? element.value.length - pos : pos;

    if (element.setSelectionRange) {
      element.setSelectionRange(p, p);
    } else if (element.createTextRange) {
      const range = element.createTextRange();
      range.collapse(true);
      range.moveEnd('character', p);
      range.moveStart('character', p);
      range.select();
    }
  });
  return this;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userPopoverStatus.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/userPopoverStatus.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getPopoverStatusConfig: () => getPopoverStatusConfig
});
let t;
module.link("../../../utils", {
  t(v) {
    t = v;
  }

}, 0);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 1);

const getPopoverStatusConfig = (currentTarget, actionCallback) => {
  const items = [{
    icon: 'circle',
    name: t('Online'),
    modifier: 'online',
    action: () => {
      typeof actionCallback === 'function' && actionCallback('online');
      $('input[name=statusType]').val('online');
      $(currentTarget).prop('class', 'rc-input__icon js-status-type edit-status-type-icon--online');
    }
  }, {
    icon: 'circle',
    name: t('Away'),
    modifier: 'away',
    action: () => {
      typeof actionCallback === 'function' && actionCallback('away');
      $('input[name=statusType]').val('away');
      $(currentTarget).prop('class', 'rc-input__icon js-status-type edit-status-type-icon--away');
    }
  }, {
    icon: 'circle',
    name: t('Busy'),
    modifier: 'busy',
    action: () => {
      typeof actionCallback === 'function' && actionCallback('busy');
      $('input[name=statusType]').val('busy');
      $(currentTarget).prop('class', 'rc-input__icon js-status-type edit-status-type-icon--busy');
    }
  }];

  if (settings.get('Accounts_AllowInvisibleStatusOption')) {
    items.push({
      icon: 'circle',
      name: t('Invisible'),
      modifier: 'offline',
      action: () => {
        typeof actionCallback === 'function' && actionCallback('offline');
        $('input[name=statusType]').val('offline');
        $(currentTarget).prop('class', 'rc-input__icon js-status-type edit-status-type-icon--offline');
      }
    });
  }

  return {
    popoverClass: 'edit-status-type',
    columns: [{
      groups: [{
        items
      }]
    }],
    currentTarget,
    offsetVertical: currentTarget.clientHeight
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"components":{"header":{"header.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/header/header.html                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.header.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.header.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/header/template.header.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("header");
Template["header"] = new Template("Template.header", (function() {
  var view = this;
  return HTML.HEADER({
    class: "rc-header"
  }, "\n\t\t", HTML.DIV({
    class: "rc-header__wrap"
  }, "\n\t\t\t", HTML.DIV({
    class: "rc-header__block rc-header--burger"
  }, "\n\t\t\t\t", Spacebars.include(view.lookupTemplate("burger")), "\n\t\t\t"), "\n\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("rawSectionName"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.SPAN({
      class: "rc-header__block"
    }, Blaze.View("lookup:rawSectionName", function() {
      return Spacebars.mustache(view.lookup("rawSectionName"));
    })), "\n\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t", HTML.SPAN({
      class: "rc-header__block"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), view.lookup("sectionName"));
    })), "\n\t\t\t" ];
  }), "\n\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.templateContentBlock);
  }, function() {
    return [ "\n\t\t\t\t", Blaze._InOuterTemplateScope(view, function() {
      return Spacebars.include(function() {
        return Spacebars.call(view.templateContentBlock);
      });
    }), "\n\t\t\t" ];
  }), "\n\n\t\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("hideHelp"));
  }, function() {
    return HTML.Raw('\n\t\t\t\t<div class="rc-header__section-help"></div>\n\t\t\t');
  }), "\n\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("toolbarButtons"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "iframe-toolbar"
    }, "\n\t\t\t\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("buttons"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.BUTTON({
        class: function() {
          return Spacebars.mustache(view.lookup("id"));
        }
      }, "\n\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("icon"));
      }, function() {
        return HTML.I({
          class: function() {
            return Spacebars.mustache(view.lookup("icon"));
          }
        });
      }), "\n\t\t\t\t\t\t", Blaze.View("lookup:label", function() {
        return Spacebars.mustache(view.lookup("label"));
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"header.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/header/header.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let fireGlobalEvent;
module.link("../../../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 1);
module.link("./header.html");
Template.header.helpers({
  back() {
    return Template.instance().data.back;
  },

  buttons() {
    console.log('asdasd');
  }

});
Template.header.events({
  'click .iframe-toolbar .js-iframe-action'(e) {
    fireGlobalEvent('click-toolbar-button', {
      id: this.id
    });
    e.currentTarget.querySelector('button').blur();
    return false;
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"icon.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/icon.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.icon.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.icon.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.icon.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("icon");
Template["icon"] = new Template("Template.icon", (function() {
  var view = this;
  return HTML.SVG({
    class: function() {
      return [ "rc-icon ", Spacebars.mustache(view.lookup("block")), " ", Spacebars.mustache(view.lookup("block")), "--", Spacebars.mustache(view.lookup("icon")), " ", Spacebars.mustache(view.lookup("classes")) ];
    },
    "aria-hidden": "true"
  }, "\n\t\t", HTML.USE({
    "xlink:href": function() {
      return [ Spacebars.mustache(view.lookup("baseUrl")), "#icon-", Spacebars.mustache(view.lookup("icon")) ];
    }
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popupList.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/popupList.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.popupList.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.popupList.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.popupList.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("popupList");
Template["popupList"] = new Template("Template.popupList", (function() {
  var view = this;
  return HTML.DIV({
    class: "rc-popup-list"
  }, "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("config"));
  }, function() {
    return Spacebars.include(function() {
      return Spacebars.call(Template.__dynamic);
    });
  }), "\n\t");
}));

Template.__checkName("popupList_default");
Template["popupList_default"] = new Template("Template.popupList_default", (function() {
  var view = this;
  return HTML.UL({
    class: "rc-popup-list__list"
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("loading"));
  }, function() {
    return [ "\n\t\t\t", Spacebars.include(view.lookupTemplate("popupList_loading")), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("items")),
        _variable: "item"
      };
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return Spacebars.dataMustache(view.lookup("config"), view.lookup("item"), Spacebars.kw({
          data: view.lookup("data")
        }));
      }, function() {
        return Spacebars.include(function() {
          return Spacebars.call(Template.__dynamic);
        });
      }), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          template: Spacebars.call(view.lookup("noMatchTemplate"))
        };
      }, function() {
        return Spacebars.include(function() {
          return Spacebars.call(Template.__dynamic);
        });
      }), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t");
}));

Template.__checkName("popupList_item_default");
Template["popupList_item_default"] = new Template("Template.popupList_item_default", (function() {
  var view = this;
  return HTML.LI({
    class: "rc-popup-list__item"
  }, "\n\t\t ", HTML.SPAN({
    class: "rc-popup-list__item-image"
  }, "\n\t\t\t ", Blaze._TemplateWith(function() {
    return {
      username: Spacebars.call(Spacebars.dot(view.lookup("item"), "username"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("avatar"));
  }), "\n\t\t "), "\n\t\t ", Blaze.If(function() {
    return Spacebars.call(view.lookup("showRealNames"));
  }, function() {
    return [ "\n\t\t \t", HTML.SPAN({
      class: "rc-popup-list__item-name"
    }, Blaze.View("lookup:modifier", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "name")));
    }), Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("item"), "nickname"));
    }, function() {
      return [ " (", Blaze.View("lookup:modifier", function() {
        return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "nickname")));
      }), ")" ];
    }), " (", Blaze.View("lookup:modifier", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "username")));
    }), ")"), "\n\t\t " ];
  }, function() {
    return [ "\n\t\t \t", HTML.SPAN({
      class: "rc-popup-list__item-name"
    }, Blaze.View("lookup:modifier", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "username")));
    }), Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("item"), "nickname"));
    }, function() {
      return [ " (", Blaze.View("lookup:item.nickname", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "nickname"));
      }), ")" ];
    })), "\n\t\t " ];
  }), "\n\t");
}));

Template.__checkName("popupList_loading");
Template["popupList_loading"] = new Template("Template.popupList_loading", (function() {
  var view = this;
  return HTML.P(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Loading");
  }), ".");
}));

Template.__checkName("popupList_item_channel");
Template["popupList_item_channel"] = new Template("Template.popupList_item_channel", (function() {
  var view = this;
  return HTML.LI({
    class: "rc-popup-list__item"
  }, "\n\t\t ", HTML.SPAN({
    class: "rc-popup-list__item-image"
  }, "\n\t\t\t ", Blaze._TemplateWith(function() {
    return {
      username: Spacebars.call(Spacebars.dot(view.lookup("item"), "name")),
      roomIcon: Spacebars.call(true)
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("avatar"));
  }), "\n\t\t "), "\n\t\t ", HTML.SPAN({
    class: "rc-popup-list__item-name"
  }, Blaze.View("lookup:modifier", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "name")));
  })), "\n\t");
}));

Template.__checkName("popupList_item_custom");
Template["popupList_item_custom"] = new Template("Template.popupList_item_custom", (function() {
  var view = this;
  return HTML.LI({
    class: "rc-popup-list__item"
  }, "\n\t\t", HTML.SPAN({
    class: "rc-popup-list__item-image"
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      username: Spacebars.call(Spacebars.dot(view.lookup("item"), "custom_name")),
      roomIcon: Spacebars.call(true)
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("avatar"));
  }), "\n\t\t"), "\n\t\t", HTML.SPAN({
    class: "rc-popup-list__item-name"
  }, Blaze.View("lookup:modifier", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "custom_name")));
  })), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"selectDropdown.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/selectDropdown.html                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.selectDropdown.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.selectDropdown.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.selectDropdown.js                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("selectDropdown");
Template["selectDropdown"] = new Template("Template.selectDropdown", (function() {
  var view = this;
  return HTML.DIV({
    class: "rc-input rc-input--small"
  }, "\n\t\t", HTML.LABEL({
    class: "rc-input__label"
  }, "\n\t\t\t", HTML.DIV({
    class: "rc-input__title"
  }, Blaze.View("lookup:title", function() {
    return Spacebars.mustache(view.lookup("title"));
  })), "\n\t\t\t", HTML.DIV({
    class: "rc-input__wrapper"
  }, "\n\t\t\t\t", HTML.SELECT({
    type: "text",
    class: "rc-input__element",
    placeholder: function() {
      return Spacebars.mustache(view.lookup("placeholder"));
    },
    name: function() {
      return Spacebars.mustache(view.lookup("name"));
    }
  }, "\n\t\t\t\t\t", Blaze.Each(function() {
    return {
      _sequence: Spacebars.call(view.lookup("options")),
      _variable: "option"
    };
  }, function() {
    return [ "\n\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("option"), "selected"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.OPTION({
        value: function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("option"), "value"));
        },
        selected: ""
      }, Blaze.View("lookup:option.title", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("option"), "title"));
      })), "\n\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.OPTION({
        value: function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("option"), "value"));
        }
      }, Blaze.View("lookup:option.title", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("option"), "title"));
      })), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t" ];
  }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"table.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/table.html                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.table.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.table.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.table.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("table");
Template["table"] = new Template("Template.table", (function() {
  var view = this;
  return HTML.DIV({
    class: "table-wrapper"
  }, "\n\t\t", HTML.DIV({
    class: "table-content-wrapper"
  }, "\n\t\t\t", HTML.DIV({
    class: "table-content"
  }, "\n\t\t\t\t", HTML.DIV({
    class: "table-scroll"
  }, "\n\t\t\t\t\t", HTML.TABLE({
    class: function() {
      return [ "rc-table ", Blaze.If(function() {
        return Spacebars.call(view.lookup("fixed"));
      }, function() {
        return "rc-table--fixed";
      }) ];
    }
  }, "\n\t\t\t\t\t\t\t", Blaze._InOuterTemplateScope(view, function() {
    return Spacebars.include(function() {
      return Spacebars.call(view.templateContentBlock);
    });
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabs.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/tabs.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.tabs.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.tabs.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.tabs.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("tabs");
Template["tabs"] = new Template("Template.tabs", (function() {
  var view = this;
  return HTML.DIV({
    class: "tabs"
  }, "\n\t\t", HTML.DIV({
    class: "tabs-wrapper",
    role: "tablist"
  }, "\n\t\t\t", Blaze.Each(function() {
    return {
      _sequence: Spacebars.call(view.lookup("tabs")),
      _variable: "tab"
    };
  }, function() {
    return [ "\n\t\t\t\t", HTML.BUTTON(HTML.Attrs({
      class: function() {
        return [ "tab ", Blaze.If(function() {
          return Spacebars.dataMustache(view.lookup("isActive"), Spacebars.dot(view.lookup("tab"), "value"));
        }, function() {
          return "active";
        }) ];
      },
      "data-value": function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("tab"), "value"));
      },
      role: "tab"
    }, function() {
      return Spacebars.attrMustache(view.lookup("ariaSelected"), Spacebars.dot(view.lookup("tab"), "value"));
    }), "\n\t\t\t\t\t", HTML.SPAN({
      tabindex: "-1"
    }, Blaze.View("lookup:tab.label", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("tab"), "label"));
    })), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tooltip.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/tooltip.html                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.tooltip.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.tooltip.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.tooltip.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("tooltip");
Template["tooltip"] = new Template("Template.tooltip", (function() {
  var view = this;
  return HTML.Raw('<div class="tooltip">\n\t\t<div class="content">\n\t\t</div>\n\t\t<div class="tooltip-arrow"></div>\n\t</div>');
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"icon.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/icon.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let baseURI;
module.link("../../../../client/lib/baseURI", {
  baseURI(v) {
    baseURI = v;
  }

}, 2);
module.link("./icon.html");

const baseUrlFix = () => "".concat(baseURI).concat(FlowRouter.current().path.substring(1));

const isMozillaFirefoxBelowVersion = upperVersion => {
  const [, version] = navigator.userAgent.match(/Firefox\/(\d+)\.\d/) || [];
  return parseInt(version, 10) < upperVersion;
};

const isGoogleChromeBelowVersion = upperVersion => {
  const [, version] = navigator.userAgent.match(/Chrome\/(\d+)\.\d/) || [];
  return parseInt(version, 10) < upperVersion;
};

const isBaseUrlFixNeeded = () => isMozillaFirefoxBelowVersion(55) || isGoogleChromeBelowVersion(55);

Template.icon.helpers({
  baseUrl: isBaseUrlFixNeeded() ? baseUrlFix : undefined
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popupList.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/popupList.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);
Template.popupList.helpers({
  config() {
    return {
      template: this.data.template_list || 'popupList_default',
      data: {
        ready: this.ready,
        loading: this.ready !== undefined && !this.ready,
        noMatchTemplate: this.data.noMatchTemplate,
        template_item: this.data.template_item || 'popupList_item_default',
        items: this.items,
        onClick: this.data.onClick || function () {},
        modifier: this.data.modifier || function (text) {
          return text;
        }
      }
    };
  },

  open() {
    const instance = Template.instance();
    return instance.data.items.length > 0;
  }

});
Template.popupList_default.helpers({
  config(item) {
    return {
      template: this.template_item || 'popupList_item_default',
      data: {
        item,
        onClick: this.onClick,
        modifier: this.modifier
      }
    };
  }

});
Template.popupList_item_default.helpers({
  showRealNames() {
    return settings.get('UI_Use_Real_Name');
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"table.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/table.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 1);
Template.table.onRendered(function () {
  const dummyTr = '<tr class="table-tr-dummy"></tr>';
  this.$('tbody').prepend(dummyTr).append(dummyTr);
  this.onResize = this.data.onResize;

  if (this.onResize) {
    this.onResize();
    $(window).on('resize', this.onResize);
  }
});
Template.table.onDestroyed(function () {
  $(window).on('off', this.onResize);
});
Template.table.events({
  'click tbody tr:not(.table-no-click)'(e, t) {
    t.data.onItemClick && t.data.onItemClick(this);
  },

  'scroll .table-scroll': _.debounce((e, t) => t.data.onScroll && t.data.onScroll(e.currentTarget), 300),

  'click .js-sort'(e, t) {
    t.data.onSort(e.currentTarget.dataset.sort);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabs.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/tabs.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
module.link("./tabs.html");
Template.tabs.onCreated(function () {
  this.activeTab = new ReactiveVar(this.data.tabs.tabs.find(tab => tab.active).value);
});
Template.tabs.events({
  'click .tab'(event, instance) {
    const {
      value
    } = event.currentTarget.dataset;

    if (value === instance.activeTab.get()) {
      return;
    }

    instance.activeTab.set(value);
    instance.data.tabs.onChange(value);
  }

});
Template.tabs.helpers({
  tabs() {
    return Template.instance().data.tabs.tabs.filter(tab => tab.condition ? tab.condition() : tab);
  },

  isActive(value) {
    return Template.instance().activeTab.get() === value;
  },

  ariaSelected(value) {
    return Template.instance().activeTab.get() === value ? {
      'aria-selected': 'true'
    } : {};
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tooltip.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/tooltip.css                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tooltip.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/tooltip.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  tooltip: () => tooltip
});
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 1);
module.link("./tooltip.html");
module.link("./tooltip.css");
let initiated = false;

const init = () => {
  if (initiated) {
    return;
  }

  initiated = true;
  Blaze.render(Template.tooltip, document.body);
};

let source = null;
let opened = false;
let timeout = null;

const placeTip = () => {
  const arrowSize = 6;
  const sourceWidth = $(source).outerWidth();
  const sourceHeight = $(source).outerHeight();
  let {
    left,
    top
  } = $(source).offset();
  const tip = $('.tooltip');
  const tipWidth = tip.outerWidth();
  const tipHeight = tip.outerHeight();
  left = left + sourceWidth / 2 - tipWidth / 2;
  $('.tooltip-arrow', tip).css({
    'margin-left': left < 0 ? "".concat(left - arrowSize, "px") : ''
  });

  if (left < 0) {
    left = 0;
  }

  top = top - tipHeight - arrowSize;
  tip.toggleClass('below', top < 0);

  if (top < 0) {
    top = top + sourceHeight + arrowSize;
  }

  return tip.css({
    left: "".concat(left, "px"),
    top: "".concat(top, "px")
  });
};

const showElement = (element, sourceElement) => {
  if (opened) {
    return;
  }

  if (timeout) {
    clearTimeout(timeout);
  }

  const elementClone = $(element).clone();
  timeout = setTimeout(() => {
    timeout = null;
    source = sourceElement;
    $('.tooltip .content').empty().append(elementClone.show());
    placeTip().addClass('show');
    opened = true;
  }, 300);
};

const hide = () => {
  if (timeout) {
    clearTimeout(timeout);
  }

  if (opened) {
    $('.tooltip').removeClass('show');
    $('.tooltip .content').empty();
    opened = false;
  }
};

const tooltip = {
  init,
  showElement,
  hide
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"views":{"app":{"burger.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/burger.html                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.burger.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.burger.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.burger.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("burger");
Template["burger"] = new Template("Template.burger", (function() {
  var view = this;
  return HTML.DIV({
    class: function() {
      return [ "rc-old burger ", Spacebars.mustache(view.lookup("isMenuOpen")) ];
    }
  }, HTML.Raw("\n\t\t<i></i>\n\t\t<i></i>\n\t\t<i></i>\n\t\t"), Blaze.Unless(function() {
    return Spacebars.call(view.lookup("embeddedVersion"));
  }, function() {
    return [ "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("unread"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: "unread-burger-alert color-error-contrast background-error-color"
      }, "\n\t\t\t\t\t", Blaze.View("lookup:unread", function() {
        return Spacebars.mustache(view.lookup("unread"));
      }), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"home.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/home.html                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.home.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.home.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.home.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("home");
Template["home"] = new Template("Template.home", (function() {
  var view = this;
  return HTML.SECTION({
    class: "page-container page-home page-static content-background-color"
  }, "\n\t\t", Blaze._TemplateWith(function() {
    return {
      sectionName: Spacebars.call(view.lookup("title"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("header"));
  }), "\n\t\t", HTML.DIV({
    class: "content"
  }, "\n\t\t\t", Blaze.View("lookup:body", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("body")));
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"notAuthorized.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/notAuthorized.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.notAuthorized.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.notAuthorized.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.notAuthorized.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("notAuthorized");
Template["notAuthorized"] = new Template("Template.notAuthorized", (function() {
  var view = this;
  return HTML.H2(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Access_not_authorized");
  }));
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"pageContainer.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/pageContainer.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.pageContainer.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.pageContainer.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.pageContainer.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("pageContainer");
Template["pageContainer"] = new Template("Template.pageContainer", (function() {
  var view = this;
  return HTML.SECTION({
    class: "page-container page-home page-static page-list content-background-color"
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("i18nPageTitle"));
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        sectionName: Spacebars.call(view.lookup("i18nPageTitle"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("header"));
    }), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        sectionName: Spacebars.call(view.lookup("pageTitle"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("header"));
    }), "\n\t\t" ];
  }), "\n\t\t", HTML.DIV({
    class: "content"
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      template: Spacebars.call(view.lookup("pageTemplate"))
    };
  }, function() {
    return Spacebars.include(function() {
      return Spacebars.call(Template.__dynamic);
    });
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"pageCustomContainer.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/pageCustomContainer.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.pageCustomContainer.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.pageCustomContainer.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.pageCustomContainer.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("pageCustomContainer");
Template["pageCustomContainer"] = new Template("Template.pageCustomContainer", (function() {
  var view = this;
  return Blaze._TemplateWith(function() {
    return {
      template: Spacebars.call(view.lookup("pageTemplate"))
    };
  }, function() {
    return Spacebars.include(function() {
      return Spacebars.call(Template.__dynamic);
    });
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"photoswipeContent.html":[
  "./template.photoswipeContent.js"
],"template.photoswipeContent.js":[],"room.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/room.html                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.room.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.room.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.room.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("roomOld");
Template["roomOld"] = new Template("Template.roomOld", (function() {
  var view = this;
  return HTML.DIV({
    class: "main-content-flex"
  }, "\n\t\t", HTML.SECTION({
    class: function() {
      return [ "messages-container flex-tab-main-content ", Spacebars.mustache(view.lookup("adminClass")) ];
    },
    id: function() {
      return Spacebars.mustache(view.lookup("windowId"));
    },
    "aria-label": function() {
      return Spacebars.mustache(view.lookup("_"), "Channel");
    }
  }, "\n\t\t\t", HTML.DIV({
    class: "messages-container-wrapper"
  }, "\n\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "messages-container-main dropzone ", Spacebars.mustache(view.lookup("dragAndDrop")) ];
    }
  }, "\n\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "dropzone-overlay ", Spacebars.mustache(view.lookup("isDropzoneDisabled")), " background-transparent-darkest color-content-background-color" ];
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), view.lookup("dragAndDropLabel"));
  })), "\n\t\t\t\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("embeddedVersion"));
  }, function() {
    return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        announcement: Spacebars.call(view.lookup("announcement")),
        announcementDetails: Spacebars.call(view.lookup("announcementDetails"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("RoomAnnouncement"));
    }), "\n\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "container-bars ", Spacebars.mustache(view.lookup("containerBarsShow"), view.lookup("unreadData"), view.lookup("uploading")) ];
    }
  }, "\n\t\t\t\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("unreadData"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("since"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("count"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
          class: "unread-bar color-primary-action-color background-component-color"
        }, "\n\t\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
          class: "jump-to"
        }, "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
          class: "jump-to-large"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Jump_to_first_unread");
        })), "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
          class: "jump-to-small"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Jump");
        })), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
          class: "unread-count-since"
        }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "S_new_messages_since_s", view.lookup("count"), view.lookup("formatUnreadSince"));
        }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
          class: "unread-count"
        }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "N_new_messages", view.lookup("count"));
        }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
          class: "mark-read"
        }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Mark_as_read");
        }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t", Blaze.Each(function() {
    return Spacebars.call(view.lookup("uploading"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: function() {
        return [ "upload-progress color-primary-action-color background-component-color ", Blaze.If(function() {
          return Spacebars.call(view.lookup("error"));
        }, function() {
          return "error-background error-border";
        }) ];
      }
    }, "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("error"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
        class: "upload-progress-text"
      }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:error", function() {
        return Spacebars.mustache(view.lookup("error"));
      }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "upload-progress-close"
      }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "close");
      }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
        class: "upload-progress-progress",
        style: function() {
          return [ "width: ", Spacebars.mustache(view.lookup("percentage")), "%;" ];
        }
      }), "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
        class: "upload-progress-text"
      }, "\n\t\t\t\t\t\t\t\t\t\t[", Blaze.View("lookup:percentage", function() {
        return Spacebars.mustache(view.lookup("percentage"));
      }), "%] ", Blaze.View("lookup:name", function() {
        return Spacebars.mustache(view.lookup("name"));
      }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "upload-progress-close"
      }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Cancel");
      }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "messages-box ", Blaze.If(function() {
        return Spacebars.call(view.lookup("selectable"));
      }, function() {
        return "selectable";
      }), " ", Spacebars.mustache(view.lookup("messageViewMode")), " ", Spacebars.mustache(view.lookup("hasLeader")) ];
    }
  }, HTML.Raw('\n\t\t\t\t\t\t<div class="ticks-bar"></div>\n\t\t\t\t\t\t'), HTML.BUTTON({
    class: "new-message background-primary-action-color color-content-background-color not"
  }, HTML.Raw('\n\t\t\t\t\t\t\t<i class="icon-down-big"></i>\n\t\t\t\t\t\t\t'), Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "New_messages");
  }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "jump-recent background-component-color ", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("hasMoreNext"));
      }, function() {
        return "not";
      }) ];
    }
  }, "\n\t\t\t\t\t\t\t", HTML.BUTTON(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Jump_to_recent_messages");
  }), HTML.Raw(' <i class="icon-level-down"></i>')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("canPreview"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "content room-not-found error-color"
    }, "\n\t\t\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "You_must_join_to_view_messages_in_this_channel");
    }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("roomLeader"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: function() {
        return [ "room-leader message color-primary-font-color content-background-color border-component-color ", Spacebars.mustache(view.lookup("hideLeaderHeader")) ];
      }
    }, "\n\t\t\t\t\t\t\t\t", HTML.BUTTON({
      class: "thumb user-card-message"
    }, "\n\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        username: Spacebars.call(view.lookup("username"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("avatar"));
    }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
      class: "leader-name"
    }, Blaze.View("lookup:name", function() {
      return Spacebars.mustache(view.lookup("name"));
    })), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
      class: "leader-status userStatus"
    }, "\n\t\t\t\t\t\t\t\t\t", HTML.SPAN({
      class: function() {
        return [ "color-ball status-bg-", Spacebars.mustache(view.lookup("status")) ];
      }
    }), "\n\t\t\t\t\t\t\t\t\t", HTML.SPAN({
      class: "status-text leader-status-text"
    }, Blaze.View("lookup:statusDisplay", function() {
      return Spacebars.mustache(view.lookup("statusDisplay"));
    })), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t", HTML.A({
      class: "chat-now",
      href: function() {
        return Spacebars.mustache(view.lookup("chatNowLink"));
      }
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Chat_Now");
    })), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "wrapper ", Blaze.If(function() {
        return Spacebars.call(view.lookup("hasMoreNext"));
      }, function() {
        return "has-more-next";
      }), " ", Spacebars.mustache(view.lookup("hideUsername")), " ", Spacebars.mustache(view.lookup("hideAvatar")) ];
    }
  }, "\n\t\t\t\t\t\t\t", HTML.UL({
    "aria-live": "polite"
  }, "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("canPreview"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("hasMore"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.LI({
        class: "load-more"
      }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isLoading"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t\t\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.LI({
        class: "start color-info-font-color"
      }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("hasPurge"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
          class: "start__purge-warning error-background error-border error-color"
        }, "\n\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call("start__purge-warning-icon"),
            icon: Spacebars.call("warning")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.Unless(function() {
          return Spacebars.call(view.lookup("filesOnly"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.Unless(function() {
            return Spacebars.call(view.lookup("excludePinned"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "RetentionPolicy_RoomWarning", Spacebars.kw({
                time: view.lookup("purgeTimeout")
              }));
            }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "RetentionPolicy_RoomWarning_Unpinned", Spacebars.kw({
                time: view.lookup("purgeTimeout")
              }));
            }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.Unless(function() {
            return Spacebars.call(view.lookup("excludePinned"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "RetentionPolicy_RoomWarning_FilesOnly", Spacebars.kw({
                time: view.lookup("purgeTimeout")
              }));
            }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "RetentionPolicy_RoomWarning_UnpinnedFilesOnly", Spacebars.kw({
                time: view.lookup("purgeTimeout")
              }));
            }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t\t" ];
      }), "\n\n\t\t\t\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("RoomForeword")), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t\t\t" ];
  }), "\n\n\t\t\t\t\t\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("messagesHistory")),
        _variable: "msg"
      };
    }, function() {
      return Blaze._TemplateWith(function() {
        return {
          showRoles: Spacebars.call(true),
          index: Spacebars.call(view.lookup("@index")),
          shouldCollapseReplies: Spacebars.call(false),
          msg: Spacebars.call(view.lookup("msg")),
          room: Spacebars.call(view.lookup("room")),
          actions: Spacebars.call(view.lookup("actions")),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          u: Spacebars.call(view.lookup("u"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      });
    }), "\n\t\t\t\t\t\t\t\t" ];
  }), "\n\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasMoreNext"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t\t\t", HTML.LI({
      class: "load-more"
    }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isLoading"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.FOOTER({
    class: "footer border-component-color"
  }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("messageboxData"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messageBox"));
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomSearch.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/roomSearch.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.roomSearch.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.roomSearch.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.roomSearch.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("roomSearch");
Template["roomSearch"] = new Template("Template.roomSearch", (function() {
  var view = this;
  return [ HTML.I({
    class: function() {
      return [ Spacebars.mustache(view.lookup("roomIcon")), " ", Spacebars.mustache(view.lookup("userStatus")) ];
    }
  }), " ", Blaze.View("lookup:name", function() {
    return Spacebars.mustache(view.lookup("name"));
  }) ];
}));

Template.__checkName("roomSearchEmpty");
Template["roomSearchEmpty"] = new Template("Template.roomSearchEmpty", (function() {
  var view = this;
  return HTML.P({
    class: function() {
      return Spacebars.mustache(view.lookup("class"));
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Nothing_found");
  }), ".");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userSearch.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/userSearch.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.userSearch.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.userSearch.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.userSearch.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("userSearch");
Template["userSearch"] = new Template("Template.userSearch", (function() {
  var view = this;
  return [ HTML.I({
    class: function() {
      return [ "icon-at status-", Spacebars.mustache(view.lookup("status")) ];
    }
  }), " ", Blaze.View("lookup:username", function() {
    return Spacebars.mustache(view.lookup("username"));
  }), Blaze.If(function() {
    return Spacebars.call(view.lookup("name"));
  }, function() {
    return [ " - ", HTML.STRONG(Blaze.View("lookup:name", function() {
      return Spacebars.mustache(view.lookup("name"));
    })) ];
  }) ];
}));

Template.__checkName("userSearchEmpty");
Template["userSearchEmpty"] = new Template("Template.userSearchEmpty", (function() {
  var view = this;
  return HTML.P(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Nothing_found");
  }), ".");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"lib":{"getCommonRoomEvents.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/lib/getCommonRoomEvents.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  getCommonRoomEvents: () => getCommonRoomEvents
});
let Clipboard;
module.link("clipboard", {
  default(v) {
    Clipboard = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 2);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 3);
let popover, MessageAction;
module.link("../../../../../ui-utils/client", {
  popover(v) {
    popover = v;
  },

  MessageAction(v) {
    MessageAction = v;
  }

}, 4);
let addMessageToList;
module.link("../../../../../ui-utils/client/lib/MessageAction", {
  addMessageToList(v) {
    addMessageToList = v;
  }

}, 5);
let callWithErrorHandling;
module.link("../../../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 6);
let isURL;
module.link("../../../../../utils/lib/isURL", {
  isURL(v) {
    isURL = v;
  }

}, 7);
let openUserCard;
module.link("../../../lib/UserCard", {
  openUserCard(v) {
    openUserCard = v;
  }

}, 8);
let messageArgs;
module.link("../../../../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 9);
let ChatMessage, Rooms, Messages;
module.link("../../../../../models", {
  ChatMessage(v) {
    ChatMessage = v;
  },

  Rooms(v) {
    Rooms = v;
  },

  Messages(v) {
    Messages = v;
  }

}, 10);
let t;
module.link("../../../../../utils/client", {
  t(v) {
    t = v;
  }

}, 11);
let chatMessages;
module.link("../room", {
  chatMessages(v) {
    chatMessages = v;
  }

}, 12);
let EmojiEvents;
module.link("../../../../../reactions/client/init", {
  EmojiEvents(v) {
    EmojiEvents = v;
  }

}, 13);
let goToRoomById;
module.link("../../../../../../client/lib/utils/goToRoomById", {
  goToRoomById(v) {
    goToRoomById = v;
  }

}, 14);
let fireGlobalEvent;
module.link("../../../../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 15);
let isLayoutEmbedded;
module.link("../../../../../../client/lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded(v) {
    isLayoutEmbedded = v;
  }

}, 16);
let onClientBeforeSendMessage;
module.link("../../../../../../client/lib/onClientBeforeSendMessage", {
  onClientBeforeSendMessage(v) {
    onClientBeforeSendMessage = v;
  }

}, 17);

const mountPopover = (e, i, outerContext) => {
  let context = $(e.target).parents('.message').data('context');

  if (!context) {
    context = 'message';
  }

  const messageContext = messageArgs(outerContext);
  let menuItems = MessageAction.getButtons(messageContext, context, 'menu').map(item => ({
    icon: item.icon,
    name: t(item.label),
    type: 'message-action',
    id: item.id,
    modifier: item.color
  }));

  if (window.matchMedia('(max-width: 500px)').matches) {
    const messageItems = MessageAction.getButtons(messageContext, context, 'message').map(item => ({
      icon: item.icon,
      name: t(item.label),
      type: 'message-action',
      id: item.id,
      modifier: item.color
    }));
    menuItems = menuItems.concat(messageItems);
  }

  const [items, deleteItem] = menuItems.reduce((result, value) => {
    result[value.id === 'delete-message' ? 1 : 0].push(value);
    return result;
  }, [[], []]);
  const groups = [{
    items
  }];

  if (deleteItem.length) {
    groups.push({
      items: deleteItem
    });
  }

  const config = {
    columns: [{
      groups
    }],
    instance: i,
    currentTarget: e.currentTarget,
    data: outerContext,
    activeElement: $(e.currentTarget).parents('.message')[0],
    onRendered: () => new Clipboard('.rc-popover__item')
  };
  popover.open(config);
};

const getCommonRoomEvents = () => _objectSpread(_objectSpread({}, (() => {
  let touchMoved = false;
  let lastTouchX = null;
  let lastTouchY = null;
  let touchtime = null;
  return _objectSpread(_objectSpread({}, EmojiEvents), {}, {
    'click .message img'(e) {
      clearTimeout(touchtime);

      if (touchMoved === true) {
        e.preventDefault();
        e.stopPropagation();
      }
    },

    'touchstart .message'(e) {
      const {
        touches
      } = e.originalEvent;

      if (touches && touches.length) {
        lastTouchX = touches[0].pageX;
        lastTouchY = touches[0].pagey;
      }

      touchMoved = false;

      if (e.originalEvent.touches.length !== 1) {
        return;
      }

      if ($(e.currentTarget).hasClass('system')) {
        return;
      }

      if (e.target && e.target.nodeName === 'AUDIO') {
        return;
      }

      if (e.target && e.target.nodeName === 'A' && isURL(e.target.getAttribute('href'))) {
        e.preventDefault();
        e.stopPropagation();
      }

      const doLongTouch = () => {
        mountPopover(e, t, this);
      };

      clearTimeout(touchtime);
      touchtime = setTimeout(doLongTouch, 500);
    },

    'touchend .message'(e) {
      clearTimeout(touchtime);

      if (e.target && e.target.nodeName === 'A' && isURL(e.target.getAttribute('href'))) {
        if (touchMoved === true) {
          e.preventDefault();
          e.stopPropagation();
          return;
        }

        window.open(e.target.href);
      }
    },

    'touchmove .message'(e) {
      const {
        touches
      } = e.originalEvent;

      if (touches && touches.length) {
        const deltaX = Math.abs(lastTouchX - touches[0].pageX);
        const deltaY = Math.abs(lastTouchY - touches[0].pageY);

        if (deltaX > 5 || deltaY > 5) {
          touchMoved = true;
        }
      }

      clearTimeout(touchtime);
    },

    'touchcancel .message'() {
      clearTimeout(touchtime);
    }

  });
})()), {}, {
  'click [data-message-action]'(event, template) {
    const button = MessageAction.getButtonById(event.currentTarget.dataset.messageAction);

    if ((button != null ? button.action : undefined) != null) {
      button.action.call(this, event, {
        tabBar: template.tabBar,
        rid: template.data.rid
      });
    }
  },

  'click .js-follow-thread'(e) {
    e.preventDefault();
    e.stopPropagation();
    const {
      msg
    } = messageArgs(this);
    callWithErrorHandling('followMessage', {
      mid: msg._id
    });
  },

  'click .js-unfollow-thread'(e) {
    e.preventDefault();
    e.stopPropagation();
    const {
      msg
    } = messageArgs(this);
    callWithErrorHandling('unfollowMessage', {
      mid: msg._id
    });
  },

  'click .js-open-thread'(event) {
    event.preventDefault();
    event.stopPropagation();
    const {
      msg: {
        rid,
        _id,
        tmid
      }
    } = messageArgs(this);
    const room = Rooms.findOne({
      _id: rid
    });
    FlowRouter.go(FlowRouter.getRouteName(), {
      rid,
      name: room.name,
      tab: 'thread',
      context: tmid || _id
    }, {
      jump: tmid && tmid !== _id && _id && _id
    });
  },

  'click .image-to-download'(event) {
    const {
      msg
    } = messageArgs(this);
    ChatMessage.update({
      '_id': msg._id,
      'urls.url': $(event.currentTarget).data('url')
    }, {
      $set: {
        'urls.$.downloadImages': true
      }
    });
    ChatMessage.update({
      '_id': msg._id,
      'attachments.image_url': $(event.currentTarget).data('url')
    }, {
      $set: {
        'attachments.$.downloadImages': true
      }
    });
  },

  'click .user-card-message'(e, instance) {
    const {
      msg
    } = messageArgs(this);

    if (!Meteor.userId()) {
      return;
    }

    const {
      username
    } = msg.u;

    if (username) {
      openUserCard({
        username,
        rid: instance.data.rid,
        target: e.currentTarget,
        open: e => {
          e.preventDefault();
          instance.data.tabBar.openUserInfo(username);
        }
      });
    }
  },

  'click .js-actionButton-respondWithMessage'(event, instance) {
    const {
      rid
    } = instance.data;
    const msg = event.currentTarget.value;

    if (!msg) {
      return;
    }

    const {
      input
    } = chatMessages[rid];
    input.value = msg;
    input.focus();
  },

  async 'click .js-actionButton-respondWithQuotedMessage'(event, instance) {
    const {
      rid
    } = instance.data;
    const {
      id: msgId
    } = event.currentTarget;
    const {
      $input
    } = chatMessages[rid];

    if (!msgId) {
      return;
    }

    const message = Messages.findOne({
      _id: msgId
    });
    let messages = $input.data('reply') || [];
    messages = addMessageToList(messages, message);
    $input.focus().data('mention-user', false).data('reply', messages).trigger('dataChange');
  },

  async 'click .js-actionButton-sendMessage'(event, instance) {
    const {
      rid
    } = instance.data;
    const msg = event.currentTarget.value;
    let msgObject = {
      _id: Random.id(),
      rid,
      msg
    };

    if (!msg) {
      return;
    }

    msgObject = await onClientBeforeSendMessage(msgObject);
    const _chatMessages = chatMessages[rid];

    if (_chatMessages && (await _chatMessages.processSlashCommand(msgObject))) {
      return;
    }

    await callWithErrorHandling('sendMessage', msgObject);
  },

  'click .message-actions__menu'(e, template) {
    const messageContext = messageArgs(this);
    const {
      msg: message,
      context: ctx
    } = messageContext;
    const context = ctx || message.context || message.actionContext || 'message';
    const allItems = MessageAction.getButtons(messageContext, context, 'menu').map(item => ({
      icon: item.icon,
      name: t(item.label),
      type: 'message-action',
      id: item.id,
      modifier: item.color
    }));
    const itemsBelowDivider = ['delete-message', 'report-message'];
    const [items, alertsItem] = allItems.reduce((result, value) => {
      result[itemsBelowDivider.includes(value.id) ? 1 : 0].push(value);
      return result;
    }, [[], []]);
    const groups = [{
      items
    }];

    if (alertsItem.length) {
      groups.push({
        items: alertsItem
      });
    }

    const config = {
      columns: [{
        groups
      }],
      instance: template,
      rid: template.data.rid,
      data: this,
      currentTarget: e.currentTarget,
      activeElement: $(e.currentTarget).parents('.message')[0],
      onRendered: () => new Clipboard('.rc-popover__item')
    };
    popover.open(config);
  },

  'click .mention-link'(e, instance) {
    e.stopPropagation();
    e.preventDefault();

    if (!Meteor.userId()) {
      return;
    }

    const {
      currentTarget: {
        dataset: {
          channel,
          group,
          username
        }
      }
    } = e;

    if (channel) {
      if (isLayoutEmbedded()) {
        fireGlobalEvent('click-mention-link', {
          path: FlowRouter.path('channel', {
            name: channel
          }),
          channel
        });
      }

      goToRoomById(channel);
      return;
    }

    if (group) {
      return;
    }

    if (username) {
      openUserCard({
        username,
        rid: instance.data.rid,
        target: e.currentTarget,
        open: e => {
          e.preventDefault();
          instance.data.tabBar.openUserInfo(username);
        }
      });
    }
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"burger.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/burger.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let ChatSubscription;
module.link("../../../../models/client", {
  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 3);
let menu;
module.link("../../../../ui-utils/client", {
  menu(v) {
    menu = v;
  }

}, 4);
let isLayoutEmbedded;
module.link("../../../../../client/lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded(v) {
    isLayoutEmbedded = v;
  }

}, 5);
let getUserPreference;
module.link("../../../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 6);
Template.burger.helpers({
  unread() {
    const userUnreadAlert = getUserPreference(Meteor.userId(), 'unreadAlert');
    const [unreadCount, unreadAlert] = ChatSubscription.find({
      open: true,
      hideUnreadStatus: {
        $ne: true
      },
      rid: {
        $ne: Session.get('openedRoom')
      },
      archived: {
        $ne: true
      }
    }, {
      fields: {
        unread: 1,
        alert: 1,
        unreadAlert: 1
      }
    }).fetch().reduce((_ref, _ref2) => {
      let [unreadCount, unreadAlert] = _ref;
      let {
        alert,
        unread,
        unreadAlert: alertType
      } = _ref2;

      if (alert || unread > 0) {
        unreadCount += unread;

        if (alert === true && alertType !== 'nothing') {
          if (alertType === 'all' || userUnreadAlert !== false) {
            unreadAlert = '•';
          }
        }
      }

      return [unreadCount, unreadAlert];
    }, [0, false]);

    if (unreadCount > 0) {
      return unreadCount > 99 ? '99+' : unreadCount;
    }

    return unreadAlert || '';
  },

  isMenuOpen() {
    if (Session.equals('isMenuOpen', true)) {
      return 'menu-opened';
    }
  },

  embeddedVersion() {
    return isLayoutEmbedded();
  }

});
Template.burger.events({
  'click div.burger'() {
    return menu.toggle();
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"helpers.js":[
  "moment"
],"home.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/home.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let settings;
module.link("../../../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);
Template.home.helpers({
  title() {
    return settings.get('Layout_Home_Title');
  },

  body() {
    return settings.get('Layout_Home_Body');
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"photoswipeContent.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/photoswipeContent.ts                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 3);

const parseLength = x => {
  const length = typeof x === 'string' ? parseInt(x, 10) : undefined;
  return Number.isFinite(length) ? length : undefined;
};

const getImageSize = src => new Promise((resolve, reject) => {
  const img = new Image();
  img.addEventListener('load', () => {
    resolve([img.naturalWidth, img.naturalHeight]);
  });
  img.addEventListener('error', error => {
    reject(error.error);
  });
  img.src = src;
});

const fromElementToSlide = async element => {
  if (!(element instanceof HTMLElement)) {
    return null;
  }

  const title = element.dataset.title || element.title;
  const {
    description
  } = element.dataset;

  if (element instanceof HTMLAnchorElement) {
    const src = element.dataset.src || element.href;
    let w = parseLength(element.dataset.width);
    let h = parseLength(element.dataset.height);

    if (w === undefined || h === undefined) {
      [w, h] = await getImageSize(src);
    }

    return {
      src,
      w,
      h,
      title,
      description
    };
  }

  if (element instanceof HTMLImageElement) {
    let msrc;
    let {
      src
    } = element;
    let w = element.naturalWidth;
    let h = element.naturalHeight;

    if (element.dataset.src) {
      msrc = element.src;
      src = element.dataset.src;
      w = parseLength(element.dataset.width);
      h = parseLength(element.dataset.height);

      if (w === undefined || h === undefined) {
        [w, h] = await getImageSize(src);
      }
    }

    return {
      msrc,
      src,
      w,
      h,
      title,
      description
    };
  }

  return null;
};

let currentGallery = null;

const initGallery = async (items, options) => {
  const [{
    default: PhotoSwipe
  }, {
    default: PhotoSwipeUiDefault
  } // eslint-disable-line @typescript-eslint/camelcase
  ] = await Promise.all([module.dynamicImport('photoswipe'), module.dynamicImport('photoswipe/dist/photoswipe-ui-default'), // @ts-ignore
  module.dynamicImport('photoswipe/dist/photoswipe.css'), // @ts-ignore
  module.dynamicImport('./photoswipeContent.html')]);
  Blaze.render(Template.photoswipeContent, document.body);

  if (!currentGallery) {
    const container = document.getElementById('pswp');

    if (!container) {
      throw new Error('Photoswipe container element not found');
    }

    currentGallery = new PhotoSwipe(container, PhotoSwipeUiDefault, items, options);
    currentGallery.listen('destroy', () => {
      currentGallery = null;
    });
    currentGallery.init();
  }
};

const defaultGalleryOptions = {
  bgOpacity: 0.7,
  showHideOpacity: true,
  counterEl: false,
  shareEl: false,
  clickToCloseNonZoomable: false,
  index: 0,

  addCaptionHTMLFn(item, captionEl) {
    var _item$title, _item$description;

    captionEl.children[0].innerHTML = "\n\t\t\t".concat(escapeHTML((_item$title = item.title) !== null && _item$title !== void 0 ? _item$title : ''), "<br/>\n\t\t\t<small>").concat(escapeHTML((_item$description = item.description) !== null && _item$description !== void 0 ? _item$description : ''), "</small>\n\t\t");
    return true;
  }

};

const createEventListenerFor = className => event => {
  event.preventDefault();
  event.stopPropagation();
  const {
    currentTarget
  } = event;
  Array.from(document.querySelectorAll(className)).sort((a, b) => {
    if (a === currentTarget) {
      return -1;
    }

    if (b === currentTarget) {
      return 1;
    }

    return 0;
  }).map(element => fromElementToSlide(element)).reduce((p, curr) => p.then(() => curr).then(async slide => {
    if (!slide) {
      return;
    }

    if (!currentGallery) {
      return initGallery([slide], defaultGalleryOptions);
    }

    currentGallery.items.push(slide);
    currentGallery.invalidateCurrItems();
    currentGallery.updateSize(true);
  }), Promise.resolve());
};

Meteor.startup(() => {
  $(document).on('click', '.gallery-item', createEventListenerFor('.gallery-item'));
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"room.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/room.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  chatMessages: () => chatMessages,
  dropzoneHelpers: () => dropzoneHelpers,
  dropzoneEvents: () => dropzoneEvents
});

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 1);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let ReactiveDict;
module.link("meteor/reactive-dict", {
  ReactiveDict(v) {
    ReactiveDict = v;
  }

}, 4);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 5);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 6);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 7);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 8);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 9);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 10);
let t, roomTypes, getUserPreference;
module.link("../../../../utils/client", {
  t(v) {
    t = v;
  },

  roomTypes(v) {
    roomTypes = v;
  },

  getUserPreference(v) {
    getUserPreference = v;
  }

}, 11);
let WebRTC;
module.link("../../../../webrtc/client", {
  WebRTC(v) {
    WebRTC = v;
  }

}, 12);
let ChatMessage, RoomRoles, Users, Subscriptions, Rooms;
module.link("../../../../models", {
  ChatMessage(v) {
    ChatMessage = v;
  },

  RoomRoles(v) {
    RoomRoles = v;
  },

  Users(v) {
    Users = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  },

  Rooms(v) {
    Rooms = v;
  }

}, 13);
let RoomHistoryManager, RoomManager, readMessage;
module.link("../../../../ui-utils/client", {
  RoomHistoryManager(v) {
    RoomHistoryManager = v;
  },

  RoomManager(v) {
    RoomManager = v;
  },

  readMessage(v) {
    readMessage = v;
  }

}, 14);
let messageContext;
module.link("../../../../ui-utils/client/lib/messageContext", {
  messageContext(v) {
    messageContext = v;
  }

}, 15);
let messageArgs;
module.link("../../../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 16);
let settings;
module.link("../../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 17);
let callbacks;
module.link("../../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 18);
let hasAllPermission, hasRole;
module.link("../../../../authorization/client", {
  hasAllPermission(v) {
    hasAllPermission = v;
  },

  hasRole(v) {
    hasRole = v;
  }

}, 19);
let ChatMessages;
module.link("../../lib/chatMessages", {
  ChatMessages(v) {
    ChatMessages = v;
  }

}, 20);
let fileUpload;
module.link("../../lib/fileUpload", {
  fileUpload(v) {
    fileUpload = v;
  }

}, 21);
module.link("./room.html");
let getCommonRoomEvents;
module.link("./lib/getCommonRoomEvents", {
  getCommonRoomEvents(v) {
    getCommonRoomEvents = v;
  }

}, 22);
let NewRoomManager;
module.link("../../../../../client/lib/RoomManager", {
  RoomManager(v) {
    NewRoomManager = v;
  }

}, 23);
let isLayoutEmbedded;
module.link("../../../../../client/lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded(v) {
    isLayoutEmbedded = v;
  }

}, 24);
let handleError;
module.link("../../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 25);
const chatMessages = {};

const userCanDrop = _id => !roomTypes.readOnly(_id, Users.findOne({
  _id: Meteor.userId()
}, {
  fields: {
    username: 1
  }
}));

const wipeFailedUploads = () => {
  const uploads = Session.get('uploading');

  if (uploads) {
    Session.set('uploading', uploads.filter(upload => !upload.error));
  }
};

function roomHasGlobalPurge(room) {
  if (!settings.get('RetentionPolicy_Enabled')) {
    return false;
  }

  switch (room.t) {
    case 'c':
      return settings.get('RetentionPolicy_AppliesToChannels');

    case 'p':
      return settings.get('RetentionPolicy_AppliesToGroups');

    case 'd':
      return settings.get('RetentionPolicy_AppliesToDMs');
  }

  return false;
}

function roomHasPurge(room) {
  if (!room || !settings.get('RetentionPolicy_Enabled')) {
    return false;
  }

  if (room.retention && room.retention.enabled !== undefined) {
    return room.retention.enabled;
  }

  return roomHasGlobalPurge(room);
}

function roomFilesOnly(room) {
  if (!room) {
    return false;
  }

  if (room.retention && room.retention.overrideGlobal) {
    return room.retention.filesOnly;
  }

  return settings.get('RetentionPolicy_FilesOnly');
}

function roomExcludePinned(room) {
  if (!room) {
    return false;
  }

  if (room.retention && room.retention.overrideGlobal) {
    return room.retention.excludePinned;
  }

  return settings.get('RetentionPolicy_DoNotPrunePinned');
}

function roomMaxAge(room) {
  if (!room) {
    return;
  }

  if (!roomHasPurge(room)) {
    return;
  }

  if (room.retention && room.retention.overrideGlobal) {
    return room.retention.maxAge;
  }

  if (room.t === 'c') {
    return settings.get('RetentionPolicy_MaxAge_Channels');
  }

  if (room.t === 'p') {
    return settings.get('RetentionPolicy_MaxAge_Groups');
  }

  if (room.t === 'd') {
    return settings.get('RetentionPolicy_MaxAge_DMs');
  }
}

async function createFileFromUrl(url) {
  let response;

  try {
    response = await fetch(url);
  } catch (error) {
    throw error;
  }

  const data = await response.blob();
  const metadata = {
    type: data.type
  };
  const {
    mime
  } = await module.dynamicImport('../../../../utils/lib/mimeTypes');
  const file = new File([data], "File - ".concat(moment().format(settings.get('Message_TimeAndDateFormat')), ".").concat(mime.extension(data.type)), metadata);
  return file;
}

function addToInput(text) {
  const {
    input
  } = chatMessages[RoomManager.openedRoom];
  const initText = input.value.slice(0, input.selectionStart);
  const finalText = input.value.slice(input.selectionEnd, input.value.length);
  input.value = initText + text + finalText;
  $(input).change().trigger('input');
}

callbacks.add('enter-room', wipeFailedUploads);
const dropzoneHelpers = {
  dragAndDrop() {
    return settings.get('FileUpload_Enabled') && 'dropzone--disabled';
  },

  isDropzoneDisabled() {
    return settings.get('FileUpload_Enabled') ? 'dropzone-overlay--enabled' : 'dropzone-overlay--disabled';
  },

  dragAndDropLabel() {
    if (!userCanDrop(this._id)) {
      return 'error-not-allowed';
    }

    if (!settings.get('FileUpload_Enabled')) {
      return 'FileUpload_Disabled';
    }

    return 'Drop_to_upload_file';
  }

};
Template.roomOld.helpers(_objectSpread(_objectSpread({}, dropzoneHelpers), {}, {
  tabBar() {
    return Template.instance().tabBar;
  },

  subscribed() {
    const {
      state
    } = Template.instance();
    return state.get('subscribed');
  },

  messagesHistory() {
    const showInMainThread = getUserPreference(Meteor.userId(), 'showMessageInMainThread', false);
    const {
      rid
    } = Template.instance();
    const room = Rooms.findOne(rid, {
      fields: {
        sysMes: 1
      }
    });
    const hideSettings = settings.collection.findOne('Hide_System_Messages') || {};
    const settingValues = Array.isArray(room === null || room === void 0 ? void 0 : room.sysMes) ? room.sysMes : hideSettings.value || [];
    const hideMessagesOfType = new Set(settingValues.reduce((array, value) => [...array, ...(value === 'mute_unmute' ? ['user-muted', 'user-unmuted'] : [value])], []));

    const query = _objectSpread({
      rid,
      _hidden: {
        $ne: true
      }
    }, !showInMainThread && {
      $or: [{
        tmid: {
          $exists: 0
        }
      }, {
        tshow: {
          $eq: true
        }
      }]
    });

    if (hideMessagesOfType.size) {
      query.t = {
        $nin: Array.from(hideMessagesOfType.values())
      };
    }

    const options = {
      sort: {
        ts: 1
      }
    };
    return ChatMessage.find(query, options);
  },

  hasMore() {
    return RoomHistoryManager.hasMore(this._id);
  },

  hasMoreNext() {
    return RoomHistoryManager.hasMoreNext(this._id);
  },

  isLoading() {
    return RoomHistoryManager.isLoading(this._id);
  },

  windowId() {
    return "chat-window-".concat(this._id);
  },

  uploading() {
    return Session.get('uploading');
  },

  roomLeader() {
    const roles = RoomRoles.findOne({
      'rid': this._id,
      'roles': 'leader',
      'u._id': {
        $ne: Meteor.userId()
      }
    });

    if (roles) {
      const leader = Users.findOne({
        _id: roles.u._id
      }, {
        fields: {
          status: 1,
          statusText: 1
        }
      }) || {};
      return _objectSpread(_objectSpread({}, roles.u), {}, {
        name: settings.get('UI_Use_Real_Name') ? roles.u.name || roles.u.username : roles.u.username,
        status: leader.status || 'offline',
        statusDisplay: leader.statusText || t(leader.status || 'offline')
      });
    }
  },

  chatNowLink() {
    return roomTypes.getRouteLink('d', {
      name: this.username
    });
  },

  announcement() {
    return Template.instance().state.get('announcement');
  },

  announcementDetails() {
    const roomData = Session.get("roomData".concat(this._id));

    if (!roomData) {
      return false;
    }

    if (roomData.announcementDetails != null && roomData.announcementDetails.callback != null) {
      return () => callbacks.run(roomData.announcementDetails.callback, this._id);
    }
  },

  messageboxData() {
    const {
      sendToBottomIfNecessary,
      subscription
    } = Template.instance();
    const {
      _id: rid
    } = this;
    const isEmbedded = isLayoutEmbedded();
    const showFormattingTips = settings.get('Message_ShowFormattingTips');
    return {
      rid,
      subscription: subscription.get(),
      isEmbedded,
      showFormattingTips: showFormattingTips && !isEmbedded,
      onInputChanged: input => {
        if (!chatMessages[rid]) {
          return;
        }

        chatMessages[rid].initializeInput(input, {
          rid
        });
      },
      onResize: () => sendToBottomIfNecessary && sendToBottomIfNecessary(),
      onKeyUp: function () {
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        return chatMessages[rid] && chatMessages[rid].keyup.apply(chatMessages[rid], args);
      },
      onKeyDown: function () {
        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
          args[_key2] = arguments[_key2];
        }

        return chatMessages[rid] && chatMessages[rid].keydown.apply(chatMessages[rid], args);
      },
      onSend: function () {
        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
          args[_key3] = arguments[_key3];
        }

        return chatMessages[rid] && chatMessages[rid].send.apply(chatMessages[rid], args);
      }
    };
  },

  getAnnouncementStyle() {
    const {
      room
    } = Template.instance();

    if (!room) {
      return '';
    }

    return room.announcementDetails && room.announcementDetails.style !== undefined ? room.announcementDetails.style : '';
  },

  maxMessageLength() {
    return settings.get('Message_MaxAllowedSize');
  },

  unreadData() {
    const data = {
      count: Template.instance().state.get('count')
    };
    const room = RoomManager.getOpenedRoomByRid(this._id);

    if (room) {
      data.since = room.unreadSince.get();
    }

    return data;
  },

  containerBarsShow(unreadData, uploading) {
    const hasUnreadData = unreadData && unreadData.count && unreadData.since;
    const isUploading = uploading && uploading.length;

    if (hasUnreadData || isUploading) {
      return 'show';
    }
  },

  formatUnreadSince() {
    if (!this.since) {
      return;
    }

    return moment(this.since).calendar(null, {
      sameDay: 'LT'
    });
  },

  adminClass() {
    if (hasRole(Meteor.userId(), 'admin')) {
      return 'admin';
    }
  },

  messageViewMode() {
    const viewMode = getUserPreference(Meteor.userId(), 'messageViewMode');
    const modes = ['', 'cozy', 'compact'];
    return modes[viewMode] || modes[0];
  },

  selectable() {
    return Template.instance().selectable.get();
  },

  hideUsername() {
    return getUserPreference(Meteor.userId(), 'hideUsernames') ? 'hide-usernames' : undefined;
  },

  hideAvatar() {
    return getUserPreference(Meteor.userId(), 'displayAvatars') ? undefined : 'hide-avatars';
  },

  canPreview() {
    const {
      room,
      state
    } = Template.instance();

    if (room && room.t !== 'c') {
      return true;
    }

    if (settings.get('Accounts_AllowAnonymousRead') === true) {
      return true;
    }

    if (hasAllPermission('preview-c-room')) {
      return true;
    }

    return state.get('subscribed');
  },

  hideLeaderHeader() {
    return Template.instance().hideLeaderHeader.get() ? 'animated-hidden' : '';
  },

  hasLeader() {
    if (RoomRoles.findOne({
      'rid': this._id,
      'roles': 'leader',
      'u._id': {
        $ne: Meteor.userId()
      }
    }, {
      fields: {
        _id: 1
      }
    })) {
      return 'has-leader';
    }
  },

  hasPurge() {
    const {
      room
    } = Template.instance();
    return roomHasPurge(room);
  },

  filesOnly() {
    const {
      room
    } = Template.instance();
    return roomFilesOnly(room);
  },

  excludePinned() {
    const {
      room
    } = Template.instance();
    return roomExcludePinned(room);
  },

  purgeTimeout() {
    const {
      room
    } = Template.instance();
    moment.relativeTimeThreshold('s', 60);
    moment.relativeTimeThreshold('ss', 0);
    moment.relativeTimeThreshold('m', 60);
    moment.relativeTimeThreshold('h', 24);
    moment.relativeTimeThreshold('d', 31);
    moment.relativeTimeThreshold('M', 12);
    return moment.duration(roomMaxAge(room) * 1000 * 60 * 60 * 24).humanize();
  },

  messageContext,

  openedThread() {
    FlowRouter.watchPathChange();
    const tab = FlowRouter.getParam('tab');
    const mid = FlowRouter.getParam('context');

    const rid = Template.currentData()._id;

    const jump = FlowRouter.getQueryParam('jump');
    const subscription = Template.instance().subscription.get();

    if (tab !== 'thread' || !mid || rid !== Session.get('openedRoom')) {
      return;
    }

    const room = Rooms.findOne({
      _id: rid
    }, {
      fields: {
        t: 1,
        usernames: 1,
        uids: 1,
        name: 1
      }
    });
    return {
      rid,
      mid,
      room,
      jump,
      subscription
    };
  }

}));
const dropzoneEvents = {
  'dragenter .dropzone'(e) {
    const types = e.originalEvent && e.originalEvent.dataTransfer && e.originalEvent.dataTransfer.types;

    if (types != null && types.length > 0 && _.some(types, type => type.indexOf('text/') === -1 || type.indexOf('text/uri-list') !== -1 || type.indexOf('text/plain') !== -1) && userCanDrop(this._id)) {
      e.currentTarget.classList.add('over');
    }

    e.stopPropagation();
  },

  'dragleave .dropzone-overlay'(e) {
    e.currentTarget.parentNode.classList.remove('over');
    e.stopPropagation();
  },

  'dragover .dropzone-overlay'(e) {
    document.querySelectorAll('.over.dropzone').forEach(dropzone => {
      if (dropzone !== e.currentTarget.parentNode) {
        dropzone.classList.remove('over');
      }
    });
    e = e.originalEvent || e;

    if (['move', 'linkMove'].includes(e.dataTransfer.effectAllowed)) {
      e.dataTransfer.dropEffect = 'move';
    } else {
      e.dataTransfer.dropEffect = 'copy';
    }

    e.stopPropagation();
  },

  async 'dropped .dropzone-overlay'(event, instance) {
    event.currentTarget.parentNode.classList.remove('over');
    const e = event.originalEvent || event;
    e.stopPropagation();
    e.preventDefault();

    if (!userCanDrop(this._id) || !settings.get('FileUpload_Enabled')) {
      return false;
    }

    let files = e.dataTransfer && e.dataTransfer.files || [];

    if (files.length < 1) {
      const transferData = e.dataTransfer.getData('text') || e.dataTransfer.getData('url');

      if (e.dataTransfer.types.includes('text/uri-list')) {
        const url = e.dataTransfer.getData('text/html').match('<img.+src=(?:"|\')(.+?)(?:"|\')(?:.+?)>');
        const imgURL = url && url[1];

        if (!imgURL) {
          return;
        }

        const file = await createFileFromUrl(imgURL);

        if (typeof file === 'string') {
          return addToInput(file);
        }

        files = [file];
      }

      if (e.dataTransfer.types.includes('text/plain') && !e.dataTransfer.types.includes('text/x-moz-url')) {
        return addToInput(transferData.trim());
      }
    }

    const {
      mime
    } = await module.dynamicImport('../../../../utils/lib/mimeTypes');
    const filesToUpload = Array.from(files).map(file => {
      Object.defineProperty(file, 'type', {
        value: mime.lookup(file.name)
      });
      return {
        file,
        name: file.name
      };
    });
    return instance.onFile && instance.onFile(filesToUpload);
  }

};
Meteor.startup(() => {
  Template.roomOld.events(_objectSpread(_objectSpread(_objectSpread({}, getCommonRoomEvents()), dropzoneEvents), {}, {
    'click .toggle-hidden'(e) {
      const id = e.currentTarget.dataset.message;
      document.querySelector("#".concat(id)).classList.toggle('message--ignored');
    },

    'click .message'(e, template) {
      if (template.selectable.get()) {
        (document.selection != null ? document.selection.empty() : undefined) || (typeof window.getSelection === 'function' ? window.getSelection().removeAllRanges() : undefined);
        const data = Blaze.getData(e.currentTarget);
        const {
          msg: {
            _id
          }
        } = messageArgs(data);

        if (!template.selectablePointer) {
          template.selectablePointer = _id;
        }

        if (!e.shiftKey) {
          template.selectedMessages = template.getSelectedMessages();
          template.selectedRange = [];
          template.selectablePointer = _id;
        }

        template.selectMessages(_id);
        const selectedMessages = $('.messages-box .message.selected').map((i, message) => message.id);

        const removeClass = _.difference(selectedMessages, template.getSelectedMessages());

        const addClass = _.difference(template.getSelectedMessages(), selectedMessages);

        removeClass.forEach(message => $(".messages-box #".concat(message)).removeClass('selected'));
        addClass.forEach(message => $(".messages-box #".concat(message)).addClass('selected'));
      }
    },

    'click .jump-recent button'(e, template) {
      e.preventDefault();
      template.atBottom = true;
      RoomHistoryManager.clear(template && template.data && template.data._id);
    },

    'load .gallery-item'(e, template) {
      template.sendToBottomIfNecessary();
    },

    'rendered .js-block-wrapper'(e, template) {
      template.sendToBottomIfNecessary();
    },

    'click .new-message'(event, instance) {
      instance.atBottom = true;
      instance.sendToBottomIfNecessary();
      chatMessages[RoomManager.openedRoom].input.focus();
    },

    'click .upload-progress-close'(e) {
      e.preventDefault();
      Session.set("uploading-cancel-".concat(this.id), true);
    },

    'click .unread-bar > button.mark-read'(e, t) {
      readMessage.readNow(t.data._id);
    },

    'click .unread-bar > button.jump-to'(e, t) {
      const {
        _id
      } = t.data;
      const room = RoomHistoryManager.getRoom(_id);
      let message = room && room.firstUnread.get();

      if (!message) {
        const subscription = Subscriptions.findOne({
          rid: _id
        });
        message = ChatMessage.find({
          rid: _id,
          ts: {
            $gt: subscription != null ? subscription.ls : undefined
          }
        }, {
          sort: {
            ts: 1
          },
          limit: 1
        }).fetch()[0];
      }

      RoomHistoryManager.getSurroundingMessages(message, 50);
    },

    'scroll .wrapper': _.throttle(function (e, t) {
      const $roomLeader = $('.room-leader');

      if ($roomLeader.length) {
        if (e.target.scrollTop < t.lastScrollTop) {
          t.hideLeaderHeader.set(false);
        } else if (t.isAtBottom(100) === false && e.target.scrollTop > $roomLeader.height()) {
          t.hideLeaderHeader.set(true);
        }
      }

      t.lastScrollTop = e.target.scrollTop;
      const height = e.target.clientHeight;
      const isLoading = RoomHistoryManager.isLoading(this._id);
      const hasMore = RoomHistoryManager.hasMore(this._id);
      const hasMoreNext = RoomHistoryManager.hasMoreNext(this._id);

      if (isLoading === false && hasMore === true || hasMoreNext === true) {
        if (hasMore === true && t.lastScrollTop <= height / 3) {
          RoomHistoryManager.getMore(this._id);
        } else if (hasMoreNext === true && Math.ceil(t.lastScrollTop) >= e.target.scrollHeight - height) {
          RoomHistoryManager.getMoreNext(this._id);
        }
      }
    }, 100),

    'click .time a'(e) {
      e.preventDefault();
      const {
        msg
      } = messageArgs(this);
      const repliedMessageId = msg.attachments[0].message_link.split('?msg=')[1];
      FlowRouter.go(FlowRouter.current().context.pathname, null, {
        msg: repliedMessageId,
        hash: Random.id()
      });
    }

  }));
  Template.roomOld.onCreated(function () {
    // this.scrollOnBottom = true
    // this.typing = new msgTyping this.data._id
    const rid = this.data._id;
    this.tabBar = this.data.tabBar;

    this.onFile = filesToUpload => {
      fileUpload(filesToUpload, chatMessages[rid].input, {
        rid
      });
    };

    this.rid = rid;
    this.subscription = new ReactiveVar();
    this.state = new ReactiveDict();
    this.userDetail = new ReactiveVar('');
    const user = Meteor.user();
    this.autorun(c => {
      const room = Rooms.findOne({
        _id: rid
      }, {
        fields: {
          t: 1,
          usernames: 1,
          uids: 1
        }
      });

      if (room.t !== 'd') {
        return c.stop();
      }

      if (roomTypes.getConfig(room.t).isGroupChat(room)) {
        return;
      }

      const usernames = Array.from(new Set(room.usernames));
      this.userDetail.set(this.userDetail.get() || (usernames.length === 1 ? usernames[0] : usernames.filter(username => username !== user.username)[0]));
    });
    this.autorun(() => {
      const rid = Template.currentData()._id;

      const room = Rooms.findOne({
        _id: rid
      }, {
        fields: {
          announcement: 1
        }
      });
      this.state.set('announcement', room.announcement);
    });
    this.autorun(() => {
      const subscription = Subscriptions.findOne({
        rid
      });
      this.subscription.set(subscription);
      this.state.set({
        subscribed: !!subscription,
        autoTranslate: subscription && subscription.autoTranslate,
        autoTranslateLanguage: subscription && subscription.autoTranslateLanguage
      });
    });
    this.showUsersOffline = new ReactiveVar(false);
    this.atBottom = !FlowRouter.getQueryParam('msg');
    this.unreadCount = new ReactiveVar(0);
    this.selectable = new ReactiveVar(false);
    this.selectedMessages = [];
    this.selectedRange = [];
    this.selectablePointer = null;
    this.flexTemplate = new ReactiveVar();
    this.groupDetail = new ReactiveVar();
    this.hideLeaderHeader = new ReactiveVar(false);

    this.resetSelection = enabled => {
      this.selectable.set(enabled);
      $('.messages-box .message.selected').removeClass('selected');
      this.selectedMessages = [];
      this.selectedRange = [];
      this.selectablePointer = null;
    };

    this.selectMessages = to => {
      if (this.selectablePointer === to && this.selectedRange.length > 0) {
        this.selectedRange = [];
      } else {
        const message1 = ChatMessage.findOne(this.selectablePointer);
        const message2 = ChatMessage.findOne(to);

        const minTs = _.min([message1.ts, message2.ts]);

        const maxTs = _.max([message1.ts, message2.ts]);

        this.selectedRange = _.pluck(ChatMessage.find({
          rid: message1.rid,
          ts: {
            $gte: minTs,
            $lte: maxTs
          }
        }).fetch(), '_id');
      }
    };

    this.getSelectedMessages = () => {
      let previewMessages;
      const messages = this.selectedMessages;
      let addMessages = false;

      for (const message of Array.from(this.selectedRange)) {
        if (messages.indexOf(message) === -1) {
          addMessages = true;
          break;
        }
      }

      if (addMessages) {
        previewMessages = _.compact(_.uniq(this.selectedMessages.concat(this.selectedRange)));
      } else {
        previewMessages = _.compact(_.difference(this.selectedMessages, this.selectedRange));
      }

      return previewMessages;
    };

    this.clearUserDetail = () => {
      this.userDetail.set(null);
      this.tabBar.setData({});
      this.tabBar.close();
    };

    Meteor.call('getRoomRoles', this.data._id, function (error, results) {
      if (error) {
        handleError(error);
      }

      return Array.from(results).forEach(record => {
        delete record._id;
        RoomRoles.upsert({
          'rid': record.rid,
          'u._id': record.u._id
        }, record);
      });
    });
    this.rolesObserve = RoomRoles.find({
      rid: this.data._id
    }).observe({
      added: role => {
        if (!role.u || !role.u._id) {
          return;
        }

        ChatMessage.update({
          'rid': this.data._id,
          'u._id': role.u._id
        }, {
          $addToSet: {
            roles: role._id
          }
        }, {
          multi: true
        });
      },
      // Update message to re-render DOM
      changed: role => {
        if (!role.u || !role.u._id) {
          return;
        }

        ChatMessage.update({
          'rid': this.data._id,
          'u._id': role.u._id
        }, {
          $inc: {
            rerender: 1
          }
        }, {
          multi: true
        });
      },
      // Update message to re-render DOM
      removed: role => {
        if (!role.u || !role.u._id) {
          return;
        }

        ChatMessage.update({
          'rid': this.data._id,
          'u._id': role.u._id
        }, {
          $pull: {
            roles: role._id
          }
        }, {
          multi: true
        });
      }
    });

    this.sendToBottomIfNecessary = () => {
      if (this.atBottom === true) {
        this.sendToBottom();
      }
    };
  }); // Update message to re-render DOM

  Template.roomOld.onDestroyed(function () {
    if (this.rolesObserve) {
      this.rolesObserve.stop();
    }

    readMessage.off(this.data._id);
    window.removeEventListener('resize', this.onWindowResize);
    this.observer && this.observer.disconnect();
    const chatMessage = chatMessages[this.data._id];
    chatMessage.onDestroyed && chatMessage.onDestroyed(this.data._id);
    callbacks.remove('streamNewMessage', this.data._id);
  });

  const isAtBottom = function (element) {
    let scrollThreshold = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    return element.scrollTop + scrollThreshold >= element.scrollHeight - element.clientHeight;
  };

  Template.roomOld.onRendered(function () {
    const {
      _id: rid
    } = this.data;

    if (!chatMessages[rid]) {
      chatMessages[rid] = new ChatMessages();
    }

    const wrapper = this.find('.wrapper');
    const store = NewRoomManager.getStore(rid);

    const afterMessageGroup = () => {
      if (store.scroll && !store.atBottom) {
        wrapper.scrollTop = store.scroll;
      } else {
        this.sendToBottom();
      }

      wrapper.removeEventListener('MessageGroup', afterMessageGroup);
      wrapper.addEventListener('scroll', _.throttle(() => {
        store.update({
          scroll: wrapper.scrollTop,
          atBottom: isAtBottom(wrapper, 50)
        });
      }, 30));
    };

    wrapper.addEventListener('MessageGroup', afterMessageGroup);
    chatMessages[rid].initializeWrapper(this.find('.wrapper'));
    chatMessages[rid].initializeInput(this.find('.js-input-message'), {
      rid
    });
    const wrapperUl = this.find('.wrapper > ul');
    const newMessage = this.find('.new-message');
    const template = this;
    const messageBox = $('.messages-box');

    template.isAtBottom = function () {
      let scrollThreshold = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

      if (isAtBottom(wrapper, scrollThreshold)) {
        newMessage.className = 'new-message background-primary-action-color color-content-background-color not';
        return true;
      }

      return false;
    };

    template.sendToBottom = function () {
      wrapper.scrollTo(30, wrapper.scrollHeight);
      newMessage.className = 'new-message background-primary-action-color color-content-background-color not';
    };

    template.checkIfScrollIsAtBottom = function () {
      template.atBottom = template.isAtBottom(100);
    };

    template.observer = new ResizeObserver(() => template.sendToBottomIfNecessary());
    template.observer.observe(wrapperUl);

    const wheelHandler = _.throttle(function () {
      template.checkIfScrollIsAtBottom();
    }, 100);

    wrapper.addEventListener('mousewheel', wheelHandler);
    wrapper.addEventListener('wheel', wheelHandler);
    wrapper.addEventListener('touchstart', () => {
      template.atBottom = false;
    });
    wrapper.addEventListener('touchend', function () {
      template.checkIfScrollIsAtBottom();
      setTimeout(() => template.checkIfScrollIsAtBottom(), 1000);
      setTimeout(() => template.checkIfScrollIsAtBottom(), 2000);
    });
    Tracker.afterFlush(() => {
      wrapper.addEventListener('scroll', wheelHandler);
    });
    this.lastScrollTop = $('.messages-box .wrapper').scrollTop();
    const rtl = $('html').hasClass('rtl');

    const getElementFromPoint = function () {
      let topOffset = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      const messageBoxOffset = messageBox.offset();
      let element;

      if (rtl) {
        element = document.elementFromPoint(messageBoxOffset.left + messageBox.width() - 1, messageBoxOffset.top + topOffset + 1);
      } else {
        element = document.elementFromPoint(messageBoxOffset.left + 1, messageBoxOffset.top + topOffset + 1);
      }

      if (element && element.classList.contains('message')) {
        return element;
      }
    };

    const updateUnreadCount = _.throttle(() => {
      Tracker.afterFlush(() => {
        const lastInvisibleMessageOnScreen = getElementFromPoint(0) || getElementFromPoint(20) || getElementFromPoint(40);

        if (!lastInvisibleMessageOnScreen || !lastInvisibleMessageOnScreen.id) {
          return this.unreadCount.set(0);
        }

        const lastMessage = ChatMessage.findOne(lastInvisibleMessageOnScreen.id);

        if (!lastMessage) {
          return this.unreadCount.set(0);
        }

        this.state.set('lastMessage', lastMessage.ts);
      });
    }, 300);

    const read = _.debounce(function () {
      if (rid !== Session.get('openedRoom')) {
        return;
      }

      readMessage.read(rid);
    }, 500);

    this.autorun(() => {
      var _room;

      if (rid !== Session.get('openedRoom')) {
        return;
      }

      let room = Rooms.findOne({
        _id: rid
      }, {
        fields: {
          t: 1
        }
      });

      if (((_room = room) === null || _room === void 0 ? void 0 : _room.t) === 'l') {
        room = Tracker.nonreactive(() => Rooms.findOne({
          _id: rid
        }));
        roomTypes.getConfig(room.t).openCustomProfileTab(this, room, room.v.username);
      }
    });
    this.autorun(() => {
      if (!Object.values(roomTypes.roomTypes).map(_ref => {
        let {
          route
        } = _ref;
        return route && route.name;
      }).filter(Boolean).includes(FlowRouter.getRouteName())) {
        return;
      }

      if (rid !== Session.get('openedRoom')) {
        return;
      }

      const subscription = Subscriptions.findOne({
        rid
      }, {
        fields: {
          alert: 1,
          unread: 1
        }
      });
      read();
      return subscription && (subscription.alert || subscription.unread) && readMessage.refreshUnreadMark(rid);
    });
    this.autorun(() => {
      const lastMessage = this.state.get('lastMessage');
      const subscription = Subscriptions.findOne({
        rid
      }, {
        fields: {
          ls: 1
        }
      });

      if (!subscription) {
        this.unreadCount.set(0);
        return;
      }

      const count = ChatMessage.find({
        rid,
        ts: {
          $lte: lastMessage,
          $gt: subscription && subscription.ls
        }
      }).count();
      this.unreadCount.set(count);
    });
    this.autorun(() => {
      const count = RoomHistoryManager.getRoom(rid).unreadNotLoaded.get() + this.unreadCount.get();
      this.state.set('count', count);
    });
    this.autorun(() => {
      Rooms.findOne(rid);
      const count = this.state.get('count');

      if (count === 0) {
        return read();
      }

      readMessage.refreshUnreadMark(rid);
    });
    readMessage.on(template.data._id, () => this.unreadCount.set(0));
    wrapper.addEventListener('scroll', updateUnreadCount); // salva a data da renderização para exibir alertas de novas mensagens

    $.data(this.firstNode, 'renderedAt', new Date());
    const webrtc = WebRTC.getInstanceByRoomId(template.data._id);

    if (webrtc) {
      this.autorun(() => {
        const remoteItems = webrtc.remoteItems.get();

        if (remoteItems && remoteItems.length > 0 || webrtc.localUrl.get()) {
          return this.tabBar.openUserInfo();
        }
      });
    }

    callbacks.add('streamNewMessage', msg => {
      if (rid !== msg.rid || msg.editedAt || msg.tmid) {
        return;
      }

      if (msg.u._id === Meteor.userId()) {
        return template.sendToBottom();
      }

      if (!template.isAtBottom()) {
        newMessage.classList.remove('not');
      }
    }, callbacks.priority.MEDIUM, rid);
    this.autorun(function () {
      if (template.data._id !== RoomManager.openedRoom) {
        return;
      }

      const room = Rooms.findOne({
        _id: template.data._id
      });

      if (!room) {
        return FlowRouter.go('home');
      }
    });
  });
});
callbacks.add('enter-room', sub => {
  if (!sub) {
    return;
  }

  const isAReplyInDMFromChannel = FlowRouter.getQueryParam('reply') && sub.t === 'd';

  if (isAReplyInDMFromChannel && chatMessages[sub.rid]) {
    chatMessages[sub.rid].restoreReplies();
  }

  setTimeout(() => readMessage.read(sub.rid), 1000);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomSearch.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/roomSearch.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let roomTypes;
module.link("../../../../utils", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 1);
Template.roomSearch.helpers({
  roomIcon() {
    if (this.type === 'u') {
      return 'icon-at';
    }

    if (this.type === 'r') {
      return roomTypes.getIcon(this);
    }
  },

  userStatus() {
    if (this.type === 'u') {
      return "status-".concat(this.status);
    }
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/index.ts                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/accounts");
module.link("./lib/collections");
module.link("./lib/iframeCommands");
module.link("./lib/menu");
module.link("./lib/parentTemplate");
module.link("./lib/codeMirror");
module.link("./lib/textarea-cursor");
module.link("./views/app/burger.html");
module.link("./views/app/home.html");
module.link("./views/app/notAuthorized.html");
module.link("./views/app/pageContainer.html");
module.link("./views/app/pageCustomContainer.html");
module.link("./views/app/roomSearch.html");
module.link("./views/app/userSearch.html");
module.link("./views/app/burger");
module.link("./views/app/home");
module.link("./views/app/roomSearch");
module.link("./views/app/photoswipeContent.ts");
module.link("./components/icon");
module.link("./components/table.html");
module.link("./components/table");
module.link("./components/tabs");
module.link("./components/popupList.html");
module.link("./components/popupList");
module.link("./components/selectDropdown.html");
module.link("./components/header/header");
module.link("./components/tooltip");
module.link("./lib/Tooltip");
module.link("./lib/chatMessages", {
  ChatMessages: "ChatMessages"
}, 0);
module.link("./lib/fileUpload", {
  fileUpload: "fileUpload"
}, 1);
module.link("./lib/UserAction", {
  UserAction: "UserAction",
  USER_ACTIVITIES: "USER_ACTIVITIES"
}, 2);
module.link("./lib/notification", {
  KonchatNotification: "KonchatNotification"
}, 3);
module.link("./lib/rocket", {
  Login: "Login",
  Button: "Button"
}, 4);
module.link("./lib/recorderjs/audioRecorder", {
  AudioRecorder: "AudioRecorder"
}, 5);
module.link("./lib/recorderjs/videoRecorder", {
  VideoRecorder: "VideoRecorder"
}, 6);
module.link("./views/app/room", {
  chatMessages: "chatMessages"
}, 7);
module.link("./lib/userPopoverStatus", {
  "*": "*"
}, 8);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/index.ts                                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client/index", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"client":{"views":{"customFieldsForm.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/views/customFieldsForm.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.customFieldsForm.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.customFieldsForm.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/views/template.customFieldsForm.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("customFieldsForm");
Template["customFieldsForm"] = new Template("Template.customFieldsForm", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("customFields"));
  }, function() {
    return [ "\n\t", HTML.DIV({
      class: "rc-form-group rc-grid"
    }, "\n\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("customFields"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "rc-input rc-w50 padded"
      }, "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("$eq"), Spacebars.dot(view.lookup("field"), "type"), "select");
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.Unless(function() {
          return Spacebars.call(Spacebars.dot(view.lookup(".."), "new"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.DIV({
            class: "input-line"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            for: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            }
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), view.lookup("fieldName"));
          })), "\n\t\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t\t", HTML.SELECT({
            name: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            "data-customfield": "true"
          }, "\n\t\t\t\t\t\t\t\t\t", Blaze.Each(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("field"), "options"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.OPTION({
              value: function() {
                return Spacebars.mustache(view.lookup("."));
              },
              selected: function() {
                return Spacebars.mustache(view.lookup("selectedField"), view.lookup("."), view.lookup(".."));
              }
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), view.lookup("."));
            })), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t"), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label"
          }, "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__title"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), view.lookup("fieldName"));
          })), "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t", HTML.SELECT({
            name: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            "data-customfield": "true",
            class: "rc-input__element"
          }, HTML.Raw("\n\t\t\t\t\t\t\t\t\t<option></option>\n\t\t\t\t\t\t\t\t\t"), Blaze.Each(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("field"), "options"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.OPTION({
              value: function() {
                return Spacebars.mustache(view.lookup("."));
              },
              selected: function() {
                return Spacebars.mustache(view.lookup("selectedField"), view.lookup("."), view.lookup(".."));
              }
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), view.lookup("."));
            })), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("$eq"), Spacebars.dot(view.lookup("field"), "type"), "text");
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.Unless(function() {
          return Spacebars.call(Spacebars.dot(view.lookup(".."), "new"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.DIV({
            class: "input-line"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            for: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            }
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), view.lookup("fieldName"));
          })), "\n\t\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t\t", HTML.INPUT({
            type: "text",
            name: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            id: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            "data-customfield": "true",
            value: function() {
              return Spacebars.mustache(view.lookup("fieldValue"));
            },
            maxlength: function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("field"), "maxLength"));
            }
          }), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label"
          }, "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__title"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), view.lookup("fieldName"));
          })), "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
            type: "text",
            class: "rc-input__element",
            name: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            id: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            "data-customfield": "true",
            value: function() {
              return Spacebars.mustache(view.lookup("fieldValue"));
            },
            maxlength: function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("field"), "maxLength"));
            }
          }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t"), "\n" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"customFieldsForm.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/views/customFieldsForm.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);
Template.customFieldsForm.helpers({
  new() {
    return this.new;
  },

  customFields() {
    const customFields = Template.instance().customFields.get();

    if (!customFields) {
      return [];
    }

    const customFieldsArray = [];
    Object.keys(customFields).forEach(key => {
      const value = customFields[key];

      if (value.hideFromForm === true && Template.instance().hideFromForm === true) {
        return;
      }

      customFieldsArray.push({
        fieldName: key,
        field: value
      });
    });
    return customFieldsArray;
  },

  selectedField(current, field) {
    const {
      formData
    } = Template.instance();

    if (typeof formData[field.fieldName] !== 'undefined') {
      return formData[field.fieldName] === current;
    }

    if (typeof field.defaultValue !== 'undefined') {
      return field.defaultValue === current;
    }
  },

  fieldValue() {
    const {
      formData
    } = Template.instance();
    return formData[this.fieldName];
  }

});
Template.customFieldsForm.onCreated(function () {
  this.customFields = new ReactiveVar();
  const currentData = Template.currentData();
  this.hideFromForm = currentData && currentData.hideFromForm;
  this.formData = currentData && currentData.formData || {};
  Tracker.autorun(() => {
    const Accounts_CustomFields = settings.get('Accounts_CustomFields');

    if (typeof Accounts_CustomFields === 'string' && Accounts_CustomFields.trim() !== '') {
      try {
        this.customFields.set(JSON.parse(settings.get('Accounts_CustomFields')));
      } catch (e) {
        console.error('Invalid JSON for Accounts_CustomFields');
      }
    } else {
      this.customFields.set(undefined);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"LoginPresence.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/lib/LoginPresence.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  LoginPresence: () => LoginPresence
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);
const LoginPresence = {
  awayTime: 600000,
  // 10 minutes
  started: false,

  startTimer() {
    LoginPresence.stopTimer();

    if (!LoginPresence.awayTime) {
      return;
    }

    this.timer = setTimeout(LoginPresence.disconnect, LoginPresence.awayTime);
  },

  stopTimer() {
    clearTimeout(this.timer);
  },

  disconnect() {
    const status = Meteor.status();

    if (status && status.status !== 'offline') {
      if (!Meteor.userId() && settings.get('Accounts_AllowAnonymousRead') !== true) {
        Meteor.disconnect();
      }
    }

    LoginPresence.stopTimer();
  },

  connect() {
    const status = Meteor.status();

    if (status && status.status === 'offline') {
      Meteor.reconnect();
    }
  },

  start() {
    if (LoginPresence.started) {
      return;
    }

    window.addEventListener('focus', () => {
      LoginPresence.stopTimer();
      LoginPresence.connect();
    });
    window.addEventListener('blur', () => {
      LoginPresence.startTimer();
    });

    if (!window.document.hasFocus()) {
      LoginPresence.startTimer();
    }

    LoginPresence.started = true;
  }

};
LoginPresence.start();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RocketChatAnnouncement.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/lib/RocketChatAnnouncement.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RocketChatAnnouncement: () => RocketChatAnnouncement
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 2);

class RocketChatAnnouncement {
  constructor() {
    let args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    this.room = new ReactiveVar(args.room);
    this.message = new ReactiveVar(args.message);
    this.callback = new ReactiveVar(args.callback);
    this.style = new ReactiveVar(args.style);
  }

  save() {
    const announcementObject = {
      message: this.message.get(),
      callback: this.callback.get(),
      style: this.style.get()
    };
    Meteor.call('saveRoomSettings', this.room.get(), 'roomAnnouncement', announcementObject);
  }

  getMessage() {
    return this.message.get();
  }

  getCallback() {
    return this.callback.get();
  }

  getStyle() {
    return this.callback.get();
  }

  getByRoom(rid) {
    const roomData = Session.get("roomData".concat(rid));

    if (!roomData) {
      return null;
    }

    this.room.set(rid);
    this.message.set(roomData.announcement);
    this.callback.set(roomData.announcementDetails ? roomData.announcementDetails.callback : null);
    this.style.set(roomData.announcementDetails ? roomData.announcementDetails.style : null);
    return this;
  }

  clear() {
    this.message.set(null);
    this.callback.set(null);
    this.style.set(null);
    Meteor.call('saveRoomSettings', this.room.get(), 'roomAnnouncement', {});
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/lib/index.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./RocketChatAnnouncement", {
  RocketChatAnnouncement: "RocketChatAnnouncement"
}, 0);
module.link("./LoginPresence", {
  LoginPresence: "LoginPresence"
}, 1);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"methods":{"sendMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/methods/sendMessage.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let TimeSync;
module.link("meteor/mizzao:timesync", {
  TimeSync(v) {
    TimeSync = v;
  }

}, 1);
let s;
module.link("underscore.string", {
  default(v) {
    s = v;
  }

}, 2);
let ChatMessage;
module.link("../../../models", {
  ChatMessage(v) {
    ChatMessage = v;
  }

}, 3);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 4);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 5);
let t;
module.link("../../../utils/client", {
  t(v) {
    t = v;
  }

}, 6);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 7);
let onClientMessageReceived;
module.link("../../../../client/lib/onClientMessageReceived", {
  onClientMessageReceived(v) {
    onClientMessageReceived = v;
  }

}, 8);
Meteor.methods({
  sendMessage(message) {
    if (!Meteor.userId() || s.trim(message.msg) === '') {
      return false;
    }

    const messageAlreadyExists = message._id && ChatMessage.findOne({
      _id: message._id
    });

    if (messageAlreadyExists) {
      return dispatchToastMessage({
        type: 'error',
        message: t('Message_Already_Sent')
      });
    }

    const user = Meteor.user();
    message.ts = isNaN(TimeSync.serverOffset()) ? new Date() : new Date(Date.now() + TimeSync.serverOffset());
    message.u = {
      _id: Meteor.userId(),
      username: user.username
    };

    if (settings.get('UI_Use_Real_Name')) {
      message.u.name = user.name;
    }

    message.temp = true;

    if (settings.get('Message_Read_Receipt_Enabled')) {
      message.unread = true;
    }

    message = callbacks.run('beforeSaveMessage', message);
    onClientMessageReceived(message).then(function (message) {
      ChatMessage.insert(message);
      return callbacks.run('afterSaveMessage', message);
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"startup":{"settingsOnLoadSiteUrl.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/startup/settingsOnLoadSiteUrl.ts                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 2);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const value = settings.get('Site_Url');

    if (value == null || value.trim() === '') {
      return;
    }

    window.__meteor_runtime_config__.ROOT_URL = value;
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"OAuthProxy.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/OAuthProxy.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let OAuth;
module.link("meteor/oauth", {
  OAuth(v) {
    OAuth = v;
  }

}, 1);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);
OAuth.launchLogin = _.wrap(OAuth.launchLogin, function (func, options) {
  const proxy = settings.get('Accounts_OAuth_Proxy_services').replace(/\s/g, '').split(',');

  if (proxy.includes(options.loginService)) {
    const redirect_uri = options.loginUrl.match(/(&redirect_uri=)([^&]+|$)/)[2];
    options.loginUrl = options.loginUrl.replace(/(&redirect_uri=)([^&]+|$)/, "$1".concat(encodeURIComponent(settings.get('Accounts_OAuth_Proxy_host')), "/oauth_redirect"));
    options.loginUrl = options.loginUrl.replace(/(&state=)([^&]+|$)/, "$1".concat(redirect_uri, "!$2"));
    options.loginUrl = "".concat(settings.get('Accounts_OAuth_Proxy_host'), "/redirect/").concat(encodeURIComponent(options.loginUrl));
  }

  return func(options);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/index.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./startup/settingsOnLoadSiteUrl");
module.link("../lib/MessageTypes");
module.link("./OAuthProxy");
module.link("./methods/sendMessage");
module.link("./views/customFieldsForm.html");
module.link("./views/customFieldsForm");
module.link("../startup/defaultRoomTypes");
module.link("./lib", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"roomTypes":{"conversation.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/conversation.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ConversationRoomType: () => ConversationRoomType
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let getUserPreference, RoomTypeConfig;
module.link("../../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  },

  RoomTypeConfig(v) {
    RoomTypeConfig = v;
  }

}, 1);

class ConversationRoomType extends RoomTypeConfig {
  constructor() {
    super({
      identifier: 'merged',
      order: 30,
      label: 'Conversations'
    });
  }

  condition() {
    // returns true only if sidebarGroupByType is not set
    return !getUserPreference(Meteor.userId(), 'sidebarGroupByType');
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"direct.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/direct.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  DirectMessageRoomRoute: () => DirectMessageRoomRoute,
  DirectMessageRoomType: () => DirectMessageRoomType
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let ChatRoom, Subscriptions;
module.link("../../../models", {
  ChatRoom(v) {
    ChatRoom = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 2);
let openRoom;
module.link("../../../ui-utils", {
  openRoom(v) {
    openRoom = v;
  }

}, 3);
let getUserPreference, RoomTypeConfig, RoomTypeRouteConfig, RoomSettingsEnum, RoomMemberActions, UiTextContext;
module.link("../../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  },

  RoomTypeConfig(v) {
    RoomTypeConfig = v;
  },

  RoomTypeRouteConfig(v) {
    RoomTypeRouteConfig = v;
  },

  RoomSettingsEnum(v) {
    RoomSettingsEnum = v;
  },

  RoomMemberActions(v) {
    RoomMemberActions = v;
  },

  UiTextContext(v) {
    UiTextContext = v;
  }

}, 4);
let hasPermission, hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasPermission(v) {
    hasPermission = v;
  },

  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 5);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 6);
let getUserAvatarURL;
module.link("../../../utils/lib/getUserAvatarURL", {
  getUserAvatarURL(v) {
    getUserAvatarURL = v;
  }

}, 7);
let getAvatarURL;
module.link("../../../utils/lib/getAvatarURL", {
  getAvatarURL(v) {
    getAvatarURL = v;
  }

}, 8);

class DirectMessageRoomRoute extends RoomTypeRouteConfig {
  constructor() {
    super({
      name: 'direct',
      path: '/direct/:rid/:tab?/:context?'
    });
  }

  action(params) {
    return openRoom('d', params.rid);
  }

  link(sub) {
    return {
      rid: sub.rid || sub.name
    };
  }

}

class DirectMessageRoomType extends RoomTypeConfig {
  constructor() {
    super({
      identifier: 'd',
      order: 50,
      icon: 'at',
      label: 'Direct_Messages',
      route: new DirectMessageRoomRoute()
    });
  }

  getIcon(roomData) {
    if (this.isGroupChat(roomData)) {
      return 'balloon';
    }

    return this.icon;
  }

  findRoom(identifier) {
    if (!hasPermission('view-d-room')) {
      return null;
    }

    const query = {
      t: 'd',
      $or: [{
        name: identifier
      }, {
        rid: identifier
      }]
    };
    const subscription = Subscriptions.findOne(query);

    if (subscription && subscription.rid) {
      return ChatRoom.findOne(subscription.rid);
    }
  }

  roomName(roomData) {
    // this function can receive different types of data
    // if it doesn't have fname and name properties, should be a Room object
    // so, need to find the related subscription
    const subscription = roomData && (roomData.fname || roomData.name) ? roomData : Subscriptions.findOne({
      rid: roomData._id
    });

    if (subscription === undefined) {
      return;
    }

    if (settings.get('UI_Use_Real_Name') && subscription.fname) {
      return subscription.fname;
    }

    return subscription.name;
  }

  secondaryRoomName(roomData) {
    if (settings.get('UI_Use_Real_Name')) {
      const subscription = Subscriptions.findOne({
        rid: roomData._id
      }, {
        fields: {
          name: 1
        }
      });
      return subscription && subscription.name;
    }
  }

  condition() {
    const groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');
    return groupByType && hasAtLeastOnePermission(['view-d-room', 'view-joined-room']);
  }

  getUserStatus(roomId) {
    const subscription = Subscriptions.findOne({
      rid: roomId
    });

    if (subscription == null) {
      return;
    }

    return Session.get("user_".concat(subscription.name, "_status"));
  }

  getUserStatusText(roomId) {
    const subscription = Subscriptions.findOne({
      rid: roomId
    });

    if (subscription == null) {
      return;
    }

    return Session.get("user_".concat(subscription.name, "_status_text"));
  }

  allowRoomSettingChange(room, setting) {
    switch (setting) {
      case RoomSettingsEnum.TYPE:
      case RoomSettingsEnum.NAME:
      case RoomSettingsEnum.SYSTEM_MESSAGES:
      case RoomSettingsEnum.DESCRIPTION:
      case RoomSettingsEnum.READ_ONLY:
      case RoomSettingsEnum.REACT_WHEN_READ_ONLY:
      case RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE:
      case RoomSettingsEnum.JOIN_CODE:
        return false;

      case RoomSettingsEnum.E2E:
        return settings.get('E2E_Enable') === true;

      default:
        return true;
    }
  }

  allowMemberAction(room, action) {
    switch (action) {
      case RoomMemberActions.BLOCK:
        return !this.isGroupChat(room);

      default:
        return false;
    }
  }

  enableMembersListProfile() {
    return true;
  }

  userDetailShowAll() {
    return true;
  }

  getUiText(context) {
    switch (context) {
      case UiTextContext.HIDE_WARNING:
        return 'Hide_Private_Warning';

      case UiTextContext.LEAVE_WARNING:
        return 'Leave_Private_Warning';

      default:
        return '';
    }
  }
  /**
   * Returns details to use on notifications
   *
   * @param {object} room
   * @param {object} user
   * @param {string} notificationMessage
   * @return {object} Notification details
   */


  getNotificationDetails(room, user, notificationMessage) {
    if (!Meteor.isServer) {
      return {};
    }

    if (this.isGroupChat(room)) {
      return {
        title: this.roomName(room),
        text: "".concat(settings.get('UI_Use_Real_Name') && user.name || user.username, ": ").concat(notificationMessage)
      };
    }

    return {
      title: settings.get('UI_Use_Real_Name') && user.name || user.username,
      text: notificationMessage
    };
  }

  getAvatarPath(roomData, subData) {
    if (!roomData && !subData) {
      return '';
    } // if coming from sidenav search


    if (roomData.name && roomData.avatarETag) {
      return getUserAvatarURL(roomData.name, roomData.avatarETag);
    }

    if (this.isGroupChat(roomData)) {
      return getAvatarURL({
        username: roomData.uids.length + roomData.usernames.join()
      });
    }

    const sub = subData || Subscriptions.findOne({
      rid: roomData._id
    }, {
      fields: {
        name: 1
      }
    });

    if (sub && sub.name) {
      const user = Meteor.users.findOne({
        username: sub.name
      }, {
        fields: {
          username: 1,
          avatarETag: 1
        }
      });
      return getUserAvatarURL((user === null || user === void 0 ? void 0 : user.username) || sub.name, user === null || user === void 0 ? void 0 : user.avatarETag);
    }

    if (roomData) {
      return getUserAvatarURL(roomData.name || this.roomName(roomData)); // rooms should have no name for direct messages...
    }
  }

  includeInDashboard() {
    return true;
  }

  isGroupChat(room) {
    return room && room.uids && room.uids.length > 2;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"favorite.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/favorite.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  FavoriteRoomType: () => FavoriteRoomType
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);
let getUserPreference, RoomTypeConfig;
module.link("../../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  },

  RoomTypeConfig(v) {
    RoomTypeConfig = v;
  }

}, 2);

class FavoriteRoomType extends RoomTypeConfig {
  constructor() {
    super({
      identifier: 'f',
      order: 20,
      header: 'favorite',
      icon: 'star',
      label: 'Favorites'
    });
  }

  condition() {
    return settings.get('Favorite_Rooms') && getUserPreference(Meteor.userId(), 'sidebarShowFavorites');
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ConversationRoomType: () => ConversationRoomType,
  DirectMessageRoomType: () => DirectMessageRoomType,
  FavoriteRoomType: () => FavoriteRoomType,
  PrivateRoomType: () => PrivateRoomType,
  PublicRoomType: () => PublicRoomType,
  UnreadRoomType: () => UnreadRoomType
});
let ConversationRoomType;
module.link("./conversation", {
  ConversationRoomType(v) {
    ConversationRoomType = v;
  }

}, 0);
let DirectMessageRoomType;
module.link("./direct", {
  DirectMessageRoomType(v) {
    DirectMessageRoomType = v;
  }

}, 1);
let FavoriteRoomType;
module.link("./favorite", {
  FavoriteRoomType(v) {
    FavoriteRoomType = v;
  }

}, 2);
let PrivateRoomType;
module.link("./private", {
  PrivateRoomType(v) {
    PrivateRoomType = v;
  }

}, 3);
let PublicRoomType;
module.link("./public", {
  PublicRoomType(v) {
    PublicRoomType = v;
  }

}, 4);
let UnreadRoomType;
module.link("./unread", {
  UnreadRoomType(v) {
    UnreadRoomType = v;
  }

}, 5);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"private.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/private.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  PrivateRoomRoute: () => PrivateRoomRoute,
  PrivateRoomType: () => PrivateRoomType
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ChatRoom, ChatSubscription;
module.link("../../../models", {
  ChatRoom(v) {
    ChatRoom = v;
  },

  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 1);
let openRoom;
module.link("../../../ui-utils", {
  openRoom(v) {
    openRoom = v;
  }

}, 2);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);
let hasAtLeastOnePermission, hasPermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  },

  hasPermission(v) {
    hasPermission = v;
  }

}, 4);
let getUserPreference, RoomSettingsEnum, RoomTypeConfig, RoomTypeRouteConfig, UiTextContext, RoomMemberActions;
module.link("../../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  },

  RoomSettingsEnum(v) {
    RoomSettingsEnum = v;
  },

  RoomTypeConfig(v) {
    RoomTypeConfig = v;
  },

  RoomTypeRouteConfig(v) {
    RoomTypeRouteConfig = v;
  },

  UiTextContext(v) {
    UiTextContext = v;
  },

  RoomMemberActions(v) {
    RoomMemberActions = v;
  }

}, 5);
let getAvatarURL;
module.link("../../../utils/lib/getAvatarURL", {
  getAvatarURL(v) {
    getAvatarURL = v;
  }

}, 6);

class PrivateRoomRoute extends RoomTypeRouteConfig {
  constructor() {
    super({
      name: 'group',
      path: '/group/:name/:tab?/:context?'
    });
  }

  action(params) {
    return openRoom('p', params.name);
  }

}

class PrivateRoomType extends RoomTypeConfig {
  constructor() {
    super({
      identifier: 'p',
      order: 40,
      icon: 'hashtag-lock',
      label: 'Private_Groups',
      route: new PrivateRoomRoute()
    });
  }

  getIcon(roomData) {
    if (roomData.prid) {
      return 'discussion';
    }

    if (roomData.teamMain) {
      return 'team-lock';
    }

    return this.icon;
  }

  findRoom(identifier) {
    const query = {
      t: 'p',
      name: identifier
    };
    return ChatRoom.findOne(query);
  }

  roomName(roomData) {
    if (roomData.prid) {
      return roomData.fname;
    }

    if (settings.get('UI_Allow_room_names_with_special_chars')) {
      return roomData.fname || roomData.name;
    }

    return roomData.name;
  }

  condition() {
    const groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');
    return groupByType && hasPermission('view-p-room');
  }

  isGroupChat() {
    return true;
  }

  canAddUser(room) {
    return hasAtLeastOnePermission(['add-user-to-any-p-room', 'add-user-to-joined-room'], room._id);
  }

  canSendMessage(roomId) {
    // TODO: remove duplicated code
    return ChatSubscription.find({
      rid: roomId
    }).count() > 0;
  }

  allowRoomSettingChange(room, setting) {
    switch (setting) {
      case RoomSettingsEnum.JOIN_CODE:
        return false;

      case RoomSettingsEnum.BROADCAST:
        return room.broadcast;

      case RoomSettingsEnum.READ_ONLY:
        return !room.broadcast;

      case RoomSettingsEnum.REACT_WHEN_READ_ONLY:
        return !room.broadcast && room.ro;

      case RoomSettingsEnum.E2E:
        return settings.get('E2E_Enable') === true;

      case RoomSettingsEnum.SYSTEM_MESSAGES:
      default:
        return true;
    }
  }

  allowMemberAction(room, action) {
    switch (action) {
      case RoomMemberActions.BLOCK:
        return false;

      default:
        return true;
    }
  }

  enableMembersListProfile() {
    return true;
  }

  getUiText(context) {
    switch (context) {
      case UiTextContext.HIDE_WARNING:
        return 'Hide_Group_Warning';

      case UiTextContext.LEAVE_WARNING:
        return 'Leave_Group_Warning';

      default:
        return '';
    }
  }

  getAvatarPath(roomData) {
    return getAvatarURL({
      roomId: roomData._id,
      cache: roomData.avatarETag
    });
  }

  includeInDashboard() {
    return true;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"public.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/public.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  PublicRoomRoute: () => PublicRoomRoute,
  PublicRoomType: () => PublicRoomType
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let openRoom;
module.link("../../../ui-utils", {
  openRoom(v) {
    openRoom = v;
  }

}, 1);
let ChatRoom, ChatSubscription;
module.link("../../../models", {
  ChatRoom(v) {
    ChatRoom = v;
  },

  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 2);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);
let hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 4);
let getUserPreference, RoomTypeConfig, RoomTypeRouteConfig, RoomSettingsEnum, UiTextContext, RoomMemberActions;
module.link("../../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  },

  RoomTypeConfig(v) {
    RoomTypeConfig = v;
  },

  RoomTypeRouteConfig(v) {
    RoomTypeRouteConfig = v;
  },

  RoomSettingsEnum(v) {
    RoomSettingsEnum = v;
  },

  UiTextContext(v) {
    UiTextContext = v;
  },

  RoomMemberActions(v) {
    RoomMemberActions = v;
  }

}, 5);
let getAvatarURL;
module.link("../../../utils/lib/getAvatarURL", {
  getAvatarURL(v) {
    getAvatarURL = v;
  }

}, 6);

class PublicRoomRoute extends RoomTypeRouteConfig {
  constructor() {
    super({
      name: 'channel',
      path: '/channel/:name/:tab?/:context?'
    });
  }

  action(params) {
    return openRoom('c', params.name);
  }

}

class PublicRoomType extends RoomTypeConfig {
  constructor() {
    super({
      identifier: 'c',
      order: 30,
      icon: 'hashtag',
      label: 'Channels',
      route: new PublicRoomRoute()
    });
  }

  getIcon(roomData) {
    if (roomData.prid) {
      return 'discussion';
    }

    if (roomData.teamMain) {
      return 'team';
    }

    return this.icon;
  }

  findRoom(identifier) {
    const query = {
      t: 'c',
      name: identifier
    };
    return ChatRoom.findOne(query);
  }

  roomName(roomData) {
    if (roomData.prid) {
      return roomData.fname;
    }

    if (settings.get('UI_Allow_room_names_with_special_chars')) {
      return roomData.fname || roomData.name;
    }

    return roomData.name;
  }

  condition() {
    const groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');
    return groupByType && (hasAtLeastOnePermission(['view-c-room', 'view-joined-room']) || settings.get('Accounts_AllowAnonymousRead') === true);
  }

  showJoinLink(roomId) {
    return !!ChatRoom.findOne({
      _id: roomId,
      t: 'c'
    });
  }

  includeInRoomSearch() {
    return true;
  }

  isGroupChat() {
    return true;
  }

  includeInDashboard() {
    return true;
  }

  canAddUser(room) {
    return hasAtLeastOnePermission(['add-user-to-any-c-room', 'add-user-to-joined-room'], room._id);
  }

  canSendMessage(roomId) {
    const room = ChatRoom.findOne({
      _id: roomId,
      t: 'c'
    }, {
      fields: {
        prid: 1
      }
    });

    if (room.prid) {
      return true;
    } // TODO: remove duplicated code


    return ChatSubscription.find({
      rid: roomId
    }).count() > 0;
  }

  enableMembersListProfile() {
    return true;
  }

  allowRoomSettingChange(room, setting) {
    switch (setting) {
      case RoomSettingsEnum.BROADCAST:
        return room.broadcast;

      case RoomSettingsEnum.READ_ONLY:
        return !room.broadcast;

      case RoomSettingsEnum.REACT_WHEN_READ_ONLY:
        return !room.broadcast && room.ro;

      case RoomSettingsEnum.E2E:
        return false;

      case RoomSettingsEnum.SYSTEM_MESSAGES:
      default:
        return true;
    }
  }

  allowMemberAction(room, action) {
    switch (action) {
      case RoomMemberActions.BLOCK:
        return false;

      default:
        return true;
    }
  }

  getUiText(context) {
    switch (context) {
      case UiTextContext.HIDE_WARNING:
        return 'Hide_Room_Warning';

      case UiTextContext.LEAVE_WARNING:
        return 'Leave_Room_Warning';

      default:
        return '';
    }
  }

  getAvatarPath(roomData) {
    return getAvatarURL({
      roomId: roomData._id,
      cache: roomData.avatarETag
    });
  }

  getDiscussionType() {
    return 'c';
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"unread.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/unread.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  UnreadRoomType: () => UnreadRoomType
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let getUserPreference, RoomTypeConfig;
module.link("../../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  },

  RoomTypeConfig(v) {
    RoomTypeConfig = v;
  }

}, 1);

class UnreadRoomType extends RoomTypeConfig {
  constructor() {
    super({
      identifier: 'unread',
      order: 10,
      label: 'Unread'
    });
    this.unread = true;
  }

  condition() {
    return getUserPreference(Meteor.userId(), 'sidebarShowUnread');
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"MessageTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/MessageTypes.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  MessageTypesValues: () => MessageTypesValues
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let MessageTypes;
module.link("../../ui-utils", {
  MessageTypes(v) {
    MessageTypes = v;
  }

}, 1);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 2);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'r',
    system: true,
    message: 'Room_name_changed',

    data(message) {
      return {
        room_name: message.msg,
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'au',
    system: true,
    message: 'User_added_by',

    data(message) {
      return {
        user_added: message.msg,
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'ru',
    system: true,
    message: 'User_removed_by',

    data(message) {
      return {
        user_removed: message.msg,
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'ul',
    system: true,
    message: 'User_left',

    data(message) {
      return {
        user_left: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'ult',
    system: true,
    message: 'User_left_team',

    data(message) {
      return {
        user_left: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'uj',
    system: true,
    message: 'User_joined_channel',

    data(message) {
      return {
        user: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'ujt',
    system: true,
    message: 'User_joined_team',

    data(message) {
      return {
        user: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'ut',
    system: true,
    message: 'User_joined_conversation',

    data(message) {
      return {
        user: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'wm',
    system: true,
    message: 'Welcome',

    data(message) {
      return {
        user: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'rm',
    system: true,
    message: 'Message_removed',

    data(message) {
      return {
        user: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'rtc',

    render(message) {
      return callbacks.run('renderRtcMessage', message);
    }

  });
  MessageTypes.registerType({
    id: 'user-muted',
    system: true,
    message: 'User_muted_by',

    data(message) {
      return {
        user_muted: message.msg,
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'user-unmuted',
    system: true,
    message: 'User_unmuted_by',

    data(message) {
      return {
        user_unmuted: message.msg,
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'subscription-role-added',
    system: true,
    message: '__username__was_set__role__by__user_by_',

    data(message) {
      return {
        username: message.msg,
        role: message.role,
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'subscription-role-removed',
    system: true,
    message: '__username__is_no_longer__role__defined_by__user_by_',

    data(message) {
      return {
        username: message.msg,
        role: message.role,
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'room-archived',
    system: true,
    message: 'This_room_has_been_archived_by__username_',

    data(message) {
      return {
        username: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'room-unarchived',
    system: true,
    message: 'This_room_has_been_unarchived_by__username_',

    data(message) {
      return {
        username: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'room-removed-read-only',
    system: true,
    message: 'room_removed_read_only',

    data(message) {
      return {
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'room-set-read-only',
    system: true,
    message: 'room_set_read_only',

    data(message) {
      return {
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'room-allowed-reacting',
    system: true,
    message: 'room_allowed_reacting',

    data(message) {
      return {
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'room-disallowed-reacting',
    system: true,
    message: 'room_disallowed_reacting',

    data(message) {
      return {
        user_by: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'room_e2e_enabled',
    system: true,
    message: 'This_room_encryption_has_been_enabled_by__username_',

    data(message) {
      return {
        username: message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'room_e2e_disabled',
    system: true,
    message: 'This_room_encryption_has_been_disabled_by__username_',

    data(message) {
      return {
        username: message.u.username
      };
    }

  });
});
const MessageTypesValues = [{
  key: 'uj',
  i18nLabel: 'Message_HideType_uj'
}, {
  key: 'ul',
  i18nLabel: 'Message_HideType_ul'
}, {
  key: 'ru',
  i18nLabel: 'Message_HideType_ru'
}, {
  key: 'au',
  i18nLabel: 'Message_HideType_au'
}, {
  key: 'mute_unmute',
  i18nLabel: 'Message_HideType_mute_unmute'
}, {
  key: 'r',
  i18nLabel: 'Message_HideType_r'
}, {
  key: 'ut',
  i18nLabel: 'Message_HideType_ut'
}, {
  key: 'wm',
  i18nLabel: 'Message_HideType_wm'
}, {
  key: 'rm',
  i18nLabel: 'Message_HideType_rm'
}, {
  key: 'subscription-role-added',
  i18nLabel: 'Message_HideType_subscription_role_added'
}, {
  key: 'subscription-role-removed',
  i18nLabel: 'Message_HideType_subscription_role_removed'
}, {
  key: 'room_archived',
  i18nLabel: 'Message_HideType_room_archived'
}, {
  key: 'room_unarchived',
  i18nLabel: 'Message_HideType_room_unarchived'
}, {
  key: 'room_changed_privacy',
  i18nLabel: 'Message_HideType_room_changed_privacy'
}, {
  key: 'room_changed_avatar',
  i18nLabel: 'Message_HideType_room_changed_avatar'
}, {
  key: 'room_changed_topic',
  i18nLabel: 'Message_HideType_room_changed_topic'
}, {
  key: 'room_e2e_enabled',
  i18nLabel: 'Message_HideType_room_enabled_encryption'
}, {
  key: 'room_e2e_disabled',
  i18nLabel: 'Message_HideType_room_disabled_encryption'
}, {
  key: 'room-removed-read-only',
  i18nLabel: 'Message_HideType_room_removed_read_only'
}, {
  key: 'room-set-read-only',
  i18nLabel: 'Message_HideType_room_set_read_only'
}, {
  key: 'room-disallowed-reacting',
  i18nLabel: 'Message_HideType_room_disallowed_reacting'
}, {
  key: 'room-allowed-reacting',
  i18nLabel: 'Message_HideType_room_allowed_reacting'
}];
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"startup":{"defaultRoomTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/startup/defaultRoomTypes.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let roomTypes;
module.link("../../utils", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 0);
let ConversationRoomType, DirectMessageRoomType, FavoriteRoomType, PrivateRoomType, PublicRoomType, UnreadRoomType;
module.link("../lib/roomTypes", {
  ConversationRoomType(v) {
    ConversationRoomType = v;
  },

  DirectMessageRoomType(v) {
    DirectMessageRoomType = v;
  },

  FavoriteRoomType(v) {
    FavoriteRoomType = v;
  },

  PrivateRoomType(v) {
    PrivateRoomType = v;
  },

  PublicRoomType(v) {
    PublicRoomType = v;
  },

  UnreadRoomType(v) {
    UnreadRoomType = v;
  }

}, 1);
roomTypes.add(new UnreadRoomType());
roomTypes.add(new FavoriteRoomType());
roomTypes.add(new ConversationRoomType());
roomTypes.add(new PublicRoomType());
roomTypes.add(new PrivateRoomType());
roomTypes.add(new DirectMessageRoomType());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/index.js                                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ui-utils":{"client":{"lib":{"collapseArrow.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/collapseArrow.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.collapseArrow.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.collapseArrow.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/template.collapseArrow.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("collapseArrow");
Template["collapseArrow"] = new Template("Template.collapseArrow", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("collapsed"));
  }, function() {
    return [ "\n        ", HTML.SPAN({
      class: "collapse-switch icon-right-dir",
      "data-index": function() {
        return Spacebars.mustache(view.lookup("index"));
      },
      "data-collapsed": function() {
        return Spacebars.mustache(view.lookup("collapsed"));
      }
    }), "\n    " ];
  }, function() {
    return [ "\n        ", HTML.SPAN({
      class: "collapse-switch icon-down-dir",
      "data-index": function() {
        return Spacebars.mustache(view.lookup("index"));
      },
      "data-collapsed": function() {
        return Spacebars.mustache(view.lookup("collapsed"));
      }
    }), "\n    " ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"modal.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/modal.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.modal.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.modal.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/template.modal.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("rc_modal");
Template["rc_modal"] = new Template("Template.rc_modal", (function() {
  var view = this;
  return HTML.DIV({
    class: "rc-modal-wrapper"
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.dataMustache(view.lookup("$eq"), view.lookup("template"), "ModalBlock");
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("data"));
    }, function() {
      return Spacebars.include(view.lookupTemplate("ModalBlock"));
    }), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t", HTML.getTag("dialog")({
      class: function() {
        return [ "rc-modal rc-modal--", Spacebars.mustache(view.lookup("modifier")) ];
      },
      "data-modal": "modal"
    }, "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("template"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          template: Spacebars.call(view.lookup("template")),
          data: Spacebars.call(view.lookup("data"))
        };
      }, function() {
        return Spacebars.include(function() {
          return Spacebars.call(Template.__dynamic);
        });
      }), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", HTML.HEADER({
        class: "rc-modal__header"
      }, "\n\t\t\t\t\t", HTML.H1({
        class: "rc-modal__title"
      }, "\n\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("html"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:title", function() {
          return Spacebars.makeRaw(Spacebars.mustache(view.lookup("title")));
        }), "\n\t\t\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:title", function() {
          return Spacebars.mustache(view.lookup("title"));
        }), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.BUTTON({
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Close");
        },
        class: "contextual-bar__close js-close"
      }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          classes: Spacebars.call("rc-modal__close"),
          icon: Spacebars.call("plus")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\n\t\t\t\t", HTML.SECTION({
        class: "rc-modal__content"
      }, "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("content"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            template: Spacebars.call(view.lookup("content")),
            data: Spacebars.call(view.lookup("data"))
          };
        }, function() {
          return Spacebars.include(function() {
            return Spacebars.call(Template.__dynamic);
          });
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("type"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call(view.lookup("type")),
            icon: Spacebars.call(view.lookup("modalIcon"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("text"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "rc-modal__content-text"
        }, "\n\t\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("html"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:text", function() {
            return Spacebars.makeRaw(Spacebars.mustache(view.lookup("text")));
          }), "\n\t\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:text", function() {
            return Spacebars.mustache(view.lookup("text"));
          }), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("input"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input"
        }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-input__label"
        }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input__wrapper"
        }, "\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
          name: "name",
          type: function() {
            return Spacebars.mustache(view.lookup("inputType"));
          },
          class: "rc-input__element js-modal-input",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("inputPlaceholder"));
          }
        }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
          class: "rc-modal__content-error"
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("inputActionText"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.INPUT({
          class: "rc-button rc-button--nude js-input-action",
          type: "submit",
          "data-button": "input-action",
          value: function() {
            return Spacebars.mustache(view.lookup("inputActionText"));
          }
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("dontAskAgain"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-checkbox"
        }, "\n\t\t\t\t\t\t\t", HTML.INPUT({
          type: "checkbox",
          id: "dont-ask-me-again",
          class: "rc-checkbox__input js-modal-dont-ask"
        }), "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            icon: Spacebars.call("check"),
            block: Spacebars.call("rc-checkbox__icon")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t\t", HTML.SPAN({
          class: "rc-checkbox__text rc-text__small"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Dont_ask_me_again");
        })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("showFooter"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.FOOTER({
          class: function() {
            return [ "rc-modal__footer ", Blaze.Unless(function() {
              return Spacebars.call(view.lookup("showFooter"));
            }, function() {
              return "rc-modal__footer--empty";
            }) ];
          }
        }, "\n\t\t\t\t\t\t\t", HTML.INPUT({
          class: function() {
            return [ "rc-button rc-button--secondary js-close ", Blaze.Unless(function() {
              return Spacebars.call(view.lookup("showCancelButton"));
            }, function() {
              return "rc-button--invisible";
            }) ];
          },
          style: function() {
            return Blaze.If(function() {
              return Spacebars.call(view.lookup("cancelButtonColor"));
            }, function() {
              return [ "color: ", Blaze.View("lookup:cancelButtonColor", function() {
                return Spacebars.mustache(view.lookup("cancelButtonColor"));
              }) ];
            });
          },
          type: "submit",
          "data-button": "cancel",
          value: function() {
            return Spacebars.mustache(view.lookup("cancelButtonText"));
          }
        }), "\n\t\t\t\t\t\t\t", HTML.INPUT({
          style: function() {
            return [ "background-color:", Spacebars.mustache(view.lookup("confirmButtonColor")) ];
          },
          class: function() {
            return [ "rc-button rc-button--primary js-confirm ", Blaze.Unless(function() {
              return Spacebars.call(view.lookup("showConfirmButton"));
            }, function() {
              return "rc-button--invisible";
            }) ];
          },
          type: "submit",
          "data-button": "create",
          value: function() {
            return Spacebars.mustache(view.lookup("confirmButtonText"));
          }
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }), "\n\t\t\t"), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popout.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/popout.html                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.popout.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.popout.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/template.popout.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("popout");
Template["popout"] = new Template("Template.popout", (function() {
  var view = this;
  return HTML.DIV({
    class: function() {
      return [ "rc-popout-wrapper rc-popout--", Spacebars.mustache(view.lookup("type")) ];
    },
    draggable: "true"
  }, "\n\t\t", HTML.DIV({
    class: function() {
      return [ "rc-popout rc-popout--", Spacebars.mustache(view.lookup("state")) ];
    },
    "data-modal": "modal"
  }, "\n\t\t\t", HTML.HEADER({
    class: "rc-popout__header"
  }, "\n\t\t\t\t", HTML.H1({
    class: "rc-popout__title"
  }, Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call("podcast")
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  })), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("showVideoControls"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "rc-popout__controls"
    }, "\n\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isPlaying"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--pause"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("pause")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--play"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("play")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isMuted"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--unmute"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("volume-mute")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--mute"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("volume")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("showStreamControls"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "rc-popout__controls"
    }, "\n\t\t\t\t\t\t\t", HTML.BUTTON({
      class: function() {
        return [ "rc-popout__controls--record ", Spacebars.mustache(view.lookup("getStreamStatus")) ];
      }
    }, " ", Blaze._TemplateWith(function() {
      return {
        icon: Spacebars.call("circle")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), " "), "\n\t\t\t\t\t\t\t", HTML.SPAN(" ", Blaze.View("lookup:getStreamStatus", function() {
      return Spacebars.mustache(view.lookup("getStreamStatus"));
    }), " "), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("isAudioOnly"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.BUTTON({
      class: "contextual-bar__minimize js-minimize"
    }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        classes: Spacebars.call("rc-popout__minimize"),
        icon: Spacebars.call("arrow-down")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", HTML.BUTTON({
    class: "contextual-bar__close js-close",
    "aria-label": function() {
      return Spacebars.mustache(view.lookup("_"), "Close");
    }
  }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
    return {
      classes: Spacebars.call("rc-popout__close"),
      icon: Spacebars.call("plus")
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\n\t\t\t", HTML.SECTION({
    class: function() {
      return [ "rc-popout__content rc-popout--", Spacebars.mustache(view.lookup("state")), " " ];
    }
  }, "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("content"));
  }, function() {
    return [ "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        template: Spacebars.call(view.lookup("content")),
        data: Spacebars.call(view.lookup("data"))
      };
    }, function() {
      return Spacebars.include(function() {
        return Spacebars.call(Template.__dynamic);
      });
    }), "\n\t\t\t\t" ];
  }), "\n\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("showVideoControls"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "rc-popout__controls"
    }, "\n\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isPlaying"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--pause"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("pause")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--play"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("play")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isMuted"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--unmute"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("volume-mute")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--mute"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("volume")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("showStreamControls"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "rc-popout__controls"
    }, "\n\t\t\t\t\t\t", HTML.BUTTON({
      class: function() {
        return [ "rc-popout__controls--record ", Spacebars.mustache(view.lookup("getStreamStatus")) ];
      }
    }, " ", Blaze._TemplateWith(function() {
      return {
        icon: Spacebars.call("circle")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), " "), "\n\t\t\t\t\t\t", HTML.SPAN(" ", Blaze.View("lookup:getStreamStatus", function() {
      return Spacebars.mustache(view.lookup("getStreamStatus"));
    }), " "), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t"), "\n\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popover.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/popover.html                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.popover.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.popover.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/template.popover.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("popover");
Template["popover"] = new Template("Template.popover", (function() {
  var view = this;
  return HTML.DIV({
    class: function() {
      return [ "rc-popover rc-popover--", Spacebars.mustache(view.lookup("popoverClass")) ];
    },
    "data-popover": "popover",
    style: "display: block; visibility: hidden;"
  }, "\n\t\t", HTML.DIV({
    class: function() {
      return [ "rc-popover__content ", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("template"));
      }, function() {
        return "rc-popover__content--templateless";
      }), " ", Blaze.If(function() {
        return Spacebars.call(view.lookup("isSafariIos"));
      }, function() {
        return "rc-popover__content--safariIos";
      }) ];
    }
  }, "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("template"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        template: Spacebars.call(view.lookup("template")),
        data: Spacebars.call(view.lookup("data"))
      };
    }, function() {
      return Spacebars.include(function() {
        return Spacebars.call(Template.__dynamic);
      });
    }), "\n\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("columns")),
        _variable: "column"
      };
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV({
        class: "rc-popover__column"
      }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.call(Spacebars.dot(view.lookup("column"), "groups")),
          _variable: "group"
        };
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("group"), "title"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", HTML.H3({
            class: "rc-popover__title"
          }, Blaze.View("lookup:group.title", function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("group"), "title"));
          })), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t\t", HTML.UL({
          class: "rc-popover__list"
        }, "\n\t\t\t\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(Spacebars.dot(view.lookup("group"), "items")),
            _variable: "item"
          };
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t\t", Spacebars.With(function() {
            return Spacebars.call(view.lookup("item"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t", HTML.LI({
              "data-qa": function() {
                return Spacebars.mustache(view.lookup("qa"));
              },
              class: function() {
                return [ "rc-popover__item ", Blaze.If(function() {
                  return Spacebars.call(Spacebars.dot(view.lookup("item"), "modifier"));
                }, function() {
                  return [ "rc-popover__item--", Blaze.View("lookup:item.modifier", function() {
                    return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "modifier"));
                  }) ];
                }), Blaze.If(function() {
                  return Spacebars.call(view.lookup("hasAction"));
                }, function() {
                  return " js-action";
                }) ];
              },
              "data-type": function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "type"));
              },
              "data-id": function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "id", "toLowerCase"));
              },
              "data-href": function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "href"));
              },
              "data-sidenav": function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "sideNav"));
              }
            }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(Spacebars.dot(view.lookup("item"), "icon"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
                class: "rc-popover__icon"
              }, "\n\t\t\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
                return {
                  block: Spacebars.call("rc-popover__icon-element"),
                  icon: Spacebars.call(Spacebars.dot(view.lookup("item"), "icon"))
                };
              }, function() {
                return Spacebars.include(view.lookupTemplate("icon"));
              }), "\n\t\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(Spacebars.dot(view.lookup("item"), "name"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
                class: "rc-popover__item-text"
              }, Blaze.View("lookup:item.name", function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "name"));
              })), "\n\t\t\t\t\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(Spacebars.dot(view.lookup("item"), "select"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
                class: "rc-popover__input"
              }, "\n\t\t\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
                return {
                  title: Spacebars.call(Spacebars.dot(view.lookup("item"), "selectTitle")),
                  name: Spacebars.call(Spacebars.dot(view.lookup("item"), "selectName")),
                  options: Spacebars.call(Spacebars.dot(view.lookup("item"), "selectOptions"))
                };
              }, function() {
                return Spacebars.include(view.lookupTemplate("selectDropdown"));
              }), "\n\t\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t\t"), HTML.Raw('\n\t\t\t\t\t\t\t<span class="rc-popover__divider"></span>\n\t\t\t\t\t\t') ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"AccountBox.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/AccountBox.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AccountBox: () => AccountBox
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 3);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 4);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 5);
let appLayout;
module.link("../../../../client/lib/appLayout", {
  appLayout(v) {
    appLayout = v;
  }

}, 6);
let SideNav;
module.link("./SideNav", {
  SideNav(v) {
    SideNav = v;
  }

}, 7);

const AccountBox = function () {
  let status = 0;
  const items = new ReactiveVar([]);

  function setStatus(status, statusText) {
    return Meteor.call('setUserStatus', status, statusText);
  }

  function open() {
    if (SideNav.flexStatus()) {
      SideNav.closeFlex();
      return;
    }

    status = 1;
  }

  function close() {
    status = 0;
  }

  function toggle() {
    if (status) {
      return close();
    }

    return open();
  }

  function openFlex() {
    status = 0;
  }
  /*
   * @param newOption:
   *   name: Button label
   *   icon: Button icon
   *   class: Class of the item
   *   permissions: Which permissions a user should have (all of them) to see this item
   */


  function addItem(newItem) {
    return Tracker.nonreactive(function () {
      const actual = items.get();
      actual.push(newItem);
      return items.set(actual);
    });
  }

  function checkCondition(item) {
    return item.condition == null || item.condition();
  }

  function getItems() {
    return _.filter(items.get(), function (item) {
      if (checkCondition(item)) {
        return true;
      }
    });
  }

  function addRoute(newRoute, router) {
    let wait = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : () => {};

    if (router == null) {
      router = FlowRouter;
    }

    const container = newRoute.customContainer ? 'pageCustomContainer' : 'pageContainer';
    const routeConfig = {
      center: container,
      pageTemplate: newRoute.pageTemplate
    };

    if (newRoute.i18nPageTitle != null) {
      routeConfig.i18nPageTitle = newRoute.i18nPageTitle;
    }

    if (newRoute.pageTitle != null) {
      routeConfig.pageTitle = newRoute.pageTitle;
    }

    return router.route(newRoute.path, {
      name: newRoute.name,

      async action() {
        await wait();
        Session.set('openedRoom');
        appLayout.renderMainLayout(routeConfig);
      },

      triggersEnter: [function () {
        if (newRoute.sideNav != null) {
          SideNav.setFlex(newRoute.sideNav);
          SideNav.openFlex();
        }
      }]
    });
  }

  return {
    setStatus,
    toggle,
    open,
    close,
    openFlex,
    addRoute,
    addItem,
    getItems
  };
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"IframeLogin.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/IframeLogin.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  IframeLogin: () => IframeLogin,
  iframeLogin: () => iframeLogin
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Match;
module.link("meteor/check", {
  Match(v) {
    Match = v;
  }

}, 1);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 2);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 3);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 4);
let HTTP;
module.link("meteor/http", {
  HTTP(v) {
    HTTP = v;
  }

}, 5);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 6);

class IframeLogin {
  constructor() {
    this.enabled = false;
    this.reactiveIframeUrl = new ReactiveVar();
    this.reactiveEnabled = new ReactiveVar();
    this.iframeUrl = undefined;
    this.apiUrl = undefined;
    this.apiMethod = undefined;
    Tracker.autorun(c => {
      this.enabled = settings.get('Accounts_iframe_enabled');
      this.reactiveEnabled.set(this.enabled);
      this.iframeUrl = settings.get('Accounts_iframe_url');
      this.apiUrl = settings.get('Accounts_Iframe_api_url');
      this.apiMethod = settings.get('Accounts_Iframe_api_method');

      if (this.enabled === false) {
        return c.stop();
      }

      if (this.enabled === true && this.iframeUrl && this.apiUrl && this.apiMethod) {
        c.stop();

        if (!Accounts._storedLoginToken()) {
          this.tryLogin(() => {});
        }
      }
    });
  }

  tryLogin(callback) {
    if (!this.enabled) {
      return;
    }

    if (!this.iframeUrl || !this.apiUrl || !this.apiMethod) {
      return;
    }

    console.log('tryLogin');
    const options = {
      beforeSend: xhr => {
        xhr.withCredentials = true;
      }
    };
    let {
      iframeUrl
    } = this;
    let separator = '?';

    if (iframeUrl.indexOf('?') > -1) {
      separator = '&';
    }

    if (navigator.userAgent.indexOf('Electron') > -1) {
      iframeUrl += "".concat(separator, "client=electron");
    }

    HTTP.call(this.apiMethod, this.apiUrl, options, (error, result) => {
      console.log(error, result);

      if (result && result.data && (result.data.token || result.data.loginToken)) {
        this.loginWithToken(result.data, (error, result) => {
          if (error) {
            this.reactiveIframeUrl.set(iframeUrl);
          } else {
            this.reactiveIframeUrl.set();
          }

          callback(error, result);
        });
      } else {
        this.reactiveIframeUrl.set(iframeUrl);
        callback(error, result);
      }
    });
  }

  loginWithToken(tokenData, callback) {
    if (!this.enabled) {
      return;
    }

    if (Match.test(tokenData, String)) {
      tokenData = {
        token: tokenData
      };
    }

    console.log('loginWithToken');

    if (tokenData.loginToken) {
      return Meteor.loginWithToken(tokenData.loginToken, callback);
    }

    Accounts.callLoginMethod({
      methodArguments: [{
        iframe: true,
        token: tokenData.token
      }],
      userCallback: callback
    });
  }

}

const iframeLogin = new IframeLogin();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"MessageAction.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/MessageAction.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  addMessageToList: () => addMessageToList,
  MessageAction: () => MessageAction
});

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 1);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 2);
let mem;
module.link("mem", {
  default(v) {
    mem = v;
  }

}, 3);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 4);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 5);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 6);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 7);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 8);
let messageArgs;
module.link("./messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 9);
let roomTypes;
module.link("../../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 10);
let Messages, Rooms, Subscriptions;
module.link("../../../models/client", {
  Messages(v) {
    Messages = v;
  },

  Rooms(v) {
    Rooms = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 11);
let hasAtLeastOnePermission, hasPermission;
module.link("../../../authorization/client", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  },

  hasPermission(v) {
    hasPermission = v;
  }

}, 12);
let modal;
module.link("./modal", {
  modal(v) {
    modal = v;
  }

}, 13);
let imperativeModal;
module.link("../../../../client/lib/imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 14);
let ReactionList;
module.link("../../../../client/views/room/modals/ReactionListModal", {
  default(v) {
    ReactionList = v;
  }

}, 15);
let call;
module.link("../../../../client/lib/utils/call", {
  call(v) {
    call = v;
  }

}, 16);
let canDeleteMessage;
module.link("../../../../client/lib/utils/canDeleteMessage", {
  canDeleteMessage(v) {
    canDeleteMessage = v;
  }

}, 17);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 18);

const addMessageToList = (messagesList, message) => {
  // checks if the message is not already on the list
  if (!messagesList.find(_ref => {
    let {
      _id
    } = _ref;
    return _id === message._id;
  })) {
    messagesList.push(message);
  }

  return messagesList;
};

const MessageAction = new class {
  /*
   	config expects the following keys (only id is mandatory):
   		id (mandatory)
   		icon: string
   		label: string
   		action: function(event, instance)
   		condition: function(message)
  		order: integer
  		group: string (message or menu)
    */
  constructor() {
    this._getButtons = mem(function () {
      return _.sortBy(_.toArray(this.buttons.get()), 'order');
    });
    this._getButtonsByGroup = mem(function (group) {
      return this._getButtons().filter(button => Array.isArray(button.group) ? button.group.includes(group) : button.group === group);
    });
    this.buttons = new ReactiveVar({});
  }

  addButton(config) {
    if (!config || !config.id) {
      return false;
    }

    if (!config.group) {
      config.group = 'menu';
    }

    if (config.condition) {
      config.condition = mem(config.condition, {
        maxAge: 1000,
        cacheKey: JSON.stringify
      });
    }

    return Tracker.nonreactive(() => {
      const btns = this.buttons.get();
      btns[config.id] = config;
      mem.clear(this._getButtons);
      mem.clear(this._getButtonsByGroup);
      return this.buttons.set(btns);
    });
  }

  removeButton(id) {
    return Tracker.nonreactive(() => {
      const btns = this.buttons.get();
      delete btns[id];
      mem.clear(this._getButtons);
      mem.clear(this._getButtonsByGroup);
      return this.buttons.set(btns);
    });
  }

  updateButton(id, config) {
    return Tracker.nonreactive(() => {
      const btns = this.buttons.get();

      if (btns[id]) {
        btns[id] = _.extend(btns[id], config);
        mem.clear(this._getButtons);
        mem.clear(this._getButtonsByGroup);
        return this.buttons.set(btns);
      }
    });
  }

  getButtonById(id) {
    const allButtons = this.buttons.get();
    return allButtons[id];
  }

  getButtons(message, context, group) {
    const allButtons = group ? this._getButtonsByGroup(group) : this._getButtons();

    if (message) {
      return allButtons.filter(function (button) {
        if (button.context == null || button.context.includes(context)) {
          return button.condition == null || button.condition(message, context);
        }

        return false;
      });
    }

    return allButtons;
  }

  resetButtons() {
    mem.clear(this._getButtons);
    mem.clear(this._getButtonsByGroup);
    return this.buttons.set({});
  }

  async getPermaLink(msgId) {
    if (!msgId) {
      throw new Error('invalid-parameter');
    }

    const msg = Messages.findOne(msgId) || (await call('getSingleMessage', msgId));

    if (!msg) {
      throw new Error('message-not-found');
    }

    const roomData = Rooms.findOne({
      _id: msg.rid
    });

    if (!roomData) {
      throw new Error('room-not-found');
    }

    const subData = Subscriptions.findOne({
      'rid': roomData._id,
      'u._id': Meteor.userId()
    });
    const roomURL = roomTypes.getURL(roomData.t, subData || roomData);
    return "".concat(roomURL, "?msg=").concat(msgId);
  }

}();
Meteor.startup(async function () {
  const {
    chatMessages
  } = await module.dynamicImport('../../../ui');

  const getChatMessagesFrom = msg => {
    const {
      rid = Session.get('openedRoom'),
      tmid = msg._id
    } = msg;
    return chatMessages["".concat(rid, "-").concat(tmid)] || chatMessages[rid];
  };

  MessageAction.addButton({
    id: 'reply-directly',
    icon: 'reply-directly',
    label: 'Reply_in_direct_message',
    context: ['message', 'message-mobile', 'threads'],

    action() {
      const {
        msg
      } = messageArgs(this);
      roomTypes.openRouteLink('d', {
        name: msg.u.username
      }, _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), {}, {
        reply: msg._id
      }));
    },

    condition(_ref2) {
      let {
        subscription,
        room,
        msg,
        u
      } = _ref2;

      if (subscription == null) {
        return false;
      }

      if (room.t === 'd' || room.t === 'l') {
        return false;
      } // Check if we already have a DM started with the message user (not ourselves) or we can start one


      if (u._id !== msg.u._id && !hasPermission('create-d')) {
        const dmRoom = Rooms.findOne({
          _id: [u._id, msg.u._id].sort().join('')
        });

        if (!dmRoom || !Subscriptions.findOne({
          'rid': dmRoom._id,
          'u._id': u._id
        })) {
          return false;
        }
      }

      return true;
    },

    order: 0,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'quote-message',
    icon: 'quote',
    label: 'Quote',
    context: ['message', 'message-mobile', 'threads'],

    action() {
      const {
        msg: message
      } = messageArgs(this);
      const {
        input
      } = getChatMessagesFrom(message);
      const $input = $(input);
      let messages = $input.data('reply') || [];
      messages = addMessageToList(messages, message, input);
      $input.focus().data('mention-user', false).data('reply', messages).trigger('dataChange');
    },

    condition(_ref3) {
      let {
        subscription,
        room
      } = _ref3;

      if (subscription == null) {
        return false;
      }

      const isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return true;
    },

    order: -3,
    group: ['message', 'menu']
  });
  MessageAction.addButton({
    id: 'permalink',
    icon: 'permalink',
    label: 'Get_link',
    classes: 'clipboard',
    context: ['message', 'message-mobile', 'threads'],

    async action() {
      const {
        msg: message
      } = messageArgs(this);
      const permalink = await MessageAction.getPermaLink(message._id);
      navigator.clipboard.writeText(permalink);
      dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Copied')
      });
    },

    condition(_ref4) {
      let {
        subscription
      } = _ref4;
      return !!subscription;
    },

    order: 4,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'copy',
    icon: 'copy',
    label: 'Copy',
    classes: 'clipboard',
    context: ['message', 'message-mobile', 'threads'],

    action() {
      const {
        msg: {
          msg
        }
      } = messageArgs(this);
      navigator.clipboard.writeText(msg);
      dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Copied')
      });
    },

    condition(_ref5) {
      let {
        subscription
      } = _ref5;
      return !!subscription;
    },

    order: 5,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'edit-message',
    icon: 'edit',
    label: 'Edit',
    context: ['message', 'message-mobile', 'threads'],

    action() {
      const {
        msg
      } = messageArgs(this);
      getChatMessagesFrom(msg).edit(document.getElementById(msg.tmid ? "thread-".concat(msg._id) : msg._id));
    },

    condition(_ref6) {
      let {
        msg: message,
        subscription,
        settings
      } = _ref6;

      if (subscription == null) {
        return false;
      }

      const hasPermission = hasAtLeastOnePermission('edit-message', message.rid);
      const isEditAllowed = settings.Message_AllowEditing;
      const editOwn = message.u && message.u._id === Meteor.userId();

      if (!(hasPermission || isEditAllowed && editOwn)) {
        return;
      }

      const blockEditInMinutes = settings.Message_AllowEditing_BlockEditInMinutes;

      if (blockEditInMinutes) {
        let msgTs;

        if (message.ts != null) {
          msgTs = moment(message.ts);
        }

        let currentTsDiff;

        if (msgTs != null) {
          currentTsDiff = moment().diff(msgTs, 'minutes');
        }

        return currentTsDiff < blockEditInMinutes;
      }

      return true;
    },

    order: 6,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'delete-message',
    icon: 'trash',
    label: 'Delete',
    context: ['message', 'message-mobile', 'threads'],
    color: 'alert',

    action() {
      const {
        msg
      } = messageArgs(this);
      getChatMessagesFrom(msg).confirmDeleteMsg(msg);
    },

    condition(_ref7) {
      let {
        msg: message,
        subscription,
        room
      } = _ref7;

      if (!subscription) {
        return false;
      }

      const isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return canDeleteMessage({
        rid: message.rid,
        ts: message.ts,
        uid: message.u._id
      });
    },

    order: 18,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'report-message',
    icon: 'report',
    label: 'Report',
    context: ['message', 'message-mobile', 'threads'],
    color: 'alert',

    action() {
      const {
        msg: message
      } = messageArgs(this);
      modal.open({
        title: TAPi18n.__('Report_this_message_question_mark'),
        text: message.msg,
        inputPlaceholder: TAPi18n.__('Why_do_you_want_to_report_question_mark'),
        type: 'input',
        showCancelButton: true,
        confirmButtonColor: '#DD6B55',
        confirmButtonText: TAPi18n.__('Report_exclamation_mark'),
        cancelButtonText: TAPi18n.__('Cancel'),
        closeOnConfirm: false,
        html: false
      }, inputValue => {
        if (inputValue === false) {
          return false;
        }

        if (!inputValue.trim()) {
          modal.showInputError(TAPi18n.__('You_need_to_write_something'));
          return false;
        }

        Meteor.call('reportMessage', message._id, inputValue);
        modal.open({
          title: TAPi18n.__('Report_sent'),
          text: TAPi18n.__('Thank_you_exclamation_mark'),
          type: 'success',
          timer: 1000,
          showConfirmButton: false
        });
      });
    },

    condition(_ref8) {
      let {
        subscription,
        room
      } = _ref8;
      const isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return Boolean(subscription);
    },

    order: 17,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'reaction-list',
    icon: 'emoji',
    label: 'Reactions',
    context: ['message', 'message-mobile', 'threads'],

    action(_, _ref9) {
      let {
        tabBar,
        rid
      } = _ref9;
      const {
        msg: {
          reactions
        }
      } = messageArgs(this);
      imperativeModal.open({
        component: ReactionList,
        props: {
          reactions,
          rid,
          tabBar,
          onClose: imperativeModal.close
        }
      });
    },

    condition(_ref10) {
      let {
        msg: {
          reactions
        }
      } = _ref10;
      return !!reactions;
    },

    order: 18,
    group: 'menu'
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomHistoryManager.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/RoomHistoryManager.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["_id"];

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 0);

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 1);
module.export({
  normalizeThreadMessage: () => normalizeThreadMessage,
  waitUntilWrapperExists: () => waitUntilWrapperExists,
  upsertMessage: () => upsertMessage,
  upsertMessageBulk: () => upsertMessageBulk,
  RoomHistoryManager: () => RoomHistoryManager
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 3);
let uuidv4;
module.link("uuid", {
  v4(v) {
    uuidv4 = v;
  }

}, 4);
let differenceInMilliseconds;
module.link("date-fns/differenceInMilliseconds", {
  default(v) {
    differenceInMilliseconds = v;
  }

}, 5);
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 6);
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 7);
let RoomManager;
module.link("./RoomManager", {
  RoomManager(v) {
    RoomManager = v;
  }

}, 8);
let readMessage;
module.link("./readMessages", {
  readMessage(v) {
    readMessage = v;
  }

}, 9);
let renderMessageBody;
module.link("../../../../client/lib/utils/renderMessageBody", {
  renderMessageBody(v) {
    renderMessageBody = v;
  }

}, 10);
let getConfig;
module.link("../../../../client/lib/utils/getConfig", {
  getConfig(v) {
    getConfig = v;
  }

}, 11);
let ChatMessage, ChatSubscription, ChatRoom;
module.link("../../../models", {
  ChatMessage(v) {
    ChatMessage = v;
  },

  ChatSubscription(v) {
    ChatSubscription = v;
  },

  ChatRoom(v) {
    ChatRoom = v;
  }

}, 12);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 13);
let filterMarkdown;
module.link("../../../markdown/lib/markdown", {
  filterMarkdown(v) {
    filterMarkdown = v;
  }

}, 14);
let getUserPreference;
module.link("../../../utils/client", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 15);
let onClientMessageReceived;
module.link("../../../../client/lib/onClientMessageReceived", {
  onClientMessageReceived(v) {
    onClientMessageReceived = v;
  }

}, 16);

const normalizeThreadMessage = _ref => {
  let message = _extends({}, _ref);

  if (message.msg) {
    message.msg = filterMarkdown(message.msg);
    delete message.mentions;
    return renderMessageBody(message).replace(/<br\s?\\?>/g, ' ');
  }

  if (message.attachments) {
    const attachment = message.attachments.find(attachment => attachment.title || attachment.description);

    if (attachment && attachment.description) {
      return escapeHTML(attachment.description);
    }

    if (attachment && attachment.title) {
      return escapeHTML(attachment.title);
    }
  }
};

const waitUntilWrapperExists = async function () {
  let selector = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '.messages-box .wrapper';
  return document.querySelector(selector) || new Promise(resolve => {
    const observer = new MutationObserver(function (mutations, obs) {
      const element = document.querySelector(selector);

      if (element) {
        obs.disconnect(); // stop observing

        return resolve(element);
      }
    });
    observer.observe(document, {
      childList: true,
      subtree: true
    });
  });
};

const upsertMessage = async function (_ref2) {
  let {
    msg,
    subscription,
    uid = Tracker.nonreactive(() => Meteor.userId())
  } = _ref2;
  let collection = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ChatMessage;
  const userId = msg.u && msg.u._id;

  if (subscription && subscription.ignored && subscription.ignored.indexOf(userId) > -1) {
    msg.ignored = true;
  } // const roles = [
  // 	(userId && UserRoles.findOne(userId, { fields: { roles: 1 } })) || {},
  // 	(userId && RoomRoles.findOne({ rid: msg.rid, 'u._id': userId })) || {},
  // ].map((e) => e.roles);
  // msg.roles = _.union.apply(_.union, roles);


  if (msg.t === 'e2e' && !msg.file) {
    msg.e2e = 'pending';
  }

  msg = (await onClientMessageReceived(msg)) || msg;

  const {
    _id
  } = msg,
        messageToUpsert = _objectWithoutProperties(msg, _excluded);

  if (msg.tcount) {
    collection.direct.update({
      tmid: _id
    }, {
      $set: {
        following: msg.replies && msg.replies.indexOf(uid) > -1,
        threadMsg: normalizeThreadMessage(messageToUpsert),
        repliesCount: msg.tcount
      }
    }, {
      multi: true
    });
  }

  return collection.direct.upsert({
    _id
  }, messageToUpsert);
};

function upsertMessageBulk(_ref3) {
  let {
    msgs,
    subscription
  } = _ref3;
  let collection = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ChatMessage;
  const uid = Tracker.nonreactive(() => Meteor.userId());
  const {
    queries
  } = ChatMessage;
  collection.queries = [];
  msgs.forEach((msg, index) => {
    if (index === msgs.length - 1) {
      ChatMessage.queries = queries;
    }

    upsertMessage({
      msg,
      subscription,
      uid
    }, collection);
  });
}

const defaultLimit = parseInt(getConfig('roomListLimit')) || 50;

const waitAfterFlush = fn => setTimeout(() => Tracker.afterFlush(fn), 10);

const RoomHistoryManager = new class extends Emitter {
  constructor() {
    super();
    this.histories = {};
    this.requestsList = [];
  }

  getRoom(rid) {
    if (!this.histories[rid]) {
      this.histories[rid] = {
        hasMore: new ReactiveVar(true),
        hasMoreNext: new ReactiveVar(false),
        isLoading: new ReactiveVar(false),
        unreadNotLoaded: new ReactiveVar(0),
        firstUnread: new ReactiveVar(),
        loaded: undefined
      };
    }

    return this.histories[rid];
  }

  async queue() {
    return new Promise(resolve => {
      const requestId = uuidv4();

      const done = () => {
        this.lastRequest = new Date();
        resolve();
      };

      if (this.requestsList.length === 0) {
        return this.run(done);
      }

      this.requestsList.push(requestId);
      this.once(requestId, done);
    });
  }

  run(fn) {
    const difference = differenceInMilliseconds(new Date(), this.lastRequest);

    if (!this.lastRequest || difference > 500) {
      return fn();
    }

    return setTimeout(fn, 500 - difference);
  }

  unqueue() {
    const requestId = this.requestsList.pop();

    if (!requestId) {
      return;
    }

    this.run(() => this.emit(requestId));
  }

  async getMore(rid) {
    let limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultLimit;
    let ts;
    const room = this.getRoom(rid);

    if (room.hasMore.curValue !== true) {
      return;
    }

    room.isLoading.set(true);
    await this.queue(); // ScrollListener.setLoader true

    const lastMessage = ChatMessage.findOne({
      rid,
      _hidden: {
        $ne: true
      }
    }, {
      sort: {
        ts: 1
      }
    }); // lastMessage ?= ChatMessage.findOne({rid: rid}, {sort: {ts: 1}})

    if (lastMessage) {
      ({
        ts
      } = lastMessage);
    } else {
      ts = undefined;
    }

    let ls = undefined;
    let typeName = undefined;
    const subscription = ChatSubscription.findOne({
      rid
    });

    if (subscription) {
      ({
        ls
      } = subscription);
      typeName = subscription.t + subscription.name;
    } else {
      const curRoomDoc = ChatRoom.findOne({
        _id: rid
      });
      typeName = (curRoomDoc ? curRoomDoc.t : undefined) + (curRoomDoc ? curRoomDoc.name : undefined);
    }

    const showMessageInMainThread = getUserPreference(Meteor.userId(), 'showMessageInMainThread', false);
    const result = await callWithErrorHandling('loadHistory', rid, ts, limit, ls, showMessageInMainThread);
    this.unqueue();
    let previousHeight;
    let scroll;
    const {
      messages = []
    } = result;
    room.unreadNotLoaded.set(result.unreadNotLoaded);
    room.firstUnread.set(result.firstUnread);
    const wrapper = await waitUntilWrapperExists();

    if (wrapper) {
      previousHeight = wrapper.scrollHeight;
      scroll = wrapper.scrollTop;
    }

    upsertMessageBulk({
      msgs: messages.filter(msg => msg.t !== 'command'),
      subscription
    });

    if (!room.loaded) {
      room.loaded = 0;
    }

    const visibleMessages = messages.filter(msg => !msg.tmid || showMessageInMainThread || msg.tshow);
    room.loaded += visibleMessages.length;

    if (messages.length < limit) {
      room.hasMore.set(false);
    }

    if (room.hasMore.get() && (visibleMessages.length === 0 || room.loaded < limit)) {
      return this.getMore(rid);
    }

    waitAfterFlush(() => {
      const heightDiff = wrapper.scrollHeight - previousHeight;
      wrapper.scrollTop = scroll + heightDiff;
    });
    room.isLoading.set(false);
    waitAfterFlush(() => {
      readMessage.refreshUnreadMark(rid);
      return RoomManager.updateMentionsMarksOfRoom(typeName);
    });
  }

  async getMoreNext(rid) {
    let limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultLimit;
    const room = this.getRoom(rid);

    if (room.hasMoreNext.curValue !== true) {
      return;
    }

    await this.queue();
    const instance = Blaze.getView($('.messages-box .wrapper')[0]).templateInstance();
    instance.atBottom = false;
    room.isLoading.set(true);
    const lastMessage = ChatMessage.findOne({
      rid,
      _hidden: {
        $ne: true
      }
    }, {
      sort: {
        ts: -1
      }
    });
    let typeName = undefined;
    const subscription = ChatSubscription.findOne({
      rid
    });

    if (subscription) {
      // const { ls } = subscription;
      typeName = subscription.t + subscription.name;
    } else {
      const curRoomDoc = ChatRoom.findOne({
        _id: rid
      });
      typeName = (curRoomDoc ? curRoomDoc.t : undefined) + (curRoomDoc ? curRoomDoc.name : undefined);
    }

    const {
      ts
    } = lastMessage;

    if (ts) {
      const result = await callWithErrorHandling('loadNextMessages', rid, ts, limit);
      upsertMessageBulk({
        msgs: Array.from(result.messages).filter(msg => msg.t !== 'command'),
        subscription
      });
      Meteor.defer(() => RoomManager.updateMentionsMarksOfRoom(typeName));
      room.isLoading.set(false);

      if (!room.loaded) {
        room.loaded = 0;
      }

      room.loaded += result.messages.length;

      if (result.messages.length < limit) {
        room.hasMoreNext.set(false);
      }
    }

    await this.unqueue();
  }

  async getSurroundingMessages(message) {
    let limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultLimit;

    if (!message || !message.rid) {
      return;
    }

    const w = await waitUntilWrapperExists();
    const instance = Blaze.getView(w).templateInstance();

    if (ChatMessage.findOne({
      _id: message._id,
      _hidden: {
        $ne: true
      }
    })) {
      const msgElement = $("#".concat(message._id), w);

      if (msgElement.length === 0) {
        return;
      }

      const wrapper = $('.messages-box .wrapper');
      const pos = wrapper.scrollTop() + msgElement.offset().top - wrapper.height() / 2;
      wrapper.animate({
        scrollTop: pos
      }, 500);
      return setTimeout(() => msgElement.removeClass('highlight'), 500);
    }

    const room = this.getRoom(message.rid);
    room.isLoading.set(true);
    let typeName = undefined;
    const subscription = ChatSubscription.findOne({
      rid: message.rid
    });

    if (subscription) {
      // const { ls } = subscription;
      typeName = subscription.t + subscription.name;
    } else {
      const curRoomDoc = ChatRoom.findOne({
        _id: message.rid
      });
      typeName = (curRoomDoc ? curRoomDoc.t : undefined) + (curRoomDoc ? curRoomDoc.name : undefined);
    }

    return Meteor.call('loadSurroundingMessages', message, limit, function (err, result) {
      if (!result || !result.messages) {
        return;
      }

      ChatMessage.remove({
        rid: message.rid
      });

      for (const msg of Array.from(result.messages)) {
        if (msg.t !== 'command') {
          upsertMessage({
            msg,
            subscription
          });
        }
      }

      readMessage.refreshUnreadMark(message.rid);
      RoomManager.updateMentionsMarksOfRoom(typeName);
      Tracker.afterFlush(() => {
        const wrapper = $('.messages-box .wrapper');
        const msgElement = $("#".concat(message._id), wrapper);
        const pos = wrapper.scrollTop() + msgElement.offset().top - wrapper.height() / 2;
        wrapper.animate({
          scrollTop: pos
        }, 500);
        msgElement.addClass('highlight');
        room.isLoading.set(false);
        const messages = wrapper[0];
        instance.atBottom = !result.moreAfter && messages.scrollTop >= messages.scrollHeight - messages.clientHeight;
        setTimeout(() => msgElement.removeClass('highlight'), 500);
      });

      if (!room.loaded) {
        room.loaded = 0;
      }

      room.loaded += result.messages.length;
      room.hasMore.set(result.moreBefore);
      return room.hasMoreNext.set(result.moreAfter);
    });
  }

  hasMore(rid) {
    const room = this.getRoom(rid);
    return room.hasMore.get();
  }

  hasMoreNext(rid) {
    const room = this.getRoom(rid);
    return room.hasMoreNext.get();
  }

  getMoreIfIsEmpty(rid) {
    const room = this.getRoom(rid);

    if (room.loaded === undefined) {
      return this.getMore(rid);
    }
  }

  isLoading(rid) {
    const room = this.getRoom(rid);
    return room.isLoading.get();
  }

  clear(rid) {
    ChatMessage.remove({
      rid
    });

    if (this.histories[rid]) {
      this.histories[rid].hasMore.set(true);
      this.histories[rid].isLoading.set(false);
      this.histories[rid].loaded = undefined;
    }
  }

}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomManager.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/RoomManager.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RoomManager: () => RoomManager
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 4);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 5);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 6);
let fireGlobalEvent;
module.link("../../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 7);
let upsertMessage, RoomHistoryManager;
module.link("./RoomHistoryManager", {
  upsertMessage(v) {
    upsertMessage = v;
  },

  RoomHistoryManager(v) {
    RoomHistoryManager = v;
  }

}, 8);
let mainReady;
module.link("./mainReady", {
  mainReady(v) {
    mainReady = v;
  }

}, 9);
let menu;
module.link("./menu", {
  menu(v) {
    menu = v;
  }

}, 10);
let roomTypes;
module.link("../../../utils", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 11);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 12);
let Notifications;
module.link("../../../notifications", {
  Notifications(v) {
    Notifications = v;
  }

}, 13);
let CachedChatRoom, ChatMessage, ChatSubscription, CachedChatSubscription, ChatRoom;
module.link("../../../models", {
  CachedChatRoom(v) {
    CachedChatRoom = v;
  },

  ChatMessage(v) {
    ChatMessage = v;
  },

  ChatSubscription(v) {
    ChatSubscription = v;
  },

  CachedChatSubscription(v) {
    CachedChatSubscription = v;
  },

  ChatRoom(v) {
    ChatRoom = v;
  }

}, 14);
let CachedCollectionManager;
module.link("../../../ui-cached-collection", {
  CachedCollectionManager(v) {
    CachedCollectionManager = v;
  }

}, 15);
let getConfig;
module.link("../../../../client/lib/utils/getConfig", {
  getConfig(v) {
    getConfig = v;
  }

}, 16);
let ROOM_DATA_STREAM;
module.link("../../../utils/stream/constants", {
  ROOM_DATA_STREAM(v) {
    ROOM_DATA_STREAM = v;
  }

}, 17);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 18);
let NewRoomManager;
module.link("../../../../client/lib/RoomManager", {
  RoomManager(v) {
    NewRoomManager = v;
  }

}, 19);
const maxRoomsOpen = parseInt(getConfig('maxRoomsOpen')) || 5;

const onDeleteMessageStream = msg => {
  ChatMessage.remove({
    _id: msg._id
  }); // remove thread refenrece from deleted message

  ChatMessage.update({
    tmid: msg._id
  }, {
    $unset: {
      tmid: 1
    }
  }, {
    multi: true
  });
};

const onDeleteMessageBulkStream = _ref => {
  let {
    rid,
    ts,
    excludePinned,
    ignoreDiscussion,
    users
  } = _ref;
  const query = {
    rid,
    ts
  };

  if (excludePinned) {
    query.pinned = {
      $ne: true
    };
  }

  if (ignoreDiscussion) {
    query.drid = {
      $exists: false
    };
  }

  if (users && users.length) {
    query['u.username'] = {
      $in: users
    };
  }

  ChatMessage.remove(query);
};

const RoomManager = new function () {
  const openedRooms = {};
  const msgStream = new Meteor.Streamer('room-messages');
  const roomStream = new Meteor.Streamer(ROOM_DATA_STREAM);
  const onlineUsers = new ReactiveVar({});
  const Dep = new Tracker.Dependency();

  const handleTrackSettingsChange = msg => {
    const openedRoom = Tracker.nonreactive(() => Session.get('openedRoom'));

    if (openedRoom !== msg.rid) {
      return;
    }

    Tracker.nonreactive(() => {
      if (msg.t === 'room_changed_privacy') {
        const type = FlowRouter.current().route.name === 'channel' ? 'c' : 'p';
        RoomManager.close(type + FlowRouter.getParam('name'));
        const subscription = ChatSubscription.findOne({
          rid: msg.rid
        });
        const route = subscription.t === 'c' ? 'channel' : 'group';
        FlowRouter.go(route, {
          name: subscription.name
        }, FlowRouter.current().queryParams);
      }

      if (msg.t === 'r') {
        const room = ChatRoom.findOne(msg.rid);

        if (room.name !== FlowRouter.getParam('name')) {
          RoomManager.close(room.t + FlowRouter.getParam('name'));
          roomTypes.openRouteLink(room.t, room, FlowRouter.current().queryParams);
        }
      }
    });
  };

  const Cls = class {
    static initClass() {
      this.prototype.openedRooms = openedRooms;
      this.prototype.onlineUsers = onlineUsers;
      this.prototype.roomStream = roomStream;
      this.prototype.computation = Tracker.autorun(() => {
        const ready = CachedChatRoom.ready.get() && mainReady.get();

        if (ready !== true) {
          return;
        }

        const user = Meteor.user();
        Tracker.nonreactive(() => Object.entries(openedRooms).forEach(_ref2 => {
          let [typeName, record] = _ref2;

          if (record.active !== true || record.ready === true) {
            return;
          }

          const type = typeName.substr(0, 1);
          const name = typeName.substr(1);
          const room = roomTypes.findRoom(type, name, user);

          if (room != null) {
            record.rid = room._id;
            RoomHistoryManager.getMoreIfIsEmpty(room._id);

            if (record.streamActive !== true) {
              record.streamActive = true;
              msgStream.on(record.rid, async msg => {
                // Should not send message to room if room has not loaded all the current messages
                if (RoomHistoryManager.hasMoreNext(record.rid) !== false) {
                  return;
                } // Do not load command messages into channel


                if (msg.t !== 'command') {
                  const subscription = ChatSubscription.findOne({
                    rid: record.rid
                  }, {
                    reactive: false
                  });
                  const isNew = !ChatMessage.findOne({
                    _id: msg._id,
                    temp: {
                      $ne: true
                    }
                  });
                  upsertMessage({
                    msg,
                    subscription
                  });
                  msg.room = {
                    type,
                    name
                  };

                  if (isNew) {
                    menu.updateUnreadBars();
                    callbacks.run('streamNewMessage', msg);
                  }
                }

                msg.name = room.name;
                Tracker.afterFlush(() => RoomManager.updateMentionsMarksOfRoom(typeName));
                handleTrackSettingsChange(msg);
                callbacks.run('streamMessage', msg);
                return fireGlobalEvent('new-message', msg);
              });
              Notifications.onRoom(record.rid, 'deleteMessage', onDeleteMessageStream); // eslint-disable-line no-use-before-define

              Notifications.onRoom(record.rid, 'deleteMessageBulk', onDeleteMessageBulkStream); // eslint-disable-line no-use-before-define
            }
          }

          record.ready = true;
        }));
        Dep.changed();
      });
    }

    getOpenedRoomByRid(rid) {
      return Object.keys(openedRooms).map(typeName => openedRooms[typeName]).find(openedRoom => openedRoom.rid === rid);
    }

    close(typeName) {
      if (openedRooms[typeName]) {
        if (openedRooms[typeName].rid != null) {
          msgStream.removeAllListeners(openedRooms[typeName].rid);
          Notifications.unRoom(openedRooms[typeName].rid, 'deleteMessage', onDeleteMessageStream); // eslint-disable-line no-use-before-define

          Notifications.unRoom(openedRooms[typeName].rid, 'deleteMessageBulk', onDeleteMessageBulkStream); // eslint-disable-line no-use-before-define
        }

        openedRooms[typeName].ready = false;
        openedRooms[typeName].active = false;

        if (openedRooms[typeName].template != null) {
          try {
            Blaze.remove(openedRooms[typeName].template);
          } catch (e) {
            console.error('Error removing template from DOM', e);
          }
        }

        delete openedRooms[typeName].dom;
        delete openedRooms[typeName].template;
        const {
          rid
        } = openedRooms[typeName];
        delete openedRooms[typeName];

        if (rid != null) {
          NewRoomManager.close(rid);
          return RoomHistoryManager.clear(rid);
        }
      }
    }

    closeOlderRooms() {
      if (Object.keys(openedRooms).length <= maxRoomsOpen) {
        return;
      }

      const roomsToClose = _.sortBy(_.values(openedRooms), 'lastSeen').reverse().slice(maxRoomsOpen);

      return Array.from(roomsToClose).map(roomToClose => this.close(roomToClose.typeName));
    }

    closeAllRooms() {
      Object.keys(openedRooms).forEach(key => {
        const openedRoom = openedRooms[key];
        this.close(openedRoom.typeName);
      });
      Session.set('openedRoom');
    }

    open(typeName) {
      if (openedRooms[typeName] == null) {
        openedRooms[typeName] = {
          typeName,
          active: false,
          ready: false,
          unreadSince: new ReactiveVar(undefined)
        };
      }

      openedRooms[typeName].lastSeen = new Date();

      if (openedRooms[typeName].ready) {
        this.closeOlderRooms();
      }

      if (CachedChatSubscription.ready.get() === true) {
        if (openedRooms[typeName].active !== true) {
          openedRooms[typeName].active = true;

          if (this.computation) {
            this.computation.invalidate();
          }
        }
      }

      return {
        ready() {
          Dep.depend();
          return openedRooms[typeName].ready;
        }

      };
    }

    existsDomOfRoom(typeName) {
      const room = openedRooms[typeName];
      return (room != null ? room.dom : undefined) != null;
    }

    updateUserStatus(user, status, utcOffset) {
      const onlineUsersValue = onlineUsers.curValue;

      if (status === 'offline') {
        delete onlineUsersValue[user.username];
      } else {
        onlineUsersValue[user.username] = {
          _id: user._id,
          status,
          utcOffset
        };
      }

      return onlineUsers.set(onlineUsersValue);
    }

    updateMentionsMarksOfRoom() {// const [ticksBar] = dom.getElementsByClassName('ticks-bar');
      // const [messagesBox] = dom.getElementsByClassName('messages-box');
      // const scrollTop = $('> .wrapper', messagesBox).scrollTop() - 50;
      // const totalHeight = $(' > .wrapper > ul', messagesBox).height() + 40;
      // if (!ticksBar) {
      // 	return;
      // }
      // // TODO: thread quotes should NOT have mention links at all
      // const mentionsSelector = '.message .body .mention-link--me, .message .body .mention-link--group';
      // ticksBar.innerHTML = Array.from(messagesBox?.querySelectorAll(mentionsSelector) || [])
      // 	.map((mentionLink) => {
      // 		const topOffset = $(mentionLink).offset().top + scrollTop;
      // 		const percent = (100 / totalHeight) * topOffset;
      // 		const className = [
      // 			'tick',
      // 			mentionLink.classList.contains('mention-link--me') && 'tick--me',
      // 			mentionLink.classList.contains('mention-link--group') && 'tick--group',
      // 		].filter(Boolean).join(' ');
      // 		return `<div class="${ className }" style="top: ${ percent }%;"></div>`;
      // 	})
      // 	.join('');
    }

  };
  Cls.initClass();
  return new Cls();
}();

const loadMissedMessages = async function (rid) {
  const lastMessage = ChatMessage.findOne({
    rid,
    _hidden: {
      $ne: true
    },
    temp: {
      $exists: false
    }
  }, {
    sort: {
      ts: -1
    },
    limit: 1
  });

  if (lastMessage == null) {
    return;
  }

  try {
    const result = await callWithErrorHandling('loadMissedMessages', rid, lastMessage.ts);

    if (result) {
      const subscription = ChatSubscription.findOne({
        rid
      });
      return Promise.all(Array.from(result).map(msg => upsertMessage({
        msg,
        subscription
      })));
    }

    return [];
  } catch (error) {
    return [];
  }
};

let connectionWasOnline = true;
Tracker.autorun(function () {
  const {
    connected
  } = Meteor.connection.status();

  if (connected === true && connectionWasOnline === false && RoomManager.openedRooms != null) {
    Object.keys(RoomManager.openedRooms).forEach(key => {
      const value = RoomManager.openedRooms[key];

      if (value.rid != null) {
        loadMissedMessages(value.rid);
      }
    });
  }

  connectionWasOnline = connected;
});
Meteor.startup(() => {
  // Reload rooms after login
  let currentUsername = undefined;
  Tracker.autorun(() => {
    const user = Meteor.user();

    if (currentUsername === undefined && (user != null ? user.username : undefined) != null) {
      currentUsername = user.username;
      RoomManager.closeAllRooms();
      const {
        roomTypes: types
      } = roomTypes; // Reload only if the current route is a channel route

      const roomType = Object.keys(types).find(key => types[key].route && types[key].route.name === FlowRouter.current().route.name);

      if (roomType) {
        FlowRouter.reload();
      }
    }
  });
  ChatMessage.find().observe({
    removed(record) {
      if (RoomManager.getOpenedRoomByRid(record.rid) != null) {
        const recordBefore = ChatMessage.findOne({
          ts: {
            $lt: record.ts
          }
        }, {
          sort: {
            ts: -1
          }
        });

        if (recordBefore != null) {
          ChatMessage.update({
            _id: recordBefore._id
          }, {
            $set: {
              tick: new Date()
            }
          });
        }

        const recordAfter = ChatMessage.findOne({
          ts: {
            $gt: record.ts
          }
        }, {
          sort: {
            ts: 1
          }
        });

        if (recordAfter != null) {
          return ChatMessage.update({
            _id: recordAfter._id
          }, {
            $set: {
              tick: new Date()
            }
          });
        }
      }
    }

  });
});
Tracker.autorun(function () {
  if (Meteor.userId()) {
    return Notifications.onUser('message', function (msg) {
      msg.u = msg.u || {
        username: 'rocket.cat'
      };
      msg.private = true;
      return ChatMessage.upsert({
        _id: msg._id
      }, msg);
    });
  }
});
callbacks.add('afterLogoutCleanUp', () => RoomManager.closeAllRooms(), callbacks.priority.MEDIUM, 'roommanager-after-logout-cleanup');
CachedCollectionManager.onLogin(() => {
  Notifications.onUser('subscriptions-changed', (action, sub) => {
    const ignored = sub && sub.ignored ? {
      $nin: sub.ignored
    } : {
      $exists: true
    };
    ChatMessage.update({
      rid: sub.rid,
      ignored
    }, {
      $unset: {
        ignored: true
      }
    }, {
      multi: true
    });

    if (sub && sub.ignored) {
      ChatMessage.update({
        'rid': sub.rid,
        't': {
          $ne: 'command'
        },
        'u._id': {
          $in: sub.ignored
        }
      }, {
        $set: {
          ignored: true
        }
      }, {
        multi: true
      });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"SideNav.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/SideNav.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  SideNav: () => SideNav
});
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let AccountBox;
module.link("./AccountBox", {
  AccountBox(v) {
    AccountBox = v;
  }

}, 2);
let roomTypes;
module.link("../../../utils/client/lib/roomTypes", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 3);
let Subscriptions;
module.link("../../../models", {
  Subscriptions(v) {
    Subscriptions = v;
  }

}, 4);
let RoomManager;
module.link("../../../../client/lib/RoomManager", {
  RoomManager(v) {
    RoomManager = v;
  }

}, 5);
const SideNav = new class {
  constructor() {
    this.initiated = false;
    this.sideNav = {};
    this.flexNav = {};
    this.animating = false;
    this.openQueue = [];
  }

  toggleFlex(status, callback) {
    if (this.animating === true) {
      return;
    }

    this.animating = true;

    if (status === -1 || status !== 1 && this.flexNav.opened) {
      this.flexNav.opened = false;
      this.flexNav.addClass('animated-hidden');
    } else {
      this.flexNav.opened = true;

      if (window.DISABLE_ANIMATION === true) {
        this.flexNav.removeClass('animated-hidden');
      } else {
        setTimeout(() => this.flexNav.removeClass('animated-hidden'), 50);
      }
    }

    if (window.DISABLE_ANIMATION === true) {
      !this.flexNav.opened && this.setFlex();
      this.animating = false;
      return typeof callback === 'function' && callback();
    }

    return setTimeout(() => {
      !this.flexNav.opened && this.setFlex();
      this.animating = false;
      return typeof callback === 'function' && callback();
    }, 500);
  }

  closeFlex() {
    let callback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
    const routesNamesForRooms = roomTypes.getTypes().filter(i => i.route).map(i => i.route.name);

    if (!routesNamesForRooms.includes(FlowRouter.current().route.name)) {
      const subscription = Subscriptions.findOne({
        rid: RoomManager.lastRid
      });

      if (subscription) {
        roomTypes.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);
      } else {
        FlowRouter.go('home');
      }
    }

    if (this.animating === true) {
      return;
    }

    this.toggleFlex(-1, callback);
  }

  flexStatus() {
    return this.flexNav.opened;
  }

  setFlex(template) {
    let data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    Session.set('flex-nav-template', template);
    return Session.set('flex-nav-data', data);
  }

  getFlex() {
    return {
      template: Session.get('flex-nav-template'),
      data: Session.get('flex-nav-data')
    };
  }

  toggleCurrent() {
    if (this.flexNav && this.flexNav.opened) {
      return this.closeFlex();
    }

    return AccountBox.toggle();
  }

  validate() {
    const invalid = [];
    this.sideNav.find('input.required').each(function () {
      if (!this.value.length) {
        return invalid.push($(this).prev('label').html());
      }
    });

    if (invalid.length) {
      return invalid;
    }

    return false;
  }

  openFlex() {
    let callback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : () => {};

    if (!this.initiated) {
      return this.openQueue.push({
        config: this.getFlex(),
        callback
      });
    }

    if (this.animating === true) {
      return;
    }

    this.toggleFlex(1, callback);
  }

  init() {
    this.sideNav = $('.sidebar');
    this.flexNav = this.sideNav.find('.flex-nav');
    this.setFlex('');
    this.initiated = true;

    if (this.openQueue.length > 0) {
      this.openQueue.forEach(item => {
        this.setFlex(item.config.template, item.config.data);
        return this.openFlex(item.callback);
      });
      this.openQueue = [];
    }
  }

}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"collapseArrow.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/collapseArrow.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createCollapseable: () => createCollapseable
});
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
module.link("./collapseArrow.html");

const createCollapseable = function (template) {
  let getInicialFromInstance = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => false;
  template.onCreated(function () {
    this.collapsedMedia = new ReactiveVar(getInicialFromInstance(Template.instance()));
  });
  template.helpers({
    collapsed() {
      return Template.instance().collapsedMedia.get();
    },

    collapsedMediaVar() {
      return Template.instance().collapsedMedia;
    }

  });
};

Template.collapseArrow.events({
  'click .collapse-switch'(e, i) {
    e.preventDefault();
    i.data.collapsedMedia.set(!i.data.collapsedMedia.get());
  }

});
Template.collapseArrow.helpers({
  collapsed() {
    return this.collapsedMedia.get();
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"mainReady.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/mainReady.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  mainReady: () => mainReady
});
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let mainReady = new ReactiveVar(false);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"menu.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/menu.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  menu: () => menu
});
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 3);
let isRtl;
module.link("../../../utils", {
  isRtl(v) {
    isRtl = v;
  }

}, 4);
const sideNavW = 280;

const map = (x, in_min, in_max, out_min, out_max) => (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;

const menu = new class extends Emitter {
  constructor() {
    super();
    this._open = false;
    this.updateUnreadBars = _.throttle(() => {
      if (this.list == null) {
        return;
      }

      const listOffset = this.list.offset();
      const listHeight = this.list.height();
      let showTop = false;
      let showBottom = false;
      $('li.sidebar-item--unread').each(function () {
        if ($(this).offset().top < listOffset.top - $(this).height()) {
          showTop = true;
        }

        if ($(this).offset().top > listOffset.top + listHeight) {
          showBottom = true;
        }
      });

      if (showTop === true) {
        $('.top-unread-rooms').removeClass('hidden');
      } else {
        $('.top-unread-rooms').addClass('hidden');
      }

      if (showBottom === true) {
        return $('.bottom-unread-rooms').removeClass('hidden');
      }

      return $('.bottom-unread-rooms').addClass('hidden');
    }, 200);
    this.sideNavW = sideNavW;
  }

  get isRtl() {
    return isRtl(Meteor._localStorage.getItem('userLanguage'));
  }

  touchstart(e) {
    this.movestarted = false;
    this.blockmove = false;
    this.touchstartX = undefined;
    this.touchstartY = undefined;
    this.diff = 0;

    if (e.target === this.sidebarWrap[0] || $(e.target).closest('.main-content').length > 0) {
      this.closePopover();
      this.touchstartX = e.touches[0].clientX;
      this.touchstartY = e.touches[0].clientY;
      this.mainContent = $('.main-content');
    }
  }

  touchmove(e) {
    if (this.touchstartX == null) {
      return;
    }

    const [touch] = e.touches;
    const diffX = touch.clientX - this.touchstartX;
    const diffY = touch.clientY - this.touchstartY;
    const absX = Math.abs(diffX);
    const absY = Math.abs(diffY);

    if (!this.movestarted && absY > 5) {
      this.blockmove = true;
    }

    if (this.blockmove) {
      return;
    }

    this.sidebar.css('transition', 'none');
    this.sidebarWrap.css('transition', 'none');

    if (this.movestarted === true || absX > 5) {
      this.movestarted = true;

      if (this.isRtl) {
        if (this.isOpen()) {
          this.diff = -sideNavW + diffX;
        } else {
          this.diff = diffX;
        }

        if (this.diff < -sideNavW) {
          this.diff = -sideNavW;
        }

        if (this.diff > 0) {
          this.diff = 0;
        }
      } else {
        if (this.isOpen()) {
          this.diff = sideNavW + diffX;
        } else {
          this.diff = diffX;
        }

        if (this.diff > sideNavW) {
          this.diff = sideNavW;
        }

        if (this.diff < 0) {
          this.diff = 0;
        }
      } // if (map((this.diff / sideNavW), 0, 1, -.1, .8) > 0) {


      this.sidebar.css('box-shadow', '0 0 15px 1px rgba(0,0,0,.3)'); // this.sidebarWrap.css('z-index', '9998');

      this.translate(this.diff); // }
    }
  }

  translate(diff) {
    let width = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : sideNavW;

    if (diff === undefined) {
      diff = this.isRtl ? -1 * sideNavW : sideNavW;
    }

    this.sidebarWrap.css('width', '100%');
    this.wrapper.css('overflow', 'hidden');
    this.sidebarWrap.css('background-color', '#000');
    this.sidebarWrap.css('opacity', map(Math.abs(diff) / width, 0, 1, -0.1, 0.8).toFixed(2));
    this.isRtl ? this.sidebar.css('transform', "translate3d(".concat((sideNavW + diff).toFixed(3), "px, 0 , 0)")) : this.sidebar.css('transform', "translate3d(".concat((diff - sideNavW).toFixed(3), "px, 0 , 0)"));
  }

  touchend() {
    const [max, min] = [sideNavW * 0.76, sideNavW * 0.24];

    if (this.movestarted !== true) {
      return;
    }

    this.movestarted = false;

    if (this.isRtl) {
      if (this.isOpen()) {
        return this.diff >= -max ? this.close() : this.open();
      }

      if (this.diff <= -min) {
        return this.open();
      }

      return this.close();
    }

    if (this.isOpen()) {
      if (this.diff >= max) {
        return this.open();
      }

      return this.close();
    }

    if (this.diff >= min) {
      return this.open();
    }

    return this.close();
  }

  init() {
    this.menu = $('.sidebar');
    this.sidebar = this.menu;
    this.sidebarWrap = $('.sidebar-wrap');
    this.wrapper = $('.messages-box > .wrapper');

    const ignore = fn => event => document.body.clientWidth <= 780 && fn(event);

    document.body.addEventListener('touchstart', ignore(e => this.touchstart(e)));
    document.body.addEventListener('touchmove', ignore(e => this.touchmove(e)));
    document.body.addEventListener('touchend', ignore(e => this.touchend(e)));
    this.sidebarWrap.on('click', ignore(e => {
      e.target === this.sidebarWrap[0] && this.isOpen() && this.emit('clickOut', e);
    }));
    this.on('close', () => {
      this.sidebarWrap.css('width', ''); // this.sidebarWrap.css('z-index', '');

      this.sidebarWrap.css('background-color', '');
      this.sidebar.css('transform', '');
      this.sidebar.css('box-shadow', '');
      this.sidebar.css('transition', '');
      this.sidebarWrap.css('transition', '');
      this.wrapper && this.wrapper.css('overflow', '');
    });
    this.on('open', ignore(() => {
      this.sidebar.css('box-shadow', '0 0 15px 1px rgba(0,0,0,.3)'); // this.sidebarWrap.css('z-index', '9998');

      this.translate();
    }));
    this.mainContent = $('.main-content');
    this.list = $('.rooms-list');
    this._open = false;
    Session.set('isMenuOpen', this._open);
  }

  closePopover() {
    return this.menu.find('[data-popover="anchor"]:checked').prop('checked', false).length > 0;
  }

  isOpen() {
    return Session.get('isMenuOpen');
  }

  open() {
    this._open = true;
    Session.set('isMenuOpen', this._open);
    this.emit('open');
  }

  close() {
    this._open = false;
    Session.set('isMenuOpen', this._open);
    this.emit('close');
  }

  toggle() {
    return this.isOpen() ? this.close() : this.open();
  }

}();
let passClosePopover = false;
menu.on('clickOut', function () {
  if (!menu.closePopover()) {
    passClosePopover = true;
    menu.close();
  }
});
menu.on('close', function () {
  if (!menu.sidebar) {
    return;
  }

  menu.sidebar.css('transition', '');
  menu.sidebarWrap.css('transition', '');

  if (passClosePopover) {
    passClosePopover = false;
    return;
  }

  menu.closePopover();
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageArgs.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/messageArgs.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  messageArgs: () => messageArgs
});

const messageArgs = context => context && context._arguments && context._arguments[1] && context._arguments[1].hash || context;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBox.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/messageBox.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  messageBox: () => messageBox
});

class MessageBoxActions {
  constructor() {
    this.actions = {};
  }

  add(group, label, config) {
    if (!group && !label && !config) {
      return;
    }

    if (!this.actions[group]) {
      this.actions[group] = [];
    }

    const actionExists = this.actions[group].find(action => action.label === label);

    if (actionExists) {
      return;
    }

    this.actions[group].push(_objectSpread(_objectSpread({}, config), {}, {
      label
    }));
  }

  remove(group, expression) {
    if (!group || !this.actions[group]) {
      return false;
    }

    this.actions[group] = this.actions[group].filter(action => !expression.test(action.id));
    return this.actions[group];
  }

  get(group) {
    if (!group) {
      return Object.keys(this.actions).reduce((ret, key) => {
        const actions = this.actions[key].filter(action => !action.condition || action.condition());

        if (actions.length) {
          ret[key] = actions;
        }

        return ret;
      }, {});
    }

    return this.actions[group].filter(action => !action.condition || action.condition());
  }

  getById(id) {
    const messageActions = this.actions;
    let actions = [];
    Object.keys(messageActions).forEach(function (action) {
      actions = actions.concat(messageActions[action]);
    });
    return actions.filter(action => action.id === id);
  }

}

const messageBox = {
  actions: new MessageBoxActions()
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageContext.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/messageContext.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  messageContext: () => messageContext
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let Subscriptions, Rooms, Users;
module.link("../../../models/client", {
  Subscriptions(v) {
    Subscriptions = v;
  },

  Rooms(v) {
    Rooms = v;
  },

  Users(v) {
    Users = v;
  }

}, 4);
let hasPermission;
module.link("../../../authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 5);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 6);
let getUserPreference, roomTypes;
module.link("../../../utils/client", {
  getUserPreference(v) {
    getUserPreference = v;
  },

  roomTypes(v) {
    roomTypes = v;
  }

}, 7);
let AutoTranslate;
module.link("../../../autotranslate/client", {
  AutoTranslate(v) {
    AutoTranslate = v;
  }

}, 8);
let fireGlobalEvent;
module.link("../../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 9);
let actionLinks;
module.link("../../../action-links/client", {
  actionLinks(v) {
    actionLinks = v;
  }

}, 10);
let goToRoomById;
module.link("../../../../client/lib/utils/goToRoomById", {
  goToRoomById(v) {
    goToRoomById = v;
  }

}, 11);
let isLayoutEmbedded;
module.link("../../../../client/lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded(v) {
    isLayoutEmbedded = v;
  }

}, 12);
let handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 13);
const fields = {
  'name': 1,
  'username': 1,
  'settings.preferences.enableMessageParserEarlyAdoption': 1,
  'settings.preferences.showMessageInMainThread': 1,
  'settings.preferences.autoImageLoad': 1,
  'settings.preferences.saveMobileBandwidth': 1,
  'settings.preferences.collapseMediaByDefault': 1,
  'settings.preferences.hideRoles': 1
};

function messageContext() {
  let {
    rid
  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Template.instance();
  const uid = Meteor.userId();
  const user = Users.findOne({
    _id: uid
  }, {
    fields
  }) || {};
  const instance = Template.instance();

  const openThread = e => {
    const {
      rid,
      mid,
      tmid
    } = e.currentTarget.dataset;
    const room = Rooms.findOne({
      _id: rid
    });
    FlowRouter.go(FlowRouter.getRouteName(), {
      rid,
      name: room.name,
      tab: 'thread',
      context: tmid || mid
    }, {
      jump: tmid && tmid !== mid && mid && mid
    });
    e.preventDefault();
    e.stopPropagation();
  };

  const runAction = isLayoutEmbedded() ? (msg, e) => {
    const {
      actionlink
    } = e.currentTarget.dataset;
    return fireGlobalEvent('click-action-link', {
      actionlink,
      value: msg._id,
      message: msg
    });
  } : (msg, e) => {
    const {
      actionlink
    } = e.currentTarget.dataset;
    actionLinks.run(actionlink, msg._id, instance, err => {
      if (err) {
        handleError(err);
      }
    });
  };

  const openDiscussion = e => {
    e.preventDefault();
    e.stopPropagation();
    const {
      drid
    } = e.currentTarget.dataset;
    goToRoomById(drid);
  };

  const replyBroadcast = e => {
    const {
      username,
      mid
    } = e.currentTarget.dataset;
    roomTypes.openRouteLink('d', {
      name: username
    }, _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), {}, {
      reply: mid
    }));
  };

  return {
    u: user,
    room: Tracker.nonreactive(() => Rooms.findOne({
      _id: rid
    }, {
      fields: {
        _updatedAt: 0,
        lastMessage: 0
      }
    })),
    subscription: Subscriptions.findOne({
      rid
    }, {
      fields: {
        name: 1,
        autoTranslate: 1,
        rid: 1,
        tunread: 1,
        tunreadUser: 1,
        tunreadGroup: 1
      }
    }),
    actions: {
      openThread() {
        return openThread;
      },

      runAction(msg) {
        return () => e => {
          e.preventDefault();
          e.stopPropagation();
          runAction(msg, e);
        };
      },

      openDiscussion() {
        return openDiscussion;
      },

      replyBroadcast() {
        return replyBroadcast;
      }

    },
    settings: {
      translateLanguage: AutoTranslate.getLanguage(rid),
      showMessageInMainThread: getUserPreference(user, 'showMessageInMainThread'),
      autoImageLoad: getUserPreference(user, 'autoImageLoad'),
      enableMessageParserEarlyAdoption: getUserPreference(user, 'enableMessageParserEarlyAdoption'),
      saveMobileBandwidth: Meteor.Device.isPhone() && getUserPreference(user, 'saveMobileBandwidth'),
      collapseMediaByDefault: getUserPreference(user, 'collapseMediaByDefault'),
      showreply: true,
      showReplyButton: true,
      hasPermissionDeleteMessage: hasPermission('delete-message', rid),
      hasPermissionDeleteOwnMessage: hasPermission('delete-own-message'),
      hideRoles: !settings.get('UI_DisplayRoles') || getUserPreference(user, 'hideRoles'),
      UI_Use_Real_Name: settings.get('UI_Use_Real_Name'),
      Chatops_Username: settings.get('Chatops_Username'),
      AutoTranslate_Enabled: settings.get('AutoTranslate_Enabled'),
      Message_AllowEditing: settings.get('Message_AllowEditing'),
      Message_AllowEditing_BlockEditInMinutes: settings.get('Message_AllowEditing_BlockEditInMinutes'),
      Message_ShowEditedStatus: settings.get('Message_ShowEditedStatus'),
      API_Embed: settings.get('API_Embed'),
      API_EmbedDisabledFor: settings.get('API_EmbedDisabledFor'),
      Message_GroupingPeriod: settings.get('Message_GroupingPeriod') * 1000
    }
  };
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"modal.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/modal.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  modal: () => modal
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let t, getUserPreference;
module.link("../../../utils", {
  t(v) {
    t = v;
  },

  getUserPreference(v) {
    getUserPreference = v;
  }

}, 3);
module.link("./modal.html");
let handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 4);
let modalStack = [];

const createModal = function () {
  let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  let fn = arguments.length > 1 ? arguments[1] : undefined;
  let onCancel = arguments.length > 2 ? arguments[2] : undefined;
  config.confirmButtonText = config.confirmButtonText || (config.type === 'error' ? t('Ok') : t('Send'));
  config.cancelButtonText = config.cancelButtonText || t('Cancel');
  config.closeOnConfirm = config.closeOnConfirm == null ? true : config.closeOnConfirm;
  config.showConfirmButton = config.showConfirmButton == null ? true : config.showConfirmButton;
  config.showFooter = config.showConfirmButton === true || config.showCancelButton === true;
  config.confirmOnEnter = config.confirmOnEnter == null ? true : config.confirmOnEnter;
  config.closeOnEscape = config.closeOnEscape == null ? true : config.closeOnEscape;

  if (config.type === 'input') {
    config.input = true;
    config.type = false;

    if (!config.inputType) {
      config.inputType = 'text';
    }
  }

  let renderedModal;
  let timer;

  const instance = _objectSpread(_objectSpread({}, config), {}, {
    render: () => {
      if (renderedModal) {
        renderedModal.firstNode().style.display = '';
        return;
      }

      renderedModal = Blaze.renderWithData(Template.rc_modal, instance, document.body);

      if (config.timer) {
        timer = setTimeout(() => {
          instance.close();
        }, config.timer);
      }
    },
    hide: () => {
      if (renderedModal) {
        renderedModal.firstNode().style.display = 'none';
      }

      if (timer) {
        clearTimeout(timer);
        timer = undefined;
      }
    },
    destroy: () => {
      if (renderedModal) {
        Blaze.remove(renderedModal);
        renderedModal = undefined;
      }

      if (timer) {
        clearTimeout(timer);
        timer = undefined;
      }
    },
    close: () => {
      if (onCancel) {
        onCancel.call(instance);
      }

      instance.destroy();
      modalStack = modalStack.filter(modal => modal !== instance);

      if (modalStack.length) {
        modalStack[modalStack.length - 1].render();
      }
    },
    confirm: value => {
      config.closeOnConfirm && instance.close();

      if (fn) {
        fn.call(instance, value);
        return;
      }

      instance.close();
    },
    cancel: () => {
      instance.close();
    },
    showInputError: text => {
      const errorEl = document.querySelector('.rc-modal__content-error');
      errorEl.innerHTML = text;
      errorEl.style.display = 'block';
    }
  });

  return instance;
};

const modal = {
  open: function () {
    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    let fn = arguments.length > 1 ? arguments[1] : undefined;
    let onCancel = arguments.length > 2 ? arguments[2] : undefined;
    modalStack.forEach(instance => {
      instance.destroy();
    });
    modalStack = [];
    const instance = createModal(config, fn, onCancel);

    if (config.dontAskAgain) {
      const dontAskAgainList = getUserPreference(Meteor.userId(), 'dontAskAgainList');

      if (dontAskAgainList && dontAskAgainList.some(dontAsk => dontAsk.action === config.dontAskAgain.action)) {
        instance.confirm(true);
        return;
      }
    }

    instance.render();
    modalStack.push(instance);
  },
  push: function () {
    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    let fn = arguments.length > 1 ? arguments[1] : undefined;
    let onCancel = arguments.length > 2 ? arguments[2] : undefined;
    const instance = createModal(config, fn, onCancel);
    modalStack.forEach(instance => {
      instance.hide();
    });
    instance.render();
    modalStack.push(instance);
    return instance;
  },
  cancel: () => {
    if (modalStack.length) {
      modalStack[modalStack.length - 1].cancel();
    }
  },
  close: () => {
    if (modalStack.length) {
      modalStack[modalStack.length - 1].close();
    }
  },
  confirm: value => {
    if (modalStack.length) {
      modalStack[modalStack.length - 1].confirm(value);
    }
  },
  showInputError: text => {
    if (modalStack.length) {
      modalStack[modalStack.length - 1].showInputError(text);
    }
  },
  onKeyDown: event => {
    if (!modalStack.length) {
      return;
    }

    const instance = modalStack[modalStack.length - 1];

    if (event.key === 'Escape') {
      event.preventDefault();
      event.stopPropagation();
      instance.close();
    }

    if (instance && instance.confirmOnEnter && event.key === 'Enter') {
      event.preventDefault();
      event.stopPropagation();

      if (instance.input) {
        return instance.confirm($('.js-modal-input').val());
      }

      instance.confirm(true);
    }
  }
};
Template.rc_modal.helpers({
  showFooter() {
    const {
      showCancelButton,
      showConfirmButton
    } = this;
    return showCancelButton || showConfirmButton;
  },

  hasAction() {
    return !!this.action;
  },

  type() {
    return this.type && "rc-modal__content-icon rc-modal__content-icon--modal-".concat(this.type);
  },

  modalIcon() {
    switch (this.type) {
      case 'success':
        return 'checkmark-circled';

      case 'error':
        return 'circle-cross';

      case 'info':
        return 'info-circled';

      default:
        return "modal-".concat(this.type);
    }
  }

});
Template.rc_modal.onRendered(function () {
  this.oldFocus = document.activeElement;

  if (this.data.input) {
    $('.js-modal-input', this.firstNode).focus();
  } else if (this.data.showConfirmButton && this.data.confirmOnEnter) {
    $('.js-confirm', this.firstNode).focus();
  }

  if (this.data.onRendered) {
    this.data.onRendered();
  }

  this.data.closeOnEscape && document.addEventListener('keydown', modal.onKeyDown);
});
Template.rc_modal.onDestroyed(function () {
  this.oldFocus && this.oldFocus.focus();
  document.removeEventListener('keydown', modal.onKeyDown);
});
Template.rc_modal.events({
  'click .js-action'(event, instance) {
    !this.action || this.action.call(instance.data.data, event, instance);
    event.stopPropagation();
    this.close();
  },

  'click .js-input-action'(e, instance) {
    !this.inputAction || this.inputAction.call(instance.data.data, e, instance);
    e.stopPropagation();
  },

  'click .js-close'(e) {
    e.preventDefault();
    e.stopPropagation();
    this.cancel();
  },

  'click .js-confirm'(event, instance) {
    event.stopPropagation();
    const {
      dontAskAgain
    } = instance.data;

    if (dontAskAgain && document.getElementById('dont-ask-me-again').checked) {
      const dontAskAgainObject = {
        action: dontAskAgain.action,
        label: dontAskAgain.label
      };
      let dontAskAgainList = getUserPreference(Meteor.userId(), 'dontAskAgainList');

      if (dontAskAgainList) {
        dontAskAgainList.push(dontAskAgainObject);
      } else {
        dontAskAgainList = [dontAskAgainObject];
      }

      Meteor.call('saveUserPreferences', {
        dontAskAgainList
      }, function (error) {
        if (error) {
          return handleError(error);
        }
      });
    }

    if (instance.data.input) {
      this.confirm(document.getElementsByClassName('js-modal-input')[0].value);
      return;
    }

    this.confirm(true);
  },

  'click .rc-modal-wrapper'(event, instance) {
    if (instance.data.allowOutsideClick === false) {
      return false;
    }

    if (event.currentTarget === event.target) {
      event.stopPropagation();
      this.close();
    }
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"openRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/openRoom.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  openRoom: () => openRoom
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 2);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 3);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 4);
let appLayout;
module.link("../../../../client/lib/appLayout", {
  appLayout(v) {
    appLayout = v;
  }

}, 5);
let Messages, ChatSubscription;
module.link("../../../models", {
  Messages(v) {
    Messages = v;
  },

  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 6);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 7);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 8);
let roomTypes;
module.link("../../../utils", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 9);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 10);
let call;
module.link("../../../../client/lib/utils/call", {
  call(v) {
    call = v;
  }

}, 11);
let RoomManager, RoomHistoryManager;
module.link("..", {
  RoomManager(v) {
    RoomManager = v;
  },

  RoomHistoryManager(v) {
    RoomHistoryManager = v;
  }

}, 12);
let NewRoomManager;
module.link("../../../../client/lib/RoomManager", {
  RoomManager(v) {
    NewRoomManager = v;
  }

}, 13);
let Rooms;
module.link("../../../models/client", {
  Rooms(v) {
    Rooms = v;
  }

}, 14);
let fireGlobalEvent;
module.link("../../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 15);
window.currentTracker = undefined; // cleanup session when hot reloading

Session.set('openedRoom', null);
NewRoomManager.on('changed', rid => {
  Session.set('openedRoom', rid);
  RoomManager.openedRoom = rid;
});

const openRoom = async function (type, name) {
  let render = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
  window.currentTracker && window.currentTracker.stop();
  window.currentTracker = Tracker.autorun(async function (c) {
    const user = Meteor.user();

    if (user && user.username == null || user == null && settings.get('Accounts_AllowAnonymousRead') === false) {
      appLayout.renderMainLayout();
      return;
    }

    try {
      const room = roomTypes.findRoom(type, name, user) || (await call('getRoomByTypeAndName', type, name));
      Rooms.upsert({
        _id: room._id
      }, _.omit(room, '_id'));

      if (room._id !== name && type === 'd') {
        // Redirect old url using username to rid
        RoomManager.close(type + name);
        return FlowRouter.go('direct', {
          rid: room._id
        }, FlowRouter.current().queryParams);
      }

      if (room._id === Session.get('openedRoom') && !FlowRouter.getQueryParam('msg')) {
        return;
      }

      RoomManager.open(type + name);

      if (render) {
        appLayout.renderMainLayout({
          center: 'room'
        });
      }

      c.stop();

      if (window.currentTracker) {
        window.currentTracker = undefined;
      }

      NewRoomManager.open(room._id);
      fireGlobalEvent('room-opened', _.omit(room, 'usernames'));
      Session.set('editRoomTitle', false); // KonchatNotification.removeRoomNotification(params._id)
      // update user's room subscription

      const sub = ChatSubscription.findOne({
        rid: room._id
      });

      if (sub && sub.open === false) {
        callWithErrorHandling('openRoom', room._id);
      }

      if (FlowRouter.getQueryParam('msg')) {
        const messageId = FlowRouter.getQueryParam('msg');
        const msg = {
          _id: messageId,
          rid: room._id
        };
        const message = Messages.findOne({
          _id: msg._id
        }) || (await callWithErrorHandling('getMessages', [msg._id]))[0];

        if (message && (message.tmid || message.tcount)) {
          return FlowRouter.setParams({
            tab: 'thread',
            context: message.tmid || message._id
          });
        }

        RoomHistoryManager.getSurroundingMessages(msg);
        FlowRouter.setQueryParams({
          msg: undefined
        });
      }

      return callbacks.run('enter-room', sub);
    } catch (error) {
      c.stop();

      if (type === 'd') {
        try {
          const {
            rid
          } = await call('createDirectMessage', ...name.split(', '));
          return FlowRouter.go('direct', {
            rid
          }, FlowRouter.current().queryParams);
        } catch (error) {
          console.error(error);
        }
      }

      Session.set('roomNotFound', {
        type,
        name,
        error
      });
      appLayout.renderMainLayout({
        center: 'roomNotFound'
      });
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popout.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/popout.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  popout: () => popout
});
module.link("./popout.html");
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);
const popout = {
  context: null,
  isAudioOnly: false,
  showVideoControls: true,
  showStreamControls: false,
  x: 0,
  y: 0,

  open() {
    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    let fn = arguments.length > 1 ? arguments[1] : undefined;
    this.close();
    this.context = Blaze.renderWithData(Template.popout, config, document.body);
    this.fn = fn;
    this.config = config;
    this.onCloseCallback = config.onCloseCallback || null;
    this.timer = null;

    if (config.timer) {
      this.timer = setTimeout(() => this.close(), config.timer);
    }

    if (config.data) {
      this.isAudioOnly = config.data.isAudioOnly;
      this.showVideoControls = config.data.showVideoControls;
      this.showStreamControls = config.data.showStreamControls;
    }
  },

  close() {
    if (this.context) {
      Blaze.remove(this.context);
    }

    this.context = null;
    this.fn = null;

    if (this.timer) {
      clearTimeout(this.timer);
    }

    if (typeof this.onCloseCallback === 'function') {
      this.onCloseCallback();
    }
  },

  dragstart(event) {
    if (!event.target.classList.contains('dropzone-overlay')) {
      const popoutElement = document.querySelector('.rc-popout-wrapper');
      setTimeout(function () {
        popoutElement.style.display = 'none';
      }, 0);
    }
  },

  dragover(event) {
    const e = event.originalEvent || event;
    e.dataTransfer.dropEffect = 'move';
    e.preventDefault();
  },

  dragend(event) {
    if (!event.target.classList.contains('dropzone-overlay')) {
      const popoutElement = document.querySelector('.rc-popout-wrapper');
      popoutElement.style.display = 'initial';
    }
  },

  drop(event) {
    const e = event.originalEvent || event;
    e.preventDefault(); // do not mess with the position if we are dropping files in the dropzone

    if (!event.target.classList.contains('dropzone-overlay')) {
      const popoutElement = document.querySelector('.rc-popout-wrapper');
      const positionTop = e.clientY - popout.y;
      const positionLeft = e.clientX - popout.x;
      popoutElement.style.left = "".concat(positionLeft >= 0 ? positionLeft : 0, "px");
      popoutElement.style.top = "".concat(positionTop >= 0 ? positionTop : 0, "px");
    }
  }

};
Template.popout.helpers({
  state() {
    return Template.instance().isMinimized.get() ? 'closed' : 'open';
  },

  isAudioOnly() {
    return Template.instance().isAudioOnly.get();
  },

  isMuted() {
    return Template.instance().isMuted.get();
  },

  isPlaying() {
    return Template.instance().isPlaying.get();
  },

  showVideoControls() {
    return Template.instance().showVideoControls.get();
  },

  showStreamControls() {
    return Template.instance().showStreamControls.get();
  },

  getStreamStatus() {
    return Template.instance().streamStatus.get();
  }

});
Template.popout.onRendered(function () {
  Template.instance().isMinimized.set(popout.isAudioOnly);
  Template.instance().isAudioOnly.set(popout.isAudioOnly);
  Template.instance().showVideoControls.set(popout.showVideoControls);
  Template.instance().showStreamControls.set(popout.showStreamControls);

  if (this.data.onRendered) {
    this.data.onRendered();
  }
});
Template.popout.onCreated(function () {
  this.isMinimized = new ReactiveVar(popout.isAudioOnly);
  this.isAudioOnly = new ReactiveVar(popout.isAudioOnly);
  this.canOpenExternal = new ReactiveVar(popout.canOpenExternal);
  this.showVideoControls = new ReactiveVar(popout.showVideoControls);
  this.showStreamControls = new ReactiveVar(popout.showStreamControls);
  this.isMuted = new ReactiveVar(false);
  this.isPlaying = new ReactiveVar(true);
  this.streamStatus = new ReactiveVar('preparing');
  document.body.addEventListener('dragstart', popout.dragstart, true);
  document.body.addEventListener('dragover', popout.dragover, true);
  document.body.addEventListener('dragend', popout.dragend, true);
  document.body.addEventListener('drop', popout.drop, true);
});
Template.popout.onDestroyed(function () {
  popout.context = null;
  document.body.removeEventListener('dragstart', popout.dragstart, true);
  document.body.removeEventListener('dragover', popout.dragover, true);
  document.body.removeEventListener('dragend', popout.dragend, true);
  document.body.removeEventListener('drop', popout.drop, true);
});
Template.popout.events({
  'click .js-action'(e, instance) {
    !this.action || this.action.call(instance.data.data, e, instance);
    e.stopPropagation();
    popout.close();
  },

  'click .js-close'(e) {
    e.stopPropagation();
    popout.close();
  },

  'click .js-minimize'(e, i) {
    e.stopPropagation();

    if (i.isMinimized.get()) {
      i.isMinimized.set(false);
      window.liveStreamPlayer.setSize(380, 214);
    } else {
      i.isMinimized.set(true);
      window.liveStreamPlayer.setSize(0, 0);
    }
  },

  'dragstart .rc-popout-wrapper'(event) {
    const e = event.originalEvent || event;
    const url = this.data && this.data.streamingSource || '.rc-popout-wrapper';
    popout.x = e.offsetX;
    popout.y = e.offsetY;
    e.dataTransfer.setData('application/x-moz-node', e.currentTarget);
    e.dataTransfer.setData('text/plain', url);
    e.dataTransfer.effectAllowed = 'move';
  },

  'dragend .rc-popout-wrapper'(event) {
    event.preventDefault();
  },

  'click .rc-popout__controls--record'(e, i) {
    e.preventDefault();

    if (i.streamStatus.get() === 'ready') {
      document.querySelector('.streaming-popup').dispatchEvent(new Event('startStreaming'));
      i.streamStatus.set('starting');
    } else if (i.streamStatus.get() === 'broadcasting') {
      document.querySelector('.streaming-popup').dispatchEvent(new Event('stopStreaming'));
      i.streamStatus.set('finished');
      setTimeout(() => popout && popout.close(), 2000);
    }
  },

  'broadcastStreamReady .streaming-popup'(e, i) {
    e.preventDefault();
    i.streamStatus.set('ready');
  },

  'broadcastStream .streaming-popup'(e, i) {
    e.preventDefault();
    i.streamStatus.set('broadcasting');
  },

  'click .rc-popout__controls--play'(e, i) {
    window.liveStreamPlayer.playVideo();
    i.isPlaying.set(true);
  },

  'click .rc-popout__controls--pause'(e, i) {
    window.liveStreamPlayer.pauseVideo();
    i.isPlaying.set(false);
  },

  'click .rc-popout__controls--mute'(e, i) {
    window.liveStreamPlayer.mute();
    i.isMuted.set(true);
  },

  'click .rc-popout__controls--unmute'(e, i) {
    window.liveStreamPlayer.unMute();
    i.isMuted.set(false);
  },

  'playerStateChanged .rc-popout'(e, i) {
    if (e.detail === window.YT.PlayerState.PLAYING) {
      i.isPlaying.set(true);
    } else if (e.detail === window.YT.PlayerState.PAUSED) {
      i.isPlaying.set(false);
    }
  }

});
callbacks.add('afterLogoutCleanUp', () => popout.close(), callbacks.priority.MEDIUM, 'popout-close-after-logout-cleanup');
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popover.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/popover.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["currentTarget"];

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
module.export({
  popover: () => popover
});
module.link("./popover.html");
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
let messageBox;
module.link("./messageBox", {
  messageBox(v) {
    messageBox = v;
  }

}, 3);
let MessageAction;
module.link("./MessageAction", {
  MessageAction(v) {
    MessageAction = v;
  }

}, 4);
let isRtl;
module.link("../../../utils/client", {
  isRtl(v) {
    isRtl = v;
  }

}, 5);
const popover = {
  renderedPopover: null,

  open(_ref) {
    let {
      currentTarget
    } = _ref,
        config = _objectWithoutProperties(_ref, _excluded);

    // Popover position must be computed as soon as possible, avoiding DOM changes over currentTarget
    const data = _objectSpread({
      targetRect: currentTarget === null || currentTarget === void 0 ? void 0 : currentTarget.getBoundingClientRect()
    }, config);

    this.renderedPopover = Blaze.renderWithData(Template.popover, data, document.body);
  },

  close() {
    if (!this.renderedPopover) {
      return false;
    }

    Blaze.remove(this.renderedPopover);
    const {
      activeElement
    } = this.renderedPopover.dataVar.curValue;

    if (activeElement) {
      $(activeElement).removeClass('active');
    }
  }

};
Template.popover.helpers({
  hasAction() {
    return !!this.action;
  }

});
Template.popover.onRendered(function () {
  if (this.data.onRendered) {
    this.data.onRendered();
  }

  $('.rc-popover').click(function (e) {
    if (e.currentTarget === e.target) {
      popover.close();
    }
  });
  const {
    offsetVertical = 0,
    offsetHorizontal = 0
  } = this.data;
  const {
    activeElement
  } = this.data;
  const originalWidth = window.innerWidth;
  const popoverContent = this.firstNode.children[0];

  const position = _.throttle(() => {
    const direction = typeof this.data.direction === 'function' ? this.data.direction() : this.data.direction;
    const verticalDirection = /top/.test(direction) ? 'top' : 'bottom';
    const rtlDirection = isRtl() ^ /inverted/.test(direction) ? 'left' : 'right';
    const rightDirection = /right/.test(direction) ? 'right' : rtlDirection;
    const horizontalDirection = /left/.test(direction) ? 'left' : rightDirection;
    const position = typeof this.data.position === 'function' ? this.data.position() : this.data.position;
    const customCSSProperties = typeof this.data.customCSSProperties === 'function' ? this.data.customCSSProperties() : this.data.customCSSProperties;
    const mousePosition = typeof this.data.mousePosition === 'function' ? this.data.mousePosition() : this.data.mousePosition || {
      x: this.data.targetRect[horizontalDirection === 'left' ? 'right' : 'left'],
      y: this.data.targetRect[verticalDirection]
    };
    const offsetWidth = offsetHorizontal * (horizontalDirection === 'left' ? 1 : -1);
    const offsetHeight = offsetVertical * (verticalDirection === 'bottom' ? 1 : -1);
    const leftDiff = window.innerWidth - originalWidth;

    if (position) {
      popoverContent.style.top = "".concat(position.top, "px");
      popoverContent.style.left = "".concat(position.left + leftDiff, "px");
    } else {
      const clientHeight = this.data.targetRect.height;
      const popoverWidth = popoverContent.offsetWidth;
      const popoverHeight = popoverContent.offsetHeight;
      const windowWidth = window.innerWidth;
      const windowHeight = window.innerHeight;
      let top = mousePosition.y - clientHeight + offsetHeight;

      if (verticalDirection === 'top') {
        top = mousePosition.y - popoverHeight + offsetHeight;

        if (top < 0) {
          top = 10 + offsetHeight;
        }
      }

      if (top + popoverHeight > windowHeight) {
        top = windowHeight - 10 - popoverHeight - offsetHeight;
      }

      let left = mousePosition.x - popoverWidth + offsetWidth;

      if (horizontalDirection === 'right') {
        left = mousePosition.x + offsetWidth;
      }

      if (left + popoverWidth >= windowWidth) {
        left = mousePosition.x - popoverWidth + offsetWidth;
      }

      if (left <= 0) {
        left = mousePosition.x + offsetWidth;
      }

      popoverContent.style.top = "".concat(top, "px");
      popoverContent.style.left = "".concat(left + leftDiff, "px");
    }

    if (customCSSProperties) {
      Object.keys(customCSSProperties).forEach(function (property) {
        popoverContent.style[property] = customCSSProperties[property];
      });
    }

    const realTop = Number(popoverContent.style.top.replace('px', ''));

    if (realTop + popoverContent.offsetHeight > window.innerHeight) {
      popoverContent.style.overflow = 'scroll';
      popoverContent.style.bottom = 0;
      popoverContent.className = 'rc-popover__content rc-popover__content-scroll';
    }

    if (activeElement) {
      $(activeElement).addClass('active');
    }

    popoverContent.style.opacity = 1;
  }, 50);

  const observer = new MutationObserver(position);
  observer.observe(popoverContent, {
    childList: true,
    subtree: true
  });
  $(window).on('resize', position);
  position();
  this.position = position;
  this.observer = observer;
  this.firstNode.style.visibility = 'visible';
});
Template.popover.onDestroyed(function () {
  var _this$observer;

  if (this.data.onDestroyed) {
    this.data.onDestroyed();
  }

  $(window).off('resize', this.position);
  (_this$observer = this.observer) === null || _this$observer === void 0 ? void 0 : _this$observer.disconnect();
});
Template.popover.events({
  'click .js-action'(e, instance) {
    !this.action || this.action.call(this, e, instance.data.data);
    popover.close();
  },

  'click .js-close'() {
    popover.close();
  },

  'click [data-type="messagebox-action"]'(event, t) {
    const {
      id
    } = event.currentTarget.dataset;
    const actions = messageBox.actions.getById(id);
    actions.filter(_ref2 => {
      let {
        action
      } = _ref2;
      return !!action;
    }).forEach(_ref3 => {
      let {
        action
      } = _ref3;
      action.call(null, _objectSpread(_objectSpread({}, t.data.data), {}, {
        event
      }));
    });
    popover.close();
  },

  'click [data-type="message-action"]'(e, t) {
    const button = MessageAction.getButtonById(e.currentTarget.dataset.id);

    if ((button != null ? button.action : undefined) != null) {
      e.stopPropagation();
      e.preventDefault();
      const {
        tabBar,
        rid
      } = t.data.instance;
      button.action.call(t.data.data, e, {
        tabBar,
        rid
      });
      popover.close();
      return false;
    }
  }

});
Template.popover.helpers({
  isSafariIos: /iP(ad|hone|od).+Version\/[\d\.]+.*Safari/i.test(navigator.userAgent)
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"readMessages.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/readMessages.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  readMessage: () => readMessage
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 2);
let RoomHistoryManager;
module.link("./RoomHistoryManager", {
  RoomHistoryManager(v) {
    RoomHistoryManager = v;
  }

}, 3);
let RoomManager;
module.link("./RoomManager", {
  RoomManager(v) {
    RoomManager = v;
  }

}, 4);
let ChatSubscription, ChatMessage;
module.link("../../../models", {
  ChatSubscription(v) {
    ChatSubscription = v;
  },

  ChatMessage(v) {
    ChatMessage = v;
  }

}, 5);
const readMessage = new class extends Emitter {
  constructor() {
    super();
    this.debug = false;
    this.enable();
  }

  read() {
    let rid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Session.get('openedRoom');

    if (!this.enabled) {
      this.log('readMessage -> readNow canceled by enabled: false');
      return;
    }

    const subscription = ChatSubscription.findOne({
      rid
    });

    if (subscription == null) {
      this.log('readMessage -> readNow canceled, no subscription found for rid:', rid);
      return;
    }

    if (subscription.alert === false && subscription.unread === 0) {
      this.log('readMessage -> readNow canceled, alert', subscription.alert, 'and unread', subscription.unread);
      return;
    }

    const room = RoomManager.getOpenedRoomByRid(rid);

    if (room == null) {
      this.log('readMessage -> readNow canceled, no room found for typeName:', subscription.t + subscription.name);
      return;
    } // Only read messages if user saw the first unread message


    const unreadMark = $('.message.first-unread');

    if (unreadMark.length > 0) {
      const position = unreadMark.position();
      const visible = (position != null ? position.top : undefined) >= 0;

      if (!visible && room.unreadSince.get()) {
        this.log('readMessage -> readNow canceled, unread mark visible:', visible, 'unread since exists', room.unreadSince.get() != null);
        return;
      } // if unread mark is not visible and there is more more not loaded unread messages

    } else if (RoomHistoryManager.getRoom(rid).unreadNotLoaded.get() > 0) {
      return;
    }

    return this.readNow(rid);
  }

  readNow() {
    let rid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Session.get('openedRoom');

    if (rid == null) {
      this.log('readMessage -> readNow canceled, no rid informed');
      return;
    }

    const subscription = ChatSubscription.findOne({
      rid
    });

    if (subscription == null) {
      this.log('readMessage -> readNow canceled, no subscription found for rid:', rid);
      return;
    }

    return Meteor.call('readMessages', rid, () => {
      RoomHistoryManager.getRoom(rid).unreadNotLoaded.set(0);
      return this.emit(rid);
    });
  }

  log() {
    return this.debug && console.log(...arguments);
  }

  disable() {
    this.enabled = false;
  }

  enable() {
    this.enabled = document.hasFocus();
  }

  isEnable() {
    return this.enabled === true;
  }

  refreshUnreadMark(rid) {
    if (rid == null) {
      return;
    }

    const subscription = ChatSubscription.findOne({
      rid
    }, {
      reactive: false
    });

    if (subscription == null) {
      return;
    }

    const room = RoomManager.openedRooms[subscription.t + subscription.name];

    if (room == null) {
      return;
    }

    if (!subscription.alert && subscription.unread === 0) {
      $('.message.first-unread').removeClass('first-unread');
      room.unreadSince.set(undefined);
      return;
    }

    let lastReadRecord = ChatMessage.findOne({
      rid: subscription.rid,
      ts: {
        $lt: subscription.ls
      }
    }, {
      sort: {
        ts: -1
      }
    });
    const {
      unreadNotLoaded
    } = RoomHistoryManager.getRoom(rid);

    if (lastReadRecord == null && unreadNotLoaded.get() === 0) {
      lastReadRecord = {
        ts: new Date(0)
      };
    }

    room.unreadSince.set((lastReadRecord || unreadNotLoaded.get() > 0) && subscription.ls);

    if (!lastReadRecord) {
      return;
    }

    const firstUnreadRecord = ChatMessage.findOne({
      'rid': subscription.rid,
      'ts': {
        $gt: lastReadRecord.ts
      },
      'u._id': {
        $ne: Meteor.userId()
      }
    }, {
      sort: {
        ts: 1
      }
    });

    if (firstUnreadRecord) {
      room.unreadFirstId = firstUnreadRecord._id;
      $('.message.first-unread').removeClass('first-unread');
      $(".message#".concat(firstUnreadRecord._id)).addClass('first-unread');
    }
  }

}();
Meteor.startup(function () {
  $(window).on('blur', () => readMessage.disable()).on('focus', () => {
    readMessage.enable();
    readMessage.read();
  }).on('touchend', () => {
    readMessage.enable();
  }).on('keyup', e => {
    const key = e.which;

    if (key === 27) {
      // ESCAPE KEY
      const rid = Session.get('openedRoom');

      if (!rid) {
        return;
      }

      readMessage.readNow(rid);
      readMessage.refreshUnreadMark(rid);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/index.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/modal", {
  modal: "modal"
}, 0);
module.link("./lib/SideNav", {
  SideNav: "SideNav"
}, 1);
module.link("./lib/AccountBox", {
  AccountBox: "AccountBox"
}, 2);
module.link("./lib/menu", {
  menu: "menu"
}, 3);
module.link("./lib/MessageAction", {
  MessageAction: "MessageAction"
}, 4);
module.link("./lib/messageBox", {
  messageBox: "messageBox"
}, 5);
module.link("./lib/popover", {
  popover: "popover"
}, 6);
module.link("./lib/readMessages", {
  readMessage: "readMessage"
}, 7);
module.link("./lib/RoomManager", {
  RoomManager: "RoomManager"
}, 8);
module.link("./lib/RoomHistoryManager", {
  upsertMessage: "upsertMessage",
  RoomHistoryManager: "RoomHistoryManager",
  normalizeThreadMessage: "normalizeThreadMessage"
}, 9);
module.link("./lib/mainReady", {
  mainReady: "mainReady"
}, 10);
module.link("./lib/IframeLogin", {
  IframeLogin: "IframeLogin",
  iframeLogin: "iframeLogin"
}, 11);
module.link("./lib/popout", {
  popout: "popout"
}, 12);
module.link("../lib/MessageProperties", {
  messageProperties: "messageProperties"
}, 13);
module.link("../lib/MessageTypes", {
  MessageTypes: "MessageTypes"
}, 14);
module.link("../lib/Message", {
  Message: "Message"
}, 15);
module.link("./lib/openRoom", {
  openRoom: "openRoom"
}, 16);
module.link("./lib/collapseArrow", {
  "*": "*"
}, 17);
module.link("./lib/messageArgs", {
  "*": "*"
}, 18);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"Message.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/lib/Message.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Message: () => Message
});
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let s;
module.link("underscore.string", {
  default(v) {
    s = v;
  }

}, 2);
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 3);
let MessageTypes;
module.link("./MessageTypes", {
  MessageTypes(v) {
    MessageTypes = v;
  }

}, 4);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 5);
const Message = {
  parse(msg, language) {
    const messageType = MessageTypes.getType(msg);

    if (messageType) {
      if (messageType.render) {
        return messageType.render(msg);
      }

      if (messageType.template) {
        // Render message
        return;
      }

      if (messageType.message) {
        if (!language) {
          language = Meteor._localStorage.getItem('userLanguage');
        }

        const data = typeof messageType.data === 'function' && messageType.data(msg) || {};
        return TAPi18n.__(messageType.message, data, language);
      }
    }

    if (msg.u && msg.u.username === settings.get('Chatops_Username')) {
      msg.html = msg.msg;
      return msg.html;
    }

    msg.html = msg.msg;

    if (s.trim(msg.html) !== '') {
      msg.html = escapeHTML(msg.html);
    }

    msg.html = msg.html.replace(/\n/gm, '<br/>');
    return msg.html;
  }

};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"MessageProperties.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/lib/MessageProperties.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  messageProperties: () => messageProperties
});
let GraphemeSplitter;
module.link("grapheme-splitter", {
  default(v) {
    GraphemeSplitter = v;
  }

}, 0);
let emoji;
module.link("../../emoji", {
  emoji(v) {
    emoji = v;
  }

}, 1);
const splitter = new GraphemeSplitter();
const messageProperties = {
  length: message => splitter.countGraphemes(message),
  messageWithoutEmojiShortnames: message => message.replace(/:\w+:/gm, match => {
    if (emoji.list[match] !== undefined) {
      return ' ';
    }

    return match;
  })
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"MessageTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/lib/MessageTypes.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  MessageTypes: () => MessageTypes
});
const MessageTypes = new class {
  constructor() {
    this.types = {};
  }

  registerType(options) {
    this.types[options.id] = options;
    return options;
  }

  getType(message) {
    return this.types[message && message.t];
  }

  isSystemMessage(message) {
    const type = this.types[message && message.t];
    return type && type.system;
  }

}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/index.js                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"livechat":{"client":{"views":{"app":{"dialog":{"closeRoom.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/dialog/closeRoom.html                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.closeRoom.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.closeRoom.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/dialog/template.closeRoom.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("closeRoom");
Template["closeRoom"] = new Template("Template.closeRoom", (function() {
  var view = this;
  return HTML.SECTION({
    class: "create-channel"
  }, "\n\t\t", HTML.DIV({
    class: "create-channel__wrapper"
  }, "\n\t\t\t", HTML.P({
    class: "create-channel__description"
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Close_room_description");
  })), "\n\t\t\t", HTML.FORM({
    id: "close-room",
    class: "close-room__content"
  }, "\n\t\t\t\t", HTML.DIV({
    class: "create-channel__inputs"
  }, "\n\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "rc-input ", Blaze.If(function() {
        return Spacebars.call(view.lookup("invalidComment"));
      }, function() {
        return "rc-input--error";
      }) ];
    }
  }, "\n\t\t\t\t\t\t", HTML.LABEL({
    class: "rc-input__label"
  }, "\n\t\t\t\t\t\t\t", HTML.DIV({
    class: "rc-input__wrapper"
  }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
    name: "comment",
    id: "comment",
    type: "text",
    class: "rc-input__element",
    placeholder: function() {
      return Spacebars.mustache(view.lookup("_"), "Please_add_a_comment");
    },
    autofocus: ""
  }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("invalidComment"));
  }, function() {
    return [ "\n\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error"
    }, "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error-icon"
    }, "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__error-icon"),
        icon: Spacebars.call("warning"),
        classes: Spacebars.call("rc-input__error-icon-svg")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error-message"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Please_add_a_comment_to_close_the_room");
    })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "rc-input ", Blaze.If(function() {
        return Spacebars.call(view.lookup("invalidTags"));
      }, function() {
        return "rc-input--error";
      }) ];
    }
  }, "\n\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasAvailableTags"));
  }, function() {
    return [ "\n\t\t\t\t\t\t", HTML.DIV({
      class: "rc-form-group rc-form-group--small rc-form-group--inline"
    }, "\n\t\t\t\t\t\t\t", HTML.SELECT({
      id: "tagSelect",
      class: "rc-input rc-input--small rc-form-item-inline"
    }, "\n\t\t\t\t\t\t\t\t", HTML.OPTION({
      value: "placeholder",
      disabled: "",
      selected: ""
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Select_tag");
    })), "\n\t\t\t\t\t\t\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("availableUserTags"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t", HTML.OPTION({
        value: function() {
          return Spacebars.mustache(view.lookup("_id"));
        }
      }, Blaze.View("lookup:.", function() {
        return Spacebars.mustache(view.lookup("."));
      })), "\n\t\t\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t\t"), HTML.Raw('\n\t\t\t\t\t\t\t<button id="addTag" class="rc-button rc-button--primary rc-form-item-inline"><i class="icon-plus"></i></button>\n\t\t\t\t\t\t')), "\n\t\t\t\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t\t\t", HTML.LABEL({
      class: "rc-input__label"
    }, "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__wrapper"
    }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__icon"
    }, "\n\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        icon: Spacebars.call("edit")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
      id: "tagInput",
      class: "rc-input__element",
      type: "text",
      name: "tags",
      autocomplete: "off",
      placeholder: function() {
        return Spacebars.mustache(view.lookup("tagsPlaceHolder"));
      }
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("invalidTags"));
  }, function() {
    return [ "\n\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error"
    }, "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error-icon"
    }, "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__error-icon"),
        icon: Spacebars.call("warning"),
        classes: Spacebars.call("rc-input__error-icon-svg")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error-message"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "error-tags-must-be-assigned-before-closing-chat");
    })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
    class: "rc-form-group rc-form-group--small"
  }, "\n\t\t\t\t\t\t", HTML.UL({
    id: "tags",
    class: "chip-container current-room-tags"
  }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
    return Spacebars.call(view.lookup("tags"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", HTML.LI({
      class: "remove-tag",
      title: function() {
        return Spacebars.mustache(view.lookup("."));
      }
    }, "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("canRemoveTag"), view.lookup("availableUserTags"), view.lookup("."));
    }, function() {
      return HTML.Raw('\n\t\t\t\t\t\t\t\t\t<i class="icon icon-cancel-circled"></i>\n\t\t\t\t\t\t\t\t');
    }), "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:.", function() {
      return Spacebars.mustache(view.lookup("."));
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t\t", HTML.DIV({
    class: "rc-input"
  }, "\n\t\t\t\t", HTML.BUTTON({
    form: "close-room",
    class: "rc-button rc-button--primary js-close-room"
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), " Confirm ");
  })), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"closeRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/dialog/closeRoom.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 3);
let settings;
module.link("../../../../../settings", {
  settings(v) {
    settings = v;
  }

}, 4);
let modal;
module.link("../../../../../ui-utils/client", {
  modal(v) {
    modal = v;
  }

}, 5);
let APIClient, t;
module.link("../../../../../utils", {
  APIClient(v) {
    APIClient = v;
  },

  t(v) {
    t = v;
  }

}, 6);
let hasRole;
module.link("../../../../../authorization", {
  hasRole(v) {
    hasRole = v;
  }

}, 7);
module.link("./closeRoom.html");
let handleError;
module.link("../../../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 8);

const validateRoomComment = comment => {
  if (!settings.get('Livechat_request_comment_when_closing_conversation')) {
    return true;
  }

  return (comment === null || comment === void 0 ? void 0 : comment.length) > 0;
};

const validateRoomTags = (tagsRequired, tags) => {
  if (!tagsRequired) {
    return true;
  }

  return (tags === null || tags === void 0 ? void 0 : tags.length) > 0;
};

const checkUserTagPermission = function () {
  let availableUserTags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  let tag = arguments.length > 1 ? arguments[1] : undefined;

  if (hasRole(Meteor.userId(), ['admin', 'livechat-manager'])) {
    return true;
  }

  return availableUserTags.includes(tag);
};

Template.closeRoom.helpers({
  invalidComment() {
    return Template.instance().invalidComment.get();
  },

  tags() {
    return Template.instance().tags.get();
  },

  invalidTags() {
    return Template.instance().invalidTags.get();
  },

  availableUserTags() {
    return Template.instance().availableUserTags.get();
  },

  tagsPlaceHolder() {
    let placeholder = TAPi18n.__('Enter_a_tag');

    if (!Template.instance().tagsRequired.get()) {
      placeholder = placeholder.concat("(".concat(TAPi18n.__('Optional'), ")"));
    }

    return placeholder;
  },

  hasAvailableTags() {
    const tags = Template.instance().availableTags.get();
    return (tags === null || tags === void 0 ? void 0 : tags.length) > 0;
  },

  canRemoveTag(availableUserTags, tag) {
    return checkUserTagPermission(availableUserTags, tag);
  }

});
Template.closeRoom.events({
  async 'submit .close-room__content'(e, instance) {
    e.preventDefault();
    e.stopPropagation();
    const comment = instance.$('#comment').val();
    instance.invalidComment.set(!validateRoomComment(comment));

    if (instance.invalidComment.get()) {
      return;
    }

    const tagsRequired = instance.tagsRequired.get();
    const tags = instance.tags.get();
    instance.invalidTags.set(!validateRoomTags(tagsRequired, tags));

    if (instance.invalidTags.get()) {
      return;
    }

    Meteor.call('livechat:closeRoom', this.rid, comment, {
      clientAction: true,
      tags
    }, function (error
    /* , result*/
    ) {
      if (error) {
        console.log(error);
        return handleError(error);
      }

      modal.open({
        title: t('Chat_closed'),
        text: t('Chat_closed_successfully'),
        type: 'success',
        timer: 1000,
        showConfirmButton: false
      });
    });
  },

  'click .remove-tag'(e, instance) {
    e.stopPropagation();
    e.preventDefault();
    const tag = this.valueOf();
    const availableTags = instance.availableTags.get();
    const hasAvailableTags = (availableTags === null || availableTags === void 0 ? void 0 : availableTags.length) > 0;
    const availableUserTags = instance.availableUserTags.get();

    if (hasAvailableTags && !checkUserTagPermission(availableUserTags, tag)) {
      return;
    }

    let tags = instance.tags.get();
    tags = tags.filter(el => el !== tag);
    instance.tags.set(tags);
  },

  'click #addTag'(e, instance) {
    e.stopPropagation();
    e.preventDefault();

    if ($('#tagSelect').find(':selected').is(':disabled')) {
      return;
    }

    const tags = [...instance.tags.get()];
    const tagVal = $('#tagSelect').val();

    if (tagVal === '' || tags.includes(tagVal)) {
      return;
    }

    tags.push(tagVal);
    instance.tags.set(tags);
    $('#tagSelect').val('placeholder');
  },

  'keydown #tagInput'(e, instance) {
    if (e.which === 13) {
      e.stopPropagation();
      e.preventDefault();
      const tags = [...instance.tags.get()];
      const tagVal = $('#tagInput').val();

      if (tagVal === '' || tags.includes(tagVal)) {
        return;
      }

      tags.push(tagVal);
      instance.tags.set(tags);
      $('#tagInput').val('');
    }
  }

});
Template.closeRoom.onRendered(function () {
  this.find('#comment').focus();
});
Template.closeRoom.onCreated(async function () {
  this.tags = new ReactiveVar([]);
  this.invalidComment = new ReactiveVar(false);
  this.invalidTags = new ReactiveVar(false);
  this.tagsRequired = new ReactiveVar(false);
  this.availableTags = new ReactiveVar([]);
  this.availableUserTags = new ReactiveVar([]);
  this.agentDepartments = new ReactiveVar([]);

  this.onEnterTag = () => this.invalidTags.set(!validateRoomTags(this.tagsRequired.get(), this.tags.get()));

  const {
    rid
  } = Template.currentData();
  const {
    room
  } = await APIClient.v1.get("rooms.info?roomId=".concat(rid));
  this.tags.set((room === null || room === void 0 ? void 0 : room.tags) || []);

  if (room !== null && room !== void 0 && room.departmentId) {
    const {
      department
    } = await APIClient.v1.get("livechat/department/".concat(room.departmentId, "?includeAgents=false"));
    this.tagsRequired.set(department === null || department === void 0 ? void 0 : department.requestTagBeforeClosingChat);
  }

  const uid = Meteor.userId();
  const {
    departments
  } = await APIClient.v1.get("livechat/agents/".concat(uid, "/departments"));
  const agentDepartments = departments.map(dept => dept.departmentId);
  this.agentDepartments.set(agentDepartments);
  Meteor.call('livechat:getTagsList', (err, tagsList) => {
    this.availableTags.set(tagsList);
    const isAdmin = hasRole(uid, ['admin', 'livechat-manager']);
    const availableTags = tagsList.filter(_ref => {
      let {
        departments
      } = _ref;
      return isAdmin || departments.length === 0 || departments.some(i => agentDepartments.includes(i));
    }).map(_ref2 => {
      let {
        name
      } = _ref2;
      return name;
    });
    this.availableUserTags.set(availableTags);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"tabbar":{"agentEdit.html":[
  "./template.agentEdit.js"
],"template.agentEdit.js":[],"agentInfo.html":[
  "./template.agentInfo.js"
],"template.agentInfo.js":[],"contactChatHistory.html":[
  "./template.contactChatHistory.js"
],"template.contactChatHistory.js":[],"contactChatHistoryItem.html":[
  "./template.contactChatHistoryItem.js"
],"template.contactChatHistoryItem.js":[],"contactChatHistoryMessages.html":[
  "./template.contactChatHistoryMessages.js"
],"template.contactChatHistoryMessages.js":[],"visitorEdit.html":[
  "./template.visitorEdit.js"
],"template.visitorEdit.js":[],"visitorEditCustomField.html":[
  "./template.visitorEditCustomField.js"
],"template.visitorEditCustomField.js":[],"visitorForward.html":[
  "./template.visitorForward.js"
],"template.visitorForward.js":[],"visitorInfo.html":[
  "./template.visitorInfo.js"
],"template.visitorInfo.js":[],"visitorNavigation.html":[
  "./template.visitorNavigation.js"
],"template.visitorNavigation.js":[],"visitorTranscript.html":[
  "./template.visitorTranscript.js"
],"template.visitorTranscript.js":[],"agentEdit.js":[
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/templating",
  "../customTemplates/register",
  "./agentEdit.html",
  "../../../../../authorization",
  "../../../../../utils/client",
  "../../../../../../client/lib/utils/handleError",
  "../../../../../../client/lib/toast"
],"agentInfo.js":[
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/session",
  "meteor/templating",
  "meteor/rocketchat:tap-i18n",
  "underscore",
  "underscore.string",
  "../customTemplates/register",
  "./agentInfo.html",
  "../../../../../ui-utils",
  "../../../../../utils/client",
  "../../../../../authorization",
  "../../../../../../client/lib/utils/handleError"
],"contactChatHistory.js":[
  "@babel/runtime/helpers/objectSpread2",
  "meteor/tracker",
  "meteor/templating",
  "moment",
  "meteor/reactive-var",
  "./contactChatHistory.html",
  "./contactChatHistoryItem.html",
  "underscore",
  "../../../../../utils/client"
],"contactChatHistoryItem.js":[
  "moment",
  "./contactChatHistoryItem.html",
  "meteor/templating",
  "meteor/reactive-var"
],"contactChatHistoryMessages.js":[
  "@babel/runtime/helpers/objectSpread2",
  "meteor/templating",
  "./contactChatHistoryMessages.html",
  "meteor/reactive-var",
  "underscore",
  "../../../../../ui-utils/client/lib/messageContext",
  "../../../../../utils/client"
],"visitorEdit.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/templating",
  "../../../../../utils",
  "../../../../../authorization/client",
  "./visitorEdit.html",
  "../../../../../utils/client",
  "../customTemplates/register",
  "../../../../../../client/lib/toast"
],"visitorEditCustomField.js":[
  "meteor/templating",
  "./visitorEditCustomField.html"
],"visitorForward.js":[
  "@babel/runtime/helpers/objectSpread2",
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/kadira:flow-router",
  "meteor/templating",
  "../../../../../models",
  "../../../../../utils",
  "./visitorForward.html",
  "../../../../../utils/client",
  "../../../../../../client/lib/toast"
],"visitorInfo.js":[
  "meteor/rocketchat:tap-i18n",
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/kadira:flow-router",
  "meteor/session",
  "meteor/templating",
  "underscore",
  "moment",
  "ua-parser-js",
  "../../../../../ui-utils",
  "../../../../../models",
  "../../../../../settings",
  "../../../../../utils",
  "../../../../../authorization",
  "./visitorInfo.html",
  "../../../../../utils/client",
  "../../../../../ui-utils/client",
  "../customTemplates/register",
  "../../../../../markdown/client",
  "../../../../../../client/lib/utils/handleError",
  "../../../../../../client/lib/utils/formatDateAndTime"
],"visitorNavigation.js":[
  "meteor/reactive-var",
  "meteor/templating",
  "moment",
  "underscore",
  "../../../../../models",
  "../../../../../utils",
  "./visitorNavigation.html",
  "../../../../../utils/client"
],"visitorTranscript.js":[
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/templating",
  "../../../../../../client/lib/toast",
  "../../../../../../client/lib/utils/handleError",
  "../../../../../utils",
  "../../../../../utils/client",
  "./visitorTranscript.html",
  "../../../../../../lib/emailValidator"
]},"livechatDashboard.html":[
  "./template.livechatDashboard.js"
],"template.livechatDashboard.js":[],"livechatNotSubscribed.html":[
  "./template.livechatNotSubscribed.js"
],"template.livechatNotSubscribed.js":[],"livechatReadOnly.html":[
  "./template.livechatReadOnly.js"
],"template.livechatReadOnly.js":[],"livechatRoomTagSelector.html":[
  "./template.livechatRoomTagSelector.js"
],"template.livechatRoomTagSelector.js":[],"business-hours":{"BusinessHours.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/business-hours/BusinessHours.ts                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  businessHourManager: () => businessHourManager
});
let SingleBusinessHourBehavior;
module.link("./Single", {
  SingleBusinessHourBehavior(v) {
    SingleBusinessHourBehavior = v;
  }

}, 0);

class BusinessHoursManager {
  constructor(businessHour) {
    this.behavior = void 0;
    this.setBusinessHourBehavior(businessHour);
  }

  setBusinessHourBehavior(businessHour) {
    this.registerBusinessHourBehavior(businessHour);
  }

  registerBusinessHourBehavior(behavior) {
    this.behavior = behavior;
  }

  getTemplate() {
    return this.behavior.getView();
  }

  showCustomTemplate(businessHourData) {
    return this.behavior.showCustomTemplate(businessHourData);
  }

  showBackButton() {
    return this.behavior.showBackButton();
  }

  showTimezoneTemplate() {
    return this.behavior.showTimezoneTemplate();
  }

}

const businessHourManager = new BusinessHoursManager(new SingleBusinessHourBehavior());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Single.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/business-hours/Single.ts                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  SingleBusinessHourBehavior: () => SingleBusinessHourBehavior
});

class SingleBusinessHourBehavior {
  getView() {
    return 'livechatBusinessHoursForm';
  }

  showCustomTemplate() {
    return false;
  }

  showBackButton() {
    return false;
  }

  showTimezoneTemplate() {
    return false;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"customTemplates":{"register.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/customTemplates/register.js                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  customFormTemplate: () => customFormTemplate,
  addCustomFormTemplate: () => addCustomFormTemplate,
  removeCustomTemplate: () => removeCustomTemplate,
  getCustomFormTemplate: () => getCustomFormTemplate
});
const customFormTemplate = new Map();

const addCustomFormTemplate = (form, customTemplateName) => customFormTemplate.set(form, customTemplateName);

const removeCustomTemplate = form => customFormTemplate.delete(form);

const getCustomFormTemplate = form => customFormTemplate.get(form);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"livechatReadOnly.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "meteor/meteor",
  "meteor/templating",
  "meteor/reactive-var",
  "meteor/kadira:flow-router",
  "../../../../models",
  "../../../../../client/lib/utils/callWithErrorHandling",
  "./livechatReadOnly.html",
  "../../../../utils/client",
  "../../lib/stream/inquiry"
],"livechatRoomTagSelector.js":[
  "meteor/meteor",
  "meteor/templating",
  "meteor/reactive-var",
  "./livechatRoomTagSelector.html"
]},"admin.js":[
  "./app/livechatDashboard.html"
],"regular.js":[
  "./app/livechatReadOnly",
  "./app/livechatNotSubscribed.html",
  "./app/livechatRoomTagSelector",
  "./app/tabbar/agentEdit",
  "./app/tabbar/agentInfo",
  "./app/tabbar/visitorEdit",
  "./app/tabbar/visitorEditCustomField",
  "./app/tabbar/visitorForward",
  "./app/tabbar/contactChatHistory",
  "./app/tabbar/contactChatHistoryItem",
  "./app/tabbar/contactChatHistoryMessages",
  "./app/tabbar/visitorInfo",
  "./app/tabbar/visitorNavigation",
  "./app/tabbar/visitorTranscript"
]},"externalFrame":{"externalFrameContainer.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/externalFrameContainer.html                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.externalFrameContainer.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.externalFrameContainer.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/template.externalFrameContainer.js                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("ExternalFrameContainer");
Template["ExternalFrameContainer"] = new Template("Template.ExternalFrameContainer", (function() {
  var view = this;
  return HTML.DIV({
    class: "flex-nav"
  }, "\n\t\t", HTML.IFRAME({
    class: "external-frame",
    src: function() {
      return Spacebars.mustache(view.lookup("externalFrameUrl"));
    }
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"crypto.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/crypto.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  generateKey: () => generateKey,
  getKeyFromString: () => getKeyFromString,
  encrypt: () => encrypt,
  decrypt: () => decrypt
});

function ab2str(buf) {
  return String.fromCharCode(...new Uint16Array(buf));
}

function str2ab(str) {
  const buf = new ArrayBuffer(str.length * 2); // 2 bytes for each char

  const bufView = new Uint16Array(buf);

  for (let i = 0, strLen = str.length; i < strLen; i++) {
    bufView[i] = str.charCodeAt(i);
  }

  return buf;
}

async function generateKey() {
  const key = await crypto.subtle.generateKey({
    name: 'AES-GCM',
    length: 256
  }, true, ['encrypt', 'decrypt']);
  const exportedKey = await crypto.subtle.exportKey('jwk', key);
  return JSON.stringify(exportedKey);
}

async function getKeyFromString(keyStr) {
  const key = JSON.parse(keyStr);
  return crypto.subtle.importKey('jwk', key, {
    name: 'AES-GCM',
    length: 256
  }, true, ['encrypt', 'decrypt']);
}

async function encrypt(text, key) {
  const vector = crypto.getRandomValues(new Uint8Array(16));
  const data = new TextEncoder().encode(text);
  const enc = await crypto.subtle.encrypt({
    name: 'AES-GCM',
    iv: vector
  }, key, data);
  const cipherText = new Uint8Array(enc);
  return encodeURIComponent(btoa(ab2str(vector) + ab2str(cipherText)));
}

async function decrypt(data, key) {
  const binaryData = atob(decodeURIComponent(data));
  const vector = new Uint8Array(new Uint16Array(str2ab(binaryData.slice(0, 16))));
  const buffer = new Uint8Array(new Uint16Array(str2ab(binaryData.slice(16))));
  const decoded = await crypto.subtle.decrypt({
    name: 'AES-GCM',
    iv: vector
  }, key, buffer);
  return new TextDecoder().decode(decoded);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"externalFrameContainer.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/externalFrameContainer.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 2);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 3);
let APIClient;
module.link("../../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 4);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 5);
let encrypt, getKeyFromString;
module.link("./crypto", {
  encrypt(v) {
    encrypt = v;
  },

  getKeyFromString(v) {
    getKeyFromString = v;
  }

}, 6);
module.link("./externalFrameContainer.html");
Template.ExternalFrameContainer.helpers({
  externalFrameUrl() {
    const authToken = Template.instance().authToken.get();

    if (!authToken) {
      return '';
    }

    const frameURLSetting = settings.get('Omnichannel_External_Frame_URL');

    try {
      const frameURL = new URL(frameURLSetting);
      frameURL.searchParams.append('uid', Meteor.userId());
      frameURL.searchParams.append('rid', Session.get('openedRoom'));
      frameURL.searchParams.append('t', authToken);
      return frameURL.toString();
    } catch (_unused) {
      console.error('Invalid URL provided to external frame');
      return '';
    }
  }

});
Template.ExternalFrameContainer.onCreated(async function () {
  this.authToken = new ReactiveVar();
  const {
    'X-Auth-Token': authToken
  } = APIClient.getCredentials();
  const keyStr = settings.get('Omnichannel_External_Frame_Encryption_JWK');

  if (keyStr) {
    return this.authToken.set(await encrypt(authToken, await getKeyFromString(keyStr)));
  }

  this.authToken.set(authToken);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"generateNewKey.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/generateNewKey.ts                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let generateKey;
module.link("./crypto", {
  generateKey(v) {
    generateKey = v;
  }

}, 1);
Meteor.methods({
  async omnichannelExternalFrameGenerateKey() {
    const key = await generateKey();
    Meteor.call('saveSetting', 'Omnichannel_External_Frame_Encryption_JWK', key);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/index.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./generateNewKey");
module.link("./tabBar");
module.link("./externalFrameContainer");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/tabBar.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  }

}, 0);
let useSetting;
module.link("../../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 1);
let addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 2);
addAction('omnichannel-external-frame', () => {
  const enabled = useSetting('Omnichannel_External_Frame_Enabled');
  return useMemo(() => enabled ? {
    groups: ['live'],
    id: 'omnichannel-external-frame',
    title: 'Omnichannel_External_Frame',
    icon: 'cube',
    template: 'ExternalFrameContainer',
    order: -1
  } : null, [enabled]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"stream":{"inquiry.js":[
  "meteor/meteor",
  "../../../lib/stream/constants"
],"queueManager.js":[
  "@babel/runtime/helpers/objectSpread2",
  "meteor/meteor",
  "../../../../utils/client",
  "../../collections/LivechatInquiry",
  "./inquiry",
  "../../../../../client/lib/utils/callWithErrorHandling",
  "../../../../utils",
  "../../../../custom-sounds/client/lib/CustomSounds"
]},"chartHandler.js":[
  "@babel/runtime/helpers/objectSpread2",
  "meteor/rocketchat:tap-i18n"
],"messageTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/lib/messageTypes.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let actionLinks;
module.link("../../../action-links/client", {
  actionLinks(v) {
    actionLinks = v;
  }

}, 0);
actionLinks.register('createLivechatCall', function (message, params, instance) {
  instance.tabBar.open('video');
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"collections":{"LivechatInquiry.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/collections/LivechatInquiry.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  LivechatInquiry: () => LivechatInquiry
});
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
const LivechatInquiry = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"startup":{"notifyUnreadRooms.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/startup/notifyUnreadRooms.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);
let getUserPreference;
module.link("../../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 3);
let Subscriptions, Users;
module.link("../../../models", {
  Subscriptions(v) {
    Subscriptions = v;
  },

  Users(v) {
    Users = v;
  }

}, 4);
let CustomSounds;
module.link("../../../custom-sounds/client", {
  CustomSounds(v) {
    CustomSounds = v;
  }

}, 5);
let audio = null;
Meteor.startup(() => {
  Tracker.autorun(() => {
    if (!settings.get('Livechat_continuous_sound_notification_new_livechat_room')) {
      audio && audio.pause();
      return;
    }

    const subs = Subscriptions.find({
      t: 'l',
      ls: {
        $exists: 0
      },
      open: true
    }).count();

    if (subs === 0) {
      audio && audio.pause();
      return;
    }

    const user = Users.findOne(Meteor.userId(), {
      fields: {
        'settings.preferences.newRoomNotification': 1
      }
    });
    const newRoomNotification = getUserPreference(user, 'newRoomNotification');
    audio = CustomSounds.play(newRoomNotification, {
      loop: true
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"stylesheets":{"livechat.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/stylesheets/livechat.css                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/index.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/messageTypes");
module.link("./roomType");
module.link("./route");
module.link("./ui");
module.link("./tabBar");
module.link("./startup/notifyUnreadRooms");
module.link("./views/app/dialog/closeRoom");
module.link("./stylesheets/livechat.css");
module.link("./externalFrame");
module.link("./lib/messageTypes");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/roomType.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let roomTypes;
module.link("../../utils", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 0);
let LivechatRoomType;
module.link("../lib/LivechatRoomType", {
  default(v) {
    LivechatRoomType = v;
  }

}, 1);
roomTypes.add(new LivechatRoomType());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"route.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/route.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  livechatManagerRoutes: () => livechatManagerRoutes,
  load: () => load
});
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let AccountBox;
module.link("../../ui-utils", {
  AccountBox(v) {
    AccountBox = v;
  }

}, 1);
module.link("../../../client/views/omnichannel/routes");
const livechatManagerRoutes = FlowRouter.group({
  prefix: '/omnichannel',
  name: 'omnichannel'
});

const load = () => module.dynamicImport('./views/admin');

AccountBox.addRoute({
  name: 'livechat-dashboard',
  path: '/dashboard',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Livechat_Dashboard',
  pageTemplate: 'livechatDashboard'
}, livechatManagerRoutes, load);
AccountBox.addRoute({
  name: 'livechat-departments',
  path: '/departments',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Departments',
  pageTemplate: 'livechatDepartments'
}, livechatManagerRoutes, load);
AccountBox.addRoute({
  name: 'livechat-department-edit',
  path: '/departments/:_id/edit',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Edit_Department',
  pageTemplate: 'livechatDepartmentForm',
  customContainer: true
}, livechatManagerRoutes, load);
AccountBox.addRoute({
  name: 'livechat-department-new',
  path: '/departments/new',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'New_Department',
  pageTemplate: 'livechatDepartmentForm',
  customContainer: true
}, livechatManagerRoutes, load);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/tabBar.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let lazy;
module.link("react", {
  lazy(v) {
    lazy = v;
  }

}, 0);
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
addAction('room-info', {
  groups: ['live'],
  id: 'room-info',
  title: 'Room_Info',
  icon: 'info-circled',
  template: /*#__PURE__*/lazy(() => module.dynamicImport('../../../client/views/omnichannel/directory/chats/contextualBar/ChatsContextualBar')),
  order: 0
});
addAction('contact-chat-history', {
  groups: ['live'],
  id: 'contact-chat-history',
  title: 'Contact_Chat_History',
  icon: 'clock',
  template: 'contactChatHistory',
  order: 11
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ui.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/ui.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 0);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);
let hasAllPermission;
module.link("../../authorization", {
  hasAllPermission(v) {
    hasAllPermission = v;
  }

}, 2);
let AccountBox, MessageTypes;
module.link("../../ui-utils", {
  AccountBox(v) {
    AccountBox = v;
  },

  MessageTypes(v) {
    MessageTypes = v;
  }

}, 3);
Tracker.autorun(c => {
  // import omnichannel tabbar templates right away if omnichannel enabled
  if (!settings.get('Livechat_enabled')) {
    return;
  }

  module.dynamicImport('./views/regular');
  c.stop();
});
AccountBox.addItem({
  name: 'Omnichannel',
  icon: 'headset',
  href: '/omnichannel/current',
  sideNav: 'omnichannelFlex',
  condition: () => settings.get('Livechat_enabled') && hasAllPermission('view-livechat-manager')
});
MessageTypes.registerType({
  id: 'livechat-close',
  system: true,
  message: 'Conversation_closed',

  data(message) {
    return {
      comment: message.msg
    };
  }

});
MessageTypes.registerType({
  id: 'livechat-started',
  system: true,
  message: 'Chat_started'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"stream":{"constants.js":[]},"LivechatRoomType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/lib/LivechatRoomType.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  default: () => LivechatRoomType
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let ChatRoom;
module.link("../../models", {
  ChatRoom(v) {
    ChatRoom = v;
  }

}, 2);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);
let hasPermission;
module.link("../../authorization", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 4);
let openRoom;
module.link("../../ui-utils", {
  openRoom(v) {
    openRoom = v;
  }

}, 5);
let RoomMemberActions, RoomSettingsEnum, UiTextContext, RoomTypeRouteConfig, RoomTypeConfig;
module.link("../../utils", {
  RoomMemberActions(v) {
    RoomMemberActions = v;
  },

  RoomSettingsEnum(v) {
    RoomSettingsEnum = v;
  },

  UiTextContext(v) {
    UiTextContext = v;
  },

  RoomTypeRouteConfig(v) {
    RoomTypeRouteConfig = v;
  },

  RoomTypeConfig(v) {
    RoomTypeConfig = v;
  }

}, 6);
let getAvatarURL;
module.link("../../utils/lib/getAvatarURL", {
  getAvatarURL(v) {
    getAvatarURL = v;
  }

}, 7);
let LivechatInquiry;

if (Meteor.isClient) {
  ({
    LivechatInquiry
  } = require('../client/collections/LivechatInquiry'));
}

class LivechatRoomRoute extends RoomTypeRouteConfig {
  constructor() {
    super({
      name: 'live',
      path: '/live/:id/:tab?/:context?'
    });
  }

  action(params) {
    openRoom('l', params.id);
  }

  link(sub) {
    return {
      id: sub.rid
    };
  }

}

class LivechatRoomType extends RoomTypeConfig {
  constructor() {
    super({
      identifier: 'l',
      order: 5,
      icon: 'omnichannel',
      label: 'Omnichannel',
      route: new LivechatRoomRoute()
    });
    this.notSubscribedTpl = 'livechatNotSubscribed';
    this.readOnlyTpl = 'livechatReadOnly';
  }

  enableMembersListProfile() {
    return true;
  }

  findRoom(identifier) {
    return ChatRoom.findOne({
      _id: identifier
    });
  }

  roomName(roomData) {
    return roomData.name || roomData.fname || roomData.label;
  }

  condition() {
    return settings.get('Livechat_enabled') && hasPermission('view-l-room');
  }

  canSendMessage(rid) {
    const room = ChatRoom.findOne({
      _id: rid
    }, {
      fields: {
        open: 1
      }
    });
    return room && room.open === true;
  }

  getUserStatus(rid) {
    const room = Session.get("roomData".concat(rid));

    if (room) {
      return room.v && room.v.status;
    }

    const inquiry = LivechatInquiry.findOne({
      rid
    });
    return inquiry && inquiry.v && inquiry.v.status;
  }

  allowRoomSettingChange(room, setting) {
    switch (setting) {
      case RoomSettingsEnum.JOIN_CODE:
        return false;

      default:
        return true;
    }
  }

  allowMemberAction(room, action) {
    return [RoomMemberActions.INVITE, RoomMemberActions.JOIN].includes(action);
  }

  getUiText(context) {
    switch (context) {
      case UiTextContext.HIDE_WARNING:
        return 'Hide_Livechat_Warning';

      case UiTextContext.LEAVE_WARNING:
        return 'Hide_Livechat_Warning';

      default:
        return '';
    }
  }

  readOnly(rid) {
    const room = ChatRoom.findOne({
      _id: rid
    }, {
      fields: {
        open: 1,
        servedBy: 1
      }
    });

    if (!room || !room.open) {
      return true;
    }

    const inquiry = LivechatInquiry.findOne({
      rid
    }, {
      fields: {
        status: 1
      }
    });

    if (inquiry && inquiry.status === 'queued') {
      return true;
    }

    return !room.servedBy;
  }

  getAvatarPath(roomData) {
    return getAvatarURL({
      username: "@".concat(this.roomName(roomData))
    });
  }

  openCustomProfileTab(instance, room, username) {
    if (!room || !room.v || room.v.username !== username) {
      return false;
    }

    instance.tabBar.openUserInfo();
    return true;
  }

  showQuickActionButtons() {
    return true;
  }

  isLivechatRoom() {
    return true;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/lib/messageTypes.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
let formatDistance;
module.link("date-fns/formatDistance", {
  default(v) {
    formatDistance = v;
  }

}, 0);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 1);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 2);
let MessageTypes;
module.link("../../ui-utils", {
  MessageTypes(v) {
    MessageTypes = v;
  }

}, 3);
MessageTypes.registerType({
  id: 'livechat_navigation_history',
  system: true,
  message: 'New_visitor_navigation',

  data(message) {
    if (!message.navigation || !message.navigation.page) {
      return;
    }

    return {
      history: "".concat((message.navigation.page.title ? "".concat(message.navigation.page.title, " - ") : '') + message.navigation.page.location.href)
    };
  }

});
MessageTypes.registerType({
  id: 'livechat_transfer_history',
  system: true,
  message: 'New_chat_transfer',

  data(message) {
    if (!message.transferData) {
      return;
    }

    const {
      comment
    } = message.transferData;
    const commentLabel = comment && comment !== '' ? '_with_a_comment' : '';
    const from = message.transferData.transferredBy && (message.transferData.transferredBy.name || message.transferData.transferredBy.username);
    const transferTypes = {
      agent: () => TAPi18n.__("Livechat_transfer_to_agent".concat(commentLabel), _objectSpread({
        from,
        to: message.transferData.transferredTo && (message.transferData.transferredTo.name || message.transferData.transferredTo.username)
      }, comment && {
        comment
      })),
      department: () => TAPi18n.__("Livechat_transfer_to_department".concat(commentLabel), _objectSpread({
        from,
        to: message.transferData.nextDepartment && message.transferData.nextDepartment.name
      }, comment && {
        comment
      })),
      queue: () => TAPi18n.__('Livechat_transfer_return_to_the_queue', {
        from
      })
    };
    return {
      transfer: transferTypes[message.transferData.scope]()
    };
  }

});
MessageTypes.registerType({
  id: 'livechat_transcript_history',
  system: true,
  message: 'Livechat_chat_transcript_sent',

  data(message) {
    if (!message.requestData) {
      return;
    }

    const {
      requestData: {
        type,
        visitor = {},
        user = {}
      } = {}
    } = message;
    const requestTypes = {
      visitor: () => TAPi18n.__('Livechat_visitor_transcript_request', {
        guest: visitor.name || visitor.username
      }),
      user: () => TAPi18n.__('Livechat_user_sent_chat_transcript_to_visitor', {
        agent: user.name || user.username,
        guest: visitor.name || visitor.username
      })
    };
    return {
      transcript: requestTypes[type]()
    };
  }

});
MessageTypes.registerType({
  id: 'livechat_video_call',
  system: true,
  message: 'New_videocall_request'
});
MessageTypes.registerType({
  id: 'livechat_webrtc_video_call',

  render(message) {
    if (message.msg === 'ended' && message.webRtcCallEndTs && message.ts) {
      return TAPi18n.__('WebRTC_call_ended_message', {
        callDuration: formatDistance(new Date(message.webRtcCallEndTs), new Date(message.ts)),
        endTime: moment(message.webRtcCallEndTs).format('h:mm A')
      });
    }

    if (message.msg === 'declined' && message.webRtcCallEndTs) {
      return TAPi18n.__('WebRTC_call_declined_message');
    }

    return message.msg;
  }

});
MessageTypes.registerType({
  id: 'omnichannel_placed_chat_on_hold',
  system: true,
  message: 'Omnichannel_placed_chat_on_hold',

  data(message) {
    return {
      comment: message.comment
    };
  }

});
MessageTypes.registerType({
  id: 'omnichannel_on_hold_chat_resumed',
  system: true,
  message: 'Omnichannel_on_hold_chat_resumed',

  data(message) {
    return {
      comment: message.comment
    };
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"message-snippet":{"client":{"tabBar":{"views":{"snippetedMessages.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/tabBar/views/snippetedMessages.html                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.snippetedMessages.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.snippetedMessages.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/tabBar/views/template.snippetedMessages.js                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("snippetedMessages");
Template["snippetedMessages"] = new Template("Template.snippetedMessages", (function() {
  var view = this;
  return [ HTML.DIV({
    class: "list-view snippeted-messages-list flex-tab__header"
  }, "\n\t\t", HTML.DIV({
    class: "title"
  }, "\n\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Snippet_Messages");
  })), "\n\t\t"), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.templateInstance().subscriptionsReady());
  }, function() {
    return [ "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hasMessages"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "No_snippet_messages");
      })), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t"), "\n\t", HTML.DIV({
    class: "flex-tab__result js-list"
  }, "\n\t\t", HTML.UL({
    class: "list clearfix"
  }, "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("messages")),
        _variable: "msg"
      };
    }, function() {
      return Blaze._TemplateWith(function() {
        return {
          msg: Spacebars.call(view.lookup("msg")),
          room: Spacebars.call(view.lookup("room")),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          u: Spacebars.call(view.lookup("u"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      });
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasMore"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "load-more"
    }, "\n\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t"), "\n\t\t" ];
  }), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"snippetedMessages.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/tabBar/views/snippetedMessages.js                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["_id"],
      _excluded2 = ["_id"];

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 3);
let messageContext;
module.link("../../../../ui-utils/client/lib/messageContext", {
  messageContext(v) {
    messageContext = v;
  }

}, 4);
let APIClient;
module.link("../../../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 5);
let Messages;
module.link("../../../../models/client", {
  Messages(v) {
    Messages = v;
  }

}, 6);
let upsertMessageBulk;
module.link("../../../../ui-utils/client/lib/RoomHistoryManager", {
  upsertMessageBulk(v) {
    upsertMessageBulk = v;
  }

}, 7);
const LIMIT_DEFAULT = 50;
Template.snippetedMessages.helpers({
  hasMessages() {
    return Template.instance().messages.find().count();
  },

  messages() {
    const instance = Template.instance();
    return instance.messages.find({}, {
      limit: instance.limit.get(),
      sort: {
        ts: -1
      }
    });
  },

  hasMore() {
    return Template.instance().hasMore.get();
  },

  messageContext
});
Template.snippetedMessages.onCreated(function () {
  this.rid = this.data.rid;
  this.hasMore = new ReactiveVar(true);
  this.messages = new Mongo.Collection(null);
  this.limit = new ReactiveVar(LIMIT_DEFAULT);
  this.autorun(() => {
    const query = {
      _hidden: {
        $ne: true
      },
      snippeted: true,
      rid: this.rid
    };
    this.cursor && this.cursor.stop();
    this.limit.set(LIMIT_DEFAULT);
    this.cursor = Messages.find(query).observe({
      added: _ref => {
        let {
          _id
        } = _ref,
            message = _objectWithoutProperties(_ref, _excluded);

        this.messages.upsert({
          _id
        }, message);
      },
      changed: _ref2 => {
        let {
          _id
        } = _ref2,
            message = _objectWithoutProperties(_ref2, _excluded2);

        this.messages.upsert({
          _id
        }, message);
      },
      removed: _ref3 => {
        let {
          _id
        } = _ref3;
        this.messages.remove({
          _id
        });
      }
    });
  });
  this.autorun(async () => {
    const limit = this.limit.get();
    const {
      messages,
      total
    } = await APIClient.v1.get("chat.getSnippetedMessages?roomId=".concat(this.rid, "&count=").concat(limit));
    upsertMessageBulk({
      msgs: messages
    }, this.messages);
    this.hasMore.set(total > limit);
  });
});
Template.mentionsFlexTab.onDestroyed(function () {
  this.cursor.stop();
});
Template.snippetedMessages.events({
  'scroll .js-list': _.throttle(function (e, instance) {
    if (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight && instance.hasMore.get()) {
      return instance.limit.set(instance.limit.get() + 50);
    }
  }, 200)
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/tabBar/tabBar.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  }

}, 0);
let addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
let useSetting;
module.link("../../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 2);
addAction('snippeted-messages', () => {
  const snippetingEnabled = useSetting('Message_AllowSnippeting');
  return useMemo(() => snippetingEnabled ? {
    groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
    id: 'snippeted-messages',
    title: 'snippet-message',
    icon: 'code',
    template: 'snippetedMessages',
    order: 20
  } : null, [snippetingEnabled]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"page":{"snippetPage.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/page/snippetPage.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.snippetPage.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.snippetPage.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/page/template.snippetPage.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("snippetPage");
Template["snippetPage"] = new Template("Template.snippetPage", (function() {
  var view = this;
  return HTML.DIV({
    id: function() {
      return Spacebars.mustache(view.lookup("_id"));
    },
    class: function() {
      return [ "snippet-page ", Spacebars.mustache(view.lookup("t")), " ", Spacebars.mustache(view.lookup("own")), " ", Spacebars.mustache(view.lookup("isTemp")) ];
    },
    "data-username": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("u"), "username"));
    },
    "data-groupable": function() {
      return Spacebars.mustache(view.lookup("isGroupable"));
    },
    "data-date": function() {
      return Spacebars.mustache(view.lookup("date"));
    },
    "data-timestamp": function() {
      return Spacebars.mustache(view.lookup("timestamp"));
    }
  }, "\n\t\t", HTML.DIV({
    class: "snippet-informations"
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      username: Spacebars.call(Spacebars.dot(view.lookup("snippet"), "u", "username"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("avatar"));
  }), "\n\t\t\t", HTML.SPAN({
    class: "username"
  }, Blaze.View("lookup:snippet.u.username", function() {
    return Spacebars.mustache(Spacebars.dot(view.lookup("snippet"), "u", "username"));
  })), "\n\t\t\t", HTML.SPAN({
    class: "snippet-filename"
  }, Blaze.View("lookup:snippet.snippetName", function() {
    return Spacebars.mustache(Spacebars.dot(view.lookup("snippet"), "snippetName"));
  })), "\n\t\t"), "\n\n\n\n\t\t", HTML.SPAN({
    class: "info"
  }, " ", Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Snippet_Added", view.lookup("date"));
  })), "\n\t\t", HTML.A({
    class: "download-button",
    target: "_blank",
    href: function() {
      return [ "/snippet/download/", Spacebars.mustache(Spacebars.dot(view.lookup("snippet"), "_id")), "/", Spacebars.mustache(Spacebars.dot(view.lookup("snippet"), "snippetName")) ];
    }
  }, HTML.Raw('\n\t\t\t<i class="icon-download"></i>\n\t\t\t'), Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Download_Snippet");
  }), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "body",
    dir: "auto"
  }, "\n\t\t\t", Blaze.View("lookup:snippetContent", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("snippetContent")));
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"stylesheets":{"snippetPage.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/page/stylesheets/snippetPage.css                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"snippetPage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/page/snippetPage.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 3);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 4);
let Markdown;
module.link("../../../markdown/client", {
  Markdown(v) {
    Markdown = v;
  }

}, 5);
let APIClient;
module.link("../../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 6);
let formatTime;
module.link("../../../../client/lib/utils/formatTime", {
  formatTime(v) {
    formatTime = v;
  }

}, 7);
Template.snippetPage.helpers({
  snippet() {
    return Template.instance().message.get();
  },

  snippetContent() {
    const message = Template.instance().message.get();

    if (message === undefined) {
      return null;
    }

    message.html = message.msg;
    const markdown = Markdown.parse(message);
    return markdown.tokens[0].text;
  },

  date() {
    const snippet = Template.instance().message.get();

    if (snippet !== undefined) {
      return moment(snippet.ts).format(settings.get('Message_DateFormat'));
    }
  },

  time() {
    const snippet = Template.instance().message.get();

    if (snippet !== undefined) {
      return formatTime(snippet.ts);
    }
  }

});
Template.snippetPage.onCreated(async function () {
  const snippetId = FlowRouter.getParam('snippetId');
  this.message = new ReactiveVar({});
  const {
    message
  } = await APIClient.v1.get("chat.getSnippetedMessageById?messageId=".concat(snippetId));
  this.message.set(message);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"actionButton.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/actionButton.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// import { Meteor } from 'meteor/meteor';
// import { MessageAction, modal } from '../../ui-utils';
// import { messageArgs } from '../../ui-utils/client/lib/messageArgs';
// import { t, handleError } from '../../utils';
// import { settings } from '../../settings';
// import { Subscriptions } from '../../models';
// import { hasAtLeastOnePermission } from '../../authorization';
//
// Meteor.startup(function() {
// 	MessageAction.addButton({
// 		id: 'snippeted-message',
// 		icon: 'code',
// 		label: 'Snippet',
// 		context: [
// 			'snippeted',
// 			'message',
// 			'message-mobile',
// 		],
// 		order: 10,
// 		group: 'menu',
// 		action() {
// 			const { msg: message } = messageArgs(this);
//
// 			modal.open({
// 				title: 'Create a Snippet',
// 				text: 'The name of your snippet (with file extension):',
// 				type: 'input',
// 				showCancelButton: true,
// 				closeOnConfirm: false,
// 				inputPlaceholder: 'Snippet name',
// 			}, function(filename) {
// 				if (filename === false) {
// 					return false;
// 				}
// 				if (filename === '') {
// 					modal.showInputError('You need to write something!');
// 					return false;
// 				}
// 				message.snippeted = true;
// 				Meteor.call('snippetMessage', message, filename, function(error) {
// 					if (error) {
// 						return handleError(error);
// 					}
// 					modal.open({
// 						title: t('Nice'),
// 						text: `Snippet '${ filename }' created.`,
// 						type: 'success',
// 						timer: 2000,
// 					});
// 				});
// 			});
//
// 		},
// 		condition(message) {
// 			if (Subscriptions.findOne({ rid: message.rid, 'u._id': Meteor.userId() }) === undefined) {
// 				return false;
// 			}
//
// 			if (message.snippeted || ((settings.get('Message_AllowSnippeting') === undefined) ||
// 				(settings.get('Message_AllowSnippeting') === null) ||
// 				(settings.get('Message_AllowSnippeting')) === false)) {
// 				return false;
// 			}
//
// 			return hasAtLeastOnePermission('snippet-message', message.rid);
// 		},
// 	});
//
// });
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/index.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./actionButton");
module.link("./messageType");
module.link("./snippetMessage");
module.link("./page/snippetPage.html");
module.link("./page/snippetPage");
module.link("./tabBar/tabBar");
module.link("./tabBar/views/snippetedMessages.html");
module.link("./tabBar/views/snippetedMessages");
module.link("./page/stylesheets/snippetPage.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/messageType.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 1);
let MessageTypes;
module.link("../../ui-utils", {
  MessageTypes(v) {
    MessageTypes = v;
  }

}, 2);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'message_snippeted',
    system: true,
    message: 'Snippeted_a_message',

    data(message) {
      const snippetLink = "<a href=\"/snippet/".concat(message.snippetId, "/").concat(encodeURIComponent(message.snippetName), "\">").concat(escapeHTML(message.snippetName), "</a>");
      return {
        snippetLink
      };
    }

  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"snippetMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/snippetMessage.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);
let ChatMessage, Subscriptions;
module.link("../../models", {
  ChatMessage(v) {
    ChatMessage = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 2);
Meteor.methods({
  snippetMessage(message) {
    if (typeof Meteor.userId() === 'undefined' || Meteor.userId() === null) {
      return false;
    }

    if (typeof settings.get('Message_AllowSnippeting') === 'undefined' || settings.get('Message_AllowSnippeting') === null || settings.get('Message_AllowSnippeting') === false) {
      return false;
    }

    const subscription = Subscriptions.findOne({
      'rid': message.rid,
      'u._id': Meteor.userId()
    });

    if (subscription === undefined) {
      return false;
    }

    ChatMessage.update({
      _id: message._id
    }, {
      $set: {
        snippeted: true
      }
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"apps":{"client":{"gameCenter":{"gameCenter.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/gameCenter.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.gameCenter.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.gameCenter.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/template.gameCenter.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("GameCenter");
Template["GameCenter"] = new Template("Template.GameCenter", (function() {
  var view = this;
  return [ Blaze._TemplateWith(function() {
    return {
      onScroll: Spacebars.call(view.lookup("onTableScroll")),
      onResize: Spacebars.call(view.lookup("onTableResize")),
      onSort: Spacebars.call(view.lookup("onTableSort"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("table"), function() {
      return [ "\n\t", HTML.TBODY({
        class: "rc-game__list"
      }, "\n\t\t", HTML.THEAD("\n\t\t\t", HTML.TR("\n\t\t\t\t", HTML.TH({
        class: "js-sort rc-table-td--medium",
        "data-sort": "name"
      }, "\n\t\t\t\t\t", HTML.DIV({
        class: "table-fake-th"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Name");
      })), "\n\t\t\t\t"), "\n\t\t\t\t", HTML.TH({
        class: "rc-table-td"
      }, "\n\t\t\t\t\t", HTML.DIV({
        class: "table-fake-th"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Description");
      }), " "), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t\t", Blaze.Each(function() {
        return Spacebars.call(view.lookup("games"));
      }, function() {
        return [ "\n\t\t", HTML.TR({
          class: "rc-game-center__game",
          "data-name": function() {
            return Spacebars.mustache(view.lookup("name"));
          }
        }, "\n\t\t\t", HTML.TD("\n\t\t\t\t", HTML.DIV({
          class: "rc-table-wrapper"
        }, "\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("icon"));
        }, function() {
          return [ "\n\t\t\t\t\t", HTML.DIV({
            class: "rc-table-avatar",
            style: function() {
              return [ "background-image:url(", Spacebars.mustache(view.lookup("icon")), ")" ];
            }
          }), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-table-info"
        }, "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "rc-table-title"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:name", function() {
          return Spacebars.mustache(view.lookup("name"));
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t\t", HTML.TD("\n\t\t\t\t", HTML.DIV({
          class: "rc-table-wrapper"
        }, "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-table-info"
        }, "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "rc-table-title"
        }, "\n\t\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("summary"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:summary", function() {
            return Spacebars.mustache(view.lookup("summary"));
          }), "\n\t\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:description", function() {
            return Spacebars.mustache(view.lookup("description"));
          }), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("summary"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.SPAN({
            class: "rc-table-subtitle"
          }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:description", function() {
            return Spacebars.mustache(view.lookup("description"));
          }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t\t", HTML.TD("\n\t\t\t\t", HTML.DIV({
          class: "rc-table-wrapper"
        }, "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-table-info"
        }, "\n\t\t\t\t\t\t\t", HTML.BUTTON({
          class: "game-center__invite-players js-invite",
          title: "Invite Friends"
        }, "\n\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call("game-center__invite-players-icon"),
            icon: Spacebars.call("plus")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t\t" ];
      }), "\n\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isLoading"));
      }, function() {
        return [ "\n\t\t", HTML.TR("\n\t\t\t", HTML.TD({
          colspan: "3",
          style: "position: relative;"
        }, Spacebars.include(view.lookupTemplate("loading"))), "\n\t\t"), "\n\t\t" ];
      }), "\n\t"), "\n\t" ];
    });
  }), "\n\t", HTML.DIV({
    class: function() {
      return [ "rc-user-info-container flex-nav animated", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("showGame"));
      }, function() {
        return " animated-hidden";
      }) ];
    }
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("showGame"));
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return Spacebars.dataMustache(view.lookup("gameContainerOptions"));
    }, function() {
      return Spacebars.include(view.lookupTemplate("GameContainer"));
    }), "\n\t\t" ];
  }), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"gameContainer.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/gameContainer.html                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.gameContainer.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.gameContainer.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/template.gameContainer.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("GameContainer");
Template["GameContainer"] = new Template("Template.GameContainer", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(view.lookup("isContextualBar"));
  }, function() {
    return [ "\n\t", HTML.HEADER({
      class: "contextual-bar__header"
    }, "\n\t\t", HTML.DIV({
      class: "contextual-bar__header-data"
    }, "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("showBackButton"));
    }, function() {
      return [ "\n\t\t\t", HTML.BUTTON({
        class: "rc-button rc-button--nude contextual-bar__header-back-btn js-back",
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Apps_Game_Center_Back");
        }
      }, HTML.Raw('\n\t\t\t\t<i class="icon-angle-left"></i>\n\t\t\t')), "\n\t\t\t" ];
    }), "\n\t\t\t", HTML.IMG({
      class: "rc-table-avatar contextual-bar__header-icon",
      src: function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("game"), "icon"));
      }
    }), "\n\t\t\t", HTML.H1({
      class: "contextual-bar__header-title"
    }, Blaze.View("lookup:game.name", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("game"), "name"));
    })), "\n\t\t"), "\n\t\t", HTML.BUTTON({
      class: "contextual-bar__header-close rc-game__close"
    }, "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("contextual-bar__header-close-icon"),
        icon: Spacebars.call("plus")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t"), "\n\t"), "\n\t" ];
  }), "\n\n\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("isLoading"));
  }, function() {
    return [ "\n\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t" ];
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: function() {
        return [ "rc-game__container ", Blaze.If(function() {
          return Spacebars.call(view.lookup("isModal"));
        }, function() {
          return " rc-game-modal__container ";
        }) ];
      }
    }, "\n\t\t\t", HTML.IFRAME({
      class: function() {
        return [ "rc-game__main ", Blaze.If(function() {
          return Spacebars.call(view.lookup("isModal"));
        }, function() {
          return " rc-game-modal__main ";
        }) ];
      },
      src: function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("game"), "url"));
      },
      style: "position:absolute; width: 100%; height: 100%;"
    }), "\n\t\t"), "\n\t" ];
  }) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"invitePlayers.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/invitePlayers.html                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.invitePlayers.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.invitePlayers.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/template.invitePlayers.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("InvitePlayers");
Template["InvitePlayers"] = new Template("Template.InvitePlayers", (function() {
  var view = this;
  return HTML.SECTION({
    class: "invite-players"
  }, "\n\t\t", HTML.DIV({
    class: "invite-players__wrapper"
  }, "\n\t\t\t", HTML.FORM({
    id: "invite-players",
    class: "invite-players__content"
  }, "\n\t\t\t\t", HTML.DIV({
    class: "invite-players__inputs"
  }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
    return {
      onClickTag: Spacebars.call(view.lookup("onClickTagUser")),
      deleteLastItem: Spacebars.call(view.lookup("deleteLastItemUser")),
      list: Spacebars.call(view.lookup("selectedUsers")),
      onSelect: Spacebars.call(view.lookup("onSelectUser")),
      collection: Spacebars.call("UserAndRoom"),
      endpoint: Spacebars.call("users.autocomplete"),
      field: Spacebars.call("username"),
      sort: Spacebars.call("username"),
      label: Spacebars.call("Invite_Users"),
      placeholder: Spacebars.call("Username_Placeholder"),
      name: Spacebars.call("users"),
      icon: Spacebars.call("at"),
      noMatchTemplate: Spacebars.call("userSearchEmpty"),
      templateItem: Spacebars.call("popupList_item_default"),
      modifier: Spacebars.call(view.lookup("userModifier"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("SearchInvitePlayers"));
  }), "\n\t\t\t\t"), HTML.Raw('\n\t\t\t\t<input form="invite-players" style="background-color: #1D74F5; float: right;" class="rc-button rc-button--right rc-button--primary js-invite-players" type="submit" data-button="create" value="Invite">\n\t\t\t')), "\n\t\t"), "\n\t");
}));

Template.__checkName("SearchInvitePlayers");
Template["SearchInvitePlayers"] = new Template("Template.SearchInvitePlayers", (function() {
  var view = this;
  return HTML.DIV(HTML.Attrs({
    class: "rc-input",
    id: function() {
      return [ "search-", Spacebars.mustache(view.lookup("name")) ];
    }
  }, function() {
    return Spacebars.attrMustache(view.lookup("disabled"));
  }), "\n\t\t", HTML.LABEL({
    class: "rc-input__label"
  }, "\n\t\t\t", HTML.DIV({
    class: "rc-input__title"
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), view.lookup("label"));
  })), "\n\t\t\t", HTML.DIV({
    class: "rc-input__wrapper"
  }, "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("icon"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "rc-input__icon"
    }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call(view.lookup("icon"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "rc-tags", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("icon"));
      }, function() {
        return " rc-tags--no-icon";
      }) ];
    }
  }, "\n\t\t\t\t\t", Blaze.Each(function() {
    return {
      _sequence: Spacebars.call(view.lookup("list")),
      _variable: "item"
    };
  }, function() {
    return [ " ", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("item"));
    }, function() {
      return Spacebars.include(view.lookupTemplate("tag"));
    }), " " ];
  }), "\n\t\t\t\t\t", HTML.INPUT(HTML.Attrs({
    type: "text",
    id: function() {
      return Spacebars.mustache(view.lookup("name"));
    },
    class: "rc-tags__input",
    placeholder: function() {
      return Spacebars.mustache(view.lookup("_"), view.lookup("placeholder"));
    },
    name: function() {
      return Spacebars.mustache(view.lookup("name"));
    },
    autocomplete: "off"
  }, function() {
    return Spacebars.attrMustache(view.lookup("disabled"));
  })), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("config"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("autocomplete"), "isShowing");
    }, function() {
      return [ "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          data: Spacebars.call(view.lookup("config")),
          items: Spacebars.call(view.lookup("items")),
          ready: Spacebars.call(Spacebars.dataMustache(view.lookup("autocomplete"), "isLoaded"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("popupList"));
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "rc-input__description"
  }, Blaze.View("lookup:description", function() {
    return Spacebars.mustache(view.lookup("description"));
  })), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"gameCenter.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/gameCenter.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let modal;
module.link("../../../ui-utils/client", {
  modal(v) {
    modal = v;
  }

}, 2);
let APIClient, t;
module.link("../../../utils/client", {
  APIClient(v) {
    APIClient = v;
  },

  t(v) {
    t = v;
  }

}, 3);
module.link("./gameCenter.html");
let handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 4);

const getExternalComponents = async instance => {
  try {
    const {
      externalComponents
    } = await APIClient.get('apps/externalComponents');
    instance.games.set(externalComponents);
  } catch (e) {
    handleError(e);
  }

  instance.isLoading.set(false);
  instance.ready.set(true);
};

const openGame = gameManifestInfo => {
  const instance = Template.instance();
  const {
    location = 'MODAL'
  } = gameManifestInfo;

  if (location === 'CONTEXTUAL_BAR') {
    instance.gameManifestInfo.set(gameManifestInfo);
  } else if (location === 'MODAL') {
    modal.open({
      allowOutsideClick: false,
      data: {
        game: gameManifestInfo
      },
      template: 'GameContainer',
      type: 'rc-game'
    });
  }
};

Template.GameCenter.helpers({
  isReady() {
    if (Template.instance().ready != null) {
      return Template.instance().ready.get();
    }

    return false;
  },

  games() {
    return Template.instance().games.get();
  },

  isLoading() {
    return Template.instance().isLoading.get();
  },

  onTableScroll() {
    const instance = Template.instance();

    if (instance.loading || instance.end.get()) {
      return;
    }

    return function (currentTarget) {
      if (currentTarget.offsetHeight + currentTarget.scrollTop >= currentTarget.scrollHeight - 100) {
        return instance.page.set(instance.page.get() + 1);
      }
    };
  },

  showGame() {
    return Template.instance().gameManifestInfo.get();
  },

  gameContainerOptions() {
    const {
      gameManifestInfo,
      clearGameManifestInfo
    } = Template.instance();
    return {
      game: gameManifestInfo.get(),
      showBackButton: true,
      clearGameManifestInfo
    };
  }

});
Template.GameCenter.onCreated(function () {
  this.ready = new ReactiveVar(false);
  this.games = new ReactiveVar([]);
  this.isLoading = new ReactiveVar(true);
  this.page = new ReactiveVar(0);
  this.end = new ReactiveVar(false);
  this.gameManifestInfo = new ReactiveVar(null);

  this.clearGameManifestInfo = () => {
    this.gameManifestInfo.set(null);
  };

  getExternalComponents(this);
});
Template.GameCenter.events({
  'click .rc-game-center__game'() {
    const gameManifestInfo = this;
    openGame(gameManifestInfo);
  },

  'click .js-invite'(event) {
    event.stopPropagation();
    modal.open({
      title: t('Apps_Game_Center_Invite_Friends'),
      content: 'InvitePlayers',
      data: this,
      confirmOnEnter: false,
      showCancelButton: false,
      showConfirmButton: false,
      html: false
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"gameContainer.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/gameContainer.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let modal;
module.link("../../../ui-utils/client", {
  modal(v) {
    modal = v;
  }

}, 1);
let Apps;
module.link("../orchestrator", {
  Apps(v) {
    Apps = v;
  }

}, 2);
let APIClient;
module.link("../../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 3);
module.link("./gameContainer.html");

const getExternalComponent = async () => {
  const {
    data: {
      game: externalComponent
    }
  } = Template.instance();
  const realAppClientUIHost = Apps.getUIHost();
  const currentUser = await realAppClientUIHost.getClientUserInfo();
  const currentRoom = await realAppClientUIHost.getClientRoomInfo();
  externalComponent.state = {
    currentUser,
    currentRoom
  };
  return externalComponent;
};

Template.GameContainer.helpers({
  isContextualBar() {
    const {
      data: {
        game
      }
    } = Template.instance();
    const {
      location
    } = game;
    return location === 'CONTEXTUAL_BAR';
  },

  isModal() {
    const {
      data: {
        game
      }
    } = Template.instance();
    const {
      location
    } = game;
    return location === 'MODAL';
  }

});
Template.GameContainer.events({
  'click .rc-game__close'() {
    const {
      data: {
        clearGameManifestInfo
      }
    } = Template.instance();
    clearGameManifestInfo();
    modal.cancel();
  },

  'click .js-back'() {
    const {
      data: {
        clearGameManifestInfo
      }
    } = Template.instance();
    clearGameManifestInfo();
  }

});
Template.GameContainer.onCreated(async () => {
  const externalComponent = await getExternalComponent();
  APIClient.post('apps/externalComponentEvent', {
    event: 'IPostExternalComponentOpened',
    externalComponent
  });
});
Template.GameContainer.onDestroyed(async () => {
  const externalComponent = await getExternalComponent();
  APIClient.post('apps/externalComponentEvent', {
    event: 'IPostExternalComponentClosed',
    externalComponent
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"invitePlayers.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/invitePlayers.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 3);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 4);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 5);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 6);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 7);
let AutoComplete;
module.link("../../../meteor-autocomplete/client", {
  AutoComplete(v) {
    AutoComplete = v;
  }

}, 8);
let roomTypes;
module.link("../../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 9);
let ChatRoom;
module.link("../../../models/client", {
  ChatRoom(v) {
    ChatRoom = v;
  }

}, 10);
let modal;
module.link("../../../ui-utils/client", {
  modal(v) {
    modal = v;
  }

}, 11);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 12);
module.link("./invitePlayers.html");
Template.InvitePlayers.helpers({
  onSelectUser() {
    return Template.instance().onSelectUser;
  },

  selectedUsers() {
    const myUsername = Meteor.user().username;
    const {
      message
    } = this;
    const users = Template.instance().selectedUsers.get().map(e => e);

    if (message) {
      users.unshift(message.u);
    }

    return users.filter(_ref => {
      let {
        username
      } = _ref;
      return myUsername !== username;
    });
  },

  onClickTagUser() {
    return Template.instance().onClickTagUser;
  },

  deleteLastItemUser() {
    return Template.instance().deleteLastItemUser;
  },

  onClickTagRoom() {
    return Template.instance().onClickTagRoom;
  },

  deleteLastItemRoom() {
    return Template.instance().deleteLastItemRoom;
  },

  selectedRoom() {
    return Template.instance().selectedRoom.get();
  },

  onSelectRoom() {
    return Template.instance().onSelectRoom;
  },

  roomCollection() {
    return ChatRoom;
  },

  roomSelector() {
    return expression => ({
      name: {
        $regex: ".*".concat(expression, ".*")
      }
    });
  },

  roomModifier() {
    return function (filter) {
      let text = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
      const f = filter.get();
      return "#".concat(f.length === 0 ? text : text.replace(new RegExp(filter.get(), 'i'), part => "<strong>".concat(part, "</strong>")));
    };
  },

  userModifier() {
    return function (filter) {
      let text = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
      const f = filter.get();
      return "@".concat(f.length === 0 ? text : text.replace(new RegExp(filter.get(), 'i'), part => "<strong>".concat(part, "</strong>")));
    };
  },

  nameSuggestion() {
    return Template.instance().discussionName.get();
  }

});
Template.InvitePlayers.events({
  async 'submit #invite-players, click .js-invite-players'(e, instance) {
    e.preventDefault();
    const {
      data: {
        name
      }
    } = instance;
    const users = instance.selectedUsers.get().map(_ref2 => {
      let {
        username
      } = _ref2;
      return username;
    });
    const privateGroupName = "".concat(name.replace(/\s/g, '-'), "-").concat(Random.id(10));

    try {
      const result = await callWithErrorHandling('createPrivateGroup', privateGroupName, users);
      roomTypes.openRouteLink(result.t, result); // This ensures the message is only sent after the
      // user has been redirected to the new room, preventing a
      // weird bug that made the message appear as unsent until
      // the screen gets refreshed

      Tracker.autorun(c => {
        if (Session.get('openedRoom') !== result.rid) {
          return;
        }

        callWithErrorHandling('sendMessage', {
          _id: Random.id(),
          rid: result.rid,
          msg: TAPi18n.__('Apps_Game_Center_Play_Game_Together', {
            name
          })
        });
        c.stop();
      });
      modal.close();
    } catch (err) {
      console.warn(err);
    }
  }

});
Template.InvitePlayers.onCreated(function () {
  this.selectedUsers = new ReactiveVar([]);

  this.onSelectUser = _ref3 => {
    let {
      item: user
    } = _ref3;

    if (user.username === Meteor.user().username) {
      return;
    }

    const users = this.selectedUsers.get();

    if (!users.find(u => user.username === u.username)) {
      this.selectedUsers.set([...users, user]);
    }
  };

  this.onClickTagUser = _ref4 => {
    let {
      username
    } = _ref4;
    this.selectedUsers.set(this.selectedUsers.get().filter(user => user.username !== username));
  };

  this.deleteLastItemUser = () => {
    const arr = this.selectedUsers.get();
    arr.pop();
    this.selectedUsers.set(arr);
  };
});
Template.SearchInvitePlayers.helpers({
  list() {
    return this.list;
  },

  items() {
    return Template.instance().ac.filteredList();
  },

  config() {
    const {
      filter
    } = Template.instance();
    const {
      noMatchTemplate,
      templateItem,
      modifier
    } = Template.instance().data;
    return {
      filter: filter.get(),
      template_item: templateItem,
      noMatchTemplate,

      modifier(text) {
        return modifier(filter, text);
      }

    };
  },

  autocomplete(key) {
    const instance = Template.instance();
    const param = instance.ac[key];
    return typeof param === 'function' ? param.apply(instance.ac) : param;
  }

});
Template.SearchInvitePlayers.events({
  'input input'(e, t) {
    const input = e.target;
    const position = input.selectionEnd || input.selectionStart;
    const {
      length
    } = input.value;
    document.activeElement === input && e && /input/i.test(e.type) && (input.selectionEnd = position + input.value.length - length);
    t.filter.set(input.value);
  },

  'click .rc-popup-list__item'(e, t) {
    t.ac.onItemClick(this, e);
  },

  'keydown input'(e, t) {
    const KEYCODE_BACKSPACE = 8;
    const KEYCODE_DELETE = 46;
    t.ac.onKeyDown(e);

    if ([KEYCODE_BACKSPACE, KEYCODE_DELETE].includes(e.keyCode) && e.target.value === '') {
      const {
        deleteLastItem
      } = t;
      return deleteLastItem && deleteLastItem();
    }
  },

  'keyup input'(e, t) {
    t.ac.onKeyUp(e);
  },

  'focus input'(e, t) {
    t.ac.onFocus(e);
  },

  'blur input'(e, t) {
    t.ac.onBlur(e);
  },

  'click .rc-tags__tag'(_ref5, t) {
    let {
      target
    } = _ref5;
    const {
      onClickTag
    } = t;
    return onClickTag & onClickTag(Blaze.getData(target));
  }

});
Template.SearchInvitePlayers.onRendered(function () {
  const {
    name
  } = this.data;
  this.ac.element = this.firstNode.querySelector("[name=".concat(name, "]"));
  this.ac.$element = $(this.ac.element);
});
Template.SearchInvitePlayers.onCreated(function () {
  this.filter = new ReactiveVar('');
  this.selected = new ReactiveVar([]);
  this.onClickTag = this.data.onClickTag;
  this.deleteLastItem = this.data.deleteLastItem;
  const {
    collection,
    endpoint,
    field,
    sort,
    onSelect,
    selector = match => ({
      term: match
    })
  } = this.data;
  this.ac = new AutoComplete({
    selector: {
      anchor: '.rc-input__label',
      item: '.rc-popup-list__item',
      container: '.rc-popup-list__list'
    },
    onSelect,
    position: 'fixed',
    limit: 10,
    inputDelay: 300,
    rules: [{
      collection,
      endpoint,
      field,
      matchAll: true,
      doNotChangeWidth: false,
      selector,
      sort
    }]
  });
  this.ac.tmplInst = this;
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/tabBar.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  }

}, 0);
let addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
let useEndpointData;
module.link("../../../../client/hooks/useEndpointData", {
  useEndpointData(v) {
    useEndpointData = v;
  }

}, 2);
let AsyncStatePhase;
module.link("../../../../client/hooks/useAsyncState", {
  AsyncStatePhase(v) {
    AsyncStatePhase = v;
  }

}, 3);
addAction('game-center', () => {
  const {
    value = {
      externalComponents: []
    },
    phase: state,
    error
  } = useEndpointData('/apps/externalComponents');
  const hasExternalComponents = value && value.externalComponents.length > 0;
  const hasError = !!error;
  return useMemo(() => state === AsyncStatePhase.RESOLVED && !hasError && hasExternalComponents ? {
    groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
    id: 'game-center',
    title: 'Apps_Game_Center',
    icon: 'game',
    template: 'GameCenter',
    order: -1
  } : null, [hasError, hasExternalComponents, state]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"communication":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/communication/index.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./websockets", {
  AppWebsocketReceiver: "AppWebsocketReceiver",
  AppEvents: "AppEvents"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"websockets.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/communication/websockets.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AppEvents: () => AppEvents,
  AppWebsocketReceiver: () => AppWebsocketReceiver
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 1);
let slashCommands, APIClient;
module.link("../../../utils", {
  slashCommands(v) {
    slashCommands = v;
  },

  APIClient(v) {
    APIClient = v;
  }

}, 2);
let CachedCollectionManager;
module.link("../../../ui-cached-collection", {
  CachedCollectionManager(v) {
    CachedCollectionManager = v;
  }

}, 3);
let loadButtons;
module.link("../../../ui-message/client/ActionButtonSyncer", {
  loadButtons(v) {
    loadButtons = v;
  }

}, 4);
const AppEvents = Object.freeze({
  APP_ADDED: 'app/added',
  APP_REMOVED: 'app/removed',
  APP_UPDATED: 'app/updated',
  APP_STATUS_CHANGE: 'app/statusUpdate',
  APP_SETTING_UPDATED: 'app/settingUpdated',
  COMMAND_ADDED: 'command/added',
  COMMAND_DISABLED: 'command/disabled',
  COMMAND_UPDATED: 'command/updated',
  COMMAND_REMOVED: 'command/removed',
  ACTIONS_CHANGED: 'actions/changed'
});

class AppWebsocketReceiver extends Emitter {
  constructor() {
    super();

    this.onCommandAddedOrUpdated = command => {
      APIClient.v1.get('commands.get', {
        command
      }).then(result => {
        slashCommands.commands[command] = result.command;
      });
    };

    this.onCommandRemovedOrDisabled = command => {
      delete slashCommands.commands[command];
    };

    this.onActionsChanged = () => loadButtons();

    this.streamer = new Meteor.Streamer('apps');
    CachedCollectionManager.onLogin(() => {
      this.listenStreamerEvents();
    });
  }

  listenStreamerEvents() {
    Object.values(AppEvents).forEach(eventName => {
      this.streamer.on(eventName, this.emit.bind(this, eventName));
    });
    this.streamer.on(AppEvents.COMMAND_ADDED, this.onCommandAddedOrUpdated);
    this.streamer.on(AppEvents.COMMAND_UPDATED, this.onCommandAddedOrUpdated);
    this.streamer.on(AppEvents.COMMAND_REMOVED, this.onCommandRemovedOrDisabled);
    this.streamer.on(AppEvents.COMMAND_DISABLED, this.onCommandRemovedOrDisabled);
    this.streamer.on(AppEvents.ACTIONS_CHANGED, this.onActionsChanged);
  }

  registerListener(event, listener) {
    this.on(event, listener);
  }

  unregisterListener(event, listener) {
    this.off(event, listener);
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"RealAppsEngineUIHost.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/RealAppsEngineUIHost.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RealAppsEngineUIHost: () => RealAppsEngineUIHost
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let AppsEngineUIHost;
module.link("@rocket.chat/apps-engine/client/AppsEngineUIHost", {
  AppsEngineUIHost(v) {
    AppsEngineUIHost = v;
  }

}, 2);
let Rooms;
module.link("../../models/client", {
  Rooms(v) {
    Rooms = v;
  }

}, 3);
let APIClient;
module.link("../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 4);
let getUserAvatarURL;
module.link("../../utils/lib/getUserAvatarURL", {
  getUserAvatarURL(v) {
    getUserAvatarURL = v;
  }

}, 5);
let baseURI;
module.link("../../../client/lib/baseURI", {
  baseURI(v) {
    baseURI = v;
  }

}, 6);

class RealAppsEngineUIHost extends AppsEngineUIHost {
  constructor() {
    super();
    this._baseURL = baseURI.replace(/\/$/, '');
  }

  getUserAvatarUrl(username) {
    const avatarUrl = getUserAvatarURL(username);

    if (!avatarUrl.startsWith('http') && !avatarUrl.startsWith('data')) {
      return "".concat(this._baseURL).concat(avatarUrl);
    }

    return avatarUrl;
  }

  async getClientRoomInfo() {
    const {
      name: slugifiedName,
      _id: id
    } = Rooms.findOne(Session.get('openedRoom'));
    let cachedMembers = [];

    try {
      const {
        members
      } = await APIClient.get('v1/groups.members', {
        roomId: id
      });
      cachedMembers = members.map(_ref => {
        let {
          _id,
          username
        } = _ref;
        return {
          id: _id,
          username,
          avatarUrl: this.getUserAvatarUrl(username)
        };
      });
    } catch (error) {
      console.warn(error);
    }

    return {
      id,
      slugifiedName,
      members: cachedMembers
    };
  }

  async getClientUserInfo() {
    const {
      username,
      _id
    } = Meteor.user();
    return {
      id: _id,
      username,
      avatarUrl: this.getUserAvatarUrl(username)
    };
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"i18n.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/i18n.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  loadAppI18nResources: () => loadAppI18nResources,
  handleI18nResources: () => handleI18nResources
});
let TAPi18next;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18next(v) {
    TAPi18next = v;
  }

}, 0);
let Apps;
module.link("./orchestrator", {
  Apps(v) {
    Apps = v;
  }

}, 1);
let Utilities;
module.link("../lib/misc/Utilities", {
  Utilities(v) {
    Utilities = v;
  }

}, 2);
let AppEvents;
module.link("./communication", {
  AppEvents(v) {
    AppEvents = v;
  }

}, 3);

const loadAppI18nResources = (appId, languages) => {
  Object.entries(languages).forEach(_ref => {
    let [language, translations] = _ref;

    try {
      // Translations keys must be scoped under app id
      const scopedTranslations = Object.entries(translations).reduce((translations, _ref2) => {
        let [key, value] = _ref2;
        translations[Utilities.getI18nKeyForApp(key, appId)] = value;
        return translations;
      }, {});
      TAPi18next.addResourceBundle(language, 'project', scopedTranslations);
    } catch (error) {
      Apps.handleError(error);
    }
  });
};

const handleAppAdded = async appId => {
  const languages = await Apps.getAppLanguages(appId);
  loadAppI18nResources(appId, languages);
};

const handleI18nResources = async () => {
  const apps = await Apps.getAppsLanguages();
  apps.forEach(_ref3 => {
    let {
      id,
      languages
    } = _ref3;
    loadAppI18nResources(id, languages);
  });
  Apps.getWsListener().unregisterListener(AppEvents.APP_ADDED, handleAppAdded);
  Apps.getWsListener().registerListener(AppEvents.APP_ADDED, handleAppAdded);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/index.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./gameCenter/tabBar");
module.link("./gameCenter/gameContainer");
module.link("./gameCenter/gameCenter");
module.link("./gameCenter/invitePlayers");
module.link("./orchestrator", {
  Apps: "Apps"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"orchestrator.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/orchestrator.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  Apps: () => Apps
});
let AppClientManager;
module.link("@rocket.chat/apps-engine/client/AppClientManager", {
  AppClientManager(v) {
    AppClientManager = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 3);
let hasAtLeastOnePermission;
module.link("../../authorization", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 4);
let settings;
module.link("../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 5);
let CachedCollectionManager;
module.link("../../ui-cached-collection", {
  CachedCollectionManager(v) {
    CachedCollectionManager = v;
  }

}, 6);
let APIClient;
module.link("../../utils", {
  APIClient(v) {
    APIClient = v;
  }

}, 7);
let AppWebsocketReceiver;
module.link("./communication", {
  AppWebsocketReceiver(v) {
    AppWebsocketReceiver = v;
  }

}, 8);
let handleI18nResources;
module.link("./i18n", {
  handleI18nResources(v) {
    handleI18nResources = v;
  }

}, 9);
let RealAppsEngineUIHost;
module.link("./RealAppsEngineUIHost", {
  RealAppsEngineUIHost(v) {
    RealAppsEngineUIHost = v;
  }

}, 10);

const createDeferredValue = () => {
  let resolve;
  let reject;
  const promise = new Promise((_resolve, _reject) => {
    resolve = _resolve;
    reject = _reject;
  });
  return [promise, resolve, reject];
};

class AppClientOrchestrator {
  constructor() {
    this.load = async isEnabled => {
      if (!this.isLoaded) {
        this.ws = new AppWebsocketReceiver();
        this.isLoaded = true;
      }

      this.setEnabled(isEnabled); // Since the deferred value (a promise) is immutable after resolved,
      // it need to be recreated to resolve a new value

      [this.deferredIsEnabled, this.setEnabled] = createDeferredValue();
      await handleI18nResources();
      this.setEnabled(isEnabled);
    };

    this.getWsListener = () => this.ws;

    this.getAppClientManager = () => this._manager;

    this.handleError = error => {
      console.error(error);

      if (hasAtLeastOnePermission(['manage-apps'])) {
        dispatchToastMessage({
          type: 'error',
          message: error.message
        });
      }
    };

    this.isEnabled = () => this.deferredIsEnabled;

    this.getApps = async () => {
      const {
        apps
      } = await APIClient.get('apps');
      return apps;
    };

    this.getAppsFromMarketplace = async () => {
      const appsOverviews = await APIClient.get('apps', {
        marketplace: 'true'
      });
      return appsOverviews.map(_ref => {
        let {
          latest,
          price,
          pricingPlans,
          purchaseType,
          isEnterpriseOnly
        } = _ref;
        return _objectSpread(_objectSpread({}, latest), {}, {
          price,
          pricingPlans,
          purchaseType,
          isEnterpriseOnly
        });
      });
    };

    this.getAppsOnBundle = async bundleId => {
      const {
        apps
      } = await APIClient.get("apps/bundles/".concat(bundleId, "/apps"));
      return apps;
    };

    this.getAppsLanguages = async () => {
      const {
        apps
      } = await APIClient.get('apps/languages');
      return apps;
    };

    this.getApp = async appId => {
      const {
        app
      } = await APIClient.get("apps/".concat(appId));
      return app;
    };

    this.getAppFromMarketplace = async (appId, version) => {
      const {
        app
      } = await APIClient.get("apps/".concat(appId), {
        marketplace: 'true',
        version
      });
      return app;
    };

    this.getLatestAppFromMarketplace = async (appId, version) => {
      const {
        app
      } = await APIClient.get("apps/".concat(appId), {
        marketplace: 'true',
        update: 'true',
        appVersion: version
      });
      return app;
    };

    this.getAppSettings = async appId => {
      const {
        settings
      } = await APIClient.get("apps/".concat(appId, "/settings"));
      return settings;
    };

    this.setAppSettings = async (appId, settings) => {
      const {
        updated
      } = await APIClient.post("apps/".concat(appId, "/settings"), undefined, {
        settings
      });
      return updated;
    };

    this.getAppApis = async appId => {
      const {
        apis
      } = await APIClient.get("apps/".concat(appId, "/apis"));
      return apis;
    };

    this.getAppLanguages = async appId => {
      const {
        languages
      } = await APIClient.get("apps/".concat(appId, "/languages"));
      return languages;
    };

    this.installApp = async (appId, version, permissionsGranted) => {
      const {
        app
      } = await APIClient.post('apps/', {
        appId,
        marketplace: true,
        version,
        permissionsGranted
      });
      return app;
    };

    this.updateApp = async (appId, version, permissionsGranted) => {
      const {
        app
      } = await APIClient.post("apps/".concat(appId), {
        appId,
        marketplace: true,
        version,
        permissionsGranted
      });
      return app;
    };

    this.uninstallApp = appId => APIClient.delete("apps/".concat(appId));

    this.syncApp = appId => APIClient.post("apps/".concat(appId, "/sync"));

    this.setAppStatus = async (appId, status) => {
      const {
        status: effectiveStatus
      } = await APIClient.post("apps/".concat(appId, "/status"), {
        status
      });
      return effectiveStatus;
    };

    this.enableApp = appId => this.setAppStatus(appId, 'manually_enabled');

    this.disableApp = appId => this.setAppStatus(appId, 'manually_disabled');

    this.buildExternalUrl = function (appId) {
      let purchaseType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'buy';
      let details = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
      return APIClient.get('apps', {
        buildExternalUrl: 'true',
        appId,
        purchaseType,
        details
      });
    };

    this.getCategories = async () => {
      const categories = await APIClient.get('apps', {
        categories: 'true'
      });
      return categories;
    };

    this.getUIHost = () => this._appClientUIHost;

    this._appClientUIHost = new RealAppsEngineUIHost();
    this._manager = new AppClientManager(this._appClientUIHost);
    this.isLoaded = false;
    [this.deferredIsEnabled, this.setEnabled] = createDeferredValue();
  }

}

const Apps = new AppClientOrchestrator();
Meteor.startup(() => {
  CachedCollectionManager.onLogin(() => {
    Meteor.call('apps/is-enabled', (error, isEnabled) => {
      if (error) {
        Apps.handleError(error);
        return;
      }

      Apps.getAppClientManager().initialize();
      Apps.load(isEnabled);
    });
  });
  Tracker.autorun(() => {
    const isEnabled = settings.get('Apps_Framework_enabled');
    Apps.load(isEnabled);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"misc":{"Utilities.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/lib/misc/Utilities.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Utilities: () => Utilities
});

class Utilities {
  static getI18nKeyForApp(key, appId) {
    return key && "apps-".concat(appId, "-").concat(key);
  }

  static curl(_ref) {
    let {
      method,
      params,
      auth,
      headers = {},
      url,
      query,
      content
    } = _ref;
    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    const newLine = '\\\n   ';
    const cmd = ['curl']; // curl options

    if (opts.verbose) {
      cmd.push('-v');
    }

    if (opts.headers) {
      cmd.push('-i');
    } // method


    cmd.push('-X');
    cmd.push((method || 'GET').toUpperCase()); // URL

    let u = url;

    if (typeof params === 'object') {
      Object.entries(params).forEach(_ref2 => {
        let [key, value] = _ref2;
        u = u.replace(":".concat(key), value);
      });
    }

    if (typeof query === 'object') {
      const queryString = Object.entries(query).map(_ref3 => {
        let [key, value] = _ref3;
        return "".concat(key, "=").concat(value);
      }).join('&');
      u += "?".concat(queryString);
    }

    cmd.push(u); // username

    if (auth) {
      cmd.push(newLine);
      cmd.push('-u');
      cmd.push(auth);
    } // headers


    const headerKeys = [];
    Object.entries(headers).forEach(_ref4 => {
      let [key, val] = _ref4;
      key = key.toLowerCase();
      headerKeys.push(key);
      cmd.push(newLine);
      cmd.push('-H');
      cmd.push("\"".concat(key).concat(val ? ': ' : ';').concat(val || '', "\""));
    });

    if (content) {
      if (typeof content === 'object') {
        if (!headerKeys.includes('content-type')) {
          cmd.push(newLine);
          cmd.push('-H');
          cmd.push('"content-type: application/json"');
        }

        content = JSON.stringify(content);
      }

      cmd.push(newLine);
      cmd.push('--data-binary');
      cmd.push("'".concat(content, "'"));
    }

    return cmd.join(' ');
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}}},"chatpal-search":{"client":{"template":{"admin.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/admin.html                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.admin.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.admin.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/template.admin.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("ChatpalAdmin");
Template["ChatpalAdmin"] = new Template("Template.ChatpalAdmin", (function() {
  var view = this;
  return HTML.SECTION({
    class: "page-container page-list"
  }, "\n\t\t", HTML.HEADER({
    class: "rc-header"
  }, "\n\t\t\t", HTML.DIV({
    class: "rc-header__wrap"
  }, "\n\t\t\t\t", HTML.SPAN({
    class: "rc-header__block"
  }, "\n\t\t\t\t\t", Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_AdminPage");
  }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "content"
  }, "\n\t\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("isAdmin"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "You_are_not_authorized_to_view_this_page");
    })), "\n\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Chatpal_Get_more_information_about_chatpal_on_our_website"));
    })), "\n\t\t\t\t", HTML.FORM("\n\t\t\t\t\t", HTML.DIV({
      class: "rocket-form"
    }, "\n\t\t\t\t\t\t", HTML.FIELDSET("\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "input-line"
    }, "\n\t\t\t\t\t\t\t\t", HTML.LABEL(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Chatpal_Email_Address");
    })), HTML.Raw('\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<input class="rc-input__element" type="text" autocomplete="off" name="email">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "input-line"
    }, "\n\t\t\t\t\t\t\t\t", HTML.LABEL(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Chatpal_Terms_and_Conditions");
    })), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
      id: "chatpal-tac",
      class: "chatpal-tac rc-input__element"
    }, "\n\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:tac", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("tac")));
    }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "input-line"
    }, "\n\t\t\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t\t\t", HTML.LABEL(HTML.Raw('\n\t\t\t\t\t\t\t\t\t\t<input type="checkbox" name="readtac">\n\t\t\t\t\t\t\t\t\t\t'), Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Chatpal_TAC_read");
    }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
      class: "submit"
    }, "\n\t\t\t\t\t\t\t", HTML.BUTTON({
      class: "rc-button rc-button--primary send"
    }, HTML.SPAN(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Chatpal_create_key");
    }))), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("apiKey"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV({
        class: "apikey"
      }, HTML.Raw("\n\t\t\t\t\t\t<h2>Here is your Chatpal Api Key</h2>\n\t\t\t\t\t\t"), HTML.DIV({
        class: "key"
      }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:apiKey", function() {
        return Spacebars.mustache(view.lookup("apiKey"));
      }), "\n\t\t\t\t\t\t"), HTML.Raw('<!-- TODO copy to clipboard -->\n\t\t\t\t\t\t<p>Please copy the key and insert it in the key field of the Chatpal Provider in the <a href="./admin/Search">Search Admin Page</a>.</p>\n\t\t\t\t\t')), "\n\t\t\t\t" ];
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"result.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/result.html                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.result.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.result.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/template.result.js                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("ChatpalSearchResultTemplate");
Template["ChatpalSearchResultTemplate"] = new Template("Template.ChatpalSearchResultTemplate", (function() {
  var view = this;
  return HTML.DIV({
    class: "chatpal-search-container"
  }, "\n\t\t", HTML.UL({
    class: "chatpal-search-typefilter"
  }, "\n\t\t\t", HTML.LI({
    value: "All",
    class: function() {
      return Spacebars.mustache(view.lookup("navSelected"), "All");
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_All_Results");
  })), "\n\t\t\t", HTML.LI({
    value: "Room",
    class: function() {
      return Spacebars.mustache(view.lookup("navSelected"), "Room");
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_Current_Room_Only");
  })), "\n\t\t\t", HTML.LI({
    value: "Messages",
    class: function() {
      return Spacebars.mustache(view.lookup("navSelected"), "Messages");
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_Messages_Only");
  })), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "chatpal-search-result"
  }, "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("searching"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "chatpal_search-loader"
    }, "\n\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t"), "\n\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("result"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.P({
        class: "chatpal-search-welcome"
      }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Chatpal_Welcome");
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }), "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("$eq"), view.lookup("resultType"), "All");
    }, function() {
      return [ "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("result"), "user", "docs"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-header"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Chatpal_Users");
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-list"
        }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("result"), "user", "docs"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("ChatpalSearchSingleUser")), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("result"), "room", "docs"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-header"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Chatpal_Rooms");
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-list"
        }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("result"), "room", "docs"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("ChatpalSearchSingleRoom")), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("result"), "message", "docs"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-header"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Chatpal_Messages");
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-list"
        }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("result"), "message", "docs"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("ChatpalSearchSingleMessage")), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("moreMessagesThanDisplayed"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "chatpal-show-more-messages"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), "Chatpal_More");
          })), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t" ];
      }), "\n\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("$not"), view.lookup("resultsFoundForAllSearch"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-header"
        }, "\n\t\t\t\t\t\t\t", HTML.H2({
          class: "chatpal-search-number"
        }, "\n\t\t\t\t\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Chatpal_No_Results");
        })), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("resultMessagesOnly"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV({
        class: "chatpal-search-result-header"
      }, "\n\t\t\t\t\t\t", HTML.H2({
        class: "chatpal-search-number"
      }, "\n\t\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("resultNumFound"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:resultNumFound", function() {
          return Spacebars.mustache(view.lookup("resultNumFound"));
        }), "\n\t\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("result"), "message"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-list"
        }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("result"), "message", "docs"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("ChatpalSearchSingleMessage")), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("resultPaging"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.dataMustache(view.lookup("$neq"), Spacebars.dot(view.lookup("resultPaging"), "numOfPages"), 0);
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "chatpal-paging"
          }, "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("$gt"), Spacebars.dot(view.lookup("resultPaging"), "currentPage"), 1);
          }, function() {
            return HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="chatpal-paging-prev chatpal-paging-button">\n\t\t\t\t\t\t\t\t\t\t<i class="icon-left-circled2"></i>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t');
          }), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "chatpal-paging-text"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), "Chatpal_search_page_of", Spacebars.dot(view.lookup("resultPaging"), "currentPage"), Spacebars.dot(view.lookup("resultPaging"), "numOfPages"));
          })), "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("$lt"), Spacebars.dot(view.lookup("resultPaging"), "currentPage"), Spacebars.dot(view.lookup("resultPaging"), "numOfPages"));
          }, function() {
            return HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="chatpal-paging-next chatpal-paging-button">\n\t\t\t\t\t\t\t\t\t\t<i class="icon-right-circled2"></i>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t');
          }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

Template.__checkName("ChatpalSearchSingleMessage");
Template["ChatpalSearchSingleMessage"] = new Template("Template.ChatpalSearchSingleMessage", (function() {
  var view = this;
  return HTML.DIV({
    class: "chatpal-search-result-single"
  }, "\n\t\t", HTML.H2("\n\t\t\t", HTML.SPAN({
    class: "chatpal-channel"
  }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call(view.lookup("roomIcon"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t\t\t\t", Blaze.View("lookup:roomName", function() {
    return Spacebars.mustache(view.lookup("roomName"));
  })), "\n\t\t\t", HTML.A({
    class: "chatpal-link",
    href: function() {
      return [ Spacebars.mustache(view.lookup("roomLink")), "?msg=", Spacebars.mustache(view.lookup("_id")) ];
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_go_to_message");
  })), "\n\t\t\t", HTML.SPAN({
    class: "chatpal-date"
  }, Blaze.View("lookup:date", function() {
    return Spacebars.mustache(view.lookup("date"));
  })), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "chatpal-avatar"
  }, "\n\t\t\t", HTML.DIV({
    class: "chatpal-avatar-image",
    style: function() {
      return [ "background-image:url(", Spacebars.mustache(view.lookup("getAvatarUrl"), view.lookup("username")), ");" ];
    }
  }), "\n\t\t"), "\n\t\t", HTML.SPAN({
    class: "chatpal-name"
  }, Blaze.View("lookup:username", function() {
    return Spacebars.mustache(view.lookup("username"));
  })), "\n\t\t", HTML.SPAN({
    class: "chatpal-time"
  }, Blaze.View("lookup:time", function() {
    return Spacebars.mustache(view.lookup("time"));
  })), "\n\t\t", HTML.DIV({
    class: "chatpal-message"
  }, Blaze.View("lookup:text", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("text")));
  })), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("roomNotSubscribed"));
  }, function() {
    return [ "\n\t\t\t", HTML.DIV({
      class: "chatpal-info color-info-font-color"
    }, HTML.I(Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Chatpal_channel_not_joined_yet"));
    }))), "\n\t\t" ];
  }), "\n\t");
}));

Template.__checkName("ChatpalSearchSingleUser");
Template["ChatpalSearchSingleUser"] = new Template("Template.ChatpalSearchSingleUser", (function() {
  var view = this;
  return HTML.DIV({
    class: "chatpal-search-result-user"
  }, "\n\t\t", HTML.DIV({
    class: "chatpal-avatar"
  }, "\n\t\t\t", HTML.DIV({
    class: "chatpal-avatar-image",
    style: function() {
      return [ "background-image:url(", Spacebars.mustache(view.lookup("getAvatarUrl"), view.lookup("cleanUsername")), ");" ];
    }
  }), "\n\t\t"), "\n\t\t", HTML.H2(Blaze.View("lookup:user_name", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("user_name")));
  })), "\n\t\t", HTML.DIV({
    class: "direct-message"
  }, "\n\t\t\t", HTML.A({
    href: function() {
      return Spacebars.mustache(view.lookup("getDMUrl"), view.lookup("cleanUsername"));
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_go_to_user");
  })), "\n\t\t"), "\n\t");
}));

Template.__checkName("ChatpalSearchSingleRoom");
Template["ChatpalSearchSingleRoom"] = new Template("Template.ChatpalSearchSingleRoom", (function() {
  var view = this;
  return HTML.DIV({
    class: "chatpal-search-result-user chatpal-search-result-room"
  }, "\n\t\t", HTML.H2("\n\t\t\t", HTML.SPAN({
    class: "chatpal-channel"
  }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call(view.lookup("roomIcon"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t\t\t\t", Blaze.View("lookup:room_name", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("room_name")));
  })), "\n\t\t\t", HTML.A({
    class: "chatpal-link",
    href: function() {
      return Spacebars.mustache(view.lookup("roomLink"));
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_go_to_room");
  })), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "chatpal-search-pills"
  }, "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("room_topic"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "chatpal-search-pills-topic"
    }, Blaze.View("lookup:room_topic", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("room_topic")));
    })), "\n\t\t\t" ];
  }), "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("room_description"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "chatpal-search-pills-description"
    }, Blaze.View("lookup:room_description", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("room_description")));
    })), "\n\t\t\t" ];
  }), "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("room_announcement"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "chatpal-search-pills-announcement"
    }, Blaze.View("lookup:room_announcement", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("room_announcement")));
    })), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("roomNotSubscribed"));
  }, function() {
    return [ "\n\t\t\t", HTML.DIV({
      class: "chatpal-info color-info-font-color"
    }, HTML.I(Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Chatpal_channel_not_joined_yet"));
    }))), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"suggestion.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/suggestion.html                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.suggestion.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.suggestion.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/template.suggestion.js                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("ChatpalSuggestionItemTemplate");
Template["ChatpalSuggestionItemTemplate"] = new Template("Template.ChatpalSuggestionItemTemplate", (function() {
  var view = this;
  return HTML.DIV({
    class: "chatpal-suggestion"
  }, "\n\t\t", HTML.SPAN({
    class: "chatpal-suggestion-text"
  }, Blaze.View("lookup:text", function() {
    return Spacebars.mustache(view.lookup("text"));
  })), "\n\t\t", HTML.SPAN({
    class: "chatpal-suggestion-hint"
  }, "\n\t\t\t", Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_run_search");
  }), "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call("chatpal-enter")
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"admin.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/admin.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 3);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 4);
let hasRole;
module.link("../../../authorization", {
  hasRole(v) {
    hasRole = v;
  }

}, 5);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 6);
let validateEmail;
module.link("../../../../lib/emailValidator", {
  validateEmail(v) {
    validateEmail = v;
  }

}, 7);
Template.ChatpalAdmin.onCreated(function () {
  this.validateEmail = validateEmail;
  this.apiKey = new ReactiveVar();
  const lang = settings.get('Language');
  this.lang = lang === 'de' || lang === 'en' ? lang : 'en';
  this.tac = new ReactiveVar();
  Meteor.call('chatpalUtilsGetTaC', this.lang, (err, data) => {
    this.tac.set(data);
  });
});
Template.ChatpalAdmin.events({
  'submit form'(e, t) {
    e.preventDefault();
    const email = e.target.email.value;
    const tac = e.target.readtac.checked;

    if (!tac) {
      return dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('Chatpal_ERROR_TAC_must_be_checked')
      });
    }

    if (!email || email === '') {
      return dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('Chatpal_ERROR_Email_must_be_set')
      });
    }

    if (!t.validateEmail(email)) {
      return dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('Chatpal_ERROR_Email_must_be_valid')
      });
    } // TODO register


    try {
      Meteor.call('chatpalUtilsCreateKey', email, (err, key) => {
        if (!key) {
          return dispatchToastMessage({
            type: 'error',
            message: TAPi18n.__('Chatpal_ERROR_username_already_exists')
          });
        }

        dispatchToastMessage({
          type: 'info',
          message: TAPi18n.__('Chatpal_created_key_successfully')
        });
        t.apiKey.set(key);
      });
    } catch (e) {
      console.log(e);
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('Chatpal_ERROR_username_already_exists')
      }); // TODO error messages
    }
  }

}); // template

Template.ChatpalAdmin.helpers({
  apiKey() {
    return Template.instance().apiKey.get();
  },

  isAdmin() {
    return hasRole(Meteor.userId(), 'admin');
  },

  tac() {
    return Template.instance().tac.get();
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"result.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/result.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 2);
let roomTypes, getURL;
module.link("../../../utils", {
  roomTypes(v) {
    roomTypes = v;
  },

  getURL(v) {
    getURL = v;
  }

}, 3);
let Subscriptions;
module.link("../../../models", {
  Subscriptions(v) {
    Subscriptions = v;
  }

}, 4);
let getAvatarUrl;
module.link("../../../utils/lib/getUserAvatarURL", {
  getUserAvatarURL(v) {
    getAvatarUrl = v;
  }

}, 5);
let formatTime;
module.link("../../../../client/lib/utils/formatTime", {
  formatTime(v) {
    formatTime = v;
  }

}, 6);
let formatDate;
module.link("../../../../client/lib/utils/formatDate", {
  formatDate(v) {
    formatDate = v;
  }

}, 7);

const getDMUrl = username => getURL("/direct/".concat(username));

Template.ChatpalSearchResultTemplate.onCreated(function () {
  this.badRequest = new ReactiveVar(false);
  this.resultType = new ReactiveVar(this.data.settings.DefaultResultType);
  this.data.parentPayload.resultType = this.resultType.get();
});
Template.ChatpalSearchResultTemplate.events = {
  'click .chatpal-search-typefilter li'(evt, t) {
    t.data.parentPayload.resultType = evt.currentTarget.getAttribute('value');
    t.data.payload.start = 0;
    t.resultType.set(t.data.parentPayload.resultType);
    t.data.search();
  },

  'click .chatpal-paging-prev'(env, t) {
    t.data.payload.start -= t.data.settings.PageSize;
    t.data.search();
  },

  'click .chatpal-paging-next'(env, t) {
    t.data.payload.start = (t.data.payload.start || 0) + t.data.settings.PageSize;
    t.data.search();
  },

  'click .chatpal-show-more-messages'(evt, t) {
    t.data.parentPayload.resultType = 'Messages';
    t.data.payload.start = 0;
    t.data.payload.rows = t.data.settings.PageSize;
    t.resultType.set(t.data.parentPayload.resultType);
    t.data.search();
  }

};
Template.ChatpalSearchResultTemplate.helpers({
  result() {
    return Template.instance().data.result.get();
  },

  searching() {
    return Template.instance().data.searching.get();
  },

  resultType() {
    return Template.instance().resultType.get();
  },

  navSelected(type) {
    return Template.instance().resultType.get() === type ? 'selected' : '';
  },

  resultsFoundForAllSearch() {
    const result = Template.instance().data.result.get();

    if (!result) {
      return true;
    }

    return result.message.numFound > 0 || result.user.numFound > 0 || result.room.numFound > 0;
  },

  moreMessagesThanDisplayed() {
    const result = Template.instance().data.result.get();
    return result.message.docs.length < result.message.numFound;
  },

  resultNumFound() {
    const result = Template.instance().data.result.get();

    if (result) {
      switch (result.message.numFound) {
        case 0:
          return TAPi18n.__('Chatpal_no_search_results');

        case 1:
          return TAPi18n.__('Chatpal_one_search_result');

        default:
          return TAPi18n.__('Chatpal_search_results', result.message.numFound);
      }
    }
  },

  resultMessagesOnly() {
    return Template.instance().resultType.get() === 'Messages' || Template.instance().resultType.get() === 'Room';
  },

  resultPaging() {
    const result = Template.instance().data.result.get();
    const pageSize = Template.instance().data.settings.PageSize;

    if (result) {
      return {
        currentPage: 1 + result.message.start / pageSize,
        numOfPages: Math.ceil(result.message.numFound / pageSize)
      };
    }
  }

});
Template.ChatpalSearchSingleMessage.helpers({
  roomIcon() {
    const room = this.r;

    if (room && room.t === 'd') {
      return 'at';
    }

    return roomTypes.getIcon(room);
  },

  roomLink() {
    return roomTypes.getRouteLink(this.r.t, this.r);
  },

  roomName() {
    return roomTypes.getRoomName(this.r.t, this.r);
  },

  roomNotSubscribed() {
    const subscription = Subscriptions.findOne({
      rid: this.rid
    });
    return typeof subscription === 'undefined';
  },

  time() {
    return formatTime(this.created);
  },

  date() {
    return formatDate(this.created);
  },

  getAvatarUrl
});
Template.ChatpalSearchSingleRoom.helpers({
  roomIcon() {
    if (this.t === 'd') {
      return 'at';
    }

    return roomTypes.getIcon(this);
  },

  roomLink() {
    return roomTypes.getRouteLink(this.t, this);
  },

  roomNotSubscribed() {
    const subscription = Subscriptions.findOne({
      rid: this.rid
    });
    return typeof subscription === 'undefined';
  }

});
Template.ChatpalSearchSingleUser.helpers({
  cleanUsername() {
    const username = this.user_username || this.username; // varies whether users or messages of users are displayed

    return username.replace(/<\/?em>/gi, '');
  },

  getAvatarUrl,
  getDMUrl
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"suggestion.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/suggestion.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
Template.ChatpalSuggestionItemTemplate.onCreated(function () {
  if (this.data.type === 'link') {
    this.data.action = () => {
      console.log('an example for an external link');
    };
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/index.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template/admin.html");
module.link("./template/result.html");
module.link("./template/suggestion.html");
module.link("./template/admin");
module.link("./template/result");
module.link("./template/suggestion");
module.link("./style.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"style.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/style.css                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"livestream":{"client":{"views":{"broadcastView.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/broadcastView.html                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.broadcastView.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.broadcastView.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/template.broadcastView.js                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("broadcastView");
Template["broadcastView"] = new Template("Template.broadcastView", (function() {
  var view = this;
  return HTML.DIV({
    class: "streaming-popup"
  }, "\n    ", HTML.VIDEO({
    id: "player",
    src: function() {
      return Spacebars.mustache(view.lookup("broadcastSource"));
    },
    muted: "",
    autoplay: "",
    width: "380px"
  }), "\n  ");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"liveStreamTab.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/liveStreamTab.html                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.liveStreamTab.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.liveStreamTab.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/template.liveStreamTab.js                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("liveStreamTab");
Template["liveStreamTab"] = new Template("Template.liveStreamTab", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(view.lookup("hasSource"));
  }, function() {
    return [ "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isPopoutOpen"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("canDock"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          type: "button",
          class: "rc-button rc-button--primary js-close button-block",
          title: function() {
            return Spacebars.mustache(view.lookup("_"), "Livestream_close");
          }
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Livestream_close");
        })), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          type: "button",
          class: "rc-button rc-button--primary js-close button-block",
          title: function() {
            return Spacebars.mustache(view.lookup("_"), "Livestream_switch_to_room");
          }
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Livestream_switch_to_room");
        })), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("hasThumbnail"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "thumbnail-container",
          style: function() {
            return [ "background: url(", Spacebars.mustache(view.lookup("thumbnailUrl")), ") 100% no-repeat no-repeat;" ];
          }
        }, "\n\t\t\t\t\t\t", HTML.A({
          href: "#",
          class: "js-popout popout--absolute-center"
        }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            icon: Spacebars.call("play-solid"),
            block: Spacebars.call("popout")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.A({
          href: "#",
          class: "js-popout popout--absolute-center"
        }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            icon: Spacebars.call("play-solid"),
            block: Spacebars.call("popout")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t ", HTML.P(" ", Blaze.View("lookup:streamingUnavailableMessage", function() {
      return Spacebars.mustache(view.lookup("streamingUnavailableMessage"));
    }), " "), "\n\t\t" ];
  }), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("canEdit"));
  }, function() {
    return [ "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("editing"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("broadcastEnabled"));
      }, function() {
        return [ "\n\t\t\t\t\t", Spacebars.include(view.lookupTemplate("liveStreamBroadcast")), "\n\t\t\t\t" ];
      }), "\n\t\t\t\t", HTML.FORM({
        class: "liveStreamTab__form"
      }, "\n\t\t\t\t\t", HTML.LABEL({
        class: "rc-input__label"
      }, HTML.Raw("\n\t\t\t\t\t\t<p> Livestream not available message: </p>\n\t\t\t\t\t\t"), HTML.INPUT({
        type: "text",
        name: "streaming-message",
        class: "rc-input__element content-background-color editing",
        placeholder: function() {
          return Spacebars.mustache(view.lookup("_"), "Livestream_not_found");
        },
        value: function() {
          return Spacebars.mustache(view.lookup("streamingUnavailableMessage"));
        }
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.LABEL({
        class: "rc-input__label"
      }, HTML.Raw("\n\t\t\t\t\t\t<p> Livestream source (URL): </p>\n\t\t\t\t\t\t"), HTML.INPUT({
        type: "text",
        name: "streaming-source",
        class: "rc-input__element content-background-color editing",
        placeholder: function() {
          return Spacebars.mustache(view.lookup("_"), "Livestream_url");
        },
        value: function() {
          return Spacebars.mustache(view.lookup("streamingSource"));
        }
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
        class: "rc-switch"
      }, "\n\t\t\t\t\t\t", HTML.LABEL({
        class: "rc-switch__label",
        tabindex: "-1"
      }, "\n\t\t\t\t\t\t\t", HTML.INPUT({
        type: "checkbox",
        class: "rc-switch__input",
        name: "streaming-audio-only",
        checked: function() {
          return Spacebars.mustache(view.lookup("isAudioOnly"));
        }
      }), HTML.Raw('\n\t\t\t\t\t\t\t<span class="rc-switch__button">\n\t\t\t\t\t\t\t<span class="rc-switch__button-inside"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t'), HTML.SPAN({
        class: "rc-switch__text"
      }, "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Livestream_enable_audio_only");
      }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "rc-switch__description"
      }, Blaze.View("lookup:typeDescription", function() {
        return Spacebars.mustache(view.lookup("typeDescription"));
      })), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
        class: "rc-user-info__flex"
      }, "\n\t\t\t\t\t\t", HTML.BUTTON({
        type: "button",
        class: "rc-button rc-button--nude js-cancel button-block",
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Cancel");
        }
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Cancel");
      })), "\n\t\t\t\t\t\t", HTML.BUTTON({
        type: "button",
        class: "rc-button rc-button--submit js-clear button-block",
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Clear");
        }
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Clear");
      })), "\n\t\t\t\t\t\t", HTML.BUTTON({
        type: "button",
        class: "rc-button rc-button--primary js-save button-block",
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Save");
        }
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Save");
      })), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: "setting-block livestream--url"
      }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("permalink")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t\t", HTML.A({
        href: "#",
        class: "current-setting streaming-source-settings"
      }, " ", Blaze.View("lookup:streamingSource", function() {
        return Spacebars.mustache(view.lookup("streamingSource"));
      }), " "), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"liveStreamView.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/liveStreamView.html                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.liveStreamView.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.liveStreamView.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/template.liveStreamView.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("liveStreamView");
Template["liveStreamView"] = new Template("Template.liveStreamView", (function() {
  var view = this;
  return HTML.Raw('<div class="streaming-popup">\n    <div id="ytplayer"></div>\n  </div>');
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"livestreamBroadcast.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/livestreamBroadcast.html                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.livestreamBroadcast.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.livestreamBroadcast.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/template.livestreamBroadcast.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("liveStreamBroadcast");
Template["liveStreamBroadcast"] = new Template("Template.liveStreamBroadcast", (function() {
  var view = this;
  return HTML.Raw('<button type="button" class="rc-button rc-button--stack rc-button--primary js-broadcast"> Broadcast my Camera </button>');
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"broadcastView.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/broadcastView.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  call: () => call
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 2);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 3);
let handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 4);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 5);

const getMedia = () => navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;

const createAndConnect = url => {
  if (!('WebSocket' in window)) {
    // eslint-disable-line no-negated-in-lhs
    return false;
  }

  const ws = new WebSocket(url);

  ws.onerror = evt => console.error("Error: ".concat(evt.data));

  return ws;
};

const sendMessageToWebSocket = (message, ws) => {
  if (ws != null) {
    if (ws.readyState === 1) {
      ws.send(message);
    }
  }
};

const call = function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  return new Promise(function (resolve, reject) {
    Meteor.call(...args, function (err, result) {
      if (err) {
        handleError(err);
        reject(err);
      }

      resolve(result);
    });
  });
};

const delay = time => new Promise(resolve => setTimeout(resolve, time));

const waitForStreamStatus = async (id, status) => {
  const streamActive = new Promise(async resolve => {
    // eslint-disable-next-line no-constant-condition
    while (true) {
      const currentStatus = await call('livestreamStreamStatus', {
        streamId: id
      }); // eslint-disable-line no-await-in-loop

      if (currentStatus === status) {
        return resolve(status);
      }

      await delay(1500); // eslint-disable-line no-await-in-loop
    }
  });
  await streamActive;
};

const waitForBroadcastStatus = async (id, status) => {
  const broadcastActive = new Promise(async resolve => {
    // eslint-disable-next-line no-constant-condition
    while (true) {
      const currentStatus = await call('getBroadcastStatus', {
        broadcastId: id
      }); // eslint-disable-line no-await-in-loop

      if (currentStatus === status) {
        return resolve(status);
      }

      await delay(1500); // eslint-disable-line no-await-in-loop
    }
  });
  await broadcastActive;
};

Template.broadcastView.helpers({
  broadcastSource() {
    return Template.instance().mediaStream.get() ? window.URL.createObjectURL(Template.instance().mediaStream.get()) : '';
  },

  mediaRecorder() {
    Template.instance().mediaRecorder.get();
  }

});
Template.broadcastView.onCreated(async function () {
  const connection = createAndConnect("".concat(settings.get('Broadcasting_media_server_url'), "/").concat(this.data.id));
  this.mediaStream = new ReactiveVar(null);
  this.mediaRecorder = new ReactiveVar(null);
  this.connection = new ReactiveVar(connection);
});
Template.broadcastView.onDestroyed(function () {
  if (this.connection.get()) {
    this.connection.get().close();
  }

  if (this.mediaRecorder.get()) {
    this.mediaRecorder.get().stop();
    this.mediaRecorder.set(null);
  }

  if (this.mediaStream.get()) {
    this.mediaStream.get().getTracks().map(track => track.stop());
    this.mediaStream.set(null);
  }
});
Template.broadcastView.onRendered(async function () {
  navigator.getMedia = getMedia();

  if (!navigator.getMedia) {
    return alert('getUserMedia() is not supported in your browser!');
  }

  const localMediaStream = await new Promise((resolve, reject) => navigator.getMedia({
    video: true,
    audio: true
  }, resolve, reject));
  const connection = this.connection.get();
  this.mediaStream.set(localMediaStream);
  let options = {
    mimeType: 'video/webm;codecs=vp9'
  };

  if (!MediaRecorder.isTypeSupported(options.mimeType)) {
    options = {
      mimeType: 'video/webm;codecs=vp8'
    };

    if (!MediaRecorder.isTypeSupported(options.mimeType)) {
      options = {
        mimeType: 'video/webm'
      };

      if (!MediaRecorder.isTypeSupported(options.mimeType)) {
        options = {
          mimeType: ''
        };
      }
    }
  }

  try {
    const mediaRecorder = new MediaRecorder(localMediaStream, options);

    mediaRecorder.ondataavailable = event => {
      if (!(event.data || event.data.size > 0)) {
        return;
      }

      sendMessageToWebSocket(event.data, connection);
    };

    mediaRecorder.start(100); // collect 100ms of data

    this.mediaRecorder.set(mediaRecorder);
    await waitForStreamStatus(this.data.stream.id, 'active');
    await call('setLivestreamStatus', {
      broadcastId: this.data.broadcast.id,
      status: 'testing'
    });
    await waitForBroadcastStatus(this.data.broadcast.id, 'testing');
    document.querySelector('.streaming-popup').dispatchEvent(new Event('broadcastStreamReady'));
  } catch (e) {
    console.log(e);
  }
});
Template.broadcastView.events({
  async 'startStreaming .streaming-popup'(e, i) {
    await call('setLivestreamStatus', {
      broadcastId: i.data.broadcast.id,
      status: 'live'
    });
    document.querySelector('.streaming-popup').dispatchEvent(new Event('broadcastStream'));
    await call('saveRoomSettings', Session.get('openedRoom'), 'streamingOptions', {
      id: i.data.broadcast.id,
      url: "https://www.youtube.com/embed/".concat(i.data.broadcast.id),
      thumbnail: "https://img.youtube.com/vi/".concat(i.data.broadcast.id, "/0.jpg")
    });
  },

  async 'stopStreaming .streaming-popup'(e, i) {
    await call('setBroadcastStatus', {
      broadcastId: i.data.broadcast.id,
      status: 'complete'
    });
    await call('saveRoomSettings', Session.get('openedRoom'), 'streamingOptions', {}, err => {
      if (err) {
        return handleError(err);
      }

      i.editing.set(false);
      i.streamingOptions.set({});
    });

    if (i.mediaRecorder.get()) {
      i.mediaRecorder.get().stop();
      i.mediaRecorder.set(null);
    }

    if (i.mediaStream.get()) {
      i.mediaStream.get().getTracks().map(track => track.stop());
      i.mediaStream.set(null);
    }
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"liveStreamTab.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/liveStreamTab.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  call: () => call,
  close: () => close
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 2);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 3);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 4);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 5);
let auth;
module.link("../oauth.js", {
  auth(v) {
    auth = v;
  }

}, 6);
let RocketChatAnnouncement;
module.link("../../../lib", {
  RocketChatAnnouncement(v) {
    RocketChatAnnouncement = v;
  }

}, 7);
let popout;
module.link("../../../ui-utils", {
  popout(v) {
    popout = v;
  }

}, 8);
let t;
module.link("../../../utils", {
  t(v) {
    t = v;
  }

}, 9);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 10);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 11);
let hasAllPermission;
module.link("../../../authorization", {
  hasAllPermission(v) {
    hasAllPermission = v;
  }

}, 12);
let Users, Rooms;
module.link("../../../models", {
  Users(v) {
    Users = v;
  },

  Rooms(v) {
    Rooms = v;
  }

}, 13);
let handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 14);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 15);

const call = function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  return new Promise(function (resolve, reject) {
    Meteor.call(...args, function (err, result) {
      if (err) {
        handleError(err);
        reject(err);
      }

      resolve(result);
    });
  });
};

const close = popup => new Promise(function (resolve) {
  const checkInterval = setInterval(() => {
    if (popup.closed) {
      clearInterval(checkInterval);
      resolve();
    }
  }, 300);
});

function optionsFromUrl(url) {
  const options = {};
  const parsedUrl = url.match(/(http:|https:|)\/\/(www.)?(youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/|embed\?clip=)?([A-Za-z0-9._%-]*)(\&\S+)?/);
  options.url = url;

  if (parsedUrl != null) {
    options.id = parsedUrl[6];

    if (parsedUrl[3].includes('youtu')) {
      options.url = "https://www.youtube.com/embed/".concat(parsedUrl[6]);
      options.thumbnail = "https://img.youtube.com/vi/".concat(parsedUrl[6], "/0.jpg");
    } // @TODO add support for other urls

  }

  return options;
}

Template.liveStreamTab.helpers({
  broadcastEnabled() {
    return !!settings.get('Broadcasting_enabled');
  },

  streamingSource() {
    return Template.instance().streamingOptions.get() ? Template.instance().streamingOptions.get().url : '';
  },

  streamingUnavailableMessage() {
    return Template.instance().streamingOptions.get() && Template.instance().streamingOptions.get().message && Template.instance().streamingOptions.get().message !== '' ? Template.instance().streamingOptions.get().message : t('Livestream_not_found');
  },

  thumbnailUrl() {
    return Template.instance().streamingOptions.get() ? Template.instance().streamingOptions.get().thumbnail : '';
  },

  hasThumbnail() {
    return !!Template.instance().streamingOptions.get() && !!Template.instance().streamingOptions.get().thumbnail && Template.instance().streamingOptions.get().thumbnail !== '';
  },

  hasSource() {
    return !!Template.instance().streamingOptions.get() && !!Template.instance().streamingOptions.get().url && Template.instance().streamingOptions.get().url !== '';
  },

  canEdit() {
    return hasAllPermission('edit-room', this.rid);
  },

  editing() {
    return Template.instance().editing.get() || Template.instance().streamingOptions.get() == null || Template.instance().streamingOptions.get() != null && (Template.instance().streamingOptions.get().url == null || Template.instance().streamingOptions.get().url === '');
  },

  canDock() {
    const livestreamTabSource = Template.instance().streamingOptions.get().url;
    let popoutSource = null;

    try {
      if (popout.context) {
        popoutSource = Blaze.getData(popout.context).data && Blaze.getData(popout.context).data.streamingSource;
      }

      if (popoutSource != null && livestreamTabSource === popoutSource) {
        return true;
      }
    } catch (e) {
      return false;
    }

    return false;
  },

  isPopoutOpen() {
    return Template.instance().popoutOpen.get();
  },

  isAudioOnly() {
    return Template.instance().streamingOptions.get() ? Template.instance().streamingOptions.get().isAudioOnly : false;
  }

});
Template.liveStreamTab.onCreated(function () {
  this.editing = new ReactiveVar(false);
  this.streamingOptions = new ReactiveVar();
  this.popoutOpen = new ReactiveVar(popout.context != null);
  this.autorun(() => {
    const room = Rooms.findOne(this.data.rid, {
      fields: {
        streamingOptions: 1
      }
    });
    this.streamingOptions.set(room.streamingOptions);
  });
});
Template.liveStreamTab.onDestroyed(function () {
  if (popout.docked) {
    popout.close();
  }
});
Template.liveStreamTab.events({
  'click .js-cancel'(e, i) {
    e.preventDefault();
    i.editing.set(false);
  },

  'click .js-clear'(e, i) {
    e.preventDefault();
    const clearedObject = {};
    Meteor.call('saveRoomSettings', this.rid, 'streamingOptions', clearedObject, function (err) {
      if (err) {
        return handleError(err);
      }

      i.editing.set(false);
      i.streamingOptions.set(clearedObject);
      const roomAnnouncement = new RocketChatAnnouncement().getByRoom(i.data.rid);

      if (roomAnnouncement.getMessage() !== '') {
        roomAnnouncement.clear();
      }

      return dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Livestream_source_changed_succesfully')
      });
    });
  },

  'click .js-save'(e, i) {
    e.preventDefault();

    const streamingOptions = _objectSpread(_objectSpread({}, optionsFromUrl(i.find('[name=streaming-source]').value)), {}, {
      isAudioOnly: i.find('[name=streaming-audio-only]').checked,
      message: i.find('[name=streaming-message]').value,
      type: 'livestream'
    });

    Meteor.call('saveRoomSettings', this.rid, 'streamingOptions', streamingOptions, function (err) {
      if (err) {
        return handleError(err);
      }

      i.editing.set(false);
      i.streamingOptions.set(streamingOptions);

      if (streamingOptions.url !== '') {
        new RocketChatAnnouncement({
          room: i.data.rid,
          message: 'Broadcast is now live. Click here to watch!',
          callback: 'openBroadcast'
        }).save();
      } else {
        const roomAnnouncement = new RocketChatAnnouncement().getByRoom(i.data.rid);

        if (roomAnnouncement.getMessage() !== '') {
          roomAnnouncement.clear();
        }
      }

      return dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Livestream_source_changed_succesfully')
      });
    });
  },

  'click .streaming-source-settings'(e, i) {
    e.preventDefault();
    i.editing.set(true);
  },

  'click .js-dock'(e) {
    e.stopPropagation();
    popout.docked = true;
  },

  'click .js-close'(e, i) {
    e.stopPropagation();
    let popoutSource = '';

    if (popout.context) {
      popoutSource = Blaze.getData(popout.context).data && Blaze.getData(popout.context).data.streamingSource;
    }

    popout.close();

    if (popoutSource !== Template.instance().streamingOptions.get().url) {
      popout.open({
        content: 'liveStreamView',
        data: {
          streamingSource: i.streamingOptions.get().url,
          isAudioOnly: i.streamingOptions.get().isAudioOnly,
          showVideoControls: true,
          streamingOptions: i.streamingOptions.get()
        },
        onCloseCallback: () => i.popoutOpen.set(false)
      });
    }
  },

  'submit .liveStreamTab__form'(e, i) {
    e.preventDefault();
    e.stopPropagation();

    const streamingOptions = _objectSpread(_objectSpread({}, optionsFromUrl(i.find('[name=streaming-source]').value)), {}, {
      isAudioOnly: i.find('[name=streaming-audio-only]').checked,
      message: i.find('[name=streaming-message]').value,
      type: 'livestream'
    });

    Meteor.call('saveRoomSettings', this.rid, 'streamingOptions', streamingOptions, function (err) {
      if (err) {
        return handleError(err);
      }

      i.editing.set(false);
      i.streamingOptions.set(streamingOptions);

      if (streamingOptions.url !== '') {
        new RocketChatAnnouncement({
          room: i.data.rid,
          message: 'Broadcast is now live. Click here to watch!',
          callback: 'openBroadcast'
        }).save();
      } else {
        const roomAnnouncement = new RocketChatAnnouncement().getByRoom(i.data.rid);

        if (roomAnnouncement.getMessage() !== '') {
          roomAnnouncement.clear();
        }
      }

      return dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Livestream_source_changed_succesfully')
      });
    });
  },

  'click .js-popout'(e, i) {
    e.preventDefault();
    popout.open({
      content: 'liveStreamView',
      data: {
        streamingSource: i.streamingOptions.get().url,
        isAudioOnly: i.streamingOptions.get().isAudioOnly,
        showVideoControls: true,
        streamingOptions: i.streamingOptions.get()
      },
      onCloseCallback: () => i.popoutOpen.set(false)
    });
    i.popoutOpen.set(true);
  },

  async 'click .js-broadcast'(e, i) {
    e.preventDefault();
    e.currentTarget.classList.add('loading');

    try {
      const user = Users.findOne({
        _id: Meteor.userId()
      }, {
        fields: {
          'settings.livestream': 1
        }
      });

      if (!user.settings || !user.settings.livestream) {
        await auth();
      }

      const result = await call('livestreamGet', {
        rid: i.data.rid
      });
      popout.open({
        content: 'broadcastView',
        data: _objectSpread(_objectSpread({}, result), {}, {
          showVideoControls: false,
          showStreamControls: true
        }),
        onCloseCallback: () => i.popoutOpen.set(false)
      });
    } catch (e) {
      console.log(e);
    } finally {
      e.currentTarget.classList.remove('loading');
    }
  }

});
callbacks.add('openBroadcast', rid => {
  const roomData = Session.get("roomData".concat(rid));

  if (!roomData) {
    return;
  }

  popout.open({
    content: 'liveStreamView',
    data: {
      streamingSource: roomData.streamingOptions.url,
      isAudioOnly: roomData.streamingOptions.isAudioOnly,
      showVideoControls: true,
      streamingOptions: roomData.streamingOptions
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"liveStreamView.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/liveStreamView.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);

this.onYouTubePlayerAPIReady = function () {
  const playerReadyEvent = new Event('playerReady');
  document.querySelector('.streaming-popup').dispatchEvent(playerReadyEvent);
};

this.liveStreamPlayer = null;
Template.liveStreamView.onCreated(function () {
  this.streamingOptions = new ReactiveVar(this.data.streamingOptions);
});
Template.liveStreamView.onRendered(function () {
  if (window.YT) {
    window.liveStreamPlayer = new window.YT.Player('ytplayer', {
      width: '380',
      height: '214',
      videoId: this.data.streamingOptions.id || '',
      playerVars: {
        autoplay: 1,
        controls: 0,
        showinfo: 0,
        enablejsapi: 1,
        fs: 0,
        modestbranding: 1,
        rel: 0
      },
      events: {
        onStateChange: e => {
          const playerStateChangedEvent = new CustomEvent('playerStateChanged', {
            detail: e.data
          });
          document.querySelector('.rc-popout').dispatchEvent(playerStateChangedEvent);
        }
      }
    });
  } else {
    const tag = document.createElement('script');
    tag.src = 'https://www.youtube.com/player_api';
    tag.type = 'text/javascript';
    const firstScriptTag = document.body.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
  }
});
Template.liveStreamView.events({
  'playerReady .streaming-popup'(e, i) {
    window.liveStreamPlayer = new window.YT.Player('ytplayer', {
      width: '380',
      height: '214',
      videoId: i.streamingOptions.get().id || '',
      playerVars: {
        autoplay: 1,
        controls: 0,
        showinfo: 0,
        enablejsapi: 1,
        fs: 0,
        modestbranding: 1,
        rel: 0
      },
      events: {
        onStateChange: e => {
          const playerStateChangedEvent = new CustomEvent('playerStateChanged', {
            detail: e.data
          });
          document.querySelector('.rc-popout').dispatchEvent(playerStateChangedEvent);
        }
      }
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"livestreamBroadcast.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/livestreamBroadcast.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"styles":{"liveStreamTab.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/styles/liveStreamTab.css                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./views/liveStreamTab.html");
module.link("./views/liveStreamTab");
module.link("./views/livestreamBroadcast.html");
module.link("./views/livestreamBroadcast");
module.link("./views/broadcastView.html");
module.link("./views/broadcastView");
module.link("./views/liveStreamView.html");
module.link("./views/liveStreamView");
module.link("./tabBar");
module.link("./styles/liveStreamTab.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oauth.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/oauth.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  close: () => close,
  auth: () => auth
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);

const close = popup => new Promise(function (resolve) {
  const checkInterval = setInterval(() => {
    if (popup.closed) {
      clearInterval(checkInterval);
      resolve();
    }
  }, 300);
});

const auth = async () => {
  const oauthWindow = window.open("".concat(settings.get('Site_Url'), "/api/v1/livestream/oauth?userId=").concat(Meteor.userId()), 'youtube-integration-oauth', 'width=400,height=600');
  return close(oauthWindow);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/tabBar.tsx                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["label"];

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
let React, useMemo;
module.link("react", {
  default(v) {
    React = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 0);
let Option, Badge;
module.link("@rocket.chat/fuselage", {
  Option(v) {
    Option = v;
  },

  Badge(v) {
    Badge = v;
  }

}, 1);
let useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 2);
let useTranslation;
module.link("../../../client/contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 3);
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 4);
let Header;
module.link("../../../client/components/Header", {
  default(v) {
    Header = v;
  }

}, 5);
addAction('livestream', _ref => {
  var _room$streamingOption;

  let {
    room
  } = _ref;
  const enabled = useSetting('Livestream_enabled');
  const t = useTranslation();
  const isLive = (room === null || room === void 0 ? void 0 : (_room$streamingOption = room.streamingOptions) === null || _room$streamingOption === void 0 ? void 0 : _room$streamingOption.id) && room.streamingOptions.type === 'livestream';
  return useMemo(() => enabled ? {
    groups: ['channel', 'group', 'team'],
    id: 'livestream',
    title: 'Livestream',
    icon: 'podcast',
    template: 'liveStreamTab',
    order: isLive ? -1 : 15,
    renderAction: props => /*#__PURE__*/React.createElement(Header.ToolBoxAction, props, isLive ? /*#__PURE__*/React.createElement(Header.Badge, {
      title: t('Livestream_live_now'),
      variant: "danger"
    }, "!") : null),
    renderOption: _ref2 => {
      let {
        label: {
          title,
          icon
        }
      } = _ref2,
          props = _objectWithoutProperties(_ref2, _excluded);

      return /*#__PURE__*/React.createElement(Option, _extends({
        label: title,
        title: title,
        icon: icon
      }, props), isLive ? /*#__PURE__*/React.createElement(Badge, {
        title: t('Livestream_live_now'),
        variant: "danger"
      }, "!") : null);
    }
  } : null, [enabled, isLive, t]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"mentions-flextab":{"client":{"views":{"mentionsFlexTab.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/views/mentionsFlexTab.html                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.mentionsFlexTab.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.mentionsFlexTab.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/views/template.mentionsFlexTab.js                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("mentionsFlexTab");
Template["mentionsFlexTab"] = new Template("Template.mentionsFlexTab", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(view.templateInstance().subscriptionsReady());
  }, function() {
    return [ "\n\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hasMessages"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "list-view mentioned-messages-list flex-tab__header"
      }, "\n\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "No_mentions_found");
      })), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  }), "\n\t", HTML.DIV({
    class: "flex-tab__result js-list"
  }, "\n\t\t", HTML.UL({
    class: "mentioned-messages-list list clearfix"
  }, "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("messages")),
        _variable: "msg"
      };
    }, function() {
      return Blaze._TemplateWith(function() {
        return {
          groupable: Spacebars.call(false),
          msg: Spacebars.call(view.lookup("msg")),
          room: Spacebars.call(view.lookup("room")),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          u: Spacebars.call(view.lookup("u")),
          customClass: Spacebars.call("mentions"),
          context: Spacebars.call("mentions")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      });
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasMore"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "load-more"
    }, "\n\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t"), "\n\t\t" ];
  }), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"mentionsFlexTab.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/views/mentionsFlexTab.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["_id"],
      _excluded2 = ["_id"];

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 2);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 3);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 4);
let messageContext;
module.link("../../../ui-utils/client/lib/messageContext", {
  messageContext(v) {
    messageContext = v;
  }

}, 5);
let upsertMessageBulk;
module.link("../../../ui-utils/client/lib/RoomHistoryManager", {
  upsertMessageBulk(v) {
    upsertMessageBulk = v;
  }

}, 6);
let APIClient;
module.link("../../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 7);
let Messages, Users;
module.link("../../../models/client", {
  Messages(v) {
    Messages = v;
  },

  Users(v) {
    Users = v;
  }

}, 8);
let getCommonRoomEvents;
module.link("../../../ui/client/views/app/lib/getCommonRoomEvents", {
  getCommonRoomEvents(v) {
    getCommonRoomEvents = v;
  }

}, 9);
const LIMIT_DEFAULT = 50;
Template.mentionsFlexTab.helpers({
  hasMessages() {
    return Template.instance().messages.find().count();
  },

  messages() {
    const instance = Template.instance();
    return instance.messages.find({}, {
      limit: instance.limit.get(),
      sort: {
        ts: -1
      }
    });
  },

  hasMore() {
    return Template.instance().hasMore.get();
  },

  messageContext
});
Template.mentionsFlexTab.onCreated(function () {
  this.messages = new Mongo.Collection(null);
  this.hasMore = new ReactiveVar(true);
  this.limit = new ReactiveVar(LIMIT_DEFAULT);
  this.autorun(() => {
    const query = {
      '_hidden': {
        $ne: true
      },
      'mentions.username': Users.findOne(Meteor.userId(), {
        fields: {
          username: 1
        }
      }).username,
      'rid': this.data.rid,
      '_updatedAt': {
        $gt: new Date()
      }
    };
    this.cursor && this.cursor.stop();
    this.limit.set(LIMIT_DEFAULT);
    this.cursor = Messages.find(query).observe({
      added: _ref => {
        let {
          _id
        } = _ref,
            message = _objectWithoutProperties(_ref, _excluded);

        this.messages.upsert({
          _id
        }, message);
      },
      changed: _ref2 => {
        let {
          _id
        } = _ref2,
            message = _objectWithoutProperties(_ref2, _excluded2);

        this.messages.upsert({
          _id
        }, message);
      },
      removed: _ref3 => {
        let {
          _id
        } = _ref3;
        this.messages.remove({
          _id
        });
      }
    });
  });
  this.autorun(async () => {
    const limit = this.limit.get();
    const {
      messages,
      total
    } = await APIClient.v1.get("chat.getMentionedMessages?roomId=".concat(this.data.rid, "&count=").concat(limit));
    upsertMessageBulk({
      msgs: messages
    }, this.messages);
    this.hasMore.set(total > limit);
  });
});
Template.mentionsFlexTab.onDestroyed(function () {
  this.cursor.stop();
});
Template.mentionsFlexTab.events(_objectSpread(_objectSpread({}, getCommonRoomEvents()), {}, {
  'scroll .js-list': _.throttle(function (e, instance) {
    if (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight && instance.hasMore.get()) {
      return instance.limit.set(instance.limit.get() + 50);
    }
  }, 200)
}));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"actionButton.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/actionButton.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 2);
let MessageAction, RoomHistoryManager;
module.link("../../ui-utils", {
  MessageAction(v) {
    MessageAction = v;
  },

  RoomHistoryManager(v) {
    RoomHistoryManager = v;
  }

}, 3);
let messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 4);
let Rooms;
module.link("../../models/client", {
  Rooms(v) {
    Rooms = v;
  }

}, 5);
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'jump-to-message',
    icon: 'jump',
    label: 'Jump_to_message',
    context: ['mentions', 'threads'],

    action(e) {
      e.preventDefault();
      e.stopPropagation();
      const {
        msg: message
      } = messageArgs(this);

      if (window.matchMedia('(max-width: 500px)').matches) {
        Template.instance().tabBar.close();
      }

      if (message.tmid) {
        return FlowRouter.go(FlowRouter.getRouteName(), {
          tab: 'thread',
          context: message.tmid,
          rid: message.rid,
          name: Rooms.findOne({
            _id: message.rid
          }).name
        }, {
          jump: message._id
        });
      }

      RoomHistoryManager.getSurroundingMessages(message, 50);
    },

    order: 100,
    group: ['message', 'menu']
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/index.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./views/mentionsFlexTab.html");
module.link("./views/mentionsFlexTab");
module.link("./actionButton");
module.link("./tabBar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/tabBar.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 0);
addAction('mentions', {
  groups: ['channel', 'group', 'team'],
  id: 'mentions',
  title: 'Mentions',
  icon: 'at',
  template: 'mentionsFlexTab',
  order: 9
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"message-pin":{"client":{"views":{"pinnedMessages.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/views/pinnedMessages.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.pinnedMessages.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.pinnedMessages.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/views/template.pinnedMessages.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("pinnedMessages");
Template["pinnedMessages"] = new Template("Template.pinnedMessages", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(view.templateInstance().subscriptionsReady());
  }, function() {
    return [ "\n\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hasMessages"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "list-view pinned-messages-list flex-tab__header"
      }, "\n\t\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "No_pinned_messages");
      })), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  }), "\n\t", HTML.DIV({
    class: "flex-tab__result pinned-messages-list js-list"
  }, "\n\t\t", HTML.UL({
    class: "list clearfix"
  }, "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("messages")),
        _variable: "msg"
      };
    }, function() {
      return Blaze._TemplateWith(function() {
        return {
          context: Spacebars.call("pinned"),
          msg: Spacebars.call(view.lookup("msg")),
          room: Spacebars.call(view.lookup("room")),
          groupable: Spacebars.call(true),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          u: Spacebars.call(view.lookup("u"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      });
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasMore"));
  }, function() {
    return [ "\n\t\t\t", HTML.DIV({
      class: "load-more"
    }, "\n\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t"), "\n\t\t" ];
  }), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"stylesheets":{"messagepin.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/views/stylesheets/messagepin.css                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"pinnedMessages.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/views/pinnedMessages.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["_id"],
      _excluded2 = ["_id"];

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 3);
let upsertMessageBulk;
module.link("../../../ui-utils/client/lib/RoomHistoryManager", {
  upsertMessageBulk(v) {
    upsertMessageBulk = v;
  }

}, 4);
let messageContext;
module.link("../../../ui-utils/client/lib/messageContext", {
  messageContext(v) {
    messageContext = v;
  }

}, 5);
let APIClient;
module.link("../../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 6);
let Messages;
module.link("../../../models/client", {
  Messages(v) {
    Messages = v;
  }

}, 7);
let getCommonRoomEvents;
module.link("../../../ui/client/views/app/lib/getCommonRoomEvents", {
  getCommonRoomEvents(v) {
    getCommonRoomEvents = v;
  }

}, 8);
const LIMIT_DEFAULT = 50;
Template.pinnedMessages.helpers({
  hasMessages() {
    return Template.instance().messages.find().count();
  },

  messages() {
    const instance = Template.instance();
    return instance.messages.find({}, {
      limit: instance.limit.get(),
      sort: {
        ts: -1
      }
    });
  },

  hasMore() {
    return Template.instance().hasMore.get();
  },

  messageContext
});
Template.pinnedMessages.onCreated(function () {
  this.pinnedMessages = new ReactiveVar([]);
  this.hasMore = new ReactiveVar(true);
  this.limit = new ReactiveVar(LIMIT_DEFAULT);
  this.rid = this.data.rid;
  this.messages = new Mongo.Collection(null);
  this.autorun(() => {
    const query = {
      t: {
        $ne: 'rm'
      },
      _hidden: {
        $ne: true
      },
      pinned: true,
      rid: this.data.rid,
      _updatedAt: {
        $gte: new Date()
      }
    };
    this.cursor && this.cursor.stop();
    this.limit.set(LIMIT_DEFAULT);
    this.cursor = Messages.find(query).observe({
      added: _ref => {
        let {
          _id
        } = _ref,
            message = _objectWithoutProperties(_ref, _excluded);

        this.messages.upsert({
          _id
        }, message);
      },
      changed: _ref2 => {
        let {
          _id
        } = _ref2,
            message = _objectWithoutProperties(_ref2, _excluded2);

        this.messages.upsert({
          _id
        }, message);
      },
      removed: _ref3 => {
        let {
          _id
        } = _ref3;
        this.messages.remove({
          _id
        });
      }
    });
  });
  this.autorun(async () => {
    const limit = this.limit.get();
    const {
      messages,
      total
    } = await APIClient.v1.get("chat.getPinnedMessages?roomId=".concat(this.rid, "&count=").concat(limit));
    upsertMessageBulk({
      msgs: messages
    }, this.messages);
    this.hasMore.set(total > limit);
  });
});
Template.mentionsFlexTab.onDestroyed(function () {
  this.cursor.stop();
});
Template.pinnedMessages.events(_objectSpread(_objectSpread({}, getCommonRoomEvents()), {}, {
  'scroll .js-list': _.throttle(function (e, instance) {
    if (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight && instance.hasMore.get()) {
      return instance.limit.set(instance.limit.get() + 50);
    }
  }, 200)
}));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"actionButton.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/actionButton.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 2);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 3);
let RoomHistoryManager, MessageAction;
module.link("../../ui-utils", {
  RoomHistoryManager(v) {
    RoomHistoryManager = v;
  },

  MessageAction(v) {
    MessageAction = v;
  }

}, 4);
let messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 5);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 6);
let hasAtLeastOnePermission;
module.link("../../authorization", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 7);
let Rooms;
module.link("../../models/client", {
  Rooms(v) {
    Rooms = v;
  }

}, 8);
let roomTypes;
module.link("../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 9);
let handleError;
module.link("../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 10);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 11);
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'pin-message',
    icon: 'pin',
    label: 'Pin',
    context: ['pinned', 'message', 'message-mobile', 'threads', 'direct'],

    action() {
      const {
        msg: message
      } = messageArgs(this);
      message.pinned = true;
      Meteor.call('pinMessage', message, function (error) {
        if (error) {
          return handleError(error);
        }
      });
    },

    condition(_ref) {
      let {
        msg,
        subscription,
        room
      } = _ref;

      if (!settings.get('Message_AllowPinning') || msg.pinned || !subscription) {
        return false;
      }

      const isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return hasAtLeastOnePermission('pin-message', msg.rid);
    },

    order: 7,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'unpin-message',
    icon: 'pin',
    label: 'Unpin',
    context: ['pinned', 'message', 'message-mobile', 'threads', 'direct'],

    action() {
      const {
        msg: message
      } = messageArgs(this);
      message.pinned = false;
      Meteor.call('unpinMessage', message, function (error) {
        if (error) {
          return handleError(error);
        }
      });
    },

    condition(_ref2) {
      let {
        msg,
        subscription
      } = _ref2;

      if (!subscription || !settings.get('Message_AllowPinning') || !msg.pinned) {
        return false;
      }

      return hasAtLeastOnePermission('pin-message', msg.rid);
    },

    order: 8,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'jump-to-pin-message',
    icon: 'jump',
    label: 'Jump_to_message',
    context: ['pinned', 'message-mobile', 'direct'],

    action() {
      const {
        msg: message
      } = messageArgs(this);

      if (window.matchMedia('(max-width: 500px)').matches) {
        Template.instance().tabBar.close();
      }

      if (message.tmid) {
        return FlowRouter.go(FlowRouter.getRouteName(), {
          tab: 'thread',
          context: message.tmid,
          rid: message.rid,
          jump: message._id,
          name: Rooms.findOne({
            _id: message.rid
          }).name
        }, {
          jump: message._id
        });
      }

      return RoomHistoryManager.getSurroundingMessages(message, 50);
    },

    condition(_ref3) {
      let {
        subscription
      } = _ref3;
      return !!subscription;
    },

    order: 100,
    group: ['message', 'menu']
  });
  MessageAction.addButton({
    id: 'permalink-pinned',
    icon: 'permalink',
    label: 'Get_link',
    classes: 'clipboard',
    context: ['pinned'],

    async action() {
      const {
        msg: message
      } = messageArgs(this);
      const permalink = await MessageAction.getPermaLink(message._id);
      navigator.clipboard.writeText(permalink);
      dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Copied')
      });
    },

    condition(_ref4) {
      let {
        subscription
      } = _ref4;
      return !!subscription;
    },

    order: 101,
    group: 'menu'
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./actionButton");
module.link("./messageType");
module.link("./pinMessage");
module.link("./tabBar");
module.link("./views/pinnedMessages.html");
module.link("./views/pinnedMessages");
module.link("./views/stylesheets/messagepin.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/messageType.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let MessageTypes;
module.link("../../ui-utils", {
  MessageTypes(v) {
    MessageTypes = v;
  }

}, 1);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'message_pinned',
    system: true,
    message: 'Pinned_a_message'
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"pinMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/pinMessage.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 1);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);
let ChatMessage, Subscriptions;
module.link("../../models", {
  ChatMessage(v) {
    ChatMessage = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 3);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 4);
Meteor.methods({
  pinMessage(message) {
    if (!Meteor.userId()) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-not-authorized')
      });
      return false;
    }

    if (!settings.get('Message_AllowPinning')) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('pinning-not-allowed')
      });
      return false;
    }

    if (Subscriptions.findOne({
      rid: message.rid
    }) == null) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-pinning-message')
      });
      return false;
    }

    if (typeof message._id !== 'string') {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-pinning-message')
      });
      return false;
    }

    dispatchToastMessage({
      type: 'success',
      message: TAPi18n.__('Message_has_been_pinned')
    });
    return ChatMessage.update({
      _id: message._id,
      rid: message.rid
    }, {
      $set: {
        pinned: true
      }
    });
  },

  unpinMessage(message) {
    if (!Meteor.userId()) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-not-authorized')
      });
      return false;
    }

    if (!settings.get('Message_AllowPinning')) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('unpinning-not-allowed')
      });
      return false;
    }

    if (Subscriptions.findOne({
      rid: message.rid
    }) == null) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-unpinning-message')
      });
      return false;
    }

    if (typeof message._id !== 'string') {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-unpinning-message')
      });
      return false;
    }

    dispatchToastMessage({
      type: 'success',
      message: TAPi18n.__('Message_has_been_unpinned')
    });
    return ChatMessage.update({
      _id: message._id,
      rid: message.rid
    }, {
      $set: {
        pinned: false
      }
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/tabBar.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  }

}, 0);
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
let useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 2);
addAction('pinned-messages', () => {
  const pinningAllowed = useSetting('Message_AllowPinning');
  return useMemo(() => pinningAllowed ? {
    groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
    id: 'pinned-messages',
    title: 'Pinned_Messages',
    icon: 'pin',
    template: 'pinnedMessages',
    order: 11
  } : null, [pinningAllowed]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"message-star":{"client":{"views":{"starredMessages.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/views/starredMessages.html                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.starredMessages.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.starredMessages.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/views/template.starredMessages.js                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("starredMessages");
Template["starredMessages"] = new Template("Template.starredMessages", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(view.templateInstance().subscriptionsReady());
  }, function() {
    return [ "\n\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hasMessages"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "list-view starred-messages-list flex-tab__header"
      }, "\n\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "No_starred_messages");
      })), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  }), "\n\t", HTML.DIV({
    class: "flex-tab__result js-list"
  }, "\n\t\t", HTML.UL({
    class: "list clearfix"
  }, "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("messages")),
        _variable: "msg"
      };
    }, function() {
      return [ "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          msg: Spacebars.call(view.lookup("msg")),
          context: Spacebars.call("starred"),
          room: Spacebars.call(view.lookup("room")),
          groupable: Spacebars.call(false),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          u: Spacebars.call(view.lookup("u"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasMore"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "load-more"
    }, "\n\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t"), "\n\t\t" ];
  }), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"stylesheets":{"messagestar.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/views/stylesheets/messagestar.css                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"starredMessages.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/views/starredMessages.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["_id"],
      _excluded2 = ["_id"];

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 3);
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 4);
let messageContext;
module.link("../../../ui-utils/client/lib/messageContext", {
  messageContext(v) {
    messageContext = v;
  }

}, 5);
let Messages;
module.link("../../../models/client", {
  Messages(v) {
    Messages = v;
  }

}, 6);
let upsertMessageBulk;
module.link("../../../ui-utils/client/lib/RoomHistoryManager", {
  upsertMessageBulk(v) {
    upsertMessageBulk = v;
  }

}, 7);
let APIClient;
module.link("../../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 8);
let getCommonRoomEvents;
module.link("../../../ui/client/views/app/lib/getCommonRoomEvents", {
  getCommonRoomEvents(v) {
    getCommonRoomEvents = v;
  }

}, 9);
const LIMIT_DEFAULT = 50;
Template.starredMessages.helpers({
  hasMessages() {
    return Template.instance().messages.find().count();
  },

  messages() {
    const instance = Template.instance();
    return instance.messages.find({}, {
      limit: instance.limit.get(),
      sort: {
        ts: -1
      }
    });
  },

  hasMore() {
    return Template.instance().hasMore.get();
  },

  messageContext
});
Template.starredMessages.onCreated(function () {
  this.rid = this.data.rid;
  this.messages = new Mongo.Collection(null);
  this.hasMore = new ReactiveVar(true);
  this.limit = new ReactiveVar(LIMIT_DEFAULT);
  this.autorun(() => {
    const query = {
      '_hidden': {
        $ne: true
      },
      'starred._id': Meteor.userId(),
      'rid': this.rid,
      '_updatedAt': {
        $gt: new Date()
      }
    };
    this.cursor && this.cursor.stop();
    this.limit.set(LIMIT_DEFAULT);
    this.cursor = Messages.find(query).observe({
      added: _ref => {
        let {
          _id
        } = _ref,
            message = _objectWithoutProperties(_ref, _excluded);

        this.messages.upsert({
          _id
        }, message);
      },
      changed: _ref2 => {
        let {
          _id
        } = _ref2,
            message = _objectWithoutProperties(_ref2, _excluded2);

        this.messages.upsert({
          _id
        }, message);
      },
      removed: _ref3 => {
        let {
          _id
        } = _ref3;
        this.messages.remove({
          _id
        });
      }
    });
  });
  this.autorun(async () => {
    const limit = this.limit.get();
    const {
      messages,
      total
    } = await APIClient.v1.get("chat.getStarredMessages?roomId=".concat(this.rid, "&count=").concat(limit));
    upsertMessageBulk({
      msgs: messages
    }, this.messages);
    this.hasMore.set(total > limit);
  });
});
Template.mentionsFlexTab.onDestroyed(function () {
  this.cursor.stop();
});
Template.starredMessages.events(_objectSpread(_objectSpread({}, getCommonRoomEvents()), {}, {
  'scroll .js-list': _.throttle(function (e, instance) {
    if (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight) {
      return instance.limit.set(instance.limit.get() + 50);
    }
  }, 200)
}));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"actionButton.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/actionButton.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 2);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 3);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 4);
let RoomHistoryManager, MessageAction;
module.link("../../ui-utils", {
  RoomHistoryManager(v) {
    RoomHistoryManager = v;
  },

  MessageAction(v) {
    MessageAction = v;
  }

}, 5);
let messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 6);
let Rooms;
module.link("../../models/client", {
  Rooms(v) {
    Rooms = v;
  }

}, 7);
let roomTypes;
module.link("../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 8);
let handleError;
module.link("../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 9);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 10);
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'star-message',
    icon: 'star',
    label: 'Star',
    context: ['starred', 'message', 'message-mobile', 'threads'],

    action() {
      const {
        msg: message
      } = messageArgs(this);
      message.starred = Meteor.userId();
      Meteor.call('starMessage', message, function (error) {
        if (error) {
          return handleError(error);
        }
      });
    },

    condition(_ref) {
      let {
        msg: message,
        subscription,
        u,
        room
      } = _ref;

      if (subscription == null && settings.get('Message_AllowStarring')) {
        return false;
      }

      const isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return !message.starred || !message.starred.find(star => star._id === u._id);
    },

    order: 9,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'unstar-message',
    icon: 'star',
    label: 'Unstar_Message',
    context: ['starred', 'message', 'message-mobile', 'threads'],

    action() {
      const {
        msg: message
      } = messageArgs(this);
      message.starred = false;
      Meteor.call('starMessage', message, function (error) {
        if (error) {
          handleError(error);
        }
      });
    },

    condition(_ref2) {
      let {
        msg: message,
        subscription,
        u
      } = _ref2;

      if (subscription == null && settings.get('Message_AllowStarring')) {
        return false;
      }

      return message.starred && message.starred.find(star => star._id === u._id);
    },

    order: 9,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'jump-to-star-message',
    icon: 'jump',
    label: 'Jump_to_message',
    context: ['starred', 'threads', 'message-mobile'],

    action() {
      const {
        msg: message
      } = messageArgs(this);

      if (window.matchMedia('(max-width: 500px)').matches) {
        Template.instance().tabBar.close();
      }

      if (message.tmid) {
        return FlowRouter.go(FlowRouter.getRouteName(), {
          tab: 'thread',
          context: message.tmid,
          rid: message.rid,
          jump: message._id,
          name: Rooms.findOne({
            _id: message.rid
          }).name
        }, {
          jump: message._id
        });
      }

      RoomHistoryManager.getSurroundingMessages(message, 50);
    },

    condition(_ref3) {
      let {
        msg,
        subscription,
        u
      } = _ref3;

      if (subscription == null || !settings.get('Message_AllowStarring')) {
        return false;
      }

      return msg.starred && msg.starred.find(star => star._id === u._id);
    },

    order: 100,
    group: ['message', 'menu']
  });
  MessageAction.addButton({
    id: 'permalink-star',
    icon: 'permalink',
    label: 'Get_link',
    classes: 'clipboard',
    context: ['starred', 'threads'],

    async action() {
      const {
        msg: message
      } = messageArgs(this);
      const permalink = await MessageAction.getPermaLink(message._id);
      navigator.clipboard.writeText(permalink);
      dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Copied')
      });
    },

    condition(_ref4) {
      let {
        msg,
        subscription,
        u
      } = _ref4;

      if (subscription == null) {
        return false;
      }

      return msg.starred && msg.starred.find(star => star._id === u._id);
    },

    order: 101,
    group: 'menu'
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/index.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./actionButton");
module.link("./starMessage");
module.link("./tabBar");
module.link("./views/starredMessages.html");
module.link("./views/starredMessages");
module.link("./views/stylesheets/messagestar.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"starMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/starMessage.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 1);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);
let ChatMessage, Subscriptions;
module.link("../../models", {
  ChatMessage(v) {
    ChatMessage = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 3);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 4);
Meteor.methods({
  starMessage(message) {
    if (!Meteor.userId()) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-starring-message')
      });
      return false;
    }

    if (Subscriptions.findOne({
      rid: message.rid
    }) == null) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-starring-message')
      });
      return false;
    }

    if (!ChatMessage.findOneByRoomIdAndMessageId(message.rid, message._id)) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-starring-message')
      });
      return false;
    }

    if (!settings.get('Message_AllowStarring')) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-starring-message')
      });
      return false;
    }

    if (message.starred) {
      dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Message_has_been_starred')
      });
    } else {
      dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Message_has_been_unstarred')
      });
    }

    return ChatMessage.update({
      _id: message._id
    }, {
      $set: {
        starred: !!message.starred
      }
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/tabBar.ts                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 0);
addAction('starred-messages', {
  groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
  id: 'starred-messages',
  title: 'Starred_Messages',
  icon: 'star',
  template: 'starredMessages',
  order: 10
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"oauth2-server-config":{"client":{"oauth":{"oauth2-client.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/oauth/oauth2-client.html                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oauth2-client.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oauth2-client.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/oauth/template.oauth2-client.js                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("authorize");
Template["authorize"] = new Template("Template.authorize", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("currentUser"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "oauth-panel"
    }, "\n\t\t\t", HTML.FORM({
      method: "post",
      action: "",
      role: "form",
      class: function() {
        return Blaze.Unless(function() {
          return Spacebars.call(view.templateInstance().subscriptionsReady());
        }, function() {
          return "hidden";
        });
      }
    }, "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("currentUser"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV({
        class: "user-info"
      }, "\n\t\t\t\t\t\t", HTML.DIV({
        class: "thumb"
      }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          username: Spacebars.call(Spacebars.dot(view.lookup("currentUser"), "username"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("avatar"));
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
        class: "username"
      }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "You_are_logged_in_as");
      }), "\n\t\t\t\t\t\t\t", HTML.H1(Blaze.View("lookup:currentUser.username", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("currentUser"), "username"));
      })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }), "\n\n\t\t\t\t", HTML.DIV({
      class: "integration-info"
    }, "\n\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t", HTML.SPAN(HTML.B(Blaze.View("lookup:getClient.name", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("getClient"), "name"));
    })), " ", Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "will_be_able_to");
    })), HTML.Raw('\n\t\t\t\t\t\t<ul class="integration-permissions">\n\t\t\t\t\t\t\t<li>Post Messages</li>\n\t\t\t\t\t\t\t<li>Create Channels</li>\n\t\t\t\t\t\t\t<li>Change Channel Topic</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t')), "\n\t\t\t\t"), HTML.Raw('\n\t\t\t\t<input type="hidden" name="allow" value="yes">\n\t\t\t\t'), HTML.INPUT({
      type: "hidden",
      name: "token",
      value: function() {
        return Spacebars.mustache(view.lookup("getToken"));
      }
    }), "\n\t\t\t\t", HTML.INPUT({
      type: "hidden",
      name: "client_id",
      value: function() {
        return Spacebars.mustache(view.lookup("client_id"));
      }
    }), "\n\t\t\t\t", HTML.INPUT({
      type: "hidden",
      name: "redirect_uri",
      value: function() {
        return Spacebars.mustache(view.lookup("redirect_uri"));
      }
    }), HTML.Raw('\n\t\t\t\t<input type="hidden" name="response_type" value="code">\n\t\t\t\t'), HTML.DIV({
      class: "buttons-group"
    }, "\n\t\t\t\t\t", HTML.BUTTON({
      id: "logout-oauth",
      class: "rc-button rc-button--danger logout"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Logout");
    })), "\n\t\t\t\t\t", HTML.BUTTON({
      id: "cancel-oauth",
      type: "button",
      class: "rc-button rc-button--cancel"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Cancel");
    })), "\n\t\t\t\t\t", HTML.BUTTON({
      type: "submit",
      class: "rc-button rc-button--primary save"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Authorize");
    })), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.templateInstance().subscriptionsReady());
    }, function() {
      return [ "\n\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "loading");
      }), "...\n\t\t\t" ];
    }), "\n\t\t"), "\n\t" ];
  }, function() {
    return [ "\n\t\t", Spacebars.include(view.lookupTemplate("loginButtons")), "\n\t" ];
  });
}));

Template.__checkName("oauth404");
Template["oauth404"] = new Template("Template.oauth404", (function() {
  var view = this;
  return HTML.DIV({
    class: "oauth-panel"
  }, "\n\t\t\t", HTML.FORM("\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.dataMustache(view.lookup("$eq"), view.lookup("error"), "404");
  }, function() {
    return HTML.Raw("\n\t\t\t\t\t<h2>Invalid OAuth client</h2>\n\t\t\t\t");
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.dataMustache(view.lookup("$eq"), view.lookup("error"), "invalid_redirect_uri");
  }, function() {
    return HTML.Raw("\n\t\t\t\t\t<h2>Redirect URL does not match</h2>\n\t\t\t\t");
  }), "\n\t\t\t"), "\n\t\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"stylesheets":{"oauth2.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/oauth/stylesheets/oauth2.css                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"oauth2-client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/oauth/oauth2-client.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 2);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 3);
let APIClient;
module.link("../../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 4);
Template.authorize.onCreated(async function () {
  this.oauthApp = new ReactiveVar({});
  const {
    oauthApp
  } = await APIClient.v1.get("oauth-apps.get?clientId=".concat(this.data.client_id()));
  this.oauthApp.set(oauthApp);
});
Template.authorize.helpers({
  getToken() {
    return Meteor._localStorage.getItem(Accounts.LOGIN_TOKEN_KEY);
  },

  getClient() {
    return Template.instance().oauthApp.get();
  }

});
Template.authorize.events({
  'click #logout-oauth'() {
    return Meteor.logout();
  },

  'click #cancel-oauth'() {
    return window.close();
  }

});
Template.authorize.onRendered(function () {
  const user = Meteor.user();

  if (user && user.oauth && user.oauth.authorizedClients && user.oauth.authorizedClients.includes(this.data.client_id())) {
    $('button[type=submit]').click();
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"admin":{"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/admin/startup.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let hasAllPermission;
module.link("../../../authorization", {
  hasAllPermission(v) {
    hasAllPermission = v;
  }

}, 0);
let registerAdminSidebarItem;
module.link("../../../../client/views/admin", {
  registerAdminSidebarItem(v) {
    registerAdminSidebarItem = v;
  }

}, 1);
registerAdminSidebarItem({
  href: 'admin-oauth-apps',
  i18nLabel: 'OAuth Apps',
  icon: 'discover',

  permissionGranted() {
    return hasAllPermission('manage-oauth-apps');
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./oauth/oauth2-client.html");
module.link("./oauth/oauth2-client");
module.link("./admin/startup");
module.link("./oauth/stylesheets/oauth2.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"search":{"client":{"provider":{"result.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/provider/result.html                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.result.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.result.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/provider/template.result.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("DefaultSearchResultTemplate");
Template["DefaultSearchResultTemplate"] = new Template("Template.DefaultSearchResultTemplate", (function() {
  var view = this;
  return [ HTML.DIV({
    class: "rocket-default-search-settings"
  }, "\n\t\t", HTML.DIV("\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("globalSearchEnabled"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.LABEL(HTML.Raw('\n\t\t\t\t\t<input type="checkbox" id="global-search">'), Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Global_Search");
    }), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t"), "\n\t", HTML.DIV({
    class: "rocket-default-search-results"
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("result"));
  }, function() {
    return [ "\n\t\t\t", Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("$and"), Spacebars.dot(view.lookup("result"), "message"), Spacebars.dot(view.lookup("result"), "message", "docs"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: "flex-tab__result js-list"
      }, "\n\t\t\t\t\t", HTML.UL({
        class: "list clearfix"
      }, "\n\t\t\t\t\t\t", Spacebars.With(function() {
        return Spacebars.call(view.lookup("messageContext"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(Spacebars.dot(view.lookup("result"), "message", "docs")),
            _variable: "msg"
          };
        }, function() {
          return Blaze._TemplateWith(function() {
            return {
              msg: Spacebars.call(Spacebars.dataMustache(view.lookup("messageParse"), view.lookup("msg"))),
              groupable: Spacebars.call(true),
              room: Spacebars.call(view.lookup("room")),
              subscription: Spacebars.call(view.lookup("subscription")),
              settings: Spacebars.call(view.lookup("settings")),
              u: Spacebars.call(view.lookup("u"))
            };
          }, function() {
            return Spacebars.include(view.lookupTemplate("message"));
          });
        }), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "No_results_found");
      })), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t\t\t", HTML.DIV({
    class: "load-more"
  }, "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("searching"));
  }, function() {
    return [ "\n\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t" ];
  }), "\n\t\t\t"), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"suggestion.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/provider/suggestion.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.suggestion.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.suggestion.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/provider/template.suggestion.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("DefaultSuggestionItemTemplate");
Template["DefaultSuggestionItemTemplate"] = new Template("Template.DefaultSuggestionItemTemplate", (function() {
  var view = this;
  return HTML.DIV({
    class: "default-suggestion"
  }, "\n\t\t", Blaze.View("lookup:text", function() {
    return Spacebars.mustache(view.lookup("text"));
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"result.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/provider/result.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 3);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 4);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 5);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 6);
let messageContext;
module.link("../../../ui-utils/client/lib/messageContext", {
  messageContext(v) {
    messageContext = v;
  }

}, 7);
let MessageAction, RoomHistoryManager;
module.link("../../../ui-utils", {
  MessageAction(v) {
    MessageAction = v;
  },

  RoomHistoryManager(v) {
    RoomHistoryManager = v;
  }

}, 8);
let messageArgs;
module.link("../../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 9);
let Rooms;
module.link("../../../models/client", {
  Rooms(v) {
    Rooms = v;
  }

}, 10);
let getCommonRoomEvents;
module.link("../../../ui/client/views/app/lib/getCommonRoomEvents", {
  getCommonRoomEvents(v) {
    getCommonRoomEvents = v;
  }

}, 11);
let goToRoomById;
module.link("../../../../client/lib/utils/goToRoomById", {
  goToRoomById(v) {
    goToRoomById = v;
  }

}, 12);
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'jump-to-search-message',
    icon: 'jump',
    label: 'Jump_to_message',
    context: ['search'],

    action() {
      const {
        msg: message
      } = messageArgs(this);

      if (message.tmid) {
        return FlowRouter.go(FlowRouter.getRouteName(), {
          tab: 'thread',
          context: message.tmid,
          rid: message.rid,
          name: Rooms.findOne({
            _id: message.rid
          }).name
        }, {
          jump: message._id
        });
      }

      if (Session.get('openedRoom') === message.rid) {
        return RoomHistoryManager.getSurroundingMessages(message, 50);
      }

      goToRoomById(message.rid); // RocketChat.MessageAction.hideDropDown();

      if (window.matchMedia('(max-width: 500px)').matches) {
        Template.instance().tabBar.close();
      }

      window.setTimeout(() => {
        RoomHistoryManager.getSurroundingMessages(message, 50);
      }, 400); // 400ms is popular among game devs as a good delay before transition starts
      // ie. 50, 100, 200, 400, 800 are the favored timings
    },

    order: 100,
    group: 'menu'
  });
});
Template.DefaultSearchResultTemplate.onRendered(function () {
  const list = this.firstNode.parentNode.querySelector('.rocket-default-search-results');
  this.autorun(() => {
    const result = this.data.result.get();

    if (result && this.hasMore.get()) {
      Tracker.afterFlush(() => {
        if (list.scrollHeight < list.offsetHeight) {
          this.data.payload.limit = (this.data.payload.limit || this.pageSize) + this.pageSize;
          this.data.search();
        }
      });
    }
  });
});
Template.DefaultSearchResultTemplate.onCreated(function () {
  // paging
  this.pageSize = this.data.settings.PageSize; // global search

  this.globalSearchEnabled = this.data.settings.GlobalSearchEnabled;
  this.data.parentPayload.searchAll = this.globalSearchEnabled;
  this.hasMore = new ReactiveVar(true);
  this.autorun(() => {
    const result = this.data.result.get();
    this.hasMore.set(!(result && result.message.docs.length < (this.data.payload.limit || this.pageSize)));
  });
});
Template.DefaultSearchResultTemplate.events(_objectSpread(_objectSpread({}, getCommonRoomEvents()), {}, {
  'change #global-search'(e, t) {
    t.data.parentPayload.searchAll = e.target.checked;
    t.data.payload.limit = t.pageSize;
    t.data.result.set(undefined);
    t.data.search();
  },

  'scroll .rocket-default-search-results': _.throttle(function (e, t) {
    if (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight && t.hasMore.get()) {
      t.data.payload.limit = (t.data.payload.limit || t.pageSize) + t.pageSize;
      t.data.search();
    }
  }, 200)
}));
Template.DefaultSearchResultTemplate.helpers({
  result() {
    return Template.instance().data.result.get();
  },

  globalSearchEnabled() {
    return Template.instance().globalSearchEnabled;
  },

  searching() {
    return Template.instance().data.searching.get();
  },

  hasMore() {
    return Template.instance().hasMore.get();
  },

  messageParse(msg) {
    const text = Template.instance().data.text.get();
    msg.searchedText = text;
    return _objectSpread(_objectSpread({
      customClass: 'search',
      actionContext: 'search'
    }, msg), {}, {
      groupable: false
    });
  },

  messageContext() {
    const result = messageContext.call(this, {
      rid: Session.get('openedRoom')
    });
    return _objectSpread(_objectSpread({}, result), {}, {
      settings: _objectSpread(_objectSpread({}, result.settings), {}, {
        showReplyButton: false,
        showreply: false
      })
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"search":{"search.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/search/search.html                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.search.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.search.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/search/template.search.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("RocketSearch");
Template["RocketSearch"] = new Template("Template.RocketSearch", (function() {
  var view = this;
  return Blaze.Unless(function() {
    return Spacebars.call(view.lookup("isActive"));
  }, function() {
    return [ "\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("error"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "rocket-search-error"
      }, "\n\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), view.lookup("error"));
      }), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  }, function() {
    return [ "\n\t", HTML.DIV({
      class: function() {
        return [ "rocket-search-tab list-view ", Spacebars.mustache(Spacebars.dot(view.lookup("provider"), "key")) ];
      }
    }, "\n\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("provider"), "description"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "title"
      }, "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
        return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup("provider"), "description")));
      })), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t\t", HTML.DIV({
      class: "control rocket-search-input"
    }, "\n\t\t\t", HTML.FORM({
      class: "search-form",
      role: "form"
    }, "\n\t\t\t\t", HTML.DIV({
      class: "rc-input"
    }, "\n\t\t\t\t\t", HTML.LABEL({
      class: "rc-input__label"
    }, "\n\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__wrapper"
    }, "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__icon"
    }, "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call(Spacebars.dot(view.lookup("provider"), "icon"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t", HTML.INPUT({
      value: function() {
        return Spacebars.mustache(view.lookup("text"));
      },
      type: "text",
      class: "rc-input__element",
      name: "message-search",
      id: "message-search",
      placeholder: function() {
        return Spacebars.mustache(view.lookup("_"), "Search_Messages");
      },
      autocomplete: "off",
      "aria-label": function() {
        return Spacebars.mustache(view.lookup("_"), "Search_Messages");
      }
    }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("suggestions"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        id: "rocket-search-suggestions"
      }, "\n\t\t\t\t\t", Blaze.Each(function() {
        return Spacebars.call(view.lookup("suggestions"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: function() {
            return [ "rocket-search-suggestion-item ", Spacebars.mustache(view.lookup("suggestionSelected"), view.lookup("@index")) ];
          }
        }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            template: Spacebars.call(Spacebars.dot(view.lookup("provider"), "suggestionItemTemplate"))
          };
        }, function() {
          return Spacebars.include(function() {
            return Spacebars.call(Template.__dynamic);
          });
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t"), "\n\t\t\t\t" ];
    }), "\n\t\t\t"), "\n\t\t"), "\n\n\t\t", HTML.DIV({
      class: "rocket-search-result"
    }, "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        template: Spacebars.call(Spacebars.dot(view.lookup("provider"), "resultTemplate")),
        data: Spacebars.call(view.lookup("scope"))
      };
    }, function() {
      return Spacebars.include(function() {
        return Spacebars.call(Template.__dynamic);
      });
    }), "\n\t\t"), "\n\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"search.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/search/search.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 2);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 3);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 4);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 5);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 6);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 7);
Template.RocketSearch.onCreated(function () {
  this.provider = new ReactiveVar();
  this.isActive = new ReactiveVar(false);
  this.error = new ReactiveVar();
  this.suggestions = new ReactiveVar();
  this.suggestionActive = new ReactiveVar();
  Meteor.call('rocketchatSearch.getProvider', (error, provider) => {
    if (!error && provider) {
      this.scope.settings = provider.settings;
      this.provider.set(provider);
      this.isActive.set(true);
    } else {
      this.error.set('Search_current_provider_not_active');
    }
  });

  const _search = () => {
    const _p = Object.assign({}, this.scope.parentPayload, this.scope.payload);

    if (this.scope.text.get()) {
      this.scope.searching.set(true);
      Meteor.call('rocketchatSearch.search', this.scope.text.get(), {
        rid: Session.get('openedRoom'),
        uid: Meteor.userId()
      }, _p, (err, result) => {
        if (err) {
          dispatchToastMessage({
            type: 'error',
            message: TAPi18n.__('Search_message_search_failed')
          });
          this.scope.searching.set(false);
        } else {
          this.scope.searching.set(false);
          this.scope.result.set(result);
        }
      });
    }
  };

  this.scope = {
    searching: new ReactiveVar(false),
    result: new ReactiveVar(),
    text: new ReactiveVar(),
    settings: {},
    parentPayload: {},
    payload: {},
    search: _search
  };

  this.search = value => {
    this.scope.result.set(undefined);
    this.scope.payload = {};
    this.scope.text.set(value);

    _search();
  };

  this.suggest = value => {
    this.suggestions.set();

    const _p = Object.assign({}, this.scope.parentPayload, this.scope.payload);

    Meteor.call('rocketchatSearch.suggest', value, {
      rid: Session.get('openedRoom'),
      uid: Meteor.userId()
    }, this.scope.parentPayload, _p, (err, result) => {
      if (err) {// TODO what should happen
      } else {
        this.suggestionActive.set(undefined);

        if (value !== this.scope.text.get()) {
          this.suggestions.set(result);
        }
      }
    });
  };
});
Template.RocketSearch.events = {
  'keydown #message-search'(evt, t) {
    if (evt.keyCode === 13) {
      if (t.suggestionActive.get() !== undefined) {
        const suggestion = t.suggestions.get()[t.suggestionActive.get()];

        if (suggestion.action) {
          const value = suggestion.action();

          if (value) {
            t.search(value);
          }
        } else {
          t.search(suggestion.text);
        }
      } else {
        t.search(evt.target.value.trim());
      }

      t.suggestions.set();
      return evt.preventDefault();
    }

    const suggestions = t.suggestions.get();
    const suggestionActive = t.suggestionActive.get();

    if (evt.keyCode === 40 && suggestions) {
      t.suggestionActive.set(suggestionActive !== undefined && suggestionActive < suggestions.length - 1 ? suggestionActive + 1 : 0);
      return;
    }

    if (evt.keyCode === 38 && suggestions) {
      t.suggestionActive.set(suggestionActive !== undefined && suggestionActive === 0 ? suggestions.length - 1 : suggestionActive - 1);
    }
  },

  'keyup #message-search': _.debounce(function (evt, t) {
    if (evt.keyCode === 13) {
      return evt.preventDefault();
    }

    const {
      value
    } = evt.target;

    if (evt.keyCode === 40 || evt.keyCode === 38) {
      return evt.preventDefault();
    }

    if (!t.provider.get().supportsSuggestions) {
      t.search(value);
    } else {
      t.suggest(value);
    }
  }, 300),

  'click .rocket-search-suggestion-item'(e, t) {
    if (this.action) {
      const value = this.action();

      if (value) {
        t.search(value);
      } else {
        t.suggestions.set();
      }
    } else {
      t.search(this.text);
    }
  },

  'mouseenter .rocket-search-suggestion-item'(e, t) {
    t.suggestionActive.set(t.suggestions.get().indexOf(this));
  }

};
Template.RocketSearch.helpers({
  error() {
    return Template.instance().error.get();
  },

  provider() {
    return Template.instance().provider.get();
  },

  scope() {
    return Template.instance().scope;
  },

  text() {
    return Template.instance().scope.text.get();
  },

  isActive() {
    return Template.instance().isActive.get();
  },

  suggestions() {
    return Template.instance().suggestions.get();
  },

  suggestionActive() {
    return Template.instance().suggestionActive.get();
  },

  suggestionSelected(index) {
    return Template.instance().suggestionActive.get() === index ? 'active' : '';
  }

}); // add closer to suggestions

Template.RocketSearch.onRendered(function () {
  $(document).on("click.suggestionclose.".concat(this.data.rid), () => {
    // if (e.target.id !== 'rocket-search-suggestions' && !$(e.target).parents('#rocket-search-suggestions').length) {
    this.suggestions.set(); // }
  });
  Tracker.autorun(c => {
    if (this.isActive.get() === true) {
      Tracker.afterFlush(() => {
        document.querySelector('#message-search').focus();
      });
      c.stop();
    }
  });
});
Template.RocketSearch.onDestroyed(function () {
  $(document).off("click.suggestionclose.".concat(this.data.rid));
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"style":{"style.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/style/style.css                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./search/search.html");
module.link("./search/search");
module.link("./provider/suggestion.html");
module.link("./provider/result.html");
module.link("./provider/result");
module.link("./style/style.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"threads":{"client":{"flextab":{"messageBoxFollow.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/messageBoxFollow.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBoxFollow.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBoxFollow.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/template.messageBoxFollow.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBoxFollow");
Template["messageBoxFollow"] = new Template("Template.messageBoxFollow", (function() {
  var view = this;
  return HTML.BUTTON({
    class: "js-follow rc-button rc-button--primary rc-message-box__join-button"
  }, "\n\t\t", Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Follow");
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"thread.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/thread.html                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.thread.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.thread.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/template.thread.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("thread");
Template["thread"] = new Template("Template.thread", (function() {
  var view = this;
  return HTML.SECTION({
    class: function() {
      return [ "contextual-bar__content flex-tab threads dropzone ", Spacebars.mustache(view.lookup("dragAndDrop")), " ", Spacebars.mustache(view.lookup("hideUsername")) ];
    }
  }, "\n\t\t", HTML.DIV({
    class: function() {
      return [ "dropzone-overlay ", Spacebars.mustache(view.lookup("isDropzoneDisabled")), " background-transparent-darkest color-content-background-color" ];
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), view.lookup("dragAndDropLabel"));
  })), "\n\t\t", HTML.DIV({
    class: "thread-list js-scroll-thread"
  }, "\n\t\t\t", HTML.UL({
    class: "thread"
  }, "\n\t\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isLoading"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.LI({
        class: "load-more"
      }, "\n\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          groupable: Spacebars.call(false),
          hideRoles: Spacebars.call(true),
          msg: Spacebars.call(view.lookup("mainMessage")),
          room: Spacebars.call(view.lookup("room")),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          customClass: Spacebars.call("thread-main"),
          templatePrefix: Spacebars.call("thread-"),
          u: Spacebars.call(view.lookup("u")),
          ignored: Spacebars.call(false),
          shouldCollapseReplies: Spacebars.call(true)
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      }), "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.call(view.lookup("messages")),
          _variable: "msg"
        };
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            hideRoles: Spacebars.call(true),
            msg: Spacebars.call(view.lookup("msg")),
            room: Spacebars.call(view.lookup("room")),
            shouldCollapseReplies: Spacebars.call(true),
            subscription: Spacebars.call(view.lookup("subscription")),
            settings: Spacebars.call(view.lookup("settings")),
            templatePrefix: Spacebars.call("thread-"),
            u: Spacebars.call(view.lookup("u")),
            context: Spacebars.call("threads")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("message"));
        }), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t" ];
  }), "\n\t\t\t"), "\n\t\t"), "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("messageBoxData"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messageBox"));
  }), "\n\t\t", HTML.FOOTER({
    class: "thread-footer"
  }, "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("checkboxData"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      style: "display: flex;"
    }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("."));
    }, function() {
      return Spacebars.include(view.lookupTemplate("Checkbox"));
    }), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t\t", HTML.LABEL({
    for: "sendAlso",
    class: "thread-footer__text"
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Also_send_to_channel");
  })), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxFollow.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/messageBoxFollow.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 1);
module.link("./messageBoxFollow.html");
Template.messageBoxFollow.events({
  'click .js-follow'() {
    const {
      tmid
    } = this;
    callWithErrorHandling('followMessage', {
      mid: tmid
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"thread.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/thread.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["context", "tab"],
      _excluded2 = ["_id"],
      _excluded3 = ["_id"];

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 0);

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 2);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 3);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 4);
let ReactiveDict;
module.link("meteor/reactive-dict", {
  ReactiveDict(v) {
    ReactiveDict = v;
  }

}, 5);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 6);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 7);
let chatMessages, ChatMessages;
module.link("../../../ui", {
  chatMessages(v) {
    chatMessages = v;
  },

  ChatMessages(v) {
    ChatMessages = v;
  }

}, 8);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 9);
let messageContext;
module.link("../../../ui-utils/client/lib/messageContext", {
  messageContext(v) {
    messageContext = v;
  }

}, 10);
let upsertMessageBulk;
module.link("../../../ui-utils/client/lib/RoomHistoryManager", {
  upsertMessageBulk(v) {
    upsertMessageBulk = v;
  }

}, 11);
let Messages;
module.link("../../../models", {
  Messages(v) {
    Messages = v;
  }

}, 12);
let fileUpload;
module.link("../../../ui/client/lib/fileUpload", {
  fileUpload(v) {
    fileUpload = v;
  }

}, 13);
let dropzoneEvents, dropzoneHelpers;
module.link("../../../ui/client/views/app/room", {
  dropzoneEvents(v) {
    dropzoneEvents = v;
  },

  dropzoneHelpers(v) {
    dropzoneHelpers = v;
  }

}, 14);
module.link("./thread.html");
let getUserPreference;
module.link("../../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 15);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 16);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 17);
module.link("./messageBoxFollow");
let getCommonRoomEvents;
module.link("../../../ui/client/views/app/lib/getCommonRoomEvents", {
  getCommonRoomEvents(v) {
    getCommonRoomEvents = v;
  }

}, 18);
let keyCodes;
module.link("../../../../client/lib/utils/keyCodes", {
  keyCodes(v) {
    keyCodes = v;
  }

}, 19);
const sort = {
  ts: 1
};
Template.thread.events(_objectSpread(_objectSpread(_objectSpread({}, dropzoneEvents), getCommonRoomEvents()), {}, {
  'click .js-close'(e) {
    e.preventDefault();
    e.stopPropagation();
    const {
      close
    } = this;
    return close && close();
  },

  'scroll .js-scroll-thread': _.throttle((_ref, i) => {
    let {
      currentTarget: e
    } = _ref;
    i.atBottom = e.scrollTop >= e.scrollHeight - e.clientHeight;
  }, 150),

  'click .toggle-hidden'(e) {
    const id = e.currentTarget.dataset.message;
    document.querySelector("#thread-".concat(id)).classList.toggle('message--ignored');
  }

}));
Template.thread.helpers(_objectSpread(_objectSpread({}, dropzoneHelpers), {}, {
  mainMessage() {
    const {
      Threads,
      state
    } = Template.instance();
    const tmid = state.get('tmid');
    return Threads.findOne({
      _id: tmid
    });
  },

  isLoading() {
    return Template.instance().state.get('loading') !== false;
  },

  messages() {
    const {
      Threads,
      state
    } = Template.instance();
    const tmid = state.get('tmid');
    return Threads.find({
      tmid,
      _id: {
        $ne: tmid
      }
    }, {
      sort
    });
  },

  messageContext() {
    const result = messageContext.call(this, {
      rid: this.mainMessage.rid
    });
    return _objectSpread(_objectSpread({}, result), {}, {
      settings: _objectSpread(_objectSpread({}, result.settings), {}, {
        showReplyButton: false,
        showreply: false
      })
    });
  },

  messageBoxData() {
    const instance = Template.instance();
    const {
      mainMessage: {
        rid,
        _id: tmid
      },
      subscription
    } = Template.currentData();
    const showFormattingTips = settings.get('Message_ShowFormattingTips');
    return {
      showFormattingTips,
      tshow: instance.state.get('sendToChannel'),
      subscription,
      rid,
      tmid,
      onSend: function () {
        instance.sendToBottom();
        instance.state.set('sendToChannel', false);

        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        return instance.chatMessages && instance.chatMessages.send.apply(instance.chatMessages, args);
      },
      onKeyUp: function () {
        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
          args[_key2] = arguments[_key2];
        }

        return instance.chatMessages && instance.chatMessages.keyup.apply(instance.chatMessages, args);
      },
      onKeyDown: function () {
        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
          args[_key3] = arguments[_key3];
        }

        const result = instance.chatMessages && instance.chatMessages.keydown.apply(instance.chatMessages, args);
        const [event] = args;
        const {
          which: keyCode
        } = event;

        if (keyCode === keyCodes.ESCAPE && !result && !event.target.value.trim()) {
          const _FlowRouter$current = FlowRouter.current(),
                {
            route: {
              name
            },
            params: {
              context,
              tab
            }
          } = _FlowRouter$current,
                params = _objectWithoutProperties(_FlowRouter$current.params, _excluded);

          FlowRouter.go(name, params);
        }
      }
    };
  },

  hideUsername() {
    return getUserPreference(Meteor.userId(), 'hideUsernames') ? 'hide-usernames' : undefined;
  },

  checkboxData() {
    const instance = Template.instance();
    const checked = instance.state.get('sendToChannel');
    return {
      id: 'sendAlso',
      checked,
      onChange: () => instance.state.set('sendToChannel', !checked)
    };
  }

}));
Template.thread.onRendered(function () {
  const rid = Tracker.nonreactive(() => this.state.get('rid'));
  const tmid = Tracker.nonreactive(() => this.state.get('tmid'));
  this.atBottom = true;
  this.chatMessages = new ChatMessages(this.Threads);
  this.chatMessages.initializeWrapper(this.find('.js-scroll-thread'));
  this.chatMessages.initializeInput(this.find('.js-input-message'), {
    rid,
    tmid
  });
  this.sendToBottom = _.throttle(() => {
    this.atBottom = true;
    this.chatMessages.wrapper.scrollTop = this.chatMessages.wrapper.scrollHeight;
  }, 300);

  this.sendToBottomIfNecessary = () => {
    this.atBottom && this.sendToBottom();
  };

  const observer = new ResizeObserver(this.sendToBottomIfNecessary);
  observer.observe(this.firstNode.querySelector('.js-scroll-thread ul'));

  this.onFile = filesToUpload => {
    fileUpload(filesToUpload, this.chatMessages.input, {
      rid: this.state.get('rid'),
      tmid: this.state.get('tmid')
    });
  };

  this.autorun(() => {
    const rid = this.state.get('rid');
    const tmid = this.state.get('tmid');

    if (!rid) {
      return;
    }

    this.callbackRemove && this.callbackRemove();

    this.callbackRemove = () => callbacks.remove('streamNewMessage', "thread-".concat(rid));

    callbacks.add('streamNewMessage', _.debounce(msg => {
      if (Session.get('openedRoom') !== msg.rid || rid !== msg.rid || msg.editedAt || msg.tmid !== tmid) {
        return;
      }

      Meteor.call('readThreads', tmid);
    }, 1000), callbacks.priority.MEDIUM, "thread-".concat(rid));
  });
  this.autorun(() => {
    const tmid = this.state.get('tmid');
    this.threadsObserve && this.threadsObserve.stop();
    this.threadsObserve = Messages.find({
      $or: [{
        tmid
      }, {
        _id: tmid
      }],
      _hidden: {
        $ne: true
      }
    }, {
      fields: {
        collapsed: 0,
        threadMsg: 0,
        repliesCount: 0
      }
    }).observe({
      added: _ref2 => {
        let {
          _id
        } = _ref2,
            message = _objectWithoutProperties(_ref2, _excluded2);

        this.Threads.upsert({
          _id
        }, message);
      },
      changed: _ref3 => {
        let {
          _id
        } = _ref3,
            message = _objectWithoutProperties(_ref3, _excluded3);

        this.Threads.update({
          _id
        }, message);
      },
      removed: _ref4 => {
        let {
          _id
        } = _ref4;
        return this.Threads.remove(_id);
      }
    });
    this.loadMore();
  });
  this.autorun(() => {
    const rid = this.state.get('rid');
    const tmid = this.state.get('tmid');
    this.chatMessages.initializeInput(this.find('.js-input-message'), {
      rid,
      tmid
    });

    if (rid && tmid) {
      chatMessages["".concat(rid, "-").concat(tmid)] = this.chatMessages;
    }
  });
  this.autorun(() => {
    FlowRouter.watchPathChange();
    const jump = FlowRouter.getQueryParam('jump');
    const {
      mainMessage
    } = Template.currentData();
    this.state.set({
      tmid: mainMessage._id,
      rid: mainMessage.rid,
      jump
    });
  });
  this.autorun(() => {
    const jump = this.state.get('jump');
    const loading = this.state.get('loading');

    if (jump && this.lastJump !== jump && loading === false) {
      this.lastJump = jump;
      this.find('.js-scroll-thread').style.scrollBehavior = 'smooth';
      this.state.set('jump', null);
      Tracker.afterFlush(() => {
        const message = this.find("#thread-".concat(jump));
        message.classList.add('highlight');

        const removeClass = () => {
          message.classList.remove('highlight');
          message.removeEventListener('animationend', removeClass);
        };

        message.addEventListener('animationend', removeClass);
        setTimeout(() => {
          message.scrollIntoView();
        }, 300);
      });
    }
  });
});
Template.thread.onCreated(async function () {
  this.Threads = new Mongo.Collection(null);
  this.state = new ReactiveDict({
    sendToChannel: !this.data.mainMessage.tcount
  });

  this.loadMore = async () => {
    const {
      tmid
    } = Tracker.nonreactive(() => this.state.all());

    if (!tmid) {
      return;
    }

    this.state.set('loading', true);
    const messages = await callWithErrorHandling('getThreadMessages', {
      tmid
    });
    upsertMessageBulk({
      msgs: messages
    }, this.Threads);
    Tracker.afterFlush(() => {
      this.state.set('loading', false);
    });
  };
});
Template.thread.onDestroyed(function () {
  const {
    Threads,
    threadsObserve,
    callbackRemove,
    state,
    chatMessages
  } = this;
  Threads.remove({});
  threadsObserve && threadsObserve.stop();
  callbackRemove && callbackRemove();
  const tmid = state.get('tmid');
  const rid = state.get('rid');

  if (rid && tmid) {
    chatMessages.onDestroyed && chatMessages.onDestroyed(rid, tmid);
    delete chatMessages["".concat(rid, "-").concat(tmid)];
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"threadlist.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/threadlist.tsx                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let React, useMemo, lazy;
module.link("react", {
  default(v) {
    React = v;
  },

  useMemo(v) {
    useMemo = v;
  },

  lazy(v) {
    lazy = v;
  }

}, 0);
let addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
let useSetting;
module.link("../../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 2);
let Header;
module.link("../../../../client/components/Header", {
  default(v) {
    Header = v;
  }

}, 3);

const getVariant = (tunreadUser, tunreadGroup) => {
  if (tunreadUser > 0) {
    return 'danger';
  }

  if (tunreadGroup > 0) {
    return 'warning';
  }

  return 'primary';
};

const template = /*#__PURE__*/lazy(() => module.dynamicImport('../../../../client/views/room/contextualBar/Threads'));
addAction('thread', options => {
  var _room$tunread2, _room$tunreadUser2, _room$tunreadGroup2;

  const room = options.room;
  const threadsEnabled = useSetting('Threads_enabled');
  return useMemo(() => threadsEnabled ? {
    groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
    id: 'thread',
    full: true,
    title: 'Threads',
    icon: 'thread',
    template,
    renderAction: props => {
      var _room$tunread, _room$tunreadUser, _room$tunreadGroup;

      const tunread = ((_room$tunread = room.tunread) === null || _room$tunread === void 0 ? void 0 : _room$tunread.length) || 0;
      const tunreadUser = ((_room$tunreadUser = room.tunreadUser) === null || _room$tunreadUser === void 0 ? void 0 : _room$tunreadUser.length) || 0;
      const tunreadGroup = ((_room$tunreadGroup = room.tunreadGroup) === null || _room$tunreadGroup === void 0 ? void 0 : _room$tunreadGroup.length) || 0;
      const unread = tunread > 99 ? '99+' : tunread;
      const variant = getVariant(tunreadUser, tunreadGroup);
      return /*#__PURE__*/React.createElement(Header.ToolBoxAction, props, unread > 0 && /*#__PURE__*/React.createElement(Header.Badge, {
        variant: variant
      }, unread));
    },
    order: 2
  } : null, [threadsEnabled, (_room$tunread2 = room.tunread) === null || _room$tunread2 === void 0 ? void 0 : _room$tunread2.length, (_room$tunreadUser2 = room.tunreadUser) === null || _room$tunreadUser2 === void 0 ? void 0 : _room$tunreadUser2.length, (_room$tunreadGroup2 = room.tunreadGroup) === null || _room$tunreadGroup2 === void 0 ? void 0 : _room$tunreadGroup2.length]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"threads.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/threads.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../threads.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"normalizeThreadTitle.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/lib/normalizeThreadTitle.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 1);
module.export({
  normalizeThreadTitle: () => normalizeThreadTitle
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 1);
let filterMarkdown;
module.link("../../../markdown/lib/markdown", {
  filterMarkdown(v) {
    filterMarkdown = v;
  }

}, 2);
let Users;
module.link("../../../models/client", {
  Users(v) {
    Users = v;
  }

}, 3);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 4);
let MentionsParser;
module.link("../../../mentions/lib/MentionsParser", {
  MentionsParser(v) {
    MentionsParser = v;
  }

}, 5);
let emojiParser;
module.link("../../../emoji/client/emojiParser.js", {
  emojiParser(v) {
    emojiParser = v;
  }

}, 6);

const normalizeThreadTitle = _ref => {
  let message = _extends({}, _ref);

  if (message.msg) {
    const filteredMessage = filterMarkdown(escapeHTML(message.msg));

    if (!message.channels && !message.mentions) {
      return filteredMessage;
    }

    const uid = Meteor.userId();
    const me = uid && (Users.findOne(uid, {
      fields: {
        username: 1
      }
    }) || {}).username;
    const pattern = settings.get('UTF8_User_Names_Validation');
    const useRealName = settings.get('UI_Use_Real_Name');
    const instance = new MentionsParser({
      pattern: () => pattern,
      useRealName: () => useRealName,
      me: () => me,
      userTemplate: _ref2 => {
        let {
          label
        } = _ref2;
        return "<strong> ".concat(label, " </strong>");
      },
      roomTemplate: _ref3 => {
        let {
          prefix,
          mention
        } = _ref3;
        return "".concat(prefix, "<strong> ").concat(mention, " </strong>");
      }
    });
    const {
      html
    } = emojiParser({
      html: filteredMessage
    });
    return instance.parse(_objectSpread(_objectSpread({}, message), {}, {
      msg: filteredMessage,
      html
    })).html;
  }

  if (message.attachments) {
    const attachment = message.attachments.find(attachment => attachment.title || attachment.description);

    if (attachment && attachment.description) {
      return escapeHTML(attachment.description);
    }

    if (attachment && attachment.title) {
      return escapeHTML(attachment.title);
    }
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"messageAction":{"follow.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/messageAction/follow.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 2);
let Messages;
module.link("../../../models/client", {
  Messages(v) {
    Messages = v;
  }

}, 3);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 4);
let MessageAction;
module.link("../../../ui-utils/client", {
  MessageAction(v) {
    MessageAction = v;
  }

}, 5);
let messageArgs;
module.link("../../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 6);
let roomTypes;
module.link("../../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 7);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 8);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 9);
Meteor.startup(function () {
  Tracker.autorun(() => {
    if (!settings.get('Threads_enabled')) {
      return MessageAction.removeButton('follow-message');
    }

    MessageAction.addButton({
      id: 'follow-message',
      icon: 'bell',
      label: 'Follow_message',
      context: ['message', 'message-mobile', 'threads'],

      async action() {
        const {
          msg
        } = messageArgs(this);
        callWithErrorHandling('followMessage', {
          mid: msg._id
        }).then(() => dispatchToastMessage({
          type: 'success',
          message: TAPi18n.__('You_followed_this_message')
        }));
      },

      condition(_ref, context) {
        let {
          msg: {
            _id,
            tmid,
            replies = []
          },
          u,
          room
        } = _ref;

        if (tmid || context) {
          const parentMessage = Messages.findOne({
            _id: tmid || _id
          }, {
            fields: {
              replies: 1
            }
          });

          if (parentMessage) {
            replies = parentMessage.replies || [];
          }
        }

        const isLivechatRoom = roomTypes.isLivechatRoom(room.t);

        if (isLivechatRoom) {
          return false;
        }

        return !replies.includes(u._id);
      },

      order: 2,
      group: 'menu'
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"replyInThread.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/messageAction/replyInThread.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 2);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let MessageAction;
module.link("../../../ui-utils/client", {
  MessageAction(v) {
    MessageAction = v;
  }

}, 4);
let messageArgs;
module.link("../../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 5);
let roomTypes;
module.link("../../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 6);
Meteor.startup(function () {
  Tracker.autorun(() => {
    if (!settings.get('Threads_enabled')) {
      return MessageAction.removeButton('reply-in-thread');
    }

    MessageAction.addButton({
      id: 'reply-in-thread',
      icon: 'thread',
      label: 'Reply_in_thread',
      context: ['message', 'message-mobile'],

      action(e) {
        const {
          msg: message
        } = messageArgs(this);
        e.stopPropagation();
        FlowRouter.setParams({
          tab: 'thread',
          context: message.tmid || message._id
        });
      },

      condition(_ref) {
        let {
          subscription,
          room
        } = _ref;
        const isLivechatRoom = roomTypes.isLivechatRoom(room.t);

        if (isLivechatRoom) {
          return false;
        }

        return Boolean(subscription);
      },

      order: -1,
      group: ['message', 'menu']
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"unfollow.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/messageAction/unfollow.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 2);
let Messages;
module.link("../../../models/client", {
  Messages(v) {
    Messages = v;
  }

}, 3);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 4);
let MessageAction;
module.link("../../../ui-utils/client", {
  MessageAction(v) {
    MessageAction = v;
  }

}, 5);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 6);
let messageArgs;
module.link("../../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 7);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 8);
Meteor.startup(function () {
  Tracker.autorun(() => {
    if (!settings.get('Threads_enabled')) {
      return MessageAction.removeButton('unfollow-message');
    }

    MessageAction.addButton({
      id: 'unfollow-message',
      icon: 'bell-off',
      label: 'Unfollow_message',
      context: ['message', 'message-mobile', 'threads'],

      async action() {
        const {
          msg
        } = messageArgs(this);
        callWithErrorHandling('unfollowMessage', {
          mid: msg._id
        }).then(() => dispatchToastMessage({
          type: 'success',
          message: TAPi18n.__('You_unfollowed_this_message')
        }));
      },

      condition(_ref, context) {
        let {
          msg: {
            _id,
            tmid,
            replies = []
          },
          u
        } = _ref;

        if (tmid || context) {
          const parentMessage = Messages.findOne({
            _id: tmid || _id
          }, {
            fields: {
              replies: 1
            }
          });

          if (parentMessage) {
            replies = parentMessage.replies || [];
          }
        }

        return replies.includes(u._id);
      },

      order: 2,
      group: 'menu'
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/index.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./flextab/threadlist");
module.link("./flextab/thread");
module.link("./flextab/threads");
module.link("./messageAction/follow");
module.link("./messageAction/unfollow");
module.link("./messageAction/replyInThread");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"threads.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/threads.css                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-account":{"client":{"avatar":{"avatar.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-account/client/avatar/avatar.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.avatar.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.avatar.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-account/client/avatar/template.avatar.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("avatar");
Template["avatar"] = new Template("Template.avatar", (function() {
  var view = this;
  return HTML.DIV({
    class: "avatar"
  }, "\n\t\t", Blaze._TemplateWith(function() {
    return {
      src: Spacebars.call(view.lookup("src")),
      alt: Spacebars.call(view.lookup("alt")),
      class: Spacebars.call("avatar-image"),
      placeholder: Spacebars.call(true)
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("lazyloadImage"));
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"avatar.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-account/client/avatar/avatar.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let Rooms;
module.link("../../../models/client", {
  Rooms(v) {
    Rooms = v;
  }

}, 2);
let getRoomAvatarURL;
module.link("../../../utils/lib/getRoomAvatarURL", {
  getRoomAvatarURL(v) {
    getRoomAvatarURL = v;
  }

}, 3);
let getUserAvatarURL;
module.link("../../../utils/lib/getUserAvatarURL", {
  getUserAvatarURL(v) {
    getUserAvatarURL = v;
  }

}, 4);

const getUsername = _ref => {
  let {
    userId,
    username
  } = _ref;
  const query = {};

  if (username) {
    query.username = username;
  }

  if (userId) {
    query._id = userId;
  }

  const user = Meteor.users.findOne(query, {
    fields: {
      username: 1,
      avatarETag: 1
    }
  });

  if (!user) {
    return {};
  }

  return user;
};

const getRoomETag = rid => Rooms.findOne({
  _id: rid
}, {
  fields: {
    avatarETag: 1
  }
});

Template.avatar.helpers({
  src() {
    const {
      url,
      rid
    } = Template.instance().data;

    if (url) {
      return url;
    }

    if (rid) {
      const {
        avatarETag
      } = getRoomETag(rid) || {};
      return getRoomAvatarURL(rid, avatarETag);
    }

    if (this.roomIcon && this.username) {
      return getUserAvatarURL("@".concat(this.username));
    }

    const {
      username,
      avatarETag
    } = getUsername(this);

    if (!username) {
      if (this.username) {
        return getUserAvatarURL(this.username);
      }

      return;
    }

    return getUserAvatarURL(username, avatarETag);
  },

  alt() {
    const {
      username
    } = getUsername(this);
    return username;
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-account/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./avatar/avatar.html");
module.link("./avatar/avatar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-login":{"client":{"login":{"form.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/form.html                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.form.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.form.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/template.form.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("loginForm");
Template["loginForm"] = new Template("Template.loginForm", (function() {
  var view = this;
  return [ HTML.FORM({
    id: "login-card",
    class: "content-background-color color-primary-font-color",
    method: "/",
    novalidate: ""
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.dataMustache(view.lookup("state"), "wait-activation");
  }, function() {
    return [ "\n\t\t\t", HTML.HEADER("\n\t\t\t\t", HTML.H2({
      "data-i18n": "Registration_Succeeded"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Registration_Succeeded"));
    })), "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Wait_activation_warning");
    })), "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Please_wait_activation");
    })), "\n\t\t\t"), "\n\t\t" ];
  }, function() {
    return Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("state"), "wait-email-activation");
    }, function() {
      return [ "\n\t\t\t", HTML.HEADER("\n\t\t\t\t", HTML.H2({
        "data-i18n": "Registration_Succeeded"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Registration_Succeeded"));
      })), "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "We_have_sent_registration_email");
      })), "\n\t\t\t"), "\n\t\t" ];
    }, function() {
      return [ "\n\t\t\t", Spacebars.include(view.lookupTemplate("loginServices")), "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("needsValidateEmail"));
      }, function() {
        return [ "\n\t\t\t\t", HTML.DIV({
          class: "alert error-color error-background error-border"
        }, "\n\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "You_need_confirm_email");
        }), "\n\t\t\t\t"), "\n\t\t\t" ];
      }), "\n\n\t\t\t", HTML.DIV({
        class: "fields"
      }, "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("state"), "login");
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("showFormLogin"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label",
            for: "emailOrUsername"
          }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
            name: "emailOrUsername",
            id: "emailOrUsername",
            type: "text",
            class: "rc-input__element",
            autocapitalize: "off",
            autocorrect: "off",
            placeholder: function() {
              return Spacebars.mustache(view.lookup("emailOrUsernamePlaceholder"));
            },
            autofocus: ""
          }), HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label",
            for: "pass"
          }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
            name: "pass",
            id: "pass",
            type: "password",
            class: "rc-input__element",
            autocapitalize: "off",
            autocorrect: "off",
            placeholder: function() {
              return Spacebars.mustache(view.lookup("passwordPlaceholder"));
            },
            autofocus: ""
          }), HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("state"), "register");
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-input"
        }, "\n\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-input__label",
          for: "name"
        }, "\n\t\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input__wrapper"
        }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
          name: "name",
          id: "name",
          type: "text",
          class: "rc-input__element",
          autocapitalize: "off",
          autocorrect: "off",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("namePlaceholder"));
          },
          autofocus: ""
        }), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-input"
        }, "\n\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-input__label",
          for: "email"
        }, "\n\t\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input__wrapper"
        }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
          name: "email",
          id: "email",
          type: "text",
          class: "rc-input__element",
          autocapitalize: "off",
          autocorrect: "off",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("_"), "Email");
          },
          autofocus: ""
        }), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\n\t\t\t\t\t", HTML.DIV({
          class: "rc-input"
        }, "\n\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-input__label",
          for: "pass"
        }, "\n\t\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input__wrapper"
        }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
          name: "pass",
          id: "pass",
          type: "password",
          class: "rc-input__element",
          autocapitalize: "off",
          autocorrect: "off",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("passwordPlaceholder"));
          },
          autofocus: ""
        }), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("requirePasswordConfirmation"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label",
            for: "confirm-pass"
          }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
            name: "confirm-pass",
            id: "confirm-pass",
            type: "password",
            class: "rc-input__element",
            autocapitalize: "off",
            autocorrect: "off",
            placeholder: function() {
              return Spacebars.mustache(view.lookup("confirmPasswordPlaceholder"));
            },
            autofocus: ""
          }), HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("manuallyApproveNewUsers"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label",
            for: "confirm-pass"
          }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
            name: "reason",
            id: "reason",
            type: "text",
            class: "rc-input__element",
            autocapitalize: "off",
            autocorrect: "off",
            placeholder: function() {
              return Spacebars.mustache(view.lookup("_"), "Reason_To_Join");
            },
            autofocus: ""
          }), HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("state"), "forgot-password", "email-verification");
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-input"
        }, "\n\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-input__label",
          for: "email"
        }, "\n\t\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input__wrapper"
        }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
          name: "email",
          id: "email",
          type: "text",
          class: "rc-input__element",
          autocapitalize: "off",
          autocorrect: "off",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("_"), "Email");
          },
          autofocus: "",
          value: function() {
            return Blaze.If(function() {
              return Spacebars.dataMustache(view.lookup("state"), "email-verification");
            }, function() {
              return Blaze.View("lookup:typedEmail", function() {
                return Spacebars.mustache(view.lookup("typedEmail"));
              });
            });
          }
        }), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\n\t\t\t", HTML.DIV({
        class: "rc-button__group rc-button__group--vertical"
      }, "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("state"), "login");
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("showFormLogin"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.BUTTON({
            class: "rc-button rc-button--primary login"
          }, Blaze.View("lookup:btnLoginSave", function() {
            return Spacebars.mustache(view.lookup("btnLoginSave"));
          })), "\n\n\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("passwordResetAllowed"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
              type: "button",
              class: "rc-button rc-button--nude forgot-password"
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Forgot_password");
            })), "\n\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t" ];
        }), "\n\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("registrationAllowed"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.BUTTON({
            type: "button",
            class: "rc-button rc-button--nude register"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), "Register");
          })), "\n\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("linkReplacementText"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
              class: "register-link-replacement"
            }, "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:linkReplacementText", function() {
              return Spacebars.makeRaw(Spacebars.mustache(view.lookup("linkReplacementText")));
            }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-button__group rc-button__group--vertical"
        }, "\n\t\t\t\t\t\t", HTML.BUTTON({
          class: "rc-button rc-button--primary login"
        }, Blaze.View("lookup:btnLoginSave", function() {
          return Spacebars.mustache(view.lookup("btnLoginSave"));
        })), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\t\t" ];
    });
  }), "\n\t\t", Blaze.Unless(function() {
    return Spacebars.dataMustache(view.lookup("state"), "login");
  }, function() {
    return [ "\n\t\t\t", HTML.DIV({
      class: "rc-button__group rc-button__group--vertical"
    }, "\n\t\t\t\t", HTML.BUTTON({
      type: "button",
      class: "rc-button rc-button--nude back-to-login"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Back_to_login");
    })), "\n\t\t\t"), "\n\t\t" ];
  }), "\n\t"), "\n\t", HTML.DIV({
    class: "login-terms"
  }, "\n\t\t", Blaze.View("lookup:loginTerms", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("loginTerms")));
  }), HTML.Raw('\n\t\t<div class="powered-by">\n\t\t\tPowered by <a class="color-tertiary-font-color" href="https://rocket.chat">Open Source Chat Platform Rocket.Chat</a>.\n\t\t</div>\n\t')) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"layout.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/layout.html                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.layout.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.layout.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/template.layout.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("loginLayout");
Template["loginLayout"] = new Template("Template.loginLayout", (function() {
  var view = this;
  return HTML.SECTION({
    class: "rc-old full-page color-tertiary-font-color",
    style: function() {
      return Spacebars.With(function() {
        return Spacebars.call(view.lookup("backgroundUrl"));
      }, function() {
        return [ "background-image: url('", Blaze.View("lookup:.", function() {
          return Spacebars.mustache(view.lookup("."));
        }), "')" ];
      });
    }
  }, "\n\t\t", HTML.DIV({
    class: "wrapper"
  }, "\n\t\t\t", Spacebars.include(view.lookupTemplate("loginLayoutHeader")), "\n\t\t\t", Spacebars.include(view.lookupTemplate("loginForm")), "\n\t\t\t", Spacebars.include(view.lookupTemplate("loginLayoutFooter")), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"services.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/services.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.services.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.services.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/template.services.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("loginServices");
Template["loginServices"] = new Template("Template.loginServices", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("loginService"), "length"));
  }, function() {
    return [ "\n\t", HTML.DIV({
      class: "oauth-login buttons-group"
    }, "\n\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("loginService"));
    }, function() {
      return [ "\n\t\t", HTML.BUTTON({
        type: "button",
        class: function() {
          return [ "rc-button rc-button--secondary external-login ", Spacebars.mustache(Spacebars.dot(view.lookup("service"), "service")) ];
        },
        title: function() {
          return Spacebars.mustache(view.lookup("displayName"));
        },
        style: function() {
          return [ Blaze.If(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("service"), "buttonColor"));
          }, function() {
            return [ "background-color:", Blaze.View("lookup:service.buttonColor", function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("service"), "buttonColor"));
            }), ";" ];
          }), Blaze.If(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("service"), "buttonLabelColor"));
          }, function() {
            return [ "color:", Blaze.View("lookup:service.buttonLabelColor", function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("service"), "buttonLabelColor"));
            }), ";" ];
          }) ];
        }
      }, "\n\t\t\t", HTML.I({
        class: function() {
          return [ "icon-", Spacebars.mustache(view.lookup("icon")), " service-icon" ];
        }
      }), HTML.Raw('<i class="icon-spin animate-spin loading-icon hidden"></i>'), HTML.SPAN(Blaze.View("lookup:service.buttonLabelText", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("service"), "buttonLabelText"));
      })), "\n\t\t"), "\n\t\t" ];
    }), "\n\t"), "\n\t" ];
  }), " ", Spacebars.include(view.lookupTemplate("AppleOauthButton")) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"form.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/form.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 3);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 4);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 5);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 6);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 7);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 8);
let t;
module.link("../../../utils", {
  t(v) {
    t = v;
  }

}, 9);
let handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 10);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 11);
Template.loginForm.helpers({
  userName() {
    const user = Meteor.user();
    return user && user.username;
  },

  namePlaceholder() {
    if (settings.get('Accounts_RequireNameForSignUp')) {
      return t('Name');
    }

    return t('Name_optional');
  },

  showFormLogin() {
    return settings.get('Accounts_ShowFormLogin');
  },

  state() {
    for (var _len = arguments.length, state = new Array(_len), _key = 0; _key < _len; _key++) {
      state[_key] = arguments[_key];
    }

    return state.indexOf(Template.instance().state.get()) > -1;
  },

  btnLoginSave() {
    if (Template.instance().loading.get()) {
      return "".concat(t('Please_wait'), "...");
    }

    switch (Template.instance().state.get()) {
      case 'register':
        return t('Register');

      case 'login':
        return t('Login');

      case 'email-verification':
        return t('Send_confirmation_email');

      case 'forgot-password':
        return t('Reset_password');
    }
  },

  loginTerms() {
    return settings.get('Layout_Login_Terms');
  },

  registrationAllowed() {
    const validSecretUrl = Template.instance().validSecretURL;
    return settings.get('Accounts_RegistrationForm') === 'Public' || validSecretUrl && validSecretUrl.get();
  },

  linkReplacementText() {
    return settings.get('Accounts_RegistrationForm_LinkReplacementText');
  },

  passwordResetAllowed() {
    return settings.get('Accounts_PasswordReset');
  },

  requirePasswordConfirmation() {
    return settings.get('Accounts_RequirePasswordConfirmation');
  },

  emailOrUsernamePlaceholder() {
    return settings.get('Accounts_EmailOrUsernamePlaceholder') || t('Email_or_username');
  },

  passwordPlaceholder() {
    return settings.get('Accounts_PasswordPlaceholder') || t('Password');
  },

  confirmPasswordPlaceholder() {
    return settings.get('Accounts_ConfirmPasswordPlaceholder') || t('Confirm_password');
  },

  manuallyApproveNewUsers() {
    return settings.get('Accounts_ManuallyApproveNewUsers');
  },

  typedEmail() {
    var _Template$instance$ty;

    return (_Template$instance$ty = Template.instance().typedEmail) === null || _Template$instance$ty === void 0 ? void 0 : _Template$instance$ty.trim();
  }

});
Template.loginForm.events({
  'submit #login-card'(event, instance) {
    event.preventDefault();
    $(event.target).find('button.login').focus();
    instance.loading.set(true);
    const formData = instance.validate();
    const state = instance.state.get();

    if (formData) {
      var _formData$emailOrUser;

      if (state === 'email-verification') {
        var _formData$email;

        Meteor.call('sendConfirmationEmail', (_formData$email = formData.email) === null || _formData$email === void 0 ? void 0 : _formData$email.trim(), () => {
          instance.loading.set(false);
          callbacks.run('userConfirmationEmailRequested');
          dispatchToastMessage({
            type: 'success',
            message: t('We_have_sent_registration_email')
          });
          return instance.state.set('login');
        });
        return;
      }

      if (state === 'forgot-password') {
        var _formData$email2;

        Meteor.call('sendForgotPasswordEmail', (_formData$email2 = formData.email) === null || _formData$email2 === void 0 ? void 0 : _formData$email2.trim(), err => {
          if (err) {
            handleError(err);
            return instance.state.set('login');
          }

          instance.loading.set(false);
          callbacks.run('userForgotPasswordEmailRequested');
          dispatchToastMessage({
            type: 'success',
            message: t('If_this_email_is_registered')
          });
          return instance.state.set('login');
        });
        return;
      }

      if (state === 'register') {
        formData.secretURL = FlowRouter.getParam('hash');
        return Meteor.call('registerUser', formData, function (error) {
          var _formData$email3;

          instance.loading.set(false);

          if (error != null) {
            if (error.reason === 'Email already exists.') {
              dispatchToastMessage({
                type: 'error',
                message: t('Email_already_exists')
              });
            } else {
              handleError(error);
            }

            return;
          }

          callbacks.run('userRegistered');
          return Meteor.loginWithPassword((_formData$email3 = formData.email) === null || _formData$email3 === void 0 ? void 0 : _formData$email3.trim(), formData.pass, function (error) {
            if (error && error.error === 'error-invalid-email') {
              return instance.state.set('wait-email-activation');
            }

            if (error && error.error === 'error-user-is-not-activated') {
              return instance.state.set('wait-activation');
            }

            Session.set('forceLogin', false);
          });
        });
      }

      let loginMethod = 'loginWithPassword';

      if (settings.get('LDAP_Enable')) {
        loginMethod = 'loginWithLDAP';
      }

      if (settings.get('CROWD_Enable')) {
        loginMethod = 'loginWithCrowd';
      }

      return Meteor[loginMethod]((_formData$emailOrUser = formData.emailOrUsername) === null || _formData$emailOrUser === void 0 ? void 0 : _formData$emailOrUser.trim(), formData.pass, function (error) {
        instance.loading.set(false);

        if (error != null) {
          switch (error.error) {
            case 'error-user-is-not-activated':
              return dispatchToastMessage({
                type: 'error',
                message: t('Wait_activation_warning')
              });

            case 'error-invalid-email':
              instance.typedEmail = formData.emailOrUsername;
              return instance.state.set('email-verification');

            case 'error-app-user-is-not-allowed-to-login':
              dispatchToastMessage({
                type: 'error',
                message: t('App_user_not_allowed_to_login')
              });
              break;

            case 'error-login-blocked-for-ip':
              dispatchToastMessage({
                type: 'error',
                message: t('Error_login_blocked_for_ip')
              });
              break;

            case 'error-login-blocked-for-user':
              dispatchToastMessage({
                type: 'error',
                message: t('Error_login_blocked_for_user')
              });
              break;

            case 'error-license-user-limit-reached':
              dispatchToastMessage({
                type: 'error',
                message: t('error-license-user-limit-reached')
              });
              break;

            default:
              return dispatchToastMessage({
                type: 'error',
                message: t('User_not_found_or_incorrect_password')
              });
          }
        }

        Session.set('forceLogin', false);
      });
    }
  },

  'click .register'() {
    Template.instance().state.set('register');
    return callbacks.run('loginPageStateChange', Template.instance().state.get());
  },

  'click .back-to-login'() {
    Template.instance().state.set('login');
    return callbacks.run('loginPageStateChange', Template.instance().state.get());
  },

  'click .forgot-password'() {
    Template.instance().state.set('forgot-password');
    return callbacks.run('loginPageStateChange', Template.instance().state.get());
  }

});
Template.loginForm.onCreated(function () {
  const instance = this;
  this.loading = new ReactiveVar(false);

  if (Session.get('loginDefaultState')) {
    this.state = new ReactiveVar(Session.get('loginDefaultState'));
  } else {
    this.state = new ReactiveVar('login');
  }

  Tracker.autorun(() => {
    const registrationForm = settings.get('Accounts_RegistrationForm');

    if (registrationForm === 'Disabled' && this.state.get() === 'register') {
      this.state.set('login');
    }
  });
  this.validSecretURL = new ReactiveVar(false);

  this.validate = function () {
    const formData = $('#login-card').serializeArray();
    const formObj = {};
    const validationObj = {};
    formData.forEach(field => {
      formObj[field.name] = field.value;
    });
    const state = instance.state.get();

    if (state !== 'login') {
      if (!(formObj.email && /\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]+\b/i.test(formObj.email))) {
        validationObj.email = t('Invalid_email');
      }
    }

    if (state === 'login') {
      if (!formObj.emailOrUsername) {
        validationObj.emailOrUsername = t('Invalid_email');
      }
    }

    if (state !== 'forgot-password' && state !== 'email-verification') {
      if (!formObj.pass) {
        validationObj.pass = t('Invalid_pass');
      }
    }

    if (state === 'register') {
      if (settings.get('Accounts_RequireNameForSignUp') && !formObj.name) {
        validationObj.name = t('Invalid_name');
      }

      if (settings.get('Accounts_RequirePasswordConfirmation') && formObj['confirm-pass'] !== formObj.pass) {
        validationObj['confirm-pass'] = t('Invalid_confirm_pass');
      }

      if (settings.get('Accounts_ManuallyApproveNewUsers') && !formObj.reason) {
        validationObj.reason = t('Invalid_reason');
      }
    }

    $('#login-card h2').removeClass('error');
    $('#login-card input.error, #login-card select.error').removeClass('error');
    $('#login-card .input-error').text('');

    if (!_.isEmpty(validationObj)) {
      $('#login-card h2').addClass('error');
      Object.keys(validationObj).forEach(key => {
        const value = validationObj[key];
        $("#login-card input[name=".concat(key, "], #login-card select[name=").concat(key, "]")).addClass('error');
        $("#login-card input[name=".concat(key, "]~.input-error, #login-card select[name=").concat(key, "]~.input-error")).text(value);
      });
      instance.loading.set(false);
      return false;
    }

    return formObj;
  };

  if (FlowRouter.getParam('hash')) {
    return Meteor.call('checkRegistrationSecretURL', FlowRouter.getParam('hash'), () => this.validSecretURL.set(true));
  }
});
Template.loginForm.onRendered(function () {
  Session.set('loginDefaultState');
  return Tracker.autorun(() => {
    callbacks.run('loginPageStateChange', this.state.get());

    switch (this.state.get()) {
      case 'login':
      case 'forgot-password':
      case 'email-verification':
        return Meteor.defer(function () {
          return $('input[name=email]').select().focus();
        });

      case 'register':
        return Meteor.defer(function () {
          return $('input[name=name]').select().focus();
        });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"layout.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/layout.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);
Template.loginLayout.helpers({
  backgroundUrl() {
    const asset = settings.get('Assets_background');
    const prefix = __meteor_runtime_config__.ROOT_URL_PATH_PREFIX || '';

    if (asset && (asset.url || asset.defaultUrl)) {
      return "".concat(prefix, "/").concat(asset.url || asset.defaultUrl);
    }
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"services.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/services.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let capitalize;
module.link("@rocket.chat/string-helpers", {
  capitalize(v) {
    capitalize = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration(v) {
    ServiceConfiguration = v;
  }

}, 3);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 4);
Template.loginServices.helpers({
  loginService() {
    return ServiceConfiguration.configurations.find({
      showButton: {
        $ne: false
      }
    }, {
      sort: {
        service: 1
      }
    }).fetch().map(service => {
      switch (service.service) {
        case 'meteor-developer':
          return {
            service,
            displayName: 'Meteor',
            icon: 'meteor'
          };

        case 'github':
          return {
            service,
            displayName: 'GitHub',
            icon: 'github-circled'
          };

        case 'gitlab':
          return {
            service,
            displayName: 'GitLab',
            icon: service.service
          };

        case 'wordpress':
          return {
            service,
            displayName: 'WordPress',
            icon: service.service
          };

        default:
          return {
            service,
            displayName: capitalize(String(service.service || '')),
            icon: service.service
          };
      }
    });
  }

});
const loginMethods = {
  'meteor-developer': 'MeteorDeveloperAccount',
  'linkedin': 'Linkedin'
};
Template.loginServices.events({
  'click .external-login'(e) {
    if (this.service == null || this.service.service == null) {
      return;
    }

    const loadingIcon = $(e.currentTarget).find('.loading-icon');
    const serviceIcon = $(e.currentTarget).find('.service-icon');
    loadingIcon.removeClass('hidden');
    serviceIcon.addClass('hidden');
    const loginWithService = "loginWith".concat(loginMethods[this.service.service] || capitalize(String(this.service.service || '')));
    const serviceConfig = this.service.clientConfig || {};
    Meteor[loginWithService](serviceConfig, error => {
      loadingIcon.addClass('hidden');
      serviceIcon.removeClass('hidden');

      if (!error) {
        return;
      }

      if (error.reason) {
        dispatchToastMessage({
          type: 'error',
          message: error.reason
        });
        return;
      }

      dispatchToastMessage({
        type: 'error',
        message: error.message
      });
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"username":{"username.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/username/username.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.username.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.username.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/username/template.username.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("username");
Template["username"] = new Template("Template.username", (function() {
  var view = this;
  return HTML.SECTION({
    class: "rc-old full-page color-tertiary-font-color",
    style: function() {
      return Spacebars.With(function() {
        return Spacebars.call(view.lookup("backgroundUrl"));
      }, function() {
        return [ "background-image: url('", Blaze.View("lookup:.", function() {
          return Spacebars.mustache(view.lookup("."));
        }), "')" ];
      });
    }
  }, "\n\t\t", HTML.DIV({
    class: "wrapper"
  }, "\n\t\t\t", HTML.FORM({
    id: "login-card",
    class: "content-background-color color-primary-font-color",
    method: "/"
  }, "\n\t\t\t\t", HTML.HEADER("\n\t\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Username_title");
  })), "\n\t\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Username_description");
  })), "\n\t\t\t\t"), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "blocked"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "alert error-color error-background error-border"
    }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "error-blocked-username", Spacebars.kw({
        field: Spacebars.dot(view.lookup("username"), "escaped")
      })));
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "unavailable"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "alert error-color error-background error-border"
    }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "error-field-unavailable", Spacebars.kw({
        field: Spacebars.dot(view.lookup("username"), "escaped")
      })));
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "invalid"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "alert error-color error-background error-border"
    }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Username_invalid", Spacebars.dot(view.lookup("username"), "escaped")));
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "empty"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "alert error-color error-background error-border"
    }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Username_cant_be_empty"));
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", HTML.DIV({
    class: "fields"
  }, "\n\t\t\t\t\t", HTML.DIV({
    class: "input-text active"
  }, "\n\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "ready"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", HTML.SPAN("\n\t\t\t\t\t\t\t\t", HTML.INPUT({
      type: "text",
      name: "username",
      id: "username",
      value: function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("username"), "username"));
      },
      dir: "auto",
      class: "rc-input__element",
      placeholder: function() {
        return Spacebars.mustache(view.lookup("_"), "Username");
      }
    }), "\n\t\t\t\t\t\t\t"), HTML.Raw("\n\t\t\t\t\t\t\t<i></i>\n\t\t\t\t\t\t") ];
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Loading_suggestion");
    }), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\n        ", Spacebars.include(view.lookupTemplate("customFieldsForm")), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "ready"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "rc-button__group rc-button__group--vertical"
    }, "\n\t\t\t\t\t\t", HTML.BUTTON({
      "data-loading-text": function() {
        return [ Spacebars.mustache(view.lookup("_"), " Please_wait "), "..." ];
      },
      class: "rc-button rc-button--primary login"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Use_this_username");
    })), "\n\t\t\t\t\t\t", HTML.BUTTON({
      type: "reset",
      class: "rc-button rc-button--nude"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Logout");
    })), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"username.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/username/username.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 4);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 5);
let Button;
module.link("../../../ui", {
  Button(v) {
    Button = v;
  }

}, 6);
let t;
module.link("../../../utils", {
  t(v) {
    t = v;
  }

}, 7);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 8);
let dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 9);
Template.username.onCreated(function () {
  const self = this;
  self.customFields = new ReactiveVar();
  self.username = new ReactiveVar();
  Tracker.autorun(() => {
    const Accounts_CustomFields = settings.get('Accounts_CustomFields');

    if (typeof Accounts_CustomFields === 'string' && Accounts_CustomFields.trim() !== '') {
      try {
        return this.customFields.set(JSON.parse(settings.get('Accounts_CustomFields')));
      } catch (error1) {
        return console.error('Invalid JSON for Accounts_CustomFields');
      }
    } else {
      return this.customFields.set(null);
    }
  });

  const validateCustomFields = function (formObj, validationObj) {
    const customFields = self.customFields.get();

    if (!customFields) {
      return;
    }

    for (const field in formObj) {
      if (formObj.hasOwnProperty(field)) {
        const value = formObj[field];

        if (customFields[field] == null) {
          continue;
        }

        const customField = customFields[field];

        if (customField.required === true && !value) {
          validationObj[field] = t('Field_required');
          return validationObj[field];
        }

        if (customField.maxLength != null && value.length > customField.maxLength) {
          validationObj[field] = t('Max_length_is', customField.maxLength);
          return validationObj[field];
        }

        if (customField.minLength != null && value.length < customField.minLength) {
          validationObj[field] = t('Min_length_is', customField.minLength);
          return validationObj[field];
        }
      }
    }
  };

  this.validate = function () {
    const formData = $('#login-card').serializeArray();
    const formObj = {};
    const validationObj = {};
    formData.forEach(field => {
      formObj[field.name] = field.value;
    });
    $('#login-card h2').removeClass('error');
    $('#login-card input.error, #login-card select.error').removeClass('error');
    $('#login-card .input-error').text('');
    validateCustomFields(formObj, validationObj);

    if (!_.isEmpty(validationObj)) {
      $('#login-card h2').addClass('error');
      Object.keys(validationObj).forEach(key => {
        const value = validationObj[key];
        $("#login-card input[name=".concat(key, "], #login-card select[name=").concat(key, "]")).addClass('error');
        $("#login-card input[name=".concat(key, "]~.input-error, #login-card select[name=").concat(key, "]~.input-error")).text(value);
      });
      return false;
    }

    return formObj;
  };

  return Meteor.call('getUsernameSuggestion', function (error, username) {
    self.username.set({
      ready: true,
      username
    });
    return Meteor.defer(() => self.find('input').focus());
  });
});
Template.username.helpers({
  username() {
    return Template.instance().username.get();
  },

  backgroundUrl() {
    const asset = settings.get('Assets_background');
    const prefix = __meteor_runtime_config__.ROOT_URL_PATH_PREFIX || '';

    if (asset && (asset.url || asset.defaultUrl)) {
      return "".concat(prefix, "/").concat(asset.url || asset.defaultUrl);
    }
  }

});
Template.username.events({
  'focus .input-text input'(event) {
    return $(event.currentTarget).parents('.input-text').addClass('focus');
  },

  'blur .input-text input'(event) {
    if (event.currentTarget.value === '') {
      return $(event.currentTarget).parents('.input-text').removeClass('focus');
    }
  },

  'reset #login-card'() {
    Meteor.logout();
  },

  'submit #login-card'(event, instance) {
    event.preventDefault();
    const formData = instance.validate();
    const username = instance.username.get();
    username.empty = false;
    username.error = false;
    username.invalid = false;
    instance.username.set(username);
    const button = $(event.target).find('button.login');
    Button.loading(button);

    if (!formData) {
      Button.reset(button);
      return;
    }

    const usernameValue = $('#username').val().trim();

    if (usernameValue === '') {
      username.empty = true;
      instance.username.set(username);
      Button.reset(button);
      return;
    }

    Meteor.call('saveCustomFields', formData, function (err) {
      if (err != null) {
        dispatchToastMessage({
          type: 'error',
          message: err.error
        });
      }
    });
    Meteor.call('setUsername', usernameValue, function (err) {
      if (err != null) {
        if (err.error === 'username-invalid') {
          username.invalid = true;
        } else if (err.error === 'error-blocked-username') {
          username.blocked = true;
        } else {
          username.unavailable = true;
        }

        username.username = usernameValue;
        username.escaped = _.escape(usernameValue);
      }

      Button.reset(button);
      instance.username.set(username);
      return callbacks.run('usernameSet');
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/index.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./login/form.html");
module.link("./login/layout.html");
module.link("./login/layout");
module.link("./login/services.html");
module.link("./username/username.html");
module.link("./login/form");
module.link("./login/services");
module.link("./username/username");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-master":{"client":{"loading":{"loading.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/loading/loading.html                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.loading.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.loading.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/loading/template.loading.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("loading");
Template["loading"] = new Template("Template.loading", (function() {
  var view = this;
  return HTML.DIV({
    class: function() {
      return [ "loading-animation ", Spacebars.mustache(view.lookup("class")) ];
    }
  }, HTML.Raw('\n\t\t<div class="bounce bounce1"></div>\n\t\t<div class="bounce bounce2"></div>\n\t\t<div class="bounce bounce3"></div>\n\t'));
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/loading/index.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./loading.css");
module.link("./loading.html");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"loading.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/loading/loading.css                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"body.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/body.html                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.body.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.body.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/template.body.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.body.addContent((function() {
  var view = this;
  return "";
}));
Meteor.startup(Template.body.renderToDocument);
Meteor.startup(function() {
  var attrs = {"class":"color-primary-font-color"};
  for (var prop in attrs) {
    document.body.setAttribute(prop, attrs[prop]);
  }
});

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"error.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/error.html                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.error.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.error.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/template.error.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("error");
Template["error"] = new Template("Template.error", (function() {
  var view = this;
  return HTML.SECTION({
    class: "rc-old full-page color-tertiary-font-color"
  }, "\n\t\t", HTML.DIV({
    class: "wrapper"
  }, HTML.Raw('\n\t\t\t<header>\n\t\t\t\t<a class="logo" href="/">\n\t\t\t\t\t<img src="images/logo/logo.svg?v=3">\n\t\t\t\t</a>\n\t\t\t</header>\n\t\t\t'), HTML.H1(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Not_found_or_not_allowed");
  })), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"body.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/body.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Clipboard;
module.link("clipboard", {
  default(v) {
    Clipboard = v;
  }

}, 0);
let s;
module.link("underscore.string", {
  default(v) {
    s = v;
  }

}, 1);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 2);
let Match;
module.link("meteor/check", {
  Match(v) {
    Match = v;
  }

}, 3);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 4);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 5);
let t;
module.link("../../utils/client", {
  t(v) {
    t = v;
  }

}, 6);
let chatMessages;
module.link("../../ui", {
  chatMessages(v) {
    chatMessages = v;
  }

}, 7);
let popover, RoomManager;
module.link("../../ui-utils", {
  popover(v) {
    popover = v;
  },

  RoomManager(v) {
    RoomManager = v;
  }

}, 8);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 9);
let ChatSubscription;
module.link("../../models", {
  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 10);
module.link("./body.html");
let imperativeModal;
module.link("../../../client/lib/imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 11);
let GenericModal;
module.link("../../../client/components/GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 12);
let fireGlobalEvent;
module.link("../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 13);
let isLayoutEmbedded;
module.link("../../../client/lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded(v) {
    isLayoutEmbedded = v;
  }

}, 14);
Template.body.onRendered(function () {
  new Clipboard('.clipboard');
  $(document.body).on('keydown', function (e) {
    const unread = Session.get('unread');

    if (e.keyCode === 27 && (e.shiftKey === true || e.ctrlKey === true) && unread != null && unread !== '') {
      e.preventDefault();
      e.stopPropagation();

      const handleClearUnreadAllMessages = () => {
        const subscriptions = ChatSubscription.find({
          open: true
        }, {
          fields: {
            unread: 1,
            alert: 1,
            rid: 1,
            t: 1,
            name: 1,
            ls: 1
          }
        });
        subscriptions.forEach(subscription => {
          if (subscription.alert || subscription.unread > 0) {
            Meteor.call('readMessages', subscription.rid);
          }
        });
        imperativeModal.close();
      };

      imperativeModal.open({
        component: GenericModal,
        props: {
          children: t('Are_you_sure_you_want_to_clear_all_unread_messages'),
          variant: 'warning',
          title: t('Clear_all_unreads_question'),
          confirmText: t('Yes_clear_all'),
          onClose: imperativeModal.close,
          onCancel: imperativeModal.close,
          onConfirm: handleClearUnreadAllMessages
        }
      });
    }
  });
  $(document.body).on('keydown', function (e) {
    const {
      target
    } = e;

    if (e.ctrlKey === true || e.metaKey === true) {
      popover.close();
      return;
    }

    if (!(e.keyCode > 45 && e.keyCode < 91 || e.keyCode === 8)) {
      return;
    }

    if (/input|textarea|select/i.test(target.tagName)) {
      return;
    }

    if (target.id === 'pswp') {
      return;
    }

    popover.close();

    if (document.querySelector('.rc-modal-wrapper dialog[open]')) {
      return;
    }

    const inputMessage = chatMessages[RoomManager.openedRoom] && chatMessages[RoomManager.openedRoom].input;

    if (!inputMessage) {
      return;
    }

    inputMessage.focus();
  });

  const handleMessageLinkClick = event => {
    const link = event.currentTarget;

    if (link.origin === s.rtrim(Meteor.absoluteUrl(), '/') && /msg=([a-zA-Z0-9]+)/.test(link.search)) {
      fireGlobalEvent('click-message-link', {
        link: link.pathname + link.search
      });
    }
  };

  this.autorun(() => {
    if (isLayoutEmbedded()) {
      $(document.body).on('click', 'a', handleMessageLinkClick);
    } else {
      $(document.body).off('click', 'a', handleMessageLinkClick);
    }
  });
  this.autorun(function (c) {
    const w = window;
    const d = document;
    const script = 'script';
    const l = 'dataLayer';
    const i = settings.get('GoogleTagManager_id');

    if (Match.test(i, String) && i.trim() !== '') {
      c.stop();
      return function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
          'gtm.start': new Date().getTime(),
          'event': 'gtm.js'
        });
        const f = d.getElementsByTagName(s)[0];
        const j = d.createElement(s);
        const dl = l !== 'dataLayer' ? "&l=".concat(l) : '';
        j.async = true;
        j.src = "//www.googletagmanager.com/gtm.js?id=".concat(i).concat(dl);
        return f.parentNode.insertBefore(j, f);
      }(w, d, script, l, i);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./body");
module.link("./loading");
module.link("./error.html");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-message":{"client":{"messageBox":{"messageBox.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBox.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBox.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBox.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.messageBox.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBox");
Template["messageBox"] = new Template("Template.messageBox", (function() {
  var view = this;
  return HTML.DIV({
    class: function() {
      return [ "rc-message-box rc-new ", Blaze.If(function() {
        return Spacebars.call(view.lookup("isEmbedded"));
      }, function() {
        return "rc-message-box--embedded";
      }) ];
    }
  }, "\n\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("isAnonymousOrMustJoinWithCode"));
  }, function() {
    return [ "\n\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        rid: Spacebars.call(view.lookup("rid")),
        tmid: Spacebars.call(view.lookup("tmid"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("userActionIndicator"));
    }), "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isWritable"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("popupConfig"));
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
          return Spacebars.call(view.lookup("popupConfig"));
        }, function() {
          return Spacebars.include(view.lookupTemplate("messagePopupConfig"));
        }), "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
          return Spacebars.call(view.lookup("popupConfig"));
        }, function() {
          return Spacebars.include(view.lookupTemplate("messagePopupSlashCommandPreview"));
        }), "\n\t\t\t\t" ];
      }), "\n\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("replyMessageData"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "reply-preview__wrap message-popup"
        }, "\n\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(view.lookup("replyMessageData")),
            _variable: "reply"
          };
        }, function() {
          return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
            return {
              input: Spacebars.call(view.lookup("input")),
              replyMessageData: Spacebars.call(view.lookup("reply"))
            };
          }, function() {
            return Spacebars.include(view.lookupTemplate("messageBoxReplyPreview"));
          }), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\n\t\t\t\t", HTML.LABEL({
        class: "rc-message-box__container"
      }, "\n\t\t\t\t\t", HTML.SPAN({
        class: function() {
          return [ "rc-message-box__icon emoji-picker-icon ", Blaze.Unless(function() {
            return Spacebars.call(view.lookup("isEmojiEnabled"));
          }, function() {
            return "emoji-picker-icon--disabled";
          }), " js-emoji-picker" ];
        },
        "aria-haspopup": "true"
      }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          block: Spacebars.call("rc-input__icon-svg"),
          icon: Spacebars.call("emoji")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.TEXTAREA({
        "aria-label": function() {
          return Spacebars.mustache(view.lookup("_"), "Message");
        },
        name: "msg",
        maxlength: function() {
          return Spacebars.mustache(view.lookup("maxMessageLength"));
        },
        placeholder: function() {
          return Spacebars.mustache(view.lookup("_"), "Message");
        },
        rows: "1",
        class: "rc-message-box__textarea js-input-message"
      }), HTML.Raw('\n\t\t\t\t\t<div class="js-input-message-shadow"></div>\n\t\t\t\t\t'), Blaze.If(function() {
        return Spacebars.call(view.lookup("isSendIconVisible"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "rc-message-box__icon rc-message-box__send js-send",
          "data-desktop": ""
        }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call("rc-input__icon-svg"),
            icon: Spacebars.call("send")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("customAction"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
            return {
              template: Spacebars.call(Spacebars.dot(view.lookup("customAction"), "template")),
              data: Spacebars.call(Spacebars.dot(view.lookup("customAction"), "data"))
            };
          }, function() {
            return Spacebars.include(function() {
              return Spacebars.call(Template.__dynamic);
            });
          }), "\n\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\n\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("canSend"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
              return {
                rid: Spacebars.call(view.lookup("rid")),
                tmid: Spacebars.call(view.lookup("tmid"))
              };
            }, function() {
              return Spacebars.include(view.lookupTemplate("messageBoxAudioMessage"));
            }), "\n\t\t\t\t\t\t\t\t", HTML.SPAN({
              class: "rc-message-box__action-menu js-action-menu",
              "data-desktop": "",
              "aria-haspopup": "true"
            }, "\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(view.lookup("actions"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
                class: "rc-message-box__icon"
              }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
                return {
                  block: Spacebars.call("rc-input__icon-svg"),
                  icon: Spacebars.call("plus")
                };
              }, function() {
                return Spacebars.include(view.lookupTemplate("icon"));
              }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", HTML.BUTTON({
              class: "js-join rc-button rc-button--primary rc-message-box__join-button"
            }, "\n\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "join");
            }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t" ];
      }), "\n\n\t\t\t\t\t", HTML.SPAN({
        class: "rc-message-box__action-label js-message-actions",
        "data-small": ""
      }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.call(view.lookup("actions")),
          _variable: "action"
        };
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", HTML.SPAN({
          class: "js-message-action",
          "data-id": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("action"), "id"));
          }
        }, "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call("rc-message-box__action"),
            icon: Spacebars.call(Spacebars.dot(view.lookup("action"), "icon"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\n\t\t\t\t\t", HTML.SPAN({
        class: "rc-message-box__send js-message-action js-send",
        disabled: function() {
          return Spacebars.mustache(view.lookup("isSendIconDisabled"));
        },
        "data-small": ""
      }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          block: Spacebars.call("rc-message-box__action"),
          icon: Spacebars.call("send")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("showFormattingTips"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-message-box__toolbar-formatting"
        }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(view.lookup("formattingButtons")),
            _variable: "formattingButton"
          };
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("formattingButton"), "icon"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", HTML.BUTTON({
              class: "rc-message-box__toolbar-formatting-item js-format",
              "data-id": function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("formattingButton"), "label"));
              },
              title: function() {
                return Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup("formattingButton"), "label"));
              }
            }, "\n\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
              return {
                block: Spacebars.call("rc-message-box__toolbar-formatting-icon"),
                icon: Spacebars.call(Spacebars.dot(view.lookup("formattingButton"), "icon"))
              };
            }, function() {
              return Spacebars.include(view.lookupTemplate("icon"));
            }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", HTML.SPAN({
              class: "rc-message-box__toolbar-formatting-item",
              title: function() {
                return Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup("formattingButton"), "label"));
              }
            }, "\n\t\t\t\t\t\t\t\t\t", HTML.A({
              href: function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("formattingButton"), "link"));
              },
              target: "_blank",
              rel: "noopener noreferrer",
              class: "rc-message-box__toolbar-formatting-link"
            }, Blaze.View("lookup:formattingButton.text", function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("formattingButton"), "text"));
            })), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: "rc-message-box__cannot-send"
      }, "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isBlockedOrBlocker"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "room_is_blocked");
        }), "\n\t\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            rid: Spacebars.call(view.lookup("rid")),
            isSubscribed: Spacebars.call(view.lookup("isSubscribed")),
            onHold: Spacebars.call(view.lookup("onHold"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("messageBoxReadOnly"));
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        rid: Spacebars.call(view.lookup("rid"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("messageBoxNotSubscribed"));
    }), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxAudioMessage.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxAudioMessage.html                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBoxAudioMessage.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBoxAudioMessage.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.messageBoxAudioMessage.js                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBoxAudioMessage");
Template["messageBoxAudioMessage"] = new Template("Template.messageBoxAudioMessage", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isAllowed"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: function() {
        return [ "rc-message-box__audio-message ", Spacebars.mustache(view.lookup("stateClass")) ];
      }
    }, "\n\t\t\t", HTML.DIV({
      class: "rc-message-box__icon rc-message-box__audio-message-cancel js-audio-message-cancel"
    }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call("circle-cross")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t"), "\n\t\t\t", HTML.DIV({
      class: "rc-message-box__audio-message-timer"
    }, HTML.Raw('\n\t\t\t\t<span class="rc-message-box__audio-message-timer-dot"></span>\n\t\t\t\t'), HTML.SPAN({
      class: "rc-message-box__audio-message-timer-text"
    }, Blaze.View("lookup:time", function() {
      return Spacebars.mustache(view.lookup("time"));
    })), "\n\t\t\t"), "\n\t\t\t", HTML.DIV({
      class: "rc-message-box__icon rc-message-box__audio-message-done js-audio-message-done"
    }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call("checkmark-circled")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t"), "\n\t\t\t", HTML.DIV({
      class: "rc-message-box__icon rc-message-box__audio-message-mic js-audio-message-record"
    }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call("mic")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t"), "\n\t\t\t", HTML.DIV({
      class: "rc-message-box__icon rc-message-box__audio-message-loading js-audio-message-loading"
    }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call("loading")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t"), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxNotSubscribed.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxNotSubscribed.html                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBoxNotSubscribed.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBoxNotSubscribed.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.messageBoxNotSubscribed.js                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBoxNotSubscribed");
Template["messageBoxNotSubscribed"] = new Template("Template.messageBoxNotSubscribed", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("customTemplate"));
  }, function() {
    return [ "\n\t\t", Blaze._TemplateWith(function() {
      return {
        template: Spacebars.call(view.lookup("customTemplate"))
      };
    }, function() {
      return Spacebars.include(function() {
        return Spacebars.call(Template.__dynamic);
      });
    }), "\n\t" ];
  }, function() {
    return [ "\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("canJoinRoom"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "rc-message-box__join"
      }, "\n\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "you_are_in_preview_mode_of", Spacebars.kw({
          room_name: view.lookup("roomName")
        })));
      }), "\n\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isJoinCodeRequired"));
      }, function() {
        return [ "\n\t\t\t\t", HTML.INPUT({
          type: "password",
          name: "joinCode",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("_"), "Password");
          },
          class: "rc-input__element rc-message-box__join-code"
        }), "\n\t\t\t\t" ];
      }), "\n\n\t\t\t\t", HTML.BUTTON({
        class: "rc-button rc-button--primary rc-button--small rc-message-box__join-button js-join-code"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "join");
      })), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isAnonymousReadAllowed"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "rc-button-group"
      }, "\n\t\t\t\t", HTML.BUTTON({
        class: "rc-button rc-button--primary rc-button--small js-register"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Sign_in_to_start_talking");
      })), "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isAnonymousWriteAllowed"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          class: "rc-button rc-button--small js-register-anonymous"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Or_talk_as_anonymous");
        })), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxReadOnly.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxReadOnly.html                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBoxReadOnly.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBoxReadOnly.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.messageBoxReadOnly.js                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBoxReadOnly");
Template["messageBoxReadOnly"] = new Template("Template.messageBoxReadOnly", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("customTemplate"));
  }, function() {
    return [ "\n\t\t", Blaze._TemplateWith(function() {
      return {
        template: Spacebars.call(view.lookup("customTemplate"))
      };
    }, function() {
      return Spacebars.include(function() {
        return Spacebars.call(Template.__dynamic);
      });
    }), "\n\t" ];
  }, function() {
    return [ "\n\t\t", HTML.SPAN("\n\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "room_is_read_only");
    }), "\n\t\t"), "\n\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("isSubscribed"));
    }, function() {
      return [ "\n\t\t\t", HTML.BUTTON({
        class: "js-join rc-button rc-button--primary rc-message-box__join-button"
      }, "\n\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "join");
      }), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxReplyPreview.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxReplyPreview.html                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBoxReplyPreview.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBoxReplyPreview.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.messageBoxReplyPreview.js                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBoxReplyPreview");
Template["messageBoxReplyPreview"] = new Template("Template.messageBoxReplyPreview", (function() {
  var view = this;
  return HTML.DIV({
    class: "reply-preview message-popup"
  }, "\n\t\t", HTML.DIV({
    class: "message"
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      attachments: Spacebars.call(view.lookup("attachments"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("reactAttachments"));
  }), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "rc-message-box__icon cancel-reply",
    "data-mid": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("replyMessageData"), "_id"));
    }
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      block: Spacebars.call("rc-input__icon-svg"),
      icon: Spacebars.call("cross")
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userActionIndicator.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/userActionIndicator.html                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.userActionIndicator.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.userActionIndicator.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.userActionIndicator.js                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("userActionIndicator");
Template["userActionIndicator"] = new Template("Template.userActionIndicator", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("data"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "rc-message-box__activity"
    }, "\n\t\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("data"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.SPAN({
        class: "rc-message-box__activity-user"
      }, Blaze.View("lookup:users", function() {
        return Spacebars.mustache(view.lookup("users"));
      })), "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("multi"));
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "are");
        }), HTML.Raw("&nbsp;"), Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), view.lookup("action"));
        }), Blaze.Unless(function() {
          return Spacebars.call(view.lookup("end"));
        }, function() {
          return ",";
        }), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "is");
        }), HTML.Raw("&nbsp;"), Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), view.lookup("action"));
        }), Blaze.Unless(function() {
          return Spacebars.call(view.lookup("end"));
        }, function() {
          return ",";
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBox.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBox.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let ReactiveDict;
module.link("meteor/reactive-dict", {
  ReactiveDict(v) {
    ReactiveDict = v;
  }

}, 2);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 3);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 4);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 5);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 6);
let setupAutogrow;
module.link("./messageBoxAutogrow", {
  setupAutogrow(v) {
    setupAutogrow = v;
  }

}, 7);
let formattingButtons, applyFormatting;
module.link("./messageBoxFormatting", {
  formattingButtons(v) {
    formattingButtons = v;
  },

  applyFormatting(v) {
    applyFormatting = v;
  }

}, 8);
let EmojiPicker;
module.link("../../../emoji", {
  EmojiPicker(v) {
    EmojiPicker = v;
  }

}, 9);
let Users;
module.link("../../../models", {
  Users(v) {
    Users = v;
  }

}, 10);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 11);
let fileUpload, KonchatNotification;
module.link("../../../ui", {
  fileUpload(v) {
    fileUpload = v;
  },

  KonchatNotification(v) {
    KonchatNotification = v;
  }

}, 12);
let messageBox, popover;
module.link("../../../ui-utils", {
  messageBox(v) {
    messageBox = v;
  },

  popover(v) {
    popover = v;
  }

}, 13);
let t, roomTypes, getUserPreference;
module.link("../../../utils/client", {
  t(v) {
    t = v;
  },

  roomTypes(v) {
    roomTypes = v;
  },

  getUserPreference(v) {
    getUserPreference = v;
  }

}, 14);
module.link("./messageBoxActions");
module.link("./messageBoxReplyPreview");
module.link("./userActionIndicator.ts");
module.link("./messageBoxAudioMessage");
module.link("./messageBoxNotSubscribed");
module.link("./messageBox.html");
module.link("./messageBoxReadOnly");
let getImageExtensionFromMime;
module.link("../../../../lib/getImageExtensionFromMime", {
  getImageExtensionFromMime(v) {
    getImageExtensionFromMime = v;
  }

}, 15);
let keyCodes;
module.link("../../../../client/lib/utils/keyCodes", {
  keyCodes(v) {
    keyCodes = v;
  }

}, 16);
let isRTL;
module.link("../../../../client/lib/utils/isRTL", {
  isRTL(v) {
    isRTL = v;
  }

}, 17);
let call;
module.link("../../../../client/lib/utils/call", {
  call(v) {
    call = v;
  }

}, 18);
Template.messageBox.onCreated(function () {
  this.state = new ReactiveDict();
  this.popupConfig = new ReactiveVar(null);
  this.replyMessageData = new ReactiveVar();
  this.isMicrophoneDenied = new ReactiveVar(true);
  this.isSendIconVisible = new ReactiveVar(false);

  this.set = value => {
    const {
      input
    } = this;

    if (!input) {
      return;
    }

    input.value = value;
    $(input).trigger('change').trigger('input');
  };

  this.insertNewLine = () => {
    const {
      input,
      autogrow
    } = this;

    if (!input) {
      return;
    }

    if (document.selection) {
      input.focus();
      const sel = document.selection.createRange();
      sel.text = '\n';
    } else if (input.selectionStart || input.selectionStart === 0) {
      const newPosition = input.selectionStart + 1;
      const before = input.value.substring(0, input.selectionStart);
      const after = input.value.substring(input.selectionEnd, input.value.length);
      input.value = "".concat(before, "\n").concat(after);
      input.selectionStart = newPosition;
      input.selectionEnd = newPosition;
    } else {
      input.value += '\n';
    }

    $(input).trigger('change').trigger('input');
    input.blur();
    input.focus();
    autogrow.update();
  };

  this.send = event => {
    const {
      input
    } = this;

    if (!input) {
      return;
    }

    const {
      autogrow,
      data: {
        rid,
        tmid,
        onSend,
        tshow
      }
    } = this;
    const {
      value
    } = input;
    this.set('');

    if (!onSend) {
      return;
    }

    onSend.call(this.data, event, {
      rid,
      tmid,
      value,
      tshow
    }, () => {
      autogrow.update();
      input.focus();
    });
  };
});
Template.messageBox.onRendered(function () {
  let inputSetup = false;
  this.autorun(() => {
    const {
      rid,
      subscription
    } = Template.currentData();
    const room = Session.get("roomData".concat(rid));

    if (!inputSetup) {
      const $input = $(this.find('.js-input-message'));
      this.source = $input[0];

      if (this.source) {
        inputSetup = true;
      }

      $input.on('dataChange', () => {
        const messages = $input.data('reply') || [];
        this.replyMessageData.set(messages);
      });
    }

    if (!room) {
      return this.state.set({
        room: false,
        isBlockedOrBlocker: false,
        mustJoinWithCode: false
      });
    }

    const isBlocked = room && room.t === 'd' && subscription && subscription.blocked;
    const isBlocker = room && room.t === 'd' && subscription && subscription.blocker;
    const isBlockedOrBlocker = isBlocked || isBlocker;
    const mustJoinWithCode = !subscription && room.joinCodeRequired;
    return this.state.set({
      room: false,
      isBlockedOrBlocker,
      mustJoinWithCode
    });
  });
  this.autorun(() => {
    const {
      rid,
      tmid,
      onInputChanged,
      onResize
    } = Template.currentData();
    Tracker.afterFlush(() => {
      const input = this.find('.js-input-message');

      if (this.input === input) {
        return;
      }

      this.input = input;
      onInputChanged && onInputChanged(input);

      if (input && rid) {
        this.popupConfig.set({
          rid,
          tmid,
          getInput: () => input
        });
      } else {
        this.popupConfig.set(null);
      }

      if (this.autogrow) {
        this.autogrow.destroy();
        this.autogrow = null;
      }

      if (!input) {
        return;
      }

      const shadow = this.find('.js-input-message-shadow');
      this.autogrow = setupAutogrow(input, shadow, onResize);
    });
  });
});
Template.messageBox.onDestroyed(function () {
  if (!this.autogrow) {
    return;
  }

  this.autogrow.destroy();
});
Template.messageBox.helpers({
  isAnonymousOrMustJoinWithCode() {
    const instance = Template.instance();
    const {
      rid
    } = Template.currentData();

    if (!rid) {
      return false;
    }

    const isAnonymous = !Meteor.userId();
    return isAnonymous || instance.state.get('mustJoinWithCode');
  },

  isWritable() {
    const {
      rid,
      subscription
    } = Template.currentData();

    if (!rid) {
      return true;
    }

    const isBlockedOrBlocker = Template.instance().state.get('isBlockedOrBlocker');

    if (isBlockedOrBlocker) {
      return false;
    }

    if (subscription !== null && subscription !== void 0 && subscription.onHold) {
      return false;
    }

    const isReadOnly = roomTypes.readOnly(rid, Users.findOne({
      _id: Meteor.userId()
    }, {
      fields: {
        username: 1
      }
    }));
    const isArchived = roomTypes.archived(rid) || subscription && subscription.t === 'd' && subscription.archived;
    return !isReadOnly && !isArchived;
  },

  popupConfig() {
    return Template.instance().popupConfig.get();
  },

  input() {
    return Template.instance().input;
  },

  replyMessageData() {
    return Template.instance().replyMessageData.get();
  },

  isEmojiEnabled() {
    return getUserPreference(Meteor.userId(), 'useEmojis');
  },

  maxMessageLength() {
    return settings.get('Message_AllowConvertLongMessagesToAttachment') ? null : settings.get('Message_MaxAllowedSize');
  },

  isSendIconVisible() {
    return Template.instance().isSendIconVisible.get();
  },

  canSend() {
    const {
      rid
    } = Template.currentData();

    if (!rid) {
      return true;
    }

    return roomTypes.verifyCanSendMessage(rid);
  },

  actions() {
    const actionGroups = messageBox.actions.get();
    return Object.values(actionGroups).reduce((actions, actionGroup) => [...actions, ...actionGroup], []);
  },

  formattingButtons() {
    return formattingButtons.filter(_ref => {
      let {
        condition
      } = _ref;
      return !condition || condition();
    });
  },

  isBlockedOrBlocker() {
    return Template.instance().state.get('isBlockedOrBlocker');
  },

  onHold() {
    const {
      rid,
      subscription
    } = Template.currentData();
    return rid && !!(subscription !== null && subscription !== void 0 && subscription.onHold);
  },

  isSubscribed() {
    const {
      subscription
    } = Template.currentData();
    return !!subscription;
  }

});

const handleFormattingShortcut = (event, instance) => {
  const isMacOS = navigator.platform.indexOf('Mac') !== -1;
  const isCmdOrCtrlPressed = isMacOS && event.metaKey || !isMacOS && event.ctrlKey;

  if (!isCmdOrCtrlPressed) {
    return false;
  }

  const key = event.key.toLowerCase();
  const {
    pattern
  } = formattingButtons.filter(_ref2 => {
    let {
      condition
    } = _ref2;
    return !condition || condition();
  }).find(_ref3 => {
    let {
      command
    } = _ref3;
    return command === key;
  }) || {};

  if (!pattern) {
    return false;
  }

  const {
    input
  } = instance;
  applyFormatting(pattern, input);
  return true;
};

let sendOnEnter;
let sendOnEnterActive;
Tracker.autorun(() => {
  sendOnEnter = getUserPreference(Meteor.userId(), 'sendOnEnter');
  sendOnEnterActive = sendOnEnter == null || sendOnEnter === 'normal' || sendOnEnter === 'desktop' && Meteor.Device.isDesktop();
});

const handleSubmit = (event, instance) => {
  const {
    which: keyCode
  } = event;
  const isSubmitKey = keyCode === keyCodes.CARRIAGE_RETURN || keyCode === keyCodes.NEW_LINE;

  if (!isSubmitKey) {
    return false;
  }

  const withModifier = event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;
  const isSending = sendOnEnterActive && !withModifier || !sendOnEnterActive && withModifier;

  if (isSending) {
    instance.send(event);
    return true;
  }

  instance.insertNewLine();
  return true;
};

Template.messageBox.events({
  async 'click .js-join'(event) {
    event.stopPropagation();
    event.preventDefault();
    const joinCodeInput = Template.instance().find('[name=joinCode]');
    const joinCode = joinCodeInput && joinCodeInput.value;
    await call('joinRoom', this.rid, joinCode);
  },

  'click .js-emoji-picker'(event, instance) {
    event.stopPropagation();
    event.preventDefault();

    if (!getUserPreference(Meteor.userId(), 'useEmojis')) {
      return;
    }

    if (EmojiPicker.isOpened()) {
      EmojiPicker.close();
      return;
    }

    EmojiPicker.open(instance.source, emoji => {
      const emojiValue = ":".concat(emoji, ": ");
      const {
        input
      } = instance;
      const caretPos = input.selectionStart;
      const textAreaTxt = input.value;
      input.focus();

      if (!document.execCommand || !document.execCommand('insertText', false, emojiValue)) {
        instance.set(textAreaTxt.substring(0, caretPos) + emojiValue + textAreaTxt.substring(caretPos));
        input.focus();
      }

      input.selectionStart = caretPos + emojiValue.length;
      input.selectionEnd = caretPos + emojiValue.length;
    });
  },

  'focus .js-input-message'() {
    KonchatNotification.removeRoomNotification(this.rid);
  },

  'keydown .js-input-message'(event, instance) {
    const isEventHandled = handleFormattingShortcut(event, instance) || handleSubmit(event, instance);

    if (isEventHandled) {
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    const {
      rid,
      tmid,
      onKeyDown
    } = this;
    onKeyDown && onKeyDown.call(this, event, {
      rid,
      tmid
    });
  },

  'keyup .js-input-message'(event) {
    const {
      rid,
      tmid,
      onKeyUp
    } = this;
    onKeyUp && onKeyUp.call(this, event, {
      rid,
      tmid
    });
  },

  'paste .js-input-message'(event, instance) {
    const {
      rid,
      tmid
    } = this;
    const {
      input,
      autogrow
    } = instance;
    setTimeout(() => autogrow && autogrow.update(), 50);

    if (!event.originalEvent.clipboardData) {
      return;
    }

    const items = [...event.originalEvent.clipboardData.items];

    if (items.some(_ref4 => {
      let {
        kind,
        type
      } = _ref4;
      return kind === 'string' && type === 'text/plain';
    })) {
      return;
    }

    const files = items.filter(item => item.kind === 'file' && item.type.indexOf('image/') !== -1).map(item => {
      const fileItem = item.getAsFile();
      const imageExtension = getImageExtensionFromMime(fileItem.type);
      const extension = imageExtension ? ".".concat(imageExtension) : '';
      return {
        file: fileItem,
        name: "Clipboard - ".concat(moment().format(settings.get('Message_TimeAndDateFormat'))).concat(extension)
      };
    }).filter(_ref5 => {
      let {
        file
      } = _ref5;
      return file !== null;
    });

    if (files.length) {
      event.preventDefault();
      fileUpload(files, input, {
        rid,
        tmid
      });
    }
  },

  'input .js-input-message'(event, instance) {
    const {
      input
    } = instance;

    if (!input) {
      return;
    }

    instance.isSendIconVisible.set(!!input.value);

    if (input.value.length > 0) {
      input.dir = isRTL(input.value) ? 'rtl' : 'ltr';
    }

    const {
      rid,
      tmid,
      onValueChanged
    } = this;
    onValueChanged && onValueChanged.call(this, event, {
      rid,
      tmid
    });
  },

  'propertychange .js-input-message'(event, instance) {
    if (event.originalEvent.propertyName !== 'value') {
      return;
    }

    const {
      input
    } = instance;

    if (!input) {
      return;
    }

    instance.sendIconDisabled.set(!!input.value);

    if (input.value.length > 0) {
      input.dir = isRTL(input.value) ? 'rtl' : 'ltr';
    }

    const {
      rid,
      tmid,
      onValueChanged
    } = this;
    onValueChanged && onValueChanged.call(this, event, {
      rid,
      tmid
    });
  },

  async 'click .js-send'(event, instance) {
    instance.send(event);
  },

  'click .js-action-menu'(event, instance) {
    const groups = messageBox.actions.get();
    const config = {
      popoverClass: 'message-box',
      columns: [{
        groups: Object.keys(groups).map(group => {
          const items = [];
          groups[group].forEach(item => {
            items.push({
              icon: item.icon,
              name: t(item.label),
              type: 'messagebox-action',
              id: item.id
            });
          });
          return {
            title: t(group),
            items
          };
        })
      }],
      offsetVertical: 10,
      direction: 'top-inverted',
      currentTarget: event.currentTarget.firstElementChild.firstElementChild,
      data: {
        rid: this.rid,
        tmid: this.tmid,
        prid: this.subscription.prid,
        messageBox: instance.firstNode
      },
      activeElement: event.currentTarget
    };
    popover.open(config);
  },

  'click .js-message-actions .js-message-action'(event, instance) {
    const {
      id
    } = event.currentTarget.dataset;
    const actions = messageBox.actions.getById(id);
    actions.filter(_ref6 => {
      let {
        action
      } = _ref6;
      return !!action;
    }).forEach(_ref7 => {
      let {
        action
      } = _ref7;
      action.call(null, {
        rid: this.rid,
        tmid: this.tmid,
        messageBox: instance.firstNode,
        prid: this.subscription.prid,
        event
      });
    });
  },

  'click .js-format'(event, instance) {
    event.preventDefault();
    event.stopPropagation();
    const {
      id
    } = event.currentTarget.dataset;
    const {
      pattern
    } = formattingButtons.filter(_ref8 => {
      let {
        condition
      } = _ref8;
      return !condition || condition();
    }).find(_ref9 => {
      let {
        label
      } = _ref9;
      return label === id;
    }) || {};

    if (!pattern) {
      return;
    }

    applyFormatting(pattern, instance.input);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxActions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxActions.js                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let VRecDialog;
module.link("../../../ui-vrecord/client", {
  VRecDialog(v) {
    VRecDialog = v;
  }

}, 4);
let messageBox, modal;
module.link("../../../ui-utils", {
  messageBox(v) {
    messageBox = v;
  },

  modal(v) {
    modal = v;
  }

}, 5);
let fileUpload;
module.link("../../../ui", {
  fileUpload(v) {
    fileUpload = v;
  }

}, 6);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 7);
let t;
module.link("../../../utils", {
  t(v) {
    t = v;
  }

}, 8);
messageBox.actions.add('Create_new', 'Video_message', {
  id: 'video-message',
  icon: 'video',
  condition: () => (navigator.mediaDevices || navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia) && window.MediaRecorder && settings.get('FileUpload_Enabled') && settings.get('Message_VideoRecorderEnabled') && (!settings.get('FileUpload_MediaTypeBlackList') || !settings.get('FileUpload_MediaTypeBlackList').match(/video\/webm|video\/\*/i)) && (!settings.get('FileUpload_MediaTypeWhiteList') || settings.get('FileUpload_MediaTypeWhiteList').match(/video\/webm|video\/\*/i)),
  action: _ref => {
    let {
      rid,
      tmid,
      messageBox
    } = _ref;
    return VRecDialog.opened ? VRecDialog.close() : VRecDialog.open(messageBox, {
      rid,
      tmid
    });
  }
});
messageBox.actions.add('Add_files_from', 'Computer', {
  id: 'file-upload',
  icon: 'computer',
  condition: () => settings.get('FileUpload_Enabled'),

  action(_ref2) {
    let {
      rid,
      tmid,
      event,
      messageBox
    } = _ref2;
    event.preventDefault();
    const $input = $(document.createElement('input'));
    $input.css('display', 'none');
    $input.attr({
      id: 'fileupload-input',
      type: 'file',
      multiple: 'multiple'
    });
    $(document.body).append($input);
    $input.one('change', async function (e) {
      const {
        mime
      } = await module.dynamicImport('../../../utils/lib/mimeTypes');
      const filesToUpload = [...e.target.files].map(file => {
        Object.defineProperty(file, 'type', {
          value: mime.lookup(file.name)
        });
        return {
          file,
          name: file.name
        };
      });
      fileUpload(filesToUpload, $('.js-input-message', messageBox).get(0), {
        rid,
        tmid
      });
      $input.remove();
    });
    $input.click(); // Simple hack for iOS aka codegueira

    if (navigator.userAgent.match(/(iPad|iPhone|iPod)/g)) {
      $input.click();
    }
  }

});
const canGetGeolocation = new ReactiveVar(false);

const getGeolocationPermission = () => new Promise(resolve => {
  if (!navigator.permissions) {
    resolve(true);
  }

  navigator.permissions.query({
    name: 'geolocation'
  }).then(_ref3 => {
    let {
      state
    } = _ref3;
    resolve(state);
  });
});

const getGeolocationPosition = () => new Promise(resolvePos => {
  navigator.geolocation.getCurrentPosition(resolvePos, () => {
    resolvePos(false);
  }, {
    enableHighAccuracy: true,
    maximumAge: 0,
    timeout: 10000
  });
});

const getCoordinates = async () => {
  const status = await getGeolocationPermission();

  if (status === 'prompt') {
    let resolveModal;
    const modalAnswer = new Promise(resolve => {
      resolveModal = resolve;
    });
    modal.open({
      title: t('You_will_be_asked_for_permissions'),
      confirmButtonText: t('Continue'),
      showCancelButton: true,
      closeOnConfirm: true,
      closeOnCancel: true
    }, async isConfirm => {
      if (!isConfirm) {
        resolveModal(false);
      }

      const position = await getGeolocationPosition();

      if (!position) {
        const newStatus = getGeolocationPermission();
        resolveModal(newStatus);
      }

      resolveModal(position);
    });
    const position = await modalAnswer;
    return position;
  }

  if (status === 'denied') {
    return status;
  }

  const position = await getGeolocationPosition();
  return position;
};

messageBox.actions.add('Share', 'My_location', {
  id: 'share-location',
  icon: 'map-pin',
  condition: () => canGetGeolocation.get(),

  async action(_ref4) {
    let {
      rid,
      tmid
    } = _ref4;
    const position = await getCoordinates();

    if (!position) {
      return;
    }

    if (position === 'denied') {
      modal.open({
        title: t('Cannot_share_your_location'),
        text: t('The_necessary_browser_permissions_for_location_sharing_are_not_granted'),
        confirmButtonText: t('Ok'),
        closeOnConfirm: true
      });
      return;
    }

    const {
      coords: {
        latitude,
        longitude
      }
    } = position;
    const text = "<div class=\"upload-preview\"><div class=\"upload-preview-file\" style=\"background-size: cover; box-shadow: 0 0 0px 1px #dfdfdf; border-radius: 2px; height: 250px; width:100%; max-width: 500px; background-image:url(https://maps.googleapis.com/maps/api/staticmap?zoom=14&size=500x250&markers=color:gray%7Clabel:%7C".concat(latitude, ",").concat(longitude, "&key=").concat(settings.get('MapView_GMapsAPIKey'), ")\" ></div></div>");
    modal.open({
      title: t('Share_Location_Title'),
      text,
      showCancelButton: true,
      closeOnConfirm: true,
      closeOnCancel: true,
      html: true
    }, function (isConfirm) {
      if (isConfirm !== true) {
        return;
      }

      Meteor.call('sendMessage', {
        _id: Random.id(),
        rid,
        tmid,
        msg: '',
        location: {
          type: 'Point',
          coordinates: [longitude, latitude]
        }
      });
    });
  }

});
Meteor.startup(() => {
  Tracker.autorun(() => {
    const isMapViewEnabled = settings.get('MapView_Enabled') === true;
    const isGeolocationCurrentPositionSupported = navigator.geolocation && navigator.geolocation.getCurrentPosition;
    const googleMapsApiKey = settings.get('MapView_GMapsAPIKey');
    canGetGeolocation.set(isMapViewEnabled && isGeolocationCurrentPositionSupported && googleMapsApiKey && googleMapsApiKey.length);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxAudioMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxAudioMessage.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);
let AudioRecorder, fileUpload, USER_ACTIVITIES, UserAction;
module.link("../../../ui", {
  AudioRecorder(v) {
    AudioRecorder = v;
  },

  fileUpload(v) {
    fileUpload = v;
  },

  USER_ACTIVITIES(v) {
    USER_ACTIVITIES = v;
  },

  UserAction(v) {
    UserAction = v;
  }

}, 3);
let t;
module.link("../../../utils", {
  t(v) {
    t = v;
  }

}, 4);
module.link("./messageBoxAudioMessage.html");

const startRecording = async (rid, tmid) => {
  try {
    await AudioRecorder.start();
    UserAction.performContinuously(rid, USER_ACTIVITIES.USER_RECORDING, {
      tmid
    });
  } catch (error) {
    throw error;
  }
};

const stopRecording = async (rid, tmid) => {
  const result = await new Promise(resolve => AudioRecorder.stop(resolve));
  UserAction.stop(rid, USER_ACTIVITIES.USER_RECORDING, {
    tmid
  });
  return result;
};

const recordingInterval = new ReactiveVar(null);
const recordingRoomId = new ReactiveVar(null);

const clearIntervalVariables = () => {
  if (recordingInterval.get()) {
    clearInterval(recordingInterval.get());
    recordingInterval.set(null);
    recordingRoomId.set(null);
  }
};

const cancelRecording = async (instance, rid, tmid) => {
  clearIntervalVariables();
  instance.time.set('00:00');
  const blob = await stopRecording(rid, tmid);
  instance.state.set(null);
  return blob;
};

Template.messageBoxAudioMessage.onCreated(async function () {
  this.state = new ReactiveVar(null);
  this.time = new ReactiveVar('00:00');
  this.isMicrophoneDenied = new ReactiveVar(false);

  if (navigator.permissions) {
    try {
      const permissionStatus = await navigator.permissions.query({
        name: 'microphone'
      });
      this.isMicrophoneDenied.set(permissionStatus.state === 'denied');

      permissionStatus.onchange = () => {
        this.isMicrophoneDenied.set(permissionStatus.state === 'denied');
      };

      return;
    } catch (error) {
      console.warn(error);
    }
  }

  if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {
    this.isMicrophoneDenied.set(true);
    return;
  }

  try {
    if (!(await navigator.mediaDevices.enumerateDevices()).some(_ref => {
      let {
        kind
      } = _ref;
      return kind === 'audioinput';
    })) {
      this.isMicrophoneDenied.set(true);
      return;
    }
  } catch (error) {
    console.warn(error);
  }
});
Template.messageBoxAudioMessage.onDestroyed(async function () {
  if (this.state.get() === 'recording') {
    const {
      rid,
      tmid
    } = this.data;
    await cancelRecording(this, rid, tmid);
  }
});
Template.messageBoxAudioMessage.helpers({
  isAllowed() {
    return AudioRecorder.isSupported() && !Template.instance().isMicrophoneDenied.get() && settings.get('FileUpload_Enabled') && settings.get('Message_AudioRecorderEnabled') && (!settings.get('FileUpload_MediaTypeBlackList') || !settings.get('FileUpload_MediaTypeBlackList').match(/audio\/mp3|audio\/\*/i)) && (!settings.get('FileUpload_MediaTypeWhiteList') || settings.get('FileUpload_MediaTypeWhiteList').match(/audio\/mp3|audio\/\*/i));
  },

  stateClass() {
    if (recordingRoomId.get() && recordingRoomId.get() !== Template.currentData().rid) {
      return 'rc-message-box__audio-message--busy';
    }

    const state = Template.instance().state.get();
    return state && "rc-message-box__audio-message--".concat(state);
  },

  time() {
    return Template.instance().time.get();
  }

});
Template.messageBoxAudioMessage.events({
  async 'click .js-audio-message-record'(event, instance) {
    event.preventDefault();

    if (recordingRoomId.get() && recordingRoomId.get() !== this.rid) {
      return;
    }

    instance.state.set('recording');

    try {
      await startRecording(this.rid, this.tmid);
      const startTime = new Date();
      recordingInterval.set(setInterval(() => {
        const now = new Date();
        const distance = (now.getTime() - startTime.getTime()) / 1000;
        const minutes = Math.floor(distance / 60);
        const seconds = Math.floor(distance % 60);
        instance.time.set("".concat(String(minutes).padStart(2, '0'), ":").concat(String(seconds).padStart(2, '0')));
      }, 1000));
      recordingRoomId.set(this.rid);
    } catch (error) {
      console.log(error);
      instance.isMicrophoneDenied.set(true);
      instance.state.set(null);
    }
  },

  async 'click .js-audio-message-cancel'(event, instance) {
    event.preventDefault();
    await cancelRecording(instance, this.rid, this.tmid);
  },

  async 'click .js-audio-message-done'(event, instance) {
    event.preventDefault();
    instance.state.set('loading');
    const {
      rid,
      tmid
    } = this;
    const blob = await cancelRecording(instance, rid, tmid);
    await fileUpload([{
      file: blob,
      type: 'video',
      name: "".concat(t('Audio record'), ".mp3")
    }], {
      input: blob
    }, {
      rid,
      tmid
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxAutogrow.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxAutogrow.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  setupAutogrow: () => setupAutogrow
});

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);

const replaceWhitespaces = whitespaces => "".concat('&nbsp;'.repeat(whitespaces.length - 1), " ");

const setupAutogrow = (textarea, shadow, callback) => {
  const width = textarea.clientWidth;
  const height = textarea.clientHeight;
  const {
    font,
    lineHeight,
    maxHeight: maxHeightPx
  } = window.getComputedStyle(textarea);
  shadow.style.position = 'fixed';
  shadow.style.top = '-10000px';
  shadow.style.left = '-10000px';
  shadow.style.width = "".concat(width, "px");
  shadow.style.font = font;
  shadow.style.lineHeight = lineHeight;
  shadow.style.resize = 'none';
  shadow.style.wordWrap = 'break-word';
  const minHeight = height;
  const maxHeight = parseInt(maxHeightPx, 10);
  let lastWidth = width;
  let lastHeight = minHeight;
  let textLenght = 0;

  const update = () => {
    const {
      clientWidth: width,
      value: text
    } = textarea;
    const isMaximumHeightReached = lastHeight >= maxHeight;
    const isTextLengthOutdated = textLenght && textLenght < text.length;
    const wasWidthChanged = width !== lastWidth;

    if (isMaximumHeightReached && isTextLengthOutdated && !wasWidthChanged) {
      return true;
    }

    const shadowText = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n$/, '<br/>&nbsp;').replace(/\n/g, '<br/>').replace(/ {2,}/g, replaceWhitespaces);

    if (wasWidthChanged) {
      shadow.style.width = "".concat(width, "px");
      lastWidth = width;
    }

    shadow.innerHTML = shadowText;
    const shadowHeight = Math.max(shadow.clientHeight + 1, minHeight) + 1;
    const height = Math.min(shadowHeight, maxHeight);

    if (height === lastHeight) {
      return true;
    }

    lastHeight = height;
    const overflow = height < maxHeight ? 'hidden' : '';

    if (height < maxHeight) {
      textLenght = text.length;
    }

    textarea.style.overflow = overflow;
    textarea.style.height = "".concat(height, "px");
    callback && callback();
  };

  const updateThrottled = _.throttle(update, 300);

  const $textarea = $(textarea);
  $textarea.on('focus', update);
  $textarea.on('change input', updateThrottled);
  window.addEventListener('resize', updateThrottled, false);

  const destroy = () => {
    $textarea.off('focus', update);
    $textarea.off('change input', updateThrottled);
    window.removeEventListener('resize', updateThrottled);
  };

  update();
  return {
    update,
    destroy
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxFormatting.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxFormatting.js                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  formattingButtons: () => formattingButtons,
  applyFormatting: () => applyFormatting
});
let Markdown;
module.link("../../../markdown/client", {
  Markdown(v) {
    Markdown = v;
  }

}, 0);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);
const formattingButtons = [{
  label: 'bold',
  icon: 'bold',
  pattern: '*{{text}}*',
  command: 'b',
  condition: () => Markdown && settings.get('Markdown_Parser') === 'original'
}, {
  label: 'bold',
  icon: 'bold',
  pattern: '**{{text}}**',
  command: 'b',
  condition: () => Markdown && settings.get('Markdown_Parser') === 'marked'
}, {
  label: 'italic',
  icon: 'italic',
  pattern: '_{{text}}_',
  command: 'i',
  condition: () => Markdown && settings.get('Markdown_Parser') !== 'disabled'
}, {
  label: 'strike',
  icon: 'strike',
  pattern: '~{{text}}~',
  condition: () => Markdown && settings.get('Markdown_Parser') === 'original'
}, {
  label: 'strike',
  icon: 'strike',
  pattern: '~~{{text}}~~',
  condition: () => Markdown && settings.get('Markdown_Parser') === 'marked'
}, {
  label: 'inline_code',
  icon: 'code',
  pattern: '`{{text}}`',
  condition: () => Markdown && settings.get('Markdown_Parser') !== 'disabled'
}, {
  label: 'multi_line',
  icon: 'multiline',
  pattern: '```\n{{text}}\n``` ',
  condition: () => Markdown && settings.get('Markdown_Parser') !== 'disabled'
}, {
  label: 'KaTeX',
  text: () => {
    if (!settings.get('Katex_Enabled')) {
      return;
    }

    if (settings.get('Katex_Dollar_Syntax')) {
      return '$$KaTeX$$';
    }

    if (settings.get('Katex_Parenthesis_Syntax')) {
      return '\\[KaTeX\\]';
    }
  },
  link: 'https://khan.github.io/KaTeX/function-support.html',
  condition: () => settings.get('Katex_Enabled')
}];

function applyFormatting(pattern, input) {
  const {
    selectionEnd = input.value.length,
    selectionStart = 0
  } = input;
  const initText = input.value.slice(0, selectionStart);
  const selectedText = input.value.slice(selectionStart, selectionEnd);
  const finalText = input.value.slice(selectionEnd, input.value.length);
  input.focus();
  const startPattern = pattern.substr(0, pattern.indexOf('{{text}}'));
  const startPatternFound = [...startPattern].reverse().every((char, index) => input.value.substr(selectionStart - index - 1, 1) === char);

  if (startPatternFound) {
    const endPattern = pattern.substr(pattern.indexOf('{{text}}') + '{{text}}'.length);
    const endPatternFound = [...endPattern].every((char, index) => input.value.substr(selectionEnd + index, 1) === char);

    if (endPatternFound) {
      input.selectionStart = selectionStart - startPattern.length;
      input.selectionEnd = selectionEnd + endPattern.length;

      if (!document.execCommand || !document.execCommand('insertText', false, selectedText)) {
        input.value = initText.substr(0, initText.length - startPattern.length) + selectedText + finalText.substr(endPattern.length);
      }

      input.selectionStart = selectionStart - startPattern.length;
      input.selectionEnd = input.selectionStart + selectedText.length;
      $(input).change();
      return;
    }
  }

  if (!document.execCommand || !document.execCommand('insertText', false, pattern.replace('{{text}}', selectedText))) {
    input.value = initText + pattern.replace('{{text}}', selectedText) + finalText;
  }

  input.selectionStart = selectionStart + pattern.indexOf('{{text}}');
  input.selectionEnd = input.selectionStart + selectedText.length;
  $(input).change();
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxNotSubscribed.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxNotSubscribed.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let RoomManager, RoomHistoryManager;
module.link("../../../ui-utils/client", {
  RoomManager(v) {
    RoomManager = v;
  },

  RoomHistoryManager(v) {
    RoomHistoryManager = v;
  }

}, 4);
let roomTypes;
module.link("../../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 5);
let hasAllPermission;
module.link("../../../authorization/client", {
  hasAllPermission(v) {
    hasAllPermission = v;
  }

}, 6);
module.link("./messageBoxNotSubscribed.html");
let call;
module.link("../../../../client/lib/utils/call", {
  call(v) {
    call = v;
  }

}, 7);
Template.messageBoxNotSubscribed.helpers({
  customTemplate() {
    return roomTypes.getNotSubscribedTpl(this.rid);
  },

  canJoinRoom() {
    return Meteor.userId() && roomTypes.verifyShowJoinLink(this.rid);
  },

  roomName() {
    const room = Session.get("roomData".concat(this.rid));
    return roomTypes.getRoomName(room.t, room);
  },

  isJoinCodeRequired() {
    const room = Session.get("roomData".concat(this.rid));
    return room && room.joinCodeRequired;
  },

  isAnonymousReadAllowed() {
    return Meteor.userId() == null && settings.get('Accounts_AllowAnonymousRead') === true;
  },

  isAnonymousWriteAllowed() {
    return Meteor.userId() == null && settings.get('Accounts_AllowAnonymousRead') === true && settings.get('Accounts_AllowAnonymousWrite') === true;
  }

});
Template.messageBoxNotSubscribed.events({
  async 'click .js-join-code'(event) {
    event.stopPropagation();
    event.preventDefault();
    const joinCodeInput = Template.instance().find('[name=joinCode]');
    const joinCode = joinCodeInput && joinCodeInput.value;
    await call('joinRoom', this.rid, joinCode);

    if (hasAllPermission('preview-c-room') === false && RoomHistoryManager.getRoom(this.rid).loaded === 0) {
      RoomManager.getOpenedRoomByRid(this.rid).streamActive = false;
      RoomManager.getOpenedRoomByRid(this.rid).ready = false;
      RoomHistoryManager.getRoom(this.rid).loaded = null;
      RoomManager.computation.invalidate();
    }
  },

  'click .js-register'(event) {
    event.stopPropagation();
    event.preventDefault();
    Session.set('forceLogin', true);
  },

  async 'click .js-register-anonymous'(event) {
    event.stopPropagation();
    event.preventDefault();
    const {
      token
    } = await call('registerUser', {});
    Meteor.loginWithToken(token);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxReadOnly.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxReadOnly.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let roomTypes;
module.link("../../../utils", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 1);
module.link("./messageBoxReadOnly.html");
Template.messageBoxReadOnly.helpers({
  customTemplate() {
    return roomTypes.getReadOnlyTpl(this.rid);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxReplyPreview.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxReplyPreview.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
module.link("./messageBoxReplyPreview.html");
Template.messageBoxReplyPreview.helpers({
  attachments() {
    const {
      replyMessageData
    } = this;
    return [{
      text: replyMessageData.msg,
      author_name: replyMessageData.u.username
    }];
  }

});
Template.messageBoxReplyPreview.events({
  'click .cancel-reply'(event) {
    event.preventDefault();
    event.stopPropagation();
    const {
      mid
    } = event.currentTarget.dataset;
    const $input = $(this.input);
    this.input.focus();
    const messages = $input.data('reply') || [];
    const filtered = messages.filter(_ref => {
      let {
        _id
      } = _ref;
      return _id !== mid;
    });
    $input.data('reply', filtered).trigger('dataChange');
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userActionIndicator.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/userActionIndicator.ts                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let UserAction;
module.link("../../../ui", {
  UserAction(v) {
    UserAction = v;
  }

}, 1);
let t;
module.link("../../../utils/client", {
  t(v) {
    t = v;
  }

}, 2);
let getConfig;
module.link("../../../../client/lib/utils/getConfig", {
  getConfig(v) {
    getConfig = v;
  }

}, 3);
module.link("./userActionIndicator.html");
const maxUsernames = parseInt(getConfig('max-usernames-typing') || '2');
Template.userActionIndicator.helpers({
  data() {
    const roomAction = UserAction.get(this.tmid || this.rid) || {};

    if (!Object.keys(roomAction).length) {
      return [];
    }

    const activities = Object.entries(roomAction);
    const userActions = activities.map(_ref => {
      let [key, _users] = _ref;
      const users = Object.keys(_users);

      if (users.length === 0) {
        return {
          end: false
        };
      }

      const action = key.split('-')[1];

      if (users.length === 1) {
        return {
          action,
          multi: false,
          users: users[0],
          end: false
        };
      }

      let last = users.pop();

      if (users.length >= maxUsernames) {
        last = t('others');
      }

      const usernames = [users.slice(0, maxUsernames - 1).join(', '), last];
      return {
        action,
        multi: true,
        users: usernames.join(" ".concat(t('and'), " ")),
        end: false
      };
    }).filter(i => i.action);

    if (!Object.keys(userActions).length) {
      return [];
    } // insert end=true for the last item.


    userActions[userActions.length - 1].end = true;
    return userActions;
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"popup":{"messagePopup.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopup.html                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopup.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopup.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopup.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopup");
Template["messagePopup"] = new Template("Template.messagePopup", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isOpen"));
  }, function() {
    return [ "\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("sidebar"));
    }, function() {
      return [ "\n\t\t\t", HTML.UL({
        class: "rooms-list__list rooms-list__toolbar-search",
        style: function() {
          return [ "top: ", Spacebars.mustache(view.lookup("sidebarHeaderHeight")), "; height: calc(100vh - ", Spacebars.mustache(view.lookup("sidebarHeaderHeight")), "); width: ", Spacebars.mustache(view.lookup("sidebarWidth")) ];
        }
      }, "\n\t\t\t\t", Blaze.Each(function() {
        return Spacebars.call(view.lookup("data"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            template: Spacebars.call(Spacebars.dot(view.lookup(".."), "template")),
            data: Spacebars.call(view.lookup("toolbarData"))
          };
        }, function() {
          return Spacebars.include(function() {
            return Spacebars.call(Template.__dynamic);
          });
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\t\t" ];
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "message-popup-position"
      }, "\n\t\t\t\t", HTML.DIV({
        class: function() {
          return [ "message-popup content-background-color ", Spacebars.mustache(view.lookup("cls")) ];
        },
        id: "popup"
      }, "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("title"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "message-popup-title secondary-background-color border-component-color"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:title", function() {
          return Spacebars.mustache(view.lookup("title"));
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", HTML.DIV({
        class: "message-popup-items"
      }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return Spacebars.call(view.lookup("data"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
          class: "popup-item",
          "data-id": function() {
            return Spacebars.mustache(view.lookup("_id"));
          }
        }, "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            template: Spacebars.call(Spacebars.dot(view.lookup(".."), "template"))
          };
        }, function() {
          return Spacebars.include(function() {
            return Spacebars.call(Template.__dynamic);
          });
        }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("data"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze.Unless(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("isLoading"), "get"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("emptyTemplate"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
              return {
                template: Spacebars.call(view.lookup("emptyTemplate"))
              };
            }, function() {
              return Spacebars.include(function() {
                return Spacebars.call(Template.__dynamic);
              });
            }), "\n\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("isLoading"), "get"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupChannel.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupChannel.html                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupChannel.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupChannel.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupChannel.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupChannel");
Template["messagePopupChannel"] = new Template("Template.messagePopupChannel", (function() {
  var view = this;
  return [ Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call(view.lookup("channelIcon"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t", Blaze.View("lookup:name", function() {
    return Spacebars.mustache(view.lookup("name"));
  }) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupConfig.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupConfig.html                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupConfig.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupConfig.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupConfig.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupConfig");
Template["messagePopupConfig"] = new Template("Template.messagePopupConfig", (function() {
  var view = this;
  return HTML.DIV({
    class: "message-popup-results"
  }, "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("popupUserConfig"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messagePopup"));
  }), "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("popupChannelConfig"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messagePopup"));
  }), "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("popupSlashCommandsConfig"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messagePopup"));
  }), "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("popupEmojiConfig"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messagePopup"));
  }), "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("popupReactionEmojiConfig"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messagePopup"));
  }), "\n\n\t\t", Blaze.Each(function() {
    return Spacebars.call(view.lookup("customMessagePopups"));
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("getCustomConfig"));
    }, function() {
      return Spacebars.include(view.lookupTemplate("messagePopup"));
    }), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupEmoji.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupEmoji.html                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupEmoji.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupEmoji.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupEmoji.js                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupEmoji");
Template["messagePopupEmoji"] = new Template("Template.messagePopupEmoji", (function() {
  var view = this;
  return [ Blaze.View("lookup:renderEmoji", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("renderEmoji"), view.lookup("_id")));
  }), "\n\t", Blaze.View("lookup:_id", function() {
    return Spacebars.mustache(view.lookup("_id"));
  }) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupSlashCommand.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupSlashCommand.html                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupSlashCommand.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupSlashCommand.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupSlashCommand.js                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupSlashCommand");
Template["messagePopupSlashCommand"] = new Template("Template.messagePopupSlashCommand", (function() {
  var view = this;
  return HTML.DIV({
    class: "popup-slash-command"
  }, "\n\t\t", HTML.DIV({
    class: "popup-slash-command-format"
  }, HTML.STRONG("/", Blaze.View("lookup:_id", function() {
    return Spacebars.mustache(view.lookup("_id"));
  })), Blaze.If(function() {
    return Spacebars.call(view.lookup("params"));
  }, function() {
    return [ " ", Blaze.View("lookup:params", function() {
      return Spacebars.mustache(view.lookup("params"));
    }) ];
  })), "\n\t\t", HTML.DIV({
    class: "popup-slash-command-description"
  }, Blaze.View("lookup:description", function() {
    return Spacebars.mustache(view.lookup("description"));
  })), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupSlashCommandPreview.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupSlashCommandPreview.html                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupSlashCommandPreview.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupSlashCommandPreview.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupSlashCommandPreview.js                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupSlashCommandPreview");
Template["messagePopupSlashCommandPreview"] = new Template("Template.messagePopupSlashCommandPreview", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isOpen"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "message-popup-position"
    }, "\n\t\t\t", HTML.DIV({
      class: function() {
        return [ "message-popup content-background-color ", Spacebars.mustache(view.lookup("cls")) ];
      }
    }, "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isLoading"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV({
        class: "message-popup-title secondary-background-color border-component-color"
      }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Loading...");
      }), "\n\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t", Spacebars.With(function() {
        return Spacebars.call(view.lookup("preview"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "message-popup-title secondary-background-color border-component-color"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), view.lookup("i18nTitle"));
        }), " ", HTML.STRONG(Blaze.View("lookup:getArgs", function() {
          return Spacebars.mustache(view.lookup("getArgs"));
        })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
          class: "message-popup-items preview-items"
        }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return Spacebars.call(view.lookup("items"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "popup-item",
            "data-id": function() {
              return Spacebars.mustache(view.lookup("id"));
            }
          }, "\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("isType"), "image", view.lookup("type"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.IMG({
              src: function() {
                return Spacebars.mustache(view.lookup("value"));
              },
              alt: function() {
                return Spacebars.mustache(view.lookup("value"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("isType"), "audio", view.lookup("type"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.AUDIO({
              controls: ""
            }, "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SOURCE({
              src: function() {
                return Spacebars.mustache(view.lookup("value"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t\t\tYour browser does not support the audio element.\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("isType"), "video", view.lookup("type"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.VIDEO({
              controls: "",
              class: "inline-video"
            }, "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SOURCE({
              src: function() {
                return Spacebars.mustache(view.lookup("value"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t\t\tYour browser does not support the video element.\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("isType"), "text", view.lookup("type"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.H4(Blaze.View("lookup:value", function() {
              return Spacebars.mustache(view.lookup("value"));
            })), HTML.Raw(" <!-- Not sure what to do here -->\n\t\t\t\t\t\t\t\t\t") ];
          }), "\n\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("isType"), "other", view.lookup("type"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.CODE(Blaze.View("lookup:value", function() {
              return Spacebars.mustache(view.lookup("value"));
            })), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t"), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupUser.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupUser.html                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupUser.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupUser.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupUser.js                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupUser");
Template["messagePopupUser"] = new Template("Template.messagePopupUser", (function() {
  var view = this;
  return HTML.DIV({
    class: "popup-user",
    title: function() {
      return [ Blaze.If(function() {
        return Spacebars.call(view.lookup("outside"));
      }, function() {
        return Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Not_in_channel");
        });
      }), " ", Blaze.If(function() {
        return Spacebars.call(view.lookup("suggestion"));
      }, function() {
        return Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Suggestion_from_recent_messages");
        });
      }) ];
    }
  }, "\n\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("system"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "popup-user-avatar_wrap"
    }, "\n\t\t\t", HTML.DIV({
      class: function() {
        return [ "popup-user-status border-transparent-dark popup-user-status-", Spacebars.mustache(view.lookup("status")) ];
      }
    }), "\n\t\t\t", HTML.DIV({
      class: "popup-user-avatar",
      style: function() {
        return [ "background-image:url(", Spacebars.mustache(view.lookup("avatarUrlFromUsername"), view.lookup("username"), view.lookup("avatarETag")), ");" ];
      }
    }), "\n\t\t"), "\n\t\t" ];
  }), "\n\t\t", HTML.DIV({
    class: "popup-user-name"
  }, "\n\t\t\t", HTML.STRONG(Blaze.View("lookup:username", function() {
    return Spacebars.mustache(view.lookup("username"));
  })), " ", Blaze.View("lookup:name", function() {
    return Spacebars.mustache(view.lookup("name"));
  }), Blaze.If(function() {
    return Spacebars.call(view.lookup("nickname"));
  }, function() {
    return [ " (", Blaze.View("lookup:nickname", function() {
      return Spacebars.mustache(view.lookup("nickname"));
    }), ")" ];
  }), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "popup-user-notice"
  }, "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("outside"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "popup-user-not_in_channel"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Not_in_channel");
    })), "\n\t\t\t" ];
  }), "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("suggestion"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "popup-user-not_in_channel"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Suggestion_from_recent_messages");
    })), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"customMessagePopups.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/customMessagePopups.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  customMessagePopups: () => customMessagePopups,
  addMessagePopup: () => addMessagePopup,
  removeMessagePopup: () => removeMessagePopup
});
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
const customMessagePopups = new ReactiveVar([]);

const nonReactiveGetFunc = () => Tracker.nonreactive(() => customMessagePopups.get());

const addMessagePopup = (configGetter, name) => {
  customMessagePopups.set([...nonReactiveGetFunc(), {
    configGetter,
    name
  }]);
};

const removeMessagePopup = popupName => {
  const customMessagePopupsList = nonReactiveGetFunc();
  const element = customMessagePopupsList.findIndex(_ref => {
    let {
      name
    } = _ref;
    return name === popupName;
  });

  if (element < 0) {
    return;
  }

  const listWithRemovedElement = [...customMessagePopupsList.slice(0, element), ...customMessagePopupsList.slice(element + 1, customMessagePopupsList.length)];
  customMessagePopups.set([...listWithRemovedElement]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopup.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 3);
module.link("./messagePopup.html");
const keys = {
  TAB: 9,
  ENTER: 13,
  ESC: 27,
  ARROW_LEFT: 37,
  ARROW_UP: 38,
  ARROW_RIGHT: 39,
  ARROW_DOWN: 40
};

function getCursorPosition(input) {
  if (input == null) {
    return;
  }

  if (input.selectionStart != null) {
    return input.selectionStart;
  }

  if (document.selection != null) {
    input.focus();
    const sel = document.selection.createRange();
    const selLen = document.selection.createRange().text.length;
    sel.moveStart('character', -input.value.length);
    return sel.text.length - selLen;
  }
}

function setCursorPosition(input, caretPos) {
  if (input == null) {
    return;
  }

  if (input.selectionStart != null) {
    input.focus();
    return input.setSelectionRange(caretPos, caretPos);
  }

  if (document.selection != null) {
    const range = input.createTextRange();
    range.move('character', caretPos);
    return range.select();
  }
}

function val(v, d) {
  if (v != null) {
    return v;
  }

  return d;
}

Template.messagePopup.onCreated(function () {
  const template = this;
  template.textFilter = new ReactiveVar('');
  template.textFilterDelay = val(template.data.textFilterDelay, 0);
  template.open = val(template.data.open, new ReactiveVar(false));
  template.hasData = new ReactiveVar(false);
  template.value = new ReactiveVar();
  template.trigger = val(template.data.trigger, '');
  template.triggerAnywhere = val(template.data.triggerAnywhere, true);
  template.closeOnEsc = val(template.data.closeOnEsc, true);
  template.blurOnSelectItem = val(template.data.blurOnSelectItem, false);
  template.prefix = val(template.data.prefix, template.trigger);
  template.suffix = val(template.data.suffix, '');

  if (template.triggerAnywhere === true) {
    template.matchSelectorRegex = val(template.data.matchSelectorRegex, new RegExp("(?:^| |\n)".concat(template.trigger, "[^\\s]*$")));
  } else {
    template.matchSelectorRegex = val(template.data.matchSelectorRegex, new RegExp("(?:^)".concat(template.trigger, "[^\\s]*$")));
  }

  template.selectorRegex = val(template.data.selectorRegex, new RegExp("".concat(template.trigger, "([^\\s]*)$")));
  template.replaceRegex = val(template.data.replaceRegex, new RegExp("".concat(template.trigger, "[^\\s]*$")));
  template.getValue = val(template.data.getValue, function (_id) {
    return _id;
  });

  template.up = () => {
    const current = template.find('.popup-item.selected');
    const previous = $(current).prev('.popup-item')[0] || template.find('.popup-item:last-child');

    if (previous != null) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
      previous.className += ' selected sidebar-item__popup-active';
      previous.scrollIntoView(false);
      return template.value.set(previous.getAttribute('data-id'));
    }
  };

  template.down = () => {
    const current = template.find('.popup-item.selected');
    const next = $(current).next('.popup-item')[0] || template.find('.popup-item');

    if (next && next.classList.contains('popup-item')) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
      next.className += ' selected sidebar-item__popup-active';
      next.scrollIntoView(false);
      return template.value.set(next.getAttribute('data-id'));
    }
  };

  template.verifySelection = () => {
    if (!template.open.curValue) {
      return;
    }

    const current = template.find('.popup-item.selected');

    if (current == null) {
      const first = template.find('.popup-item');

      if (first != null) {
        first.className += ' selected sidebar-item__popup-active';
        return template.value.set(first.getAttribute('data-id'));
      }

      return template.value.set(null);
    }
  };

  template.onInputKeydown = event => {
    if (template.open.curValue !== true || template.hasData.curValue !== true) {
      return;
    }

    if (event.which === keys.ENTER || event.which === keys.TAB) {
      if (template.blurOnSelectItem === true) {
        template.input.blur();
      } else {
        template.open.set(false);
      }

      template.enterValue();

      if (template.data.cleanOnEnter) {
        template.input.value = '';
      }

      event.preventDefault();
      event.stopPropagation();
      return;
    }

    if (event.which === keys.ARROW_UP) {
      template.up();
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    if (event.which === keys.ARROW_DOWN) {
      template.down();
      event.preventDefault();
      event.stopPropagation();
    }
  };

  template.setTextFilter = _.debounce(function (value) {
    return template.textFilter.set(value);
  }, template.textFilterDelay);

  template.onInputKeyup = event => {
    if (template.closeOnEsc === true && template.open.curValue === true && event.which === keys.ESC) {
      template.open.set(false);
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    const value = template.input.value.substr(0, getCursorPosition(template.input));

    if (template.matchSelectorRegex.test(value)) {
      template.setTextFilter(value.match(template.selectorRegex)[1]);
      template.open.set(true);
    } else {
      template.open.set(false);
    }

    if (template.open.curValue !== true) {
      return;
    }

    if (event.which !== keys.ARROW_UP && event.which !== keys.ARROW_DOWN) {
      return Meteor.defer(function () {
        template.verifySelection();
      });
    }
  };

  template.onFocus = () => {
    template.clickingItem = false;

    if (template.open.curValue === true) {
      return;
    }

    const value = template.input.value.substr(0, getCursorPosition(template.input));

    if (template.matchSelectorRegex.test(value)) {
      template.setTextFilter(value.match(template.selectorRegex)[1]);
      template.open.set(true);
      return Meteor.defer(function () {
        return template.verifySelection();
      });
    }

    return template.open.set(false);
  };

  template.onBlur = () => {
    if (template.open.curValue === false) {
      return;
    }

    if (template.clickingItem === true) {
      return;
    }

    return template.open.set(false);
  };

  template.enterValue = function () {
    if (template.value.curValue == null) {
      return;
    }

    const {
      value
    } = template.input;
    const caret = getCursorPosition(template.input);
    let firstPartValue = value.substr(0, caret);
    const lastPartValue = value.substr(caret);
    const getValue = this.getValue(template.value.curValue, template.data.collection, template.records.get(), firstPartValue);

    if (!getValue) {
      return;
    }

    firstPartValue = firstPartValue.replace(template.selectorRegex, template.prefix + getValue + template.suffix);
    template.input.value = firstPartValue + lastPartValue;
    return setCursorPosition(template.input, firstPartValue.length);
  };

  template.records = new ReactiveVar([]);
  template.autorun(function () {
    const filter = template.textFilter.get();

    if (filter != null) {
      const filterCallback = result => {
        template.hasData.set(result && result.length > 0);
        template.records.set(result);
        return Meteor.defer(function () {
          return template.verifySelection();
        });
      };

      const result = template.data.getFilter(template.data.collection, filter, filterCallback);

      if (result != null) {
        return filterCallback(result);
      }
    }
  });
});
Template.messagePopup.onRendered(function () {
  if (this.data.getInput != null) {
    this.input = typeof this.data.getInput === 'function' && this.data.getInput();
  } else if (this.data.input) {
    this.input = this.parentTemplate().find(this.data.input);
  }

  if (this.input == null) {
    console.error('Input not found for popup');
  }

  const self = this;
  self.autorun(() => {
    const open = self.open.get();

    if ($('.reply-preview').length) {
      if (open === true) {
        $('.reply-preview').addClass('reply-preview-with-popup');
        setTimeout(() => {
          $('#popup').addClass('popup-with-reply-preview');
        }, 50);
      }
    }

    if (open === false) {
      $('.reply-preview').removeClass('reply-preview-with-popup');
      $('#popup').removeClass('popup-with-reply-preview');
    }
  });
  $(this.input).on('keyup', this.onInputKeyup.bind(this));
  $(this.input).on('keydown', this.onInputKeydown.bind(this));
  $(this.input).on('focus', this.onFocus.bind(this));
  $(this.input).on('blur', this.onBlur.bind(this));
});
Template.messagePopup.onDestroyed(function () {
  $(this.input).off('keyup', this.onInputKeyup);
  $(this.input).off('keydown', this.onInputKeydown);
  $(this.input).off('focus', this.onFocus);
  $(this.input).off('blur', this.onBlur);
});
Template.messagePopup.events({
  'mouseenter .popup-item'(e) {
    if (e.currentTarget.className.indexOf('selected') > -1) {
      return;
    }

    const template = Template.instance();
    const current = template.find('.popup-item.selected');

    if (current != null) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
    }

    e.currentTarget.className += ' selected sidebar-item__popup-active';
    return template.value.set(this._id);
  },

  'mousedown .popup-item, touchstart .popup-item'() {
    const template = Template.instance();
    template.clickingItem = true;
  },

  'mouseup .popup-item, touchend .popup-item'(e) {
    e.stopPropagation();
    const template = Template.instance();
    const wasMenuIconClicked = e.target.classList.contains('sidebar-item__menu-icon');
    template.clickingItem = false;

    if (!wasMenuIconClicked) {
      template.value.set(this._id);
      template.enterValue();
      template.open.set(false);
    }
  }

});
Template.messagePopup.helpers({
  isOpen() {
    return Template.instance().open.get() && (Template.instance().hasData.get() || Template.instance().data.emptyTemplate != null || !Template.instance().parentTemplate(1).subscriptionsReady());
  },

  data() {
    const template = Template.instance();
    return Object.assign(template.records.get(), {
      toolbar: true
    });
  },

  toolbarData() {
    return _objectSpread(_objectSpread({}, Template.currentData()), {}, {
      toolbar: true
    });
  },

  sidebarHeaderHeight() {
    return "".concat(document.querySelector('.sidebar__header').offsetHeight, "px");
  },

  sidebarWidth() {
    return "".concat(document.querySelector('.sidebar').offsetWidth, "px");
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupChannel.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupChannel.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let roomTypes;
module.link("../../../utils", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 1);
module.link("./messagePopupChannel.html");
Template.messagePopupChannel.helpers({
  channelIcon() {
    return roomTypes.getIcon(this);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupConfig.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupConfig.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 1);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 2);
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 3);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 4);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 5);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 6);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 7);
let escapeRegExp;
module.link("@rocket.chat/string-helpers", {
  escapeRegExp(v) {
    escapeRegExp = v;
  }

}, 8);
let Messages, Subscriptions;
module.link("../../../models/client", {
  Messages(v) {
    Messages = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 9);
let settings;
module.link("../../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 10);
let hasAllPermission, hasAtLeastOnePermission;
module.link("../../../authorization/client", {
  hasAllPermission(v) {
    hasAllPermission = v;
  },

  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 11);
let EmojiPicker, emoji;
module.link("../../../emoji", {
  EmojiPicker(v) {
    EmojiPicker = v;
  },

  emoji(v) {
    emoji = v;
  }

}, 12);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 13);
let t, getUserPreference, slashCommands;
module.link("../../../utils/client", {
  t(v) {
    t = v;
  },

  getUserPreference(v) {
    getUserPreference = v;
  },

  slashCommands(v) {
    slashCommands = v;
  }

}, 14);
let customMessagePopups;
module.link("./customMessagePopups", {
  customMessagePopups(v) {
    customMessagePopups = v;
  }

}, 15);
module.link("./messagePopupConfig.html");
module.link("./messagePopupSlashCommand.html");
module.link("./messagePopupUser.html");

const reloadUsersFromRoomMessages = (rid, template) => {
  const user = Meteor.userId() && Meteor.users.findOne(Meteor.userId(), {
    fields: {
      username: 1
    }
  });

  if (!rid || !user) {
    return;
  }

  template.usersFromRoomMessages.remove({});
  const uniqueMessageUsersControl = {};
  Messages.find({
    rid,
    'u.username': {
      $ne: user.username
    },
    't': {
      $exists: false
    }
  }, {
    fields: {
      'u.username': 1,
      'u.name': 1,
      'ts': 1
    },
    sort: {
      ts: -1
    }
  }).fetch().filter(_ref => {
    let {
      u: {
        username
      }
    } = _ref;
    const notMapped = !uniqueMessageUsersControl[username];
    uniqueMessageUsersControl[username] = true;
    return notMapped;
  }).forEach(_ref2 => {
    let {
      u: {
        username,
        name
      },
      ts
    } = _ref2;
    return template.usersFromRoomMessages.upsert(username, {
      _id: username,
      username,
      name,
      status: Tracker.nonreactive(() => Session.get("user_".concat(username, "_status")) || 'offline'),
      ts
    });
  });
};

const fetchUsersFromServer = _.throttle(async (filterText, records, rid, cb) => {
  const usernames = records.map(_ref3 => {
    let {
      username
    } = _ref3;
    return username;
  });
  const {
    users
  } = await callWithErrorHandling('spotlight', filterText, usernames, {
    users: true,
    mentions: true
  }, rid);

  if (!users || users.length <= 0) {
    return;
  }

  users // .slice(0, 5)
  .forEach(_ref4 => {
    let {
      username,
      nickname,
      name,
      status,
      avatarETag,
      outside
    } = _ref4;
    // if (records.length < 5) {
    records.push({
      _id: username,
      username,
      nickname,
      name,
      status,
      avatarETag,
      outside,
      sort: 3
    }); // }
  });
  records.sort((_ref5, _ref6) => {
    let {
      sort: sortA
    } = _ref5;
    let {
      sort: sortB
    } = _ref6;
    return sortA - sortB;
  });
  cb && cb(records);
}, 1000);

const fetchRoomsFromServer = _.throttle(async (filterText, records, rid, cb) => {
  if (!hasAllPermission('view-outside-room')) {
    cb && cb([]);
    return;
  }

  const {
    rooms
  } = await callWithErrorHandling('spotlight', filterText, null, {
    rooms: true,
    mentions: true
  }, rid);

  if (!rooms || rooms.length <= 0) {
    return;
  }

  rooms.slice(0, 5).forEach(room => {
    if (records.length < 5) {
      records.push(room);
    }
  });
  cb && cb(records);
}, 1000);

const emojiSort = recents => (a, b) => {
  let idA = a._id;
  let idB = a._id;

  if (recents.includes(a._id)) {
    idA = recents.indexOf(a._id) + idA;
  }

  if (recents.includes(b._id)) {
    idB = recents.indexOf(b._id) + idB;
  }

  if (idA < idB) {
    return -1;
  }

  if (idA > idB) {
    return 1;
  }

  return 0;
};

const exactFinalTone = new RegExp('^tone[1-5]:*$');
const colorBlind = new RegExp('tone[1-5]:*$');
const seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');

const getEmojis = (collection, filter) => {
  const key = ":".concat(filter);

  if (!getUserPreference(Meteor.userId(), 'useEmojis')) {
    return [];
  }

  if (!emoji.packages.emojione || emoji.packages.emojione.asciiList[key]) {
    return [];
  }

  const regExp = new RegExp(escapeRegExp(filter), 'i');
  const recents = EmojiPicker.getRecent().map(item => ":".concat(item, ":"));
  return Object.keys(collection).map(_id => {
    const data = collection[key];
    return {
      _id,
      data
    };
  }).filter(_ref7 => {
    let {
      _id
    } = _ref7;
    return regExp.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id));
  }).sort(emojiSort(recents)).slice(0, 10);
};

const addEmojiToRecents = emoji => {
  const pickerEl = document.querySelector('.emoji-picker');

  if (!pickerEl) {
    return;
  }

  const view = Blaze.getView(pickerEl);

  if (!view) {
    return;
  }

  Template._withTemplateInstanceFunc(view.templateInstance, () => {
    EmojiPicker.addRecent(emoji.replace(/:/g, ''));
  });
};

Template.messagePopupConfig.onCreated(function () {
  this.usersFromRoomMessages = new Mongo.Collection(null);
  this.autorun(() => {
    const {
      rid
    } = this.data;
    reloadUsersFromRoomMessages(rid, this);
  });
});
Template.messagePopupConfig.helpers({
  customMessagePopups() {
    return customMessagePopups.get();
  },

  getCustomConfig() {
    const template = Template.instance();
    return this.configGetter(template);
  },

  popupUserConfig() {
    var _this = this;

    const template = Template.instance();
    const suggestionsCount = settings.get('Number_of_users_autocomplete_suggestions');
    return {
      title: t('People'),
      collection: template.usersFromRoomMessages,
      template: 'messagePopupUser',
      rid: this.rid,
      getInput: this.getInput,
      textFilterDelay: 500,
      trigger: '@',
      suffix: ' ',
      getFilter: function (collection) {
        let filter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
        let cb = arguments.length > 2 ? arguments[2] : undefined;
        const {
          rid
        } = _this;
        const filterText = filter.trim();
        const filterRegex = filterText !== '' && new RegExp("".concat(escapeRegExp(filterText)), 'i');
        const items = template.usersFromRoomMessages.find(_objectSpread({
          ts: {
            $exists: true
          }
        }, filterText && {
          $or: [{
            username: filterRegex
          }, {
            name: filterRegex
          }]
        }), {
          limit: filterText ? 2 : suggestionsCount,
          sort: {
            ts: -1
          }
        }).fetch().map(u => {
          u.suggestion = true;
          return u;
        }); // // If needed, add to list the online users
        // if (items.length < 5 && filterRegex) {
        // 	const usernamesAlreadyFetched = items.map(({ username }) => username);
        // 	if (!hasAllPermission('view-outside-room')) {
        // 		const usernamesFromDMs = Subscriptions
        // 			.find(
        // 				{
        // 					t: 'd',
        // 					$and: [
        // 						{
        // 							...filterRegex && {
        // 								$or: [
        // 									{ name: filterRegex },
        // 									{ fname: filterRegex },
        // 								],
        // 							},
        // 						},
        // 						{
        // 							name: { $nin: usernamesAlreadyFetched },
        // 						},
        // 					],
        // 				},
        // 				{
        // 					fields: { name: 1 },
        // 				},
        // 			)
        // 			.map(({ name }) => name);
        // 		const newItems = Users
        // 			.find(
        // 				{
        // 					username: {
        // 						$in: usernamesFromDMs,
        // 					},
        // 				},
        // 				{
        // 					fields: {
        // 						username: 1,
        // 						nickname: 1,
        // 						name: 1,
        // 						status: 1,
        // 					},
        // 					limit: 5 - usernamesAlreadyFetched.length,
        // 				},
        // 			)
        // 			.fetch()
        // 			.map(({ username, name, status, nickname }) => ({
        // 				_id: username,
        // 				username,
        // 				nickname,
        // 				name,
        // 				status,
        // 				sort: 1,
        // 			}));
        // 		items.push(...newItems);
        // 	} else {
        // 		const user = Meteor.users.findOne(Meteor.userId(), { fields: { username: 1 } });
        // 		const newItems = Meteor.users.find({
        // 			$and: [
        // 				{
        // 					...filterRegex && {
        // 						$or: [
        // 							{ username: filterRegex },
        // 							{ name: filterRegex },
        // 						],
        // 					},
        // 				},
        // 				{
        // 					username: {
        // 						$nin: [
        // 							user && user.username,
        // 							...usernamesAlreadyFetched,
        // 						],
        // 					},
        // 				},
        // 			],
        // 		},
        // 		{
        // 			fields: {
        // 				username: 1,
        // 				nickname: 1,
        // 				name: 1,
        // 				status: 1,
        // 			},
        // 			limit: 5 - usernamesAlreadyFetched.length,
        // 		})
        // 			.fetch()
        // 			.map(({ username, name, status, nickname }) => ({
        // 				_id: username,
        // 				username,
        // 				nickname,
        // 				name,
        // 				status,
        // 				sort: 1,
        // 			}));
        // 		items.push(...newItems);
        // 	}
        // }
        // Get users from Server

        if (items.length < suggestionsCount && filterText !== '') {
          fetchUsersFromServer(filterText, items, rid, cb);
        }

        if (!filterRegex || filterRegex.test('all')) {
          items.push({
            _id: 'all',
            username: 'all',
            system: true,
            name: t('Notify_all_in_this_room'),
            sort: 4
          });
        }

        if (!filterRegex || filterRegex.test('here')) {
          items.push({
            _id: 'here',
            username: 'here',
            system: true,
            name: t('Notify_active_in_this_room'),
            sort: 4
          });
        }

        return items;
      },
      getValue: _id => _id
    };
  },

  popupChannelConfig() {
    return {
      title: t('Channels'),
      collection: Subscriptions,
      trigger: '#',
      suffix: ' ',
      textFilterDelay: 500,
      template: 'messagePopupChannel',
      rid: this.rid,
      getInput: this.getInput,
      getFilter: (collection, filter, cb) => {
        const {
          rid
        } = this;
        const exp = new RegExp(filter, 'i');
        const records = collection.find({
          name: exp,
          t: {
            $in: ['c', 'p']
          }
        }, {
          reactive: 1,
          limit: 5,
          sort: {
            ls: -1
          }
        }).fetch();

        if (records.length < 5 && filter && filter.trim() !== '') {
          fetchRoomsFromServer(filter, records, rid, cb);
        }

        return records;
      },
      getValue: (_id, collection, records) => {
        const record = _.findWhere(records, {
          _id
        });

        return record && record.name;
      }
    };
  },

  popupSlashCommandsConfig() {
    return {
      title: t('Commands'),
      collection: slashCommands.commands,
      trigger: '/',
      suffix: ' ',
      triggerAnywhere: false,
      template: 'messagePopupSlashCommand',
      rid: this.rid,
      getInput: this.getInput,
      getFilter: (collection, filter) => {
        const {
          rid
        } = this;
        return Object.keys(collection).map(command => {
          const item = collection[command];
          return {
            _id: command,
            params: item.params ? TAPi18n.__(item.params) : '',
            description: TAPi18n.__(item.description),
            permission: item.permission
          };
        }).filter(command => {
          const isMatch = command._id.indexOf(filter) > -1;

          if (!isMatch) {
            return false;
          }

          if (!command.permission) {
            return true;
          }

          return hasAtLeastOnePermission(command.permission, rid);
        }).sort((a, b) => a._id > b._id).slice(0, 11);
      }
    };
  },

  popupEmojiConfig() {
    return {
      title: t('Emoji'),
      collection: emoji.list,
      template: 'messagePopupEmoji',
      trigger: ':',
      prefix: '',
      suffix: ' ',
      rid: this.rid,
      getInput: this.getInput,
      getFilter: getEmojis,
      getValue: emojiText => {
        addEmojiToRecents(emojiText);
        return emojiText;
      }
    };
  },

  popupReactionEmojiConfig() {
    return {
      title: t('Emoji'),
      collection: emoji.list,
      template: 'messagePopupEmoji',
      trigger: '\\+:',
      prefix: '+',
      suffix: ' ',
      rid: this.rid,
      getInput: this.getInput,
      getFilter: getEmojis,
      getValue: emojiText => {
        addEmojiToRecents(emojiText);
        return emojiText;
      }
    };
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupEmoji.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupEmoji.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
module.link("./messagePopupEmoji.html");
Template.messagePopupEmoji.helpers({
  value() {
    const {
      length
    } = this.data;
    return this.data[length - 1];
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupSlashCommandPreview.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupSlashCommandPreview.js                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 3);
let slashCommands;
module.link("../../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 4);
let hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 5);
module.link("./messagePopupSlashCommandPreview.html");
const keys = {
  TAB: 9,
  ENTER: 13,
  ESC: 27,
  ARROW_LEFT: 37,
  ARROW_UP: 38,
  ARROW_RIGHT: 39,
  ARROW_DOWN: 40
};

function getCursorPosition(input) {
  if (!input) {
    return;
  }

  if (input.selectionStart) {
    return input.selectionStart;
  }

  if (document.selection) {
    input.focus();
    const sel = document.selection.createRange();
    const selLen = document.selection.createRange().text.length;
    sel.moveStart('character', -input.value.length);
    return sel.text.length - selLen;
  }
}

Template.messagePopupSlashCommandPreview.onCreated(function () {
  this.open = new ReactiveVar(false);
  this.isLoading = new ReactiveVar(true);
  this.preview = new ReactiveVar();
  this.selectedItem = new ReactiveVar();
  this.commandName = new ReactiveVar('');
  this.commandArgs = new ReactiveVar(''); // regex ensures a command is entered into the input
  // such as "/testing " before continuing

  this.matchSelectorRegex = /(?:^)(\/[\w\d\S]+ )[^]*$/;
  this.selectorRegex = /(\/[\w\d\S]+ )([^]*)$/;
  this.replaceRegex = /(\/[\w\d\S]+ )[^]*$/; // WHAT'S THIS

  this.dragging = false;
  const template = this;
  template.fetchPreviews = _.debounce(function _previewFetcher(cmd, args) {
    const command = cmd;
    const params = args;
    const {
      rid,
      tmid
    } = template.data;
    Meteor.call('getSlashCommandPreviews', {
      cmd,
      params,
      msg: {
        rid,
        tmid
      }
    }, function (err, preview) {
      if (err) {
        return;
      }

      if (!preview || !Array.isArray(preview.items)) {
        template.preview.set({
          i18nTitle: 'No_results_found_for',
          items: []
        });
      } else {
        template.preview.set(preview);
      }

      template.commandName.set(command);
      template.commandArgs.set(params);
      template.isLoading.set(false);
      Meteor.defer(function () {
        template.verifySelection();
      });
    });
  }, 500);

  template.enterKeyAction = () => {
    const current = template.find('.popup-item.selected');

    if (!current) {
      return;
    }

    const selectedId = current.getAttribute('data-id');

    if (!selectedId) {
      return;
    }

    const cmd = template.commandName.curValue;
    const params = template.commandArgs.curValue;

    if (!cmd || !params) {
      return;
    }

    const item = template.preview.curValue.items.find(i => i.id === selectedId);

    if (!item) {
      return;
    }

    const {
      rid,
      tmid
    } = template.data;
    Meteor.call('executeSlashCommandPreview', {
      cmd,
      params,
      msg: {
        rid,
        tmid
      }
    }, item, function (err) {
      if (err) {
        console.warn(err);
      }
    });
    template.open.set(false);
    template.inputBox.value = '';
    template.preview.set();
    template.commandName.set('');
    template.commandArgs.set('');
  };

  template.selectionLogic = () => {
    const inputValueAtCursor = template.inputBox.value.substr(0, getCursorPosition(template.inputBox));

    if (!template.matchSelectorRegex.test(inputValueAtCursor)) {
      template.open.set(false);
      return;
    }

    const matches = inputValueAtCursor.match(template.selectorRegex);
    const cmd = matches[1].replace('/', '').trim().toLowerCase();
    const command = slashCommands.commands[cmd]; // Ensure the command they're typing actually exists
    // And it provides a command preview
    // And if it provides a permission to check, they have permission to run the command

    const {
      rid
    } = template.data;

    if (!command || !command.providesPreview || command.permission && !hasAtLeastOnePermission(command.permission, rid)) {
      template.open.set(false);
      return;
    }

    const args = matches[2]; // Check to verify there are no additional arguments passed,
    // Because we we don't care about what it if there isn't

    if (!args) {
      template.open.set(false);
      return;
    } // If they haven't changed a thing, show what we already got


    if (template.commandName.curValue === cmd && template.commandArgs.curValue === args && template.preview.curValue) {
      template.isLoading.set(false);
      template.open.set(true);
      return;
    }

    template.isLoading.set(true);
    template.open.set(true); // Fetch and display them

    template.fetchPreviews(cmd, args);
  };

  template.verifySelection = () => {
    const current = template.find('.popup-item.selected');

    if (!current) {
      const first = template.find('.popup-item');

      if (first) {
        first.className += ' selected sidebar-item__popup-active';
      }
    }
  }; // Typing data


  template.onInputKeyup = event => {
    if (template.open.curValue === true && event.which === keys.ESC) {
      template.open.set(false);
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    if (event.which === keys.ARROW_UP || event.which === keys.ARROW_DOWN) {
      // Arrow up and down are for navigating the choices
      return;
    }

    template.selectionLogic();
  }; // Using the keyboard to navigate the options


  template.onInputKeydown = event => {
    if (!template.open.curValue || template.isLoading.curValue) {
      return;
    }

    if (event.which === keys.ENTER) {
      // || event.which === keys.TAB) { <-- does using tab to select make sense?
      template.enterKeyAction();
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    if (event.which === keys.ARROW_UP) {
      template.up();
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    if (event.which === keys.ARROW_DOWN) {
      template.down();
      event.preventDefault();
      event.stopPropagation();
    }
  };

  template.up = () => {
    const current = template.find('.popup-item.selected');
    const previous = $(current).prev('.popup-item')[0] || template.find('.popup-item:last-child');

    if (previous != null) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
      previous.className += ' selected sidebar-item__popup-active';
    }
  };

  template.down = () => {
    const current = template.find('.popup-item.selected');
    const next = $(current).next('.popup-item')[0] || template.find('.popup-item');

    if (next && next.classList.contains('popup-item')) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
      next.className += ' selected sidebar-item__popup-active';
    }
  };

  template.onFocus = () => {
    template.clickingItem = false;

    if (template.open.curValue) {
      return;
    }

    template.selectionLogic();
  };

  template.onBlur = () => {
    if (template.clickingItem) {
      return;
    }

    return template.open.set(false);
  };
});
Template.messagePopupSlashCommandPreview.onRendered(function _messagePopupSlashCommandPreviewRendered() {
  if (!this.data.getInput) {
    throw Error('Somethign wrong happened.');
  }

  this.inputBox = this.data.getInput();
  $(this.inputBox).on('keyup', this.onInputKeyup.bind(this));
  $(this.inputBox).on('keydown', this.onInputKeydown.bind(this));
  $(this.inputBox).on('focus', this.onFocus.bind(this));
  $(this.inputBox).on('blur', this.onBlur.bind(this));
  const self = this;
  self.autorun(() => {
    setTimeout(self.selectionLogic, 500);
  });
});
Template.messagePopupSlashCommandPreview.onDestroyed(function () {
  $(this.inputBox).off('keyup', this.onInputKeyup);
  $(this.inputBox).off('keydown', this.onInputKeydown);
  $(this.inputBox).off('focus', this.onFocus);
  $(this.inputBox).off('blur', this.onBlur);
});
Template.messagePopupSlashCommandPreview.events({
  'mouseenter .popup-item, mousedown .popup-item, touchstart .popup-item'(e) {
    if (e.currentTarget.className.includes('selected')) {
      return;
    }

    const template = Template.instance();
    const current = template.find('.popup-item.selected');

    if (current) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
    }

    e.currentTarget.className += ' selected sidebar-item__popup-active';
  },

  'mousedown .popup-item, touchstart .popup-item'() {
    const template = Template.instance();
    template.clickingItem = true;
  },

  'mouseup .popup-item, touchend .popup-item'() {
    const template = Template.instance();

    if (template.dragging) {
      template.dragging = false;
      return;
    }

    template.clickingItem = false;
    template.enterKeyAction();
  },

  'touchmove .popup-item'(e) {
    e.stopPropagation();
    const template = Template.instance();
    template.dragging = true;
  }

});
Template.messagePopupSlashCommandPreview.helpers({
  isOpen() {
    return Template.instance().open.get(); // && ((Template.instance().hasData.get() || (Template.instance().data.emptyTemplate != null)) || !Template.instance().parentTemplate(1).subscriptionsReady());
  },

  getArgs() {
    return Template.instance().commandArgs.get();
  },

  isLoading() {
    return Template.instance().isLoading.get();
  },

  isType(actual, expected) {
    return actual === expected;
  },

  preview() {
    return Template.instance().preview.get();
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"message.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/message.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.message.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.message.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/template.message.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("message");
Template["message"] = new Template("Template.message", (function() {
  var view = this;
  return HTML.LI({
    id: function() {
      return [ Spacebars.mustache(view.lookup("templatePrefix")), Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "_id")) ];
    },
    "data-id": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "_id"));
    },
    "data-context": function() {
      return Spacebars.mustache(view.lookup("actionContext"));
    },
    class: function() {
      return [ "message ", Spacebars.mustache(view.lookup("className")), " ", Spacebars.mustache(view.lookup("ignoredClass")), " ", Spacebars.mustache(view.lookup("system")), " ", Spacebars.mustache(view.lookup("t")), " ", Spacebars.mustache(view.lookup("own")), " ", Spacebars.mustache(view.lookup("isTemp")), " ", Spacebars.mustache(view.lookup("chatops")), " ", Spacebars.mustache(view.lookup("collapsed")), " ", Spacebars.mustache(view.lookup("customClass")) ];
    },
    "data-username": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
    },
    "data-tmid": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "tmid"));
    },
    "data-groupable": function() {
      return Spacebars.mustache(view.lookup("isGroupable"));
    },
    "data-date": function() {
      return Spacebars.mustache(view.lookup("date"));
    },
    "data-timestamp": function() {
      return Spacebars.mustache(view.lookup("timestamp"));
    },
    "data-alias": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "alias"));
    }
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("isThreadReply"));
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        parentMessage: Spacebars.call(view.lookup("parentMessage")),
        msg: Spacebars.call(view.lookup("msg")),
        tmid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "tmid")),
        class: Spacebars.call(view.lookup("bodyClass")),
        following: Spacebars.call(Spacebars.dot(view.lookup("msg"), "following"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("messageThread"));
    }), "\n\t\t\t", HTML.DIV({
      class: "thread-replied js-open-thread"
    }, "\n\t\t\t\t", HTML.BUTTON({
      "aria-label": function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
      },
      class: "thumb user-card-message",
      "data-username": function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
      }
    }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        username: Spacebars.call(Spacebars.dot(view.lookup("msg"), "u", "username"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("avatar"));
    }), "\n\t\t\t\t"), "\n\t\t\t\t", HTML.SPAN({
      role: "button",
      class: "js-toggle-thread-reply thread-reply-preview color-primary-font-color"
    }, "\n\t\t\t\t\t", HTML.SPAN({
      class: "message-body--unstyled"
    }, Blaze.View("lookup:threadMessage", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("threadMessage")));
    })), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t" ];
  }), "\n\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("shouldHideBody"));
  }, function() {
    return [ "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "avatar"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("avatarFromUsername"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          "aria-label": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          },
          class: "thumb user-card-message",
          "data-username": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          }
        }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            username: Spacebars.call(view.lookup("avatarFromUsername"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("avatar"));
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          "aria-label": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          },
          class: "thumb user-card-message",
          "data-username": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          }
        }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            url: Spacebars.call(view.lookup("avatarFromMessage"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("avatar"));
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("msg"), "emoji"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          "aria-label": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          },
          class: "thumb user-card-message",
          "data-username": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          }
        }, "\n\t\t\t\t\t\t", HTML.DIV({
          class: "avatar"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:renderEmoji", function() {
          return Spacebars.makeRaw(Spacebars.mustache(view.lookup("renderEmoji"), Spacebars.dot(view.lookup("msg"), "emoji")));
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          "aria-label": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          },
          class: "thumb user-card-message",
          "data-username": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          }
        }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            username: Spacebars.call(Spacebars.dot(view.lookup("msg"), "u", "username"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("avatar"));
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }), "\n\t\t\t", HTML.DIV({
      class: "message-body-wrapper"
    }, "\n\t\t\t\t", HTML.DIV({
      class: "title border-component-color color-info-font-color"
    }, "\n\t\t\t\t\t", HTML.BUTTON({
      type: "button",
      class: "user user-card-message color-primary-font-color",
      "data-username": function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
      },
      tabindex: "1"
    }, "\n\t\t\t\t\t\t", Blaze.View("lookup:getName", function() {
      return Spacebars.mustache(view.lookup("getName"));
    }), Blaze.If(function() {
      return Spacebars.call(view.lookup("showUsername"));
    }, function() {
      return [ " ", HTML.SPAN({
        class: "message-alias border-component-color color-info-font-color"
      }, "@", Blaze.View("lookup:msg.u.username", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
      })) ];
    }), "\n\t\t\t\t\t"), HTML.Raw('\n\t\t\t\t\t<span class="info border-component-color color-info-font-color"></span>\n\t\t\t\t\t'), Blaze.If(function() {
      return Spacebars.call(view.lookup("showRoles"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.call(view.lookup("roleTags")),
          _variable: "role"
        };
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", HTML.SPAN({
          class: "role-tag color-secondary-color border-component-color",
          "data-role": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("role"), "description"));
          }
        }, Blaze.View("lookup:role.description", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("role"), "description"));
        })), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isBot"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "is-bot color-secondary-color border-component-color"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Bot");
      })), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", HTML.TIME({
      class: "time",
      title: function() {
        return [ Spacebars.mustache(view.lookup("date")), " ", Spacebars.mustache(view.lookup("time")) ];
      },
      datetime: function() {
        return [ Spacebars.mustache(view.lookup("date")), " ", Spacebars.mustache(view.lookup("time")) ];
      }
    }, Blaze.View("lookup:time", function() {
      return Spacebars.mustache(view.lookup("time"));
    })), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("showTranslated"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "translated"
      }, "\n\t\t\t\t\t\t\t", HTML.I({
        class: function() {
          return [ "icon-language ", Blaze.If(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("msg"), "autoTranslateFetching"));
          }, function() {
            return "loading";
          }) ];
        },
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Translated");
        }
      }), "\n\t\t\t\t\t\t\t", HTML.SPAN({
        class: "translation-provider"
      }, Blaze.View("lookup:translationProvider", function() {
        return Spacebars.mustache(view.lookup("translationProvider"));
      })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "sentByEmail"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "sent-by-email"
      }, "\n\t\t\t\t\t\t\t", HTML.I({
        class: "icon-mail",
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Message_sent_by_email");
        }
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("edited"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "edited",
        title: function() {
          return [ Spacebars.mustache(view.lookup("_"), "edited"), " ", Spacebars.mustache(view.lookup("_"), "at"), " ", Spacebars.mustache(view.lookup("editTime")), " ", Spacebars.mustache(view.lookup("_"), "by"), " ", Spacebars.mustache(view.lookup("editedBy")) ];
        }
      }, "\n\t\t\t\t\t\t\t", HTML.I({
        class: function() {
          return [ "icon-pencil", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("$neq"), view.lookup("editedBy"), Spacebars.dot(view.lookup("msg"), "u", "username"));
          }, function() {
            return " error-color";
          }) ];
        },
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Edited");
        }
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "pinned"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Message_has_been_pinned");
        },
        class: "pinned"
      }, HTML.Raw('<i class="icon-pin"></i>')), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("showStar"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Message_has_been_starred");
        },
        class: "starred"
      }, HTML.Raw('<i class="icon-star"></i>')), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("following"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", Blaze.Unless(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("msg"), "tcount"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", HTML.SPAN({
          title: function() {
            return Spacebars.mustache(view.lookup("_"), "Following");
          },
          class: "following"
        }, HTML.Raw('<i class="icon-bell"></i>')), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "alert"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.DIV({
        title: function() {
          return Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup("msg"), "alert"));
        },
        class: "message-unread"
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "private"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "private"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Only_you_can_see_this_message");
      })), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("fromSearch"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "user color-info-font-color"
      }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call(view.lookup("roomIcon"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), Blaze.View("lookup:channelName", function() {
        return Spacebars.mustache(view.lookup("channelName"));
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isIgnored"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "toggle-hidden icon-right-dir",
        "data-message": function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "_id"));
        }
      }, " ", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Message_Ignored");
      }), " "), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t"), "\n\t\t\t\t", HTML.DIV({
      class: function() {
        return [ "body ", Spacebars.mustache(view.lookup("bodyClass")) ];
      },
      dir: "auto",
      "data-unread-text": function() {
        return Spacebars.mustache(view.lookup("_"), "Unread_Messages");
      }
    }, "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isSnippet"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.DIV({
        class: "snippet-name"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Snippet_name");
      }), ": ", Blaze.View("lookup:snippetName", function() {
        return Spacebars.mustache(view.lookup("snippetName"));
      })), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "blocks"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.DIV({
        class: "rc-ui-kit"
      }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          blocks: Spacebars.call(Spacebars.dot(view.lookup("msg"), "blocks")),
          rid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "rid")),
          mid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "_id"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("Blocks"));
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("enableMessageParserEarlyAdoption"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            tokens: Spacebars.call(Spacebars.dot(view.lookup("msg"), "md")),
            mentions: Spacebars.call(Spacebars.dot(view.lookup("msg"), "mentions"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("MessageBody"));
        }), "\n\t\t\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:body", function() {
          return Spacebars.makeRaw(Spacebars.mustache(view.lookup("body")));
        }), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "location"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          location: Spacebars.call(Spacebars.dot(view.lookup("msg"), "location"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("messageLocation"));
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("hasOembed"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze.Each(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("msg"), "urls"));
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.View("lookup:injectMessage", function() {
          return Spacebars.mustache(view.lookup("injectMessage"), view.lookup("."), Spacebars.dot(view.lookup(".."), "msg"));
        }), "\n\t\t\t\t\t", Blaze.View("lookup:injectSettings", function() {
          return Spacebars.mustache(view.lookup("injectSettings"), view.lookup("."), Spacebars.dot(view.lookup(".."), "settings"));
        }), "\n\t\t\t\t\t", Blaze.View("lookup:injectIndex", function() {
          return Spacebars.mustache(view.lookup("injectIndex"), view.lookup("."), view.lookup("@index"));
        }), "\n\t\t\t\t\t", Spacebars.include(view.lookupTemplate("oembedBaseWidget")), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }), "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("hasAttachments"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          attachments: Spacebars.call(Spacebars.dot(view.lookup("msg"), "attachments")),
          file: Spacebars.call(Spacebars.dot(view.lookup("msg"), "file"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("reactAttachments"));
      }), "\n\t\t\t" ];
    }), "\n\n\n\t\t\t", Spacebars.With(function() {
      return Spacebars.call(view.lookup("readReceipt"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: function() {
          return [ "read-receipt ", Spacebars.mustache(view.lookup("readByEveryone")) ];
        }
      }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("check")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hideMessageActions"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: "message-actions"
      }, "\n\n\t\t\t\t\t", HTML.DIV({
        class: "message-actions__buttons"
      }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.dataMustache(view.lookup("messageActions"), "message"),
          _variable: "action"
        };
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
          class: "message-actions__button",
          "data-message-action": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("action"), "id"));
          },
          title: function() {
            return Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup("action"), "label"));
          }
        }, "\n\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call("message-actions__button-icon"),
            icon: Spacebars.call(Spacebars.dot(view.lookup("action"), "icon"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
        class: "message-actions__menu",
        "aria-haspopup": "true"
      }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          block: Spacebars.call("message-actions__menu-icon"),
          icon: Spacebars.call("menu")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hideActionLinks"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          mid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "_id")),
          actions: Spacebars.call(view.lookup("actionLinks")),
          runAction: Spacebars.call(Spacebars.dataMustache(Spacebars.dot(view.lookup("actions"), "runAction"), view.lookup("msg")))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("MessageActions"));
      }), "\n\t\t\t" ];
    }), "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hideReactions"));
    }, function() {
      return [ "\n\t\t\t", HTML.UL({
        class: "reactions"
      }, "\n\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.call(view.lookup("reactions")),
          _variable: "reaction"
        };
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.LI(HTML.Attrs({
          "data-emoji": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("reaction"), "emoji"));
          }
        }, function() {
          return Spacebars.attrMustache(view.lookup("markUserReaction"), view.lookup("reaction"));
        }), "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "reaction-emoji"
        }, Blaze.View("lookup:renderEmoji", function() {
          return Spacebars.makeRaw(Spacebars.mustache(view.lookup("renderEmoji"), Spacebars.dot(view.lookup("reaction"), "emoji")));
        })), "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "reaction-count"
        }, Blaze.View("lookup:reaction.count", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("reaction"), "count"));
        })), "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "people",
          style: "font-weight: bold"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:reaction.usernames", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("reaction"), "usernames"));
        }), " ", HTML.SPAN({
          style: "color: #aaa;"
        }, Blaze.View("lookup:reaction.reaction", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("reaction"), "reaction"));
        })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t\t", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("hideAddReaction"));
      }, function() {
        return HTML.Raw('\n\t\t\t\t\t<li class="add-reaction">\n\t\t\t\t\t\t<span class="icon-people-plus"></span>\n\t\t\t\t\t</li>\n\t\t\t\t');
      }), "\n\t\t\t"), "\n\t\t\t" ];
    }), "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "drid"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          count: Spacebars.call(Spacebars.dot(view.lookup("msg"), "dcount")),
          drid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "drid")),
          lm: Spacebars.call(Spacebars.dot(view.lookup("msg"), "dlm")),
          openDiscussion: Spacebars.call(Spacebars.dot(view.lookup("actions"), "openDiscussion"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("DiscussionMetric"));
      }), "\n\t\t\t" ];
    }), "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("$and"), Spacebars.dot(view.lookup("settings"), "showReplyButton"), Spacebars.dot(view.lookup("msg"), "tcount"));
    }, function() {
      return [ "\n\t\t\t    ", Blaze._TemplateWith(function() {
        return {
          counter: Spacebars.call(Spacebars.dot(view.lookup("msg"), "tcount")),
          following: Spacebars.call(view.lookup("following")),
          lm: Spacebars.call(Spacebars.dot(view.lookup("msg"), "tlm")),
          rid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "rid")),
          mid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "_id")),
          unread: Spacebars.call(view.lookup("unread")),
          mention: Spacebars.call(view.lookup("mention")),
          all: Spacebars.call(view.lookup("all")),
          openThread: Spacebars.call(Spacebars.dot(view.lookup("actions"), "openThread"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("ThreadMetric"));
      }), "\n\t\t\t" ];
    }), "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("broadcast"));
    }, function() {
      return [ "\n\t\t\t \t", Blaze._TemplateWith(function() {
        return {
          mid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "_id")),
          username: Spacebars.call(Spacebars.dot(view.lookup("msg"), "u", "username")),
          replyBroadcast: Spacebars.call(Spacebars.dot(view.lookup("actions"), "replyBroadcast"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("BroadCastMetric"));
      }), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageThread.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageThread.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageThread.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageThread.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/template.messageThread.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageThread");
Template["messageThread"] = new Template("Template.messageThread", (function() {
  var view = this;
  return HTML.Q({
    role: "button",
    title: function() {
      return Spacebars.mustache(view.lookup("_"), "Open_thread");
    },
    class: "thread-quote js-open-thread"
  }, "\n\t\t", Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call("thread"),
      block: Spacebars.call("thread-icons")
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), " ", HTML.DIV({
    class: "thread-quote__message "
  }, HTML.SPAN({
    class: "message-body--unstyled"
  }, Blaze.View("lookup:parentMessage", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("parentMessage")));
  }))), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("following"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      role: "button",
      class: "js-unfollow-thread",
      title: function() {
        return Spacebars.mustache(view.lookup("_"), "Following");
      }
    }, "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        icon: Spacebars.call("bell"),
        block: Spacebars.call("thread-icons")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t"), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      role: "button",
      class: "js-follow-thread",
      title: function() {
        return Spacebars.mustache(view.lookup("_"), "Not_following");
      }
    }, "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        icon: Spacebars.call("bell-off"),
        block: Spacebars.call("thread-icons")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t"), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"actionButtons":{"lib":{"applyButtonFilters.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/actionButtons/lib/applyButtonFilters.ts                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  applyAuthFilter: () => applyAuthFilter,
  applyRoomFilter: () => applyRoomFilter,
  applyButtonFilters: () => applyButtonFilters
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let RoomTypeFilter;
module.link("@rocket.chat/apps-engine/definition/ui", {
  RoomTypeFilter(v) {
    RoomTypeFilter = v;
  }

}, 1);
let hasAtLeastOnePermission, hasPermission, hasRole;
module.link("../../../../authorization/client", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  },

  hasPermission(v) {
    hasPermission = v;
  },

  hasRole(v) {
    hasRole = v;
  }

}, 2);
let isDirectMessageRoom, isMultipleDirectMessageRoom, isOmnichannelRoom, isPrivateDiscussion, isPrivateTeamRoom, isPublicDiscussion, isPublicTeamRoom;
module.link("../../../../../definition/IRoom", {
  isDirectMessageRoom(v) {
    isDirectMessageRoom = v;
  },

  isMultipleDirectMessageRoom(v) {
    isMultipleDirectMessageRoom = v;
  },

  isOmnichannelRoom(v) {
    isOmnichannelRoom = v;
  },

  isPrivateDiscussion(v) {
    isPrivateDiscussion = v;
  },

  isPrivateTeamRoom(v) {
    isPrivateTeamRoom = v;
  },

  isPublicDiscussion(v) {
    isPublicDiscussion = v;
  },

  isPublicTeamRoom(v) {
    isPublicTeamRoom = v;
  }

}, 3);

const applyAuthFilter = (button, room) => {
  const {
    hasAllPermissions,
    hasOnePermission,
    hasAllRoles,
    hasOneRole
  } = button.when || {};
  const hasAllPermissionsResult = hasAllPermissions ? hasPermission(hasAllPermissions) : true;
  const hasOnePermissionResult = hasOnePermission ? hasAtLeastOnePermission(hasOnePermission) : true;
  const hasAllRolesResult = hasAllRoles ? hasAllRoles.every(role => hasRole(Meteor.userId(), role, room === null || room === void 0 ? void 0 : room._id)) : true;
  const hasOneRoleResult = hasOneRole ? hasRole(Meteor.userId(), hasOneRole, room === null || room === void 0 ? void 0 : room._id) : true;
  return hasAllPermissionsResult && hasOnePermissionResult && hasAllRolesResult && hasOneRoleResult;
};

const enumToFilter = {
  [RoomTypeFilter.PUBLIC_CHANNEL]: room => room.t === 'c',
  [RoomTypeFilter.PRIVATE_CHANNEL]: room => room.t === 'p',
  [RoomTypeFilter.PUBLIC_TEAM]: isPublicTeamRoom,
  [RoomTypeFilter.PRIVATE_TEAM]: isPrivateTeamRoom,
  [RoomTypeFilter.PUBLIC_DISCUSSION]: isPublicDiscussion,
  [RoomTypeFilter.PRIVATE_DISCUSSION]: isPrivateDiscussion,
  [RoomTypeFilter.DIRECT]: isDirectMessageRoom,
  [RoomTypeFilter.DIRECT_MULTIPLE]: isMultipleDirectMessageRoom,
  [RoomTypeFilter.LIVE_CHAT]: isOmnichannelRoom
};

const applyRoomFilter = (button, room) => {
  const {
    roomTypes
  } = button.when || {};
  return !roomTypes || roomTypes.some(filter => {
    var _enumToFilter$filter;

    return (_enumToFilter$filter = enumToFilter[filter]) === null || _enumToFilter$filter === void 0 ? void 0 : _enumToFilter$filter.call(enumToFilter, room);
  });
};

const applyButtonFilters = (button, room) => {
  return applyAuthFilter(button, room) && (!room || applyRoomFilter(button, room));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"messageAction.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/actionButtons/messageAction.ts                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onAdded: () => onAdded,
  onRemoved: () => onRemoved
});
let Utilities;
module.link("../../../apps/lib/misc/Utilities", {
  Utilities(v) {
    Utilities = v;
  }

}, 0);
let MessageAction, messageArgs;
module.link("../../../ui-utils/client", {
  MessageAction(v) {
    MessageAction = v;
  },

  messageArgs(v) {
    messageArgs = v;
  }

}, 1);
let t;
module.link("../../../utils/client", {
  t(v) {
    t = v;
  }

}, 2);
let triggerActionButtonAction;
module.link("../ActionManager", {
  triggerActionButtonAction(v) {
    triggerActionButtonAction = v;
  }

}, 3);
let applyButtonFilters;
module.link("./lib/applyButtonFilters", {
  applyButtonFilters(v) {
    applyButtonFilters = v;
  }

}, 4);

const getIdForActionButton = _ref => {
  let {
    appId,
    actionId
  } = _ref;
  return "".concat(appId, "/").concat(actionId);
};

const onAdded = button => {
  var _button$when;

  return (// eslint-disable-next-line no-void
    void MessageAction.addButton({
      id: getIdForActionButton(button),
      // icon: button.icon || '',
      label: t(Utilities.getI18nKeyForApp(button.labelI18n, button.appId)),
      context: ((_button$when = button.when) === null || _button$when === void 0 ? void 0 : _button$when.messageActionContext) || ['message', 'message-mobile', 'threads', 'starred'],

      condition(_ref2) {
        let {
          room
        } = _ref2;
        return applyButtonFilters(button, room);
      },

      async action() {
        const {
          msg
        } = messageArgs(this);
        triggerActionButtonAction({
          rid: msg.rid,
          mid: msg._id,
          actionId: button.actionId,
          appId: button.appId,
          payload: {
            context: button.context
          }
        });
      }

    })
  );
};

const onRemoved = button => MessageAction.removeButton(getIdForActionButton(button));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBox.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/actionButtons/messageBox.ts                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onAdded: () => onAdded,
  onRemoved: () => onRemoved
});
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 0);
let Rooms;
module.link("../../../models/client", {
  Rooms(v) {
    Rooms = v;
  }

}, 1);
let messageBox;
module.link("../../../ui-utils/client", {
  messageBox(v) {
    messageBox = v;
  }

}, 2);
let applyButtonFilters;
module.link("./lib/applyButtonFilters", {
  applyButtonFilters(v) {
    applyButtonFilters = v;
  }

}, 3);
let triggerActionButtonAction;
module.link("../ActionManager", {
  triggerActionButtonAction(v) {
    triggerActionButtonAction = v;
  }

}, 4);
let t;
module.link("../../../utils/client", {
  t(v) {
    t = v;
  }

}, 5);
let Utilities;
module.link("../../../apps/lib/misc/Utilities", {
  Utilities(v) {
    Utilities = v;
  }

}, 6);

const getIdForActionButton = _ref => {
  let {
    appId,
    actionId
  } = _ref;
  return "".concat(appId, "/").concat(actionId);
};

const APP_GROUP = 'Create_new';

const onAdded = button => // eslint-disable-next-line no-void
void messageBox.actions.add(APP_GROUP, t(Utilities.getI18nKeyForApp(button.labelI18n, button.appId)), {
  id: getIdForActionButton(button),

  // icon: button.icon || '',
  condition() {
    return applyButtonFilters(button, Rooms.findOne(Session.get('openedRoom')));
  },

  action() {
    triggerActionButtonAction({
      rid: Session.get('openedRoom'),
      actionId: button.actionId,
      appId: button.appId,
      payload: {
        context: button.context
      }
    });
  }

});

const onRemoved = button => // eslint-disable-next-line no-void
void messageBox.actions.remove(APP_GROUP, new RegExp(getIdForActionButton(button)));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabbar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/actionButtons/tabbar.ts                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onAdded: () => onAdded,
  onRemoved: () => onRemoved
});
let addAction, deleteAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  },

  deleteAction(v) {
    deleteAction = v;
  }

}, 0);
let Utilities;
module.link("../../../apps/lib/misc/Utilities", {
  Utilities(v) {
    Utilities = v;
  }

}, 1);
let t;
module.link("../../../utils/client", {
  t(v) {
    t = v;
  }

}, 2);
let triggerActionButtonAction;
module.link("../ActionManager", {
  triggerActionButtonAction(v) {
    triggerActionButtonAction = v;
  }

}, 3);
let applyButtonFilters;
module.link("./lib/applyButtonFilters", {
  applyButtonFilters(v) {
    applyButtonFilters = v;
  }

}, 4);

const getIdForActionButton = _ref => {
  let {
    appId,
    actionId
  } = _ref;
  return "".concat(appId, "/").concat(actionId);
};

const onAdded = button => // eslint-disable-next-line no-void
void addAction(getIdForActionButton(button), _ref2 => {
  let {
    room
  } = _ref2;
  return applyButtonFilters(button, room) ? {
    id: button.actionId,
    icon: '',
    order: 300,
    title: t(Utilities.getI18nKeyForApp(button.labelI18n, button.appId)),
    // Filters were applied in the applyButtonFilters function
    // if the code made it this far, the button should be shown
    groups: ['group', 'channel', 'live', 'team', 'direct', 'direct_multiple'],
    action: () => triggerActionButtonAction({
      rid: room._id,
      actionId: button.actionId,
      appId: button.appId,
      payload: {
        context: button.context
      }
    })
  } : null;
});

const onRemoved = button => deleteAction(getIdForActionButton(button));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ActionButtonSyncer.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/ActionButtonSyncer.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  addButton: () => addButton,
  removeButton: () => removeButton,
  loadButtons: () => loadButtons
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let UIActionButtonContext;
module.link("@rocket.chat/apps-engine/definition/ui", {
  UIActionButtonContext(v) {
    UIActionButtonContext = v;
  }

}, 1);
let APIClient;
module.link("../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 2);
let TabBar;
module.link("./actionButtons/tabbar", {
  "*"(v) {
    TabBar = v;
  }

}, 3);
let MessageAction;
module.link("./actionButtons/messageAction", {
  "*"(v) {
    MessageAction = v;
  }

}, 4);
let MessageBox;
module.link("./actionButtons/messageBox", {
  "*"(v) {
    MessageBox = v;
  }

}, 5);
let registeredButtons = [];

const addButton = button => {
  switch (button.context) {
    case UIActionButtonContext.MESSAGE_ACTION:
      MessageAction.onAdded(button);
      break;

    case UIActionButtonContext.ROOM_ACTION:
      TabBar.onAdded(button);
      break;

    case UIActionButtonContext.MESSAGE_BOX_ACTION:
      MessageBox.onAdded(button);
      break;
  }

  registeredButtons.push(Object.freeze(button));
};

const removeButton = button => {
  switch (button.context) {
    case UIActionButtonContext.MESSAGE_ACTION:
      MessageAction.onRemoved(button);
      break;

    case UIActionButtonContext.ROOM_ACTION:
      TabBar.onRemoved(button);
      break;

    case UIActionButtonContext.MESSAGE_BOX_ACTION:
      MessageBox.onRemoved(button);
      break;
  }
};

const loadButtons = () => APIClient.get('apps/actionButtons').then(value => {
  registeredButtons.forEach(button => removeButton(button));
  registeredButtons = [];
  value.map(addButton);
});

Meteor.startup(() => loadButtons());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ActionManager.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/ActionManager.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["triggerId"],
      _excluded2 = ["type", "actionId", "appId", "rid", "mid", "viewId", "container"],
      _excluded3 = ["type"],
      _excluded4 = ["viewId"],
      _excluded5 = ["view"],
      _excluded6 = ["type"];

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
module.export({
  on: () => on,
  off: () => off,
  generateTriggerId: () => generateTriggerId,
  triggerAction: () => triggerAction,
  triggerBlockAction: () => triggerBlockAction,
  triggerActionButtonAction: () => triggerActionButtonAction,
  triggerSubmitView: () => triggerSubmitView,
  triggerCancel: () => triggerCancel,
  getUserInteractionPayloadByViewId: () => getUserInteractionPayloadByViewId
});
let UIKitIncomingInteractionType;
module.link("@rocket.chat/apps-engine/definition/uikit", {
  UIKitIncomingInteractionType(v) {
    UIKitIncomingInteractionType = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 2);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 3);
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 4);
let Notifications;
module.link("../../notifications/client/lib/Notifications", {
  default(v) {
    Notifications = v;
  }

}, 5);
let CachedCollectionManager;
module.link("../../ui-cached-collection", {
  CachedCollectionManager(v) {
    CachedCollectionManager = v;
  }

}, 6);
let modal;
module.link("../../ui-utils/client/lib/modal", {
  modal(v) {
    modal = v;
  }

}, 7);
let APIClient;
module.link("../../utils", {
  APIClient(v) {
    APIClient = v;
  }

}, 8);
let UIKitInteractionTypes;
module.link("../../../definition/UIKit", {
  UIKitInteractionTypes(v) {
    UIKitInteractionTypes = v;
  }

}, 9);
let banners;
module.link("../../../client/lib/banners", {
  "*"(v) {
    banners = v;
  }

}, 10);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 11);
let t;
module.link("../../utils/client", {
  t(v) {
    t = v;
  }

}, 12);
const events = new Emitter();

const on = function () {
  events.on(...arguments);
};

const off = function () {
  events.off(...arguments);
};

const TRIGGER_TIMEOUT = 5000;
const TRIGGER_TIMEOUT_ERROR = 'TRIGGER_TIMEOUT_ERROR';
const triggersId = new Map();
const instances = new Map();

const invalidateTriggerId = id => {
  const appId = triggersId.get(id);
  triggersId.delete(id);
  return appId;
};

const generateTriggerId = appId => {
  const triggerId = Random.id();
  triggersId.set(triggerId, appId);
  setTimeout(invalidateTriggerId, TRIGGER_TIMEOUT, triggerId);
  return triggerId;
};

const handlePayloadUserInteraction = (type, _ref) => {
  let {
    /* appId,*/
    triggerId
  } = _ref,
      data = _objectWithoutProperties(_ref, _excluded);

  if (!triggersId.has(triggerId)) {
    return;
  }

  const appId = invalidateTriggerId(triggerId);

  if (!appId) {
    return;
  }

  const {
    view
  } = data;
  let {
    viewId
  } = data;

  if (view && view.id) {
    viewId = view.id;
  }

  if (!viewId) {
    return;
  }

  if ([UIKitInteractionTypes.ERRORS].includes(type)) {
    events.emit(viewId, _objectSpread({
      type,
      triggerId,
      viewId,
      appId
    }, data));
    return UIKitInteractionTypes.ERRORS;
  }

  if ([UIKitInteractionTypes.BANNER_UPDATE, UIKitInteractionTypes.MODAL_UPDATE, UIKitInteractionTypes.CONTEXTUAL_BAR_UPDATE].includes(type)) {
    events.emit(viewId, _objectSpread({
      type,
      triggerId,
      viewId,
      appId
    }, data));
    return type;
  }

  if ([UIKitInteractionTypes.MODAL_OPEN].includes(type)) {
    const instance = modal.push({
      template: 'ModalBlock',
      modifier: 'uikit',
      closeOnEscape: false,
      data: _objectSpread({
        triggerId,
        viewId,
        appId
      }, data)
    });
    instances.set(viewId, {
      close() {
        instance.close();
        instances.delete(viewId);
      }

    });
    return UIKitInteractionTypes.MODAL_OPEN;
  }

  if ([UIKitInteractionTypes.CONTEXTUAL_BAR_OPEN].includes(type)) {
    instances.set(viewId, {
      payload: _objectSpread({
        type,
        triggerId,
        appId,
        viewId
      }, data),

      close() {
        instances.delete(viewId);
      }

    });
    FlowRouter.setParams({
      tab: 'app',
      context: viewId
    });
    return UIKitInteractionTypes.CONTEXTUAL_BAR_OPEN;
  }

  if ([UIKitInteractionTypes.BANNER_OPEN].includes(type)) {
    banners.open(data);
    instances.set(viewId, {
      close() {
        banners.closeById(viewId);
      }

    });
    return UIKitInteractionTypes.BANNER_OPEN;
  }

  if ([UIKitIncomingInteractionType.BANNER_CLOSE].includes(type)) {
    const instance = instances.get(viewId);

    if (instance) {
      instance.close();
    }

    return UIKitIncomingInteractionType.BANNER_CLOSE;
  }

  if ([UIKitIncomingInteractionType.CONTEXTUAL_BAR_CLOSE].includes(type)) {
    const instance = instances.get(viewId);

    if (instance) {
      instance.close();
    }

    return UIKitIncomingInteractionType.CONTEXTUAL_BAR_CLOSE;
  }

  return UIKitInteractionTypes.MODAL_ClOSE;
};

const triggerAction = async _ref2 => {
  let {
    type,
    actionId,
    appId,
    rid,
    mid,
    viewId,
    container
  } = _ref2,
      rest = _objectWithoutProperties(_ref2, _excluded2);

  return new Promise(async (resolve, reject) => {
    const triggerId = generateTriggerId(appId);
    const payload = rest.payload || rest;
    setTimeout(reject, TRIGGER_TIMEOUT, [TRIGGER_TIMEOUT_ERROR, {
      triggerId,
      appId
    }]);

    const _await$APIClient$post = await APIClient.post("apps/ui.interaction/".concat(appId), {
      type,
      actionId,
      payload,
      container,
      mid,
      rid,
      triggerId,
      viewId
    }),
          {
      type: interactionType
    } = _await$APIClient$post,
          data = _objectWithoutProperties(_await$APIClient$post, _excluded3);

    return resolve(handlePayloadUserInteraction(interactionType, data));
  });
};

const triggerBlockAction = options => triggerAction(_objectSpread({
  type: UIKitIncomingInteractionType.BLOCK
}, options));

const triggerActionButtonAction = options => triggerAction(_objectSpread({
  type: UIKitIncomingInteractionType.ACTION_BUTTON
}, options)).catch(async reason => {
  if (Array.isArray(reason) && reason[0] === TRIGGER_TIMEOUT_ERROR) {
    dispatchToastMessage({
      type: 'error',
      message: t('UIKit_Interaction_Timeout')
    });
  }
});

const triggerSubmitView = async _ref3 => {
  let {
    viewId
  } = _ref3,
      options = _objectWithoutProperties(_ref3, _excluded4);

  const close = () => {
    const instance = instances.get(viewId);

    if (instance) {
      instance.close();
    }
  };

  try {
    const result = await triggerAction(_objectSpread({
      type: UIKitIncomingInteractionType.VIEW_SUBMIT,
      viewId
    }, options));

    if (!result || UIKitInteractionTypes.MODAL_CLOSE === result) {
      close();
    }
  } catch (_unused) {
    close();
  }
};

const triggerCancel = async _ref4 => {
  let {
    view
  } = _ref4,
      options = _objectWithoutProperties(_ref4, _excluded5);

  const instance = instances.get(view.id);

  try {
    await triggerAction(_objectSpread({
      type: UIKitIncomingInteractionType.VIEW_CLOSED,
      view
    }, options));
  } finally {
    if (instance) {
      instance.close();
    }
  }
};

const getUserInteractionPayloadByViewId = viewId => {
  if (!viewId) {
    throw new Error('No viewId provided when checking for `user interaction payload`');
  }

  const instance = instances.get(viewId);

  if (!instance) {
    return {};
  }

  return instance.payload;
};

Meteor.startup(() => CachedCollectionManager.onLogin(() => Notifications.onUser('uiInteraction', _ref5 => {
  let {
    type
  } = _ref5,
      data = _objectWithoutProperties(_ref5, _excluded6);

  handlePayloadUserInteraction(type, data);
})));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./message");
module.link("./messageBox/messageBox");
module.link("./popup/customMessagePopups");
module.link("./popup/messagePopup");
module.link("./popup/messagePopupChannel");
module.link("./popup/messagePopupConfig");
module.link("./popup/messagePopupEmoji");
module.link("./popup/messagePopupSlashCommandPreview");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"message.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/message.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let dompurify;
module.link("dompurify", {
  default(v) {
    dompurify = v;
  }

}, 1);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 4);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 5);
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 6);
let timeAgo;
module.link("../../../client/lib/utils/timeAgo", {
  timeAgo(v) {
    timeAgo = v;
  }

}, 7);
let formatDateAndTime;
module.link("../../../client/lib/utils/formatDateAndTime", {
  formatDateAndTime(v) {
    formatDateAndTime = v;
  }

}, 8);
let normalizeThreadTitle;
module.link("../../threads/client/lib/normalizeThreadTitle", {
  normalizeThreadTitle(v) {
    normalizeThreadTitle = v;
  }

}, 9);
let MessageTypes, MessageAction;
module.link("../../ui-utils/client", {
  MessageTypes(v) {
    MessageTypes = v;
  },

  MessageAction(v) {
    MessageAction = v;
  }

}, 10);
let RoomRoles, UserRoles, Roles;
module.link("../../models/client", {
  RoomRoles(v) {
    RoomRoles = v;
  },

  UserRoles(v) {
    UserRoles = v;
  },

  Roles(v) {
    Roles = v;
  }

}, 11);
let Markdown;
module.link("../../markdown/client", {
  Markdown(v) {
    Markdown = v;
  }

}, 12);
let t, roomTypes;
module.link("../../utils", {
  t(v) {
    t = v;
  },

  roomTypes(v) {
    roomTypes = v;
  }

}, 13);
let AutoTranslate;
module.link("../../autotranslate/client", {
  AutoTranslate(v) {
    AutoTranslate = v;
  }

}, 14);
let renderMentions;
module.link("../../mentions/client/client", {
  renderMentions(v) {
    renderMentions = v;
  }

}, 15);
let renderMessageBody;
module.link("../../../client/lib/utils/renderMessageBody", {
  renderMessageBody(v) {
    renderMessageBody = v;
  }

}, 16);
let settings;
module.link("../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 17);
let formatTime;
module.link("../../../client/lib/utils/formatTime", {
  formatTime(v) {
    formatTime = v;
  }

}, 18);
let formatDate;
module.link("../../../client/lib/utils/formatDate", {
  formatDate(v) {
    formatDate = v;
  }

}, 19);
module.link("./messageThread");
module.link("./message.html");

const renderBody = (msg, settings) => {
  const searchedText = msg.searchedText ? msg.searchedText : '';
  const isSystemMessage = MessageTypes.isSystemMessage(msg);
  const messageType = MessageTypes.getType(msg) || {};

  if (messageType.render) {
    msg = messageType.render(msg);
  } else if (messageType.template) {// render template
  } else if (messageType.message) {
    msg.msg = escapeHTML(msg.msg);
    msg = TAPi18n.__(messageType.message, _objectSpread({}, typeof messageType.data === 'function' && messageType.data(msg)));
    msg = dompurify.sanitize(msg);
  } else if (msg.u && msg.u.username === settings.Chatops_Username) {
    msg.html = msg.msg;
    msg = renderMentions(msg);
    msg = msg.html;
  } else {
    msg = renderMessageBody(msg);
  }

  if (isSystemMessage) {
    msg.html = Markdown.parse(msg.html);
  }

  if (searchedText) {
    msg = msg.replace(new RegExp(searchedText, 'gi'), str => "<mark>".concat(str, "</mark>"));
  }

  return msg;
};

Template.message.helpers({
  enableMessageParserEarlyAdoption() {
    const {
      settings: {
        enableMessageParserEarlyAdoption
      },
      msg
    } = this;
    return enableMessageParserEarlyAdoption && msg.md;
  },

  unread() {
    var _subscription$tunread;

    const {
      msg,
      subscription
    } = this;
    return subscription === null || subscription === void 0 ? void 0 : (_subscription$tunread = subscription.tunread) === null || _subscription$tunread === void 0 ? void 0 : _subscription$tunread.includes(msg._id);
  },

  mention() {
    var _subscription$tunread2;

    const {
      msg,
      subscription
    } = this;
    return subscription === null || subscription === void 0 ? void 0 : (_subscription$tunread2 = subscription.tunreadUser) === null || _subscription$tunread2 === void 0 ? void 0 : _subscription$tunread2.includes(msg._id);
  },

  all() {
    var _subscription$tunread3;

    const {
      msg,
      subscription
    } = this;
    return subscription === null || subscription === void 0 ? void 0 : (_subscription$tunread3 = subscription.tunreadGroup) === null || _subscription$tunread3 === void 0 ? void 0 : _subscription$tunread3.includes(msg._id);
  },

  following() {
    const {
      msg,
      u
    } = this;
    return msg.replies && msg.replies.indexOf(u._id) > -1;
  },

  body() {
    const {
      msg,
      settings
    } = this;
    return Tracker.nonreactive(() => renderBody(msg, settings));
  },

  i18nReplyCounter() {
    const {
      msg
    } = this;

    if (msg.tcount === 1) {
      return 'reply_counter';
    }

    return 'reply_counter_plural';
  },

  i18nDiscussionCounter() {
    const {
      msg
    } = this;
    return "<span class='reply-counter'>".concat(msg.dcount, "</span>");
  },

  formatDateAndTime,

  encodeURI(text) {
    return encodeURI(text);
  },

  broadcast() {
    const {
      msg,
      room = {},
      u
    } = this;
    return !msg.private && !msg.t && msg.u._id !== u._id && room && room.broadcast;
  },

  isIgnored() {
    const {
      ignored,
      msg
    } = this;
    const isIgnored = typeof ignored !== 'undefined' ? ignored : msg.ignored;
    return isIgnored;
  },

  ignoredClass() {
    const {
      ignored,
      msg
    } = this;
    const isIgnored = typeof ignored !== 'undefined' ? ignored : msg.ignored;
    return isIgnored ? 'message--ignored' : '';
  },

  isDecrypting() {
    const {
      msg
    } = this;
    return msg.e2e === 'pending';
  },

  isBot() {
    const {
      msg
    } = this;
    return msg.bot && 'bot';
  },

  hasAttachments() {
    var _msg$attachments;

    const {
      msg
    } = this;
    return (_msg$attachments = msg.attachments) === null || _msg$attachments === void 0 ? void 0 : _msg$attachments.length;
  },

  roleTags() {
    const {
      msg,
      hideRoles,
      settings
    } = this;

    if (settings.hideRoles || hideRoles) {
      return [];
    }

    if (!msg.u || !msg.u._id) {
      return [];
    }

    const userRoles = UserRoles.findOne(msg.u._id);
    const roomRoles = RoomRoles.findOne({
      'u._id': msg.u._id,
      'rid': msg.rid
    });
    const roles = [...(userRoles && userRoles.roles || []), ...(roomRoles && roomRoles.roles || [])];
    return Roles.find({
      _id: {
        $in: roles
      },
      description: {
        $exists: 1,
        $ne: ''
      }
    }, {
      fields: {
        description: 1
      }
    });
  },

  isGroupable() {
    const {
      msg,
      room = {},
      settings,
      groupable
    } = this;

    if (groupable === false || settings.allowGroup === false || room.broadcast || msg.groupable === false || MessageTypes.isSystemMessage(msg) && !msg.tmid) {
      return 'false';
    }
  },

  avatarFromUsername() {
    const {
      msg
    } = this;

    if (msg.avatar != null && msg.avatar[0] === '@') {
      return msg.avatar.replace(/^@/, '');
    }
  },

  avatarFromMessage() {
    const {
      msg
    } = this;

    if (msg && msg.avatar) {
      return encodeURI(msg.avatar);
    }

    return '';
  },

  getName() {
    const {
      msg,
      settings
    } = this;

    if (msg.alias) {
      return msg.alias;
    }

    if (!msg.u) {
      return '';
    }

    return settings.UI_Use_Real_Name && msg.u.name || msg.u.username;
  },

  showUsername() {
    const {
      msg,
      settings
    } = this;
    return msg.alias || settings.UI_Use_Real_Name && msg.u && msg.u.name;
  },

  own() {
    const {
      msg,
      u = {}
    } = this;

    if (msg.u && msg.u._id === u._id) {
      return 'own';
    }
  },

  t() {
    const {
      msg
    } = this;
    return msg.t;
  },

  timestamp() {
    const {
      msg
    } = this;
    return +msg.ts;
  },

  chatops() {
    const {
      msg,
      settings
    } = this;

    if (msg.u && msg.u.username === settings.Chatops_Username) {
      return 'chatops-message';
    }
  },

  time() {
    const {
      msg,
      timeAgo: useTimeAgo
    } = this;
    return useTimeAgo ? timeAgo(msg.ts) : formatTime(msg.ts);
  },

  date() {
    const {
      msg
    } = this;
    return formatDate(msg.ts);
  },

  isTemp() {
    const {
      msg
    } = this;

    if (msg.temp === true) {
      return 'temp';
    }
  },

  threadMessage() {
    const {
      msg
    } = this;
    return normalizeThreadTitle(msg);
  },

  bodyClass() {
    const {
      msg
    } = this;
    return MessageTypes.isSystemMessage(msg) ? 'color-info-font-color' : 'color-primary-font-color';
  },

  system(returnClass) {
    const {
      msg
    } = this;

    if (MessageTypes.isSystemMessage(msg)) {
      if (returnClass) {
        return 'color-info-font-color';
      }

      return 'system';
    }
  },

  showTranslated() {
    const {
      msg,
      subscription,
      settings,
      u
    } = this;

    if (settings.AutoTranslate_Enabled && msg.u && msg.u._id !== u._id && !MessageTypes.isSystemMessage(msg)) {
      const autoTranslate = subscription && subscription.autoTranslate;
      return msg.autoTranslateFetching || !!autoTranslate !== !!msg.autoTranslateShowInverse && msg.translations && msg.translations[settings.translateLanguage];
    }
  },

  translationProvider() {
    var _AutoTranslate$provid;

    const instance = Template.instance();
    const {
      translationProvider
    } = instance.data.msg;
    return translationProvider && ((_AutoTranslate$provid = AutoTranslate.providersMetadata[translationProvider]) === null || _AutoTranslate$provid === void 0 ? void 0 : _AutoTranslate$provid.displayName);
  },

  edited() {
    const {
      msg
    } = this;
    return msg.editedAt && !MessageTypes.isSystemMessage(msg);
  },

  editTime() {
    const {
      msg
    } = this;
    return msg.editedAt ? formatDateAndTime(msg.editedAt) : '';
  },

  editedBy() {
    const {
      msg
    } = this;

    if (!msg.editedAt) {
      return '';
    } // try to return the username of the editor,
    // otherwise a special "?" character that will be
    // rendered as a special avatar


    return msg.editedBy && msg.editedBy.username || '?';
  },

  label() {
    const {
      msg
    } = this;

    if (msg.i18nLabel) {
      return t(msg.i18nLabel);
    }

    if (msg.label) {
      return msg.label;
    }
  },

  hasOembed() {
    const {
      msg,
      settings
    } = this; // there is no URLs, there is no template to show the oembed (oembed package removed) or oembed is not enable

    if (!(msg.urls && msg.urls.length > 0) || !Template.oembedBaseWidget || !settings.API_Embed) {
      return false;
    } // check if oembed is disabled for message's sender


    if ((settings.API_EmbedDisabledFor || '').split(',').map(username => username.trim()).includes(msg.u && msg.u.username)) {
      return false;
    }

    return true;
  },

  reactions() {
    const {
      msg: {
        reactions = {}
      },
      u: {
        username: myUsername,
        name: myName
      }
    } = this;
    return Object.entries(reactions).map(_ref => {
      let [emoji, reaction] = _ref;
      const myDisplayName = reaction.names ? myName : "@".concat(myUsername);
      const displayNames = reaction.names || reaction.usernames.map(username => "@".concat(username));
      const selectedDisplayNames = displayNames.slice(0, 15).filter(displayName => displayName !== myDisplayName);

      if (displayNames.some(displayName => displayName === myDisplayName)) {
        selectedDisplayNames.unshift(t('You'));
      }

      let usernames;

      if (displayNames.length > 15) {
        usernames = "".concat(selectedDisplayNames.join(', '), " ").concat(t('And_more', {
          length: displayNames.length - 15
        }).toLowerCase());
      } else if (displayNames.length > 1) {
        usernames = "".concat(selectedDisplayNames.slice(0, -1).join(', '), " ").concat(t('and'), " ").concat(selectedDisplayNames[selectedDisplayNames.length - 1]);
      } else {
        usernames = selectedDisplayNames[0];
      }

      return {
        emoji,
        count: displayNames.length,
        usernames,
        reaction: " ".concat(t('Reacted_with').toLowerCase(), " ").concat(emoji),
        userReacted: displayNames.indexOf(myDisplayName) > -1
      };
    });
  },

  markUserReaction(reaction) {
    if (reaction.userReacted) {
      return {
        class: 'selected'
      };
    }
  },

  hideReactions() {
    const {
      msg
    } = this;

    if (_.isEmpty(msg.reactions)) {
      return 'hidden';
    }
  },

  hideAddReaction() {
    const {
      room,
      u,
      msg,
      subscription
    } = this;

    if (!room) {
      return true;
    }

    if (!subscription) {
      return true;
    }

    if (msg.private) {
      return true;
    }

    if (roomTypes.readOnly(room._id, u._id) && !room.reactWhenReadOnly) {
      return true;
    }
  },

  hideMessageActions() {
    const {
      msg
    } = this;
    return msg.private || MessageTypes.isSystemMessage(msg);
  },

  actionLinks() {
    const {
      msg
    } = this; // remove 'method_id' and 'params' properties

    return _.map(msg.actionLinks, function (actionLink, key) {
      return _.extend({
        id: key
      }, _.omit(actionLink, 'method_id', 'params'));
    });
  },

  hideActionLinks() {
    const {
      msg
    } = this;

    if (_.isEmpty(msg.actionLinks)) {
      return 'hidden';
    }
  },

  injectMessage(data, _ref2) {
    let {
      _id,
      rid
    } = _ref2;
    data.msg = {
      _id,
      rid
    };
  },

  injectIndex(data, index) {
    data.index = index;
  },

  injectSettings(data, settings) {
    data.settings = settings;
  },

  className() {
    return this.msg.className;
  },

  channelName() {
    const {
      subscription
    } = this; // const subscription = Subscriptions.findOne({ rid: this.rid });

    return subscription && subscription.name;
  },

  roomIcon() {
    const {
      room
    } = this;

    if (room && room.t === 'd') {
      return 'at';
    }

    return roomTypes.getIcon(room);
  },

  customClass() {
    const {
      customClass,
      msg
    } = this;
    return customClass || msg.customClass;
  },

  fromSearch() {
    const {
      customClass,
      msg
    } = this;
    return [msg.customClass, customClass].includes('search');
  },

  actionContext() {
    const {
      msg
    } = this;
    return msg.actionContext;
  },

  messageActions(group) {
    const {
      msg,
      context: ctx
    } = this;
    let messageGroup = group;
    let context = ctx || msg.actionContext;

    if (!group) {
      messageGroup = 'message';
    }

    if (!context) {
      context = 'message';
    }

    return MessageAction.getButtons(this, context, messageGroup);
  },

  isSnippet() {
    const {
      msg
    } = this;
    return msg.actionContext === 'snippeted';
  },

  isThreadReply() {
    const {
      groupable,
      msg: {
        tmid,
        t,
        groupable: _groupable
      },
      settings: {
        showreply
      }
    } = this;
    return !(groupable === true || _groupable === true) && !!(tmid && showreply && (!t || t === 'e2e'));
  },

  shouldHideBody() {
    const {
      msg: {
        tmid,
        actionContext
      },
      settings: {
        showreply
      },
      context
    } = this;
    return showreply && tmid && !(actionContext || context);
  },

  collapsed() {
    const {
      msg: {
        tmid,
        collapsed
      },
      settings: {
        showreply
      },
      shouldCollapseReplies
    } = this;
    const isCollapsedThreadReply = shouldCollapseReplies && tmid && showreply && collapsed !== false;

    if (isCollapsedThreadReply) {
      return 'collapsed';
    }
  },

  collapseSwitchClass() {
    const {
      msg: {
        collapsed = true
      }
    } = this;
    return collapsed ? 'icon-right-dir' : 'icon-down-dir';
  },

  parentMessage() {
    const {
      msg: {
        threadMsg
      }
    } = this;
    return threadMsg;
  },

  showStar() {
    const {
      msg
    } = this;
    return msg.starred && msg.starred.length > 0 && msg.starred.find(star => star._id === Meteor.userId()) && !(msg.actionContext === 'starred' || this.context === 'starred');
  },

  readReceipt() {
    if (!settings.get('Message_Read_Receipt_Enabled')) {
      return;
    }

    return {
      readByEveryone: !this.msg.unread && 'read' || 'color-component-color'
    };
  }

});

const hasTempClass = node => node.classList.contains('temp');

const getPreviousSentMessage = currentNode => {
  if (hasTempClass(currentNode)) {
    return currentNode.previousElementSibling;
  }

  if (currentNode.previousElementSibling != null) {
    let previousValid = currentNode.previousElementSibling;

    while (previousValid != null && (hasTempClass(previousValid) || !previousValid.classList.contains('message'))) {
      previousValid = previousValid.previousElementSibling;
    }

    return previousValid;
  }
};

const isNewDay = (currentNode, previousNode, forceDate, showDateSeparator) => {
  if (!showDateSeparator) {
    return false;
  }

  if (forceDate || !previousNode) {
    return true;
  }

  const {
    dataset: currentDataset
  } = currentNode;
  const {
    dataset: previousDataset
  } = previousNode;
  const previousMessageDate = new Date(parseInt(previousDataset.timestamp));
  const currentMessageDate = new Date(parseInt(currentDataset.timestamp));

  if (previousMessageDate.toDateString() !== currentMessageDate.toDateString()) {
    return true;
  }

  return false;
};

const isSequential = (currentNode, previousNode, forceDate, period, showDateSeparator, shouldCollapseReplies) => {
  if (!previousNode) {
    return false;
  }

  if (showDateSeparator && forceDate) {
    return false;
  }

  const {
    dataset: currentDataset
  } = currentNode;
  const {
    dataset: previousDataset
  } = previousNode;
  const previousMessageDate = new Date(parseInt(previousDataset.timestamp));
  const currentMessageDate = new Date(parseInt(currentDataset.timestamp));

  if (showDateSeparator && previousMessageDate.toDateString() !== currentMessageDate.toDateString()) {
    return false;
  }

  if (!shouldCollapseReplies && currentDataset.tmid) {
    return previousDataset.id === currentDataset.tmid || previousDataset.tmid === currentDataset.tmid;
  }

  if (previousDataset.tmid && !currentDataset.tmid) {
    return false;
  }

  if ([previousDataset.groupable, currentDataset.groupable].includes('false')) {
    return false;
  }

  if (previousDataset.username !== currentDataset.username) {
    return false;
  }

  if (previousDataset.alias !== currentDataset.alias) {
    return false;
  }

  if (parseInt(currentDataset.timestamp) - parseInt(previousDataset.timestamp) <= period) {
    return true;
  }

  return false;
};

const processSequentials = _ref3 => {
  let {
    index,
    currentNode,
    settings,
    forceDate,
    showDateSeparator = true,
    groupable,
    shouldCollapseReplies
  } = _ref3;

  if (!showDateSeparator && !groupable) {
    return;
  } // const currentDataset = currentNode.dataset;


  const previousNode = (index === undefined || index > 0) && getPreviousSentMessage(currentNode);
  const nextNode = currentNode.nextElementSibling;

  if (!previousNode) {
    setTimeout(() => {
      currentNode.dispatchEvent(new CustomEvent('MessageGroup', {
        bubbles: true
      }));
    }, 100);
  }

  if (isSequential(currentNode, previousNode, forceDate, settings.Message_GroupingPeriod, showDateSeparator, shouldCollapseReplies)) {
    currentNode.classList.add('sequential');
  } else {
    currentNode.classList.remove('sequential');
  }

  if (isNewDay(currentNode, previousNode, forceDate, showDateSeparator)) {
    currentNode.classList.add('new-day');
  } else {
    currentNode.classList.remove('new-day');
  }

  if (nextNode && nextNode.dataset) {
    if (isSequential(nextNode, currentNode, forceDate, settings.Message_GroupingPeriod, showDateSeparator, shouldCollapseReplies)) {
      nextNode.classList.add('sequential');
    } else {
      nextNode.classList.remove('sequential');
    }

    if (isNewDay(nextNode, currentNode, forceDate, showDateSeparator)) {
      nextNode.classList.add('new-day');
    } else {
      nextNode.classList.remove('new-day');
    }
  }
};

Template.message.onRendered(function () {
  const currentNode = this.firstNode;
  this.autorun(() => processSequentials(_objectSpread({
    currentNode
  }, Template.currentData())));
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageThread.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageThread.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
let callWithErrorHandling;
module.link("../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 3);
let Messages;
module.link("../../models/client", {
  Messages(v) {
    Messages = v;
  }

}, 4);
let normalizeThreadTitle;
module.link("../../threads/client/lib/normalizeThreadTitle", {
  normalizeThreadTitle(v) {
    normalizeThreadTitle = v;
  }

}, 5);
module.link("./messageThread.html");

const findParentMessage = (() => {
  const waiting = [];
  let resolve;
  let pending = new Promise(r => {
    resolve = r;
  });

  const getMessages = _.debounce(async function () {
    const _tmp = [...waiting];
    waiting.length = 0;
    resolve(callWithErrorHandling('getMessages', _tmp));
    pending = new Promise(r => {
      resolve = r;
    });
  }, 500);

  const get = async tmid => {
    getMessages();
    const messages = await pending;
    return messages.find(_ref => {
      let {
        _id
      } = _ref;
      return _id === tmid;
    });
  };

  return async tmid => {
    const message = Messages.findOne({
      _id: tmid
    });

    if (message) {
      return message;
    }

    if (waiting.indexOf(tmid) === -1) {
      waiting.push(tmid);
    }

    return get(tmid);
  };
})();

Template.messageThread.helpers({
  parentMessage() {
    const {
      parentMessage
    } = Template.instance();

    if (parentMessage) {
      return normalizeThreadTitle(parentMessage.get());
    }
  }

});
Template.messageThread.onCreated(function () {
  this.parentMessage = new ReactiveVar();
  this.autorun(async () => {
    const {
      tmid
    } = Template.currentData();
    this.parentMessage.set(await findParentMessage(tmid));
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"videobridge":{"client":{"views":{"bbbLiveView.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/client/views/bbbLiveView.html                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.bbbLiveView.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.bbbLiveView.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/client/views/template.bbbLiveView.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("bbbLiveView");
Template["bbbLiveView"] = new Template("Template.bbbLiveView", (function() {
  var view = this;
  return HTML.IFRAME({
    allowfullscreen: "true",
    webkitallowfullscreen: "true",
    mozallowfullscreen: "true",
    allow: "microphone *; camera *; display-capture *",
    src: function() {
      return Spacebars.mustache(view.lookup("source"));
    },
    width: "380",
    height: "400",
    frameborder: "0"
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"actionLink.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/client/actionLink.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 2);
let actionLinks;
module.link("../../action-links/client", {
  actionLinks(v) {
    actionLinks = v;
  }

}, 3);
let Rooms;
module.link("../../models", {
  Rooms(v) {
    Rooms = v;
  }

}, 4);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 5);
actionLinks.register('joinJitsiCall', function (message, params, instance) {
  if (Session.get('openedRoom')) {
    var _Meteor$user, _room$muted;

    const rid = Session.get('openedRoom');
    const room = Rooms.findOne({
      _id: rid
    });
    const username = (_Meteor$user = Meteor.user()) === null || _Meteor$user === void 0 ? void 0 : _Meteor$user.username;
    const currentTime = new Date().getTime();
    const jitsiTimeout = new Date(room && room.jitsiTimeout || currentTime).getTime();

    if (room && room !== null && room !== void 0 && (_room$muted = room.muted) !== null && _room$muted !== void 0 && _room$muted.includes(username)) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('You_have_been_muted', '')
      });
    } else if (jitsiTimeout > currentTime) {
      instance.tabBar.open('video');
    } else {
      dispatchToastMessage({
        type: 'info',
        message: TAPi18n.__('Call Already Ended', '')
      });
    }
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./views/bbbLiveView.html");
module.link("./tabBar");
module.link("./actionLink");
module.link("../lib/messageType");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/client/tabBar.tsx                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["label"],
      _excluded2 = ["label"];

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
let React, useMemo, lazy;
module.link("react", {
  default(v) {
    React = v;
  },

  useMemo(v) {
    useMemo = v;
  },

  lazy(v) {
    lazy = v;
  }

}, 0);
let useStableArray;
module.link("@rocket.chat/fuselage-hooks", {
  useStableArray(v) {
    useStableArray = v;
  }

}, 1);
let Option, Badge;
module.link("@rocket.chat/fuselage", {
  Option(v) {
    Option = v;
  },

  Badge(v) {
    Badge = v;
  }

}, 2);
let useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 3);
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 4);
let useTranslation;
module.link("../../../client/contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 5);
let useUser;
module.link("../../../client/contexts/UserContext", {
  useUser(v) {
    useUser = v;
  }

}, 6);
let Header;
module.link("../../../client/components/Header", {
  default(v) {
    Header = v;
  }

}, 7);
const templateBBB = /*#__PURE__*/lazy(() => module.dynamicImport('../../../client/views/room/contextualBar/Call/BBB'));
addAction('bbb_video', _ref => {
  var _room$muted;

  let {
    room
  } = _ref;
  const enabled = useSetting('bigbluebutton_Enabled');
  const t = useTranslation();
  const live = (room === null || room === void 0 ? void 0 : room.streamingOptions) && room.streamingOptions.type === 'call';
  const enabledDirect = useSetting('bigbluebutton_enable_d');
  const enabledGroup = useSetting('bigbluebutton_enable_p');
  const enabledChannel = useSetting('bigbluebutton_enable_c');
  const enabledTeams = useSetting('bigbluebutton_enable_teams');
  const groups = useStableArray([enabledDirect && 'direct', 'direct_multiple', enabledGroup && 'group', enabledTeams && 'team', enabledChannel && 'channel'].filter(Boolean));
  const user = useUser();
  const username = user ? user.username : '';
  const enableOption = enabled && (!username || !((_room$muted = room.muted) !== null && _room$muted !== void 0 && _room$muted.includes(username)));
  return useMemo(() => enableOption ? {
    groups,
    id: 'bbb_video',
    title: 'BBB_Video_Call',
    icon: 'phone',
    template: templateBBB,
    order: live ? -1 : 4,
    renderAction: props => /*#__PURE__*/React.createElement(Header.ToolBoxAction, props, live ? /*#__PURE__*/React.createElement(Header.Badge, {
      title: t('Started_a_video_call'),
      variant: "primary"
    }, "!") : null),
    renderOption: _ref2 => {
      let {
        label: {
          title,
          icon
        }
      } = _ref2,
          props = _objectWithoutProperties(_ref2, _excluded);

      return /*#__PURE__*/React.createElement(Option, _extends({
        label: title,
        title: title,
        icon: icon
      }, props), /*#__PURE__*/React.createElement(Badge, {
        title: t('Started_a_video_call'),
        variant: "primary"
      }, "!"));
    }
  } : null, [enableOption, groups, live, t]);
});
const templateJitsi = /*#__PURE__*/lazy(() => module.dynamicImport('../../../client/views/room/contextualBar/Call/Jitsi'));
addAction('video', _ref3 => {
  var _room$muted2;

  let {
    room
  } = _ref3;
  const enabled = useSetting('Jitsi_Enabled');
  const t = useTranslation();
  const enabledChannel = useSetting('Jitsi_Enable_Channels');
  const enabledTeams = useSetting('Jitsi_Enable_Teams');
  const enabledLiveChat = useSetting('Omnichannel_call_provider') === 'Jitsi';
  const groups = useStableArray(['direct', 'direct_multiple', 'group', enabledLiveChat && 'live', enabledTeams && 'team', enabledChannel && 'channel'].filter(Boolean));
  const currentTime = new Date().getTime();
  const jitsiTimeout = new Date((room === null || room === void 0 ? void 0 : room.jitsiTimeout) || currentTime).getTime();
  const live = jitsiTimeout > currentTime || null;
  const user = useUser();
  const username = user ? user.username : '';
  const enableOption = enabled && (!username || !((_room$muted2 = room.muted) !== null && _room$muted2 !== void 0 && _room$muted2.includes(username)));
  return useMemo(() => enableOption ? {
    groups,
    id: 'video',
    title: 'Call',
    icon: 'phone',
    template: templateJitsi,
    full: true,
    order: live ? -1 : 4,
    renderAction: props => /*#__PURE__*/React.createElement(Header.ToolBoxAction, props, live && /*#__PURE__*/React.createElement(Header.Badge, {
      title: t('Started_a_video_call'),
      variant: "primary"
    }, "!")),
    renderOption: _ref4 => {
      let {
        label: {
          title,
          icon
        }
      } = _ref4,
          props = _objectWithoutProperties(_ref4, _excluded2);

      return /*#__PURE__*/React.createElement(Option, _extends({
        label: title,
        title: title,
        icon: icon
      }, props), live && /*#__PURE__*/React.createElement(Badge, {
        title: t('Started_a_video_call'),
        variant: "primary"
      }, "!"));
    }
  } : null, [enableOption, groups, live, t]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"messageType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/lib/messageType.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 1);
let MessageTypes;
module.link("../../ui-utils", {
  MessageTypes(v) {
    MessageTypes = v;
  }

}, 2);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'jitsi_call_started',
    system: true,
    message: TAPi18n.__('Started_a_video_call')
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"constants.js":[]},"authorization":{"client":{"requiresPermission.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/requiresPermission.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.requiresPermission.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.requiresPermission.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/template.requiresPermission.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("requiresPermission");
Template["requiresPermission"] = new Template("Template.requiresPermission", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.dataMustache(view.lookup("hasPermission"), view.lookup("."));
  }, function() {
    return [ "\n\t\t", Blaze._InOuterTemplateScope(view, function() {
      return Spacebars.include(function() {
        return Spacebars.call(view.templateContentBlock);
      });
    }), "\n\t" ];
  }, function() {
    return [ "\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.templateElseBlock);
    }, function() {
      return [ "\n\t\t\t", Blaze._InOuterTemplateScope(view, function() {
        return Spacebars.include(function() {
          return Spacebars.call(view.templateElseBlock);
        });
      }), "\n\t\t" ];
    }, function() {
      return [ "\n\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Not_found_or_not_allowed");
      }), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"lib":{"ChatPermissions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/lib/ChatPermissions.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ChatPermissions: () => ChatPermissions
});
let AuthzCachedCollection;
module.link("../../../models", {
  AuthzCachedCollection(v) {
    AuthzCachedCollection = v;
  }

}, 0);
const ChatPermissions = AuthzCachedCollection.collection;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"streamer.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/lib/streamer.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  rolesStreamer: () => rolesStreamer
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
const rolesStreamer = new Meteor.Streamer('roles');
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"hasPermission.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/hasPermission.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  hasAllPermission: () => hasAllPermission,
  hasAtLeastOnePermission: () => hasAtLeastOnePermission,
  userHasAllPermission: () => userHasAllPermission,
  hasPermission: () => hasPermission
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ChatPermissions;
module.link("./lib/ChatPermissions", {
  ChatPermissions(v) {
    ChatPermissions = v;
  }

}, 1);
let Models;
module.link("../../models/client", {
  "*"(v) {
    Models = v;
  }

}, 2);
let AuthorizationUtils;
module.link("../lib/AuthorizationUtils", {
  AuthorizationUtils(v) {
    AuthorizationUtils = v;
  }

}, 3);

const isValidScope = scope => typeof scope === 'string' && scope in Models;

const createPermissionValidator = quantifier => (permissionIds, scope, userId) => {
  const user = Models.Users.findOneById(userId, {
    fields: {
      roles: 1
    }
  });
  const checkEachPermission = quantifier.bind(permissionIds);
  return checkEachPermission(permissionId => {
    var _permission$roles;

    if (user !== null && user !== void 0 && user.roles) {
      if (AuthorizationUtils.isPermissionRestrictedForRoleList(permissionId, user.roles)) {
        return false;
      }
    }

    const permission = ChatPermissions.findOne(permissionId, {
      fields: {
        roles: 1
      }
    });
    const roles = (_permission$roles = permission === null || permission === void 0 ? void 0 : permission.roles) !== null && _permission$roles !== void 0 ? _permission$roles : [];
    return roles.some(roleName => {
      const role = Models.Roles.findOne(roleName, {
        fields: {
          scope: 1
        }
      });
      const roleScope = role === null || role === void 0 ? void 0 : role.scope;

      if (!isValidScope(roleScope)) {
        return false;
      }

      const model = Models[roleScope];
      return model.isUserInRole && model.isUserInRole(userId, roleName, scope);
    });
  });
};

const atLeastOne = createPermissionValidator(Array.prototype.some);
const all = createPermissionValidator(Array.prototype.every);

const validatePermissions = (permissions, scope, predicate, userId) => {
  var _userId;

  userId = (_userId = userId) !== null && _userId !== void 0 ? _userId : Meteor.userId();

  if (!userId) {
    return false;
  }

  if (!Models.AuthzCachedCollection.ready.get()) {
    return false;
  }

  return predicate([].concat(permissions), scope, userId);
};

const hasAllPermission = (permissions, scope) => validatePermissions(permissions, scope, all);

const hasAtLeastOnePermission = (permissions, scope) => validatePermissions(permissions, scope, atLeastOne);

const userHasAllPermission = (permissions, scope, userId) => validatePermissions(permissions, scope, all, userId);

const hasPermission = hasAllPermission;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hasRole.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/hasRole.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  hasRole: () => hasRole
});
let Roles;
module.link("../../models", {
  Roles(v) {
    Roles = v;
  }

}, 0);

const hasRole = (userId, roleNames, scope) => {
  roleNames = [].concat(roleNames);
  return Roles.isUserInRoles(userId, roleNames, scope);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  hasAllPermission: () => hasAllPermission,
  hasAtLeastOnePermission: () => hasAtLeastOnePermission,
  hasRole: () => hasRole,
  hasPermission: () => hasPermission,
  userHasAllPermission: () => userHasAllPermission,
  AuthorizationUtils: () => AuthorizationUtils
});
let hasAllPermission, hasAtLeastOnePermission, hasPermission, userHasAllPermission;
module.link("./hasPermission", {
  hasAllPermission(v) {
    hasAllPermission = v;
  },

  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  },

  hasPermission(v) {
    hasPermission = v;
  },

  userHasAllPermission(v) {
    userHasAllPermission = v;
  }

}, 0);
let hasRole;
module.link("./hasRole", {
  hasRole(v) {
    hasRole = v;
  }

}, 1);
let AuthorizationUtils;
module.link("../lib/AuthorizationUtils", {
  AuthorizationUtils(v) {
    AuthorizationUtils = v;
  }

}, 2);
module.link("./requiresPermission.html");
module.link("./startup");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/startup.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let hasAtLeastOnePermission;
module.link("./hasPermission", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 2);
let CachedCollectionManager;
module.link("../../ui-cached-collection", {
  CachedCollectionManager(v) {
    CachedCollectionManager = v;
  }

}, 3);
let APIClient;
module.link("../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 4);
let Roles;
module.link("../../models/client", {
  Roles(v) {
    Roles = v;
  }

}, 5);
let rolesStreamer;
module.link("./lib/streamer", {
  rolesStreamer(v) {
    rolesStreamer = v;
  }

}, 6);
let registerAdminSidebarItem;
module.link("../../../client/views/admin", {
  registerAdminSidebarItem(v) {
    registerAdminSidebarItem = v;
  }

}, 7);
Meteor.startup(() => {
  CachedCollectionManager.onLogin(async () => {
    const {
      roles
    } = await APIClient.v1.get('roles.list'); // if a role is checked before this collection is populated, it will return undefined

    Roles._collection._docs._map = new Map(roles.map(record => [record._id, record]));
    Object.values(Roles._collection.queries).forEach(query => Roles._collection._recomputeResults(query));
    Roles.ready.set(true);
  });
  registerAdminSidebarItem({
    href: 'admin-permissions',
    i18nLabel: 'Permissions',
    icon: 'lock',

    permissionGranted() {
      return hasAtLeastOnePermission(['access-permissions', 'access-setting-permissions']);
    }

  });
  const events = {
    changed: role => {
      delete role.type;
      Roles.upsert({
        _id: role._id
      }, role);
    },
    removed: role => {
      Roles.remove({
        _id: role._id
      });
    }
  };
  Tracker.autorun(c => {
    if (!Meteor.userId()) {
      return;
    }

    rolesStreamer.on('roles', role => events[role.type](role));
    c.stop();
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"AuthorizationUtils.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/lib/AuthorizationUtils.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AuthorizationUtils: () => AuthorizationUtils
});
const restrictedRolePermissions = new Map();
const AuthorizationUtils = class {
  static addRolePermissionWhiteList(roleId, list) {
    if (!roleId) {
      throw new Error('invalid-param');
    }

    if (!list) {
      throw new Error('invalid-param');
    }

    if (!restrictedRolePermissions.has(roleId)) {
      restrictedRolePermissions.set(roleId, new Set());
    }

    const rules = restrictedRolePermissions.get(roleId);

    for (const permissionId of list) {
      rules.add(permissionId);
    }
  }

  static isPermissionRestrictedForRole(permissionId, roleId) {
    if (!roleId || !permissionId) {
      throw new Error('invalid-param');
    }

    if (!restrictedRolePermissions.has(roleId)) {
      return false;
    }

    const rules = restrictedRolePermissions.get(roleId);

    if (!rules || !rules.size) {
      return false;
    }

    return !rules.has(permissionId);
  }

  static isPermissionRestrictedForRoleList(permissionId, roleList) {
    if (!roleList || !permissionId) {
      throw new Error('invalid-param');
    }

    for (const roleId of roleList) {
      if (this.isPermissionRestrictedForRole(permissionId, roleId)) {
        return true;
      }
    }

    return false;
  }

};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":[
  "./AuthorizationUtils"
]},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"emoji":{"client":{"emojiPicker.html":[
  "./template.emojiPicker.js"
],"template.emojiPicker.js":[],"lib":{"EmojiPicker.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji/client/lib/EmojiPicker.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  EmojiPicker: () => EmojiPicker
});

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 1);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 2);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 3);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 4);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 5);
let emoji;
module.link("../../lib/rocketchat", {
  emoji(v) {
    emoji = v;
  }

}, 6);
let updatePositions = true;
const EmojiPicker = {
  width: 365,
  height: 300,
  initiated: false,
  input: null,
  source: null,
  recent: [],
  tone: null,
  opened: false,
  pickCallback: null,
  scrollingToCategory: false,
  currentCategory: new ReactiveVar('recent'),

  async init() {
    if (this.initiated) {
      return;
    }

    this.initiated = true;
    this.recent = Meteor._localStorage.getItem('emoji.recent') ? Meteor._localStorage.getItem('emoji.recent').split(',') : [];
    this.tone = Meteor._localStorage.getItem('emoji.tone') || 0;
    Blaze.render(Template.emojiPicker, document.body);
    $(document).click(event => {
      if (!this.opened) {
        return;
      }

      if (!$(event.target).closest('.emoji-picker').length && !$(event.target).is('.emoji-picker')) {
        if (this.opened) {
          this.close();
        }
      }
    });
    $(window).resize(_.debounce(() => {
      if (!this.opened) {
        return;
      }

      this.setPosition();
    }, 300));
  },

  isOpened() {
    return this.opened;
  },

  setTone(tone) {
    this.tone = tone;

    Meteor._localStorage.setItem('emoji.tone', tone);
  },

  getTone() {
    return this.tone;
  },

  getRecent() {
    return this.recent;
  },

  setPosition() {
    const windowHeight = window.innerHeight;
    const windowWidth = window.innerWidth;
    const windowBorder = 10;
    const sourcePos = $(this.source).offset();
    const {
      left,
      top
    } = sourcePos;
    const cssProperties = {
      top,
      left
    };
    const isLargerThanWindow = this.width + windowBorder > windowWidth;

    if (top + this.height >= windowHeight) {
      cssProperties.top = windowHeight - this.height - windowBorder - 75;
    }

    if (left < windowBorder) {
      cssProperties.left = isLargerThanWindow ? 0 : windowBorder;
    }

    if (left + this.width >= windowWidth) {
      cssProperties.left = isLargerThanWindow ? 0 : windowWidth - this.width - windowBorder;
    }

    return $('.emoji-picker').css(cssProperties);
  },

  async open(source, callback) {
    if (!this.initiated) {
      await this.init();
    }

    this.pickCallback = callback;
    this.source = source;
    const containerEl = this.setPosition();
    containerEl.addClass('show');
    const emojiInput = containerEl.find('.js-emojipicker-search');

    if (emojiInput) {
      emojiInput.focus();
    }

    this.calculateCategoryPositions();

    if (this.recent.length === 0 && this.currentCategory.get() === 'recent') {
      this.showCategory(emoji.packages.emojiCustom.list.length > 0 ? 'rocket' : 'people', false);
    }

    this.opened = true;
  },

  close() {
    $('.emoji-picker').removeClass('show');
    this.opened = false;
    this.source.focus();
  },

  pickEmoji(emoji) {
    this.pickCallback(emoji);
    this.close();
    this.addRecent(emoji);
  },

  addRecent(_emoji) {
    const pos = this.recent.indexOf(_emoji);

    if (pos !== -1) {
      this.recent.splice(pos, 1);
    }

    this.recent.unshift(_emoji); // limit recent emojis to 27 (3 rows of 9)

    this.recent.splice(27);
    updatePositions = true;

    Meteor._localStorage.setItem('emoji.recent', this.recent);

    emoji.packages.base.emojisByCategory.recent = this.recent;
    this.updateRecent('recent');
  },

  removeFromRecent(_emoji) {
    const pos = this.recent.indexOf(_emoji);

    if (pos === -1) {
      return;
    }

    this.recent.splice(pos, 1);

    Meteor._localStorage.setItem('emoji.recent', this.recent);
  },

  async updateRecent(category) {
    const emojiPickerImport = await module.dynamicImport('../emojiPicker');
    const {
      updateRecentEmoji
    } = emojiPickerImport;
    updateRecentEmoji(category);
  },

  calculateCategoryPositions() {
    if (!updatePositions) {
      return;
    }

    updatePositions = false;
    const containerScroll = $('.emoji-picker .emojis').scrollTop();
    this.catPositions = Array.from(document.querySelectorAll('.emoji-list-category')).map(el => {
      const {
        top
      } = $(el).position();
      return {
        el,
        top: top + containerScroll
      };
    });
  },

  getCategoryPositions() {
    return this.catPositions;
  },

  showCategory(category) {
    let animate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
    this.scrollingToCategory = animate;
    $('.emoji-picker .js-emojipicker-search').val('').change().focus();
    this.currentCategory.set(category);
    Tracker.afterFlush(() => {
      const header = $("#emoji-list-category-".concat(category));
      const container = $('.emoji-picker .emojis');
      const scrollTop = header.position().top + container.scrollTop(); // - container.position().top;

      if (animate) {
        return container.animate({
          scrollTop
        }, 300, () => {
          this.scrollingToCategory = false;
        });
      }

      container.scrollTop(scrollTop);
    });
  }

};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"emojiParser.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji/client/emojiParser.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  emojiParser: () => emojiParser,
  createEmojiMessageRenderer: () => createEmojiMessageRenderer
});
let isIE11;
module.link("../../../client/lib/utils/isIE11", {
  isIE11(v) {
    isIE11 = v;
  }

}, 0);
let emoji;
module.link("../lib/rocketchat", {
  emoji(v) {
    emoji = v;
  }

}, 1);

/*
 * emojiParser is a function that will replace emojis
 * @param {Object} message - The message object
 */
const emojiParser = message => {
  var _message$html;

  if (!((_message$html = message.html) !== null && _message$html !== void 0 && _message$html.trim())) {
    return message;
  }

  let html = message.html.trim(); // &#39; to apostrophe (') for emojis such as :')

  html = html.replace(/&#39;/g, "'"); // '<br>' to ' <br> ' for emojis such at line breaks

  html = html.replace(/<br>/g, ' <br> ');
  html = Object.entries(emoji.packages).reverse().reduce((value, _ref) => {
    let [, emojiPackage] = _ref;
    return emojiPackage.render(value);
  }, html);
  const checkEmojiOnly = document.createElement('div');
  checkEmojiOnly.innerHTML = html;
  const emojis = Array.from(checkEmojiOnly.querySelectorAll('.emoji:not(:empty), .emojione:not(:empty)'));
  let hasText = false;

  if (!isIE11) {
    const filter = node => {
      if (node.nodeType === Node.ELEMENT_NODE && (node.classList.contains('emojione') || node.classList.contains('emoji'))) {
        return NodeFilter.FILTER_REJECT;
      }

      return NodeFilter.FILTER_ACCEPT;
    };

    const walker = document.createTreeWalker(checkEmojiOnly, NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_TEXT, filter);

    while (walker.nextNode()) {
      if (walker.currentNode.nodeType === Node.TEXT_NODE && walker.currentNode.nodeValue.trim() !== '') {
        hasText = true;
        break;
      }
    }

    const emojiOnly = emojis.length && !hasText;

    if (emojiOnly) {
      for (let i = 0, len = emojis.length; i < len; i++) {
        const {
          classList
        } = emojis[i];
        classList.add('big');
      }

      html = checkEmojiOnly.innerHTML;
    }
  } // apostrophe (') back to &#39;


  html = html.replace(/\'/g, '&#39;'); // line breaks ' <br> ' back to '<br>'

  html = html.replace(/ <br> /g, '<br>');
  return _objectSpread(_objectSpread({}, message), {}, {
    html
  });
};

const createEmojiMessageRenderer = () => emojiParser;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emojiPicker.js":[
  "underscore",
  "meteor/reactive-var",
  "meteor/reactive-dict",
  "meteor/kadira:flow-router",
  "meteor/templating",
  "@rocket.chat/string-helpers",
  "../../theme/client/imports/components/emojiPicker.css",
  "../../utils/client",
  "./lib/EmojiPicker",
  "../lib/rocketchat",
  "./emojiPicker.html"
],"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji/client/index.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/EmojiPicker", {
  EmojiPicker: "EmojiPicker"
}, 0);
module.link("../lib/rocketchat", {
  emoji: "emoji"
}, 1);
module.link("./emojiParser", {
  createEmojiMessageRenderer: "createEmojiMessageRenderer"
}, 2);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"rocketchat.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji/lib/rocketchat.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  emoji: () => emoji
});
let emojioneRender;
module.link("../../emoji-emojione/lib/emojioneRender", {
  emojioneRender(v) {
    emojioneRender = v;
  }

}, 0);
let EmojiPicker;

const removeFromRecent = emoji => {
  if (!EmojiPicker) {
    // since this function will be only called client side, the import needs to happen here
    ({
      EmojiPicker
    } = require('../client/lib/EmojiPicker'));
  }

  EmojiPicker.removeFromRecent(emoji.replace(/(^:|:$)/g, ''));
};

const emoji = {
  packages: {
    base: {
      emojiCategories: [{
        key: 'recent',
        i18n: 'Frequently_Used'
      }],
      categoryIndex: 0,
      emojisByCategory: {
        recent: []
      },
      toneList: {},
      render: emojioneRender,

      renderPicker(emojiToRender) {
        if (!emoji.list[emojiToRender]) {
          removeFromRecent(emojiToRender);
          return;
        }

        const correctPackage = emoji.list[emojiToRender].emojiPackage;
        return emoji.packages[correctPackage].renderPicker(emojiToRender);
      }

    }
  },
  list: {}
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji/index.js                                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lazy-load":{"client":{"lazyloadImage.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lazy-load/client/lazyloadImage.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.lazyloadImage.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.lazyloadImage.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lazy-load/client/template.lazyloadImage.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("lazyloadImage");
Template["lazyloadImage"] = new Template("Template.lazyloadImage", (function() {
  var view = this;
  return HTML.IMG({
    "data-src": function() {
      return Spacebars.mustache(view.lookup("srcUrl"));
    },
    src: function() {
      return Spacebars.mustache(view.lookup("lazySrcUrl"));
    },
    alt: function() {
      return Spacebars.mustache(view.lookup("alt"));
    },
    height: function() {
      return Spacebars.mustache(view.lookup("height"));
    },
    class: function() {
      return Spacebars.mustache(view.lookup("class"));
    },
    "data-title": function() {
      return Spacebars.mustache(view.lookup("title"));
    },
    "data-description": function() {
      return Spacebars.mustache(view.lookup("description"));
    }
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lazy-load/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  addImage: () => addImage
});
module.link("./lazyloadImage");
const map = new WeakMap();
const featureExists = !!window.IntersectionObserver;

const loadImage = el => {
  const instance = map.get(el);
  map.delete(el);

  if (!instance) {
    return;
  }

  const img = new Image();
  const src = el.getAttribute('data-src');

  img.onload = () => {
    el.className = el.className.replace('lazy-img', '');
    el.src = src;
    el.removeAttribute('data-src');
    instance.loaded.set(true);
  };

  img.src = src;
};

const observer = featureExists && new IntersectionObserver((entries, observer) => entries.forEach(entry => {
  if (entry.isIntersecting) {
    observer.unobserve(entry.target);
    return loadImage(entry.target);
  }
}), {
  threshold: [0],
  trackVisibility: true,
  delay: 230
});

const addImage = instance => {
  const el = instance.firstNode;
  map.set(el, instance);

  if (featureExists) {
    return observer.observe(el);
  }

  loadImage(el);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"lazyloadImage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lazy-load/client/lazyloadImage.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
module.link("./lazyloadImage.html");
let addImage;
module.link(".", {
  addImage(v) {
    addImage = v;
  }

}, 2);
const emptyImageEncoded = 'iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8+/u3PQAJJAM0dIyWdgAAAABJRU5ErkJggg==';
const imgsrcs = new Set();
Template.lazyloadImage.helpers({
  class() {
    const loaded = Template.instance().loaded.get();
    return "".concat(this.class, " ").concat(loaded ? '' : 'lazy-img');
  },

  srcUrl() {
    if (Template.instance().loaded.get()) {
      return;
    }

    return this.src;
  },

  lazySrcUrl() {
    const {
      preview,
      placeholder,
      src
    } = this;
    const {
      loaded
    } = Template.instance();

    if (loaded.get() || !preview && !placeholder || imgsrcs.has(src)) {
      return src;
    }

    imgsrcs.add(this.src);
    return "data:image/png;base64,".concat(preview || emptyImageEncoded);
  }

});
Template.lazyloadImage.onCreated(function () {
  this.loaded = new ReactiveVar(false);
});
Template.lazyloadImage.onRendered(function () {
  addImage(this);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"meteor-autocomplete":{"client":{"inputs.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/inputs.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.inputs.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.inputs.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/template.inputs.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("inputAutocomplete");
Template["inputAutocomplete"] = new Template("Template.inputAutocomplete", (function() {
  var view = this;
  return [ HTML.INPUT(HTML.Attrs({
    type: "text"
  }, function() {
    return Spacebars.attrMustache(view.lookup("attributes"));
  })), "\n    ", Spacebars.include(view.lookupTemplate("autocompleteContainer")) ];
}));

Template.__checkName("textareaAutocomplete");
Template["textareaAutocomplete"] = new Template("Template.textareaAutocomplete", (function() {
  var view = this;
  return [ HTML.TEXTAREA(HTML.Attrs(function() {
    return Spacebars.attrMustache(view.lookup("attributes"));
  }, {
    value: function() {
      return Blaze._InOuterTemplateScope(view, function() {
        return Spacebars.include(function() {
          return Spacebars.call(view.templateContentBlock);
        });
      });
    }
  })), "\n    ", Spacebars.include(view.lookupTemplate("autocompleteContainer")) ];
}));

Template.__checkName("_autocompleteContainer");
Template["_autocompleteContainer"] = new Template("Template._autocompleteContainer", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isShowing"));
  }, function() {
    return [ "\n    ", HTML.DIV({
      class: "-autocomplete-container"
    }, "\n        ", Blaze.If(function() {
      return Spacebars.call(view.lookup("isLoaded"));
    }, function() {
      return [ "\n            ", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("empty"));
      }, function() {
        return [ "\n            ", HTML.UL({
          class: "-autocomplete-list"
        }, "\n                ", Blaze.Each(function() {
          return Spacebars.call(view.lookup("filteredList"));
        }, function() {
          return [ "\n                ", HTML.LI({
            class: "-autocomplete-item"
          }, "\n                    ", Spacebars.With(function() {
            return Spacebars.call(Spacebars.dot(view.lookup(".."), "currentTemplate"));
          }, function() {
            return [ "\n                        ", Spacebars.With(function() {
              return Spacebars.call(view.lookup(".."));
            }, function() {
              return [ "  \n                            ", Spacebars.include(view.lookupTemplate("..")), "  \n                        " ];
            }), "\n                    " ];
          }), "\n                "), "\n                " ];
        }), "\n            "), "\n            " ];
      }, function() {
        return [ "\n                ", Spacebars.include(view.lookupTemplate("noMatchTemplate")), "\n            " ];
      }), "\n        " ];
    }, function() {
      return [ "\n            ", Spacebars.include(view.lookupTemplate("loading")), "\n        " ];
    }), "\n    "), "\n    " ];
  });
}));

Template.__checkName("_noMatch");
Template["_noMatch"] = new Template("Template._noMatch", (function() {
  var view = this;
  return HTML.Raw("(<i>no matches</i>)");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"autocomplete-client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/autocomplete-client.js                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  default: () => AutoComplete
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Match;
module.link("meteor/check", {
  Match(v) {
    Match = v;
  }

}, 1);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 2);
let Deps;
module.link("meteor/deps", {
  Deps(v) {
    Deps = v;
  }

}, 3);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 4);
let getCaretCoordinates;
module.link("meteor/dandv:caret-position", {
  getCaretCoordinates(v) {
    getCaretCoordinates = v;
  }

}, 5);
let AutoCompleteRecords;
module.link("./collection", {
  default(v) {
    AutoCompleteRecords = v;
  }

}, 6);
let APIClient;
module.link("../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 7);

const isServerSearch = function (rule) {
  return _.isString(rule.collection);
};

const validateRule = function (rule) {
  if (rule.subscription != null && !Match.test(rule.collection, String)) {
    throw new Error('Collection name must be specified as string for server-side search');
  } // XXX back-compat message, to be removed


  if (rule.callback) {
    console.warn('autocomplete no longer supports callbacks; use event listeners instead.');
  }
};

const isWholeField = function (rule) {
  // either '' or null both count as whole field.
  return !rule.token;
};

const getRegExp = function (rule) {
  if (!isWholeField(rule)) {
    // Expressions for the range from the last word break to the current cursor position
    return new RegExp("(^|\\b|\\s)".concat(rule.token, "([\\w.]*)$"));
  } // Whole-field behavior - word characters or spaces


  return new RegExp('(^)(.*)$');
};

const getFindParams = function (rule, filter, limit) {
  // This is a different 'filter' - the selector from the settings
  // We need to extend so that we don't copy over rule.filter
  const selector = _.extend({}, rule.filter || {});

  const options = {
    limit
  };

  if (!filter) {
    // Match anything, no sort, limit X
    return [selector, options];
  }

  if (rule.sort && rule.field) {
    const sortspec = {}; // Only sort if there is a filter, for faster performance on a match of anything

    sortspec[rule.field] = 1;
    options.sort = sortspec;
  }

  if (_.isFunction(rule.selector)) {
    // Custom selector
    _.extend(selector, rule.selector(filter));
  } else {
    selector[rule.field] = {
      $regex: rule.matchAll ? filter : "^".concat(filter),
      // default is case insensitive search - empty string is not the same as undefined!
      $options: typeof rule.options === 'undefined' ? 'i' : rule.options
    };
  }

  return [selector, options];
};

const getField = function (obj, str) {
  const string = str.split('.');
  string.forEach(key => {
    obj = obj[key];
  });
  return obj;
};

class AutoComplete {
  constructor(settings) {
    this.KEYS = [40, 38, 13, 27, 9];
    this.limit = settings.limit || 5;
    this.position = settings.position || 'bottom';
    this.rules = settings.rules;
    this.selector = _objectSpread({
      container: '.-autocomplete-container',
      item: '.-autocomplete-item'
    }, settings.selector);
    const {
      rules
    } = this;
    Object.keys(rules).forEach(key => {
      const rule = rules[key];
      validateRule(rule);
    });
    this.onSelect = settings.onSelect;

    this.expressions = (() => Object.keys(rules).map(key => {
      const rule = rules[key];
      return getRegExp(rule);
    }))();

    this.matched = -1;
    this.loaded = true; // Reactive dependencies for current matching rule and filter

    this.ruleDep = new Deps.Dependency();
    this.filterDep = new Deps.Dependency();
    this.loadingDep = new Deps.Dependency(); // Autosubscribe to the record set published by the server based on the filter
    // This will tear down server subscriptions when they are no longer being used.

    this.sub = null;
    this.comp = Deps.autorun(async () => {
      const rule = this.matchedRule();
      const filter = this.getFilter();

      if (this.sub) {
        // Stop any existing sub immediately, don't wait
        this.sub.stop();
      }

      if (!(rule && filter)) {
        return;
      } // subscribe only for server-side collections


      if (!isServerSearch(rule)) {
        this.setLoaded(true);
        return;
      }

      const [selector] = getFindParams(rule, filter, this.limit); // console.debug 'Subscribing to <%s> in <%s>.<%s>', filter, rule.collection, rule.field

      this.setLoaded(false);
      const endpointName = rule.endpoint || 'users.autocomplete';
      const {
        items
      } = await APIClient.v1.get("".concat(endpointName, "?selector=").concat(JSON.stringify(selector)));
      AutoCompleteRecords.remove({});
      items.forEach(item => AutoCompleteRecords.insert(item));
      this.setLoaded(true);
    });
  }

  teardown() {
    // Stop the reactive computation we started for this autocomplete instance
    this.comp.stop();
  }

  matchedRule() {
    // reactive getters and setters for @filter and the currently matched rule
    this.ruleDep.depend();

    if (this.matched >= 0) {
      return this.rules[this.matched];
    }

    return null;
  }

  setMatchedRule(i) {
    this.matched = i;
    this.ruleDep.changed();
  }

  getFilter() {
    this.filterDep.depend();
    return this.filter;
  }

  setFilter(x) {
    this.filter = x;
    this.filterDep.changed();
    return this.filter;
  }

  isLoaded() {
    this.loadingDep.depend();
    return this.loaded;
  }

  setLoaded(val) {
    if (val === this.loaded) {
      return; // Don't cause redraws unnecessarily
    }

    this.loaded = val;
    this.loadingDep.changed();
  }

  onKeyUp() {
    if (!this.$element) {
      return; // Don't try to do this while loading
    }

    if (this._timeoutHandler) {
      clearTimeout(this._timeoutHandler);
    }

    this._timeoutHandler = setTimeout(() => {
      this._timeoutHandler = 0;
      const startpos = this.element.selectionStart;
      const val = this.getText().substring(0, startpos);
      /*
      	Matching on multiple expressions.
      	We always go from a matched state to an unmatched one
      	before going to a different matched one.
       */

      let i = 0;
      let breakLoop = false;

      while (i < this.expressions.length) {
        const matches = val.match(this.expressions[i]); // matching -> not matching

        if (!matches && this.matched === i) {
          this.setMatchedRule(-1);
          breakLoop = true;
        } // not matching -> matching


        if (matches && this.matched === -1) {
          this.setMatchedRule(i);
          breakLoop = true;
        } // Did filter change?


        if (matches && this.filter !== matches[2]) {
          this.setFilter(matches[2]);
          breakLoop = true;
        }

        if (breakLoop) {
          break;
        }

        i++;
      }
    }, 300);
  }

  onKeyDown(e) {
    if (this.matched === -1 || this.KEYS.indexOf(e.keyCode) < 0) {
      return;
    }

    switch (e.keyCode) {
      case 9: // TAB

      case 13:
        // ENTER
        if (this.select()) {
          // Don't jump fields or submit if select successful
          e.preventDefault();
          e.stopPropagation();
        }

        break;
      // preventDefault needed below to avoid moving cursor when selecting

      case 40:
        // DOWN
        e.preventDefault();
        this.next();
        break;

      case 38:
        // UP
        e.preventDefault();
        this.prev();
        break;

      case 27:
        // ESCAPE
        this.$element.blur();
        this.hideList();
    }
  }

  onFocus() {
    // We need to run onKeyUp after the focus resolves,
    // or the caret position (selectionStart) will not be correct
    Meteor.defer(() => this.onKeyUp());
  }

  onBlur() {
    // We need to delay this so click events work
    // TODO this is a bit of a hack, see if we can't be smarter
    Meteor.setTimeout(() => {
      this.hideList();
    }, 500);
  }

  onItemClick(doc) {
    this.processSelection(doc, this.rules[this.matched]);
  }

  onItemHover(doc, e) {
    this.tmplInst.$(this.selector.item).removeClass('selected');
    $(e.target).closest(this.selector.item).addClass('selected');
  }

  filteredList() {
    // @ruleDep.depend() # optional as long as we use depend on filter, because list will always get re-rendered
    const filter = this.getFilter(); // Reactively depend on the filter

    if (this.matched === -1) {
      return null;
    }

    const rule = this.rules[this.matched]; // Don't display list unless we have a token or a filter (or both)
    // Single field: nothing displayed until something is typed

    if (!(rule.token || filter)) {
      return null;
    }

    const params = getFindParams(rule, filter, this.limit);
    const selector = params[0];
    const options = params[1];
    Meteor.defer(() => this.ensureSelection()); // if server collection, the server has already done the filtering work

    if (isServerSearch(rule)) {
      return AutoCompleteRecords.find({}, options);
    } // Otherwise, search on client


    return rule.collection.find(selector, options);
  }

  isShowing() {
    const rule = this.matchedRule(); // Same rules as above

    const showing = rule && (rule.token || this.getFilter()); // Do this after the render

    if (showing) {
      Meteor.defer(() => {
        this.positionContainer();
        this.ensureSelection();
      });
    }

    return showing;
  } // Replace text with currently selected item


  select() {
    const node = this.tmplInst.find("".concat(this.selector.item, ".selected"));

    if (node == null) {
      return false;
    }

    const doc = Blaze.getData(node);

    if (!doc) {
      return false; // Don't select if nothing matched
    }

    this.processSelection(doc, this.rules[this.matched]);
    return true;
  }

  processSelection(doc, rule) {
    const replacement = getField(doc, rule.field);

    if (!isWholeField(rule)) {
      this.replace(replacement, rule);
      this.hideList();
    } else {
      // Empty string or doesn't exist?
      // Single-field replacement: replace whole field
      this.setText(replacement); // Field retains focus, but list is hidden unless another key is pressed
      // Must be deferred or onKeyUp will trigger and match again
      // TODO this is a hack; see above

      this.onBlur();
    }

    this.onSelect && this.onSelect(doc);
    this.$element.trigger('autocompleteselect', doc);
  } // Replace the appropriate region


  replace(replacement) {
    const startpos = this.element.selectionStart;
    const fullStuff = this.getText();
    let val = fullStuff.substring(0, startpos);
    val = val.replace(this.expressions[this.matched], "$1".concat(this.rules[this.matched].token).concat(replacement));
    const posfix = fullStuff.substring(startpos, fullStuff.length);
    const separator = posfix.match(/^\s/) ? '' : ' ';
    const finalFight = val + separator + posfix;
    this.setText(finalFight);
    const newPosition = val.length + 1;
    this.element.setSelectionRange(newPosition, newPosition);
  }

  hideList() {
    this.setMatchedRule(-1);
    this.setFilter(null);
  }

  getText() {
    return this.$element.val() || this.$element.text();
  }

  setText(text) {
    if (this.$element.is('input,textarea')) {
      return this.$element.val(text);
    }

    this.$element.html(text);
  }
  /*
  	Rendering functions
   */


  positionContainer() {
    // First render; Pick the first item and set css whenever list gets shown
    let pos = {};
    const element = this.selector.anchor ? this.tmplInst.$(this.selector.anchor) : this.$element;

    if (this.position === 'fixed') {
      const width = element.outerWidth();
      return this.tmplInst.$(this.selector.container).css({
        width,
        position: 'fixed'
      });
    }

    const position = element.position();

    if (!position) {
      return;
    }

    const rule = this.matchedRule();
    const offset = getCaretCoordinates(this.element, this.element.selectionStart); // In whole-field positioning, we don't move the container and make it the
    // full width of the field.

    if (rule && isWholeField(rule)) {
      pos.left = position.left;

      if (rule.doNotChangeWidth !== false) {
        pos.width = element.outerWidth(); // position.offsetWidth
      }
    } else {
      // Normal positioning, at token word
      pos = {
        left: position.left + offset.left
      };
    } // Position menu from top (above) or from bottom of caret (below, default)


    if (this.position === 'top') {
      pos.bottom = element.offsetParent().height() - position.top - offset.top;
    } else {
      pos.top = position.top + offset.top + parseInt(element.css('font-size'));
    }

    this.tmplInst.$(this.selector.container).css(_objectSpread(_objectSpread({}, pos), {}, {
      position: 'absolute'
    }));
  }

  ensureSelection() {
    // Re-render; make sure selected item is something in the list or none if list empty
    const selectedItem = this.tmplInst.$("".concat(this.selector.item, ".selected"));

    if (!selectedItem.length) {
      // Select anything
      this.tmplInst.$("".concat(this.selector.item, ":first-child")).addClass('selected');
    }
  } // Select next item in list


  next() {
    const currentItem = this.tmplInst.$("".concat(this.selector.item, ".selected"));

    if (!currentItem.length) {
      return this.tmplInst.$("".concat(this.selector.item, ":first-child")).addClass('selected');
    }

    currentItem.removeClass('selected');
    const next = currentItem.next();

    if (next.length) {
      next.addClass('selected');
    } else {
      // End of list or lost selection; Go back to first item
      this.tmplInst.$("".concat(this.selector.item, ":first-child")).addClass('selected');
    }
  } // Select previous item in list


  prev() {
    const currentItem = this.tmplInst.$("".concat(this.selector.item, ".selected"));

    if (!currentItem.length) {
      return; // Don't try to iterate an empty list
    }

    currentItem.removeClass('selected');
    const prev = currentItem.prev();

    if (prev.length) {
      prev.addClass('selected');
    } else {
      // Beginning of list or lost selection; Go to end of list
      this.tmplInst.$("".concat(this.selector.item, ":last-child")).addClass('selected');
    }
  } // This doesn't need to be reactive because list already changes reactively
  // and will cause all of the items to re-render anyway


  currentTemplate() {
    return this.rules[this.matched].template;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"autocomplete.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/autocomplete.css                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"collection.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/collection.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
module.exportDefault(new Mongo.Collection(null));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/index.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AutoComplete: () => AutoComplete
});
module.link("./inputs.html");
module.link("./templates");
let AutoComplete;
module.link("./autocomplete-client", {
  default(v) {
    AutoComplete = v;
  }

}, 0);
module.link("./autocomplete.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"templates.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/templates.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  acEvents: () => acEvents,
  attributes: () => attributes,
  autocompleteHelpers: () => autocompleteHelpers
});
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
let AutoComplete;
module.link("./autocomplete-client", {
  default(v) {
    AutoComplete = v;
  }

}, 3);
//  Events on template instances, sent to the autocomplete class
const acEvents = {
  keydown(e, t) {
    t.ac.onKeyDown(e);
  },

  keyup(e, t) {
    t.ac.onKeyUp(e);
  },

  focus(e, t) {
    t.ac.onFocus(e);
  },

  blur(e, t) {
    t.ac.onBlur(e);
  }

};
Template.inputAutocomplete.events(acEvents);
Template.textareaAutocomplete.events(acEvents);

const attributes = function () {
  return _.omit(this, 'settings'); // Render all but the settings parameter
};

const autocompleteHelpers = {
  attributes,
  autocompleteContainer: new Template('AutocompleteContainer', function () {
    const ac = new AutoComplete(Blaze.getData().settings); // Set the autocomplete object on the parent template instance

    this.parentView.templateInstance().ac = ac; // Set nodes on render in the autocomplete class

    this.onViewReady(function () {
      ac.element = this.parentView.firstNode();
      ac.$element = $(ac.element);
    });
    return Blaze.With(ac, function () {
      //eslint-disable-line
      return Template._autocompleteContainer;
    });
  })
};
Template.inputAutocomplete.helpers(autocompleteHelpers);
Template.textareaAutocomplete.helpers(autocompleteHelpers);

Template._autocompleteContainer.rendered = function () {
  this.data.tmplInst = this;
};

Template._autocompleteContainer.destroyed = function () {
  // Meteor._debug "autocomplete destroyed"
  this.data.teardown();
};
/*
  List rendering helpers
 */


Template._autocompleteContainer.events({
  // t.data is the AutoComplete instance; `this` is the data item
  'click .-autocomplete-item, click [data-autocomplete]'(e, t) {
    t.data.onItemClick(this, e);
  },

  'mouseenter .-autocomplete-item'(e, t) {
    t.data.onItemHover(this, e);
  }

});

Template._autocompleteContainer.helpers({
  empty() {
    return this.filteredList().count() === 0;
  },

  noMatchTemplate() {
    return this.matchedRule().noMatchTemplate || Template._noMatch;
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"oembed":{"client":{"baseWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/baseWidget.html                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.baseWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.baseWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.baseWidget.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedBaseWidget");
Template["oembedBaseWidget"] = new Template("Template.oembedBaseWidget", (function() {
  var view = this;
  return Blaze._TemplateWith(function() {
    return {
      template: Spacebars.call(view.lookup("template"))
    };
  }, function() {
    return Spacebars.include(function() {
      return Spacebars.call(Template.__dynamic);
    });
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedAudioWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedAudioWidget.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedAudioWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedAudioWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedAudioWidget.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedAudioWidget");
Template["oembedAudioWidget"] = new Template("Template.oembedAudioWidget", (function() {
  var view = this;
  return HTML.A({
    href: function() {
      return Spacebars.mustache(view.lookup("url"));
    },
    rel: "noopener noreferrer",
    target: "_blank"
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("parsedUrl"));
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        collapsedMedia: Spacebars.call(view.lookup("collapsedMediaVar"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("collapseArrow"));
    }), "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("collapsed"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.SPAN({
        class: "collapse-switch icon-down-dir",
        "data-index": function() {
          return Spacebars.mustache(view.lookup("index"));
        },
        "data-collapsed": function() {
          return Spacebars.mustache(view.lookup("collapsed"));
        }
      }), "\n\t\t\t\t", HTML.BLOCKQUOTE({
        class: "message-oembed background-transparent-darker-before"
      }, "\n\t\t\t\t\t", HTML.AUDIO({
        controls: ""
      }, "\n\t\t\t\t\t\t", HTML.SOURCE({
        src: function() {
          return Spacebars.mustache(view.lookup("url"));
        },
        rel: "noopener noreferrer",
        type: function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("headers"), "contentType"));
        }
      }), "\n\t\t\t\t\t\tYour browser does not support the audio element.\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedFrameWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedFrameWidget.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedFrameWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedFrameWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedFrameWidget.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedFrameWidget");
Template["oembedFrameWidget"] = new Template("Template.oembedFrameWidget", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("parsedUrl"));
  }, function() {
    return [ "\n\t", HTML.BLOCKQUOTE({
      class: "message-oembed background-transparent-darker-before"
    }, "\n\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedProviderName"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedProviderUrl"));
      }, function() {
        return [ "\n\t\t\t\t", HTML.A({
          href: function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedProviderUrl"));
          },
          rel: "noopener noreferrer",
          target: "_blank",
          style: "color: #9e9ea6"
        }, Blaze.View("lookup:meta.oembedProviderName", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedProviderName"));
        })), "\n\t\t\t" ];
      }), "\n\t\t" ];
    }), "\n\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedAuthorName"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedAuthorUrl"));
      }, function() {
        return [ HTML.Raw('\n\t\t\t\t<br class="only-after-a">\n\t\t\t\t'), HTML.A({
          href: function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedAuthorUrl"));
          },
          rel: "noopener noreferrer",
          target: "_blank"
        }, Blaze.View("lookup:meta.oembedAuthorName", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedAuthorName"));
        })), "\n\t\t\t" ];
      }), "\n\t\t" ];
    }), "\n\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedTitle"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedUrl"));
      }, function() {
        return [ HTML.Raw('\n\t\t\t\t<br class="only-after-a">\n\t\t\t\t'), HTML.A({
          href: function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedUrl"));
          },
          rel: "noopener noreferrer",
          target: "_blank"
        }, Blaze.View("lookup:meta.oembedTitle", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedTitle"));
        })), "\n\t\t\t" ];
      }), "\n\t\t" ];
    }), "\n\t\t", Blaze._TemplateWith(function() {
      return {
        collapsedMedia: Spacebars.call(view.lookup("collapsedMediaVar"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("collapseArrow"));
    }), HTML.Raw(" <br>\n\t\t"), Blaze.Unless(function() {
      return Spacebars.call(view.lookup("collapsed"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedDescription"));
      }, function() {
        return [ "\n\t\t\t\t", HTML.P(Blaze.View("lookup:meta.oembedDescription", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedDescription"));
        })), "\n\t\t\t" ];
      }), "\n\t\t\t", Blaze.View("lookup:meta.oembedHtml", function() {
        return Spacebars.makeRaw(Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedHtml")));
      }), "\n\t\t" ];
    }), "\n\t"), "\n" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedImageWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedImageWidget.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedImageWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedImageWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedImageWidget.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedImageWidget");
Template["oembedImageWidget"] = new Template("Template.oembedImageWidget", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("parsedUrl"));
  }, function() {
    return [ "\n\t\t", Blaze._TemplateWith(function() {
      return {
        collapsedMedia: Spacebars.call(view.lookup("collapsedMediaVar"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("collapseArrow"));
    }), HTML.Raw(" <br>\n\t\t"), Blaze.Unless(function() {
      return Spacebars.call(view.lookup("collapsed"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("loadImage"));
      }, function() {
        return [ "\n\t\t\t\t", HTML.FIGURE("\n\t\t\t\t\t", HTML.DIV({
          class: "inline-image",
          style: function() {
            return [ "background-image: url('", Spacebars.mustache(view.lookup("url")), "');" ];
          }
        }, "\n\t\t\t\t\t\t", HTML.IMG({
          src: function() {
            return Spacebars.mustache(view.lookup("url"));
          },
          rel: "noopener noreferrer",
          height: "200",
          class: "gallery-item"
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t", HTML.DIV({
          class: "image-to-download",
          "data-url": function() {
            return Spacebars.mustache(view.lookup("url"));
          }
        }, HTML.Raw('\n\t\t\t\t\t<i class="icon-picture"></i>\n\t\t\t\t\t<div>click to load</div>\n\t\t\t\t')), "\n\t\t\t" ];
      }), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedUrlWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedUrlWidget.html                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedUrlWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedUrlWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedUrlWidget.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedUrlWidget");
Template["oembedUrlWidget"] = new Template("Template.oembedUrlWidget", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("show"));
  }, function() {
    return [ "\n\t\t", HTML.BLOCKQUOTE({
      class: "message-oembed background-transparent-darker-before"
    }, "\n\t\t\t", HTML.DIV({
      style: function() {
        return [ Blaze.If(function() {
          return Spacebars.call(view.lookup("image"));
        }, function() {
          return "min-height: 80px;";
        }), " padding: 10px 3px;" ];
      }
    }, "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("image"));
    }, function() {
      return [ "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("meta"), "ogImageUserGenerated"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t", HTML.A({
          href: function() {
            return Spacebars.mustache(view.lookup("url"));
          },
          rel: "noopener noreferrer",
          target: function() {
            return Spacebars.mustache(view.lookup("target"));
          }
        }, "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("meta"), "ogImage"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t\t", HTML.IMG({
            src: function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "ogImage"));
            },
            rel: "noopener noreferrer",
            height: "200"
          }), "\n\t\t\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t\t", HTML.IMG({
            src: function() {
              return Spacebars.mustache(view.lookup("image"));
            },
            rel: "noopener noreferrer",
            height: "200"
          }), "\n\t\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.A({
          href: function() {
            return Spacebars.mustache(view.lookup("url"));
          },
          rel: "noopener noreferrer",
          target: function() {
            return Spacebars.mustache(view.lookup("target"));
          }
        }, "\n\t\t\t\t\t\t\t", HTML.IMG({
          src: function() {
            return Spacebars.mustache(view.lookup("image"));
          },
          rel: "noopener noreferrer",
          height: "60",
          align: "left",
          style: "margin-right: 10px;"
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t\t", HTML.DIV({
      style: "color: #AAA;"
    }, Blaze.View("lookup:parsedUrl.host", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("parsedUrl"), "host"));
    })), "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("title"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t", HTML.A({
        href: function() {
          return Spacebars.mustache(view.lookup("url"));
        },
        rel: "noopener noreferrer",
        target: function() {
          return Spacebars.mustache(view.lookup("target"));
        }
      }, HTML.STRONG(Blaze.View("lookup:title", function() {
        return Spacebars.makeRaw(Spacebars.mustache(view.lookup("title")));
      }))), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }), "\n\t\t\t\t", HTML.DIV(Blaze.View("lookup:description", function() {
      return Spacebars.mustache(view.lookup("description"));
    })), "\n\t\t\t"), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedVideoWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedVideoWidget.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedVideoWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedVideoWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedVideoWidget.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedVideoWidget");
Template["oembedVideoWidget"] = new Template("Template.oembedVideoWidget", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("parsedUrl"));
  }, function() {
    return [ "\n\t", HTML.BLOCKQUOTE({
      class: "message-oembed background-transparent-darker-before"
    }, "\n\t\t", HTML.DIV(HTML.A({
      href: function() {
        return Spacebars.mustache(view.lookup("url"));
      },
      rel: "noopener noreferrer",
      target: "_blank"
    }, Blaze.View("lookup:parsedUrl.host", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("parsedUrl"), "host"));
    }))), "\n\t\t", HTML.SPAN(Blaze.View("lookup:title", function() {
      return Spacebars.mustache(view.lookup("title"));
    })), "\n\t\t", Blaze._TemplateWith(function() {
      return {
        collapsedMedia: Spacebars.call(view.lookup("collapsedMediaVar"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("collapseArrow"));
    }), HTML.Raw(" <br>\n\t\t"), Blaze.Unless(function() {
      return Spacebars.call(view.lookup("collapsed"));
    }, function() {
      return [ "\n\t\t\t", HTML.VIDEO({
        controls: "",
        class: "inline-video"
      }, "\n\t\t\t\t", HTML.SOURCE({
        src: function() {
          return Spacebars.mustache(view.lookup("url"));
        },
        rel: "noopener noreferrer",
        type: function() {
          return Spacebars.mustache(view.lookup("contentType"));
        }
      }), "\n\t\t\t\tYour browser does not support the video element.\n\t\t\t"), "\n\t\t" ];
    }), "\n\t"), "\n" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedYoutubeWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedYoutubeWidget.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedYoutubeWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedYoutubeWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedYoutubeWidget.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedYoutubeWidget");
Template["oembedYoutubeWidget"] = new Template("Template.oembedYoutubeWidget", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("parsedUrl"));
  }, function() {
    return [ "\n\t\t", HTML.BLOCKQUOTE({
      class: "message-oembed background-transparent-darker-before"
    }, "\n\t\t\t", HTML.A({
      href: function() {
        return Spacebars.mustache(view.lookup("url"));
      },
      rel: "noopener noreferrer",
      target: "_blank"
    }, Blaze.View("lookup:parsedUrl.host", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("parsedUrl"), "host"));
    })), "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        collapsedMedia: Spacebars.call(view.lookup("collapsedMediaVar"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("collapseArrow"));
    }), HTML.Raw(" <br>\n\t\t\t"), Blaze.Unless(function() {
      return Spacebars.call(view.lookup("collapsed"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.IFRAME({
        width: "270",
        height: "200",
        src: function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "twitterPlayer"));
        },
        rel: "noopener noreferrer",
        frameborder: "0",
        allowfullscreen: ""
      }), HTML.Raw("<br>\n\t\t\t\t"), Blaze.View("lookup:meta.description", function() {
        return Spacebars.makeRaw(Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "description")));
      }), "\n\t\t\t" ];
    }), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"baseWidget.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/baseWidget.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let createCollapseable;
module.link("../../ui-utils", {
  createCollapseable(v) {
    createCollapseable = v;
  }

}, 1);
createCollapseable(Template.oembedBaseWidget, instance => instance.data.settings.collapseMediaByDefault || false);
Template.oembedBaseWidget.helpers({
  template() {
    var _this$headers, _this$headers$content, _this$headers2, _this$headers2$conten, _this$headers3, _this$headers3$conten, _this$meta, _this$meta$twitterPla, _this$meta2;

    const {
      collapsedMedia
    } = Template.instance();

    this.collapsedMediaVar = () => collapsedMedia;

    this.collapsed = collapsedMedia.get();

    if ((_this$headers = this.headers) !== null && _this$headers !== void 0 && (_this$headers$content = _this$headers.contentType) !== null && _this$headers$content !== void 0 && _this$headers$content.match(/image\/.*/)) {
      return 'oembedImageWidget';
    }

    if ((_this$headers2 = this.headers) !== null && _this$headers2 !== void 0 && (_this$headers2$conten = _this$headers2.contentType) !== null && _this$headers2$conten !== void 0 && _this$headers2$conten.match(/audio\/.*/)) {
      return 'oembedAudioWidget';
    }

    if ((_this$headers3 = this.headers) !== null && _this$headers3 !== void 0 && (_this$headers3$conten = _this$headers3.contentType) !== null && _this$headers3$conten !== void 0 && _this$headers3$conten.match(/video\/.*/) || (_this$meta = this.meta) !== null && _this$meta !== void 0 && (_this$meta$twitterPla = _this$meta.twitterPlayerStreamContentType) !== null && _this$meta$twitterPla !== void 0 && _this$meta$twitterPla.match(/video\/.*/)) {
      return 'oembedVideoWidget';
    }

    if ((_this$meta2 = this.meta) !== null && _this$meta2 !== void 0 && _this$meta2.oembedHtml) {
      return 'oembedFrameWidget';
    }

    return 'oembedUrlWidget';
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./baseWidget.html");
module.link("./baseWidget");
module.link("./oembedImageWidget.html");
module.link("./oembedImageWidget");
module.link("./oembedAudioWidget.html");
module.link("./oembedVideoWidget.html");
module.link("./oembedVideoWidget");
module.link("./oembedYoutubeWidget.html");
module.link("./oembedUrlWidget.html");
module.link("./oembedUrlWidget");
module.link("./oembedFrameWidget.html");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedImageWidget.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedImageWidget.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let getUserPreference;
module.link("../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 2);
Template.oembedImageWidget.helpers({
  loadImage() {
    if (getUserPreference(Meteor.userId(), 'autoImageLoad') === false && this.downloadImages == null) {
      return false;
    }

    if (Meteor.Device.isPhone() && getUserPreference(Meteor.userId(), 'saveMobileBandwidth') && this.downloadImages == null) {
      return false;
    }

    return true;
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedUrlWidget.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedUrlWidget.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
let unescapeHTML;
module.link("@rocket.chat/string-helpers", {
  unescapeHTML(v) {
    unescapeHTML = v;
  }

}, 3);

const getTitle = function (self) {
  if (self.meta == null) {
    return;
  }

  return self.meta.ogTitle || self.meta.twitterTitle || self.meta.title || self.meta.pageTitle;
};

const getDescription = function (self) {
  if (self.meta == null) {
    return;
  }

  const description = self.meta.ogDescription || self.meta.twitterDescription || self.meta.description;

  if (description == null) {
    return;
  }

  return unescapeHTML(description.replace(/(^[“\s]*)|([”\s]*$)/g, ''));
};

Template.oembedUrlWidget.helpers({
  description() {
    const description = getDescription(this);

    if (_.isString(description)) {
      return description;
    }
  },

  title() {
    const title = getTitle(this);

    if (_.isString(title)) {
      return Blaze._escape(title);
    }
  },

  target() {
    if (!(this.parsedUrl && this.parsedUrl.host) || !(document && document.location && document.location.host) || this.parsedUrl && this.parsedUrl.host !== document.location.host) {
      return '_blank';
    }
  },

  image() {
    if (this.meta == null) {
      return;
    }

    let decodedOgImage;

    if (this.meta.ogImage && this.meta.ogImage.replace) {
      decodedOgImage = this.meta.ogImage.replace(/&amp;/g, '&');
    }

    let url = decodedOgImage || this.meta.twitterImage || this.meta.msapplicationTileImage;

    if (url == null) {
      return;
    }

    url = new URL(url, "".concat(this.parsedUrl.protocol, "//").concat(this.parsedUrl.host)).href;
    return url;
  },

  show() {
    return getDescription(this) != null || getTitle(this) != null;
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedVideoWidget.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedVideoWidget.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);

const getTitle = function (self) {
  if (self.meta == null) {
    return;
  }

  return self.meta.ogTitle || self.meta.twitterTitle || self.meta.title || self.meta.pageTitle;
};

Template.oembedVideoWidget.helpers({
  url() {
    if (this.meta && this.meta.twitterPlayerStream) {
      return this.meta.twitterPlayerStream;
    }

    if (this.url) {
      return this.url;
    }
  },

  contentType() {
    if (this.meta && this.meta.twitterPlayerStreamContentType) {
      return this.meta.twitterPlayerStreamContentType;
    }

    if (this.headers && this.headers.contentType) {
      return this.headers.contentType;
    }
  },

  title() {
    return getTitle(this);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"tokenpass":{"client":{"tokenChannelsList.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/tokenChannelsList.html                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.tokenChannelsList.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.tokenChannelsList.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/template.tokenChannelsList.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("tokenChannelsList");
Template["tokenChannelsList"] = new Template("Template.tokenChannelsList", (function() {
  var view = this;
  return [ HTML.Raw('<h3 class="rooms-list__type">\n\t\tToken Channels\n\t</h3>\n\t'), HTML.UL({
    class: "rooms-list__list"
  }, "\n\t\t", HTML.UL({
    class: "rooms-list__list"
  }, "\n\t\t\t", Blaze.Each(function() {
    return {
      _sequence: Spacebars.call(view.lookup("rooms")),
      _variable: "room"
    };
  }, function() {
    return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("room"));
    }, function() {
      return Spacebars.include(view.lookupTemplate("chatRoomItem"));
    }), "\n\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t", HTML.P({
      class: "rooms-list__empty-room"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "No_channels_yet");
    })), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tokenpassChannelSettings.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/tokenpassChannelSettings.html                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.tokenpassChannelSettings.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.tokenpassChannelSettings.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/template.tokenpassChannelSettings.js                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("channelSettings__tokenpass");
Template["channelSettings__tokenpass"] = new Template("Template.channelSettings__tokenpass", (function() {
  var view = this;
  return HTML.LI({
    class: function() {
      return [ "channelSettings-tokenpass setting-block ", Spacebars.mustache(view.lookup("editing")) ];
    }
  }, HTML.Raw('\n\t\t<div class="header">\n\t\t\t<button type="button" class="rc-button rc-button--secondary edit js-edit">\n\t\t\t\t<i class="icon-pencil"></i>\n\t\t\t</button>\n\n\t\t\t<label>Tokenpass</label>\n\t\t</div>\n\t\t'), HTML.DIV({
    class: "details"
  }, "\n\t\t\t", HTML.DIV({
    class: "boolean"
  }, "\n\t\t\t\t", HTML.LABEL(Blaze.View("lookup:requiredLabel", function() {
    return Spacebars.mustache(view.lookup("requiredLabel"));
  })), "\n\t\t\t\t", HTML.DIV({
    class: "setting-block"
  }, "\n\t\t\t\t\t", HTML.DIV({
    class: "input checkbox toggle"
  }, "\n\t\t\t\t\t\t", HTML.INPUT(HTML.Attrs({
    type: "checkbox",
    id: "requireAllTokens",
    name: "requireAllTokens"
  }, function() {
    return Spacebars.attrMustache(view.lookup("requiredChecked"));
  }, function() {
    return Spacebars.attrMustache(view.lookup("requiredDisabled"));
  })), HTML.Raw('\n\t\t\t\t\t\t<label for="requireAllTokens"></label>\n\t\t\t\t\t')), "\n\t\t\t\t"), "\n\t\t\t"), "\n\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("list"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.UL({
      class: "chip-container"
    }, "\n\t\t\t\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("list"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.LI({
        class: "js-remove",
        title: function() {
          return [ "balance: ", Spacebars.mustache(view.lookup("balance")) ];
        },
        "aria-label": function() {
          return [ Spacebars.mustache(view.lookup("token")), " ", Spacebars.mustache(view.lookup("balance")) ];
        }
      }, Blaze.If(function() {
        return Spacebars.call(view.lookup("editing"));
      }, function() {
        return HTML.Raw('<i class="icon-cancel-circled"></i>');
      }), Blaze.View("lookup:token", function() {
        return Spacebars.mustache(view.lookup("token"));
      })), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("editing"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.FORM({
      class: "channelSettings-tokenpass__form"
    }, "\n\t\t\t\t\t", HTML.INPUT({
      type: "text",
      name: "token",
      class: "channelSettings-tokenpass__input content-background-color editing",
      placeholder: function() {
        return Spacebars.mustache(view.lookup("_"), "Token_required");
      }
    }), "\n\t\t\t\t\t", HTML.INPUT({
      type: "number",
      min: "0",
      name: "balance",
      class: "channelSettings-tokenpass__input content-background-color editing",
      placeholder: function() {
        return Spacebars.mustache(view.lookup("_"), "Minimum_balance");
      }
    }), "\n\t\t\t\t\t", HTML.BUTTON(HTML.Attrs({
      type: "button",
      class: "rc-button rc-button--secondary js-add",
      title: function() {
        return Spacebars.mustache(view.lookup("_"), "Add");
      }
    }, function() {
      return Spacebars.attrMustache(view.lookup("addDisabled"));
    }), HTML.Raw('<i class="icon-plus"></i>')), "\n\t\t\t\t\t", HTML.BUTTON({
      type: "button",
      class: "rc-button rc-button--secondary js-cancel",
      title: function() {
        return Spacebars.mustache(view.lookup("_"), "Cancel");
      }
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Cancel");
    })), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("save"));
    }, function() {
      return HTML.BUTTON({
        type: "button",
        class: "rc-button rc-button--primary js-save"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Save");
      }));
    }), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"channelSettings.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/channelSettings.css                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./startup");
module.link("./roomType");
module.link("./tokenChannelsList.html");
module.link("./tokenChannelsList");
module.link("./tokenpassChannelSettings.html");
module.link("./tokenpassChannelSettings");
module.link("./login-button.css");
module.link("./channelSettings.css");
module.link("./styles.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/login-button.css                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/roomType.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let roomTypes, RoomTypeConfig;
module.link("../../utils", {
  roomTypes(v) {
    roomTypes = v;
  },

  RoomTypeConfig(v) {
    RoomTypeConfig = v;
  }

}, 1);

class TokenPassRoomType extends RoomTypeConfig {
  constructor() {
    super({
      identifier: 'tokenpass',
      order: 1
    });
    this.customTemplate = 'tokenChannelsList';
  }

  condition() {
    const user = Meteor.users.findOne(Meteor.userId(), {
      fields: {
        'services.tokenpass': 1
      }
    });
    const hasTokenpass = !!(user && user.services && user.services.tokenpass);
    return hasTokenpass;
  }

}

roomTypes.add(new TokenPassRoomType());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/startup.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ChannelSettings;
module.link("../../channel-settings", {
  ChannelSettings(v) {
    ChannelSettings = v;
  }

}, 1);
let Rooms;
module.link("../../models", {
  Rooms(v) {
    Rooms = v;
  }

}, 2);
Meteor.startup(function () {
  ChannelSettings.addOption({
    group: ['room'],
    id: 'tokenpass',
    template: 'channelSettings__tokenpass',

    validation(data) {
      if (data && data.rid) {
        const room = Rooms.findOne(data.rid, {
          fields: {
            tokenpass: 1
          }
        });
        return room && room.tokenpass;
      }

      return false;
    }

  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"styles.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/styles.css                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tokenChannelsList.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/tokenChannelsList.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 3);
let Subscriptions;
module.link("../../models", {
  Subscriptions(v) {
    Subscriptions = v;
  }

}, 4);
Template.tokenChannelsList.helpers({
  rooms() {
    return Template.instance().tokenpassRooms.get().filter(room => Subscriptions.find({
      rid: room._id
    }).count() === 0);
  }

});
Template.tokenChannelsList.onRendered(function () {
  Tracker.autorun(c => {
    const user = Meteor.user();

    if (user && user.services && user.services.tokenpass) {
      c.stop();
      Meteor.call('findTokenChannels', (error, result) => {
        if (!error) {
          this.tokenpassRooms.set(result);
        }
      });
    }
  });
});
Template.tokenChannelsList.onCreated(function () {
  this.tokenpassRooms = new ReactiveVar([]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tokenpassChannelSettings.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/tokenpassChannelSettings.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 3);
let t;
module.link("../../utils", {
  t(v) {
    t = v;
  }

}, 4);
let ChatRoom;
module.link("../../models", {
  ChatRoom(v) {
    ChatRoom = v;
  }

}, 5);
let handleError;
module.link("../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 6);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 7);
Template.channelSettings__tokenpass.helpers({
  addDisabled() {
    const {
      balance,
      token
    } = Template.instance();
    return balance.get() && token.get() ? '' : 'disabled';
  },

  list() {
    return Template.instance().list.get();
  },

  save() {
    const {
      list,
      initial
    } = Template.instance();
    return JSON.stringify(list.get()) !== JSON.stringify(initial);
  },

  editing() {
    return Template.instance().editing.get() ? 'tokenpass__editing' : '';
  },

  requiredChecked() {
    return Template.instance().requireAll.get() ? 'checked' : '';
  },

  requiredLabel() {
    return Template.instance().requireAll.get() ? t('Require_all_tokens') : t('Require_any_token');
  },

  requiredDisabled() {
    return !Template.instance().editing.get() ? 'disabled' : '';
  },

  editDisabled() {
    return Template.instance().editing.get() ? 'disabled' : '';
  }

});
Template.channelSettings__tokenpass.onCreated(function () {
  const room = ChatRoom.findOne(this.data.rid, {
    fields: {
      tokenpass: 1
    }
  });
  this.editing = new ReactiveVar(false);
  this.initial = room.tokenpass;
  this.requireAll = new ReactiveVar(room.tokenpass.require === 'all');
  this.list = new ReactiveVar(this.initial.tokens);
  this.token = new ReactiveVar('');
  this.balance = new ReactiveVar('');
});
Template.channelSettings__tokenpass.events({
  'click .js-edit'(e, i) {
    i.editing.set(true);
  },

  'input [name=token]'(e, i) {
    i.token.set(e.target.value);
  },

  'input [name=balance]'(e, i) {
    i.balance.set(e.target.value);
  },

  'click .js-add'(e, i) {
    e.preventDefault();
    const instance = Template.instance();
    const {
      balance,
      token,
      list
    } = instance;
    list.set([...list.get().filter(t => t.token !== token), {
      token: token.get(),
      balance: balance.get()
    }]);
    [...i.findAll('input')].forEach(el => {
      el.value = '';
    });
    return balance.set('') && token.set('');
  },

  'click .js-remove'(e, instance) {
    e.preventDefault();
    const {
      list,
      editing
    } = instance;

    if (!editing.get()) {
      return;
    }

    list.set(list.get().filter(t => t.token !== this.token));
  },

  'click .js-save'(e, i) {
    e.preventDefault();
    const tokenpass = {
      require: i.find('[name=requireAllTokens]').checked ? 'all' : 'any',
      tokens: i.list.get()
    };
    Meteor.call('saveRoomSettings', this.rid, 'tokenpass', tokenpass, function (err) {
      if (err) {
        return handleError(err);
      }

      i.editing.set(false);
      i.token.set('');
      i.balance.set('');
      i.initial = tokenpass;
      [...i.findAll('input')].forEach(el => {
        el.value = '';
      });
      return dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Room_tokenpass_config_changed_successfully')
      });
    });
  },

  'click .js-cancel'(e, i) {
    e.preventDefault();
    i.editing.set(false);
    i.list.set(i.initial.tokens);
    i.token.set('');
    i.balance.set('');
    [...i.findAll('input')].forEach(el => {
      el.value = '';
    });
  },

  'change [name=requireAllTokens]'(e, instance) {
    instance.requireAll.set(e.currentTarget.checked);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/lib/common.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);
let CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth(v) {
    CustomOAuth = v;
  }

}, 3);
const config = {
  serverURL: '',
  identityPath: '/oauth/user',
  authorizePath: '/oauth/authorize',
  tokenPath: '/oauth/access-token',
  scope: 'user,tca,private-balances',
  tokenSentVia: 'payload',
  usernameField: 'username',
  mergeUsers: true,
  addAutopublishFields: {
    forLoggedInUser: ['services.tokenpass'],
    forOtherUsers: ['services.tokenpass.name']
  },
  accessTokenParam: 'access_token'
};
const Tokenpass = new CustomOAuth('tokenpass', config);

if (Meteor.isServer) {
  Meteor.startup(function () {
    settings.get('API_Tokenpass_URL', function (key, value) {
      config.serverURL = value;
      Tokenpass.configure(config);
    });
  });
} else {
  Meteor.startup(function () {
    Tracker.autorun(function () {
      if (settings.get('API_Tokenpass_URL')) {
        config.serverURL = settings.get('API_Tokenpass_URL');
        Tokenpass.configure(config);
      }
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-sidenav":{"client":{"roomList.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/roomList.html                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.roomList.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.roomList.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/template.roomList.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("roomList");
Template["roomList"] = new Template("Template.roomList", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isLivechat"));
  }, function() {
    return [ "\n\t\t", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("."));
    }, function() {
      return Spacebars.include(view.lookupTemplate("livechat"));
    }), "\n\t" ];
  }, function() {
    return [ "\n\t\t", Spacebars.With(function() {
      return Spacebars.call(view.lookup("rooms"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("shouldAppear"), view.lookup(".."), view.lookup("."));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.H3({
          class: "rooms-list__type"
        }, "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "rooms-list__type-text"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup(".."), "label"));
        })), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.UL({
          class: function() {
            return [ "rooms-list__list ", Spacebars.mustache(view.lookup("roomType"), view.lookup("..")) ];
          }
        }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(view.lookup(".")),
            _variable: "room"
          };
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
            return Spacebars.call(view.lookup("room"));
          }, function() {
            return Spacebars.include(view.lookupTemplate("chatRoomItem"));
          }), "\n\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", HTML.P({
            class: "rooms-list__empty-room"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), view.lookup("noSubscriptionText"));
          })), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"sideNav.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/sideNav.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.sideNav.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.sideNav.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/template.sideNav.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("sideNav");
Template["sideNav"] = new Template("Template.sideNav", (function() {
  var view = this;
  return [ HTML.ASIDE({
    class: function() {
      return [ "rcx-sidebar sidebar sidebar--main sidebar--", Spacebars.mustache(view.lookup("sidebarViewMode")), " ", Blaze.If(function() {
        return Spacebars.call(view.lookup("sidebarHideAvatar"));
      }, function() {
        return "sidebar--hide-avatar";
      }) ];
    },
    role: "navigation"
  }, "\n\t\t", Spacebars.include(view.lookupTemplate("sidebarHeader")), "\n\t\t", HTML.DIV({
    class: "wrapper-unread"
  }, "\n\t\t\t", HTML.DIV({
    class: "unread-rooms background-primary-action-color color-primary-action-contrast top-unread-rooms hidden"
  }, HTML.Raw('\n\t\t\t\t<i class="icon-up-big"></i> '), Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "More_unreads");
  }), "\n\t\t\t"), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "rooms-list sidebar--custom-colors",
    "aria-label": function() {
      return Spacebars.mustache(view.lookup("_"), "Channels");
    },
    role: "region"
  }, "\n\t\t\t", Spacebars.include(view.lookupTemplate("sidebarChats")), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "wrapper-unread"
  }, "\n\t\t\t", HTML.DIV({
    class: "unread-rooms background-primary-action-color color-primary-action-contrast bottom-unread-rooms hidden"
  }, HTML.Raw('\n\t\t\t\t<i class="icon-down-big"></i> '), Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "More_unreads");
  }), "\n\t\t\t"), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "flex-nav animated-hidden"
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      template: Spacebars.call(view.lookup("flexTemplate")),
      data: Spacebars.call(view.lookup("flexData"))
    };
  }, function() {
    return Spacebars.include(function() {
      return Spacebars.call(Template.__dynamic);
    });
  }), "\n\t\t"), "\n\t\t", Spacebars.include(view.lookupTemplate("sidebarFooter")), "\n\t"), HTML.Raw('\n\t<div class="sidebar-wrap"></div>') ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userPresence.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/userPresence.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.userPresence.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.userPresence.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/template.userPresence.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("userPresence");
Template["userPresence"] = new Template("Template.userPresence", (function() {
  var view = this;
  return Blaze._InOuterTemplateScope(view, function() {
    return Spacebars.include(function() {
      return Spacebars.call(view.templateContentBlock);
    });
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./sideNav.html");
module.link("./roomList.html");
module.link("./sideNav");
module.link("./roomList");
module.link("./userPresence");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomList.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/roomList.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 2);
let ChatSubscription, Rooms, Users, Subscriptions;
module.link("../../models", {
  ChatSubscription(v) {
    ChatSubscription = v;
  },

  Rooms(v) {
    Rooms = v;
  },

  Users(v) {
    Users = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 3);
let UiTextContext, getUserPreference, roomTypes;
module.link("../../utils", {
  UiTextContext(v) {
    UiTextContext = v;
  },

  getUserPreference(v) {
    getUserPreference = v;
  },

  roomTypes(v) {
    roomTypes = v;
  }

}, 4);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 5);
Template.roomList.helpers({
  rooms() {
    /*
    	modes:
    		sortby activity/alphabetical
    		merge channels into one list
    		show favorites
    		show unread
    */
    if (this.anonymous) {
      return Rooms.find({
        t: 'c'
      }, {
        sort: {
          name: 1
        }
      });
    }

    const user = Users.findOne(Meteor.userId(), {
      fields: {
        'settings.preferences.sidebarSortby': 1,
        'settings.preferences.sidebarShowFavorites': 1,
        'settings.preferences.sidebarShowUnread': 1,
        'services.tokenpass': 1,
        'messageViewMode': 1
      }
    });
    const sortBy = getUserPreference(user, 'sidebarSortby') || 'activity';
    const query = {
      open: true
    };
    const sort = {};

    if (sortBy === 'activity') {
      sort.lm = -1;
    } else {
      // alphabetical
      sort[this.identifier === 'd' && settings.get('UI_Use_Real_Name') ? 'lowerCaseFName' : 'lowerCaseName'] = /descending/.test(sortBy) ? -1 : 1;
    }

    if (this.identifier === 'unread') {
      query.alert = true;
      query.$or = [{
        hideUnreadStatus: {
          $ne: true
        }
      }, {
        unread: {
          $gt: 0
        }
      }];
      return ChatSubscription.find(query, {
        sort
      });
    }

    const favoritesEnabled = !!(settings.get('Favorite_Rooms') && getUserPreference(user, 'sidebarShowFavorites'));

    if (this.identifier === 'f') {
      query.f = favoritesEnabled;
    } else {
      let types = [this.identifier];

      if (this.identifier === 'merged') {
        types = ['c', 'p', 'd'];
      }

      if (this.identifier === 'discussion') {
        types = ['c', 'p', 'd'];
        query.prid = {
          $exists: true
        };
      }

      if (this.identifier === 'tokens') {
        types = ['c', 'p'];
      }

      if (['c', 'p'].includes(this.identifier)) {
        query.tokens = {
          $exists: false
        };
      } else if (this.identifier === 'tokens' && user && user.services && user.services.tokenpass) {
        query.tokens = {
          $exists: true
        };
      }

      if (getUserPreference(user, 'sidebarShowUnread')) {
        query.$or = [{
          alert: {
            $ne: true
          }
        }, {
          $and: [{
            hideUnreadStatus: true
          }, {
            unread: 0
          }]
        }];
      }

      query.t = {
        $in: types
      };

      if (favoritesEnabled) {
        query.f = {
          $ne: favoritesEnabled
        };
      }
    }

    return ChatSubscription.find(query, {
      sort
    });
  },

  isLivechat() {
    return this.identifier === 'l';
  },

  shouldAppear(group, rooms) {
    /*
    if is a normal group ('channel' 'private' 'direct')
    or is favorite and has one room
    or is unread and has one room
    */
    return !['unread', 'f'].includes(group.identifier) || rooms.length || rooms.count && rooms.count();
  },

  roomType(room) {
    if (room.header || room.identifier) {
      return "type-".concat(room.header || room.identifier);
    }
  },

  noSubscriptionText() {
    const instance = Template.instance();

    if (instance.data.anonymous) {
      return 'No_channels_yet';
    }

    return roomTypes.getConfig(instance.data.identifier).getUiText(UiTextContext.NO_ROOMS_SUBSCRIBED) || 'No_channels_yet';
  }

});

const getLowerCaseNames = function (room) {
  let nameDefault = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
  let fnameDefault = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
  const name = room.name || nameDefault;
  const fname = room.fname || fnameDefault || name;
  return {
    lowerCaseName: String(name).toLowerCase(),
    lowerCaseFName: String(fname).toLowerCase()
  };
};

const mergeSubRoom = subscription => {
  const options = {
    fields: {
      lm: 1,
      lastMessage: 1,
      uids: 1,
      streamingOptions: 1,
      usernames: 1,
      topic: 1,
      encrypted: 1,
      jitsiTimeout: 1,
      // autoTranslate: 1,
      // autoTranslateLanguage: 1,
      description: 1,
      announcement: 1,
      broadcast: 1,
      archived: 1,
      avatarETag: 1,
      retention: 1,
      teamId: 1,
      teamMain: 1,
      onHold: 1,
      metrics: 1,
      muted: 1,
      servedBy: 1,
      ts: 1,
      waitingResponse: 1,
      v: 1,
      transcriptRequest: 1,
      tags: 1,
      closedAt: 1,
      responseBy: 1,
      priorityId: 1,
      livechatData: 1,
      departmentId: 1,
      source: 1,
      queuedAt: 1
    }
  };
  const room = Rooms.findOne({
    _id: subscription.rid
  }, options) || {};
  const lastRoomUpdate = room.lm || subscription.ts || subscription._updatedAt;
  const {
    encrypted,
    description,
    cl,
    topic,
    announcement,
    broadcast,
    archived,
    avatarETag,
    retention,
    lastMessage,
    streamingOptions,
    teamId,
    teamMain,
    uids,
    usernames,
    jitsiTimeout,
    v,
    transcriptRequest,
    servedBy,
    onHold,
    tags,
    closedAt,
    metrics,
    muted,
    waitingResponse,
    responseBy,
    priorityId,
    livechatData,
    departmentId,
    ts,
    source,
    queuedAt
  } = room;
  subscription.lm = subscription.lr ? new Date(Math.max(subscription.lr, lastRoomUpdate)) : lastRoomUpdate;
  return Object.assign(subscription, getLowerCaseNames(subscription), {
    encrypted,
    description,
    cl,
    topic,
    announcement,
    broadcast,
    archived,
    avatarETag,
    retention,
    lastMessage,
    streamingOptions,
    teamId,
    teamMain,
    uids,
    usernames,
    jitsiTimeout,
    v,
    transcriptRequest,
    servedBy,
    onHold,
    tags,
    closedAt,
    metrics,
    muted,
    waitingResponse,
    responseBy,
    priorityId,
    livechatData,
    departmentId,
    ts,
    source,
    queuedAt
  });
};

const mergeRoomSub = room => {
  const sub = Subscriptions.findOne({
    rid: room._id
  });

  if (!sub) {
    return room;
  }

  const {
    encrypted,
    description,
    cl,
    topic,
    announcement,
    broadcast,
    archived,
    avatarETag,
    retention,
    lastMessage,
    streamingOptions,
    teamId,
    teamMain,
    uids,
    usernames,
    jitsiTimeout,
    v,
    transcriptRequest,
    servedBy,
    onHold,
    tags,
    closedAt,
    metrics,
    muted,
    waitingResponse,
    responseBy,
    priorityId,
    livechatData,
    departmentId,
    ts,
    source,
    queuedAt
  } = room;
  Subscriptions.update({
    rid: room._id
  }, {
    $set: _objectSpread({
      encrypted,
      description,
      cl,
      topic,
      announcement,
      broadcast,
      archived,
      avatarETag,
      retention,
      uids,
      usernames,
      lastMessage,
      streamingOptions,
      teamId,
      teamMain,
      v,
      transcriptRequest,
      servedBy,
      onHold,
      tags,
      closedAt,
      metrics,
      muted,
      waitingResponse,
      responseBy,
      priorityId,
      livechatData,
      departmentId,
      jitsiTimeout,
      ts,
      source,
      queuedAt
    }, getLowerCaseNames(room, sub.name, sub.fname))
  });
  Subscriptions.update({
    rid: room._id,
    lm: {
      $lt: room.lm
    }
  }, {
    $set: {
      lm: room.lm
    }
  });
  return room;
};

callbacks.add('cachedCollection-received-rooms', mergeRoomSub);
callbacks.add('cachedCollection-sync-rooms', mergeRoomSub);
callbacks.add('cachedCollection-loadFromServer-rooms', mergeRoomSub);
callbacks.add('cachedCollection-received-subscriptions', mergeSubRoom);
callbacks.add('cachedCollection-sync-subscriptions', mergeSubRoom);
callbacks.add('cachedCollection-loadFromServer-subscriptions', mergeSubRoom);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"sideNav.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/sideNav.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 3);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 4);
let SideNav, menu;
module.link("../../ui-utils", {
  SideNav(v) {
    SideNav = v;
  },

  menu(v) {
    menu = v;
  }

}, 5);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 6);
let roomTypes, getUserPreference;
module.link("../../utils", {
  roomTypes(v) {
    roomTypes = v;
  },

  getUserPreference(v) {
    getUserPreference = v;
  }

}, 7);
let Users;
module.link("../../models", {
  Users(v) {
    Users = v;
  }

}, 8);
Template.sideNav.helpers({
  flexTemplate() {
    return SideNav.getFlex().template;
  },

  flexData() {
    return SideNav.getFlex().data;
  },

  roomType() {
    return roomTypes.getTypes().map(roomType => ({
      template: roomType.customTemplate || 'roomList',
      data: {
        header: roomType.header,
        identifier: roomType.identifier,
        isCombined: roomType.isCombined,
        label: roomType.label
      }
    }));
  },

  loggedInUser() {
    return !!Meteor.userId();
  },

  sidebarViewMode() {
    const viewMode = getUserPreference(Meteor.userId(), 'sidebarViewMode');
    return viewMode || 'condensed';
  },

  sidebarHideAvatar() {
    return !getUserPreference(Meteor.userId(), 'sidebarDisplayAvatar');
  }

});
Template.sideNav.events({
  'click .close-flex'() {
    return SideNav.closeFlex();
  },

  'click .arrow'() {
    return SideNav.toggleCurrent();
  },

  'scroll .rooms-list'() {
    return menu.updateUnreadBars();
  },

  'dropped .sidebar'(e) {
    return e.preventDefault();
  },

  'mouseenter .sidebar-item__link'(e) {
    const element = e.currentTarget;
    setTimeout(() => {
      const ellipsedElement = element.querySelector('.sidebar-item__ellipsis');
      const isTextEllipsed = ellipsedElement.offsetWidth < ellipsedElement.scrollWidth;

      if (isTextEllipsed) {
        element.setAttribute('title', element.getAttribute('aria-label'));
      } else {
        element.removeAttribute('title');
      }
    }, 0);
  }

});

const redirectToDefaultChannelIfNeeded = () => {
  const needToBeRedirect = () => ['/', '/home'].includes(FlowRouter.current().path);

  Tracker.autorun(c => {
    const firstChannelAfterLogin = settings.get('First_Channel_After_Login');

    if (!needToBeRedirect()) {
      return c.stop();
    }

    if (!firstChannelAfterLogin) {
      return c.stop();
    }

    const room = roomTypes.findRoom('c', firstChannelAfterLogin, Meteor.userId());

    if (!room) {
      return;
    }

    c.stop();
    FlowRouter.go("/channel/".concat(firstChannelAfterLogin));
  });
};

Template.sideNav.onRendered(function () {
  SideNav.init();
  menu.init();
  redirectToDefaultChannelIfNeeded();
  return Meteor.defer(() => menu.updateUnreadBars());
});
Template.sideNav.onCreated(function () {
  this.groupedByType = new ReactiveVar(false);
  this.autorun(() => {
    const user = Users.findOne(Meteor.userId(), {
      fields: {
        'settings.preferences.sidebarGroupByType': 1
      }
    });
    const userPref = getUserPreference(user, 'sidebarGroupByType');
    this.groupedByType.set(userPref || settings.get('UI_Group_Channels_By_Type'));
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userPresence.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/userPresence.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let Presence;
module.link("../../../client/lib/presence", {
  Presence(v) {
    Presence = v;
  }

}, 4);
module.link("./userPresence.html");
const data = new Map();
const options = {
  threshold: 0.1
};
let lastEntries = [];

const handleEntries = function (entries) {
  lastEntries = entries.filter(_ref => {
    let {
      isIntersecting
    } = _ref;
    return isIntersecting;
  });
  lastEntries.forEach(async entry => {
    const {
      uid
    } = data.get(entry.target);
    Presence.get(uid);
  });
};

const featureExists = !!window.IntersectionObserver;
const observer = featureExists && new IntersectionObserver(handleEntries, options);
Tracker.autorun(() => {
  // Only clear statuses on disconnect, prevent process it on reconnect again
  const isConnected = Meteor.status().connected;

  if (!Meteor.userId() || !isConnected) {
    Presence.reset();
    return Meteor.users.update({
      status: {
        $exists: true
      }
    }, {
      $unset: {
        status: true
      }
    }, {
      multi: true
    });
  }

  Presence.restart();

  if (featureExists) {
    for (const node of data.keys()) {
      observer.unobserve(node);
      observer.observe(node);
    }

    return;
  }

  Accounts.onLogout(() => {
    Presence.reset();
  });
});
Template.userPresence.onRendered(function () {
  if (!this.data || !this.data.uid) {
    return;
  }

  data.set(this.firstNode, this.data);

  if (featureExists) {
    return observer.observe(this.firstNode);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-vrecord":{"client":{"vrecord.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/vrecord.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.vrecord.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.vrecord.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/template.vrecord.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("vrecDialog");
Template["vrecDialog"] = new Template("Template.vrecDialog", (function() {
  var view = this;
  return HTML.DIV({
    class: "rc-old vrec-dialog secondary-background-color"
  }, HTML.Raw('\n\t\t<div class="video-container">\n\t\t\t<video width="320" height="240" src=""></video>\n\t\t</div>\n\t\t'), HTML.DIV({
    class: "buttons"
  }, "\n\t\t\t", HTML.BUTTON(HTML.Attrs({
    class: function() {
      return [ "rc-button rc-button--primary record rc-button--small ", Spacebars.mustache(view.lookup("recordDisabled")) ];
    }
  }, function() {
    return Spacebars.attrMustache(view.lookup("recordDisabled"));
  }), "\n\t\t\t\t", HTML.I({
    class: function() {
      return Spacebars.mustache(view.lookup("recordIcon"));
    }
  }), HTML.SPAN(Blaze.View("lookup:time", function() {
    return Spacebars.mustache(view.lookup("time"));
  })), "\n\t\t\t"), "\n\t\t\t", HTML.SPAN({
    class: "buttons__wrapper"
  }, "\n\t\t\t\t", HTML.BUTTON({
    class: "rc-button rc-button--nude rc-button--small cancel"
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Cancel");
  })), "\n\t\t\t\t", HTML.BUTTON(HTML.Attrs({
    class: function() {
      return [ "rc-button rc-button--primary rc-button--small ok ", Spacebars.mustache(view.lookup("okDisabled")) ];
    }
  }, function() {
    return Spacebars.attrMustache(view.lookup("okDisabled"));
  }), Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Ok");
  })), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"VRecDialog.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/VRecDialog.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  VRecDialog: () => VRecDialog
});
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let VideoRecorder;
module.link("../../ui", {
  VideoRecorder(v) {
    VideoRecorder = v;
  }

}, 2);
const VRecDialog = new class {
  constructor() {
    this.opened = false;
    this.dialogView = null;
  }

  init() {
    this.dialogView = Blaze.render(Template.vrecDialog, document.body);
  }

  open(source, _ref) {
    let {
      rid,
      tmid
    } = _ref;

    if (!this.dialogView) {
      this.init();
    }

    this.dialogView.templateInstance().update({
      rid,
      tmid,
      input: source.querySelector('.js-input-message')
    });
    this.source = source;
    const dialog = $('.vrec-dialog');
    this.dialogView.templateInstance().setPosition(dialog, source);
    dialog.addClass('show');
    this.opened = true;
    return this.initializeCamera();
  }

  close() {
    $('.vrec-dialog').removeClass('show');
    this.opened = false;

    if (this.video != null) {
      return VideoRecorder.stop();
    }
  }

  initializeCamera() {
    this.video = $('.vrec-dialog video').get('0');

    if (!this.video) {
      return;
    }

    return VideoRecorder.start(this.video);
  }

}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  VRecDialog: () => VRecDialog
});
module.link("./vrecord.html");
module.link("./vrecord");
let VRecDialog;
module.link("./VRecDialog", {
  VRecDialog(v) {
    VRecDialog = v;
  }

}, 0);
module.link("./vrecord.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"vrecord.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/vrecord.css                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"vrecord.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/vrecord.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 3);
let VRecDialog;
module.link("./VRecDialog", {
  VRecDialog(v) {
    VRecDialog = v;
  }

}, 4);
let VideoRecorder, fileUpload, UserAction, USER_ACTIVITIES;
module.link("../../ui", {
  VideoRecorder(v) {
    VideoRecorder = v;
  },

  fileUpload(v) {
    fileUpload = v;
  },

  UserAction(v) {
    UserAction = v;
  },

  USER_ACTIVITIES(v) {
    USER_ACTIVITIES = v;
  }

}, 5);
Template.vrecDialog.helpers({
  recordIcon() {
    if (VideoRecorder.cameraStarted.get() && VideoRecorder.recording.get()) {
      return 'icon-stop';
    }

    return 'icon-circle';
  },

  okDisabled() {
    if (VideoRecorder.cameraStarted.get() && VideoRecorder.recordingAvailable.get()) {
      return '';
    }

    return 'disabled';
  },

  recordDisabled() {
    return VideoRecorder.cameraStarted.get() ? '' : 'disabled';
  },

  time() {
    return Template.instance().time.get();
  }

});
const recordingInterval = new ReactiveVar(null);

const stopVideoRecording = (rid, tmid) => {
  if (recordingInterval.get()) {
    clearInterval(recordingInterval.get());
    recordingInterval.set(null);
  }

  UserAction.stop(rid, USER_ACTIVITIES.USER_RECORDING, {
    tmid
  });
};

Template.vrecDialog.events({
  'click .vrec-dialog .cancel'(e, t) {
    const rid = t.rid.get();
    const tmid = t.tmid.get();
    VideoRecorder.stop();
    VRecDialog.close();
    t.time.set('');
    stopVideoRecording(rid, tmid);
  },

  'click .vrec-dialog .record'(e, t) {
    const rid = t.rid.get();
    const tmid = t.tmid.get();

    if (VideoRecorder.recording.get()) {
      VideoRecorder.stopRecording();
      stopVideoRecording(rid, tmid);
    } else {
      VideoRecorder.record();
      UserAction.performContinuously(rid, USER_ACTIVITIES.USER_RECORDING, {
        tmid
      });
      t.time.set('00:00');
      const startTime = new Date();
      recordingInterval.set(setInterval(() => {
        const now = new Date();
        const distance = (now.getTime() - startTime.getTime()) / 1000;
        const minutes = Math.floor(distance / 60);
        const seconds = Math.floor(distance % 60);
        t.time.set("".concat(String(minutes).padStart(2, '0'), ":").concat(String(seconds).padStart(2, '0')));
      }, 1000));
    }
  },

  'click .vrec-dialog .ok'(e, instance) {
    const [rid, tmid, input] = [instance.rid.get(), instance.tmid.get(), instance.input.get()];

    const cb = blob => {
      fileUpload([{
        file: blob,
        type: 'video',
        name: "".concat(TAPi18n.__('Video record'), ".webm")
      }], input, {
        rid,
        tmid
      });
      VRecDialog.close();
    };

    VideoRecorder.stop(cb);
    instance.time.set('');
    stopVideoRecording(rid, tmid);
  }

});
Template.vrecDialog.onCreated(function () {
  this.width = 400;
  this.height = 290;
  this.rid = new ReactiveVar();
  this.tmid = new ReactiveVar();
  this.input = new ReactiveVar();
  this.time = new ReactiveVar('');

  this.update = _ref => {
    let {
      rid,
      tmid,
      input
    } = _ref;
    this.rid.set(rid);
    this.tmid.set(tmid);
    this.input.set(input);
  };

  this.setPosition = function (dialog, source) {
    let anchor = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'left';

    const _set = () => {
      const sourcePos = $(source).offset();
      let top = sourcePos.top - this.height - 5;

      if (top < 0) {
        top = 10;
      }

      if (anchor === 'left') {
        let right = window.innerWidth - (sourcePos.left + source.offsetWidth - 25);

        if (right < 0) {
          right = 10;
        }

        return dialog.css({
          top: "".concat(top, "px"),
          right: "".concat(right, "px")
        });
      }

      let left = sourcePos.left - this.width + 100;

      if (left < 0) {
        left = 10;
      }

      return dialog.css({
        top: "".concat(top, "px"),
        left: "".concat(left, "px")
      });
    };

    const set = _.debounce(_set, 2000);

    _set();

    this.remove = set;
    $(window).on('resize', set);
  };
});
Template.vrecDialog.onDestroyed(function () {
  VRecDialog.close(this.rid.get());
  $(window).off('resize', this.remove);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"webdav":{"client":{"selectWebdavAccount.html":[
  "./template.selectWebdavAccount.js"
],"template.selectWebdavAccount.js":[],"webdavFilePicker.html":[
  "./template.webdavFilePicker.js"
],"template.webdavFilePicker.js":[],"startup":{"messageBoxActions.js":[
  "meteor/meteor",
  "meteor/tracker",
  "../../../utils",
  "../../../settings",
  "../../../ui-utils",
  "../../../models/client",
  "../../../../client/lib/imperativeModal",
  "../../../../client/views/room/webdav/AddWebdavAccountModal"
],"sync.js":[
  "meteor/meteor",
  "meteor/tracker",
  "../../../utils/client",
  "../../../models/client",
  "../../../notifications/client"
]},"actionButton.js":[
  "meteor/meteor",
  "../../utils",
  "../../models/client",
  "../../settings",
  "../../ui-utils",
  "../../ui-utils/client/lib/messageArgs"
],"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webdav/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);
Meteor.startup(() => {
  Tracker.autorun(c => {
    if (!settings.get('Webdav_Integration_Enabled')) {
      return;
    }

    c.stop();
    module.dynamicImport('./startup/messageBoxActions');
    module.dynamicImport('./startup/sync');
    module.dynamicImport('./actionButton');
    module.dynamicImport('./webdavFilePicker.html');
    module.dynamicImport('./webdavFilePicker.css');
    module.dynamicImport('./webdavFilePicker');
    module.dynamicImport('./selectWebdavAccount.html');
    module.dynamicImport('./selectWebdavAccount');
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"selectWebdavAccount.js":[
  "meteor/meteor",
  "meteor/templating",
  "../../ui-utils",
  "../../utils",
  "../../models/client",
  "../../../client/lib/toast"
],"webdavFilePicker.css":[],"webdavFilePicker.js":[
  "meteor/meteor",
  "meteor/templating",
  "underscore",
  "meteor/session",
  "meteor/ui",
  "meteor/reactive-var",
  "meteor/reactive-dict",
  "../../ui/client/views/app/helpers",
  "../../ui-utils/client",
  "../../utils/client",
  "../../file-upload/client",
  "../../../client/lib/utils/call",
  "../../../client/lib/toast"
]}},"discussion":{"client":{"lib":{"messageTypes":{"discussionMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/client/lib/messageTypes/discussionMessage.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let MessageTypes;
module.link("../../../../ui-utils/client", {
  MessageTypes(v) {
    MessageTypes = v;
  }

}, 1);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'discussion-created',
    system: false,
    message: 'discussion-created',

    data(message) {
      return {
        message: "<svg class=\"rc-icon\" aria-hidden=\"true\"><use xlink:href=\"#icon-discussion\"></use></svg> ".concat(message.msg)
      };
    }

  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"createDiscussionMessageAction.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/client/createDiscussionMessageAction.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 2);
let hasPermission;
module.link("../../authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 3);
let MessageAction;
module.link("../../ui-utils/client", {
  MessageAction(v) {
    MessageAction = v;
  }

}, 4);
let messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 5);
let roomTypes;
module.link("../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 6);
let imperativeModal;
module.link("../../../client/lib/imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 7);
let CreateDiscussion;
module.link("../../../client/components/CreateDiscussion/CreateDiscussion", {
  default(v) {
    CreateDiscussion = v;
  }

}, 8);
Meteor.startup(function () {
  Tracker.autorun(() => {
    if (!settings.get('Discussion_enabled')) {
      return MessageAction.removeButton('start-discussion');
    }

    MessageAction.addButton({
      id: 'start-discussion',
      icon: 'discussion',
      label: 'Discussion_start',
      context: ['message', 'message-mobile'],

      async action() {
        var _message$msg;

        const {
          msg: message,
          room
        } = messageArgs(this);
        imperativeModal.open({
          component: CreateDiscussion,
          props: {
            defaultParentRoom: room.prid || room._id,
            onClose: imperativeModal.close,
            parentMessageId: message._id,
            nameSuggestion: message === null || message === void 0 ? void 0 : (_message$msg = message.msg) === null || _message$msg === void 0 ? void 0 : _message$msg.substr(0, 140)
          }
        });
      },

      condition(_ref) {
        let {
          msg: {
            u: {
              _id: uid
            },
            drid,
            dcount
          },
          room,
          subscription,
          u
        } = _ref;

        if (drid || !isNaN(dcount)) {
          return false;
        }

        if (!subscription) {
          return false;
        }

        const isLivechatRoom = roomTypes.isLivechatRoom(room.t);

        if (isLivechatRoom) {
          return false;
        }

        return uid !== u._id ? hasPermission('start-discussion-other-user') : hasPermission('start-discussion');
      },

      order: 1,
      group: 'menu'
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"discussionFromMessageBox.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/client/discussionFromMessageBox.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let messageBox;
module.link("../../ui-utils/client", {
  messageBox(v) {
    messageBox = v;
  }

}, 2);
let settings;
module.link("../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let hasPermission;
module.link("../../authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 4);
let imperativeModal;
module.link("../../../client/lib/imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 5);
let CreateDiscussion;
module.link("../../../client/components/CreateDiscussion/CreateDiscussion", {
  default(v) {
    CreateDiscussion = v;
  }

}, 6);
Meteor.startup(function () {
  Tracker.autorun(() => {
    if (!settings.get('Discussion_enabled')) {
      return messageBox.actions.remove('Create_new', /start-discussion/);
    }

    messageBox.actions.add('Create_new', 'Discussion', {
      id: 'start-discussion',
      icon: 'discussion',
      condition: () => hasPermission('start-discussion') || hasPermission('start-discussion-other-user'),

      action(data) {
        imperativeModal.open({
          component: CreateDiscussion,
          props: {
            defaultParentRoom: data.prid || data.rid,
            onClose: imperativeModal.close
          }
        });
      }

    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/messageTypes/discussionMessage");
module.link("./createDiscussionMessageAction");
module.link("./discussionFromMessageBox");
module.link("./tabBar");
module.link("../lib/discussionRoomType");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/client/tabBar.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo, lazy;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  },

  lazy(v) {
    lazy = v;
  }

}, 0);
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
let useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 2);
const template = /*#__PURE__*/lazy(() => module.dynamicImport('../../../client/views/room/contextualBar/Discussions'));
addAction('discussions', _ref => {
  let {
    room: {
      prid
    }
  } = _ref;
  const discussionEnabled = useSetting('Discussion_enabled');
  return useMemo(() => discussionEnabled && !prid ? {
    groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
    id: 'discussions',
    title: 'Discussions',
    icon: 'discussion',
    template,
    full: true,
    order: 3
  } : null, [discussionEnabled, prid]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"discussionRoomType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/lib/discussionRoomType.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  DiscussionRoomType: () => DiscussionRoomType
});
let RoomTypeConfig, roomTypes;
module.link("../../utils", {
  RoomTypeConfig(v) {
    RoomTypeConfig = v;
  },

  roomTypes(v) {
    roomTypes = v;
  }

}, 0);

class DiscussionRoomType extends RoomTypeConfig {
  constructor() {
    super({
      identifier: 't',
      order: 25,
      label: 'Discussion'
    });
  }

}

roomTypes.add(new DiscussionRoomType());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"markdown":{"lib":{"parser":{"filtered":{"filtered.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/filtered/filtered.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  filtered: () => filtered
});

const filtered = function (message) {
  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
    supportSchemesForLink: 'http,https'
  };
  const schemes = options.supportSchemesForLink.split(',').join('|'); // Remove block code backticks

  message = message.replace(/```/g, ''); // Remove inline code backticks

  message = message.replace(new RegExp(/`([^`\r\n]+)\`/gm), match => match.substr(1, match.length - 2)); // Filter [text](url), ![alt_text](image_url)

  message = message.replace(new RegExp("!?\\[([^\\]]+)\\]\\((?:".concat(schemes, "):\\/\\/[^\\)]+\\)"), 'gm'), (match, title) => title); // Filter <http://link|Text>

  message = message.replace(new RegExp("(?:<|&lt;)(?:".concat(schemes, "):\\/\\/[^\\|]+\\|(.+?)(?=>|&gt;)(?:>|&gt;)"), 'gm'), (match, title) => title); // Filter headings

  message = message.replace(/(^#{1,4}) (([\S\w\d-_\/\*\.,\\][ \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]?)+)/gm, '$2'); // Filter bold

  message = message.replace(/(^|>|[ >_~`])\*{1,2}([^\*\r\n]+)\*{1,2}([<_~`]|\B|\b|$)/gm, '$1$2$3'); // Filter italics

  message = message.replace(/(^|>|[ >*~`])\_{1,2}([^\_\r\n]+)\_{1,2}([<*~`]|\B|\b|$)/gm, '$1$2$3'); // Filter strike-through text

  message = message.replace(/(^|>|[ >_*`])\~{1,2}([^~\r\n]+)\~{1,2}([<_*`]|\B|\b|$)/gm, '$1$2$3'); // Filter block quotes

  message = message.replace(/(?:>){3}\n+([\s\S]*?)\n+(?:<){3}/g, '$1'); // Filter > quote

  message = message.replace(/^>(.*)$/gm, '$1');
  return message;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"marked":{"marked.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/marked/marked.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  marked: () => marked
});
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 1);

let _marked;

module.link("marked", {
  default(v) {
    _marked = v;
  }

}, 2);
let createDOMPurify;
module.link("dompurify", {
  default(v) {
    createDOMPurify = v;
  }

}, 3);
let unescapeHTML, escapeHTML;
module.link("@rocket.chat/string-helpers", {
  unescapeHTML(v) {
    unescapeHTML = v;
  },

  escapeHTML(v) {
    escapeHTML = v;
  }

}, 4);
let hljs, register;
module.link("../../hljs", {
  default(v) {
    hljs = v;
  },

  register(v) {
    register = v;
  }

}, 5);
let getGlobalWindow;
module.link("../../getGlobalWindow", {
  getGlobalWindow(v) {
    getGlobalWindow = v;
  }

}, 6);
const renderer = new _marked.Renderer();
let msg = null;

renderer.code = function (code, lang, escaped) {
  if (this.options.highlight) {
    const out = this.options.highlight(code, lang);

    if (out != null && out !== code) {
      escaped = true;
      code = out;
    }
  }

  let text = null;

  if (!lang) {
    text = "<pre><code class=\"code-colors hljs\">".concat(escaped ? code : escapeHTML(code), "</code></pre>");
  } else {
    text = "<pre><code class=\"code-colors hljs ".concat(escape(lang, true), "\">").concat(escaped ? code : escapeHTML(code), "</code></pre>");
  }

  if (_.isString(msg)) {
    return text;
  }

  const token = "=!=".concat(Random.id(), "=!=");
  msg.tokens.push({
    highlight: true,
    token,
    text
  });
  return token;
};

renderer.codespan = function (text) {
  text = "<code class=\"code-colors inline\">".concat(text, "</code>");

  if (_.isString(msg)) {
    return text;
  }

  const token = "=!=".concat(Random.id(), "=!=");
  msg.tokens.push({
    token,
    text
  });
  return token;
};

renderer.blockquote = function (quote) {
  return "<blockquote class=\"background-transparent-darker-before\">".concat(quote, "</blockquote>");
};

const linkRenderer = renderer.link;

renderer.link = function (href, title, text) {
  const html = linkRenderer.call(renderer, href, title, text);
  return html.replace(/^<a /, '<a target="_blank" rel="nofollow noopener noreferrer" ');
};

const highlight = function (code, lang) {
  if (!lang) {
    return code;
  }

  try {
    register(lang);
    return hljs.highlight(lang, code).value;
  } catch (e) {
    // Unknown language
    return code;
  }
};

const marked = (message, _ref) => {
  let {
    marked: {
      gfm,
      tables,
      breaks,
      pedantic,
      smartLists,
      smartypants
    } = {}
  } = _ref;
  msg = message;

  if (!message.tokens) {
    message.tokens = [];
  }

  message.html = _marked(unescapeHTML(message.html), {
    gfm,
    tables,
    breaks,
    pedantic,
    smartLists,
    smartypants,
    renderer,
    highlight
  });
  const window = getGlobalWindow();
  const DomPurify = createDOMPurify(window);
  message.html = DomPurify.sanitize(message.html, {
    ADD_ATTR: ['target']
  });
  return message;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"original":{"code.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/original/code.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  code: () => code
});
let unescapeHTML;
module.link("@rocket.chat/string-helpers", {
  unescapeHTML(v) {
    unescapeHTML = v;
  }

}, 0);
let hljs, register;
module.link("../../hljs", {
  default(v) {
    hljs = v;
  },

  register(v) {
    register = v;
  }

}, 1);
let addAsToken;
module.link("./token", {
  addAsToken(v) {
    addAsToken = v;
  }

}, 2);

const inlinecode = message => {
  // Support `text`
  message.html = message.html.replace(/\`([^`\r\n]+)\`([<_*~]|\B|\b|$)/gm, (match, p1, p2) => addAsToken(message, "<span class=\"copyonly\">`</span><span><code class=\"code-colors inline\">".concat(p1, "</code></span><span class=\"copyonly\">`</span>").concat(p2), 'inlinecode', {
    noHtml: match
  }));
};

const codeblocks = message => {
  // Count occurencies of ```
  const count = (message.html.match(/```/gm) || []).length;

  if (count) {
    // Check if we need to add a final ```
    if (count % 2 > 0) {
      message.html = "".concat(message.html, "\n```");
      message.msg = "".concat(message.msg, "\n```");
    } // Separate text in code blocks and non code blocks


    const msgParts = message.html.split(/(^.*)(```(?:[a-zA-Z]+)?(?:(?:.|\r|\n)*?)```)(.*\n?)$/gm);

    for (let index = 0; index < msgParts.length; index++) {
      // Verify if this part is code
      const part = msgParts[index];
      const codeMatch = part.match(/^```[\r\n]*(.*[\r\n\ ]?)[\r\n]*([\s\S]*?)```+?$/);

      if (codeMatch) {
        // Process highlight if this part is code
        const singleLine = codeMatch[0].indexOf('\n') === -1;
        const lang = !singleLine && Array.from(hljs.listLanguages()).includes(codeMatch[1].trim()) ? codeMatch[1].trim() : '';
        const emptyLanguage = lang === '' ? unescapeHTML(codeMatch[1] + codeMatch[2]) : unescapeHTML(codeMatch[2]);
        const code = singleLine ? unescapeHTML(codeMatch[1]) : emptyLanguage;

        const result = (() => {
          if (lang) {
            try {
              register(lang);
              return hljs.highlight(lang, code);
            } catch (error) {
              console.error(error);
            }
          }

          return hljs.highlightAuto(lang + code);
        })();

        const token = addAsToken(message, "<pre><code class='code-colors hljs ".concat(result.language, "'><span class='copyonly'>```<br></span>").concat(result.value, "<span class='copyonly'><br>```</span></code></pre>"), 'code', {
          noHtml: codeMatch[0],
          highlight: true
        });
        msgParts[index] = token;
      } else {
        msgParts[index] = part;
      }
    } // Re-mount message


    message.html = msgParts.join('');
  }
};

const code = message => {
  var _message$html;

  if ((_message$html = message.html) !== null && _message$html !== void 0 && _message$html.trim()) {
    codeblocks(message);
    inlinecode(message);
  }

  return message;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"markdown.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/original/markdown.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  markdown: () => markdown
});
let addAsToken, isToken, validateAllowedTokens;
module.link("./token", {
  addAsToken(v) {
    addAsToken = v;
  },

  isToken(v) {
    isToken = v;
  },

  validateAllowedTokens(v) {
    validateAllowedTokens = v;
  }

}, 0);

const validateUrl = (url, message) => {
  var _message$tokens;

  // Don't render markdown inside links
  if (message !== null && message !== void 0 && (_message$tokens = message.tokens) !== null && _message$tokens !== void 0 && _message$tokens.some(token => url.includes(token.token))) {
    return false;
  } // Valid urls don't contain whitespaces


  if (/\s/.test(url.trim())) {
    return false;
  }

  try {
    new URL(url);
    return true;
  } catch (e) {
    return false;
  }
};

const endsWithWhitespace = text => text.substring(text.length - 1).match(/\s/);

const getParseableMarkersCount = (start, end) => {
  const usableMarkers = start.length > 1 ? 2 : 1;
  return end.length - usableMarkers >= 0 ? usableMarkers : 1;
};

const getTextWrapper = (marker, tagName) => (textPrepend, wrappedText, textAppend) => "".concat(textPrepend, "<span class=\"copyonly\">").concat(marker, "</span><").concat(tagName, ">").concat(wrappedText, "</").concat(tagName, "><span class=\"copyonly\">").concat(marker, "</span>").concat(textAppend);

const getRegexReplacer = (replaceFunction, getRegex) => (marker, tagName) => {
  const wrapper = getTextWrapper(marker, tagName);
  return msg => msg.replace(getRegex(marker), function () {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    return replaceFunction(wrapper, ...args);
  });
};

const getParserWithCustomMarker = getRegexReplacer((wrapper, match, p1, p2, p3) => {
  if (endsWithWhitespace(p2)) {
    return match;
  }

  const finalMarkerCount = getParseableMarkersCount(p1, p3);
  return wrapper(p1.substring(finalMarkerCount), p2, p3.substring(finalMarkerCount));
}, marker => new RegExp("(\\".concat(marker, "+(?!\\s))([^\\").concat(marker, "\\r\\n]+)(\\").concat(marker, "+)"), 'gm'));
const parseBold = getParserWithCustomMarker('*', 'strong');
const parseStrike = getParserWithCustomMarker('~', 'strike');
const parseItalic = getRegexReplacer((wrapper, match, p1, p2, p3, p4, p5) => {
  if (p1 || p5 || endsWithWhitespace(p3)) {
    return match;
  }

  const finalMarkerCount = getParseableMarkersCount(p2, p4);
  return wrapper(p2.substring(finalMarkerCount), p3, p4.substring(finalMarkerCount));
}, () => new RegExp('([^\\r\\n\\s~*_]){0,1}(\\_+(?!\\s))([^\\_\\r\\n]+)(\\_+)([^\\r\\n\\s]){0,1}', 'gm'))('_', 'em');

const parseNotEscaped = (message, _ref) => {
  let {
    supportSchemesForLink,
    headers,
    rootUrl
  } = _ref;
  let msg = message.html;

  if (!message.tokens) {
    message.tokens = [];
  }

  const schemes = (supportSchemesForLink || '').split(',').join('|');

  if (headers) {
    // Support # Text for h1
    msg = msg.replace(/^# (([\S\w\d-_\/\*\.,\\][ \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]?)+)/gm, '<h1>$1</h1>'); // Support # Text for h2

    msg = msg.replace(/^## (([\S\w\d-_\/\*\.,\\][ \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]?)+)/gm, '<h2>$1</h2>'); // Support # Text for h3

    msg = msg.replace(/^### (([\S\w\d-_\/\*\.,\\][ \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]?)+)/gm, '<h3>$1</h3>'); // Support # Text for h4

    msg = msg.replace(/^#### (([\S\w\d-_\/\*\.,\\][ \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]?)+)/gm, '<h4>$1</h4>');
  } // Support *text* to make bold


  msg = parseBold(msg); // Support _text_ to make italics

  msg = parseItalic(msg); // // Support ~text~ to strike through text

  msg = parseStrike(msg); // Support for block quote
  // >>>
  // Text
  // <<<

  msg = msg.replace(/(?:&gt;){3}\n+([\s\S]*?)\n+(?:&lt;){3}/g, '<blockquote class="background-transparent-darker-before"><span class="copyonly">&gt;&gt;&gt;</span>$1<span class="copyonly">&lt;&lt;&lt;</span></blockquote>'); // Support >Text for quote

  msg = msg.replace(/^&gt;(.*)$/gm, '<blockquote class="background-transparent-darker-before"><span class="copyonly">&gt;</span>$1</blockquote>'); // Remove white-space around blockquote (prevent <br>). Because blockquote is block element.

  msg = msg.replace(/\s*<blockquote class="background-transparent-darker-before">/gm, '<blockquote class="background-transparent-darker-before">');
  msg = msg.replace(/<\/blockquote>\s*/gm, '</blockquote>'); // Remove new-line between blockquotes.

  msg = msg.replace(/<\/blockquote>\n<blockquote/gm, '</blockquote><blockquote'); // Support ![alt text](http://image url)

  msg = msg.replace(new RegExp("!\\[([^\\]]+)\\]\\(((?:".concat(schemes, "):\\/\\/[^\\s]+)\\)"), 'gm'), (match, title, url) => {
    if (!validateUrl(url, message)) {
      return match;
    }

    if (isToken(title) && !validateAllowedTokens(message, title, ['bold', 'italic', 'strike'])) {
      return match;
    }

    url = encodeURI(url);
    const target = url.indexOf(rootUrl) === 0 ? '' : '_blank';
    return addAsToken(message, "<a data-title=\"".concat(url, "\" href=\"").concat(url, "\" title=\"").concat(title, "\" target=\"").concat(target, "\" rel=\"noopener noreferrer\"><div class=\"inline-image\" style=\"background-image: url(").concat(url, ");\"></div></a>"), 'link');
  }); // Support [Text](http://link)

  msg = msg.replace(new RegExp("\\[([^\\]]+)\\]\\(((?:".concat(schemes, "):\\/\\/[^\\s]+)\\)"), 'gm'), (match, title, url) => {
    if (!validateUrl(url, message)) {
      return match;
    }

    if (isToken(title) && !validateAllowedTokens(message, title, ['bold', 'italic', 'strike'])) {
      return match;
    }

    const target = url.indexOf(rootUrl) === 0 ? '' : '_blank';
    title = title.replace(/&amp;/g, '&');
    const escapedUrl = encodeURI(url);
    return addAsToken(message, "<a data-title=\"".concat(escapedUrl, "\" href=\"").concat(escapedUrl, "\" target=\"").concat(target, "\" rel=\"noopener noreferrer\">").concat(title, "</a>"), 'link');
  }); // Support <http://link|Text>

  msg = msg.replace(new RegExp("(?:<|&lt;)((?:".concat(schemes, "):\\/\\/[^\\|]+)\\|(.+?)(?=>|&gt;)(?:>|&gt;)"), 'gm'), (match, url, title) => {
    if (!validateUrl(url, message)) {
      return match;
    }

    if (isToken(title) && !validateAllowedTokens(message, title, ['bold', 'italic', 'strike'])) {
      return match;
    }

    url = encodeURI(url);
    const target = url.indexOf(rootUrl) === 0 ? '' : '_blank';
    return addAsToken(message, "<a data-title=\"".concat(url, "\" href=\"").concat(url, "\" target=\"").concat(target, "\" rel=\"noopener noreferrer\">").concat(title, "</a>"), 'link');
  });
  return msg;
};

const markdown = (message, options) => {
  message.html = parseNotEscaped(message, options);
  return message;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"original.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/original/original.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  original: () => original
});
let markdown;
module.link("./markdown.js", {
  markdown(v) {
    markdown = v;
  }

}, 0);
let code;
module.link("./code.js", {
  code(v) {
    code = v;
  }

}, 1);

const original = function (message) {
  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
    supportSchemesForLink: 'http,https',
    headers: true
  };
  // Parse markdown code
  message = code(message); // Parse markdown

  message = markdown(message, options); // Replace linebreak to br

  message.html = message.html.replace(/\n/gm, '<br>');
  return message;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"token.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/original/token.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  addAsToken: () => addAsToken,
  isToken: () => isToken,
  validateAllowedTokens: () => validateAllowedTokens,
  validateForbiddenTokens: () => validateForbiddenTokens
});
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 0);

const addAsToken = (message, html, type, extra) => {
  if (!message.tokens) {
    message.tokens = [];
  }

  const token = "=!=".concat(Random.id(), "=!=");
  message.tokens.push(_objectSpread({
    token,
    type,
    text: html
  }, extra && _objectSpread({}, extra)));
  return token;
};

const isToken = msg => /=!=[.a-z0-9]{17}=!=/gim.test(msg.trim());

const validateAllowedTokens = (message, id, desiredTokens) => {
  const tokens = id.match(/=!=[.a-z0-9]{17}=!=/gim) || [];
  const tokensFound = message.tokens.filter(_ref => {
    let {
      token
    } = _ref;
    return tokens.includes(token);
  });
  return tokensFound.length === 0 || tokensFound.every(token => desiredTokens.includes(token.type));
};

const validateForbiddenTokens = (message, id, desiredTokens) => {
  const tokens = id.match(/=!=[.a-z0-9]{17}=!=/gim) || [];
  const tokensFound = message.tokens.filter(_ref2 => {
    let {
      token
    } = _ref2;
    return tokens.includes(token);
  });
  return tokensFound.length === 0 || !tokensFound.some(token => desiredTokens.includes(token.type));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"getGlobalWindow.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/getGlobalWindow.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getGlobalWindow: () => getGlobalWindow
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
const {
  getGlobalWindow
} = Meteor.isServer ? require('../server/getGlobalWindow') : require('../client/getGlobalWindow');
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hljs.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/hljs.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  register: () => register
});
let hljs;
module.link("highlight.js/lib/highlight", {
  default(v) {
    hljs = v;
  }

}, 0);
let clean;
module.link("highlight.js/lib/languages/clean", {
  default(v) {
    clean = v;
  }

}, 1);
let markdown;
module.link("highlight.js/lib/languages/markdown", {
  default(v) {
    markdown = v;
  }

}, 2);
let javascript;
module.link("highlight.js/lib/languages/javascript", {
  default(v) {
    javascript = v;
  }

}, 3);
hljs.registerLanguage('markdown', markdown);
hljs.registerLanguage('clean', clean);
hljs.registerLanguage('javascript', javascript); // eslint-disable-next-line complexity

const register = async lang => {
  switch (lang) {
    case 'onec':
      return hljs.registerLanguage('onec', (await module.dynamicImport('highlight.js/lib/languages/1c')).default);

    case 'abnf':
      return hljs.registerLanguage('abnf', (await module.dynamicImport('highlight.js/lib/languages/abnf')).default);

    case 'accesslog':
      return hljs.registerLanguage('accesslog', (await module.dynamicImport('highlight.js/lib/languages/accesslog')).default);

    case 'actionscript':
      return hljs.registerLanguage('actionscript', (await module.dynamicImport('highlight.js/lib/languages/actionscript')).default);

    case 'ada':
      return hljs.registerLanguage('ada', (await module.dynamicImport('highlight.js/lib/languages/ada')).default);

    case 'apache':
      return hljs.registerLanguage('apache', (await module.dynamicImport('highlight.js/lib/languages/apache')).default);

    case 'applescript':
      return hljs.registerLanguage('applescript', (await module.dynamicImport('highlight.js/lib/languages/applescript')).default);

    case 'arduino':
      return hljs.registerLanguage('arduino', (await module.dynamicImport('highlight.js/lib/languages/arduino')).default);

    case 'armasm':
      return hljs.registerLanguage('armasm', (await module.dynamicImport('highlight.js/lib/languages/armasm')).default);

    case 'asciidoc':
      return hljs.registerLanguage('asciidoc', (await module.dynamicImport('highlight.js/lib/languages/asciidoc')).default);

    case 'aspectj':
      return hljs.registerLanguage('aspectj', (await module.dynamicImport('highlight.js/lib/languages/aspectj')).default);

    case 'autohotkey':
      return hljs.registerLanguage('autohotkey', (await module.dynamicImport('highlight.js/lib/languages/autohotkey')).default);

    case 'autoit':
      return hljs.registerLanguage('autoit', (await module.dynamicImport('highlight.js/lib/languages/autoit')).default);

    case 'avrasm':
      return hljs.registerLanguage('avrasm', (await module.dynamicImport('highlight.js/lib/languages/avrasm')).default);

    case 'awk':
      return hljs.registerLanguage('awk', (await module.dynamicImport('highlight.js/lib/languages/awk')).default);

    case 'axapta':
      return hljs.registerLanguage('axapta', (await module.dynamicImport('highlight.js/lib/languages/axapta')).default);

    case 'bash':
      return hljs.registerLanguage('bash', (await module.dynamicImport('highlight.js/lib/languages/bash')).default);

    case 'basic':
      return hljs.registerLanguage('basic', (await module.dynamicImport('highlight.js/lib/languages/basic')).default);

    case 'bnf':
      return hljs.registerLanguage('bnf', (await module.dynamicImport('highlight.js/lib/languages/bnf')).default);

    case 'brainfuck':
      return hljs.registerLanguage('brainfuck', (await module.dynamicImport('highlight.js/lib/languages/brainfuck')).default);

    case 'cal':
      return hljs.registerLanguage('cal', (await module.dynamicImport('highlight.js/lib/languages/cal')).default);

    case 'capnproto':
      return hljs.registerLanguage('capnproto', (await module.dynamicImport('highlight.js/lib/languages/capnproto')).default);

    case 'ceylon':
      return hljs.registerLanguage('ceylon', (await module.dynamicImport('highlight.js/lib/languages/ceylon')).default);

    case 'clean':
      return hljs.registerLanguage('clean', (await module.dynamicImport('highlight.js/lib/languages/clean')).default);

    case 'clojure':
      return hljs.registerLanguage('clojure', (await module.dynamicImport('highlight.js/lib/languages/clojure')).default);

    case 'clojure-repl':
      return hljs.registerLanguage('clojure-repl', (await module.dynamicImport('highlight.js/lib/languages/clojure-repl')).default);

    case 'cmake':
      return hljs.registerLanguage('cmake', (await module.dynamicImport('highlight.js/lib/languages/cmake')).default);

    case 'coffeescript':
      return hljs.registerLanguage('coffeescript', (await module.dynamicImport('highlight.js/lib/languages/coffeescript')).default);

    case 'coq':
      return hljs.registerLanguage('coq', (await module.dynamicImport('highlight.js/lib/languages/coq')).default);

    case 'cos':
      return hljs.registerLanguage('cos', (await module.dynamicImport('highlight.js/lib/languages/cos')).default);

    case 'cpp':
      return hljs.registerLanguage('cpp', (await module.dynamicImport('highlight.js/lib/languages/cpp')).default);

    case 'crmsh':
      return hljs.registerLanguage('crmsh', (await module.dynamicImport('highlight.js/lib/languages/crmsh')).default);

    case 'crystal':
      return hljs.registerLanguage('crystal', (await module.dynamicImport('highlight.js/lib/languages/crystal')).default);

    case 'cs':
      return hljs.registerLanguage('cs', (await module.dynamicImport('highlight.js/lib/languages/cs')).default);

    case 'csp':
      return hljs.registerLanguage('csp', (await module.dynamicImport('highlight.js/lib/languages/csp')).default);

    case 'css':
      return hljs.registerLanguage('css', (await module.dynamicImport('highlight.js/lib/languages/css')).default);

    case 'd':
      return hljs.registerLanguage('d', (await module.dynamicImport('highlight.js/lib/languages/d')).default);

    case 'dart':
      return hljs.registerLanguage('dart', (await module.dynamicImport('highlight.js/lib/languages/dart')).default);

    case 'delphi':
      return hljs.registerLanguage('delphi', (await module.dynamicImport('highlight.js/lib/languages/delphi')).default);

    case 'diff':
      return hljs.registerLanguage('diff', (await module.dynamicImport('highlight.js/lib/languages/diff')).default);

    case 'django':
      return hljs.registerLanguage('django', (await module.dynamicImport('highlight.js/lib/languages/django')).default);

    case 'dns':
      return hljs.registerLanguage('dns', (await module.dynamicImport('highlight.js/lib/languages/dns')).default);

    case 'dockerfile':
      return hljs.registerLanguage('dockerfile', (await module.dynamicImport('highlight.js/lib/languages/dockerfile')).default);

    case 'dos':
      return hljs.registerLanguage('dos', (await module.dynamicImport('highlight.js/lib/languages/dos')).default);

    case 'dsconfig':
      return hljs.registerLanguage('dsconfig', (await module.dynamicImport('highlight.js/lib/languages/dsconfig')).default);

    case 'dts':
      return hljs.registerLanguage('dts', (await module.dynamicImport('highlight.js/lib/languages/dts')).default);

    case 'dust':
      return hljs.registerLanguage('dust', (await module.dynamicImport('highlight.js/lib/languages/dust')).default);

    case 'ebnf':
      return hljs.registerLanguage('ebnf', (await module.dynamicImport('highlight.js/lib/languages/ebnf')).default);

    case 'elixir':
      return hljs.registerLanguage('elixir', (await module.dynamicImport('highlight.js/lib/languages/elixir')).default);

    case 'elm':
      return hljs.registerLanguage('elm', (await module.dynamicImport('highlight.js/lib/languages/elm')).default);

    case 'erb':
      return hljs.registerLanguage('erb', (await module.dynamicImport('highlight.js/lib/languages/erb')).default);

    case 'erlang':
      return hljs.registerLanguage('erlang', (await module.dynamicImport('highlight.js/lib/languages/erlang')).default);

    case 'excel':
      return hljs.registerLanguage('excel', (await module.dynamicImport('highlight.js/lib/languages/excel')).default);

    case 'fix':
      return hljs.registerLanguage('fix', (await module.dynamicImport('highlight.js/lib/languages/fix')).default);

    case 'flix':
      return hljs.registerLanguage('flix', (await module.dynamicImport('highlight.js/lib/languages/flix')).default);

    case 'fortran':
      return hljs.registerLanguage('fortran', (await module.dynamicImport('highlight.js/lib/languages/fortran')).default);

    case 'fsharp':
      return hljs.registerLanguage('fsharp', (await module.dynamicImport('highlight.js/lib/languages/fsharp')).default);

    case 'gams':
      return hljs.registerLanguage('gams', (await module.dynamicImport('highlight.js/lib/languages/gams')).default);

    case 'gauss':
      return hljs.registerLanguage('gauss', (await module.dynamicImport('highlight.js/lib/languages/gauss')).default);

    case 'gcode':
      return hljs.registerLanguage('gcode', (await module.dynamicImport('highlight.js/lib/languages/gcode')).default);

    case 'gherkin':
      return hljs.registerLanguage('gherkin', (await module.dynamicImport('highlight.js/lib/languages/gherkin')).default);

    case 'glsl':
      return hljs.registerLanguage('glsl', (await module.dynamicImport('highlight.js/lib/languages/glsl')).default);

    case 'go':
      return hljs.registerLanguage('go', (await module.dynamicImport('highlight.js/lib/languages/go')).default);

    case 'golo':
      return hljs.registerLanguage('golo', (await module.dynamicImport('highlight.js/lib/languages/golo')).default);

    case 'gradle':
      return hljs.registerLanguage('gradle', (await module.dynamicImport('highlight.js/lib/languages/gradle')).default);

    case 'groovy':
      return hljs.registerLanguage('groovy', (await module.dynamicImport('highlight.js/lib/languages/groovy')).default);

    case 'haml':
      return hljs.registerLanguage('haml', (await module.dynamicImport('highlight.js/lib/languages/haml')).default);

    case 'handlebars':
      return hljs.registerLanguage('handlebars', (await module.dynamicImport('highlight.js/lib/languages/handlebars')).default);

    case 'haskell':
      return hljs.registerLanguage('haskell', (await module.dynamicImport('highlight.js/lib/languages/haskell')).default);

    case 'haxe':
      return hljs.registerLanguage('haxe', (await module.dynamicImport('highlight.js/lib/languages/haxe')).default);

    case 'hsp':
      return hljs.registerLanguage('hsp', (await module.dynamicImport('highlight.js/lib/languages/hsp')).default);

    case 'htmlbars':
      return hljs.registerLanguage('htmlbars', (await module.dynamicImport('highlight.js/lib/languages/htmlbars')).default);

    case 'http':
      return hljs.registerLanguage('http', (await module.dynamicImport('highlight.js/lib/languages/http')).default);

    case 'hy':
      return hljs.registerLanguage('hy', (await module.dynamicImport('highlight.js/lib/languages/hy')).default);

    case 'inform7':
      return hljs.registerLanguage('inform7', (await module.dynamicImport('highlight.js/lib/languages/inform7')).default);

    case 'ini':
      return hljs.registerLanguage('ini', (await module.dynamicImport('highlight.js/lib/languages/ini')).default);

    case 'irpf90':
      return hljs.registerLanguage('irpf90', (await module.dynamicImport('highlight.js/lib/languages/irpf90')).default);

    case 'java':
      return hljs.registerLanguage('java', (await module.dynamicImport('highlight.js/lib/languages/java')).default);

    case 'javascript':
      return hljs.registerLanguage('javascript', (await module.dynamicImport('highlight.js/lib/languages/javascript')).default);

    case 'jboss-cli':
      return hljs.registerLanguage('jboss-cli', (await module.dynamicImport('highlight.js/lib/languages/jboss-cli')).default);

    case 'json':
      return hljs.registerLanguage('json', (await module.dynamicImport('highlight.js/lib/languages/json')).default);

    case 'julia':
      return hljs.registerLanguage('julia', (await module.dynamicImport('highlight.js/lib/languages/julia')).default);

    case 'julia-repl':
      return hljs.registerLanguage('julia-repl', (await module.dynamicImport('highlight.js/lib/languages/julia-repl')).default);

    case 'kotlin':
      return hljs.registerLanguage('kotlin', (await module.dynamicImport('highlight.js/lib/languages/kotlin')).default);

    case 'lasso':
      return hljs.registerLanguage('lasso', (await module.dynamicImport('highlight.js/lib/languages/lasso')).default);

    case 'ldif':
      return hljs.registerLanguage('ldif', (await module.dynamicImport('highlight.js/lib/languages/ldif')).default);

    case 'leaf':
      return hljs.registerLanguage('leaf', (await module.dynamicImport('highlight.js/lib/languages/leaf')).default);

    case 'less':
      return hljs.registerLanguage('less', (await module.dynamicImport('highlight.js/lib/languages/less')).default);

    case 'lisp':
      return hljs.registerLanguage('lisp', (await module.dynamicImport('highlight.js/lib/languages/lisp')).default);

    case 'livecodeserver':
      return hljs.registerLanguage('livecodeserver', (await module.dynamicImport('highlight.js/lib/languages/livecodeserver')).default);

    case 'livescript':
      return hljs.registerLanguage('livescript', (await module.dynamicImport('highlight.js/lib/languages/livescript')).default);

    case 'llvm':
      return hljs.registerLanguage('llvm', (await module.dynamicImport('highlight.js/lib/languages/llvm')).default);

    case 'lsl':
      return hljs.registerLanguage('lsl', (await module.dynamicImport('highlight.js/lib/languages/lsl')).default);

    case 'lua':
      return hljs.registerLanguage('lua', (await module.dynamicImport('highlight.js/lib/languages/lua')).default);

    case 'makefile':
      return hljs.registerLanguage('makefile', (await module.dynamicImport('highlight.js/lib/languages/makefile')).default);

    case 'markdown':
      return hljs.registerLanguage('markdown', (await module.dynamicImport('highlight.js/lib/languages/markdown')).default);

    case 'mathematica':
      return hljs.registerLanguage('mathematica', (await module.dynamicImport('highlight.js/lib/languages/mathematica')).default);

    case 'matlab':
      return hljs.registerLanguage('matlab', (await module.dynamicImport('highlight.js/lib/languages/matlab')).default);

    case 'maxima':
      return hljs.registerLanguage('maxima', (await module.dynamicImport('highlight.js/lib/languages/maxima')).default);

    case 'mel':
      return hljs.registerLanguage('mel', (await module.dynamicImport('highlight.js/lib/languages/mel')).default);

    case 'mercury':
      return hljs.registerLanguage('mercury', (await module.dynamicImport('highlight.js/lib/languages/mercury')).default);

    case 'mipsasm':
      return hljs.registerLanguage('mipsasm', (await module.dynamicImport('highlight.js/lib/languages/mipsasm')).default);

    case 'mizar':
      return hljs.registerLanguage('mizar', (await module.dynamicImport('highlight.js/lib/languages/mizar')).default);

    case 'perl':
      return hljs.registerLanguage('perl', (await module.dynamicImport('highlight.js/lib/languages/perl')).default);

    case 'mojolicious':
      return hljs.registerLanguage('mojolicious', (await module.dynamicImport('highlight.js/lib/languages/mojolicious')).default);

    case 'monkey':
      return hljs.registerLanguage('monkey', (await module.dynamicImport('highlight.js/lib/languages/monkey')).default);

    case 'moonscript':
      return hljs.registerLanguage('moonscript', (await module.dynamicImport('highlight.js/lib/languages/moonscript')).default);

    case 'n1ql':
      return hljs.registerLanguage('n1ql', (await module.dynamicImport('highlight.js/lib/languages/n1ql')).default);

    case 'nginx':
      return hljs.registerLanguage('nginx', (await module.dynamicImport('highlight.js/lib/languages/nginx')).default);

    case 'nimrod':
      return hljs.registerLanguage('nimrod', (await module.dynamicImport('highlight.js/lib/languages/nimrod')).default);

    case 'nix':
      return hljs.registerLanguage('nix', (await module.dynamicImport('highlight.js/lib/languages/nix')).default);

    case 'nsis':
      return hljs.registerLanguage('nsis', (await module.dynamicImport('highlight.js/lib/languages/nsis')).default);

    case 'objectivec':
      return hljs.registerLanguage('objectivec', (await module.dynamicImport('highlight.js/lib/languages/objectivec')).default);

    case 'ocaml':
      return hljs.registerLanguage('ocaml', (await module.dynamicImport('highlight.js/lib/languages/ocaml')).default);

    case 'openscad':
      return hljs.registerLanguage('openscad', (await module.dynamicImport('highlight.js/lib/languages/openscad')).default);

    case 'oxygene':
      return hljs.registerLanguage('oxygene', (await module.dynamicImport('highlight.js/lib/languages/oxygene')).default);

    case 'parser3':
      return hljs.registerLanguage('parser3', (await module.dynamicImport('highlight.js/lib/languages/parser3')).default);

    case 'pf':
      return hljs.registerLanguage('pf', (await module.dynamicImport('highlight.js/lib/languages/pf')).default);

    case 'php':
      return hljs.registerLanguage('php', (await module.dynamicImport('highlight.js/lib/languages/php')).default);

    case 'pony':
      return hljs.registerLanguage('pony', (await module.dynamicImport('highlight.js/lib/languages/pony')).default);

    case 'powershell':
      return hljs.registerLanguage('powershell', (await module.dynamicImport('highlight.js/lib/languages/powershell')).default);

    case 'processing':
      return hljs.registerLanguage('processing', (await module.dynamicImport('highlight.js/lib/languages/processing')).default);

    case 'profile':
      return hljs.registerLanguage('profile', (await module.dynamicImport('highlight.js/lib/languages/profile')).default);

    case 'prolog':
      return hljs.registerLanguage('prolog', (await module.dynamicImport('highlight.js/lib/languages/prolog')).default);

    case 'protobuf':
      return hljs.registerLanguage('protobuf', (await module.dynamicImport('highlight.js/lib/languages/protobuf')).default);

    case 'puppet':
      return hljs.registerLanguage('puppet', (await module.dynamicImport('highlight.js/lib/languages/puppet')).default);

    case 'purebasic':
      return hljs.registerLanguage('purebasic', (await module.dynamicImport('highlight.js/lib/languages/purebasic')).default);

    case 'python':
      return hljs.registerLanguage('python', (await module.dynamicImport('highlight.js/lib/languages/python')).default);

    case 'q':
      return hljs.registerLanguage('q', (await module.dynamicImport('highlight.js/lib/languages/q')).default);

    case 'qml':
      return hljs.registerLanguage('qml', (await module.dynamicImport('highlight.js/lib/languages/qml')).default);

    case 'r':
      return hljs.registerLanguage('r', (await module.dynamicImport('highlight.js/lib/languages/r')).default);

    case 'rib':
      return hljs.registerLanguage('rib', (await module.dynamicImport('highlight.js/lib/languages/rib')).default);

    case 'roboconf':
      return hljs.registerLanguage('roboconf', (await module.dynamicImport('highlight.js/lib/languages/roboconf')).default);

    case 'rsl':
      return hljs.registerLanguage('rsl', (await module.dynamicImport('highlight.js/lib/languages/rsl')).default);

    case 'ruleslanguage':
      return hljs.registerLanguage('ruleslanguage', (await module.dynamicImport('highlight.js/lib/languages/ruleslanguage')).default);

    case 'rust':
      return hljs.registerLanguage('rust', (await module.dynamicImport('highlight.js/lib/languages/rust')).default);

    case 'scala':
      return hljs.registerLanguage('scala', (await module.dynamicImport('highlight.js/lib/languages/scala')).default);

    case 'scheme':
      return hljs.registerLanguage('scheme', (await module.dynamicImport('highlight.js/lib/languages/scheme')).default);

    case 'scilab':
      return hljs.registerLanguage('scilab', (await module.dynamicImport('highlight.js/lib/languages/scilab')).default);

    case 'scss':
      return hljs.registerLanguage('scss', (await module.dynamicImport('highlight.js/lib/languages/scss')).default);

    case 'shell':
      return hljs.registerLanguage('shell', (await module.dynamicImport('highlight.js/lib/languages/shell')).default);

    case 'smali':
      return hljs.registerLanguage('smali', (await module.dynamicImport('highlight.js/lib/languages/smali')).default);

    case 'smalltalk':
      return hljs.registerLanguage('smalltalk', (await module.dynamicImport('highlight.js/lib/languages/smalltalk')).default);

    case 'sml':
      return hljs.registerLanguage('sml', (await module.dynamicImport('highlight.js/lib/languages/sml')).default);

    case 'sqf':
      return hljs.registerLanguage('sqf', (await module.dynamicImport('highlight.js/lib/languages/sqf')).default);

    case 'sql':
      return hljs.registerLanguage('sql', (await module.dynamicImport('highlight.js/lib/languages/sql')).default);

    case 'stan':
      return hljs.registerLanguage('stan', (await module.dynamicImport('highlight.js/lib/languages/stan')).default);

    case 'stata':
      return hljs.registerLanguage('stata', (await module.dynamicImport('highlight.js/lib/languages/stata')).default);

    case 'step21':
      return hljs.registerLanguage('step21', (await module.dynamicImport('highlight.js/lib/languages/step21')).default);

    case 'stylus':
      return hljs.registerLanguage('stylus', (await module.dynamicImport('highlight.js/lib/languages/stylus')).default);

    case 'subunit':
      return hljs.registerLanguage('subunit', (await module.dynamicImport('highlight.js/lib/languages/subunit')).default);

    case 'swift':
      return hljs.registerLanguage('swift', (await module.dynamicImport('highlight.js/lib/languages/swift')).default);

    case 'taggerscript':
      return hljs.registerLanguage('taggerscript', (await module.dynamicImport('highlight.js/lib/languages/taggerscript')).default);

    case 'yaml':
      return hljs.registerLanguage('yaml', (await module.dynamicImport('highlight.js/lib/languages/yaml')).default);

    case 'tap':
      return hljs.registerLanguage('tap', (await module.dynamicImport('highlight.js/lib/languages/tap')).default);

    case 'tcl':
      return hljs.registerLanguage('tcl', (await module.dynamicImport('highlight.js/lib/languages/tcl')).default);

    case 'tex':
      return hljs.registerLanguage('tex', (await module.dynamicImport('highlight.js/lib/languages/tex')).default);

    case 'thrift':
      return hljs.registerLanguage('thrift', (await module.dynamicImport('highlight.js/lib/languages/thrift')).default);

    case 'tp':
      return hljs.registerLanguage('tp', (await module.dynamicImport('highlight.js/lib/languages/tp')).default);

    case 'twig':
      return hljs.registerLanguage('twig', (await module.dynamicImport('highlight.js/lib/languages/twig')).default);

    case 'typescript':
      return hljs.registerLanguage('typescript', (await module.dynamicImport('highlight.js/lib/languages/typescript')).default);

    case 'vala':
      return hljs.registerLanguage('vala', (await module.dynamicImport('highlight.js/lib/languages/vala')).default);

    case 'vbnet':
      return hljs.registerLanguage('vbnet', (await module.dynamicImport('highlight.js/lib/languages/vbnet')).default);

    case 'vbscript':
      return hljs.registerLanguage('vbscript', (await module.dynamicImport('highlight.js/lib/languages/vbscript')).default);

    case 'vbscript-html':
      return hljs.registerLanguage('vbscript-html(', (await module.dynamicImport('highlight.js/lib/languages/vbscript-html')).default);

    case 'verilog':
      return hljs.registerLanguage('verilog', (await module.dynamicImport('highlight.js/lib/languages/verilog')).default);

    case 'vhdl':
      return hljs.registerLanguage('vhdl', (await module.dynamicImport('highlight.js/lib/languages/vhdl')).default);

    case 'vim':
      return hljs.registerLanguage('vim', (await module.dynamicImport('highlight.js/lib/languages/vim')).default);

    case 'x86asm':
      return hljs.registerLanguage('x86asm', (await module.dynamicImport('highlight.js/lib/languages/x86asm')).default);

    case 'xl':
      return hljs.registerLanguage('xl', (await module.dynamicImport('highlight.js/lib/languages/xl')).default);

    case 'xquery':
      return hljs.registerLanguage('xquery', (await module.dynamicImport('highlight.js/lib/languages/xquery')).default);

    case 'zephir':
      return hljs.registerLanguage('zephir', (await module.dynamicImport('highlight.js/lib/languages/zephir')).default);

    default:
      return hljs.registerLanguage('plaintext', (await module.dynamicImport('highlight.js/lib/languages/plaintext')).default);
  }
};

module.exportDefault(hljs);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"markdown.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/markdown.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["parser"];

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 0);
module.export({
  Markdown: () => Markdown,
  filterMarkdown: () => filterMarkdown,
  createMarkdownMessageRenderer: () => createMarkdownMessageRenderer,
  createMarkdownNotificationRenderer: () => createMarkdownNotificationRenderer
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 1);
let marked;
module.link("./parser/marked/marked", {
  marked(v) {
    marked = v;
  }

}, 2);
let original;
module.link("./parser/original/original", {
  original(v) {
    original = v;
  }

}, 3);
let filtered;
module.link("./parser/filtered/filtered", {
  filtered(v) {
    filtered = v;
  }

}, 4);
let code;
module.link("./parser/original/code", {
  code(v) {
    code = v;
  }

}, 5);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 6);
const parsers = {
  original,
  marked,
  filtered
};

class MarkdownClass {
  parse(text) {
    const message = {
      html: escapeHTML(text)
    };
    return this.mountTokensBack(this.parseMessageNotEscaped(message)).html;
  }

  parseNotEscaped(text) {
    const message = {
      html: text
    };
    return this.mountTokensBack(this.parseMessageNotEscaped(message)).html;
  }

  parseMessageNotEscaped(message) {
    const parser = settings.get('Markdown_Parser');

    if (parser === 'disabled') {
      return message;
    }

    const options = {
      supportSchemesForLink: settings.get('Markdown_SupportSchemesForLink'),
      headers: settings.get('Markdown_Headers'),
      rootUrl: Meteor.absoluteUrl(),
      marked: {
        gfm: settings.get('Markdown_Marked_GFM'),
        tables: settings.get('Markdown_Marked_Tables'),
        breaks: settings.get('Markdown_Marked_Breaks'),
        pedantic: settings.get('Markdown_Marked_Pedantic'),
        smartLists: settings.get('Markdown_Marked_SmartLists'),
        smartypants: settings.get('Markdown_Marked_Smartypants')
      }
    };
    const parse = typeof parsers[parser] === 'function' ? parsers[parser] : parsers.original;
    return parse(message, options);
  }

  mountTokensBackRecursively(message, tokenList) {
    let useHtml = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
    const missingTokens = [];

    if (tokenList.length > 0) {
      for (const {
        token,
        text,
        noHtml
      } of tokenList) {
        if (message.html.indexOf(token) >= 0) {
          message.html = message.html.replace(token, () => useHtml ? text : noHtml); // Uses lambda so doesn't need to escape $
        } else {
          missingTokens.push({
            token,
            text,
            noHtml
          });
        }
      }
    } // If there are tokens that were missing from the string, but the last iteration replaced at least one token, then go again
    // this is done because one of the tokens may have been hidden by another one


    if (missingTokens.length > 0 && missingTokens.length < tokenList.length) {
      this.mountTokensBackRecursively(message, missingTokens, useHtml);
    }
  }

  mountTokensBack(message) {
    let useHtml = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

    if (message.tokens) {
      this.mountTokensBackRecursively(message, message.tokens, useHtml);
    }

    return message;
  }

  code() {
    return code(...arguments);
  }

  filterMarkdownFromMessage(message) {
    return parsers.filtered(message, {
      supportSchemesForLink: settings.get('Markdown_SupportSchemesForLink')
    });
  }

}

const Markdown = new MarkdownClass();

const filterMarkdown = message => Markdown.filterMarkdownFromMessage(message);

const createMarkdownMessageRenderer = _ref => {
  let {
    parser
  } = _ref,
      options = _objectWithoutProperties(_ref, _excluded);

  if (!parser || parser === 'disabled') {
    return message => message;
  }

  const parse = typeof parsers[parser] === 'function' ? parsers[parser] : parsers.original;
  return message => {
    var _message$html;

    if (!(message !== null && message !== void 0 && (_message$html = message.html) !== null && _message$html !== void 0 && _message$html.trim())) {
      return message;
    }

    return parse(message, options);
  };
};

const createMarkdownNotificationRenderer = options => message => parsers.filtered(message, options);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"getGlobalWindow.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/client/getGlobalWindow.ts                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getGlobalWindow: () => getGlobalWindow
});

const getGlobalWindow = () => window;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/client/index.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/markdown", {
  Markdown: "Markdown"
}, 0);
module.link("../lib/markdown", {
  createMarkdownMessageRenderer: "createMarkdownMessageRenderer",
  createMarkdownNotificationRenderer: "createMarkdownNotificationRenderer"
}, 1);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"action-links":{"client":{"lib":{"actionLinks.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/action-links/client/lib/actionLinks.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  actionLinks: () => actionLinks
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 1);
let Messages, Subscriptions;
module.link("../../../models/client", {
  Messages(v) {
    Messages = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 2);
const actionLinks = {
  actions: {},

  register(name, funct) {
    actionLinks.actions[name] = funct;
  },

  getMessage(name, messageId) {
    const userId = Meteor.userId();

    if (!userId) {
      throw new Meteor.Error('error-invalid-user', 'Invalid user', {
        function: 'actionLinks.getMessage'
      });
    }

    const message = Messages.findOne({
      _id: messageId
    });

    if (!message) {
      throw new Meteor.Error('error-invalid-message', 'Invalid message', {
        function: 'actionLinks.getMessage'
      });
    }

    const subscription = Subscriptions.findOne({
      'rid': message.rid,
      'u._id': userId
    });

    if (!subscription) {
      throw new Meteor.Error('error-not-allowed', 'Not allowed', {
        function: 'actionLinks.getMessage'
      });
    }

    if (!message.actionLinks || !message.actionLinks[name]) {
      throw new Meteor.Error('error-invalid-actionlink', 'Invalid action link', {
        function: 'actionLinks.getMessage'
      });
    }

    return message;
  },

  run(name, messageId, instance) {
    const message = actionLinks.getMessage(name, messageId);
    const actionLink = message.actionLinks[name];
    let ranClient = false;

    if (actionLinks && actionLinks.actions && actionLinks.actions[actionLink.method_id]) {
      // run just on client side
      actionLinks.actions[actionLink.method_id](message, actionLink.params, instance);
      ranClient = true;
    } // and run on server side


    Meteor.call('actionLinkHandler', name, messageId, err => {
      if (err && !ranClient) {
        handleError(err);
      }
    });
  }

};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/action-links/client/index.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  actionLinks: () => actionLinks
});
let actionLinks;
module.link("./lib/actionLinks", {
  actionLinks(v) {
    actionLinks = v;
  }

}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"autotranslate":{"client":{"lib":{"actionButton.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/autotranslate/client/lib/actionButton.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let AutoTranslate;
module.link("./autotranslate", {
  AutoTranslate(v) {
    AutoTranslate = v;
  }

}, 2);
let settings;
module.link("../../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);
let hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 4);
let MessageAction;
module.link("../../../ui-utils", {
  MessageAction(v) {
    MessageAction = v;
  }

}, 5);
let messageArgs;
module.link("../../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 6);
let Messages;
module.link("../../../models", {
  Messages(v) {
    Messages = v;
  }

}, 7);
Meteor.startup(() => {
  AutoTranslate.init();
  Tracker.autorun(() => {
    if (settings.get('AutoTranslate_Enabled') && hasAtLeastOnePermission(['auto-translate'])) {
      MessageAction.addButton({
        id: 'translate',
        icon: 'language',
        label: 'Translate',
        context: ['message', 'message-mobile', 'threads'],

        action() {
          const {
            msg: message
          } = messageArgs(this);
          const language = AutoTranslate.getLanguage(message.rid);

          if (!message.translations || !message.translations[language]) {
            // } && !_.find(message.attachments, attachment => { return attachment.translations && attachment.translations[language]; })) {
            AutoTranslate.messageIdsToWait[message._id] = true;
            Messages.update({
              _id: message._id
            }, {
              $set: {
                autoTranslateFetching: true
              }
            });
            Meteor.call('autoTranslate.translateMessage', message, language);
          }

          const action = message.autoTranslateShowInverse ? '$unset' : '$set';
          Messages.update({
            _id: message._id
          }, {
            [action]: {
              autoTranslateShowInverse: true
            }
          });
        },

        condition(_ref) {
          let {
            msg,
            u
          } = _ref;
          return msg && msg.u && msg.u._id !== u._id && msg.translations && !msg.translations.original;
        },

        order: 90
      });
      MessageAction.addButton({
        id: 'view-original',
        icon: 'language',
        label: 'View_original',
        context: ['message', 'message-mobile', 'threads'],

        action() {
          const {
            msg: message
          } = messageArgs(this);
          const language = AutoTranslate.getLanguage(message.rid);

          if (!message.translations || !message.translations[language]) {
            // } && !_.find(message.attachments, attachment => { return attachment.translations && attachment.translations[language]; })) {
            AutoTranslate.messageIdsToWait[message._id] = true;
            Messages.update({
              _id: message._id
            }, {
              $set: {
                autoTranslateFetching: true
              }
            });
            Meteor.call('autoTranslate.translateMessage', message, language);
          }

          const action = message.autoTranslateShowInverse ? '$unset' : '$set';
          Messages.update({
            _id: message._id
          }, {
            [action]: {
              autoTranslateShowInverse: true
            }
          });
        },

        condition(_ref2) {
          let {
            msg,
            u
          } = _ref2;
          return msg && msg.u && msg.u._id !== u._id && msg.translations && msg.translations.original;
        },

        order: 90
      });
    } else {
      MessageAction.removeButton('toggle-language');
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"autotranslate.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/autotranslate/client/lib/autotranslate.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AutoTranslate: () => AutoTranslate,
  createAutoTranslateMessageRenderer: () => createAutoTranslateMessageRenderer,
  createAutoTranslateMessageStreamHandler: () => createAutoTranslateMessageStreamHandler
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
let mem;
module.link("mem", {
  default(v) {
    mem = v;
  }

}, 3);
let Subscriptions, Messages;
module.link("../../../models", {
  Subscriptions(v) {
    Subscriptions = v;
  },

  Messages(v) {
    Messages = v;
  }

}, 4);
let hasPermission;
module.link("../../../authorization", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 5);
let callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 6);
let userLanguage = 'en';
let username = '';
Meteor.startup(() => {
  Tracker.autorun(() => {
    const user = Meteor.user();

    if (!user) {
      return;
    }

    userLanguage = user.language || 'en';
    username = user.username;
  });
});
const AutoTranslate = {
  initialized: false,
  providersMetadata: {},
  messageIdsToWait: {},
  supportedLanguages: [],
  findSubscriptionByRid: mem(rid => Subscriptions.findOne({
    rid
  })),

  getLanguage(rid) {
    let subscription = {};

    if (rid) {
      subscription = this.findSubscriptionByRid(rid);
    }

    const language = subscription && subscription.autoTranslateLanguage || userLanguage || window.defaultUserLanguage();

    if (language.indexOf('-') !== -1) {
      if (!_.findWhere(this.supportedLanguages, {
        language
      })) {
        return language.substr(0, 2);
      }
    }

    return language;
  },

  translateAttachments(attachments, language) {
    for (const attachment of attachments) {
      if (attachment.author_name !== username) {
        if (attachment.text && attachment.translations && attachment.translations[language]) {
          attachment.text = attachment.translations[language];
        }

        if (attachment.description && attachment.translations && attachment.translations[language]) {
          attachment.description = attachment.translations[language];
        }

        if (attachment.attachments && attachment.attachments.length > 0) {
          attachment.attachments = this.translateAttachments(attachment.attachments, language);
        }
      }
    }

    return attachments;
  },

  init() {
    if (this.initialized) {
      return;
    }

    Tracker.autorun(async c => {
      const uid = Meteor.userId();

      if (!uid || !hasPermission('auto-translate')) {
        return;
      }

      c.stop();
      [this.providersMetadata, this.supportedLanguages] = await Promise.all([callWithErrorHandling('autoTranslate.getProviderUiMetadata'), callWithErrorHandling('autoTranslate.getSupportedLanguages', 'en')]);
    });
    Subscriptions.find().observeChanges({
      changed: (id, fields) => {
        if (fields.hasOwnProperty('autoTranslate') || fields.hasOwnProperty('autoTranslateLanguage')) {
          mem.clear(this.findSubscriptionByRid);
        }
      }
    });
    this.initialized = true;
  }

};

const createAutoTranslateMessageRenderer = () => {
  AutoTranslate.init();
  return message => {
    const subscription = AutoTranslate.findSubscriptionByRid(message.rid);
    const autoTranslateLanguage = AutoTranslate.getLanguage(message.rid);

    if (message.u && message.u._id !== Meteor.userId()) {
      if (!message.translations) {
        message.translations = {};
      }

      if (!!(subscription && subscription.autoTranslate) !== !!message.autoTranslateShowInverse) {
        message.translations.original = message.html;

        if (message.translations[autoTranslateLanguage]) {
          message.html = message.translations[autoTranslateLanguage];
        }

        if (message.attachments && message.attachments.length > 0) {
          message.attachments = AutoTranslate.translateAttachments(message.attachments, autoTranslateLanguage);
        }
      }
    } else if (message.attachments && message.attachments.length > 0) {
      message.attachments = AutoTranslate.translateAttachments(message.attachments, autoTranslateLanguage);
    }

    return message;
  };
};

const createAutoTranslateMessageStreamHandler = () => {
  AutoTranslate.init();
  return message => {
    if (message.u && message.u._id !== Meteor.userId()) {
      const subscription = AutoTranslate.findSubscriptionByRid(message.rid);
      const language = AutoTranslate.getLanguage(message.rid);

      if (subscription && subscription.autoTranslate === true && message.msg && (!message.translations || !message.translations[language])) {
        // || (message.attachments && !_.find(message.attachments, attachment => { return attachment.translations && attachment.translations[language]; }))
        Messages.update({
          _id: message._id
        }, {
          $set: {
            autoTranslateFetching: true
          }
        });
      } else if (AutoTranslate.messageIdsToWait[message._id] !== undefined && subscription && subscription.autoTranslate !== true) {
        Messages.update({
          _id: message._id
        }, {
          $set: {
            autoTranslateShowInverse: true
          },
          $unset: {
            autoTranslateFetching: true
          }
        });
        delete AutoTranslate.messageIdsToWait[message._id];
      } else if (message.autoTranslateFetching === true) {
        Messages.update({
          _id: message._id
        }, {
          $unset: {
            autoTranslateFetching: true
          }
        });
      }
    }
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/autotranslate/client/lib/tabBar.ts                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let lazy, useMemo;
module.link("react", {
  lazy(v) {
    lazy = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 0);
let addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
let usePermission;
module.link("../../../../client/contexts/AuthorizationContext", {
  usePermission(v) {
    usePermission = v;
  }

}, 2);
let useSetting;
module.link("../../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 3);
addAction('autotranslate', () => {
  const hasPermission = usePermission('auto-translate');
  const autoTranslateEnabled = useSetting('AutoTranslate_Enabled');
  return useMemo(() => hasPermission && autoTranslateEnabled ? {
    groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
    id: 'autotranslate',
    title: 'Auto_Translate',
    icon: 'language',
    template: /*#__PURE__*/lazy(() => module.dynamicImport('../../../../client/views/room/contextualBar/AutoTranslate')),
    order: 20,
    full: true
  } : null, [autoTranslateEnabled, hasPermission]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/autotranslate/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/actionButton");
module.link("./lib/tabBar");
module.link("./lib/autotranslate", {
  AutoTranslate: "AutoTranslate",
  createAutoTranslateMessageRenderer: "createAutoTranslateMessageRenderer",
  createAutoTranslateMessageStreamHandler: "createAutoTranslateMessageStreamHandler"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"channel-settings":{"client":{"lib":{"ChannelSettings.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/channel-settings/client/lib/ChannelSettings.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  ChannelSettings: () => ChannelSettings
});
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
const ChannelSettings = new class {
  constructor() {
    this.options = new ReactiveVar({});
  }
  /*
   * Adds an option in Channel Settings
   * @config (object)
   *   id: option id (required)
   *   template (string): template name to render (required)
   *   validation (function): if option should be displayed
   */


  addOption(config) {
    if (config == null || config.id == null) {
      return false;
    }

    return Tracker.nonreactive(() => {
      const opts = this.options.get();
      opts[config.id] = config;
      return this.options.set(opts);
    });
  }

  getOptions() {
    let currentData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    let group = arguments.length > 1 ? arguments[1] : undefined;

    const allOptions = _.toArray(this.options.get());

    const allowedOptions = _.compact(_.map(allOptions, function (option) {
      const ret = _objectSpread({}, option);

      if (option.validation == null || option.validation(currentData)) {
        ret.data = Object.assign({}, typeof option.data === 'function' ? option.data() : option.data, currentData);
        return ret;
      }
    })).filter(function (option) {
      return !group || !option.group || option.group.includes(group);
    });

    return _.sortBy(allowedOptions, 'order');
  }

}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/channel-settings/client/index.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./tabBar");
module.link("./lib/ChannelSettings", {
  ChannelSettings: "ChannelSettings"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/channel-settings/client/tabBar.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let lazy;
module.link("react", {
  lazy(v) {
    lazy = v;
  }

}, 0);
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
addAction('channel-settings', {
  groups: ['channel', 'group'],
  id: 'channel-settings',
  anonymous: true,
  full: true,
  title: 'Room_Info',
  icon: 'info-circled',
  template: /*#__PURE__*/lazy(() => module.dynamicImport('../../../client/views/room/contextualBar/Info')),
  order: 1
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/channel-settings/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"custom-sounds":{"client":{"lib":{"CustomSounds.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-sounds/client/lib/CustomSounds.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CustomSounds: () => CustomSounds
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
let CachedCollectionManager;
module.link("../../../ui-cached-collection", {
  CachedCollectionManager(v) {
    CachedCollectionManager = v;
  }

}, 3);
let getURL;
module.link("../../../utils/client", {
  getURL(v) {
    getURL = v;
  }

}, 4);

const getCustomSoundId = sound => "custom-sound-".concat(sound);

class CustomSoundsClass {
  constructor() {
    this.play = function (sound) {
      let {
        volume = 1,
        loop = false
      } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      const audio = document.querySelector("#".concat(getCustomSoundId(sound)));

      if (!audio || !audio.play) {
        return;
      }

      audio.volume = volume;
      audio.loop = loop;
      audio.play();
      return audio;
    };

    this.pause = sound => {
      const audio = document.querySelector("#".concat(getCustomSoundId(sound)));

      if (!audio || !audio.pause) {
        return;
      }

      audio.pause();

      if (audio.currentTime !== 0) {
        audio.currentTime = 0;
      }
    };

    this.list = new ReactiveVar({});
    this.add({
      _id: 'chime',
      name: 'Chime',
      extension: 'mp3',
      src: getURL('sounds/chime.mp3')
    });
    this.add({
      _id: 'door',
      name: 'Door',
      extension: 'mp3',
      src: getURL('sounds/door.mp3')
    });
    this.add({
      _id: 'beep',
      name: 'Beep',
      extension: 'mp3',
      src: getURL('sounds/beep.mp3')
    });
    this.add({
      _id: 'chelle',
      name: 'Chelle',
      extension: 'mp3',
      src: getURL('sounds/chelle.mp3')
    });
    this.add({
      _id: 'ding',
      name: 'Ding',
      extension: 'mp3',
      src: getURL('sounds/ding.mp3')
    });
    this.add({
      _id: 'droplet',
      name: 'Droplet',
      extension: 'mp3',
      src: getURL('sounds/droplet.mp3')
    });
    this.add({
      _id: 'highbell',
      name: 'Highbell',
      extension: 'mp3',
      src: getURL('sounds/highbell.mp3')
    });
    this.add({
      _id: 'seasons',
      name: 'Seasons',
      extension: 'mp3',
      src: getURL('sounds/seasons.mp3')
    });
  }

  add(sound) {
    if (!sound.src) {
      sound.src = this.getURL(sound);
    }

    const audio = $('<audio />', {
      id: getCustomSoundId(sound._id),
      preload: true
    }).append($('<source />', {
      src: sound.src
    }));
    const list = this.list.get();
    list[sound._id] = sound;
    this.list.set(list);
    $('body').append(audio);
  }

  remove(sound) {
    const list = this.list.get();
    delete list[sound._id];
    this.list.set(list);
    $("#".concat(sound._id)).remove();
  }

  update(sound) {
    const audio = $("#".concat(sound._id));

    if (audio && audio[0]) {
      const list = this.list.get();

      if (!sound.src) {
        sound.src = this.getURL(sound);
      }

      list[sound._id] = sound;
      this.list.set(list);
      $('source', audio).attr('src', sound.src);
      audio[0].load();
    } else {
      this.add(sound);
    }
  }

  getURL(sound) {
    return getURL("/custom-sounds/".concat(sound._id, ".").concat(sound.extension, "?_dc=").concat(sound.random || 0));
  }

  getList() {
    const list = Object.values(this.list.get());
    return _.sortBy(list, 'name');
  }

}

const CustomSounds = new CustomSoundsClass();
Meteor.startup(() => CachedCollectionManager.onLogin(() => {
  Meteor.call('listCustomSounds', (error, result) => {
    for (const sound of result) {
      CustomSounds.add(sound);
    }
  });
}));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"notifications":{"deleteCustomSound.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-sounds/client/notifications/deleteCustomSound.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let CachedCollectionManager;
module.link("../../../ui-cached-collection", {
  CachedCollectionManager(v) {
    CachedCollectionManager = v;
  }

}, 1);
let Notifications;
module.link("../../../notifications", {
  Notifications(v) {
    Notifications = v;
  }

}, 2);
let CustomSounds;
module.link("../lib/CustomSounds", {
  CustomSounds(v) {
    CustomSounds = v;
  }

}, 3);
Meteor.startup(() => CachedCollectionManager.onLogin(() => Notifications.onAll('deleteCustomSound', data => CustomSounds.remove(data.soundData))));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"updateCustomSound.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-sounds/client/notifications/updateCustomSound.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let CachedCollectionManager;
module.link("../../../ui-cached-collection", {
  CachedCollectionManager(v) {
    CachedCollectionManager = v;
  }

}, 1);
let Notifications;
module.link("../../../notifications", {
  Notifications(v) {
    Notifications = v;
  }

}, 2);
let CustomSounds;
module.link("../lib/CustomSounds", {
  CustomSounds(v) {
    CustomSounds = v;
  }

}, 3);
Meteor.startup(() => CachedCollectionManager.onLogin(() => Notifications.onAll('updateCustomSound', data => CustomSounds.update(data.soundData))));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-sounds/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./notifications/deleteCustomSound");
module.link("./notifications/updateCustomSound");
module.link("./lib/CustomSounds", {
  CustomSounds: "CustomSounds"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"emoji-custom":{"client":{"lib":{"emojiCustom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/lib/emojiCustom.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getEmojiUrlFromName: () => getEmojiUrlFromName,
  deleteEmojiCustom: () => deleteEmojiCustom,
  updateEmojiCustom: () => updateEmojiCustom
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let escapeRegExp;
module.link("@rocket.chat/string-helpers", {
  escapeRegExp(v) {
    escapeRegExp = v;
  }

}, 2);
let isSetNotNull;
module.link("./function-isSet", {
  isSetNotNull(v) {
    isSetNotNull = v;
  }

}, 3);
let RoomManager;
module.link("../../../ui-utils/client", {
  RoomManager(v) {
    RoomManager = v;
  }

}, 4);
let emoji, EmojiPicker;
module.link("../../../emoji/client", {
  emoji(v) {
    emoji = v;
  },

  EmojiPicker(v) {
    EmojiPicker = v;
  }

}, 5);
let CachedCollectionManager;
module.link("../../../ui-cached-collection/client", {
  CachedCollectionManager(v) {
    CachedCollectionManager = v;
  }

}, 6);
let APIClient;
module.link("../../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 7);

const getEmojiUrlFromName = function (name, extension) {
  Session.get;
  const key = "emoji_random_".concat(name);
  let random = 0;

  if (isSetNotNull(() => Session.keys[key])) {
    random = Session.keys[key];
  }

  if (name == null) {
    return;
  }

  const path = __meteor_runtime_config__.ROOT_URL_PATH_PREFIX || '';
  return "".concat(path, "/emoji-custom/").concat(encodeURIComponent(name), ".").concat(extension, "?_dc=").concat(random);
};

const deleteEmojiCustom = function (emojiData) {
  delete emoji.list[":".concat(emojiData.name, ":")];
  const arrayIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf(emojiData.name);

  if (arrayIndex !== -1) {
    emoji.packages.emojiCustom.emojisByCategory.rocket.splice(arrayIndex, 1);
  }

  const arrayIndexList = emoji.packages.emojiCustom.list.indexOf(":".concat(emojiData.name, ":"));

  if (arrayIndexList !== -1) {
    emoji.packages.emojiCustom.list.splice(arrayIndexList, 1);
  }

  if (isSetNotNull(() => emojiData.aliases)) {
    for (const alias of emojiData.aliases) {
      delete emoji.list[":".concat(alias, ":")];
      const aliasIndex = emoji.packages.emojiCustom.list.indexOf(":".concat(alias, ":"));

      if (aliasIndex !== -1) {
        emoji.packages.emojiCustom.list.splice(aliasIndex, 1);
      }
    }
  }

  EmojiPicker.updateRecent('rocket');
};

const updateEmojiCustom = function (emojiData) {
  let key = "emoji_random_".concat(emojiData.name);
  Session.set(key, Math.round(Math.random() * 1000));
  const previousExists = isSetNotNull(() => emojiData.previousName);
  const currentAliases = isSetNotNull(() => emojiData.aliases);

  if (previousExists && isSetNotNull(() => emoji.list[":".concat(emojiData.previousName, ":")].aliases)) {
    for (const alias of emoji.list[":".concat(emojiData.previousName, ":")].aliases) {
      delete emoji.list[":".concat(alias, ":")];
      const aliasIndex = emoji.packages.emojiCustom.list.indexOf(":".concat(alias, ":"));

      if (aliasIndex !== -1) {
        emoji.packages.emojiCustom.list.splice(aliasIndex, 1);
      }
    }
  }

  if (previousExists && emojiData.name !== emojiData.previousName) {
    const arrayIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf(emojiData.previousName);

    if (arrayIndex !== -1) {
      emoji.packages.emojiCustom.emojisByCategory.rocket.splice(arrayIndex, 1);
    }

    const arrayIndexList = emoji.packages.emojiCustom.list.indexOf(":".concat(emojiData.previousName, ":"));

    if (arrayIndexList !== -1) {
      emoji.packages.emojiCustom.list.splice(arrayIndexList, 1);
    }

    delete emoji.list[":".concat(emojiData.previousName, ":")];
  }

  const categoryIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf("".concat(emojiData.name));

  if (categoryIndex === -1) {
    emoji.packages.emojiCustom.emojisByCategory.rocket.push("".concat(emojiData.name));
    emoji.packages.emojiCustom.list.push(":".concat(emojiData.name, ":"));
  }

  emoji.list[":".concat(emojiData.name, ":")] = Object.assign({
    emojiPackage: 'emojiCustom'
  }, emoji.list[":".concat(emojiData.name, ":")], emojiData);

  if (currentAliases) {
    for (const alias of emojiData.aliases) {
      emoji.packages.emojiCustom.list.push(":".concat(alias, ":"));
      emoji.list[":".concat(alias, ":")] = {};
      emoji.list[":".concat(alias, ":")].emojiPackage = 'emojiCustom';
      emoji.list[":".concat(alias, ":")].aliasOf = emojiData.name;
    }
  }

  const url = getEmojiUrlFromName(emojiData.name, emojiData.extension); // update in admin interface

  if (previousExists && emojiData.name !== emojiData.previousName) {
    $(document).find(".emojiAdminPreview-image[data-emoji='".concat(emojiData.previousName, "']")).css('background-image', "url('".concat(url, ")'")).attr('data-emoji', "".concat(emojiData.name));
  } else {
    $(document).find(".emojiAdminPreview-image[data-emoji='".concat(emojiData.name, "']")).css('background-image', "url('".concat(url, "')"));
  } // update in picker


  if (previousExists && emojiData.name !== emojiData.previousName) {
    $(document).find("li[data-emoji='".concat(emojiData.previousName, "'] span")).css('background-image', "url('".concat(url, "')")).attr('data-emoji', "".concat(emojiData.name));
    $(document).find("li[data-emoji='".concat(emojiData.previousName, "']")).attr('data-emoji', "".concat(emojiData.name)).attr('class', "emoji-".concat(emojiData.name));
  } else {
    $(document).find("li[data-emoji='".concat(emojiData.name, "'] span")).css('background-image', "url('".concat(url, "')"));
  } // update in picker and opened rooms


  for (key in RoomManager.openedRooms) {
    if (RoomManager.openedRooms.hasOwnProperty(key)) {
      const room = RoomManager.openedRooms[key];

      if (previousExists && emojiData.name !== emojiData.previousName) {
        $(room.dom).find("span[data-emoji='".concat(emojiData.previousName, "']")).css('background-image', "url('".concat(url, "')")).attr('data-emoji', "".concat(emojiData.name));
      } else {
        $(room.dom).find("span[data-emoji='".concat(emojiData.name, "']")).css('background-image', "url('".concat(url, "')"));
      }
    }
  }

  EmojiPicker.updateRecent('rocket');
};

const customRender = html => {
  const emojisMatchGroup = emoji.packages.emojiCustom.list.map(escapeRegExp).join('|');

  if (emojisMatchGroup !== emoji.packages.emojiCustom._regexpSignature) {
    emoji.packages.emojiCustom._regexpSignature = emojisMatchGroup;
    emoji.packages.emojiCustom._regexp = new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|(".concat(emojisMatchGroup, ")"), 'gi');
  }

  html = html.replace(emoji.packages.emojiCustom._regexp, shortname => {
    if (typeof shortname === 'undefined' || shortname === '' || emoji.packages.emojiCustom.list.indexOf(shortname) === -1) {
      return shortname;
    }

    let emojiAlias = shortname.replace(/:/g, '');
    let dataCheck = emoji.list[shortname];

    if (dataCheck.hasOwnProperty('aliasOf')) {
      emojiAlias = dataCheck.aliasOf;
      dataCheck = emoji.list[":".concat(emojiAlias, ":")];
    }

    return "<span class=\"emoji\" style=\"background-image:url(".concat(getEmojiUrlFromName(emojiAlias, dataCheck.extension), ");\" data-emoji=\"").concat(emojiAlias, "\" title=\"").concat(shortname, "\">").concat(shortname, "</span>");
  });
  return html;
};

emoji.packages.emojiCustom = {
  emojiCategories: [{
    key: 'rocket',
    i18n: 'Custom'
  }],
  categoryIndex: 1,
  toneList: {},
  list: [],
  _regexpSignature: null,
  _regexp: null,
  render: customRender,
  renderPicker: customRender
};
Meteor.startup(() => CachedCollectionManager.onLogin(async () => {
  try {
    const {
      emojis: {
        update: emojis
      }
    } = await APIClient.v1.get('emoji-custom.list');
    emoji.packages.emojiCustom.emojisByCategory = {
      rocket: []
    };

    for (const currentEmoji of emojis) {
      emoji.packages.emojiCustom.emojisByCategory.rocket.push(currentEmoji.name);
      emoji.packages.emojiCustom.list.push(":".concat(currentEmoji.name, ":"));
      emoji.list[":".concat(currentEmoji.name, ":")] = currentEmoji;
      emoji.list[":".concat(currentEmoji.name, ":")].emojiPackage = 'emojiCustom';

      for (const alias of currentEmoji.aliases) {
        emoji.packages.emojiCustom.list.push(":".concat(alias, ":"));
        emoji.list[":".concat(alias, ":")] = {
          emojiPackage: 'emojiCustom',
          aliasOf: currentEmoji.name
        };
      }
    }

    EmojiPicker.updateRecent('rocket');
  } catch (e) {
    console.error('Error getting custom emoji', e);
  }
}));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"function-isSet.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/lib/function-isSet.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isSet: () => isSet,
  isSetNotNull: () => isSetNotNull
});

const isSet = function (fn) {
  let value;

  try {
    value = fn();
  } catch (e) {
    value = undefined;
  }

  return value !== undefined;
};

const isSetNotNull = function (fn) {
  let value;

  try {
    value = fn();
  } catch (e) {
    value = null;
  }

  return value !== null && value !== undefined;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"admin":{"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/admin/startup.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let registerAdminSidebarItem;
module.link("../../../../client/views/admin", {
  registerAdminSidebarItem(v) {
    registerAdminSidebarItem = v;
  }

}, 0);
let hasPermission;
module.link("../../../authorization", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 1);
registerAdminSidebarItem({
  href: 'emoji-custom',
  i18nLabel: 'Custom_Emoji',
  icon: 'emoji',

  permissionGranted() {
    return hasPermission('manage-emoji');
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"notifications":{"deleteEmojiCustom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/notifications/deleteEmojiCustom.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Notifications;
module.link("../../../notifications", {
  Notifications(v) {
    Notifications = v;
  }

}, 1);
let deleteEmojiCustom;
module.link("../lib/emojiCustom", {
  deleteEmojiCustom(v) {
    deleteEmojiCustom = v;
  }

}, 2);
Meteor.startup(() => Notifications.onLogged('deleteEmojiCustom', data => deleteEmojiCustom(data.emojiData)));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"updateEmojiCustom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/notifications/updateEmojiCustom.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Notifications;
module.link("../../../notifications", {
  Notifications(v) {
    Notifications = v;
  }

}, 1);
let updateEmojiCustom;
module.link("../lib/emojiCustom", {
  updateEmojiCustom(v) {
    updateEmojiCustom = v;
  }

}, 2);
Meteor.startup(() => Notifications.onLogged('updateEmojiCustom', data => updateEmojiCustom(data.emojiData)));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/index.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/emojiCustom");
module.link("./notifications/deleteEmojiCustom");
module.link("./notifications/updateEmojiCustom");
module.link("./admin/startup");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"file-upload":{"client":{"lib":{"fileUploadHandler.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/file-upload/client/lib/fileUploadHandler.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  fileUploadHandler: () => fileUploadHandler
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let UploadFS;
module.link("meteor/jalik:ufs", {
  UploadFS(v) {
    UploadFS = v;
  }

}, 3);
let FileUploadBase;
module.link("../../lib/FileUploadBase", {
  FileUploadBase(v) {
    FileUploadBase = v;
  }

}, 4);
let Uploads, Avatars;
module.link("../../../models", {
  Uploads(v) {
    Uploads = v;
  },

  Avatars(v) {
    Avatars = v;
  }

}, 5);
new UploadFS.Store({
  collection: Uploads.model,
  name: 'Uploads'
});
new UploadFS.Store({
  collection: Avatars.model,
  name: 'Avatars'
});

const fileUploadHandler = (directive, meta, file) => {
  const store = UploadFS.getStore(directive);

  if (store) {
    return new FileUploadBase(store, meta, file);
  }

  console.error('Invalid file store', directive);
};

Tracker.autorun(function () {
  if (Meteor.userId()) {
    const secure = location.protocol === 'https:' ? '; secure' : '';
    document.cookie = "rc_uid=".concat(escape(Meteor.userId()), "; path=/").concat(secure);
    document.cookie = "rc_token=".concat(escape(Accounts._storedLoginToken()), "; path=/").concat(secure);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/file-upload/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  fileUploadHandler: () => fileUploadHandler
});
let fileUploadHandler;
module.link("./lib/fileUploadHandler", {
  fileUploadHandler(v) {
    fileUploadHandler = v;
  }

}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"FileUploadBase.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/file-upload/lib/FileUploadBase.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  FileUploadBase: () => FileUploadBase
});
let path;
module.link("path", {
  default(v) {
    path = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 2);
let UploadFS;
module.link("meteor/jalik:ufs", {
  UploadFS(v) {
    UploadFS = v;
  }

}, 3);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 4);
let canAccessRoom, hasPermission;
module.link("../../authorization", {
  canAccessRoom(v) {
    canAccessRoom = v;
  },

  hasPermission(v) {
    hasPermission = v;
  }

}, 5);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 6);

// set ufs temp dir to $TMPDIR/ufs instead of /tmp/ufs if the variable is set
if ('TMPDIR' in process.env) {
  UploadFS.config.tmpDir = path.join(process.env.TMPDIR, 'ufs');
}

UploadFS.config.defaultStorePermissions = new UploadFS.StorePermissions({
  insert(userId, doc) {
    if (userId) {
      return true;
    } // allow inserts from slackbridge (message_id = slack-timestamp-milli)


    if (doc && doc.message_id && doc.message_id.indexOf('slack-') === 0) {
      return true;
    } // allow inserts to the UserDataFiles store


    if (doc && doc.store && doc.store.split(':').pop() === 'UserDataFiles') {
      return true;
    }

    if (canAccessRoom(null, null, doc)) {
      return true;
    }

    return false;
  },

  update(userId, doc) {
    return hasPermission(Meteor.userId(), 'delete-message', doc.rid) || settings.get('Message_AllowDeleting') && userId === doc.userId;
  },

  remove(userId, doc) {
    return hasPermission(Meteor.userId(), 'delete-message', doc.rid) || settings.get('Message_AllowDeleting') && userId === doc.userId;
  }

});

class FileUploadBase {
  constructor(store, meta, file) {
    this.id = Random.id();
    this.meta = meta;
    this.file = file;
    this.store = store;
  }

  getProgress() {}

  getFileName() {
    return this.meta.name;
  }

  start(callback) {
    this.handler = new UploadFS.Uploader({
      store: this.store,
      data: this.file,
      file: this.meta,
      onError: err => callback(err),
      onComplete: fileData => {
        const file = _.pick(fileData, '_id', 'type', 'size', 'name', 'identify', 'description');

        file.url = fileData.url.replace(Meteor.absoluteUrl(), '/');
        return callback(null, file, this.store.options.name);
      }
    });

    this.handler.onProgress = (file, progress) => {
      this.onProgress(progress);
    };

    return this.handler.start();
  }

  onProgress() {}

  stop() {
    return this.handler.stop();
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/file-upload/index.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"notifications":{"client":{"lib":{"Notifications.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/notifications/client/lib/Notifications.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
module.link("./Presence");

class Notifications {
  constructor() {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    this.logged = Meteor.userId() !== null;
    this.loginCb = [];
    Tracker.autorun(() => {
      if (Meteor.userId() !== null && this.logged === false) {
        this.loginCb.forEach(cb => cb());
      }

      this.logged = Meteor.userId() !== null;
    });
    this.debug = false;
    this.streamAll = new Meteor.Streamer('notify-all');
    this.streamLogged = new Meteor.Streamer('notify-logged');
    this.streamRoom = new Meteor.Streamer('notify-room');
    this.streamRoomUsers = new Meteor.Streamer('notify-room-users');
    this.streamUser = new Meteor.Streamer('notify-user');

    if (this.debug === true) {
      this.onAll(function () {
        return console.log('RocketChat.Notifications: onAll', args);
      });
      this.onUser(function () {
        return console.log('RocketChat.Notifications: onAll', args);
      });
    }
  }

  onLogin(cb) {
    this.loginCb.push(cb);

    if (this.logged) {
      return cb();
    }
  }

  notifyRoom(room, eventName) {
    for (var _len2 = arguments.length, args = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {
      args[_key2 - 2] = arguments[_key2];
    }

    if (this.debug === true) {
      console.log('RocketChat.Notifications: notifyRoom', [room, eventName, ...args]);
    }

    args.unshift("".concat(room, "/").concat(eventName));
    return this.streamRoom.emit.apply(this.streamRoom, args);
  }

  notifyUser(userId, eventName) {
    for (var _len3 = arguments.length, args = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {
      args[_key3 - 2] = arguments[_key3];
    }

    if (this.debug === true) {
      console.log('RocketChat.Notifications: notifyUser', [userId, eventName, ...args]);
    }

    args.unshift("".concat(userId, "/").concat(eventName));
    return this.streamUser.emit.apply(this.streamUser, args);
  }

  notifyUsersOfRoom(room, eventName) {
    for (var _len4 = arguments.length, args = new Array(_len4 > 2 ? _len4 - 2 : 0), _key4 = 2; _key4 < _len4; _key4++) {
      args[_key4 - 2] = arguments[_key4];
    }

    if (this.debug === true) {
      console.log('RocketChat.Notifications: notifyUsersOfRoom', [room, eventName, ...args]);
    }

    args.unshift("".concat(room, "/").concat(eventName));
    return this.streamRoomUsers.emit.apply(this.streamRoomUsers, args);
  }

  onAll(eventName, callback) {
    return this.streamAll.on(eventName, callback);
  }

  onLogged(eventName, callback) {
    return this.onLogin(() => this.streamLogged.on(eventName, callback));
  }

  onRoom(room, eventName, callback) {
    if (this.debug === true) {
      this.streamRoom.on(room, function () {
        return console.log("RocketChat.Notifications: onRoom ".concat(room), [room, eventName, callback]);
      });
    }

    return this.streamRoom.on("".concat(room, "/").concat(eventName), callback);
  }

  async onUser(eventName, callback) {
    let visitorId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    await this.streamUser.on("".concat(Meteor.userId() || visitorId, "/").concat(eventName), callback);
    return () => this.unUser(eventName, callback, visitorId);
  }

  unAll(callback) {
    return this.streamAll.removeListener('notify', callback);
  }

  unLogged(callback) {
    return this.streamLogged.removeListener('notify', callback);
  }

  unRoom(room, eventName, callback) {
    return this.streamRoom.removeListener("".concat(room, "/").concat(eventName), callback);
  }

  unUser(eventName, callback) {
    let visitorId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    return this.streamUser.removeListener("".concat(Meteor.userId() || visitorId, "/").concat(eventName), callback);
  }

}

module.exportDefault(new Notifications());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Presence.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/notifications/client/lib/Presence.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Presence, STATUS_MAP;
module.link("../../../../client/lib/presence", {
  Presence(v) {
    Presence = v;
  },

  STATUS_MAP(v) {
    STATUS_MAP = v;
  }

}, 1);
// TODO implement API on Streamer to be able to listen to all streamed data
// this is a hacky way to listen to all streamed data from user-presense Streamer
Meteor.StreamerCentral.on('stream-user-presence', (uid, args) => {
  if (!Array.isArray(args)) {
    throw new Error('Presence event must be an array');
  }

  const [username, status, statusText] = args;
  Presence.notify({
    _id: uid,
    username,
    status: STATUS_MAP[status],
    statusText
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/notifications/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Notifications: () => Notifications
});
let Notifications;
module.link("./lib/Notifications", {
  default(v) {
    Notifications = v;
  }

}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/notifications/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"settings":{"client":{"lib":{"settings.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/settings/client/lib/settings.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  settings: () => settings
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveDict;
module.link("meteor/reactive-dict", {
  ReactiveDict(v) {
    ReactiveDict = v;
  }

}, 1);
let PublicSettingsCachedCollection;
module.link("../../../../client/lib/settings/PublicSettingsCachedCollection", {
  PublicSettingsCachedCollection(v) {
    PublicSettingsCachedCollection = v;
  }

}, 2);
let SettingsBase;
module.link("../../lib/settings", {
  SettingsBase(v) {
    SettingsBase = v;
  }

}, 3);

class Settings extends SettingsBase {
  constructor() {
    super(...arguments);
    this.cachedCollection = PublicSettingsCachedCollection.get();
    this.collection = PublicSettingsCachedCollection.get().collection;
    this.dict = new ReactiveDict('settings');
  }

  get(_id) {
    if (_id instanceof RegExp) {
      throw new Error('RegExp Settings.get(RegExp)');
    }

    if ((arguments.length <= 1 ? 0 : arguments.length - 1) > 0) {
      throw new Error('settings.get(String, callback) only works on backend');
    }

    return this.dict.get(_id);
  }

  _storeSettingValue(record, initialLoad) {
    Meteor.settings[record._id] = record.value;
    this.dict.set(record._id, record.value);
    this.load(record._id, record.value, initialLoad);
  }

  init() {
    let initialLoad = true;
    this.collection.find().observe({
      added: record => this._storeSettingValue(record, initialLoad),
      changed: record => this._storeSettingValue(record, initialLoad),
      removed: record => {
        delete Meteor.settings[record._id];
        this.dict.set(record._id, null);
        this.load(record._id, undefined, initialLoad);
      }
    });
    initialLoad = false;
  }

}

const settings = new Settings();
settings.init();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/settings/client/index.ts                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  settings: () => settings
});
let settings;
module.link("./lib/settings", {
  settings(v) {
    settings = v;
  }

}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"settings.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/settings/lib/settings.ts                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  SettingsBase: () => SettingsBase
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 1);

class SettingsBase {
  constructor() {
    this.callbacks = new Map();
    this.regexCallbacks = new Map();
  }

  get(_id, callback) {
    if (callback != null) {
      this.onload(_id, callback);

      if (!Meteor.settings) {
        return;
      }

      if (_id === '*') {
        return Object.keys(Meteor.settings).forEach(key => {
          const value = Meteor.settings[key];
          callback(key, value);
        });
      }

      if (_.isRegExp(_id) && Meteor.settings) {
        return Object.keys(Meteor.settings).forEach(key => {
          if (!_id.test(key)) {
            return;
          }

          const value = Meteor.settings[key];
          callback(key, value);
        });
      }

      if (typeof _id === 'string') {
        const value = Meteor.settings[_id];

        if (value != null) {
          callback(_id, Meteor.settings[_id]);
        }

        return;
      }
    }

    if (!Meteor.settings) {
      return;
    }

    if (_.isRegExp(_id)) {
      return Object.keys(Meteor.settings).reduce((items, key) => {
        const value = Meteor.settings[key];

        if (_id.test(key)) {
          items.push({
            key,
            value
          });
        }

        return items;
      }, []);
    }

    return Meteor.settings && Meteor.settings[_id];
  }

  set(_id, value, callback) {
    Meteor.call('saveSetting', _id, value, callback);
  }

  batchSet(settings, callback) {
    Meteor.call('saveSettings', settings, callback);
  }

  load(key, value, initialLoad) {
    ['*', key].forEach(item => {
      const callbacks = this.callbacks.get(item);

      if (callbacks) {
        callbacks.forEach(callback => callback(key, value, initialLoad));
      }
    });
    this.regexCallbacks.forEach(cbValue => {
      if (!(cbValue !== null && cbValue !== void 0 && cbValue.regex.test(key))) {
        return;
      }

      cbValue.callbacks.forEach(callback => callback(key, value, initialLoad));
    });
  }

  onload(key, callback) {
    // if key is '*'
    // 	for key, value in Meteor.settings
    // 		callback key, value, false
    // else if Meteor.settings?[_id]?
    // 	callback key, Meteor.settings[_id], false
    const keys = Array.isArray(key) ? key : [key];
    keys.forEach(k => {
      if (_.isRegExp(k)) {
        var _this$regexCallbacks$;

        if (!this.regexCallbacks.has(k.source)) {
          this.regexCallbacks.set(k.source, {
            regex: k,
            callbacks: []
          });
        }

        (_this$regexCallbacks$ = this.regexCallbacks.get(k.source)) === null || _this$regexCallbacks$ === void 0 ? void 0 : _this$regexCallbacks$.callbacks.push(callback);
      } else {
        var _this$callbacks$get;

        if (!this.callbacks.has(k)) {
          this.callbacks.set(k, []);
        }

        (_this$callbacks$get = this.callbacks.get(k)) === null || _this$callbacks$get === void 0 ? void 0 : _this$callbacks$get.push(callback);
      }
    });
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/settings/index.js                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.ts');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.ts');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ui-clean-history":{"client":{"lib":{"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-clean-history/client/lib/tabBar.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo, lazy;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  },

  lazy(v) {
    lazy = v;
  }

}, 0);
let addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
let usePermission;
module.link("../../../../client/contexts/AuthorizationContext", {
  usePermission(v) {
    usePermission = v;
  }

}, 2);
const template = /*#__PURE__*/lazy(() => module.dynamicImport('../../../../client/views/room/contextualBar/PruneMessages'));
addAction('clean-history', _ref => {
  let {
    room
  } = _ref;
  const hasPermission = usePermission('clean-channel-history', room._id);
  return useMemo(() => hasPermission ? {
    groups: ['channel', 'group', 'team', 'direct_multiple', 'direct'],
    id: 'clean-history',
    full: true,
    title: 'Prune_Messages',
    icon: 'eraser',
    template,
    order: 250
  } : null, [hasPermission]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-clean-history/client/index.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/tabBar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"user-status":{"client":{"lib":{"customUserStatus.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/lib/customUserStatus.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  deleteCustomUserStatus: () => deleteCustomUserStatus,
  updateCustomUserStatus: () => updateCustomUserStatus
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let userStatus;
module.link("./userStatus", {
  userStatus(v) {
    userStatus = v;
  }

}, 2);
userStatus.packages.customUserStatus = {
  list: []
};

const deleteCustomUserStatus = function (customUserStatusData) {
  delete userStatus.list[customUserStatusData._id];
  const arrayIndex = userStatus.packages.customUserStatus.list.indexOf(customUserStatusData._id);

  if (arrayIndex !== -1) {
    userStatus.packages.customUserStatusData.list.splice(arrayIndex, 1);
  }
};

const updateCustomUserStatus = function (customUserStatusData) {
  const newUserStatus = {
    name: customUserStatusData.name,
    id: customUserStatusData._id,
    statusType: customUserStatusData.statusType,
    localizeName: false
  };
  const arrayIndex = userStatus.packages.customUserStatus.list.indexOf(newUserStatus.id);

  if (arrayIndex === -1) {
    userStatus.packages.customUserStatus.list.push(newUserStatus);
  } else {
    userStatus.packages.customUserStatus.list[arrayIndex] = newUserStatus;
  }

  userStatus.list[newUserStatus.id] = newUserStatus;
};

Meteor.startup(() => {
  Tracker.autorun(() => {
    if (!Meteor.userId()) {
      return;
    }

    Meteor.call('listCustomUserStatus', (error, result) => {
      if (!result) {
        return;
      }

      for (const customStatus of result) {
        const newUserStatus = {
          name: customStatus.name,
          id: customStatus._id,
          statusType: customStatus.statusType,
          localizeName: false
        };
        userStatus.packages.customUserStatus.list.push(newUserStatus);
        userStatus.list[newUserStatus.id] = newUserStatus;
      }
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userStatus.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/lib/userStatus.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  userStatus: () => userStatus
});
let UserStatus;
module.link("../../../../definition/UserStatus", {
  UserStatus(v) {
    UserStatus = v;
  }

}, 0);
const userStatus = {
  packages: {
    base: {
      render(html) {
        return html;
      }

    }
  },
  list: {
    online: {
      name: UserStatus.ONLINE,
      localizeName: true,
      id: UserStatus.ONLINE,
      statusType: UserStatus.ONLINE
    },
    away: {
      name: UserStatus.AWAY,
      localizeName: true,
      id: UserStatus.AWAY,
      statusType: UserStatus.AWAY
    },
    busy: {
      name: UserStatus.BUSY,
      localizeName: true,
      id: UserStatus.BUSY,
      statusType: UserStatus.BUSY
    },
    offline: {
      name: UserStatus.OFFLINE,
      localizeName: true,
      id: UserStatus.OFFLINE,
      statusType: UserStatus.OFFLINE
    }
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"admin":{"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/admin/startup.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 0);
let registerAdminSidebarItem;
module.link("../../../../client/views/admin", {
  registerAdminSidebarItem(v) {
    registerAdminSidebarItem = v;
  }

}, 1);
registerAdminSidebarItem({
  href: 'custom-user-status',
  i18nLabel: 'Custom_User_Status',
  icon: 'user',

  permissionGranted() {
    return hasAtLeastOnePermission(['manage-user-status']);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"notifications":{"deleteCustomUserStatus.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/notifications/deleteCustomUserStatus.js                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let deleteCustomUserStatus;
module.link("../lib/customUserStatus", {
  deleteCustomUserStatus(v) {
    deleteCustomUserStatus = v;
  }

}, 1);
let Notifications;
module.link("../../../notifications", {
  Notifications(v) {
    Notifications = v;
  }

}, 2);
Meteor.startup(() => Notifications.onLogged('deleteCustomUserStatus', data => deleteCustomUserStatus(data.userStatusData)));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"updateCustomUserStatus.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/notifications/updateCustomUserStatus.js                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let updateCustomUserStatus;
module.link("../lib/customUserStatus", {
  updateCustomUserStatus(v) {
    updateCustomUserStatus = v;
  }

}, 1);
let Notifications;
module.link("../../../notifications", {
  Notifications(v) {
    Notifications = v;
  }

}, 2);
Meteor.startup(() => Notifications.onLogged('updateCustomUserStatus', data => updateCustomUserStatus(data.userStatusData)));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./admin/startup");
module.link("./notifications/deleteCustomUserStatus");
module.link("./notifications/updateCustomUserStatus");
module.link("./lib/userStatus", {
  userStatus: "userStatus",
  UserStatusProps: "UserStatusProps"
}, 0);
module.link("./lib/customUserStatus", {
  deleteCustomUserStatus: "deleteCustomUserStatus",
  updateCustomUserStatus: "updateCustomUserStatus"
}, 1);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"utils":{"client":{"lib":{"RestApiClient.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/client/lib/RestApiClient.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  APIClient: () => APIClient
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
let jQuery;
module.link("jquery", {
  default(v) {
    jQuery = v;
  }

}, 2);
let process2faReturn;
module.link("../../../../client/lib/2fa/process2faReturn", {
  process2faReturn(v) {
    process2faReturn = v;
  }

}, 3);
let baseURI;
module.link("../../../../client/lib/baseURI", {
  baseURI(v) {
    baseURI = v;
  }

}, 4);
const APIClient = {
  delete(endpoint, params) {
    return APIClient._jqueryCall('DELETE', endpoint, params);
  },

  get(endpoint, params) {
    return APIClient._jqueryCall('GET', endpoint, params);
  },

  post(endpoint, params, body) {
    if (!body) {
      body = params;
      params = {};
    }

    return APIClient._jqueryCall('POST', endpoint, params, body);
  },

  put(endpoint, params, body) {
    if (!body) {
      body = params;
      params = {};
    }

    return APIClient._jqueryCall('PUT', endpoint, params, body);
  },

  upload(endpoint, params, formData, xhrOptions) {
    if (!formData) {
      formData = params;
      params = {};
    }

    return APIClient._jqueryFormDataCall(endpoint, params, formData, xhrOptions);
  },

  getCredentials() {
    return {
      'X-User-Id': Meteor._localStorage.getItem(Accounts.USER_ID_KEY),
      'X-Auth-Token': Meteor._localStorage.getItem(Accounts.LOGIN_TOKEN_KEY)
    };
  },

  _generateQueryFromParams(params) {
    let query = '';

    if (params && typeof params === 'object') {
      Object.keys(params).forEach(key => {
        query += query === '' ? '?' : '&';

        if (Array.isArray(params[key])) {
          const encodedParams = params[key].map(value => encodeURIComponent(value));
          const joinedArray = encodedParams.join("&".concat(key, "[]="));
          query += "".concat(key, "[]=").concat(joinedArray);
        } else {
          query += "".concat(key, "=").concat(encodeURIComponent(params[key]));
        }
      });
    }

    return query;
  },

  _jqueryCall(method, endpoint, params, body) {
    let headers = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
    let dataType = arguments.length > 5 ? arguments[5] : undefined;

    const query = APIClient._generateQueryFromParams(params);

    return new Promise(function _rlRestApiGet(resolve, reject) {
      jQuery.ajax({
        method,
        url: "".concat(baseURI, "api/").concat(endpoint).concat(query),
        headers: Object.assign(_objectSpread({
          'Content-Type': 'application/json'
        }, APIClient.getCredentials()), headers),
        data: JSON.stringify(body),
        dataType,
        success: function _rlGetSuccess(result) {
          resolve(result);
        },
        error: function _rlGetFailure(xhr, status, errorThrown) {
          APIClient.processTwoFactorError({
            xhr,
            params: [method, endpoint, params, body, headers],
            resolve,
            reject,

            originalCallback() {
              const error = new Error(errorThrown);
              error.xhr = xhr;
              reject(error);
            }

          });
        }
      });
    });
  },

  _jqueryFormDataCall(endpoint, params, formData) {
    let {
      progress = () => {},
      error = () => {}
    } = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
    const ret = {};

    const query = APIClient._generateQueryFromParams(params);

    if (!(formData instanceof FormData)) {
      throw new Error('The formData parameter MUST be an instance of the FormData class.');
    }

    ret.promise = new Promise(function _jqueryFormDataPromise(resolve, reject) {
      ret.xhr = jQuery.ajax({
        xhr() {
          const xhr = new window.XMLHttpRequest();
          xhr.upload.addEventListener('progress', function (evt) {
            if (evt.lengthComputable) {
              const percentComplete = evt.loaded / evt.total;
              progress(percentComplete * 100);
            }
          }, false);
          xhr.upload.addEventListener('error', error, false);
          return xhr;
        },

        url: "".concat(baseURI, "api/").concat(endpoint).concat(query),
        headers: APIClient.getCredentials(),
        data: formData,
        processData: false,
        contentType: false,
        type: 'POST',
        success: function _jqueryFormDataSuccess(result) {
          resolve(result);
        },
        error: function _jqueryFormDataError(xhr, status, errorThrown) {
          const error = new Error(errorThrown);
          error.xhr = xhr;
          reject(error);
        }
      });
    });
    return ret;
  },

  processTwoFactorError(_ref) {
    let {
      xhr,
      params,
      originalCallback,
      resolve,
      reject
    } = _ref;

    if (!xhr.responseJSON || !xhr.responseJSON.errorType) {
      return originalCallback();
    }

    process2faReturn({
      error: xhr.responseJSON,
      originalCallback,

      onCode(code, method) {
        const headers = params[params.length - 1];
        headers['x-2fa-code'] = code;
        headers['x-2fa-method'] = method;

        APIClient._jqueryCall(...params).then(resolve).catch(reject);
      }

    });
  },

  v1: {
    delete(endpoint, params) {
      return APIClient.delete("v1/".concat(endpoint), params);
    },

    get(endpoint, params) {
      return APIClient.get("v1/".concat(endpoint), params);
    },

    post(endpoint, params, body) {
      return APIClient.post("v1/".concat(endpoint), params, body);
    },

    upload(endpoint, params, formData) {
      return APIClient.upload("v1/".concat(endpoint), params, formData);
    },

    put(endpoint, params, body) {
      return APIClient.put("v1/".concat(endpoint), params, body);
    }

  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/client/lib/roomTypes.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  roomTypes: () => roomTypes
});
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 1);
let RoomTypesCommon;
module.link("../../lib/RoomTypesCommon", {
  RoomTypesCommon(v) {
    RoomTypesCommon = v;
  }

}, 2);
let hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 3);
let ChatRoom, ChatSubscription;
module.link("../../../models", {
  ChatRoom(v) {
    ChatRoom = v;
  },

  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 4);
const roomTypes = new class RocketChatRoomTypes extends RoomTypesCommon {
  checkCondition(roomType) {
    return roomType.condition == null || roomType.condition();
  }

  getTypes() {
    return _.sortBy(this.roomTypesOrder, 'order').map(type => this.roomTypes[type.identifier]).filter(type => !type.condition || type.condition());
  }

  getIcon(roomData) {
    if (!roomData || !roomData.t || !this.roomTypes[roomData.t]) {
      return;
    }

    return this.roomTypes[roomData.t].getIcon && this.roomTypes[roomData.t].getIcon(roomData) || this.roomTypes[roomData.t].icon;
  }

  getRoomName(roomType, roomData) {
    return this.roomTypes[roomType] && this.roomTypes[roomType].roomName && this.roomTypes[roomType].roomName(roomData);
  }

  getSecondaryRoomName(roomType, roomData) {
    return this.roomTypes[roomType] && typeof this.roomTypes[roomType].secondaryRoomName === 'function' && this.roomTypes[roomType].secondaryRoomName(roomData);
  }

  getIdentifiers(e) {
    const except = [].concat(e);

    const list = _.reject(this.roomTypesOrder, t => except.indexOf(t.identifier) !== -1);

    return _.map(list, t => t.identifier);
  }

  getUserStatus(roomType, rid) {
    return this.roomTypes[roomType] && typeof this.roomTypes[roomType].getUserStatus === 'function' && this.roomTypes[roomType].getUserStatus(rid);
  }

  getRoomType(roomId) {
    const fields = {
      t: 1
    };
    const room = ChatRoom.findOne({
      _id: roomId
    }, {
      fields
    });
    return room && room.t;
  }

  isLivechatRoom(roomType) {
    return this.roomTypes[roomType] && typeof this.roomTypes[roomType].isLivechatRoom === 'function' && this.roomTypes[roomType].isLivechatRoom();
  }

  showQuickActionButtons(roomType) {
    return this.roomTypes[roomType] && typeof this.roomTypes[roomType].showQuickActionButtons === 'function' && this.roomTypes[roomType].showQuickActionButtons();
  }

  getUserStatusText(roomType, rid) {
    return this.roomTypes[roomType] && typeof this.roomTypes[roomType].getUserStatusText === 'function' && this.roomTypes[roomType].getUserStatusText(rid);
  }

  findRoom(roomType, identifier, user) {
    return this.roomTypes[roomType] && this.roomTypes[roomType].findRoom(identifier, user);
  }

  canSendMessage(rid) {
    return ChatSubscription.find({
      rid
    }).count() > 0;
  }

  readOnly(rid, user) {
    const fields = {
      ro: 1,
      t: 1
    };

    if (user) {
      fields.muted = 1;
      fields.unmuted = 1;
    }

    const room = ChatRoom.findOne({
      _id: rid
    }, {
      fields
    });
    const roomType = room && room.t;

    if (roomType && this.roomTypes[roomType] && this.roomTypes[roomType].readOnly) {
      return this.roomTypes[roomType].readOnly(rid, user);
    }

    if (!user) {
      return room && room.ro;
    }

    if (room) {
      if (Array.isArray(room.muted) && room.muted.indexOf(user.username) !== -1) {
        return true;
      }

      if (room.ro === true) {
        if (Array.isArray(room.unmuted) && room.unmuted.indexOf(user.username) !== -1) {
          return false;
        }

        if (hasAtLeastOnePermission('post-readonly', room._id)) {
          return false;
        }

        return true;
      }
    }

    return false;
  }

  archived(rid) {
    const room = ChatRoom.findOne({
      _id: rid
    }, {
      fields: {
        archived: 1
      }
    });
    return room && room.archived === true;
  }

  verifyCanSendMessage(rid) {
    const room = ChatRoom.findOne({
      _id: rid
    }, {
      fields: {
        t: 1
      }
    });

    if (!room || !room.t) {
      return;
    }

    const roomType = room.t;

    if (this.roomTypes[roomType] && this.roomTypes[roomType].canSendMessage) {
      return this.roomTypes[roomType].canSendMessage(rid);
    }

    return this.canSendMessage(rid);
  }

  verifyShowJoinLink(rid) {
    const room = ChatRoom.findOne({
      _id: rid,
      t: {
        $exists: true,
        $ne: null
      }
    }, {
      fields: {
        t: 1
      }
    });

    if (!room || !room.t) {
      return;
    }

    const roomType = room.t;

    if (this.roomTypes[roomType] && !this.roomTypes[roomType].showJoinLink) {
      return false;
    }

    return this.roomTypes[roomType].showJoinLink(rid);
  }

  getNotSubscribedTpl(rid) {
    const room = ChatRoom.findOne({
      _id: rid,
      t: {
        $exists: true,
        $ne: null
      }
    }, {
      fields: {
        t: 1
      }
    });

    if (!room || !room.t) {
      return;
    }

    const roomType = room.t;

    if (this.roomTypes[roomType] && !this.roomTypes[roomType].notSubscribedTpl) {
      return false;
    }

    return this.roomTypes[roomType].notSubscribedTpl;
  }

  getReadOnlyTpl(rid) {
    const room = ChatRoom.findOne({
      _id: rid,
      t: {
        $exists: true,
        $ne: null
      }
    }, {
      fields: {
        t: 1
      }
    });

    if (!room || !room.t) {
      return;
    }

    const roomType = room.t;
    return this.roomTypes[roomType] && this.roomTypes[roomType].readOnlyTpl;
  }

  openRouteLink(roomType, subData, queryParams) {
    if (!this.roomTypes[roomType]) {
      return false;
    }

    let routeData = {};

    if (this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link) {
      routeData = this.roomTypes[roomType].route.link(subData);
    } else if (subData && subData.name) {
      routeData = {
        name: subData.name
      };
    }

    return FlowRouter.go(this.roomTypes[roomType].route.name, routeData, queryParams);
  }

}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/client/index.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/tapi18n", {
  t: "t",
  isRtl: "isRtl"
}, 0);
module.link("../lib/getDefaultSubscriptionPref", {
  getDefaultSubscriptionPref: "getDefaultSubscriptionPref"
}, 1);
module.link("../rocketchat.info", {
  Info: "Info"
}, 2);
module.link("../lib/getUserPreference", {
  getUserPreference: "getUserPreference"
}, 3);
module.link("../lib/fileUploadRestrictions", {
  fileUploadMediaWhiteList: "fileUploadMediaWhiteList",
  fileUploadIsValidContentType: "fileUploadIsValidContentType"
}, 4);
module.link("./lib/roomTypes", {
  roomTypes: "roomTypes"
}, 5);
module.link("../lib/RoomTypeConfig", {
  RoomTypeRouteConfig: "RoomTypeRouteConfig",
  RoomTypeConfig: "RoomTypeConfig",
  RoomSettingsEnum: "RoomSettingsEnum",
  RoomMemberActions: "RoomMemberActions",
  UiTextContext: "UiTextContext"
}, 6);
module.link("../lib/RoomTypesCommon", {
  RoomTypesCommon: "RoomTypesCommon"
}, 7);
module.link("../lib/getUserAvatarURL", {
  getUserAvatarURL: "getUserAvatarURL"
}, 8);
module.link("../lib/slashCommand", {
  slashCommands: "slashCommands"
}, 9);
module.link("../lib/getUserNotificationPreference", {
  getUserNotificationPreference: "getUserNotificationPreference"
}, 10);
module.link("../lib/getAvatarColor", {
  getAvatarColor: "getAvatarColor"
}, 11);
module.link("../lib/getURL", {
  getURL: "getURL"
}, 12);
module.link("../lib/placeholders", {
  placeholders: "placeholders"
}, 13);
module.link("../lib/templateVarHandler", {
  templateVarHandler: "templateVarHandler"
}, 14);
module.link("./lib/RestApiClient", {
  APIClient: "APIClient"
}, 15);
module.link("../lib/timeConverter", {
  secondsToHHMMSS: "secondsToHHMMSS"
}, 16);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"RoomTypeConfig.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/RoomTypeConfig.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RoomSettingsEnum: () => RoomSettingsEnum,
  RoomMemberActions: () => RoomMemberActions,
  UiTextContext: () => UiTextContext,
  RoomTypeRouteConfig: () => RoomTypeRouteConfig,
  RoomTypeConfig: () => RoomTypeConfig
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 1);
let Users;
let settings;

if (Meteor.isServer) {
  ({
    settings
  } = require('../../settings/server'));
  Users = require('../../models/server/models/Users').default;
} else {
  ({
    settings
  } = require('../../settings/client'));
}

const RoomSettingsEnum = {
  TYPE: 'type',
  NAME: 'roomName',
  TOPIC: 'roomTopic',
  ANNOUNCEMENT: 'roomAnnouncement',
  DESCRIPTION: 'roomDescription',
  READ_ONLY: 'readOnly',
  REACT_WHEN_READ_ONLY: 'reactWhenReadOnly',
  ARCHIVE_OR_UNARCHIVE: 'archiveOrUnarchive',
  JOIN_CODE: 'joinCode',
  BROADCAST: 'broadcast',
  SYSTEM_MESSAGES: 'systemMessages',
  E2E: 'encrypted'
};
const RoomMemberActions = {
  ARCHIVE: 'archive',
  IGNORE: 'ignore',
  BLOCK: 'block',
  MUTE: 'mute',
  SET_AS_OWNER: 'setAsOwner',
  SET_AS_LEADER: 'setAsLeader',
  SET_AS_MODERATOR: 'setAsModerator',
  LEAVE: 'leave',
  REMOVE_USER: 'removeUser',
  JOIN: 'join',
  INVITE: 'invite'
};
const UiTextContext = {
  CLOSE_WARNING: 'closeWarning',
  HIDE_WARNING: 'hideWarning',
  LEAVE_WARNING: 'leaveWarning',
  NO_ROOMS_SUBSCRIBED: 'noRoomsSubscribed'
};

class RoomTypeRouteConfig {
  constructor(_ref) {
    let {
      name,
      path
    } = _ref;

    if (typeof name !== 'undefined' && (typeof name !== 'string' || name.length === 0)) {
      throw new Error('The name must be a string.');
    }

    if (typeof path !== 'undefined' && (typeof path !== 'string' || path.length === 0)) {
      throw new Error('The path must be a string.');
    }

    this._name = name;
    this._path = path;
  }

  get name() {
    return this._name;
  }

  get path() {
    return this._path;
  }

}

class RoomTypeConfig {
  constructor(_ref2) {
    let {
      identifier = Random.id(),
      order,
      icon,
      header,
      label,
      route
    } = _ref2;

    if (typeof identifier !== 'string' || identifier.length === 0) {
      throw new Error('The identifier must be a string.');
    }

    if (typeof order !== 'number') {
      throw new Error('The order must be a number.');
    }

    if (typeof icon !== 'undefined' && (typeof icon !== 'string' || icon.length === 0)) {
      throw new Error('The icon must be a string.');
    }

    if (typeof header !== 'undefined' && (typeof header !== 'string' || header.length === 0)) {
      throw new Error('The header must be a string.');
    }

    if (typeof label !== 'undefined' && (typeof label !== 'string' || label.length === 0)) {
      throw new Error('The label must be a string.');
    }

    if (typeof route !== 'undefined' && !(route instanceof RoomTypeRouteConfig)) {
      throw new Error('Room\'s route is not a valid route configuration. Must be an instance of "RoomTypeRouteConfig".');
    }

    this._identifier = identifier;
    this._order = order;
    this._icon = icon;
    this._header = header;
    this._label = label;
    this._route = route;
  }
  /**
   * The room type's internal identifier.
   */


  get identifier() {
    return this._identifier;
  }
  /**
   * The order of this room type for the display.
   */


  get order() {
    return this._order;
  }
  /**
   * Sets the order of this room type for the display.
   *
   * @param {number} order the number value for the order
   */


  set order(order) {
    if (typeof order !== 'number') {
      throw new Error('The order must be a number.');
    }

    this._order = order;
  }
  /**
   * The icon class, css, to use as the visual aid.
   */


  get icon() {
    return this._icon;
  }
  /**
   * The header name of this type.
   */


  get header() {
    return this._header;
  }
  /**
   * The i18n label for this room type.
   */


  get label() {
    return this._label;
  }
  /**
   * The route config for this room type.
   */


  get route() {
    return this._route;
  }

  allowRoomSettingChange() {
    return true;
  }

  allowMemberAction() {
    return false;
  }
  /**
   * Return a room's name
   *
   * @abstract
   * @return {string} Room's name according to it's type
   */


  roomName() {
    return '';
  }

  canBeCreated(hasPermission) {
    if (!hasPermission && typeof hasPermission !== 'function') {
      throw new Error('You MUST provide the "hasPermission" to canBeCreated function');
    }

    return Meteor.isServer ? hasPermission(Meteor.userId(), "create-".concat(this._identifier)) : hasPermission(["create-".concat(this._identifier)]);
  }

  canBeDeleted(hasPermission, room) {
    if (!hasPermission && typeof hasPermission !== 'function') {
      throw new Error('You MUST provide the "hasPermission" to canBeDeleted function');
    }

    return Meteor.isServer ? hasPermission(Meteor.userId(), "delete-".concat(room.t), room._id) : hasPermission("delete-".concat(room.t), room._id);
  }

  supportMembersList() {
    return true;
  }

  isGroupChat() {
    return false;
  }

  canAddUser() {
    return false;
  }

  userDetailShowAll() {
    return true;
  }

  userDetailShowAdmin() {
    return true;
  }

  preventRenaming() {
    return false;
  }

  includeInRoomSearch() {
    return false;
  }

  enableMembersListProfile() {
    return false;
  }
  /**
   * Returns a text which can be used in generic UIs.
   * @param context The role of the text in the UI-Element
   * @return {string} A text or a translation key - the consumers of this method will pass the
   * returned value to an internationalization library
   */


  getUiText() {
    return '';
  }
  /**
   * Returns the full object of message sender
   * @param {string} senderId Sender's _id
   * @return {object} Sender's object from db
   */


  getMsgSender(senderId) {
    if (Meteor.isServer && Users) {
      return Users.findOneById(senderId);
    }

    return {};
  }
  /**
   * Returns details to use on notifications
   *
   * @param {object} room
   * @param {object} user
   * @param {string} notificationMessage
   * @return {object} Notification details
   */


  getNotificationDetails(room, user, notificationMessage) {
    if (!Meteor.isServer) {
      return {};
    }

    const title = "#".concat(this.roomName(room));
    const text = "".concat(settings.get('UI_Use_Real_Name') ? user.name : user.username, ": ").concat(notificationMessage);
    return {
      title,
      text
    };
  }
  /**
   * Check if there is an user with the same id and loginToken
   * @param {object} allowData
   * @return {object} User's object from db
   */


  canAccessUploadedFile() {
    return false;
  }

  getReadReceiptsExtraData() {
    return {};
  }

  getAvatarPath() {
    return '';
  }

  openCustomProfileTab() {
    return false;
  }

  getDiscussionType() {
    return 'p';
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomTypesCommon.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/RoomTypesCommon.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RoomTypesCommon: () => RoomTypesCommon
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 1);
let RoomTypeConfig;
module.link("./RoomTypeConfig", {
  RoomTypeConfig(v) {
    RoomTypeConfig = v;
  }

}, 2);
let roomExit;
module.link("./roomExit", {
  roomExit(v) {
    roomExit = v;
  }

}, 3);

class RoomTypesCommon {
  constructor() {
    this.roomTypes = {};
    this.roomTypesOrder = [];
    this.mainOrder = 1;
  }

  getTypesToShowOnDashboard() {
    return Object.keys(this.roomTypes).filter(key => this.roomTypes[key].includeInDashboard && this.roomTypes[key].includeInDashboard());
  }
  /**
   * Adds a room type to the application.
   *
   * @param {RoomTypeConfig} roomConfig
   * @returns {void}
   */


  add(roomConfig) {
    if (!(roomConfig instanceof RoomTypeConfig)) {
      throw new Error('Invalid Room Configuration object, it must extend "RoomTypeConfig"');
    }

    if (this.roomTypes[roomConfig.identifier]) {
      return false;
    }

    if (!roomConfig.order) {
      roomConfig.order = this.mainOrder + 10;
      this.mainOrder += 10;
    }

    this.roomTypesOrder.push({
      identifier: roomConfig.identifier,
      order: roomConfig.order
    });
    this.roomTypes[roomConfig.identifier] = roomConfig;

    if (roomConfig.route && roomConfig.route.path && roomConfig.route.name && roomConfig.route.action) {
      const routeConfig = {
        name: roomConfig.route.name,
        action: roomConfig.route.action // triggersExit: [() => Session.set('openedRoom', '')],

      };

      if (Meteor.isClient) {
        routeConfig.triggersExit = [roomExit];
      }

      return FlowRouter.route(roomConfig.route.path, routeConfig);
    }
  }

  hasCustomLink(roomType) {
    return this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link != null;
  }
  /**
   * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))
   * @param {object} subData the user's subscription data
   */


  getRouteLink(roomType, subData) {
    const routeData = this.getRouteData(roomType, subData);

    if (!routeData) {
      return false;
    }

    return FlowRouter.path(this.roomTypes[roomType].route.name, routeData);
  }
  /**
   * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))
   * @param {RoomTypeConfig} roomConfig room's type configuration
   */


  getConfig(roomType) {
    return this.roomTypes[roomType];
  }
  /**
   * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))
   * @param {object} subData the user's subscription data
   */


  getURL(roomType, subData) {
    const routeData = this.getRouteData(roomType, subData);

    if (!routeData) {
      return false;
    }

    return FlowRouter.url(this.roomTypes[roomType].route.name, routeData);
  }

  getRelativePath(roomType, subData) {
    return this.getRouteLink(roomType, subData).replace(Meteor.absoluteUrl(), '');
  }

  getRouteData(roomType, subData) {
    if (!this.roomTypes[roomType]) {
      return false;
    }

    let routeData = {};

    if (this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link) {
      routeData = this.roomTypes[roomType].route.link(subData);
    } else if (subData && subData.name) {
      routeData = {
        rid: subData.rid || subData._id,
        name: subData.name
      };
    }

    return routeData;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"fileUploadRestrictions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/fileUploadRestrictions.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  fileUploadIsValidContentType: () => fileUploadIsValidContentType
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 1);
let settings;

if (Meteor.isClient) {
  settings = require('../../settings/client').settings;
} else {
  settings = require('../../settings/server').settings;
}

const fileUploadMediaWhiteList = function (customWhiteList) {
  const mediaTypeWhiteList = customWhiteList || settings.get('FileUpload_MediaTypeWhiteList');

  if (!mediaTypeWhiteList || mediaTypeWhiteList === '*') {
    return;
  }

  return _.map(mediaTypeWhiteList.split(','), function (item) {
    return item.trim();
  });
};

const fileUploadMediaBlackList = function () {
  const blacklist = settings.get('FileUpload_MediaTypeBlackList');

  if (!blacklist) {
    return;
  }

  return _.map(blacklist.split(','), item => item.trim());
};

const isTypeOnList = function (type, list) {
  if (_.contains(list, type)) {
    return true;
  }

  const wildCardGlob = '/*';

  const wildcards = _.filter(list, function (item) {
    return item.indexOf(wildCardGlob) > 0;
  });

  if (_.contains(wildcards, type.replace(/(\/.*)$/, wildCardGlob))) {
    return true;
  }
};

const fileUploadIsValidContentType = function (type, customWhiteList) {
  const blackList = fileUploadMediaBlackList();
  const whiteList = fileUploadMediaWhiteList(customWhiteList);

  if (!type && blackList) {
    return false;
  }

  if (blackList && isTypeOnList(type, blackList)) {
    return false;
  }

  if (!whiteList) {
    return true;
  }

  return isTypeOnList(type, whiteList);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getAvatarColor.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getAvatarColor.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getAvatarColor: () => getAvatarColor
});
const colors = ['#F44336', '#E91E63', '#9C27B0', '#673AB7', '#3F51B5', '#2196F3', '#03A9F4', '#00BCD4', '#009688', '#4CAF50', '#8BC34A', '#CDDC39', '#FFC107', '#FF9800', '#FF5722', '#795548', '#9E9E9E', '#607D8B'];

const getAvatarColor = name => colors[name.length % colors.length];
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getAvatarURL.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getAvatarURL.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getAvatarURL: () => getAvatarURL
});
let getURL;
module.link("./getURL", {
  getURL(v) {
    getURL = v;
  }

}, 0);

const getAvatarURL = _ref => {
  let {
    username,
    roomId,
    cache
  } = _ref;

  if (username) {
    return getURL("/avatar/".concat(encodeURIComponent(username)).concat(cache ? "?etag=".concat(cache) : ''));
  }

  if (roomId) {
    return getURL("/avatar/room/".concat(encodeURIComponent(roomId)).concat(cache ? "?etag=".concat(cache) : ''));
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getDefaultSubscriptionPref.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getDefaultSubscriptionPref.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getDefaultSubscriptionPref: () => getDefaultSubscriptionPref
});

const getDefaultSubscriptionPref = userPref => {
  const subscription = {};
  const {
    desktopNotifications,
    pushNotifications,
    emailNotificationMode,
    highlights
  } = userPref.settings && userPref.settings.preferences || {};

  if (Array.isArray(highlights) && highlights.length) {
    subscription.userHighlights = highlights;
  }

  if (desktopNotifications && desktopNotifications !== 'default') {
    subscription.desktopNotifications = desktopNotifications;
    subscription.desktopPrefOrigin = 'user';
  }

  if (pushNotifications && pushNotifications !== 'default') {
    subscription.mobilePushNotifications = pushNotifications;
    subscription.mobilePrefOrigin = 'user';
  }

  if (emailNotificationMode && emailNotificationMode !== 'default') {
    subscription.emailNotifications = emailNotificationMode;
    subscription.emailPrefOrigin = 'user';
  }

  return subscription;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getRoomAvatarURL.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getRoomAvatarURL.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getRoomAvatarURL: () => getRoomAvatarURL
});
let getAvatarURL;
module.link("./getAvatarURL", {
  getAvatarURL(v) {
    getAvatarURL = v;
  }

}, 0);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);

const getRoomAvatarURL = function (roomId, etag) {
  const externalSource = (settings.get('Accounts_RoomAvatarExternalProviderUrl') || '').trim().replace(/\/$/, '');

  if (externalSource !== '') {
    return externalSource.replace('{roomId}', roomId);
  }

  if (!roomId) {
    return;
  }

  return getAvatarURL({
    roomId,
    cache: etag
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getURL.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getURL.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  _getURL: () => _getURL,
  getURL: () => getURL
});
let s;
module.link("underscore.string", {
  default(v) {
    s = v;
  }

}, 0);
let escapeRegExp;
module.link("@rocket.chat/string-helpers", {
  escapeRegExp(v) {
    escapeRegExp = v;
  }

}, 1);
let isURL;
module.link("./isURL", {
  isURL(v) {
    isURL = v;
  }

}, 2);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);

function getCloudUrl(path, _site_url, cloudRoute) {
  let cloudParams = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
  const cloudBaseUrl = (settings.get('DeepLink_Url') || '').replace(/\/+$/, '');
  const siteUrl = s.rtrim(_site_url, '/'); // Remove the protocol

  const host = siteUrl.replace(/https?\:\/\//i, '');
  path = s.ltrim(path, '/');
  Object.assign(cloudParams, {
    host,
    path
  });

  if (siteUrl.includes('http://')) {
    cloudParams.secure = 'no';
  }

  const params = Object.entries(cloudParams).map(_ref => {
    let [key, value] = _ref;
    return "".concat(key, "=").concat(encodeURIComponent(value));
  }).join('&');
  return "".concat(cloudBaseUrl, "/").concat(cloudRoute, "?").concat(params);
}

const _getURL = (path, _ref2) => {
  let {
    cdn,
    full,
    cloud,
    cloud_route,
    cloud_params,
    _cdn_prefix,
    _root_url_path_prefix,
    _site_url
  } = _ref2;

  if (isURL(path)) {
    return path;
  }

  const [_path, _query] = path.split('?');
  path = _path;
  const query = _query ? "?".concat(_query) : '';
  const siteUrl = s.rtrim(s.trim(_site_url || ''), '/');
  const cloudRoute = s.trim(cloud_route || '');
  const cdnPrefix = s.rtrim(s.trim(_cdn_prefix || ''), '/');
  const pathPrefix = s.rtrim(s.trim(_root_url_path_prefix || ''), '/');
  const finalPath = s.ltrim(s.trim(path), '/');
  const url = s.rtrim("".concat(pathPrefix, "/").concat(finalPath), '/') + query;

  if (cloud) {
    const cloudParams = cloud_params || {};
    return getCloudUrl(url, siteUrl, cloudRoute, cloudParams);
  }

  if (cdn && cdnPrefix !== '') {
    return cdnPrefix + url;
  }

  if (full) {
    return siteUrl.replace(new RegExp("".concat(escapeRegExp(pathPrefix), "$")), '') + url;
  }

  return url;
};

const getURL = function (path) {
  let {
    cdn = true,
    full = false,
    cloud = false,
    cloud_route = '',
    cloud_params = {}
  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  return _getURL(path, {
    cdn,
    full,
    cloud,
    cloud_route,
    cloud_params,
    _cdn_prefix: settings.get('CDN_PREFIX'),
    _root_url_path_prefix: __meteor_runtime_config__.ROOT_URL_PATH_PREFIX,
    _site_url: settings.get('Site_Url')
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getUserAvatarURL.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getUserAvatarURL.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getUserAvatarURL: () => getUserAvatarURL
});
let getAvatarURL;
module.link("./getAvatarURL", {
  getAvatarURL(v) {
    getAvatarURL = v;
  }

}, 0);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);

const getUserAvatarURL = function (username) {
  let cache = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
  const externalSource = (settings.get('Accounts_AvatarExternalProviderUrl') || '').trim().replace(/\/$/, '');

  if (externalSource !== '') {
    return externalSource.replace('{username}', username);
  }

  if (username == null) {
    return;
  }

  return getAvatarURL({
    username,
    cache
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getUserNotificationPreference.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getUserNotificationPreference.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getUserNotificationPreference: () => getUserNotificationPreference
});
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 0);
let Users;
module.link("../../models", {
  Users(v) {
    Users = v;
  }

}, 1);

const getUserNotificationPreference = (user, pref) => {
  var _user, _user$settings;

  if (typeof user === 'string') {
    user = Users.findOneById(user);
  }

  let preferenceKey;

  switch (pref) {
    case 'desktop':
      preferenceKey = 'desktopNotifications';
      break;

    case 'mobile':
      preferenceKey = 'pushNotifications';
      break;

    case 'email':
      preferenceKey = 'emailNotificationMode';
      break;
  }

  if ((_user = user) !== null && _user !== void 0 && (_user$settings = _user.settings) !== null && _user$settings !== void 0 && _user$settings.preferences && typeof user.settings.preferences[preferenceKey] !== 'undefined' && user.settings.preferences[preferenceKey] !== 'default') {
    return {
      value: user.settings.preferences[preferenceKey],
      origin: 'user'
    };
  }

  const serverValue = settings.get("Accounts_Default_User_Preferences_".concat(preferenceKey));

  if (serverValue) {
    return {
      value: serverValue,
      origin: 'server'
    };
  }

  return null;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getUserPreference.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getUserPreference.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getUserPreference: () => getUserPreference
});
let Users;
module.link("../../models", {
  Users(v) {
    Users = v;
  }

}, 0);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);

const getUserPreference = function (user, key) {
  let defaultValue = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;
  let preference;

  if (typeof user === typeof '') {
    user = Users.findOne(user, {
      fields: {
        ["settings.preferences.".concat(key)]: 1
      }
    });
  }

  if (user && user.settings && user.settings.preferences && user.settings.preferences.hasOwnProperty(key)) {
    preference = user.settings.preferences[key];
  } else if (defaultValue === undefined) {
    preference = settings.get("Accounts_Default_User_Preferences_".concat(key));
  }

  return preference !== undefined ? preference : defaultValue;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"isURL.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/isURL.js                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isURL: () => isURL,
  isRelativeURL: () => isRelativeURL
});

const isURL = str => /^(https?:\/\/|data:)/.test(str);

const isRelativeURL = str => /^[^\/]+\/[^\/].*$|^\/[^\/].*$/gim.test(str);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"mimeTypes.js":[
  "mime-type/with-db"
],"placeholders.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/placeholders.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  placeholders: () => placeholders
});
let s;
module.link("underscore.string", {
  default(v) {
    s = v;
  }

}, 0);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 1);
const placeholders = {
  replace: (str, data) => {
    if (!str) {
      return '';
    }

    str = str.replace(/\[Site_Name\]/g, settings.get('Site_Name') || '');
    str = str.replace(/\[Site_URL\]/g, settings.get('Site_Url') || '');

    if (data) {
      str = str.replace(/\[name\]/g, data.name || '');
      str = str.replace(/\[fname\]/g, s.strLeft(data.name, ' ') || '');
      str = str.replace(/\[lname\]/g, s.strRightBack(data.name, ' ') || '');
      str = str.replace(/\[email\]/g, data.email || '');
      str = str.replace(/\[password\]/g, data.password || '');
      str = str.replace(/\[reason\]/g, data.reason || '');
      str = str.replace(/\[User\]/g, data.user || '');
      str = str.replace(/\[Room\]/g, data.room || '');

      if (data.unsubscribe) {
        str = str.replace(/\[unsubscribe\]/g, data.unsubscribe);
      }
    }

    str = str.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1<br>$2');
    return str;
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomExit.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/roomExit.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  roomExit: () => roomExit
});
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 2);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);

const testIfPathAreEquals = function () {
  let oldPath = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  let newPath = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
  return oldPath.replace(/"/g, '') === newPath;
};

const roomExit = function () {
  const oldRoute = FlowRouter.current();
  Tracker.afterFlush(() => {
    const context = FlowRouter.current();

    if (oldRoute && testIfPathAreEquals(oldRoute.params.name || oldRoute.params.rid || oldRoute.params.id, context.params.name || context.params.rid || context.params.id)) {
      return;
    } // 7370 - Close flex-tab when opening a room on mobile UI


    if (window.matchMedia('(max-width: 500px)').matches) {
      const flex = document.querySelector('.flex-tab');

      if (flex) {
        const templateData = Blaze.getData(flex);
        templateData && templateData.tabBar && templateData.tabBar.close();
      }
    }

    callbacks.run('roomExit'); // Session.set('lastOpenedRoom', Session.get('openedRoom'));
    // Session.set('openedRoom', null);
    // RoomManager.openedRoom = null;
  });

  if (typeof window.currentTracker !== 'undefined') {
    window.currentTracker.stop();
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"slashCommand.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/slashCommand.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  slashCommands: () => slashCommands
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
const slashCommands = {
  commands: {},
  add: function _addingSlashCommand(command, callback) {
    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
    let result = arguments.length > 3 ? arguments[3] : undefined;
    let providesPreview = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
    let previewer = arguments.length > 5 ? arguments[5] : undefined;
    let previewCallback = arguments.length > 6 ? arguments[6] : undefined;
    slashCommands.commands[command] = {
      command,
      callback,
      params: options.params,
      description: options.description,
      permission: options.permission,
      clientOnly: options.clientOnly || false,
      result,
      providesPreview,
      previewer,
      previewCallback
    };
  },
  run: function _runningSlashCommand(command, params, message, triggerId) {
    if (slashCommands.commands[command] && typeof slashCommands.commands[command].callback === 'function') {
      if (!message || !message.rid) {
        throw new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');
      }

      return slashCommands.commands[command].callback(command, params, message, triggerId);
    }
  },
  getPreviews: function _executeSlashCommandPreview(command, params, message, preview, triggerId) {
    if (slashCommands.commands[command] && typeof slashCommands.commands[command].previewCallback === 'function') {
      if (!message || !message.rid) {
        throw new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');
      } // { id, type, value }


      if (!preview.id || !preview.type || !preview.value) {
        throw new Meteor.Error('error-invalid-preview', 'Preview Item must have an id, type, and value.');
      }

      return slashCommands.commands[command].previewCallback(command, params, message, preview, triggerId);
    }
  },
  executePreview: function _executeSlashCommandPreview(command, params, message, preview, triggerId) {
    if (slashCommands.commands[command] && typeof slashCommands.commands[command].previewCallback === 'function') {
      if (!message || !message.rid) {
        throw new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');
      } // { id, type, value }


      if (!preview.id || !preview.type || !preview.value) {
        throw new Meteor.Error('error-invalid-preview', 'Preview Item must have an id, type, and value.');
      }

      return slashCommands.commands[command].previewCallback(command, params, message, preview, triggerId);
    }
  }
};
Meteor.methods({
  slashCommand(command) {
    if (!Meteor.userId()) {
      throw new Meteor.Error('error-invalid-user', 'Invalid user', {
        method: 'slashCommand'
      });
    }

    if (!command || !command.cmd || !slashCommands.commands[command.cmd]) {
      throw new Meteor.Error('error-invalid-command', 'Invalid Command Provided', {
        method: 'executeSlashCommandPreview'
      });
    }

    return slashCommands.run(command.cmd, command.params, command.msg, command.triggerId);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tapi18n.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/tapi18n.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  t: () => t,
  isRtl: () => isRtl
});

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 1);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 2);

const t = function (key) {
  for (var _len = arguments.length, replaces = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    replaces[_key - 1] = arguments[_key];
  }

  if (_.isObject(replaces[0])) {
    return TAPi18n.__(key, ...replaces);
  }

  return TAPi18n.__(key, {
    postProcess: 'sprintf',
    sprintf: replaces
  });
};

const isRtl = lang => {
  const language = lang || Meteor._localStorage.getItem('userLanguage') || 'en-US';
  return ['ar', 'dv', 'fa', 'he', 'ku', 'ps', 'sd', 'ug', 'ur', 'yi'].includes(language.split('-').shift().toLowerCase());
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"templateVarHandler.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/templateVarHandler.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  templateVarHandler: () => templateVarHandler
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let logger;

if (Meteor.isServer) {
  const {
    Logger
  } = require('../../../server/lib/logger/Logger');

  logger = new Logger('TemplateVarHandler');
}

const templateVarHandler = function (variable, object) {
  const templateRegex = /#{([\w\-]+)}/gi;
  let match = templateRegex.exec(variable);
  let tmpVariable = variable;

  if (match == null) {
    if (!object.hasOwnProperty(variable)) {
      logger && logger.debug("user does not have attribute: ".concat(variable));
      return;
    }

    return object[variable];
  }

  logger && logger.debug('template found. replacing values');

  while (match != null) {
    const tmplVar = match[0];
    const tmplAttrName = match[1];

    if (!object.hasOwnProperty(tmplAttrName)) {
      logger && logger.debug("user does not have attribute: ".concat(tmplAttrName));
      return;
    }

    const attrVal = object[tmplAttrName];
    logger && logger.debug("replacing template var: ".concat(tmplVar, " with value: ").concat(attrVal));
    tmpVariable = tmpVariable.replace(tmplVar, attrVal);
    match = templateRegex.exec(variable);
  }

  return tmpVariable;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"timeConverter.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/timeConverter.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  secondsToHHMMSS: () => secondsToHHMMSS
});

const secondsToHHMMSS = sec => {
  sec = parseFloat(sec);
  let hours = Math.floor(sec / 3600);
  let minutes = Math.floor((sec - hours * 3600) / 60);
  let seconds = Math.round(sec - hours * 3600 - minutes * 60);

  if (hours < 10) {
    hours = "0".concat(hours);
  }

  if (minutes < 10) {
    minutes = "0".concat(minutes);
  }

  if (seconds < 10) {
    seconds = "0".concat(seconds);
  }

  if (hours > 0) {
    return "".concat(hours, ":").concat(minutes, ":").concat(seconds);
  }

  if (minutes > 0) {
    return "00:".concat(minutes, ":").concat(seconds);
  }

  return "00:00:".concat(seconds);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"stream":{"constants.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/stream/constants.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ROOM_DATA_STREAM: () => ROOM_DATA_STREAM
});
const ROOM_DATA_STREAM = 'room-data';
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/index.js                                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.info":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/rocketchat.info                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./rocketchat.info.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.info.js":function module(require,exports){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/rocketchat.info.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
exports.Info = {
    "version": "4.4.0-develop",
    "build": {
        "date": "2022-06-11T15:31:53.604Z",
        "nodeVersion": "v14.18.2",
        "arch": "arm64",
        "platform": "darwin",
        "osRelease": "21.3.0",
        "totalMemory": 8589934592,
        "freeMemory": 130285568,
        "cpus": 8
    },
    "commit": {
        "hash": "d9c65c60ac3393ee94db775221f03a042874afd1",
        "date": "Fri Jan 28 20:14:46 2022 -0300",
        "author": "Diego Sampaio",
        "subject": "Merge branch 'master' into develop",
        "tag": "4.3.3",
        "branch": "develop"
    },
    "marketplaceApiVersion": "1.30.0"
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"dolphin":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/dolphin/lib/common.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration(v) {
    ServiceConfiguration = v;
  }

}, 2);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);
let CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth(v) {
    CustomOAuth = v;
  }

}, 4);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 5);
const config = {
  serverURL: '',
  authorizePath: '/m/oauth2/auth/',
  tokenPath: '/m/oauth2/token/',
  identityPath: '/m/oauth2/api/me/',
  scope: 'basic',
  addAutopublishFields: {
    forLoggedInUser: ['services.dolphin'],
    forOtherUsers: ['services.dolphin.name']
  },
  accessTokenParam: 'access_token'
};
const Dolphin = new CustomOAuth('dolphin', config);

function DolphinOnCreateUser(options, user) {
  if (user && user.services && user.services.dolphin && user.services.dolphin.NickName) {
    user.username = user.services.dolphin.NickName;
  }

  return options;
}

if (Meteor.isServer) {
  Meteor.startup(() => settings.get('Accounts_OAuth_Dolphin_URL', (key, value) => {
    config.serverURL = value;
    return Dolphin.configure(config);
  }));

  if (settings.get('Accounts_OAuth_Dolphin_URL')) {
    const data = {
      buttonLabelText: settings.get('Accounts_OAuth_Dolphin_button_label_text'),
      buttonColor: settings.get('Accounts_OAuth_Dolphin_button_color'),
      buttonLabelColor: settings.get('Accounts_OAuth_Dolphin_button_label_color'),
      clientId: settings.get('Accounts_OAuth_Dolphin_id'),
      secret: settings.get('Accounts_OAuth_Dolphin_secret'),
      serverURL: settings.get('Accounts_OAuth_Dolphin_URL'),
      loginStyle: settings.get('Accounts_OAuth_Dolphin_login_style')
    };
    ServiceConfiguration.configurations.upsert({
      service: 'dolphin'
    }, {
      $set: data
    });
  }

  callbacks.add('beforeCreateUser', DolphinOnCreateUser, callbacks.priority.HIGH, 'dolphin');
} else {
  Meteor.startup(() => Tracker.autorun(function () {
    if (settings.get('Accounts_OAuth_Dolphin_URL')) {
      config.serverURL = settings.get('Accounts_OAuth_Dolphin_URL');
      return Dolphin.configure(config);
    }
  }));
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/dolphin/client/index.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./login-button.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/dolphin/client/login-button.css                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"drupal":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/drupal/lib/common.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);
let CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth(v) {
    CustomOAuth = v;
  }

}, 3);
// Drupal Server CallBack URL needs to be http(s)://{rocketchat.server}[:port]/_oauth/drupal
// In RocketChat -> Administration the URL needs to be http(s)://{drupal.server}/
const config = {
  serverURL: '',
  identityPath: '/oauth2/UserInfo',
  authorizePath: '/oauth2/authorize',
  tokenPath: '/oauth2/token',
  scope: 'openid email profile offline_access',
  tokenSentVia: 'payload',
  usernameField: 'preferred_username',
  mergeUsers: true,
  addAutopublishFields: {
    forLoggedInUser: ['services.drupal'],
    forOtherUsers: ['services.drupal.name']
  },
  accessTokenParam: 'access_token'
};
const Drupal = new CustomOAuth('drupal', config);

if (Meteor.isServer) {
  Meteor.startup(function () {
    settings.get('API_Drupal_URL', function (key, value) {
      config.serverURL = value;
      Drupal.configure(config);
    });
  });
} else {
  Meteor.startup(function () {
    Tracker.autorun(function () {
      if (settings.get('API_Drupal_URL')) {
        config.serverURL = settings.get('API_Drupal_URL');
        Drupal.configure(config);
      }
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/drupal/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./login-button.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/drupal/client/login-button.css                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"emoji-emojione":{"lib":{"emojiPicker.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-emojione/lib/emojiPicker.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  emojiCategories: () => emojiCategories,
  toneList: () => toneList,
  emojisByCategory: () => emojisByCategory
});
const emojiCategories = [{
  key: 'people',
  i18n: 'Smileys_and_People'
}, {
  key: 'nature',
  i18n: 'Animals_and_Nature'
}, {
  key: 'food',
  i18n: 'Food_and_Drink'
}, {
  key: 'activity',
  i18n: 'Activity'
}, {
  key: 'travel',
  i18n: 'Travel_and_Places'
}, {
  key: 'objects',
  i18n: 'Objects'
}, {
  key: 'symbols',
  i18n: 'Symbols'
}, {
  key: 'flags',
  i18n: 'Flags'
}];
const toneList = {
  'snowboarder': 1,
  'person_lifting_weights': 1,
  'woman_lifting_weights': 1,
  'man_lifting_weights': 1,
  'person_doing_cartwheel': 1,
  'woman_cartwheeling': 1,
  'man_cartwheeling': 1,
  'person_bouncing_ball': 1,
  'woman_bouncing_ball': 1,
  'man_bouncing_ball': 1,
  'person_playing_handball': 1,
  'woman_playing_handball': 1,
  'man_playing_handball': 1,
  'person_golfing': 1,
  'woman_golfing': 1,
  'man_golfing': 1,
  'horse_racing': 1,
  'person_in_lotus_position': 1,
  'woman_in_lotus_position': 1,
  'man_in_lotus_position': 1,
  'person_surfing': 1,
  'woman_surfing': 1,
  'man_surfing': 1,
  'person_swimming': 1,
  'woman_swimming': 1,
  'man_swimming': 1,
  'person_playing_water_polo': 1,
  'woman_playing_water_polo': 1,
  'man_playing_water_polo': 1,
  'person_rowing_boat': 1,
  'woman_rowing_boat': 1,
  'man_rowing_boat': 1,
  'person_climbing': 1,
  'woman_climbing': 1,
  'man_climbing': 1,
  'person_mountain_biking': 1,
  'woman_mountain_biking': 1,
  'man_mountain_biking': 1,
  'person_biking': 1,
  'woman_biking': 1,
  'man_biking': 1,
  'person_juggling': 1,
  'woman_juggling': 1,
  'man_juggling': 1,
  'bath': 1,
  'person_in_bed': 1,
  'palms_up_together': 1,
  'open_hands': 1,
  'raised_hands': 1,
  'clap': 1,
  'thumbsup': 1,
  'thumbsdown': 1,
  'punch': 1,
  'fist': 1,
  'left_facing_fist': 1,
  'right_facing_fist': 1,
  'fingers_crossed': 1,
  'v': 1,
  'love_you_gesture': 1,
  'metal': 1,
  'ok_hand': 1,
  'point_left': 1,
  'point_right': 1,
  'point_up_2': 1,
  'point_down': 1,
  'point_up': 1,
  'raised_hand': 1,
  'raised_back_of_hand': 1,
  'hand_splayed': 1,
  'vulcan': 1,
  'wave': 1,
  'call_me': 1,
  'muscle': 1,
  'leg': 1,
  'foot': 1,
  'middle_finger': 1,
  'writing_hand': 1,
  'pray': 1,
  'ear': 1,
  'nose': 1,
  'baby': 1,
  'girl': 1,
  'child': 1,
  'boy': 1,
  'woman': 1,
  'adult': 1,
  'man': 1,
  'blond_haired_person': 1,
  'blond-haired_woman': 1,
  'blond-haired_man': 1,
  'woman_red_haired': 1,
  'man_red_haired': 1,
  'woman_curly_haired': 1,
  'man_curly_haired': 1,
  'woman_white_haired': 1,
  'man_white_haired': 1,
  'woman_bald': 1,
  'man_bald': 1,
  'bearded_person': 1,
  'older_woman': 1,
  'older_adult': 1,
  'older_man': 1,
  'man_with_chinese_cap': 1,
  'person_wearing_turban': 1,
  'woman_wearing_turban': 1,
  'man_wearing_turban': 1,
  'woman_with_headscarf': 1,
  'police_officer': 1,
  'woman_police_officer': 1,
  'man_police_officer': 1,
  'construction_worker': 1,
  'woman_construction_worker': 1,
  'man_construction_worker': 1,
  'guard': 1,
  'woman_guard': 1,
  'man_guard': 1,
  'detective': 1,
  'woman_detective': 1,
  'man_detective': 1,
  'woman_health_worker': 1,
  'man_health_worker': 1,
  'woman_farmer': 1,
  'man_farmer': 1,
  'woman_cook': 1,
  'man_cook': 1,
  'woman_student': 1,
  'man_student': 1,
  'woman_singer': 1,
  'man_singer': 1,
  'woman_teacher': 1,
  'man_teacher': 1,
  'woman_factory_worker': 1,
  'man_factory_worker': 1,
  'woman_technologist': 1,
  'man_technologist': 1,
  'woman_office_worker': 1,
  'man_office_worker': 1,
  'woman_mechanic': 1,
  'man_mechanic': 1,
  'woman_scientist': 1,
  'man_scientist': 1,
  'woman_artist': 1,
  'man_artist': 1,
  'woman_firefighter': 1,
  'man_firefighter': 1,
  'woman_pilot': 1,
  'man_pilot': 1,
  'woman_astronaut': 1,
  'man_astronaut': 1,
  'woman_judge': 1,
  'man_judge': 1,
  'bride_with_veil': 1,
  'man_in_tuxedo': 1,
  'princess': 1,
  'prince': 1,
  'mrs_claus': 1,
  'santa': 1,
  'superhero': 1,
  'woman_superhero': 1,
  'man_superhero': 1,
  'supervillain': 1,
  'woman_supervillain': 1,
  'man_supervillain': 1,
  'mage': 1,
  'woman_mage': 1,
  'man_mage': 1,
  'elf': 1,
  'woman_elf': 1,
  'man_elf': 1,
  'vampire': 1,
  'woman_vampire': 1,
  'man_vampire': 1,
  'merperson': 1,
  'mermaid': 1,
  'merman': 1,
  'fairy': 1,
  'woman_fairy': 1,
  'man_fairy': 1,
  'angel': 1,
  'pregnant_woman': 1,
  'breast_feeding': 1,
  'person_bowing': 1,
  'woman_bowing': 1,
  'man_bowing': 1,
  'person_tipping_hand': 1,
  'woman_tipping_hand': 1,
  'man_tipping_hand': 1,
  'person_gesturing_no': 1,
  'woman_gesturing_no': 1,
  'man_gesturing_no': 1,
  'person_gesturing_ok': 1,
  'woman_gesturing_ok': 1,
  'man_gesturing_ok': 1,
  'person_raising_hand': 1,
  'woman_raising_hand': 1,
  'man_raising_hand': 1,
  'person_facepalming': 1,
  'woman_facepalming': 1,
  'man_facepalming': 1,
  'person_shrugging': 1,
  'woman_shrugging': 1,
  'man_shrugging': 1,
  'person_pouting': 1,
  'woman_pouting': 1,
  'man_pouting': 1,
  'person_frowning': 1,
  'woman_frowning': 1,
  'man_frowning': 1,
  'person_getting_haircut': 1,
  'woman_getting_haircut': 1,
  'man_getting_haircut': 1,
  'person_getting_massage': 1,
  'woman_getting_face_massage': 1,
  'man_getting_face_massage': 1,
  'person_in_steamy_room': 1,
  'woman_in_steamy_room': 1,
  'man_in_steamy_room': 1,
  'nail_care': 1,
  'selfie': 1,
  'dancer': 1,
  'man_dancing': 1,
  'levitate': 1,
  'person_walking': 1,
  'woman_walking': 1,
  'man_walking': 1,
  'person_running': 1,
  'woman_running': 1,
  'man_running': 1
};
const emojisByCategory = {
  symbols: ['heart', 'orange_heart', 'yellow_heart', 'green_heart', 'blue_heart', 'purple_heart', 'black_heart', 'broken_heart', 'heart_exclamation', 'two_hearts', 'revolving_hearts', 'heartbeat', 'heartpulse', 'sparkling_heart', 'cupid', 'gift_heart', 'heart_decoration', 'peace', 'cross', 'star_and_crescent', 'om_symbol', 'wheel_of_dharma', 'star_of_david', 'six_pointed_star', 'menorah', 'yin_yang', 'orthodox_cross', 'place_of_worship', 'ophiuchus', 'aries', 'taurus', 'gemini', 'cancer', 'leo', 'virgo', 'libra', 'scorpius', 'sagittarius', 'capricorn', 'aquarius', 'pisces', 'id', 'atom', 'infinity', 'accept', 'radioactive', 'biohazard', 'mobile_phone_off', 'vibration_mode', 'u6709', 'u7121', 'u7533', 'u55b6', 'u6708', 'eight_pointed_black_star', 'vs', 'white_flower', 'ideograph_advantage', 'secret', 'congratulations', 'u5408', 'u6e80', 'u5272', 'u7981', 'a', 'b', 'ab', 'cl', 'o2', 'sos', 'x', 'o', 'octagonal_sign', 'no_entry', 'name_badge', 'no_entry_sign', '100', 'anger', 'hotsprings', 'no_pedestrians', 'do_not_litter', 'no_bicycles', 'non-potable_water', 'underage', 'no_mobile_phones', 'no_smoking', 'exclamation', 'grey_exclamation', 'question', 'grey_question', 'bangbang', 'interrobang', 'low_brightness', 'high_brightness', 'part_alternation_mark', 'warning', 'children_crossing', 'trident', 'fleur-de-lis', 'beginner', 'recycle', 'white_check_mark', 'u6307', 'chart', 'sparkle', 'eight_spoked_asterisk', 'negative_squared_cross_mark', 'globe_with_meridians', 'diamond_shape_with_a_dot_inside', 'm', 'cyclone', 'zzz', 'atm', 'wc', 'wheelchair', 'parking', 'u7a7a', 'sa', 'passport_control', 'customs', 'baggage_claim', 'left_luggage', 'mens', 'womens', 'baby_symbol', 'restroom', 'put_litter_in_its_place', 'cinema', 'signal_strength', 'koko', 'symbols', 'information_source', 'abc', 'abcd', 'capital_abcd', 'ng', 'ok', 'up', 'cool', 'new', 'free', 'zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'keycap_ten', '1234', 'hash', 'asterisk', 'eject', 'arrow_forward', 'pause_button', 'play_pause', 'stop_button', 'record_button', 'track_next', 'track_previous', 'fast_forward', 'rewind', 'arrow_double_up', 'arrow_double_down', 'arrow_backward', 'arrow_up_small', 'arrow_down_small', 'arrow_right', 'arrow_left', 'arrow_up', 'arrow_down', 'arrow_upper_right', 'arrow_lower_right', 'arrow_lower_left', 'arrow_upper_left', 'arrow_up_down', 'left_right_arrow', 'arrow_right_hook', 'leftwards_arrow_with_hook', 'arrow_heading_up', 'arrow_heading_down', 'twisted_rightwards_arrows', 'repeat', 'repeat_one', 'arrows_counterclockwise', 'arrows_clockwise', 'musical_note', 'notes', 'heavy_plus_sign', 'heavy_minus_sign', 'heavy_division_sign', 'heavy_multiplication_x', 'heavy_dollar_sign', 'currency_exchange', 'tm', 'copyright', 'registered', 'wavy_dash', 'curly_loop', 'loop', 'end', 'back', 'on', 'top', 'soon', 'heavy_check_mark', 'ballot_box_with_check', 'radio_button', 'white_circle', 'black_circle', 'red_circle', 'blue_circle', 'small_red_triangle', 'small_red_triangle_down', 'small_orange_diamond', 'small_blue_diamond', 'large_orange_diamond', 'large_blue_diamond', 'white_square_button', 'black_square_button', 'black_small_square', 'white_small_square', 'black_medium_small_square', 'white_medium_small_square', 'black_medium_square', 'white_medium_square', 'black_large_square', 'white_large_square', 'speaker', 'mute', 'sound', 'loud_sound', 'bell', 'no_bell', 'mega', 'loudspeaker', 'speech_left', 'eye_in_speech_bubble', 'speech_balloon', 'thought_balloon', 'anger_right', 'spades', 'clubs', 'hearts', 'diamonds', 'black_joker', 'flower_playing_cards', 'mahjong', 'clock1', 'clock2', 'clock3', 'clock4', 'clock5', 'clock6', 'clock7', 'clock8', 'clock9', 'clock10', 'clock11', 'clock12', 'clock130', 'clock230', 'clock330', 'clock430', 'clock530', 'clock630', 'clock730', 'clock830', 'clock930', 'clock1030', 'clock1130', 'clock1230', 'digit_zero', 'digit_one', 'digit_two', 'digit_three', 'digit_four', 'digit_five', 'digit_six', 'digit_seven', 'digit_eight', 'digit_nine', 'pound_symbol', 'asterisk_symbol', 'female_sign', 'male_sign', 'medical_symbol'],
  activity: ['soccer', 'basketball', 'football', 'baseball', 'softball', 'tennis', 'volleyball', 'rugby_football', '8ball', 'ping_pong', 'badminton', 'goal', 'hockey', 'field_hockey', 'cricket_game', 'lacrosse', 'golf', 'flying_disc', 'bow_and_arrow', 'fishing_pole_and_fish', 'boxing_glove', 'martial_arts_uniform', 'running_shirt_with_sash', 'skateboard', 'ice_skate', 'curling_stone', 'sled', 'ski', 'skier', 'snowboarder', 'person_lifting_weights', 'woman_lifting_weights', 'man_lifting_weights', 'people_wrestling', 'women_wrestling', 'men_wrestling', 'person_doing_cartwheel', 'woman_cartwheeling', 'man_cartwheeling', 'person_bouncing_ball', 'woman_bouncing_ball', 'man_bouncing_ball', 'person_fencing', 'person_playing_handball', 'woman_playing_handball', 'man_playing_handball', 'person_golfing', 'woman_golfing', 'man_golfing', 'horse_racing', 'person_in_lotus_position', 'woman_in_lotus_position', 'man_in_lotus_position', 'person_surfing', 'woman_surfing', 'man_surfing', 'person_swimming', 'woman_swimming', 'man_swimming', 'person_playing_water_polo', 'woman_playing_water_polo', 'man_playing_water_polo', 'person_rowing_boat', 'woman_rowing_boat', 'man_rowing_boat', 'person_climbing', 'woman_climbing', 'man_climbing', 'person_mountain_biking', 'woman_mountain_biking', 'man_mountain_biking', 'person_biking', 'woman_biking', 'man_biking', 'trophy', 'first_place', 'second_place', 'third_place', 'medal', 'military_medal', 'rosette', 'reminder_ribbon', 'ticket', 'tickets', 'circus_tent', 'person_juggling', 'woman_juggling', 'man_juggling', 'performing_arts', 'art', 'clapper', 'microphone', 'headphones', 'musical_score', 'musical_keyboard', 'drum', 'saxophone', 'trumpet', 'guitar', 'violin', 'game_die', 'dart', 'bowling', 'video_game', 'slot_machine'],
  objects: ['watch', 'iphone', 'calling', 'computer', 'keyboard', 'desktop', 'printer', 'mouse_three_button', 'trackball', 'joystick', 'chess_pawn', 'jigsaw', 'compression', 'minidisc', 'floppy_disk', 'cd', 'dvd', 'vhs', 'camera', 'camera_with_flash', 'video_camera', 'movie_camera', 'projector', 'film_frames', 'telephone_receiver', 'telephone', 'pager', 'fax', 'tv', 'radio', 'microphone2', 'level_slider', 'control_knobs', 'stopwatch', 'timer', 'alarm_clock', 'clock', 'hourglass', 'hourglass_flowing_sand', 'satellite', 'compass', 'battery', 'electric_plug', 'magnet', 'bulb', 'flashlight', 'candle', 'fire_extinguisher', 'wastebasket', 'oil', 'money_with_wings', 'dollar', 'yen', 'euro', 'pound', 'moneybag', 'credit_card', 'gem', 'nazar_amulet', 'bricks', 'scales', 'toolbox', 'wrench', 'hammer', 'hammer_pick', 'tools', 'pick', 'nut_and_bolt', 'gear', 'chains', 'gun', 'bomb', 'knife', 'dagger', 'crossed_swords', 'shield', 'smoking', 'coffin', 'urn', 'amphora', 'crystal_ball', 'prayer_beads', 'barber', 'alembic', 'test_tube', 'petri_dish', 'dna', 'abacus', 'telescope', 'microscope', 'hole', 'pill', 'syringe', 'thermometer', 'toilet', 'potable_water', 'shower', 'bathtub', 'bath', 'broom', 'basket', 'roll_of_paper', 'soap', 'sponge', 'squeeze_bottle', 'thread', 'yarn', 'bellhop', 'key', 'key2', 'door', 'couch', 'bed', 'sleeping_accommodation', 'teddy_bear', 'frame_photo', 'shopping_bags', 'shopping_cart', 'gift', 'balloon', 'flags', 'ribbon', 'confetti_ball', 'tada', 'dolls', 'izakaya_lantern', 'wind_chime', 'red_envelope', 'envelope', 'envelope_with_arrow', 'incoming_envelope', 'e-mail', 'love_letter', 'inbox_tray', 'outbox_tray', 'package', 'label', 'mailbox_closed', 'mailbox', 'mailbox_with_mail', 'mailbox_with_no_mail', 'postbox', 'postal_horn', 'scroll', 'page_with_curl', 'page_facing_up', 'receipt', 'bookmark_tabs', 'bar_chart', 'chart_with_upwards_trend', 'chart_with_downwards_trend', 'notepad_spiral', 'calendar_spiral', 'calendar', 'date', 'card_index', 'card_box', 'ballot_box', 'file_cabinet', 'clipboard', 'file_folder', 'open_file_folder', 'dividers', 'newspaper2', 'newspaper', 'notebook', 'notebook_with_decorative_cover', 'ledger', 'closed_book', 'green_book', 'blue_book', 'orange_book', 'books', 'book', 'bookmark', 'link', 'paperclip', 'paperclips', 'triangular_ruler', 'straight_ruler', 'safety_pin', 'pushpin', 'round_pushpin', 'scissors', 'pen_ballpoint', 'pen_fountain', 'black_nib', 'paintbrush', 'crayon', 'pencil', 'pencil2', 'mag', 'mag_right', 'lock_with_ink_pen', 'closed_lock_with_key', 'lock', 'unlock'],
  nature: ['dog', 'cat', 'mouse', 'hamster', 'rabbit', 'fox', 'raccoon', 'bear', 'panda_face', 'kangaroo', 'badger', 'koala', 'tiger', 'lion_face', 'cow', 'pig', 'pig_nose', 'frog', 'monkey_face', 'see_no_evil', 'hear_no_evil', 'speak_no_evil', 'monkey', 'chicken', 'penguin', 'bird', 'baby_chick', 'hatching_chick', 'hatched_chick', 'duck', 'swan', 'eagle', 'owl', 'parrot', 'peacock', 'bat', 'wolf', 'boar', 'horse', 'unicorn', 'bee', 'bug', 'butterfly', 'snail', 'shell', 'beetle', 'ant', 'cricket', 'spider', 'spider_web', 'scorpion', 'mosquito', 'microbe', 'turtle', 'snake', 'lizard', 't_rex', 'sauropod', 'octopus', 'squid', 'shrimp', 'crab', 'lobster', 'blowfish', 'tropical_fish', 'fish', 'dolphin', 'whale', 'whale2', 'shark', 'crocodile', 'tiger2', 'leopard', 'zebra', 'gorilla', 'elephant', 'rhino', 'hippopotamus', 'dromedary_camel', 'camel', 'giraffe', 'llama', 'water_buffalo', 'ox', 'cow2', 'racehorse', 'pig2', 'ram', 'sheep', 'goat', 'deer', 'dog2', 'poodle', 'cat2', 'rooster', 'turkey', 'dove', 'rabbit2', 'mouse2', 'rat', 'chipmunk', 'hedgehog', 'feet', 'dragon', 'dragon_face', 'cactus', 'christmas_tree', 'evergreen_tree', 'deciduous_tree', 'palm_tree', 'seedling', 'herb', 'shamrock', 'four_leaf_clover', 'bamboo', 'tanabata_tree', 'leaves', 'fallen_leaf', 'maple_leaf', 'mushroom', 'ear_of_rice', 'bouquet', 'tulip', 'rose', 'wilted_rose', 'hibiscus', 'cherry_blossom', 'blossom', 'sunflower', 'sun_with_face', 'full_moon_with_face', 'first_quarter_moon_with_face', 'last_quarter_moon_with_face', 'new_moon_with_face', 'full_moon', 'waning_gibbous_moon', 'last_quarter_moon', 'waning_crescent_moon', 'new_moon', 'waxing_crescent_moon', 'first_quarter_moon', 'waxing_gibbous_moon', 'crescent_moon', 'earth_americas', 'earth_africa', 'earth_asia', 'dizzy', 'star', 'star2', 'sparkles', 'zap', 'comet', 'boom', 'fire', 'cloud_tornado', 'rainbow', 'sunny', 'white_sun_small_cloud', 'partly_sunny', 'white_sun_cloud', 'cloud', 'white_sun_rain_cloud', 'cloud_rain', 'thunder_cloud_rain', 'cloud_lightning', 'cloud_snow', 'snowflake', 'snowman2', 'snowman', 'wind_blowing_face', 'dash', 'droplet', 'sweat_drops', 'umbrella', 'umbrella2', 'ocean', 'fog'],
  food: ['green_apple', 'apple', 'pear', 'tangerine', 'lemon', 'banana', 'watermelon', 'grapes', 'strawberry', 'melon', 'cherries', 'peach', 'mango', 'pineapple', 'coconut', 'kiwi', 'tomato', 'eggplant', 'avocado', 'broccoli', 'leafy_green', 'cucumber', 'hot_pepper', 'corn', 'carrot', 'potato', 'sweet_potato', 'croissant', 'bread', 'french_bread', 'pretzel', 'bagel', 'cheese', 'egg', 'cooking', 'pancakes', 'bacon', 'cut_of_meat', 'poultry_leg', 'meat_on_bone', 'hotdog', 'hamburger', 'fries', 'pizza', 'sandwich', 'stuffed_flatbread', 'taco', 'burrito', 'salad', 'shallow_pan_of_food', 'canned_food', 'spaghetti', 'ramen', 'stew', 'curry', 'sushi', 'bento', 'fried_shrimp', 'rice_ball', 'rice', 'rice_cracker', 'fish_cake', 'fortune_cookie', 'oden', 'dango', 'shaved_ice', 'ice_cream', 'icecream', 'pie', 'cake', 'birthday', 'moon_cake', 'cupcake', 'custard', 'lollipop', 'candy', 'chocolate_bar', 'popcorn', 'salt', 'doughnut', 'dumpling', 'cookie', 'chestnut', 'peanuts', 'honey_pot', 'milk', 'baby_bottle', 'coffee', 'tea', 'cup_with_straw', 'sake', 'beer', 'beers', 'champagne_glass', 'wine_glass', 'tumbler_glass', 'cocktail', 'tropical_drink', 'champagne', 'spoon', 'fork_and_knife', 'fork_knife_plate', 'bowl_with_spoon', 'takeout_box', 'chopsticks'],
  people: ['grinning', 'smiley', 'smile', 'grin', 'laughing', 'sweat_smile', 'joy', 'rofl', 'relaxed', 'blush', 'innocent', 'slight_smile', 'upside_down', 'wink', 'relieved', 'heart_eyes', 'kissing_heart', 'smiling_face_with_3_hearts', 'kissing', 'kissing_smiling_eyes', 'kissing_closed_eyes', 'yum', 'stuck_out_tongue', 'stuck_out_tongue_closed_eyes', 'stuck_out_tongue_winking_eye', 'zany_face', 'face_with_raised_eyebrow', 'face_with_monocle', 'nerd', 'sunglasses', 'star_struck', 'partying_face', 'smirk', 'unamused', 'disappointed', 'pensive', 'worried', 'confused', 'slight_frown', 'frowning2', 'persevere', 'confounded', 'tired_face', 'weary', 'cry', 'sob', 'triumph', 'angry', 'rage', 'face_with_symbols_over_mouth', 'exploding_head', 'flushed', 'scream', 'fearful', 'cold_sweat', 'hot_face', 'cold_face', 'pleading_face', 'disappointed_relieved', 'sweat', 'hugging', 'thinking', 'face_with_hand_over_mouth', 'shushing_face', 'lying_face', 'no_mouth', 'neutral_face', 'expressionless', 'grimacing', 'rolling_eyes', 'hushed', 'frowning', 'anguished', 'open_mouth', 'astonished', 'sleeping', 'drooling_face', 'sleepy', 'dizzy_face', 'zipper_mouth', 'woozy_face', 'nauseated_face', 'face_vomiting', 'sneezing_face', 'mask', 'thermometer_face', 'head_bandage', 'money_mouth', 'cowboy', 'smiling_imp', 'imp', 'japanese_ogre', 'japanese_goblin', 'clown', 'poop', 'ghost', 'skull', 'skull_crossbones', 'alien', 'space_invader', 'robot', 'jack_o_lantern', 'smiley_cat', 'smile_cat', 'joy_cat', 'heart_eyes_cat', 'smirk_cat', 'kissing_cat', 'scream_cat', 'crying_cat_face', 'pouting_cat', 'palms_up_together', 'open_hands', 'raised_hands', 'clap', 'handshake', 'thumbsup', 'thumbsdown', 'punch', 'fist', 'left_facing_fist', 'right_facing_fist', 'fingers_crossed', 'v', 'love_you_gesture', 'metal', 'ok_hand', 'point_left', 'point_right', 'point_up_2', 'point_down', 'point_up', 'raised_hand', 'raised_back_of_hand', 'hand_splayed', 'vulcan', 'wave', 'call_me', 'muscle', 'leg', 'foot', 'middle_finger', 'writing_hand', 'pray', 'ring', 'lipstick', 'kiss', 'lips', 'tongue', 'ear', 'nose', 'footprints', 'eye', 'eyes', 'brain', 'bone', 'tooth', 'speaking_head', 'bust_in_silhouette', 'busts_in_silhouette', 'baby', 'girl', 'child', 'boy', 'woman', 'adult', 'man', 'blond_haired_person', 'blond-haired_woman', 'blond-haired_man', 'woman_red_haired', 'man_red_haired', 'woman_curly_haired', 'man_curly_haired', 'woman_white_haired', 'man_white_haired', 'woman_bald', 'man_bald', 'bearded_person', 'older_woman', 'older_adult', 'older_man', 'man_with_chinese_cap', 'person_wearing_turban', 'woman_wearing_turban', 'man_wearing_turban', 'woman_with_headscarf', 'police_officer', 'woman_police_officer', 'man_police_officer', 'construction_worker', 'woman_construction_worker', 'man_construction_worker', 'guard', 'woman_guard', 'man_guard', 'detective', 'woman_detective', 'man_detective', 'woman_health_worker', 'man_health_worker', 'woman_farmer', 'man_farmer', 'woman_cook', 'man_cook', 'woman_student', 'man_student', 'woman_singer', 'man_singer', 'woman_teacher', 'man_teacher', 'woman_factory_worker', 'man_factory_worker', 'woman_technologist', 'man_technologist', 'woman_office_worker', 'man_office_worker', 'woman_mechanic', 'man_mechanic', 'woman_scientist', 'man_scientist', 'woman_artist', 'man_artist', 'woman_firefighter', 'man_firefighter', 'woman_pilot', 'man_pilot', 'woman_astronaut', 'man_astronaut', 'woman_judge', 'man_judge', 'bride_with_veil', 'man_in_tuxedo', 'princess', 'prince', 'mrs_claus', 'santa', 'superhero', 'woman_superhero', 'man_superhero', 'supervillain', 'woman_supervillain', 'man_supervillain', 'mage', 'woman_mage', 'man_mage', 'elf', 'woman_elf', 'man_elf', 'vampire', 'woman_vampire', 'man_vampire', 'zombie', 'woman_zombie', 'man_zombie', 'genie', 'woman_genie', 'man_genie', 'merperson', 'mermaid', 'merman', 'fairy', 'woman_fairy', 'man_fairy', 'angel', 'pregnant_woman', 'breast_feeding', 'person_bowing', 'woman_bowing', 'man_bowing', 'person_tipping_hand', 'woman_tipping_hand', 'man_tipping_hand', 'person_gesturing_no', 'woman_gesturing_no', 'man_gesturing_no', 'person_gesturing_ok', 'woman_gesturing_ok', 'man_gesturing_ok', 'person_raising_hand', 'woman_raising_hand', 'man_raising_hand', 'person_facepalming', 'woman_facepalming', 'man_facepalming', 'person_shrugging', 'woman_shrugging', 'man_shrugging', 'person_pouting', 'woman_pouting', 'man_pouting', 'person_frowning', 'woman_frowning', 'man_frowning', 'person_getting_haircut', 'woman_getting_haircut', 'man_getting_haircut', 'person_getting_massage', 'woman_getting_face_massage', 'man_getting_face_massage', 'person_in_steamy_room', 'woman_in_steamy_room', 'man_in_steamy_room', 'nail_care', 'selfie', 'dancer', 'man_dancing', 'people_with_bunny_ears_partying', 'women_with_bunny_ears_partying', 'men_with_bunny_ears_partying', 'levitate', 'person_walking', 'woman_walking', 'man_walking', 'person_running', 'woman_running', 'man_running', 'couple', 'two_women_holding_hands', 'two_men_holding_hands', 'couple_with_heart', 'couple_with_heart_woman_man', 'couple_ww', 'couple_mm', 'couplekiss', 'kiss_woman_man', 'kiss_ww', 'kiss_mm', 'family', 'family_man_woman_boy', 'family_mwg', 'family_mwgb', 'family_mwbb', 'family_mwgg', 'family_wwb', 'family_wwg', 'family_wwgb', 'family_wwbb', 'family_wwgg', 'family_mmb', 'family_mmg', 'family_mmgb', 'family_mmbb', 'family_mmgg', 'family_woman_boy', 'family_woman_girl', 'family_woman_girl_boy', 'family_woman_boy_boy', 'family_woman_girl_girl', 'family_man_boy', 'family_man_girl', 'family_man_girl_boy', 'family_man_boy_boy', 'family_man_girl_girl', 'coat', 'womans_clothes', 'shirt', 'jeans', 'necktie', 'dress', 'bikini', 'kimono', 'lab_coat', 'high_heel', 'sandal', 'boot', 'mans_shoe', 'athletic_shoe', 'hiking_boot', 'womans_flat_shoe', 'socks', 'gloves', 'scarf', 'tophat', 'billed_cap', 'womans_hat', 'mortar_board', 'helmet_with_cross', 'crown', 'pouch', 'purse', 'handbag', 'briefcase', 'school_satchel', 'eyeglasses', 'dark_sunglasses', 'goggles', 'closed_umbrella', 'red_haired', 'curly_haired', 'white_haired', 'bald'],
  regional: ['regional_indicator_z', 'regional_indicator_y', 'regional_indicator_x', 'regional_indicator_w', 'regional_indicator_v', 'regional_indicator_u', 'regional_indicator_t', 'regional_indicator_s', 'regional_indicator_r', 'regional_indicator_q', 'regional_indicator_p', 'regional_indicator_o', 'regional_indicator_n', 'regional_indicator_m', 'regional_indicator_l', 'regional_indicator_k', 'regional_indicator_j', 'regional_indicator_i', 'regional_indicator_h', 'regional_indicator_g', 'regional_indicator_f', 'regional_indicator_e', 'regional_indicator_d', 'regional_indicator_c', 'regional_indicator_b', 'regional_indicator_a'],
  travel: ['red_car', 'taxi', 'blue_car', 'bus', 'trolleybus', 'race_car', 'police_car', 'ambulance', 'fire_engine', 'minibus', 'truck', 'articulated_lorry', 'tractor', 'scooter', 'bike', 'motor_scooter', 'motorcycle', 'rotating_light', 'oncoming_police_car', 'oncoming_bus', 'oncoming_automobile', 'oncoming_taxi', 'aerial_tramway', 'mountain_cableway', 'suspension_railway', 'railway_car', 'train', 'mountain_railway', 'monorail', 'bullettrain_side', 'bullettrain_front', 'light_rail', 'steam_locomotive', 'train2', 'metro', 'tram', 'station', 'airplane', 'airplane_departure', 'airplane_arriving', 'airplane_small', 'seat', 'luggage', 'satellite_orbital', 'rocket', 'flying_saucer', 'helicopter', 'canoe', 'sailboat', 'speedboat', 'motorboat', 'cruise_ship', 'ferry', 'ship', 'anchor', 'fuelpump', 'construction', 'vertical_traffic_light', 'traffic_light', 'busstop', 'map', 'moyai', 'statue_of_liberty', 'tokyo_tower', 'european_castle', 'japanese_castle', 'stadium', 'ferris_wheel', 'roller_coaster', 'carousel_horse', 'fountain', 'beach_umbrella', 'beach', 'island', 'desert', 'volcano', 'mountain', 'mountain_snow', 'mount_fuji', 'camping', 'tent', 'house', 'house_with_garden', 'homes', 'house_abandoned', 'construction_site', 'factory', 'office', 'department_store', 'post_office', 'european_post_office', 'hospital', 'bank', 'hotel', 'convenience_store', 'school', 'love_hotel', 'wedding', 'classical_building', 'church', 'mosque', 'synagogue', 'kaaba', 'shinto_shrine', 'railway_track', 'motorway', 'japan', 'rice_scene', 'park', 'sunrise', 'sunrise_over_mountains', 'stars', 'sparkler', 'fireworks', 'firecracker', 'city_sunset', 'city_dusk', 'cityscape', 'night_with_stars', 'milky_way', 'bridge_at_night', 'foggy'],
  flags: ['flag_white', 'flag_black', 'checkered_flag', 'triangular_flag_on_post', 'rainbow_flag', 'pirate_flag', 'flag_af', 'flag_ax', 'flag_al', 'flag_dz', 'flag_as', 'flag_ad', 'flag_ao', 'flag_ai', 'flag_aq', 'flag_ag', 'flag_ar', 'flag_am', 'flag_aw', 'flag_au', 'flag_at', 'flag_az', 'flag_bs', 'flag_bh', 'flag_bd', 'flag_bb', 'flag_by', 'flag_be', 'flag_bz', 'flag_bj', 'flag_bm', 'flag_bt', 'flag_bo', 'flag_ba', 'flag_bw', 'flag_br', 'flag_io', 'flag_vg', 'flag_bn', 'flag_bg', 'flag_bf', 'flag_bi', 'flag_kh', 'flag_cm', 'flag_ca', 'flag_ic', 'flag_cv', 'flag_bq', 'flag_ky', 'flag_cf', 'flag_td', 'flag_cl', 'flag_cn', 'flag_cx', 'flag_cc', 'flag_co', 'flag_km', 'flag_cg', 'flag_cd', 'flag_ck', 'flag_cr', 'flag_ci', 'flag_hr', 'flag_cu', 'flag_cw', 'flag_cy', 'flag_cz', 'flag_dk', 'flag_dj', 'flag_dm', 'flag_do', 'flag_ec', 'flag_eg', 'flag_sv', 'flag_gq', 'flag_er', 'flag_ee', 'flag_et', 'flag_eu', 'flag_fk', 'flag_fo', 'flag_fj', 'flag_fi', 'flag_fr', 'flag_gf', 'flag_pf', 'flag_tf', 'flag_ga', 'flag_gm', 'flag_ge', 'flag_de', 'flag_gh', 'flag_gi', 'flag_gr', 'flag_gl', 'flag_gd', 'flag_gp', 'flag_gu', 'flag_gt', 'flag_gg', 'flag_gn', 'flag_gw', 'flag_gy', 'flag_ht', 'flag_hn', 'flag_hk', 'flag_hu', 'flag_is', 'flag_in', 'flag_id', 'flag_ir', 'flag_iq', 'flag_ie', 'flag_im', 'flag_il', 'flag_it', 'flag_jm', 'flag_jp', 'crossed_flags', 'flag_je', 'flag_jo', 'flag_kz', 'flag_ke', 'flag_ki', 'flag_xk', 'flag_kw', 'flag_kg', 'flag_la', 'flag_lv', 'flag_lb', 'flag_ls', 'flag_lr', 'flag_ly', 'flag_li', 'flag_lt', 'flag_lu', 'flag_mo', 'flag_mk', 'flag_mg', 'flag_mw', 'flag_my', 'flag_mv', 'flag_ml', 'flag_mt', 'flag_mh', 'flag_mq', 'flag_mr', 'flag_mu', 'flag_yt', 'flag_mx', 'flag_fm', 'flag_md', 'flag_mc', 'flag_mn', 'flag_me', 'flag_ms', 'flag_ma', 'flag_mz', 'flag_mm', 'flag_na', 'flag_nr', 'flag_np', 'flag_nl', 'flag_nc', 'flag_nz', 'flag_ni', 'flag_ne', 'flag_ng', 'flag_nu', 'flag_nf', 'flag_kp', 'flag_mp', 'flag_no', 'flag_om', 'flag_pk', 'flag_pw', 'flag_ps', 'flag_pa', 'flag_pg', 'flag_py', 'flag_pe', 'flag_ph', 'flag_pn', 'flag_pl', 'flag_pt', 'flag_pr', 'flag_qa', 'flag_re', 'flag_ro', 'flag_ru', 'flag_rw', 'flag_ws', 'flag_sm', 'flag_st', 'flag_sa', 'flag_sn', 'flag_rs', 'flag_sc', 'flag_sl', 'flag_sg', 'flag_sx', 'flag_sk', 'flag_si', 'flag_gs', 'flag_sb', 'flag_so', 'flag_za', 'flag_kr', 'flag_ss', 'flag_es', 'flag_lk', 'flag_bl', 'flag_sh', 'flag_kn', 'flag_lc', 'flag_pm', 'flag_vc', 'flag_sd', 'flag_sr', 'flag_sz', 'flag_se', 'flag_ch', 'flag_sy', 'flag_tw', 'flag_tj', 'flag_tz', 'flag_th', 'flag_tl', 'flag_tg', 'flag_tk', 'flag_to', 'flag_tt', 'flag_tn', 'flag_tr', 'flag_tm', 'flag_tc', 'flag_vi', 'flag_tv', 'flag_ug', 'flag_ua', 'flag_ae', 'flag_gb', 'england', 'scotland', 'wales', 'flag_us', 'flag_uy', 'flag_uz', 'flag_vu', 'flag_va', 'flag_ve', 'flag_vn', 'flag_wf', 'flag_eh', 'flag_ye', 'flag_zm', 'flag_zw', 'flag_ac', 'flag_bv', 'flag_cp', 'flag_ea', 'flag_dg', 'flag_hm', 'flag_mf', 'flag_sj', 'flag_ta', 'flag_um', 'united_nations'],
  modifier: ['tone1', 'tone2', 'tone3', 'tone4', 'tone5']
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emojioneRender.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-emojione/lib/emojioneRender.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  emojioneRender: () => emojioneRender,
  emojioneRenderFromShort: () => emojioneRenderFromShort
});
let emojione;
module.link("emojione", {
  default(v) {
    emojione = v;
  }

}, 0);

function emojioneRender(message) {
  return emojione.toImage(message);
}

function emojioneRenderFromShort(message) {
  return emojione.shortnameToImage(message);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-emojione/lib/rocketchat.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let emojione;
module.link("emojione", {
  default(v) {
    emojione = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let mem;
module.link("mem", {
  default(v) {
    mem = v;
  }

}, 3);
let emojioneRender, emojioneRenderFromShort;
module.link("./emojioneRender", {
  emojioneRender(v) {
    emojioneRender = v;
  },

  emojioneRenderFromShort(v) {
    emojioneRenderFromShort = v;
  }

}, 4);
let emojisByCategory, emojiCategories, toneList;
module.link("./emojiPicker", {
  emojisByCategory(v) {
    emojisByCategory = v;
  },

  emojiCategories(v) {
    emojiCategories = v;
  },

  toneList(v) {
    toneList = v;
  }

}, 5);
let emoji;
module.link("../../emoji", {
  emoji(v) {
    emoji = v;
  }

}, 6);
let getUserPreference;
module.link("../../utils", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 7);
// TODO remove fix below when issue is solved: https://github.com/joypixels/emojione/issues/617
// add missing emojis not provided by JS object, but included on emoji.json
emojione.shortnames += '|:tm:|:copyright:|:registered:|:digit_zero:|:digit_one:|:digit_two:|:digit_three:|:digit_four:|:digit_five:|:digit_six:|:digit_seven:|:digit_eight:|:digit_nine:|:pound_symbol:|:asterisk_symbol:';
emojione.regShortNames = new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|(".concat(emojione.shortnames, ")"), 'gi');
emojione.emojioneList[':tm:'] = {
  uc_base: '2122',
  uc_output: '2122-fe0f',
  uc_match: '2122-fe0f',
  uc_greedy: '2122-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':copyright:'] = {
  uc_base: '00a9',
  uc_output: '00a9-f0ef',
  uc_match: '00a9-fe0f',
  uc_greedy: '00a9-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':registered:'] = {
  uc_base: '00ae',
  uc_output: '00ae-fe0f',
  uc_match: '00ae-fe0f',
  uc_greedy: '00ae-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_zero:'] = {
  uc_base: '0030',
  uc_output: '0030-fe0f',
  uc_match: '0030-fe0f',
  uc_greedy: '0030-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_one:'] = {
  uc_base: '0031',
  uc_output: '0031-fe0f',
  uc_match: '0031-fe0f',
  uc_greedy: '0031-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_two:'] = {
  uc_base: '0032',
  uc_output: '0032-fe0f',
  uc_match: '0032-fe0f',
  uc_greedy: '0032-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_three:'] = {
  uc_base: '0033',
  uc_output: '0033-fe0f',
  uc_match: '0033-fe0f',
  uc_greedy: '0033-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_four:'] = {
  uc_base: '0034',
  uc_output: '0034-fe0f',
  uc_match: '0034-fe0f',
  uc_greedy: '0034-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_five:'] = {
  uc_base: '0035',
  uc_output: '0035-fe0f',
  uc_match: '0035-fe0f',
  uc_greedy: '0035-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_six:'] = {
  uc_base: '0036',
  uc_output: '0036-fe0f',
  uc_match: '0036-fe0f',
  uc_greedy: '0036-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_seven:'] = {
  uc_base: '0037',
  uc_output: '0037-fe0f',
  uc_match: '0037-fe0f',
  uc_greedy: '0037-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_eight:'] = {
  uc_base: '0038',
  uc_output: '0038-fe0f',
  uc_match: '0038-fe0f',
  uc_greedy: '0038-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_nine:'] = {
  uc_base: '0039',
  uc_output: '0039-fe0f',
  uc_match: '0039-fe0f',
  uc_greedy: '0039-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':pound_symbol:'] = {
  uc_base: '0023',
  uc_output: '0023-fe0f',
  uc_match: '0023-fe0f',
  uc_greedy: '0023-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':asterisk_symbol:'] = {
  uc_base: '002a',
  uc_output: '002a-fe0f',
  uc_match: '002a-fe0f',
  uc_greedy: '002a-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
}; // end fix
// fix for :+1: - had to replace all function that does its conversion: https://github.com/joypixels/emojione/blob/4.5.0/lib/js/emojione.js#L249

(function (ns) {
  ns.shortnameConversionMap = mem(ns.shortnameConversionMap, {
    maxAge: 1000
  });
  ns.unicodeCharRegex = mem(ns.unicodeCharRegex, {
    maxAge: 1000
  });
  const convertShortName = mem(function (shortname) {
    // the fix is basically adding this .replace(/[+]/g, '\\$&')
    if (typeof shortname === 'undefined' || shortname === '' || ns.shortnames.indexOf(shortname.replace(/[+]/g, '\\$&')) === -1) {
      // if the shortname doesnt exist just return the entire match
      return shortname;
    } // map shortname to parent


    if (!ns.emojioneList[shortname]) {
      for (const emoji in ns.emojioneList) {
        if (!ns.emojioneList.hasOwnProperty(emoji) || emoji === '') {
          continue;
        }

        if (ns.emojioneList[emoji].shortnames.indexOf(shortname) === -1) {
          continue;
        }

        shortname = emoji;
        break;
      }
    }

    const unicode = ns.emojioneList[shortname].uc_output;
    const fname = ns.emojioneList[shortname].uc_base;
    const category = fname.indexOf('-1f3f') >= 0 ? 'diversity' : ns.emojioneList[shortname].category;
    const title = ns.imageTitleTag ? "title=\"".concat(shortname, "\"") : ''; // const size = ns.spriteSize === '32' || ns.spriteSize === '64' ? ns.spriteSize : '32';
    // if the emoji path has been set, we'll use the provided path, otherwise we'll use the default path

    const ePath = ns.defaultPathPNG !== ns.imagePathPNG ? ns.imagePathPNG : "".concat(ns.defaultPathPNG + ns.emojiSize, "/"); // depending on the settings, we'll either add the native unicode as the alt tag, otherwise the shortname

    const alt = ns.unicodeAlt ? ns.convert(unicode.toUpperCase()) : shortname;

    if (ns.sprites) {
      return "<span class=\"emojione emojione-".concat(category, " _").concat(fname, "\" ").concat(title, ">").concat(alt, "</span>");
    }

    return "<img class=\"emojione\" alt=\"".concat(alt, "\" ").concat(title, " src=\"").concat(ePath).concat(fname).concat(ns.fileExtension, "\"/>");
  }, {
    maxAge: 1000
  });
  const convertUnicode = mem(function (entire, m1, m2, m3) {
    const mappedUnicode = ns.mapUnicodeToShort();

    if (typeof m3 === 'undefined' || m3 === '' || !(ns.unescapeHTML(m3) in ns.asciiList)) {
      // if the ascii doesnt exist just return the entire match
      return entire;
    }

    m3 = ns.unescapeHTML(m3);
    const unicode = ns.asciiList[m3];
    const shortname = mappedUnicode[unicode];
    const category = unicode.indexOf('-1f3f') >= 0 ? 'diversity' : ns.emojioneList[shortname].category;
    const title = ns.imageTitleTag ? "title=\"".concat(ns.escapeHTML(m3), "\"") : ''; // const size = ns.spriteSize === '32' || ns.spriteSize === '64' ? ns.spriteSize : '32';
    // if the emoji path has been set, we'll use the provided path, otherwise we'll use the default path

    const ePath = ns.defaultPathPNG !== ns.imagePathPNG ? ns.imagePathPNG : "".concat(ns.defaultPathPNG + ns.emojiSize, "/"); // depending on the settings, we'll either add the native unicode as the alt tag, otherwise the shortname

    const alt = ns.unicodeAlt ? ns.convert(unicode.toUpperCase()) : ns.escapeHTML(m3);

    if (ns.sprites) {
      return "".concat(m2, "<span class=\"emojione emojione-").concat(category, " _").concat(unicode, "\"  ").concat(title, ">").concat(alt, "</span>");
    }

    return "".concat(m2, "<img class=\"emojione\" alt=\"").concat(alt, "\" ").concat(title, " src=\"").concat(ePath).concat(unicode).concat(ns.fileExtension, "\"/>");
  }, {
    maxAge: 1000,
    cacheKey: JSON.stringify
  });

  ns.shortnameToImage = function (str) {
    // replace regular shortnames first
    str = str.replace(ns.regShortNames, convertShortName); // if ascii smileys are turned on, then we'll replace them!

    if (ns.ascii) {
      const asciiRX = ns.riskyMatchAscii ? ns.regAsciiRisky : ns.regAscii;
      return str.replace(asciiRX, convertUnicode);
    }

    return str;
  };
})(emojione);

emoji.packages.emojione = emojione;
emoji.packages.emojione.sprites = true;
emoji.packages.emojione.emojisByCategory = emojisByCategory;
emoji.packages.emojione.emojiCategories = emojiCategories;
emoji.packages.emojione.toneList = toneList;
emoji.packages.emojione.render = emojioneRender;
emoji.packages.emojione.renderPicker = emojioneRenderFromShort; // http://stackoverflow.com/a/26990347 function isSet() from Gajus

function isSetNotNull(fn) {
  let value;

  try {
    value = fn();
  } catch (e) {
    value = null;
  }

  return value !== null && value !== undefined;
} // RocketChat.emoji.list is the collection of emojis from all emoji packages


for (const key in emojione.emojioneList) {
  if (emojione.emojioneList.hasOwnProperty(key)) {
    const currentEmoji = emojione.emojioneList[key];
    currentEmoji.emojiPackage = 'emojione';
    emoji.list[key] = currentEmoji;

    if (currentEmoji.shortnames) {
      currentEmoji.shortnames.forEach(shortname => {
        emoji.list[shortname] = currentEmoji;
      });
    }
  }
} // Additional settings -- ascii emojis


Meteor.startup(function () {
  Tracker.autorun(function () {
    if (isSetNotNull(() => emoji.packages.emojione)) {
      if (isSetNotNull(() => getUserPreference(Meteor.userId(), 'convertAsciiEmoji'))) {
        emoji.packages.emojione.ascii = getUserPreference(Meteor.userId(), 'convertAsciiEmoji');
      } else {
        emoji.packages.emojione.ascii = true;
      }
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"emojione-sprites.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-emojione/client/emojione-sprites.css                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-emojione/client/index.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/rocketchat");
module.link("./emojione-sprites.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"github-enterprise":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/github-enterprise/lib/common.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth(v) {
    CustomOAuth = v;
  }

}, 2);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);
// GitHub Enterprise Server CallBack URL needs to be http(s)://{rocketchat.server}[:port]/_oauth/github_enterprise
// In RocketChat -> Administration the URL needs to be http(s)://{github.enterprise.server}/
const config = {
  serverURL: '',
  identityPath: '/api/v3/user',
  authorizePath: '/login/oauth/authorize',
  tokenPath: '/login/oauth/access_token',
  addAutopublishFields: {
    forLoggedInUser: ['services.github-enterprise'],
    forOtherUsers: ['services.github-enterprise.username']
  }
};
const GitHubEnterprise = new CustomOAuth('github_enterprise', config);

if (Meteor.isServer) {
  Meteor.startup(function () {
    settings.get('API_GitHub_Enterprise_URL', function (key, value) {
      config.serverURL = value;
      GitHubEnterprise.configure(config);
    });
  });
} else {
  Meteor.startup(function () {
    Tracker.autorun(function () {
      if (settings.get('API_GitHub_Enterprise_URL')) {
        config.serverURL = settings.get('API_GitHub_Enterprise_URL');
        GitHubEnterprise.configure(config);
      }
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"github-enterprise-login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/github-enterprise/client/github-enterprise-login-button.css                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/github-enterprise/client/index.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./github-enterprise-login-button.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"gitlab":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/gitlab/lib/common.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);
let CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth(v) {
    CustomOAuth = v;
  }

}, 4);
const config = {
  serverURL: 'https://gitlab.com',
  identityPath: '/api/v4/user',
  scope: 'read_user',
  mergeUsers: false,
  addAutopublishFields: {
    forLoggedInUser: ['services.gitlab'],
    forOtherUsers: ['services.gitlab.username']
  },
  accessTokenParam: 'access_token'
};
const Gitlab = new CustomOAuth('gitlab', config);

if (Meteor.isServer) {
  Meteor.startup(function () {
    const updateConfig = _.debounce(() => {
      config.serverURL = settings.get('API_Gitlab_URL').trim().replace(/\/*$/, '') || config.serverURL;
      config.identityPath = settings.get('Accounts_OAuth_Gitlab_identity_path') || config.identityPath;
      config.mergeUsers = Boolean(settings.get('Accounts_OAuth_Gitlab_merge_users'));
      Gitlab.configure(config);
    }, 300);

    settings.get('API_Gitlab_URL', updateConfig);
    settings.get('Accounts_OAuth_Gitlab_identity_path', updateConfig);
    settings.get('Accounts_OAuth_Gitlab_merge_users', updateConfig);
  });
} else {
  Meteor.startup(function () {
    Tracker.autorun(function () {
      let anyChange = false;

      if (settings.get('API_Gitlab_URL')) {
        config.serverURL = settings.get('API_Gitlab_URL').trim().replace(/\/*$/, '');
        anyChange = true;
      }

      if (settings.get('Accounts_OAuth_Gitlab_identity_path')) {
        config.identityPath = settings.get('Accounts_OAuth_Gitlab_identity_path').trim() || config.identityPath;
        anyChange = true;
      }

      if (settings.get('Accounts_OAuth_Gitlab_merge_users')) {
        config.mergeUsers = true;
        anyChange = true;
      }

      if (anyChange) {
        Gitlab.configure(config);
      }
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"gitlab-login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/gitlab/client/gitlab-login-button.css                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/gitlab/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./gitlab-login-button.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"importer":{"lib":{"ImporterInfo.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer/lib/ImporterInfo.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ImporterInfo: () => ImporterInfo
});

class ImporterInfo {
  /**
   * Creates a new class which contains information about the importer.
   *
   * @param {string} key The unique key of this importer.
   * @param {string} name The i18n name.
   * @param {string} mimeType The type of file it expects.
   * @param {{ href: string, text: string }[]} warnings An array of warning objects. `{ href, text }`
   */
  constructor(key) {
    let name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
    let mimeType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
    let warnings = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
    this.key = key;
    this.name = name;
    this.mimeType = mimeType;
    this.warnings = warnings;
    this.importer = undefined;
    this.instance = undefined;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ImporterProgressStep.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer/lib/ImporterProgressStep.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ProgressStep: () => ProgressStep,
  ImportWaitingStates: () => ImportWaitingStates,
  ImportFileReadyStates: () => ImportFileReadyStates,
  ImportPreparingStartedStates: () => ImportPreparingStartedStates,
  ImportingStartedStates: () => ImportingStartedStates,
  ImportingDoneStates: () => ImportingDoneStates,
  ImportingErrorStates: () => ImportingErrorStates
});
const ProgressStep = Object.freeze({
  NEW: 'importer_new',
  UPLOADING: 'importer_uploading',
  DOWNLOADING_FILE: 'importer_downloading_file',
  FILE_LOADED: 'importer_file_loaded',
  PREPARING_STARTED: 'importer_preparing_started',
  PREPARING_USERS: 'importer_preparing_users',
  PREPARING_CHANNELS: 'importer_preparing_channels',
  PREPARING_MESSAGES: 'importer_preparing_messages',
  USER_SELECTION: 'importer_user_selection',
  IMPORTING_STARTED: 'importer_importing_started',
  IMPORTING_USERS: 'importer_importing_users',
  IMPORTING_CHANNELS: 'importer_importing_channels',
  IMPORTING_MESSAGES: 'importer_importing_messages',
  IMPORTING_FILES: 'importer_importing_files',
  FINISHING: 'importer_finishing',
  DONE: 'importer_done',
  ERROR: 'importer_import_failed',
  CANCELLED: 'importer_import_cancelled'
});
const ImportWaitingStates = [ProgressStep.NEW, ProgressStep.UPLOADING, ProgressStep.DOWNLOADING_FILE];
const ImportFileReadyStates = [ProgressStep.FILE_LOADED];
const ImportPreparingStartedStates = [ProgressStep.PREPARING_STARTED, ProgressStep.PREPARING_USERS, ProgressStep.PREPARING_CHANNELS, ProgressStep.PREPARING_MESSAGES];
const ImportingStartedStates = [ProgressStep.IMPORTING_STARTED, ProgressStep.IMPORTING_USERS, ProgressStep.IMPORTING_CHANNELS, ProgressStep.IMPORTING_MESSAGES, ProgressStep.IMPORTING_FILES, ProgressStep.FINISHING];
const ImportingDoneStates = [ProgressStep.DONE, ProgressStep.ERROR, ProgressStep.CANCELLED];
const ImportingErrorStates = [ProgressStep.ERROR, ProgressStep.CANCELLED];
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Importers.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer/lib/Importers.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Importers: () => Importers
});
let ImporterInfo;
module.link("./ImporterInfo", {
  ImporterInfo(v) {
    ImporterInfo = v;
  }

}, 0);

/** Container class which holds all of the importer details. */
class ImportersContainer {
  constructor() {
    this.importers = new Map();
  }
  /**
   * Adds an importer to the import collection. Adding it more than once will
   * overwrite the previous one.
   *
   * @param {ImporterInfo} info The information related to the importer.
   * @param {*} importer The class for the importer, will be undefined on the client.
   */


  add(info, importer) {
    if (!(info instanceof ImporterInfo)) {
      throw new Error('The importer must be a valid ImporterInfo instance.');
    }

    info.importer = importer;
    this.importers.set(info.key, info);
    return this.importers.get(info.key);
  }
  /**
   * Gets the importer information that is stored.
   *
   * @param {string} key The key of the importer.
   */


  get(key) {
    return this.importers.get(key);
  }
  /**
   * Gets all of the importers in array format.
   *
   * @returns {ImporterInfo[]} The array of importer information.
   */


  getAll() {
    return Array.from(this.importers.values());
  }

}

const Importers = new ImportersContainer();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer/client/index.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/Importers", {
  Importers: "Importers"
}, 0);
module.link("../lib/ImporterInfo", {
  ImporterInfo: "ImporterInfo"
}, 1);
module.link("../lib/ImporterProgressStep", {
  ProgressStep: "ProgressStep"
}, 2);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"importer-csv":{"lib":{"info.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-csv/lib/info.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CsvImporterInfo: () => CsvImporterInfo
});
let ImporterInfo;
module.link("../../importer/lib/ImporterInfo", {
  ImporterInfo(v) {
    ImporterInfo = v;
  }

}, 0);

class CsvImporterInfo extends ImporterInfo {
  constructor() {
    super('csv', 'CSV', 'application/zip', [{
      text: 'Importer_CSV_Information',
      href: 'https://rocket.chat/docs/administrator-guides/import/csv/'
    }]);
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"adder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-csv/client/adder.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Importers;
module.link("../../importer/client", {
  Importers(v) {
    Importers = v;
  }

}, 0);
let CsvImporterInfo;
module.link("../lib/info", {
  CsvImporterInfo(v) {
    CsvImporterInfo = v;
  }

}, 1);
Importers.add(new CsvImporterInfo());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-csv/client/index.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./adder");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"importer-hipchat-enterprise":{"lib":{"info.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-hipchat-enterprise/lib/info.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  HipChatEnterpriseImporterInfo: () => HipChatEnterpriseImporterInfo
});
let ImporterInfo;
module.link("../../importer/lib/ImporterInfo", {
  ImporterInfo(v) {
    ImporterInfo = v;
  }

}, 0);

class HipChatEnterpriseImporterInfo extends ImporterInfo {
  constructor() {
    super('hipchatenterprise', 'HipChat (tar.gz)', 'application/gzip', [{
      text: 'Importer_HipChatEnterprise_Information',
      href: 'https://rocket.chat/docs/administrator-guides/import/hipchat/enterprise/'
    }]);
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"adder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-hipchat-enterprise/client/adder.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Importers;
module.link("../../importer/client", {
  Importers(v) {
    Importers = v;
  }

}, 0);
let HipChatEnterpriseImporterInfo;
module.link("../lib/info", {
  HipChatEnterpriseImporterInfo(v) {
    HipChatEnterpriseImporterInfo = v;
  }

}, 1);
Importers.add(new HipChatEnterpriseImporterInfo());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-hipchat-enterprise/client/index.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./adder");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"importer-slack":{"lib":{"info.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack/lib/info.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  SlackImporterInfo: () => SlackImporterInfo
});
let ImporterInfo;
module.link("../../importer/lib/ImporterInfo", {
  ImporterInfo(v) {
    ImporterInfo = v;
  }

}, 0);

class SlackImporterInfo extends ImporterInfo {
  constructor() {
    super('slack', 'Slack', 'application/zip');
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"adder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack/client/adder.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Importers;
module.link("../../importer/client", {
  Importers(v) {
    Importers = v;
  }

}, 0);
let SlackImporterInfo;
module.link("../lib/info", {
  SlackImporterInfo(v) {
    SlackImporterInfo = v;
  }

}, 1);
Importers.add(new SlackImporterInfo());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack/client/index.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./adder");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"importer-slack-users":{"lib":{"info.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack-users/lib/info.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  SlackUsersImporterInfo: () => SlackUsersImporterInfo
});
let ImporterInfo;
module.link("../../importer/lib/ImporterInfo", {
  ImporterInfo(v) {
    ImporterInfo = v;
  }

}, 0);

class SlackUsersImporterInfo extends ImporterInfo {
  constructor() {
    super('slack-users', 'Slack_Users', 'text/csv', [{
      text: 'Importer_Slack_Users_CSV_Information',
      href: 'https://rocket.chat/docs/administrator-guides/import/slack/users'
    }]);
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"adder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack-users/client/adder.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Importers;
module.link("../../importer/client", {
  Importers(v) {
    Importers = v;
  }

}, 0);
let SlackUsersImporterInfo;
module.link("../lib/info", {
  SlackUsersImporterInfo(v) {
    SlackUsersImporterInfo = v;
  }

}, 1);
Importers.add(new SlackUsersImporterInfo());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack-users/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./adder");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"integrations":{"lib":{"rocketchat.js":[]},"client":{"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/integrations/client/startup.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let hasAtLeastOnePermission;
module.link("../../authorization", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 0);
let registerAdminSidebarItem;
module.link("../../../client/views/admin", {
  registerAdminSidebarItem(v) {
    registerAdminSidebarItem = v;
  }

}, 1);
registerAdminSidebarItem({
  href: 'admin-integrations',
  i18nLabel: 'Integrations',
  icon: 'code',
  permissionGranted: () => hasAtLeastOnePermission(['manage-outgoing-integrations', 'manage-own-outgoing-integrations', 'manage-incoming-integrations', 'manage-own-incoming-integrations'])
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"streamer.js":[
  "meteor/meteor"
]}},"mentions":{"lib":{"MentionsParser.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions/lib/MentionsParser.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  MentionsParser: () => MentionsParser
});
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 0);

const userTemplateDefault = _ref => {
  let {
    prefix,
    className,
    mention,
    title,
    label,
    type = 'username'
  } = _ref;
  return "".concat(prefix, "<a class=\"").concat(className, "\" data-").concat(type, "=\"").concat(mention, "\"").concat(title ? " title=\"".concat(title, "\"") : '', ">").concat(label, "</a>");
};

const roomTemplateDefault = _ref2 => {
  let {
    prefix,
    reference,
    mention
  } = _ref2;
  return "".concat(prefix, "<a class=\"mention-link mention-link--room\" data-channel=\"").concat(reference, "\">", "#".concat(mention), "</a>");
};

class MentionsParser {
  constructor(_ref3) {
    let {
      pattern,
      useRealName,
      me: _me,
      roomTemplate = roomTemplateDefault,
      userTemplate = userTemplateDefault
    } = _ref3;

    this.replaceUsers = (msg, _ref4, me) => {
      let {
        mentions,
        temp
      } = _ref4;
      return msg.replace(this.userMentionRegex, (match, prefix, mention) => {
        const classNames = ['mention-link'];

        if (mention === 'all') {
          classNames.push('mention-link--all');
          classNames.push('mention-link--group');
        } else if (mention === 'here') {
          classNames.push('mention-link--here');
          classNames.push('mention-link--group');
        } else if (mention === me) {
          classNames.push('mention-link--me');
          classNames.push('mention-link--user');
        } else {
          classNames.push('mention-link--user');
        }

        const className = classNames.join(' ');

        if (mention === 'all' || mention === 'here') {
          return this.userTemplate({
            prefix,
            className,
            mention,
            label: mention,
            type: 'group'
          });
        }

        const filterUser = _ref5 => {
          let {
            username,
            type
          } = _ref5;
          return (!type || type === 'user') && username === mention;
        };

        const filterTeam = _ref6 => {
          let {
            name,
            type
          } = _ref6;
          return type === 'team' && name === mention;
        };

        const [mentionObj] = (mentions || []).filter(m => filterUser(m) || filterTeam(m));
        const label = temp ? mention && escapeHTML(mention) : mentionObj && escapeHTML(mentionObj.type === 'team' || this.useRealName ? mentionObj.name : mentionObj.username);

        if (!label) {
          return match;
        }

        return this.userTemplate({
          prefix,
          className,
          mention,
          label,
          type: (mentionObj === null || mentionObj === void 0 ? void 0 : mentionObj.type) === 'team' ? 'team' : 'username',
          title: this.useRealName ? mention : label
        });
      });
    };

    this.replaceChannels = (msg, _ref7) => {
      let {
        temp,
        channels
      } = _ref7;
      return msg.replace(/&#39;/g, "'").replace(this.channelMentionRegex, (match, prefix, mention) => {
        if (!temp && !(channels && channels.find(function (c) {
          return c.dname ? c.dname === mention : c.name === mention;
        }))) {
          return match;
        }

        const channel = channels && channels.find(function (_ref8) {
          let {
            name,
            dname
          } = _ref8;
          return dname ? dname === mention : name === mention;
        });
        const reference = channel ? channel._id : mention;
        return this.roomTemplate({
          prefix,
          reference,
          channel,
          mention
        });
      });
    };

    this.pattern = pattern;
    this.useRealName = useRealName;
    this.me = _me;
    this.userTemplate = userTemplate;
    this.roomTemplate = roomTemplate;
  }

  set me(m) {
    this._me = m;
  }

  get me() {
    return typeof this._me === 'function' ? this._me() : this._me;
  }

  set pattern(p) {
    this._pattern = p;
  }

  get pattern() {
    return typeof this._pattern === 'function' ? this._pattern() : this._pattern;
  }

  set useRealName(s) {
    this._useRealName = s;
  }

  get useRealName() {
    return typeof this._useRealName === 'function' ? this._useRealName() : this._useRealName;
  }

  get userMentionRegex() {
    return new RegExp("(^|\\s|> ?)@(".concat(this.pattern, "(@(").concat(this.pattern, "))?)"), 'gm');
  }

  get channelMentionRegex() {
    return new RegExp("(^|\\s|>)#(".concat(this.pattern, "(@(").concat(this.pattern, "))?)"), 'gm');
  }

  getUserMentions(str) {
    return (str.match(this.userMentionRegex) || []).map(match => match.trim());
  }

  getChannelMentions(str) {
    return (str.match(this.channelMentionRegex) || []).map(match => match.trim());
  }

  parse(message) {
    let msg = message && message.html || '';

    if (!msg.trim()) {
      return message;
    }

    msg = this.replaceUsers(msg, message, this.me);
    msg = this.replaceChannels(msg, message, this.me);
    message.html = msg;
    return message;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions/client/client.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  instance: () => instance,
  renderMentions: () => renderMentions,
  createMentionsMessageRenderer: () => createMentionsMessageRenderer
});
let MentionsParser;
module.link("../lib/MentionsParser", {
  MentionsParser(v) {
    MentionsParser = v;
  }

}, 0);
module.link("./mentionLink.css");
let instance = new MentionsParser({
  me: () => undefined,
  pattern: () => undefined,
  useRealName: () => undefined
});

let renderMentions = message => message;

const createMentionsMessageRenderer = _ref => {
  let {
    me,
    pattern,
    useRealName
  } = _ref;
  module.runSetters(instance = new MentionsParser({
    me: () => me,
    pattern: () => pattern,
    useRealName: () => useRealName
  }), ["instance"]);
  module.runSetters(renderMentions = message => instance.parse(message), ["renderMentions"]);
  return message => instance.parse(message);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":[
  "./client"
],"mentionLink.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions/client/mentionLink.css                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"nextcloud":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/nextcloud/lib/common.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);
let CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth(v) {
    CustomOAuth = v;
  }

}, 4);
const config = {
  serverURL: '',
  tokenPath: '/index.php/apps/oauth2/api/v1/token',
  tokenSentVia: 'header',
  authorizePath: '/index.php/apps/oauth2/authorize',
  identityPath: '/ocs/v2.php/cloud/user?format=json',
  scope: 'openid',
  addAutopublishFields: {
    forLoggedInUser: ['services.nextcloud'],
    forOtherUsers: ['services.nextcloud.name']
  }
};
const Nextcloud = new CustomOAuth('nextcloud', config);

const fillServerURL = _.debounce(Meteor.bindEnvironment(() => {
  const nextcloudURL = settings.get('Accounts_OAuth_Nextcloud_URL');

  if (!nextcloudURL) {
    if (nextcloudURL === undefined) {
      return fillServerURL();
    }

    return;
  }

  config.serverURL = nextcloudURL.trim().replace(/\/*$/, '');
  return Nextcloud.configure(config);
}), Meteor.isServer ? 1000 : 100);

Meteor.startup(function () {
  if (Meteor.isServer) {
    settings.get('Accounts_OAuth_Nextcloud_URL', () => fillServerURL());
  } else {
    Tracker.autorun(function () {
      return fillServerURL();
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/nextcloud/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommand-asciiarts":{"lib":{"gimme.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/lib/gimme.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 1);

/*
 * Gimme is a named function that will replace /gimme commands
 * @param {Object} message - The message object
 */
function Gimme(command, params, item) {
  if (command === 'gimme') {
    const msg = item;
    msg.msg = "\u0F3C \u3064 \u25D5_\u25D5 \u0F3D\u3064 ".concat(params);
    Meteor.call('sendMessage', msg);
  }
}

slashCommands.add('gimme', Gimme, {
  description: 'Slash_Gimme_Description',
  params: 'your_message_optional'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"lenny.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/lib/lenny.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 1);

/*
 * Lenny is a named function that will replace /lenny commands
 * @param {Object} message - The message object
 */
function LennyFace(command, params, item) {
  if (command === 'lennyface') {
    const msg = item;
    msg.msg = "".concat(params, " ( \u0361\xB0 \u035C\u0296 \u0361\xB0)");
    Meteor.call('sendMessage', msg);
  }
}

slashCommands.add('lennyface', LennyFace, {
  description: 'Slash_LennyFace_Description',
  params: 'your_message_optional'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"shrug.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/lib/shrug.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 1);

/*
 * Shrug is a named function that will replace /shrug commands
 * @param {Object} message - The message object
 */
function Shrug(command, params, item) {
  if (command === 'shrug') {
    const msg = item;
    msg.msg = "".concat(params, " \xAF\\_(\u30C4)_/\xAF");
    Meteor.call('sendMessage', msg);
  }
}

slashCommands.add('shrug', Shrug, {
  description: 'Slash_Shrug_Description',
  params: 'your_message_optional'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tableflip.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/lib/tableflip.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 1);

/*
 * Tableflip is a named function that will replace /Tableflip commands
 * @param {Object} message - The message object
 */
function Tableflip(command, params, item) {
  if (command === 'tableflip') {
    const msg = item;
    msg.msg = "".concat(params, " (\u256F\xB0\u25A1\xB0\uFF09\u256F\uFE35 \u253B\u2501\u253B");
    Meteor.call('sendMessage', msg);
  }
}

slashCommands.add('tableflip', Tableflip, {
  description: 'Slash_Tableflip_Description',
  params: 'your_message_optional'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"unflip.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/lib/unflip.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 1);

/*
 * Unflip is a named function that will replace /unflip commands
 * @param {Object} message - The message object
 */
function Unflip(command, params, item) {
  if (command === 'unflip') {
    const msg = item;
    msg.msg = "".concat(params, " \u252C\u2500\u252C \u30CE( \u309C-\u309C\u30CE)");
    Meteor.call('sendMessage', msg);
  }
}

slashCommands.add('unflip', Unflip, {
  description: 'Slash_TableUnflip_Description',
  params: 'your_message_optional'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/client/index.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/gimme");
module.link("../lib/lenny");
module.link("../lib/shrug");
module.link("../lib/tableflip");
module.link("../lib/unflip");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-topic":{"lib":{"topic.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-topic/lib/topic.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 1);
let ChatRoom;
module.link("../../models", {
  ChatRoom(v) {
    ChatRoom = v;
  }

}, 2);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);
let hasPermission;
module.link("../../authorization", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 4);

function Topic(command, params, item) {
  if (command === 'topic') {
    if (Meteor.isClient && hasPermission('edit-room', item.rid) || Meteor.isServer && hasPermission(Meteor.userId(), 'edit-room', item.rid)) {
      Meteor.call('saveRoomSettings', item.rid, 'roomTopic', params, err => {
        if (err) {
          if (Meteor.isClient) {
            const {
              handleError
            } = require('../../../client/lib/utils/handleError');

            return handleError(err);
          }

          throw err;
        }

        if (Meteor.isClient) {
          callbacks.run('roomTopicChanged', ChatRoom.findOne(item.rid));
        }
      });
    }
  }
}

slashCommands.add('topic', Topic, {
  description: 'Slash_Topic_Description',
  params: 'Slash_Topic_Params',
  permission: 'edit-room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-topic/client/index.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/topic");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"wordpress":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/wordpress/lib/common.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration(v) {
    ServiceConfiguration = v;
  }

}, 2);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 3);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 4);
let CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth(v) {
    CustomOAuth = v;
  }

}, 5);
const config = {
  serverURL: '',
  identityPath: '/oauth/me',
  addAutopublishFields: {
    forLoggedInUser: ['services.wordpress'],
    forOtherUsers: ['services.wordpress.user_login']
  },
  accessTokenParam: 'access_token'
};
const WordPress = new CustomOAuth('wordpress', config);

const fillSettings = _.debounce(Meteor.bindEnvironment(() => {
  config.serverURL = settings.get('API_Wordpress_URL');

  if (!config.serverURL) {
    if (config.serverURL === undefined) {
      return fillSettings();
    }

    return;
  }

  delete config.identityPath;
  delete config.identityTokenSentVia;
  delete config.authorizePath;
  delete config.tokenPath;
  delete config.scope;
  const serverType = settings.get('Accounts_OAuth_Wordpress_server_type');

  switch (serverType) {
    case 'custom':
      if (settings.get('Accounts_OAuth_Wordpress_identity_path')) {
        config.identityPath = settings.get('Accounts_OAuth_Wordpress_identity_path');
      }

      if (settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via')) {
        config.identityTokenSentVia = settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via');
      }

      if (settings.get('Accounts_OAuth_Wordpress_token_path')) {
        config.tokenPath = settings.get('Accounts_OAuth_Wordpress_token_path');
      }

      if (settings.get('Accounts_OAuth_Wordpress_authorize_path')) {
        config.authorizePath = settings.get('Accounts_OAuth_Wordpress_authorize_path');
      }

      if (settings.get('Accounts_OAuth_Wordpress_scope')) {
        config.scope = settings.get('Accounts_OAuth_Wordpress_scope');
      }

      break;

    case 'wordpress-com':
      config.identityPath = 'https://public-api.wordpress.com/rest/v1/me';
      config.identityTokenSentVia = 'header';
      config.authorizePath = 'https://public-api.wordpress.com/oauth2/authorize';
      config.tokenPath = 'https://public-api.wordpress.com/oauth2/token';
      config.scope = 'auth';
      break;

    default:
      config.identityPath = '/oauth/me';
      break;
  }

  const result = WordPress.configure(config);

  if (Meteor.isServer) {
    const enabled = settings.get('Accounts_OAuth_Wordpress');

    if (enabled) {
      ServiceConfiguration.configurations.upsert({
        service: 'wordpress'
      }, {
        $set: config
      });
    } else {
      ServiceConfiguration.configurations.remove({
        service: 'wordpress'
      });
    }
  }

  return result;
}), Meteor.isServer ? 1000 : 100);

if (Meteor.isServer) {
  Meteor.startup(function () {
    return settings.watchByRegex(/(API\_Wordpress\_URL)?(Accounts\_OAuth\_Wordpress\_)?/, () => fillSettings());
  });
} else {
  Meteor.startup(function () {
    return Tracker.autorun(function () {
      return fillSettings();
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/wordpress/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./wordpress-login-button.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"wordpress-login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/wordpress/client/wordpress-login-button.css                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"theme":{"client":{"vendor":{"fontello":{"css":{"fontello.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/theme/client/vendor/fontello/css/fontello.css                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"photoswipe.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/theme/client/vendor/photoswipe.css                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"imports":{"components":{"emojiPicker.css":[
  "meteor/modules"
]}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/theme/client/index.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("toastr/build/toastr.min.css");
module.link("./main.css");
module.link("./vendor/photoswipe.css");
module.link("./vendor/fontello/css/fontello.css");
module.link("./rocketchat.font.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.font.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/theme/client/rocketchat.font.css                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"main.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/theme/client/main.css                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"e2e":{"client":{"stylesheets":{"e2e.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/stylesheets/e2e.css                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"E2ERoomState.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/E2ERoomState.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  E2ERoomState: () => E2ERoomState
});
var E2ERoomState;

(function (E2ERoomState) {
  E2ERoomState["NO_PASSWORD_SET"] = "NO_PASSWORD_SET";
  E2ERoomState["NOT_STARTED"] = "NOT_STARTED";
  E2ERoomState["DISABLED"] = "DISABLED";
  E2ERoomState["HANDSHAKE"] = "HANDSHAKE";
  E2ERoomState["ESTABLISHING"] = "ESTABLISHING";
  E2ERoomState["CREATING_KEYS"] = "CREATING_KEYS";
  E2ERoomState["WAITING_KEYS"] = "WAITING_KEYS";
  E2ERoomState["KEYS_RECEIVED"] = "KEYS_RECEIVED";
  E2ERoomState["READY"] = "READY";
  E2ERoomState["ERROR"] = "ERROR";
})(E2ERoomState || module.runSetters(E2ERoomState = {}, ["E2ERoomState"]));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"events.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/events.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 0);
let e2e;
module.link("./rocketchat.e2e", {
  e2e(v) {
    e2e = v;
  }

}, 1);
Accounts.onLogout(() => {
  e2e.stopClient();
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"helper.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/helper.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  toString: () => toString,
  toArrayBuffer: () => toArrayBuffer,
  joinVectorAndEcryptedData: () => joinVectorAndEcryptedData,
  splitVectorAndEcryptedData: () => splitVectorAndEcryptedData,
  encryptRSA: () => encryptRSA,
  encryptAES: () => encryptAES,
  decryptRSA: () => decryptRSA,
  decryptAES: () => decryptAES,
  generateAESKey: () => generateAESKey,
  generateRSAKey: () => generateRSAKey,
  exportJWKKey: () => exportJWKKey,
  importRSAKey: () => importRSAKey,
  importAESKey: () => importAESKey,
  importRawKey: () => importRawKey,
  deriveKey: () => deriveKey,
  readFileAsArrayBuffer: () => readFileAsArrayBuffer,
  Deferred: () => Deferred
});
let ByteBuffer;
module.link("bytebuffer", {
  default(v) {
    ByteBuffer = v;
  }

}, 0);
const StaticArrayBufferProto = new ArrayBuffer().__proto__;

function toString(thing) {
  if (typeof thing === 'string') {
    return thing;
  }

  return new ByteBuffer.wrap(thing).toString('binary');
}

function toArrayBuffer(thing) {
  if (thing === undefined) {
    return undefined;
  }

  if (thing === Object(thing)) {
    if (thing.__proto__ === StaticArrayBufferProto) {
      return thing;
    }
  }

  if (typeof thing !== 'string') {
    throw new Error("Tried to convert a non-string of type ".concat(typeof thing, " to an array buffer"));
  }

  return new ByteBuffer.wrap(thing, 'binary').toArrayBuffer();
}

function joinVectorAndEcryptedData(vector, encryptedData) {
  const cipherText = new Uint8Array(encryptedData);
  const output = new Uint8Array(vector.length + cipherText.length);
  output.set(vector, 0);
  output.set(cipherText, vector.length);
  return output;
}

function splitVectorAndEcryptedData(cipherText) {
  const vector = cipherText.slice(0, 16);
  const encryptedData = cipherText.slice(16);
  return [vector, encryptedData];
}

async function encryptRSA(key, data) {
  return crypto.subtle.encrypt({
    name: 'RSA-OAEP'
  }, key, data);
}

async function encryptAES(vector, key, data) {
  return crypto.subtle.encrypt({
    name: 'AES-CBC',
    iv: vector
  }, key, data);
}

async function decryptRSA(key, data) {
  return crypto.subtle.decrypt({
    name: 'RSA-OAEP'
  }, key, data);
}

async function decryptAES(vector, key, data) {
  return crypto.subtle.decrypt({
    name: 'AES-CBC',
    iv: vector
  }, key, data);
}

async function generateAESKey() {
  return crypto.subtle.generateKey({
    name: 'AES-CBC',
    length: 128
  }, true, ['encrypt', 'decrypt']);
}

async function generateRSAKey() {
  return crypto.subtle.generateKey({
    name: 'RSA-OAEP',
    modulusLength: 2048,
    publicExponent: new Uint8Array([0x01, 0x00, 0x01]),
    hash: {
      name: 'SHA-256'
    }
  }, true, ['encrypt', 'decrypt']);
}

async function exportJWKKey(key) {
  return crypto.subtle.exportKey('jwk', key);
}

async function importRSAKey(keyData) {
  let keyUsages = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ['encrypt', 'decrypt'];
  return crypto.subtle.importKey('jwk', keyData, {
    name: 'RSA-OAEP',
    modulusLength: 2048,
    publicExponent: new Uint8Array([0x01, 0x00, 0x01]),
    hash: {
      name: 'SHA-256'
    }
  }, true, keyUsages);
}

async function importAESKey(keyData) {
  let keyUsages = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ['encrypt', 'decrypt'];
  return crypto.subtle.importKey('jwk', keyData, {
    name: 'AES-CBC'
  }, true, keyUsages);
}

async function importRawKey(keyData) {
  let keyUsages = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ['deriveKey'];
  return crypto.subtle.importKey('raw', keyData, {
    name: 'PBKDF2'
  }, false, keyUsages);
}

async function deriveKey(salt, baseKey) {
  let keyUsages = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : ['encrypt', 'decrypt'];
  const iterations = 1000;
  const hash = 'SHA-256';
  return crypto.subtle.deriveKey({
    name: 'PBKDF2',
    salt,
    iterations,
    hash
  }, baseKey, {
    name: 'AES-CBC',
    length: 256
  }, true, keyUsages);
}

async function readFileAsArrayBuffer(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();

    reader.onload = function (evt) {
      resolve(evt.target.result);
    };

    reader.onerror = function (evt) {
      reject(evt);
    };

    reader.readAsArrayBuffer(file);
  });
}

class Deferred {
  constructor() {
    const p = new Promise((resolve, reject) => {
      this.resolve = resolve;
      this.reject = reject;
    });
    p.resolve = this.resolve;
    p.reject = this.reject;
    return p;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/index.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./stylesheets/e2e.css");
module.link("./rocketchat.e2e", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"logger.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/logger.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  log: () => log,
  logError: () => logError
});
let getConfig;
module.link("../../../client/lib/utils/getConfig", {
  getConfig(v) {
    getConfig = v;
  }

}, 0);
let debug = undefined;

const isDebugEnabled = () => {
  if (debug === undefined) {
    debug = getConfig('debug') === 'true' || getConfig('debug-e2e') === 'true';
  }

  return debug;
};

const log = function (context) {
  for (var _len = arguments.length, msg = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    msg[_key - 1] = arguments[_key];
  }

  isDebugEnabled() && console.log("[".concat(context, "]"), ...msg);
};

const logError = function (context) {
  for (var _len2 = arguments.length, msg = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
    msg[_key2 - 1] = arguments[_key2];
  }

  isDebugEnabled() && console.error("[".concat(context, "]"), ...msg);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.e2e.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/rocketchat.e2e.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["_id"];

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 0);

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 1);
module.export({
  e2e: () => e2e
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let EJSON;
module.link("meteor/ejson", {
  EJSON(v) {
    EJSON = v;
  }

}, 3);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 4);
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 5);
let E2ERoom;
module.link("./rocketchat.e2e.room", {
  E2ERoom(v) {
    E2ERoom = v;
  }

}, 6);
let toString, toArrayBuffer, joinVectorAndEcryptedData, splitVectorAndEcryptedData, encryptAES, decryptAES, generateRSAKey, exportJWKKey, importRSAKey, importRawKey, deriveKey;
module.link("./helper", {
  toString(v) {
    toString = v;
  },

  toArrayBuffer(v) {
    toArrayBuffer = v;
  },

  joinVectorAndEcryptedData(v) {
    joinVectorAndEcryptedData = v;
  },

  splitVectorAndEcryptedData(v) {
    splitVectorAndEcryptedData = v;
  },

  encryptAES(v) {
    encryptAES = v;
  },

  decryptAES(v) {
    decryptAES = v;
  },

  generateRSAKey(v) {
    generateRSAKey = v;
  },

  exportJWKKey(v) {
    exportJWKKey = v;
  },

  importRSAKey(v) {
    importRSAKey = v;
  },

  importRawKey(v) {
    importRawKey = v;
  },

  deriveKey(v) {
    deriveKey = v;
  }

}, 7);
let banners;
module.link("../../../client/lib/banners", {
  "*"(v) {
    banners = v;
  }

}, 8);
let Rooms, Subscriptions, Messages;
module.link("../../models/client", {
  Rooms(v) {
    Rooms = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  },

  Messages(v) {
    Messages = v;
  }

}, 9);
module.link("./events.js");
module.link("./tabbar");
let log, logError;
module.link("./logger", {
  log(v) {
    log = v;
  },

  logError(v) {
    logError = v;
  }

}, 10);
let waitUntilFind;
module.link("../../../client/lib/utils/waitUntilFind", {
  waitUntilFind(v) {
    waitUntilFind = v;
  }

}, 11);
let imperativeModal;
module.link("../../../client/lib/imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 12);
let SaveE2EPasswordModal;
module.link("../../../client/views/e2e/SaveE2EPasswordModal", {
  default(v) {
    SaveE2EPasswordModal = v;
  }

}, 13);
let EnterE2EPasswordModal;
module.link("../../../client/views/e2e/EnterE2EPasswordModal", {
  default(v) {
    EnterE2EPasswordModal = v;
  }

}, 14);
let call;
module.link("../../../client/lib/utils/call", {
  call(v) {
    call = v;
  }

}, 15);
let failedToDecodeKey = false;

class E2E extends Emitter {
  constructor() {
    super();
    this.started = false;
    this.enabled = new ReactiveVar(false);
    this._ready = new ReactiveVar(false);
    this.instancesByRoomId = {};
    this.on('ready', () => {
      this._ready.set(true);

      this.log('startClient -> Done');
      this.log('decryptSubscriptions');
      this.decryptSubscriptions();
      this.log('decryptSubscriptions -> Done');
    });
  }

  log() {
    for (var _len = arguments.length, msg = new Array(_len), _key = 0; _key < _len; _key++) {
      msg[_key] = arguments[_key];
    }

    log('E2E', ...msg);
  }

  error() {
    for (var _len2 = arguments.length, msg = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      msg[_key2] = arguments[_key2];
    }

    logError('E2E', ...msg);
  }

  isEnabled() {
    return this.enabled.get();
  }

  isReady() {
    return this.enabled.get() && this._ready.get();
  }

  async getInstanceByRoomId(rid) {
    const room = await waitUntilFind(() => Rooms.findOne({
      _id: rid
    }));

    if (room.t !== 'd' && room.t !== 'p') {
      return null;
    }

    if (room.encrypted !== true && !room.e2eKeyId) {
      return null;
    }

    if (!this.instancesByRoomId[rid]) {
      this.instancesByRoomId[rid] = new E2ERoom(Meteor.userId(), rid, room.t);
    }

    return this.instancesByRoomId[rid];
  }

  removeInstanceByRoomId(rid) {
    delete this.instancesByRoomId[rid];
  }

  async startClient() {
    if (this.started) {
      return;
    }

    this.log('startClient -> STARTED');
    this.started = true;

    let public_key = Meteor._localStorage.getItem('public_key');

    let private_key = Meteor._localStorage.getItem('private_key');

    await this.loadKeysFromDB();

    if (!public_key && this.db_public_key) {
      public_key = this.db_public_key;
    }

    if (!private_key && this.db_private_key) {
      try {
        private_key = await this.decodePrivateKey(this.db_private_key);
      } catch (error) {
        this.started = false;
        failedToDecodeKey = true;
        this.openAlert({
          title: TAPi18n.__("Wasn't possible to decode your encryption key to be imported."),
          html: '<div>Your encryption password seems wrong. Click here to try again.</div>',
          modifiers: ['large', 'danger'],
          closable: true,
          icon: 'key',
          action: () => {
            this.startClient();
            this.closeAlert();
          }
        });
        return;
      }
    }

    if (public_key && private_key) {
      await this.loadKeys({
        public_key,
        private_key
      });
    } else {
      await this.createAndLoadKeys();
    } // TODO: Split in 2 methods to persist keys


    if (!this.db_public_key || !this.db_private_key) {
      await call('e2e.setUserPublicAndPrivateKeys', {
        public_key: Meteor._localStorage.getItem('public_key'),
        private_key: await this.encodePrivateKey(Meteor._localStorage.getItem('private_key'), this.createRandomPassword())
      });
    }

    const randomPassword = Meteor._localStorage.getItem('e2e.randomPassword');

    if (randomPassword) {
      const passwordRevealText = TAPi18n.__('E2E_password_reveal_text', {
        postProcess: 'sprintf',
        sprintf: [randomPassword]
      });

      this.openAlert({
        title: TAPi18n.__('Save_Your_Encryption_Password'),
        html: TAPi18n.__('Click_here_to_view_and_copy_your_password'),
        modifiers: ['large'],
        closable: false,
        icon: 'key',
        action: () => {
          imperativeModal.open({
            component: SaveE2EPasswordModal,
            props: {
              passwordRevealText,
              onClose: imperativeModal.close,
              onCancel: () => {
                this.closeAlert();
                imperativeModal.close();
              },
              onConfirm: () => {
                Meteor._localStorage.removeItem('e2e.randomPassword');

                this.closeAlert();
                imperativeModal.close();
              }
            }
          });
        }
      });
    }

    this.emit('ready');
  }

  async stopClient() {
    this.log('-> Stop Client');
    this.closeAlert();

    Meteor._localStorage.removeItem('public_key');

    Meteor._localStorage.removeItem('private_key');

    this.instancesByRoomId = {};
    this.privateKey = null;
    this.enabled.set(false);

    this._ready.set(false);

    this.started = false;
  }

  async changePassword(newPassword) {
    await call('e2e.setUserPublicAndPrivateKeys', {
      public_key: Meteor._localStorage.getItem('public_key'),
      private_key: await this.encodePrivateKey(Meteor._localStorage.getItem('private_key'), newPassword)
    });

    if (Meteor._localStorage.getItem('e2e.randomPassword')) {
      Meteor._localStorage.setItem('e2e.randomPassword', newPassword);
    }
  }

  async loadKeysFromDB() {
    try {
      const {
        public_key,
        private_key
      } = await call('e2e.fetchMyKeys');
      this.db_public_key = public_key;
      this.db_private_key = private_key;
    } catch (error) {
      return this.error('Error fetching RSA keys: ', error);
    }
  }

  async loadKeys(_ref) {
    let {
      public_key,
      private_key
    } = _ref;

    Meteor._localStorage.setItem('public_key', public_key);

    try {
      this.privateKey = await importRSAKey(EJSON.parse(private_key), ['decrypt']);

      Meteor._localStorage.setItem('private_key', private_key);
    } catch (error) {
      return this.error('Error importing private key: ', error);
    }
  }

  async createAndLoadKeys() {
    // Could not obtain public-private keypair from server.
    let key;

    try {
      key = await generateRSAKey();
      this.privateKey = key.privateKey;
    } catch (error) {
      return this.error('Error generating key: ', error);
    }

    try {
      const publicKey = await exportJWKKey(key.publicKey);

      Meteor._localStorage.setItem('public_key', JSON.stringify(publicKey));
    } catch (error) {
      return this.error('Error exporting public key: ', error);
    }

    try {
      const privateKey = await exportJWKKey(key.privateKey);

      Meteor._localStorage.setItem('private_key', JSON.stringify(privateKey));
    } catch (error) {
      return this.error('Error exporting private key: ', error);
    }

    this.requestSubscriptionKeys();
  }

  async requestSubscriptionKeys() {
    call('e2e.requestSubscriptionKeys');
  }

  createRandomPassword() {
    const randomPassword = "".concat(Random.id(3), "-").concat(Random.id(3), "-").concat(Random.id(3)).toLowerCase();

    Meteor._localStorage.setItem('e2e.randomPassword', randomPassword);

    return randomPassword;
  }

  async encodePrivateKey(private_key, password) {
    const masterKey = await this.getMasterKey(password);
    const vector = crypto.getRandomValues(new Uint8Array(16));

    try {
      const encodedPrivateKey = await encryptAES(vector, masterKey, toArrayBuffer(private_key));
      return EJSON.stringify(joinVectorAndEcryptedData(vector, encodedPrivateKey));
    } catch (error) {
      return this.error('Error encrypting encodedPrivateKey: ', error);
    }
  }

  async getMasterKey(password) {
    if (password == null) {
      alert('You should provide a password');
    } // First, create a PBKDF2 "key" containing the password


    let baseKey;

    try {
      baseKey = await importRawKey(toArrayBuffer(password));
    } catch (error) {
      return this.error('Error creating a key based on user password: ', error);
    } // Derive a key from the password


    try {
      return await deriveKey(toArrayBuffer(Meteor.userId()), baseKey);
    } catch (error) {
      return this.error('Error deriving baseKey: ', error);
    }
  }

  async requestPassword() {
    return new Promise(resolve => {
      const showModal = () => {
        imperativeModal.open({
          component: EnterE2EPasswordModal,
          props: {
            onClose: imperativeModal.close,
            onCancel: () => {
              failedToDecodeKey = false;
              this.closeAlert();
              imperativeModal.close();
            },
            onConfirm: password => {
              resolve(password);
              this.closeAlert();
              imperativeModal.close();
            }
          }
        });
      };

      const showAlert = () => {
        this.openAlert({
          title: TAPi18n.__('Enter_your_E2E_password'),
          html: TAPi18n.__('Click_here_to_enter_your_encryption_password'),
          modifiers: ['large'],
          closable: false,
          icon: 'key',

          action() {
            showModal();
          }

        });
      };

      if (failedToDecodeKey) {
        showModal();
      } else {
        showAlert();
      }
    });
  }

  async decodePrivateKey(private_key) {
    const password = await this.requestPassword();
    const masterKey = await this.getMasterKey(password);
    const [vector, cipherText] = splitVectorAndEcryptedData(EJSON.parse(private_key));

    try {
      const privKey = await decryptAES(vector, masterKey, cipherText);
      return toString(privKey);
    } catch (error) {
      throw new Error('E2E -> Error decrypting private key');
    }
  }

  async decryptMessage(message) {
    if (message.t !== 'e2e' || message.e2e === 'done') {
      return message;
    }

    const e2eRoom = await this.getInstanceByRoomId(message.rid);

    if (!e2eRoom) {
      return message;
    }

    const data = await e2eRoom.decrypt(message.msg);

    if (!data) {
      return message;
    }

    return _objectSpread(_objectSpread({}, message), {}, {
      msg: data.text,
      e2e: 'done'
    });
  }

  async decryptPendingMessages() {
    return Messages.find({
      t: 'e2e',
      e2e: 'pending'
    }).forEach(async _ref2 => {
      let {
        _id
      } = _ref2,
          msg = _objectWithoutProperties(_ref2, _excluded);

      Messages.direct.update({
        _id
      }, await this.decryptMessage(msg));
    });
  }

  async decryptSubscription(rid) {
    const e2eRoom = await this.getInstanceByRoomId(rid);
    this.log('decryptSubscription ->', rid);
    e2eRoom === null || e2eRoom === void 0 ? void 0 : e2eRoom.decryptSubscription();
  }

  async decryptSubscriptions() {
    Subscriptions.find({
      encrypted: true
    }).forEach(room => this.decryptSubscription(room._id));
  }

  openAlert(config) {
    banners.open(_objectSpread({
      id: 'e2e'
    }, config));
  }

  closeAlert() {
    banners.closeById('e2e');
  }

}

const e2e = new E2E();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.e2e.room.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/rocketchat.e2e.room.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["_id"];

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
module.export({
  E2ERoom: () => E2ERoom
});

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let Base64;
module.link("meteor/base64", {
  Base64(v) {
    Base64 = v;
  }

}, 1);
let EJSON;
module.link("meteor/ejson", {
  EJSON(v) {
    EJSON = v;
  }

}, 2);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 3);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 4);
let TimeSync;
module.link("meteor/mizzao:timesync", {
  TimeSync(v) {
    TimeSync = v;
  }

}, 5);
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 6);
let e2e;
module.link("./rocketchat.e2e", {
  e2e(v) {
    e2e = v;
  }

}, 7);
let toString, toArrayBuffer, joinVectorAndEcryptedData, splitVectorAndEcryptedData, encryptRSA, encryptAES, decryptRSA, decryptAES, generateAESKey, exportJWKKey, importAESKey, importRSAKey, readFileAsArrayBuffer;
module.link("./helper", {
  toString(v) {
    toString = v;
  },

  toArrayBuffer(v) {
    toArrayBuffer = v;
  },

  joinVectorAndEcryptedData(v) {
    joinVectorAndEcryptedData = v;
  },

  splitVectorAndEcryptedData(v) {
    splitVectorAndEcryptedData = v;
  },

  encryptRSA(v) {
    encryptRSA = v;
  },

  encryptAES(v) {
    encryptAES = v;
  },

  decryptRSA(v) {
    decryptRSA = v;
  },

  decryptAES(v) {
    decryptAES = v;
  },

  generateAESKey(v) {
    generateAESKey = v;
  },

  exportJWKKey(v) {
    exportJWKKey = v;
  },

  importAESKey(v) {
    importAESKey = v;
  },

  importRSAKey(v) {
    importRSAKey = v;
  },

  readFileAsArrayBuffer(v) {
    readFileAsArrayBuffer = v;
  }

}, 8);
let Notifications;
module.link("../../notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 9);
let Rooms, Subscriptions, Messages;
module.link("../../models/client", {
  Rooms(v) {
    Rooms = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  },

  Messages(v) {
    Messages = v;
  }

}, 10);
let roomTypes, RoomSettingsEnum;
module.link("../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  },

  RoomSettingsEnum(v) {
    RoomSettingsEnum = v;
  }

}, 11);
let log, logError;
module.link("./logger", {
  log(v) {
    log = v;
  },

  logError(v) {
    logError = v;
  }

}, 12);
let E2ERoomState;
module.link("./E2ERoomState", {
  E2ERoomState(v) {
    E2ERoomState = v;
  }

}, 13);
let call;
module.link("../../../client/lib/utils/call", {
  call(v) {
    call = v;
  }

}, 14);
const KEY_ID = Symbol('keyID');
const PAUSED = Symbol('PAUSED');
const permitedMutations = {
  [E2ERoomState.NOT_STARTED]: [E2ERoomState.ESTABLISHING, E2ERoomState.DISABLED, E2ERoomState.KEYS_RECEIVED],
  [E2ERoomState.READY]: [E2ERoomState.DISABLED],
  [E2ERoomState.ERROR]: [E2ERoomState.KEYS_RECEIVED, E2ERoomState.NOT_STARTED],
  [E2ERoomState.WAITING_KEYS]: [E2ERoomState.KEYS_RECEIVED, E2ERoomState.ERROR, E2ERoomState.DISABLED],
  [E2ERoomState.ESTABLISHING]: [E2ERoomState.READY, E2ERoomState.KEYS_RECEIVED, E2ERoomState.ERROR, E2ERoomState.DISABLED, E2ERoomState.WAITING_KEYS]
};

const filterMutation = (currentState, nextState) => {
  if (currentState === nextState) {
    return nextState === E2ERoomState.ERROR;
  }

  if (!(currentState in permitedMutations)) {
    return nextState;
  }

  if (permitedMutations[currentState].includes(nextState)) {
    return nextState;
  }

  return false;
};

class E2ERoom extends Emitter {
  constructor(userId, roomId, t) {
    super();
    this.state = undefined;
    this[PAUSED] = undefined;
    this.userId = userId;
    this.roomId = roomId;
    this.typeOfRoom = t;
    this.once(E2ERoomState.READY, () => this.decryptPendingMessages());
    this.once(E2ERoomState.READY, () => this.decryptSubscription());
    this.on('STATE_CHANGED', prev => {
      if (this.roomId === Session.get('openedRoom')) {
        this.log("[PREV: ".concat(prev, "]"), 'State CHANGED');
      }
    });
    this.on('STATE_CHANGED', () => this.handshake());
    this.setState(E2ERoomState.NOT_STARTED);
  }

  log() {
    for (var _len = arguments.length, msg = new Array(_len), _key = 0; _key < _len; _key++) {
      msg[_key] = arguments[_key];
    }

    log("E2E ROOM { state: ".concat(this.state, ", rid: ").concat(this.roomId, " }"), ...msg);
  }

  error() {
    for (var _len2 = arguments.length, msg = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      msg[_key2] = arguments[_key2];
    }

    logError("E2E ROOM { state: ".concat(this.state, ", rid: ").concat(this.roomId, " }"), ...msg);
  }

  setState(requestedState) {
    const currentState = this.state;
    const nextState = filterMutation(currentState, requestedState);

    if (!nextState) {
      this.error("invalid state ".concat(currentState, " -> ").concat(requestedState));
      return;
    }

    this.state = nextState;
    this.log(currentState, '->', nextState);
    this.emit('STATE_CHANGED', currentState, nextState, this);
    this.emit(nextState, this);
  }

  isReady() {
    return this.state === E2ERoomState.READY;
  }

  isDisabled() {
    return this.state === E2ERoomState.DISABLED;
  }

  enable() {
    if (this.state === E2ERoomState.READY) {
      return;
    }

    this.setState(E2ERoomState.READY);
  }

  disable() {
    this.setState(E2ERoomState.DISABLED);
  }

  pause() {
    this.log('PAUSED', this[PAUSED], '->', true);
    this[PAUSED] = true;
    this.emit('PAUSED', true);
  }

  resume() {
    this.log('PAUSED', this[PAUSED], '->', false);
    this[PAUSED] = false;
    this.emit('PAUSED', false);
  }

  keyReceived() {
    this.setState(E2ERoomState.KEYS_RECEIVED);
  }

  async shouldConvertSentMessages() {
    if (!this.isReady() || this[PAUSED]) {
      return false;
    }

    if (this[PAUSED] === undefined) {
      return new Promise(resolve => {
        this.once('PAUSED', resolve);
      });
    }

    return true;
  }

  shouldConvertReceivedMessages() {
    return this.isReady();
  }

  isWaitingKeys() {
    return this.state === E2ERoomState.WAITING_KEYS;
  }

  get keyID() {
    return this[KEY_ID];
  }

  set keyID(keyID) {
    this[KEY_ID] = keyID;
  }

  async decryptSubscription() {
    var _subscription$lastMes;

    const subscription = Subscriptions.findOne({
      rid: this.roomId
    });
    const data = await (((_subscription$lastMes = subscription.lastMessage) === null || _subscription$lastMes === void 0 ? void 0 : _subscription$lastMes.msg) && this.decrypt(subscription.lastMessage.msg));

    if (!(data !== null && data !== void 0 && data.text)) {
      this.log('decryptSubscriptions nothing to do');
      return;
    }

    Subscriptions.direct.update({
      _id: subscription._id
    }, {
      $set: {
        'lastMessage.msg': data.text,
        'lastMessage.e2e': 'done'
      }
    });
    this.log('decryptSubscriptions Done');
  }

  async decryptPendingMessages() {
    return Messages.find({
      rid: this.roomId,
      t: 'e2e',
      e2e: 'pending'
    }).forEach(async _ref => {
      let {
        _id
      } = _ref,
          msg = _objectWithoutProperties(_ref, _excluded);

      Messages.direct.update({
        _id
      }, await this.decryptMessage(msg));
    });
  } // Initiates E2E Encryption


  async handshake() {
    if (this.state !== E2ERoomState.KEYS_RECEIVED && this.state !== E2ERoomState.NOT_STARTED) {
      return;
    }

    this.setState(E2ERoomState.ESTABLISHING);

    try {
      const groupKey = Subscriptions.findOne({
        rid: this.roomId
      }).E2EKey;

      if (groupKey) {
        await this.importGroupKey(groupKey);
        this.setState(E2ERoomState.READY);
        return;
      }
    } catch (error) {
      this.setState(E2ERoomState.ERROR);
      this.error('Error fetching group key: ', error);
      return;
    }

    try {
      const room = Rooms.findOne({
        _id: this.roomId
      });

      if (!room.e2eKeyId) {
        // TODO CHECK_PERMISSION
        this.setState(E2ERoomState.CREATING_KEYS);
        await this.createGroupKey();
        this.setState(E2ERoomState.READY);
        return;
      }

      this.setState(E2ERoomState.WAITING_KEYS);
      this.log('Requesting room key');
      Notifications.notifyUsersOfRoom(this.roomId, 'e2ekeyRequest', this.roomId, room.e2eKeyId);
    } catch (error) {
      // this.error = error;
      this.setState(E2ERoomState.ERROR);
    }
  }

  isSupportedRoomType(type) {
    return roomTypes.getConfig(type).allowRoomSettingChange({}, RoomSettingsEnum.E2E);
  }

  async importGroupKey(groupKey) {
    this.log('Importing room key ->', this.roomId); // Get existing group key
    // const keyID = groupKey.slice(0, 12);

    groupKey = groupKey.slice(12);
    groupKey = Base64.decode(groupKey); // Decrypt obtained encrypted session key

    try {
      const decryptedKey = await decryptRSA(e2e.privateKey, groupKey);
      this.sessionKeyExportedString = toString(decryptedKey);
    } catch (error) {
      return this.error('Error decrypting group key: ', error);
    }

    this.keyID = Base64.encode(this.sessionKeyExportedString).slice(0, 12); // Import session key for use.

    try {
      const key = await importAESKey(JSON.parse(this.sessionKeyExportedString)); // Key has been obtained. E2E is now in session.

      this.groupSessionKey = key;
    } catch (error) {
      return this.error('Error importing group key: ', error);
    }
  }

  async createGroupKey() {
    this.log('Creating room key'); // Create group key

    try {
      this.groupSessionKey = await generateAESKey();
    } catch (error) {
      console.error('Error generating group key: ', error);
      throw error;
    }

    try {
      const sessionKeyExported = await exportJWKKey(this.groupSessionKey);
      this.sessionKeyExportedString = JSON.stringify(sessionKeyExported);
      this.keyID = Base64.encode(this.sessionKeyExportedString).slice(0, 12);
      await call('e2e.setRoomKeyID', this.roomId, this.keyID);
      await this.encryptKeyForOtherParticipants();
    } catch (error) {
      this.error('Error exporting group key: ', error);
      throw error;
    }
  }

  async encryptKeyForOtherParticipants() {
    // Encrypt generated session key for every user in room and publish to subscription model.
    try {
      const {
        users
      } = await call('e2e.getUsersOfRoomWithoutKey', this.roomId);
      users.forEach(user => this.encryptForParticipant(user));
    } catch (error) {
      return this.error('Error getting room users: ', error);
    }
  }

  async encryptForParticipant(user) {
    let userKey;

    try {
      userKey = await importRSAKey(JSON.parse(user.e2e.public_key), ['encrypt']);
    } catch (error) {
      return this.error('Error importing user key: ', error);
    } // const vector = crypto.getRandomValues(new Uint8Array(16));
    // Encrypt session key for this user with his/her public key


    try {
      const encryptedUserKey = await encryptRSA(userKey, toArrayBuffer(this.sessionKeyExportedString)); // Key has been encrypted. Publish to that user's subscription model for this room.

      await call('e2e.updateGroupKey', this.roomId, user._id, this.keyID + Base64.encode(new Uint8Array(encryptedUserKey)));
    } catch (error) {
      return this.error('Error encrypting user key: ', error);
    }
  } // Encrypts files before upload. I/O is in arraybuffers.


  async encryptFile(file) {
    if (!this.isSupportedRoomType(this.typeOfRoom)) {
      return;
    }

    const fileArrayBuffer = await readFileAsArrayBuffer(file);
    const vector = crypto.getRandomValues(new Uint8Array(16));
    let result;

    try {
      result = await encryptAES(vector, this.groupSessionKey, fileArrayBuffer);
    } catch (error) {
      return this.error('Error encrypting group key: ', error);
    }

    const output = joinVectorAndEcryptedData(vector, result);
    const encryptedFile = new File([toArrayBuffer(EJSON.stringify(output))], file.name);
    return encryptedFile;
  } // Decrypt uploaded encrypted files. I/O is in arraybuffers.


  async decryptFile(message) {
    if (message[0] !== '{') {
      return;
    }

    const [vector, cipherText] = splitVectorAndEcryptedData(EJSON.parse(message));

    try {
      return await decryptAES(vector, this.groupSessionKey, cipherText);
    } catch (error) {
      this.error('Error decrypting file: ', error);
      return false;
    }
  } // Encrypts messages


  async encryptText(data) {
    if (!_.isObject(data)) {
      data = new TextEncoder('UTF-8').encode(EJSON.stringify({
        text: data,
        ack: Random.id((Random.fraction() + 1) * 20)
      }));
    }

    if (!this.isSupportedRoomType(this.typeOfRoom)) {
      return data;
    }

    const vector = crypto.getRandomValues(new Uint8Array(16));
    let result;

    try {
      result = await encryptAES(vector, this.groupSessionKey, data);
    } catch (error) {
      return this.error('Error encrypting message: ', error);
    }

    return this.keyID + Base64.encode(joinVectorAndEcryptedData(vector, result));
  } // Helper function for encryption of messages


  encrypt(message) {
    let ts;

    if (isNaN(TimeSync.serverOffset())) {
      ts = new Date();
    } else {
      ts = new Date(Date.now() + TimeSync.serverOffset());
    }

    const data = new TextEncoder('UTF-8').encode(EJSON.stringify({
      _id: message._id,
      text: message.msg,
      userId: this.userId,
      ts
    }));
    return this.encryptText(data);
  } // Decrypt messages


  async decryptMessage(message) {
    if (message.t !== 'e2e' || message.e2e === 'done') {
      return message;
    }

    const data = await this.decrypt(message.msg);

    if (!(data !== null && data !== void 0 && data.text)) {
      return message;
    }

    return _objectSpread(_objectSpread({}, message), {}, {
      msg: data.text,
      e2e: 'done'
    });
  }

  async decrypt(message) {
    if (!this.isSupportedRoomType(this.typeOfRoom)) {
      return message;
    }

    const keyID = message.slice(0, 12);

    if (keyID !== this.keyID) {
      return message;
    }

    message = message.slice(12);
    const [vector, cipherText] = splitVectorAndEcryptedData(Base64.decode(message));

    try {
      const result = await decryptAES(vector, this.groupSessionKey, cipherText);
      return EJSON.parse(new TextDecoder('UTF-8').decode(new Uint8Array(result)));
    } catch (error) {
      return this.error('Error decrypting message: ', error, message);
    }
  }

  provideKeyToUser(keyId) {
    if (this.keyID !== keyId) {
      return;
    }

    this.encryptKeyForOtherParticipants();
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabbar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/tabbar.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo, useCallback;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  },

  useCallback(v) {
    useCallback = v;
  }

}, 0);
let useMutableCallback;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback(v) {
    useMutableCallback = v;
  }

}, 1);
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 2);
let useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 3);
let usePermission;
module.link("../../../client/contexts/AuthorizationContext", {
  usePermission(v) {
    usePermission = v;
  }

}, 4);
let useMethod;
module.link("../../../client/contexts/ServerContext", {
  useMethod(v) {
    useMethod = v;
  }

}, 5);
let useReactiveValue;
module.link("../../../client/hooks/useReactiveValue", {
  useReactiveValue(v) {
    useReactiveValue = v;
  }

}, 6);
let e2e;
module.link("./rocketchat.e2e", {
  e2e(v) {
    e2e = v;
  }

}, 7);
addAction('e2e', _ref => {
  let {
    room
  } = _ref;
  const e2eEnabled = useSetting('E2E_Enable');
  const e2eReady = useReactiveValue(useCallback(() => e2e.isReady(), [])) || room.encrypted;
  const canToggleE2e = usePermission('toggle-room-e2e-encryption', room._id);
  const canEditRoom = usePermission('edit-room', room._id);
  const hasPermission = (room.t === 'd' || canEditRoom && canToggleE2e) && e2eReady;
  const toggleE2E = useMethod('saveRoomSettings');
  const action = useMutableCallback(() => {
    toggleE2E(room._id, 'encrypted', !room.encrypted);
  });
  const enabledOnRoom = !!room.encrypted;
  return useMemo(() => e2eEnabled && hasPermission ? {
    groups: ['direct', 'direct_multiple', 'group', 'team'],
    id: 'e2e',
    title: enabledOnRoom ? 'E2E_disable' : 'E2E_enable',
    icon: 'key',
    order: 13,
    action
  } : null, [action, e2eEnabled, enabledOnRoom, hasPermission]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"models":{"client":{"models":{"Avatars.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/Avatars.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Avatars: () => Avatars
});
let Base;
module.link("./_Base", {
  Base(v) {
    Base = v;
  }

}, 0);

class Avatars extends Base {
  constructor() {
    super();

    this._initModel('avatars');
  }

}

module.exportDefault(new Avatars());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"CachedChannelList.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/CachedChannelList.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CachedChannelList: () => CachedChannelList
});
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
const CachedChannelList = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"CachedChatRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/CachedChatRoom.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CachedChatRoom: () => CachedChatRoom
});
let CachedCollection;
module.link("../../../ui-cached-collection", {
  CachedCollection(v) {
    CachedCollection = v;
  }

}, 0);
const CachedChatRoom = new CachedCollection({
  name: 'rooms'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"CachedChatSubscription.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/CachedChatSubscription.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CachedChatSubscription: () => CachedChatSubscription
});
let CachedCollection;
module.link("../../../ui-cached-collection", {
  CachedCollection(v) {
    CachedCollection = v;
  }

}, 0);
const CachedChatSubscription = new CachedCollection({
  name: 'subscriptions'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"CachedUserList.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/CachedUserList.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CachedUserList: () => CachedUserList
});
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
const CachedUserList = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ChatMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/ChatMessage.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ChatMessage: () => ChatMessage
});
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
const ChatMessage = new Mongo.Collection(null);

ChatMessage.setReactions = function (messageId, reactions) {
  return this.update({
    _id: messageId
  }, {
    $set: {
      reactions
    }
  });
};

ChatMessage.unsetReactions = function (messageId) {
  return this.update({
    _id: messageId
  }, {
    $unset: {
      reactions: 1
    }
  });
};

ChatMessage.findOneByRoomIdAndMessageId = function (rid, messageId, options) {
  const query = {
    rid,
    _id: messageId
  };
  return this.findOne(query, options);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ChatPermissions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/ChatPermissions.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AuthzCachedCollection: () => AuthzCachedCollection,
  ChatPermissions: () => ChatPermissions
});
let CachedCollection;
module.link("../../../ui-cached-collection", {
  CachedCollection(v) {
    CachedCollection = v;
  }

}, 0);
const AuthzCachedCollection = new CachedCollection({
  name: 'permissions',
  eventType: 'onLogged'
});
const ChatPermissions = AuthzCachedCollection.collection;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ChatRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/ChatRoom.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ChatRoom: () => ChatRoom
});
let CachedChatRoom;
module.link("./CachedChatRoom", {
  CachedChatRoom(v) {
    CachedChatRoom = v;
  }

}, 0);
const ChatRoom = CachedChatRoom.collection;

ChatRoom.setReactionsInLastMessage = function (roomId, lastMessage) {
  return this.update({
    _id: roomId
  }, {
    $set: {
      lastMessage
    }
  });
};

ChatRoom.unsetReactionsInLastMessage = function (roomId) {
  return this.update({
    _id: roomId
  }, {
    $unset: {
      lastMessage: {
        reactions: 1
      }
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ChatSubscription.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/ChatSubscription.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ChatSubscription: () => ChatSubscription
});
let CachedChatSubscription;
module.link("./CachedChatSubscription", {
  CachedChatSubscription(v) {
    CachedChatSubscription = v;
  }

}, 0);
const ChatSubscription = CachedChatSubscription.collection;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"CustomSounds.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/CustomSounds.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CustomSounds: () => CustomSounds
});
let Base;
module.link("./_Base", {
  Base(v) {
    Base = v;
  }

}, 0);

class CustomSounds extends Base {
  constructor() {
    super();

    this._initModel('custom_sounds');
  }

}

module.exportDefault(new CustomSounds());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"EmojiCustom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/EmojiCustom.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  EmojiCustom: () => EmojiCustom
});
let Base;
module.link("./_Base", {
  Base(v) {
    Base = v;
  }

}, 0);

class EmojiCustom extends Base {
  constructor() {
    super();

    this._initModel('custom_emoji');
  } // find


  findByNameOrAlias(name, options) {
    const query = {
      $or: [{
        name
      }, {
        aliases: name
      }]
    };
    return this.find(query, options);
  }

}

module.exportDefault(new EmojiCustom());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Roles.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/Roles.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Roles: () => Roles
});
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Models;
module.link("..", {
  "*"(v) {
    Models = v;
  }

}, 2);
const Roles = Object.assign(new Mongo.Collection(null), {
  findUsersInRole(name, scope, options) {
    const role = this.findOne(name);
    const roleScope = role && role.scope || 'Users';
    const model = Models[roleScope];
    return model && model.findUsersInRoles && model.findUsersInRoles(name, scope, options);
  },

  isUserInRoles(userId, roles, scope) {
    roles = [].concat(roles);
    return roles.some(roleName => {
      const role = this.findOne(roleName);
      const roleScope = role && role.scope || 'Users';
      const model = Models[roleScope];
      return model && model.isUserInRole && model.isUserInRole(userId, roleName, scope);
    });
  },

  ready: new ReactiveVar(false)
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomRoles.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/RoomRoles.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RoomRoles: () => RoomRoles
});
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
const RoomRoles = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Subscriptions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/Subscriptions.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Subscriptions: () => Subscriptions
});

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let mem;
module.link("mem", {
  default(v) {
    mem = v;
  }

}, 1);
let Users;
module.link("..", {
  Users(v) {
    Users = v;
  }

}, 2);
const Subscriptions = {};
Object.assign(Subscriptions, {
  isUserInRole: mem(function (userId, roleName, roomId) {
    if (roomId == null) {
      return false;
    }

    const query = {
      rid: roomId
    };
    const subscription = this.findOne(query, {
      fields: {
        roles: 1
      }
    });
    return subscription && Array.isArray(subscription.roles) && subscription.roles.includes(roleName);
  }, {
    maxAge: 1000,
    cacheKey: JSON.stringify
  }),
  findUsersInRoles: mem(function (roles, scope, options) {
    roles = [].concat(roles);
    const query = {
      roles: {
        $in: roles
      }
    };

    if (scope) {
      query.rid = scope;
    }

    const subscriptions = this.find(query).fetch();

    const users = _.compact(_.map(subscriptions, function (subscription) {
      if (typeof subscription.u !== 'undefined' && typeof subscription.u._id !== 'undefined') {
        return subscription.u._id;
      }
    }));

    return Users.find({
      _id: {
        $in: users
      }
    }, options);
  }, {
    maxAge: 1000,
    cacheKey: JSON.stringify
  })
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Uploads.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/Uploads.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Uploads: () => Uploads
});
let Base;
module.link("./_Base", {
  Base(v) {
    Base = v;
  }

}, 0);

class Uploads extends Base {
  constructor() {
    super();

    this._initModel('uploads');
  }

}

module.exportDefault(new Uploads());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserAndRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/UserAndRoom.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  UserAndRoom: () => UserAndRoom
});
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
const UserAndRoom = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserDataFiles.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/UserDataFiles.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  UserDataFiles: () => UserDataFiles
});
let Base;
module.link("./_Base", {
  Base(v) {
    Base = v;
  }

}, 0);

class UserDataFiles extends Base {
  constructor() {
    super();

    this._initModel('userDataFiles');
  }

}

module.exportDefault(new UserDataFiles());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserRoles.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/UserRoles.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  UserRoles: () => UserRoles
});
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
const UserRoles = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Users.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/Users.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Users: () => Users
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 1);
const Users = {
  findOneById(userId) {
    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    const query = {
      _id: userId
    };
    return this.findOne(query, options);
  },

  isUserInRole(userId, roleName) {
    const user = this.findOneById(userId, {
      fields: {
        roles: 1
      }
    });
    return user && Array.isArray(user.roles) && user.roles.includes(roleName);
  },

  findUsersInRoles(roles, scope, options) {
    roles = [].concat(roles);
    const query = {
      roles: {
        $in: roles
      }
    };
    return this.find(query, options);
  }

};
// overwrite Meteor.users collection so records on it don't get erased whenever the client reconnects to websocket
Meteor.users = new Mongo.Collection(null);

Meteor.user = () => Meteor.users.findOne({
  _id: Meteor.userId()
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"WebdavAccounts.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/WebdavAccounts.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  WebdavAccounts: () => WebdavAccounts
});
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
const WebdavAccounts = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"_Base.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/_Base.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Base: () => Base
});
let check;
module.link("meteor/check", {
  check(v) {
    check = v;
  }

}, 0);
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 1);

class Base {
  _baseName() {
    return 'rocketchat_';
  }

  _initModel(name) {
    check(name, String);
    this.model = new Mongo.Collection(this._baseName() + name);
    return this.model;
  }

  find() {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    return this.model.find.apply(this.model, args);
  }

  findOne() {
    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    return this.model.findOne.apply(this.model, args);
  }

  insert() {
    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
      args[_key3] = arguments[_key3];
    }

    return this.model.insert.apply(this.model, args);
  }

  update() {
    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
      args[_key4] = arguments[_key4];
    }

    return this.model.update.apply(this.model, args);
  }

  upsert() {
    for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
      args[_key5] = arguments[_key5];
    }

    return this.model.upsert.apply(this.model, args);
  }

  remove() {
    for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {
      args[_key6] = arguments[_key6];
    }

    return this.model.remove.apply(this.model, args);
  }

  allow() {
    for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {
      args[_key7] = arguments[_key7];
    }

    return this.model.allow.apply(this.model, args);
  }

  deny() {
    for (var _len8 = arguments.length, args = new Array(_len8), _key8 = 0; _key8 < _len8; _key8++) {
      args[_key8] = arguments[_key8];
    }

    return this.model.deny.apply(this.model, args);
  }

  ensureIndex() {}

  dropIndex() {}

  tryEnsureIndex() {}

  tryDropIndex() {}

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Base: () => Base,
  Avatars: () => Avatars,
  Uploads: () => Uploads,
  UserDataFiles: () => UserDataFiles,
  Roles: () => Roles,
  Subscriptions: () => Subscriptions,
  Users: () => Users,
  Messages: () => Messages,
  CachedChannelList: () => CachedChannelList,
  CachedChatRoom: () => CachedChatRoom,
  CachedChatSubscription: () => CachedChatSubscription,
  CachedUserList: () => CachedUserList,
  ChatRoom: () => ChatRoom,
  RoomRoles: () => RoomRoles,
  UserAndRoom: () => UserAndRoom,
  UserRoles: () => UserRoles,
  AuthzCachedCollection: () => AuthzCachedCollection,
  ChatPermissions: () => ChatPermissions,
  ChatMessage: () => ChatMessage,
  ChatSubscription: () => ChatSubscription,
  Rooms: () => Rooms,
  CustomSounds: () => CustomSounds,
  EmojiCustom: () => EmojiCustom,
  WebdavAccounts: () => WebdavAccounts
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 1);
let Base;
module.link("./models/_Base", {
  Base(v) {
    Base = v;
  }

}, 2);
let Avatars;
module.link("./models/Avatars", {
  default(v) {
    Avatars = v;
  }

}, 3);
let Uploads;
module.link("./models/Uploads", {
  default(v) {
    Uploads = v;
  }

}, 4);
let UserDataFiles;
module.link("./models/UserDataFiles", {
  default(v) {
    UserDataFiles = v;
  }

}, 5);
let Roles;
module.link("./models/Roles", {
  Roles(v) {
    Roles = v;
  }

}, 6);
let subscriptions;
module.link("./models/Subscriptions", {
  Subscriptions(v) {
    subscriptions = v;
  }

}, 7);
let users;
module.link("./models/Users", {
  Users(v) {
    users = v;
  }

}, 8);
let CachedChannelList;
module.link("./models/CachedChannelList", {
  CachedChannelList(v) {
    CachedChannelList = v;
  }

}, 9);
let CachedChatRoom;
module.link("./models/CachedChatRoom", {
  CachedChatRoom(v) {
    CachedChatRoom = v;
  }

}, 10);
let CachedChatSubscription;
module.link("./models/CachedChatSubscription", {
  CachedChatSubscription(v) {
    CachedChatSubscription = v;
  }

}, 11);
let CachedUserList;
module.link("./models/CachedUserList", {
  CachedUserList(v) {
    CachedUserList = v;
  }

}, 12);
let ChatRoom;
module.link("./models/ChatRoom", {
  ChatRoom(v) {
    ChatRoom = v;
  }

}, 13);
let ChatSubscription;
module.link("./models/ChatSubscription", {
  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 14);
let ChatMessage;
module.link("./models/ChatMessage", {
  ChatMessage(v) {
    ChatMessage = v;
  }

}, 15);
let RoomRoles;
module.link("./models/RoomRoles", {
  RoomRoles(v) {
    RoomRoles = v;
  }

}, 16);
let UserAndRoom;
module.link("./models/UserAndRoom", {
  UserAndRoom(v) {
    UserAndRoom = v;
  }

}, 17);
let UserRoles;
module.link("./models/UserRoles", {
  UserRoles(v) {
    UserRoles = v;
  }

}, 18);
let AuthzCachedCollection, ChatPermissions;
module.link("./models/ChatPermissions", {
  AuthzCachedCollection(v) {
    AuthzCachedCollection = v;
  },

  ChatPermissions(v) {
    ChatPermissions = v;
  }

}, 19);
let WebdavAccounts;
module.link("./models/WebdavAccounts", {
  WebdavAccounts(v) {
    WebdavAccounts = v;
  }

}, 20);
let CustomSounds;
module.link("./models/CustomSounds", {
  default(v) {
    CustomSounds = v;
  }

}, 21);
let EmojiCustom;
module.link("./models/EmojiCustom", {
  default(v) {
    EmojiCustom = v;
  }

}, 22);

const Users = _.extend({}, users, Meteor.users);

const Subscriptions = _.extend({}, subscriptions, ChatSubscription);

const Messages = _.extend({}, ChatMessage);

const Rooms = _.extend({}, ChatRoom);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/index.js                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"otr":{"client":{"stylesheets":{"otr.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/otr/client/stylesheets/otr.css                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/otr/client/index.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./stylesheets/otr.css");
module.link("./rocketchat.otr.room");
module.link("./rocketchat.otr");
module.link("./tabBar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.otr.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/otr/client/rocketchat.otr.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  OTR: () => OTR
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let Subscriptions;
module.link("../../models", {
  Subscriptions(v) {
    Subscriptions = v;
  }

}, 3);
let Notifications;
module.link("../../notifications", {
  Notifications(v) {
    Notifications = v;
  }

}, 4);
let t;
module.link("../../utils", {
  t(v) {
    t = v;
  }

}, 5);
let onClientMessageReceived;
module.link("../../../client/lib/onClientMessageReceived", {
  onClientMessageReceived(v) {
    onClientMessageReceived = v;
  }

}, 6);
let onClientBeforeSendMessage;
module.link("../../../client/lib/onClientBeforeSendMessage", {
  onClientBeforeSendMessage(v) {
    onClientBeforeSendMessage = v;
  }

}, 7);

class OTRClass {
  constructor() {
    this.enabled = new ReactiveVar(false);
    this.instancesByRoomId = {};
    this.crypto = null;
  }

  isEnabled() {
    return this.enabled.get();
  }

  getInstanceByRoomId(roomId) {
    if (!this.enabled.get()) {
      return;
    }

    if (this.instancesByRoomId[roomId]) {
      return this.instancesByRoomId[roomId];
    }

    const subscription = Subscriptions.findOne({
      rid: roomId
    });

    if (!subscription || subscription.t !== 'd') {
      return;
    }

    this.instancesByRoomId[roomId] = new OTR.Room(Meteor.userId(), roomId); // eslint-disable-line no-use-before-define

    return this.instancesByRoomId[roomId];
  }

}

const OTR = new OTRClass();
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (Meteor.userId()) {
      Notifications.onUser('otr', (type, data) => {
        if (!data.roomId || !data.userId || data.userId === Meteor.userId()) {
          return;
        }

        OTR.getInstanceByRoomId(data.roomId).onUserStream(type, data);
      });
    }
  });
  onClientBeforeSendMessage.use(function (message) {
    if (message.rid && OTR.getInstanceByRoomId(message.rid) && OTR.getInstanceByRoomId(message.rid).established.get()) {
      return OTR.getInstanceByRoomId(message.rid).encrypt(message).then(msg => {
        message.msg = msg;
        message.t = 'otr';
        return message;
      });
    }

    return Promise.resolve(message);
  });
  onClientMessageReceived.use(function (message) {
    if (message.rid && OTR.getInstanceByRoomId(message.rid) && OTR.getInstanceByRoomId(message.rid).established.get()) {
      if (message.notification) {
        message.msg = t('Encrypted_message');
        return Promise.resolve(message);
      }

      const otrRoom = OTR.getInstanceByRoomId(message.rid);
      return otrRoom.decrypt(message.msg).then(data => {
        const {
          _id,
          text,
          ack
        } = data;
        message._id = _id;
        message.msg = text;

        if (data.ts) {
          message.ts = data.ts;
        }

        if (message.otrAck) {
          return otrRoom.decrypt(message.otrAck).then(data => {
            if (ack === data.text) {
              message.t = 'otr-ack';
            }

            return message;
          });
        }

        if (data.userId !== Meteor.userId()) {
          return otrRoom.encryptText(ack).then(ack => {
            Meteor.call('updateOTRAck', message._id, ack);
            return message;
          });
        }

        return message;
      });
    }

    if (message.t === 'otr') {
      message.msg = '';
    }

    return Promise.resolve(message);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.otr.room.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/otr/client/rocketchat.otr.room.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 2);
let EJSON;
module.link("meteor/ejson", {
  EJSON(v) {
    EJSON = v;
  }

}, 3);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 4);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 5);
let TimeSync;
module.link("meteor/mizzao:timesync", {
  TimeSync(v) {
    TimeSync = v;
  }

}, 6);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 7);
let OTR;
module.link("./rocketchat.otr", {
  OTR(v) {
    OTR = v;
  }

}, 8);
let Notifications;
module.link("../../notifications", {
  Notifications(v) {
    Notifications = v;
  }

}, 9);
let getUidDirectMessage;
module.link("../../../client/lib/utils/getUidDirectMessage", {
  getUidDirectMessage(v) {
    getUidDirectMessage = v;
  }

}, 10);
let Presence;
module.link("../../../client/lib/presence", {
  Presence(v) {
    Presence = v;
  }

}, 11);
let goToRoomById;
module.link("../../../client/lib/utils/goToRoomById", {
  goToRoomById(v) {
    goToRoomById = v;
  }

}, 12);
let imperativeModal;
module.link("../../../client/lib/imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 13);
let GenericModal;
module.link("../../../client/components/GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 14);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 15);
OTR.Room = class {
  constructor(userId, roomId) {
    this.userId = userId;
    this.roomId = roomId;
    this.peerId = getUidDirectMessage(roomId);
    this.established = new ReactiveVar(false);
    this.establishing = new ReactiveVar(false);
    this.userOnlineComputation = null;
    this.keyPair = null;
    this.exportedPublicKey = null;
    this.sessionKey = null;
  }

  handshake(refresh) {
    this.establishing.set(true);
    this.firstPeer = true;
    this.generateKeyPair().then(() => {
      Notifications.notifyUser(this.peerId, 'otr', 'handshake', {
        roomId: this.roomId,
        userId: this.userId,
        publicKey: EJSON.stringify(this.exportedPublicKey),
        refresh
      });
    });
  }

  acknowledge() {
    Notifications.notifyUser(this.peerId, 'otr', 'acknowledge', {
      roomId: this.roomId,
      userId: this.userId,
      publicKey: EJSON.stringify(this.exportedPublicKey)
    });
  }

  deny() {
    this.reset();
    Notifications.notifyUser(this.peerId, 'otr', 'deny', {
      roomId: this.roomId,
      userId: this.userId
    });
  }

  end() {
    this.reset();
    Notifications.notifyUser(this.peerId, 'otr', 'end', {
      roomId: this.roomId,
      userId: this.userId
    });
  }

  reset() {
    this.establishing.set(false);
    this.established.set(false);
    this.keyPair = null;
    this.exportedPublicKey = null;
    this.sessionKey = null;
    Meteor.call('deleteOldOTRMessages', this.roomId);
  }

  generateKeyPair() {
    if (this.userOnlineComputation) {
      this.userOnlineComputation.stop();
    }

    this.userOnlineComputation = Tracker.autorun(() => {
      const $room = $("#chat-window-".concat(this.roomId));
      const $title = $('.rc-header__title', $room);

      if (this.established.get()) {
        if ($room.length && $title.length && !$('.otr-icon', $title).length) {
          $title.prepend("<i class='otr-icon icon-key'></i>");
        }
      } else if ($title.length) {
        $('.otr-icon', $title).remove();
      }
    }); // Generate an ephemeral key pair.

    return OTR.crypto.generateKey({
      name: 'ECDH',
      namedCurve: 'P-256'
    }, false, ['deriveKey', 'deriveBits']).then(keyPair => {
      this.keyPair = keyPair;
      return OTR.crypto.exportKey('jwk', keyPair.publicKey);
    }).then(exportedPublicKey => {
      this.exportedPublicKey = exportedPublicKey; // Once we have generated new keys, it's safe to delete old messages

      Meteor.call('deleteOldOTRMessages', this.roomId);
    }).catch(e => {
      dispatchToastMessage({
        type: 'error',
        message: e
      });
    });
  }

  importPublicKey(publicKey) {
    return OTR.crypto.importKey('jwk', EJSON.parse(publicKey), {
      name: 'ECDH',
      namedCurve: 'P-256'
    }, false, []).then(peerPublicKey => OTR.crypto.deriveBits({
      name: 'ECDH',
      namedCurve: 'P-256',
      public: peerPublicKey
    }, this.keyPair.privateKey, 256)).then(bits => OTR.crypto.digest({
      name: 'SHA-256'
    }, bits)).then(hashedBits => {
      // We truncate the hash to 128 bits.
      const sessionKeyData = new Uint8Array(hashedBits).slice(0, 16);
      return OTR.crypto.importKey('raw', sessionKeyData, {
        name: 'AES-GCM'
      }, false, ['encrypt', 'decrypt']);
    }).then(sessionKey => {
      // Session key available.
      this.sessionKey = sessionKey;
    });
  }

  encryptText(data) {
    if (!_.isObject(data)) {
      data = new TextEncoder('UTF-8').encode(EJSON.stringify({
        text: data,
        ack: Random.id((Random.fraction() + 1) * 20)
      }));
    }

    const iv = crypto.getRandomValues(new Uint8Array(12));
    return OTR.crypto.encrypt({
      name: 'AES-GCM',
      iv
    }, this.sessionKey, data).then(cipherText => {
      cipherText = new Uint8Array(cipherText);
      const output = new Uint8Array(iv.length + cipherText.length);
      output.set(iv, 0);
      output.set(cipherText, iv.length);
      return EJSON.stringify(output);
    }).catch(() => {
      throw new Meteor.Error('encryption-error', 'Encryption error.');
    });
  }

  encrypt(message) {
    let ts;

    if (isNaN(TimeSync.serverOffset())) {
      ts = new Date();
    } else {
      ts = new Date(Date.now() + TimeSync.serverOffset());
    }

    const data = new TextEncoder('UTF-8').encode(EJSON.stringify({
      _id: message._id,
      text: message.msg,
      userId: this.userId,
      ack: Random.id((Random.fraction() + 1) * 20),
      ts
    }));
    const enc = this.encryptText(data);
    return enc;
  }

  decrypt(message) {
    let cipherText = EJSON.parse(message);
    const iv = cipherText.slice(0, 12);
    cipherText = cipherText.slice(12);
    return OTR.crypto.decrypt({
      name: 'AES-GCM',
      iv
    }, this.sessionKey, cipherText).then(data => {
      data = EJSON.parse(new TextDecoder('UTF-8').decode(new Uint8Array(data)));
      return data;
    }).catch(e => {
      dispatchToastMessage({
        type: 'error',
        message: e
      });
      return message;
    });
  }

  onUserStream(type, data) {
    switch (type) {
      case 'handshake':
        let timeout = null;

        const establishConnection = () => {
          this.establishing.set(true);
          Meteor.clearTimeout(timeout);
          this.generateKeyPair().then(() => {
            this.importPublicKey(data.publicKey).then(() => {
              this.firstPeer = false;
              goToRoomById(data.roomId);
              Meteor.defer(() => {
                this.established.set(true);
                this.acknowledge();
              });
            });
          });
        };

        (async () => {
          const {
            username
          } = await Presence.get(data.userId);

          if (data.refresh && this.established.get()) {
            this.reset();
            establishConnection();
          } else {
            if (this.established.get()) {
              this.reset();
            }

            imperativeModal.open({
              component: GenericModal,
              props: {
                variant: 'warning',
                title: TAPi18n.__('OTR'),
                children: TAPi18n.__('Username_wants_to_start_otr_Do_you_want_to_accept', {
                  username
                }),
                confirmText: TAPi18n.__('Yes'),
                cancelText: TAPi18n.__('No'),
                onClose: () => imperativeModal.close,
                onCancel: () => {
                  Meteor.clearTimeout(timeout);
                  this.deny();
                  imperativeModal.close();
                },
                onConfirm: () => {
                  establishConnection();
                  imperativeModal.close();
                }
              }
            });
          }

          timeout = Meteor.setTimeout(() => {
            this.establishing.set(false);
            imperativeModal.close();
          }, 10000);
        })();

        break;

      case 'acknowledge':
        this.importPublicKey(data.publicKey).then(() => {
          this.established.set(true);
        });
        break;

      case 'deny':
        (async () => {
          const {
            username
          } = await Presence.get(this.peerId);

          if (this.establishing.get()) {
            this.reset();
            imperativeModal.open({
              component: GenericModal,
              props: {
                variant: 'warning',
                title: TAPi18n.__('OTR'),
                children: TAPi18n.__('Username_denied_the_OTR_session', {
                  username
                }),
                onClose: imperativeModal.close,
                onConfirm: imperativeModal.close
              }
            });
          }
        })();

        break;

      case 'end':
        (async () => {
          const {
            username
          } = await Presence.get(this.peerId);

          if (this.established.get()) {
            this.reset();
            imperativeModal.open({
              component: GenericModal,
              props: {
                variant: 'warning',
                title: TAPi18n.__('OTR'),
                children: TAPi18n.__('Username_ended_the_OTR_session', {
                  username
                }),
                confirmText: TAPi18n.__('Ok'),
                onClose: imperativeModal.close,
                onConfirm: imperativeModal.close
              }
            });
          }
        })();

        break;
    }
  }

};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/otr/client/tabBar.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo, lazy, useEffect;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  },

  lazy(v) {
    lazy = v;
  },

  useEffect(v) {
    useEffect = v;
  }

}, 0);
let OTR;
module.link("./rocketchat.otr", {
  OTR(v) {
    OTR = v;
  }

}, 1);
let useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 2);
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 3);
const template = /*#__PURE__*/lazy(() => module.dynamicImport('../../../client/views/room/contextualBar/OTR'));
addAction('otr', () => {
  const enabled = useSetting('OTR_Enable');
  const shouldAddAction = enabled && window.crypto;
  useEffect(() => {
    if (shouldAddAction) {
      OTR.crypto = window.crypto.subtle;
      OTR.enabled.set(true);
    } else {
      OTR.enabled.set(false);
    }
  }, [shouldAddAction]);
  return useMemo(() => shouldAddAction ? {
    groups: ['direct'],
    id: 'otr',
    title: 'OTR',
    icon: 'shredder',
    template,
    order: 13,
    full: true
  } : null, [shouldAddAction]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"reactions":{"client":{"methods":{"setReaction.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/reactions/client/methods/setReaction.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 1);
let Messages, Rooms, Subscriptions;
module.link("../../../models", {
  Messages(v) {
    Messages = v;
  },

  Rooms(v) {
    Rooms = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 2);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);
let emoji;
module.link("../../../emoji", {
  emoji(v) {
    emoji = v;
  }

}, 4);
let roomTypes;
module.link("../../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 5);
Meteor.methods({
  setReaction(reaction, messageId) {
    if (!Meteor.userId()) {
      throw new Meteor.Error(203, 'User_logged_out');
    }

    const user = Meteor.user();
    const message = Messages.findOne({
      _id: messageId
    });
    const room = Rooms.findOne({
      _id: message.rid
    });

    if (message.private) {
      return false;
    }

    if (!emoji.list[reaction]) {
      return false;
    }

    if (roomTypes.readOnly(room._id, user._id)) {
      return false;
    }

    if (!Subscriptions.findOne({
      rid: message.rid
    })) {
      return false;
    }

    if (message.reactions && message.reactions[reaction] && message.reactions[reaction].usernames.indexOf(user.username) !== -1) {
      message.reactions[reaction].usernames.splice(message.reactions[reaction].usernames.indexOf(user.username), 1);

      if (message.reactions[reaction].usernames.length === 0) {
        delete message.reactions[reaction];
      }

      if (_.isEmpty(message.reactions)) {
        delete message.reactions;
        Messages.unsetReactions(messageId);
        callbacks.run('unsetReaction', messageId, reaction);
      } else {
        Messages.setReactions(messageId, message.reactions);
        callbacks.run('setReaction', messageId, reaction);
      }
    } else {
      if (!message.reactions) {
        message.reactions = {};
      }

      if (!message.reactions[reaction]) {
        message.reactions[reaction] = {
          usernames: []
        };
      }

      message.reactions[reaction].usernames.push(user.username);
      Messages.setReactions(messageId, message.reactions);
      callbacks.run('setReaction', messageId, reaction);
    }
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"stylesheets":{"reaction.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/reactions/client/stylesheets/reaction.css                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/reactions/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./init");
module.link("./methods/setReaction");
module.link("./stylesheets/reaction.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"init.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/reactions/client/init.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  EmojiEvents: () => EmojiEvents
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 1);
let roomTypes;
module.link("../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 2);
let Rooms, Subscriptions;
module.link("../../models", {
  Rooms(v) {
    Rooms = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 3);
let MessageAction;
module.link("../../ui-utils", {
  MessageAction(v) {
    MessageAction = v;
  }

}, 4);
let messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 5);
let EmojiPicker;
module.link("../../emoji", {
  EmojiPicker(v) {
    EmojiPicker = v;
  }

}, 6);
let tooltip;
module.link("../../ui/client/components/tooltip", {
  tooltip(v) {
    tooltip = v;
  }

}, 7);
const EmojiEvents = {
  'click .add-reaction'(event) {
    event.preventDefault();
    event.stopPropagation();
    const data = Blaze.getData(event.currentTarget);
    const {
      msg: {
        rid,
        _id: mid,
        private: isPrivate
      }
    } = messageArgs(data);
    const user = Meteor.user();
    const room = Rooms.findOne({
      _id: rid
    });

    if (!room) {
      return false;
    }

    if (!Subscriptions.findOne({
      rid
    })) {
      return false;
    }

    if (isPrivate) {
      return false;
    }

    if (roomTypes.readOnly(room._id, user._id) && !room.reactWhenReadOnly) {
      return false;
    }

    EmojiPicker.open(event.currentTarget, emoji => {
      Meteor.call('setReaction', ":".concat(emoji, ":"), mid);
    });
  },

  'click .reactions > li:not(.add-reaction)'(event) {
    event.preventDefault();
    const data = Blaze.getData(event.currentTarget);
    const {
      msg: {
        _id: mid
      }
    } = messageArgs(data);
    Meteor.call('setReaction', $(event.currentTarget).attr('data-emoji'), mid, () => {
      tooltip.hide();
    });
  },

  'mouseenter .reactions > li:not(.add-reaction)'(event) {
    event.stopPropagation();
    tooltip.showElement($(event.currentTarget).find('.people').get(0), event.currentTarget);
  },

  'mouseleave .reactions > li:not(.add-reaction)'(event) {
    event.stopPropagation();
    tooltip.hide();
  }

};
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'reaction-message',
    icon: 'add-reaction',
    label: 'Add_Reaction',
    context: ['message', 'message-mobile', 'threads'],

    action(event) {
      event.stopPropagation();
      const {
        msg
      } = messageArgs(this);
      EmojiPicker.open(event.currentTarget, emoji => Meteor.call('setReaction', ":".concat(emoji, ":"), msg._id));
    },

    condition(_ref) {
      let {
        msg: message,
        u: user,
        room,
        subscription
      } = _ref;

      if (!room) {
        return false;
      }

      if (!subscription) {
        return false;
      }

      if (message.private) {
        return false;
      }

      if (roomTypes.readOnly(room._id, user._id) && !room.reactWhenReadOnly) {
        return false;
      }

      const isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return true;
    },

    order: -2,
    group: ['message', 'menu']
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-cached-collection":{"client":{"models":{"CachedCollection.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-cached-collection/client/models/CachedCollection.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["_id"],
      _excluded2 = ["_id"];

var _this2 = this;

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 0);
module.export({
  CachedCollectionManager: () => CachedCollectionManager,
  CachedCollection: () => CachedCollection
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let check;
module.link("meteor/check", {
  check(v) {
    check = v;
  }

}, 1);
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 2);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 3);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 4);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 5);
let localforage;
module.link("localforage", {
  default(v) {
    localforage = v;
  }

}, 6);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 7);
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 8);
let callbacks;
module.link("../../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 9);
let Notifications;
module.link("../../../notifications/client/lib/Notifications", {
  default(v) {
    Notifications = v;
  }

}, 10);
let getConfig;
module.link("../../../../client/lib/utils/getConfig", {
  getConfig(v) {
    getConfig = v;
  }

}, 11);
let call;
module.link("../../../../client/lib/utils/call", {
  call(v) {
    call = v;
  }

}, 12);

const wrap = fn => function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  return new Promise((resolve, reject) => {
    fn(...args, (err, result) => {
      if (err) {
        return reject(err);
      }

      return resolve(result);
    });
  });
};

const localforageGetItem = wrap(localforage.getItem);

class CachedCollectionManagerClass extends Emitter {
  constructor() {
    var _this;

    super();
    _this = this;
    this.items = [];
    this._syncEnabled = false;
    this.logged = false;
    const {
      _unstoreLoginToken
    } = Accounts;

    Accounts._unstoreLoginToken = function () {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }

      _unstoreLoginToken.apply(Accounts, args);

      _this.clearAllCacheOnLogout();
    }; // Wait 1s to start or the code will run before the connection and
    // on first connection the `reconnect` callbacks will run


    Tracker.autorun(() => {
      const [WAITING_FIRST_CONNECTION, WAITING_FIRST_DISCONNECTION, LISTENING_RECONNECTIONS] = [0, 1, 2];
      this.step = this.step || WAITING_FIRST_CONNECTION;
      const {
        connected
      } = Meteor.status();

      switch (this.step) {
        case WAITING_FIRST_CONNECTION:
          return !connected || this.step++;

        case WAITING_FIRST_DISCONNECTION:
          return connected || this.step++;

        case LISTENING_RECONNECTIONS:
          return connected && this.emit('reconnect');
      }
    });
    Tracker.autorun(() => {
      const uid = Meteor.userId();
      this.logged = uid !== null;

      if (this.logged) {
        this.emit('login', uid);
      }
    });
  }

  register(cachedCollection) {
    this.items.push(cachedCollection);
  }

  clearAllCache() {
    for (const item of this.items) {
      item.clearCache();
    }
  }

  clearAllCacheOnLogout() {
    for (const item of this.items) {
      item.clearCacheOnLogout();
    }
  }

  countQueries() {
    for (const item of this.items) {
      item.countQueries();
    }
  }

  set syncEnabled(value) {
    check(value, Boolean);
    this._syncEnabled = value;
  }

  get syncEnabled() {
    return this._syncEnabled;
  }

  onReconnect(cb) {
    this.on('reconnect', cb);
  }

  onLogin(cb) {
    this.on('login', cb);

    if (this.logged) {
      cb();
    }
  }

}

const CachedCollectionManager = new CachedCollectionManagerClass();

const debug = name => [getConfig("debugCachedCollection-".concat(name)), getConfig('debugCachedCollection'), getConfig('debug')].includes('true');

const nullLog = function () {};

const log = function () {
  for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
    args[_key3] = arguments[_key3];
  }

  return console.log("CachedCollection ".concat(_this2.name, " =>"), ...args);
};

class CachedCollection extends Emitter {
  constructor(_ref) {
    let {
      collection = new Mongo.Collection(null),
      name,
      methodName = "".concat(name, "/get"),
      syncMethodName = "".concat(name, "/get"),
      eventName = "".concat(name, "-changed"),
      eventType = 'onUser',
      userRelated = true,
      listenChangesForLoggedUsersOnly = false,
      useSync = true,
      version = 16,
      maxCacheTime = 60 * 60 * 24 * 30,
      onSyncData = () => {}
    } = _ref;
    super();
    this.save = _.debounce(() => {
      this.log('saving cache');
      const data = this.collection.find().fetch();
      localforage.setItem(this.name, {
        updatedAt: this.updatedAt,
        version: this.version,
        token: this.getToken(),
        records: data
      });
      this.log('saving cache (done)');
    }, 1000);
    this.collection = collection;
    this.ready = new ReactiveVar(false);
    this.name = name;
    this.methodName = methodName;
    this.syncMethodName = syncMethodName;
    this.eventName = eventName;
    this.eventType = eventType;
    this.useSync = useSync;
    this.listenChangesForLoggedUsersOnly = listenChangesForLoggedUsersOnly;
    this.version = version;
    this.userRelated = userRelated;
    this.updatedAt = new Date(0);
    this.maxCacheTime = maxCacheTime;
    this.onSyncData = onSyncData;
    this.log = debug(name) ? log : nullLog;
    CachedCollectionManager.register(this);

    if (!userRelated) {
      this.init();
      return;
    }

    CachedCollectionManager.onLogin(() => {
      this.init();
    });
  }

  countQueries() {
    this.log("".concat(Object.keys(this.collection._collection.queries).length, " queries"));
  }

  getToken() {
    if (this.userRelated === false) {
      return undefined;
    }

    return Accounts._storedLoginToken();
  }

  async loadFromCache() {
    const data = await localforageGetItem(this.name);

    if (!data) {
      return false;
    }

    if (data.version < this.version || data.token !== this.getToken()) {
      return false;
    }

    if (data.records.length <= 0) {
      return false;
    }

    if (new Date() - data.updatedAt >= 1000 * this.maxCacheTime) {
      return false;
    }

    this.log("".concat(data.records.length, " records loaded from cache"));
    data.records.forEach(record => {
      callbacks.run("cachedCollection-loadFromCache-".concat(this.name), record); // this.collection.direct.insert(record);

      if (!record._updatedAt) {
        return;
      }

      const _updatedAt = new Date(record._updatedAt);

      record._updatedAt = _updatedAt;

      if (record.lastMessage && typeof record.lastMessage._updatedAt === 'string') {
        record.lastMessage._updatedAt = new Date(record.lastMessage._updatedAt);
      }

      if (_updatedAt > this.updatedAt) {
        this.updatedAt = _updatedAt;
      }
    });
    this.collection._collection._docs._map = new Map(data.records.map(record => [record._id, record]));
    this.updatedAt = data.updatedAt || this.updatedAt;
    Object.values(this.collection._collection.queries).forEach(query => this.collection._collection._recomputeResults(query));
    return true;
  }

  async loadFromServer() {
    const startTime = new Date();
    const lastTime = this.updatedAt;
    const data = await call(this.methodName);
    this.log("".concat(data.length, " records loaded from server"));
    data.forEach(record => {
      callbacks.run("cachedCollection-loadFromServer-".concat(this.name), record, 'changed');
      this.collection.direct.upsert({
        _id: record._id
      }, _.omit(record, '_id'));
      this.onSyncData('changed', record);

      if (record._updatedAt && record._updatedAt > this.updatedAt) {
        this.updatedAt = record._updatedAt;
      }
    });
    this.updatedAt = this.updatedAt === lastTime ? startTime : this.updatedAt;
  }

  async loadFromServerAndPopulate() {
    await this.loadFromServer();
    this.save();
  }

  clearCacheOnLogout() {
    if (this.userRelated === true) {
      this.clearCache();
    }
  }

  clearCache() {
    this.log('clearing cache');
    localforage.removeItem(this.name);
    this.collection.remove({});
  }

  removeRoomFromCacheWhenUserLeaves(roomId, ChatRoom, CachedChatRoom) {
    ChatRoom.remove(roomId);
    CachedChatRoom.save();
  }

  async setupListener(eventType, eventName) {
    const {
      RoomManager
    } = await module.dynamicImport('../../../ui-utils');
    const {
      ChatRoom,
      CachedChatRoom
    } = await module.dynamicImport('../../../models');
    Notifications[eventType || this.eventType](eventName || this.eventName, (t, record) => {
      this.log('record received', t, record);
      callbacks.run("cachedCollection-received-".concat(this.name), record, t);

      if (t === 'removed') {
        let room;

        if (this.eventName === 'subscriptions-changed') {
          room = ChatRoom.findOne(record.rid);

          if (room) {
            this.removeRoomFromCacheWhenUserLeaves(room._id, ChatRoom, CachedChatRoom);
          }
        } else {
          room = this.collection.findOne({
            _id: record._id
          });
        }

        if (room) {
          room.name && RoomManager.close(room.t + room.name);
          !room.name && RoomManager.close(room.t + room._id);
        }

        this.collection.remove(record._id);
      } else {
        const {
          _id
        } = record,
              recordData = _objectWithoutProperties(record, _excluded);

        this.collection.direct.upsert({
          _id
        }, recordData);
      }

      this.save();
    });
  }

  trySync() {
    let delay = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;
    clearTimeout(this.tm); // Wait for an empty queue to load data again and sync

    this.tm = setTimeout(async () => {
      if (!(await this.sync())) {
        return this.trySync(delay);
      }

      this.save();
    }, delay);
  }

  async sync() {
    if (!this.updatedAt || this.updatedAt.valueOf() === 0 || Meteor.connection._outstandingMethodBlocks.length !== 0) {
      return false;
    }

    const startTime = new Date();
    const lastTime = this.updatedAt;
    this.log("syncing from ".concat(this.updatedAt));
    const data = await call(this.syncMethodName, this.updatedAt);
    let changes = [];

    if (data.update && data.update.length > 0) {
      this.log("".concat(data.update.length, " records updated in sync"));
      changes.push(...data.update);
    }

    if (data.remove && data.remove.length > 0) {
      this.log("".concat(data.remove.length, " records removed in sync"));
      changes.push(...data.remove);
    }

    changes = changes.sort((a, b) => {
      const valueA = a._updatedAt || a._deletedAt;
      const valueB = b._updatedAt || b._deletedAt;

      if (valueA < valueB) {
        return -1;
      }

      if (valueA > valueB) {
        return 1;
      }

      return 0;
    });

    for (const record of changes) {
      const action = record._deletedAt ? 'removed' : 'changed';
      callbacks.run("cachedCollection-sync-".concat(this.name), record, action);
      const actionTime = record._deletedAt || record._updatedAt;

      const {
        _id
      } = record,
            recordData = _objectWithoutProperties(record, _excluded2);

      if (record._deletedAt) {
        this.collection.direct.remove({
          _id
        });
      } else {
        this.collection.direct.upsert({
          _id
        }, recordData);
      }

      if (actionTime > this.updatedAt) {
        this.updatedAt = actionTime;
      }

      this.onSyncData(action, record);
    }

    this.updatedAt = this.updatedAt === lastTime ? startTime : this.updatedAt;
    return true;
  }

  async init() {
    this.ready.set(false);

    if (await this.loadFromCache()) {
      this.trySync();
    } else {
      await this.loadFromServerAndPopulate();
    }

    this.ready.set(true);
    CachedCollectionManager.onReconnect(() => {
      this.trySync();
    });

    if (!this.userRelated) {
      return this.setupListener();
    }

    CachedCollectionManager.onLogin(async () => {
      this.setupListener();
    });
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-cached-collection/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./models/CachedCollection", {
  CachedCollection: "CachedCollection",
  CachedCollectionManager: "CachedCollectionManager"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-cached-collection/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client/index", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"2fa":{"client":{"TOTPCrowd.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPCrowd.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
module.link("../../crowd/client/index");
let reportError;
module.link("../../../client/lib/2fa/utils", {
  reportError(v) {
    reportError = v;
  }

}, 2);
let overrideLoginMethod;
module.link("../../../client/lib/2fa/overrideLoginMethod", {
  overrideLoginMethod(v) {
    overrideLoginMethod = v;
  }

}, 3);

Meteor.loginWithCrowdAndTOTP = function (username, password, code, callback) {
  const loginRequest = {
    crowd: true,
    username,
    crowdPassword: password
  };
  Accounts.callLoginMethod({
    methodArguments: [{
      totp: {
        login: loginRequest,
        code
      }
    }],

    userCallback(error) {
      if (error) {
        reportError(error, callback);
      } else {
        callback && callback();
      }
    }

  });
};

const {
  loginWithCrowd
} = Meteor;

Meteor.loginWithCrowd = function (username, password, callback) {
  overrideLoginMethod(loginWithCrowd, [username, password], callback, Meteor.loginWithCrowdAndTOTP);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TOTPGoogle.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPGoogle.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
let Google;
module.link("meteor/google-oauth", {
  Google(v) {
    Google = v;
  }

}, 2);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 3);
let overrideLoginMethod;
module.link("../../../client/lib/2fa/overrideLoginMethod", {
  overrideLoginMethod(v) {
    overrideLoginMethod = v;
  }

}, 4);

const loginWithGoogleAndTOTP = function (options, code, callback) {
  // support a callback without options
  if (!callback && typeof options === 'function') {
    callback = options;
    options = null;
  }

  if (Meteor.isCordova && Google.signIn) {
    // After 20 April 2017, Google OAuth login will no longer work from
    // a WebView, so Cordova apps must use Google Sign-In instead.
    // https://github.com/meteor/meteor/issues/8253
    Google.signIn(options, callback);
    return;
  } // Use Google's domain-specific login page if we want to restrict creation to
  // a particular email domain. (Don't use it if restrictCreationByEmailDomain
  // is a function.) Note that all this does is change Google's UI ---
  // accounts-base/accounts_server.js still checks server-side that the server
  // has the proper email address after the OAuth conversation.


  if (typeof Accounts._options.restrictCreationByEmailDomain === 'string') {
    options = _.extend({}, options || {});
    options.loginUrlParameters = _.extend({}, options.loginUrlParameters || {});
    options.loginUrlParameters.hd = Accounts._options.restrictCreationByEmailDomain;
  }

  const credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(callback, code);
  Google.requestCredential(options, credentialRequestCompleteCallback);
};

const {
  loginWithGoogle
} = Meteor;

Meteor.loginWithGoogle = function (options, cb) {
  overrideLoginMethod(loginWithGoogle, [options], cb, loginWithGoogleAndTOTP);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TOTPLDAP.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPLDAP.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
module.link("../../../client/startup/ldap");
let reportError;
module.link("../../../client/lib/2fa/utils", {
  reportError(v) {
    reportError = v;
  }

}, 2);
let overrideLoginMethod;
module.link("../../../client/lib/2fa/overrideLoginMethod", {
  overrideLoginMethod(v) {
    overrideLoginMethod = v;
  }

}, 3);

Meteor.loginWithLDAPAndTOTP = function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  // Pull username and password
  const username = args.shift();
  const ldapPass = args.shift(); // Check if last argument is a function. if it is, pop it off and set callback to it

  const callback = typeof args[args.length - 1] === 'function' ? args.pop() : null; // The last argument before the callback is the totp code

  const code = args.pop(); // if args still holds options item, grab it

  const ldapOptions = args.length > 0 ? args.shift() : {}; // Set up loginRequest object

  const loginRequest = {
    ldap: true,
    username,
    ldapPass,
    ldapOptions
  };
  Accounts.callLoginMethod({
    methodArguments: [{
      totp: {
        login: loginRequest,
        code
      }
    }],

    userCallback(error) {
      if (error) {
        reportError(error, callback);
      } else {
        callback && callback();
      }
    }

  });
};

const {
  loginWithLDAP
} = Meteor;

Meteor.loginWithLDAP = function () {
  for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
    args[_key2] = arguments[_key2];
  }

  const callback = typeof args[args.length - 1] === 'function' ? args.pop() : null;
  overrideLoginMethod(loginWithLDAP, args, callback, Meteor.loginWithLDAPAndTOTP, args[0]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TOTPOAuth.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPOAuth.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let capitalize;
module.link("@rocket.chat/string-helpers", {
  capitalize(v) {
    capitalize = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 2);
let Facebook;
module.link("meteor/facebook-oauth", {
  Facebook(v) {
    Facebook = v;
  }

}, 3);
let Github;
module.link("meteor/github-oauth", {
  Github(v) {
    Github = v;
  }

}, 4);
let Twitter;
module.link("meteor/twitter-oauth", {
  Twitter(v) {
    Twitter = v;
  }

}, 5);
let MeteorDeveloperAccounts;
module.link("meteor/meteor-developer-oauth", {
  MeteorDeveloperAccounts(v) {
    MeteorDeveloperAccounts = v;
  }

}, 6);
let Linkedin;
module.link("meteor/pauli:linkedin-oauth", {
  Linkedin(v) {
    Linkedin = v;
  }

}, 7);
let OAuth;
module.link("meteor/oauth", {
  OAuth(v) {
    OAuth = v;
  }

}, 8);
let process2faReturn;
module.link("../../../client/lib/2fa/process2faReturn", {
  process2faReturn(v) {
    process2faReturn = v;
  }

}, 9);
let CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth(v) {
    CustomOAuth = v;
  }

}, 10);
let convertError;
module.link("../../../client/lib/2fa/utils", {
  convertError(v) {
    convertError = v;
  }

}, 11);
let overrideLoginMethod;
module.link("../../../client/lib/2fa/overrideLoginMethod", {
  overrideLoginMethod(v) {
    overrideLoginMethod = v;
  }

}, 12);
let lastCredentialToken = null;
let lastCredentialSecret = null;

Accounts.oauth.tryLoginAfterPopupClosed = function (credentialToken, callback, totpCode) {
  let credentialSecret = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
  credentialSecret = credentialSecret || OAuth._retrieveCredentialSecret(credentialToken) || null;
  const methodArgument = {
    oauth: {
      credentialToken,
      credentialSecret
    }
  };
  lastCredentialToken = credentialToken;
  lastCredentialSecret = credentialSecret;

  if (totpCode && typeof totpCode === 'string') {
    methodArgument.totp = {
      code: totpCode
    };
  }

  Accounts.callLoginMethod({
    methodArguments: [methodArgument],
    userCallback: callback && function (err) {
      callback(convertError(err));
    }
  });
};

Accounts.oauth.credentialRequestCompleteHandler = function (callback, totpCode) {
  return function (credentialTokenOrError) {
    if (credentialTokenOrError && credentialTokenOrError instanceof Error) {
      callback && callback(credentialTokenOrError);
    } else {
      Accounts.oauth.tryLoginAfterPopupClosed(credentialTokenOrError, callback, totpCode);
    }
  };
};

const createOAuthTotpLoginMethod = credentialProvider => (options, code, callback) => {
  // support a callback without options
  if (!callback && typeof options === 'function') {
    callback = options;
    options = null;
  }

  if (lastCredentialToken && lastCredentialSecret) {
    Accounts.oauth.tryLoginAfterPopupClosed(lastCredentialToken, callback, code, lastCredentialSecret);
  } else {
    const provider = credentialProvider && credentialProvider() || this;
    const credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(callback, code);
    provider.requestCredential(options, credentialRequestCompleteCallback);
  }

  lastCredentialToken = null;
  lastCredentialSecret = null;
};

const loginWithOAuthTokenAndTOTP = createOAuthTotpLoginMethod();
const loginWithFacebookAndTOTP = createOAuthTotpLoginMethod(() => Facebook);
const {
  loginWithFacebook
} = Meteor;

Meteor.loginWithFacebook = function (options, cb) {
  overrideLoginMethod(loginWithFacebook, [options], cb, loginWithFacebookAndTOTP);
};

const loginWithGithubAndTOTP = createOAuthTotpLoginMethod(() => Github);
const {
  loginWithGithub
} = Meteor;

Meteor.loginWithGithub = function (options, cb) {
  overrideLoginMethod(loginWithGithub, [options], cb, loginWithGithubAndTOTP);
};

const loginWithMeteorDeveloperAccountAndTOTP = createOAuthTotpLoginMethod(() => MeteorDeveloperAccounts);
const {
  loginWithMeteorDeveloperAccount
} = Meteor;

Meteor.loginWithMeteorDeveloperAccount = function (options, cb) {
  overrideLoginMethod(loginWithMeteorDeveloperAccount, [options], cb, loginWithMeteorDeveloperAccountAndTOTP);
};

const loginWithTwitterAndTOTP = createOAuthTotpLoginMethod(() => Twitter);
const {
  loginWithTwitter
} = Meteor;

Meteor.loginWithTwitter = function (options, cb) {
  overrideLoginMethod(loginWithTwitter, [options], cb, loginWithTwitterAndTOTP);
};

const loginWithLinkedinAndTOTP = createOAuthTotpLoginMethod(() => Linkedin);
const {
  loginWithLinkedin
} = Meteor;

Meteor.loginWithLinkedin = function (options, cb) {
  overrideLoginMethod(loginWithLinkedin, [options], cb, loginWithLinkedinAndTOTP);
};

Accounts.onPageLoadLogin(loginAttempt => {
  var _loginAttempt$error;

  if ((loginAttempt === null || loginAttempt === void 0 ? void 0 : (_loginAttempt$error = loginAttempt.error) === null || _loginAttempt$error === void 0 ? void 0 : _loginAttempt$error.error) !== 'totp-required') {
    return;
  }

  const {
    methodArguments
  } = loginAttempt;

  if (!(methodArguments !== null && methodArguments !== void 0 && methodArguments.length)) {
    return;
  }

  const oAuthArgs = methodArguments.find(arg => arg.oauth);
  const {
    credentialToken,
    credentialSecret
  } = oAuthArgs.oauth;
  const cb = loginAttempt.userCallback;
  process2faReturn({
    error: loginAttempt.error,
    originalCallback: cb,
    onCode: code => {
      Accounts.oauth.tryLoginAfterPopupClosed(credentialToken, cb, code, credentialSecret);
    }
  });
});
const oldConfigureLogin = CustomOAuth.prototype.configureLogin;

CustomOAuth.prototype.configureLogin = function () {
  const loginWithService = "loginWith".concat(capitalize(String(this.name || '')));

  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  oldConfigureLogin.apply(this, args);
  const oldMethod = Meteor[loginWithService];

  Meteor[loginWithService] = function (options, cb) {
    overrideLoginMethod(oldMethod, [options], cb, loginWithOAuthTokenAndTOTP);
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TOTPPassword.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPPassword.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
let t;
module.link("../../utils", {
  t(v) {
    t = v;
  }

}, 2);
let process2faReturn;
module.link("../../../client/lib/2fa/process2faReturn", {
  process2faReturn(v) {
    process2faReturn = v;
  }

}, 3);
let isTotpInvalidError, reportError;
module.link("../../../client/lib/2fa/utils", {
  isTotpInvalidError(v) {
    isTotpInvalidError = v;
  },

  reportError(v) {
    reportError = v;
  }

}, 4);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 5);

Meteor.loginWithPasswordAndTOTP = function (selector, password, code, callback) {
  if (typeof selector === 'string') {
    if (selector.indexOf('@') === -1) {
      selector = {
        username: selector
      };
    } else {
      selector = {
        email: selector
      };
    }
  }

  Accounts.callLoginMethod({
    methodArguments: [{
      totp: {
        login: {
          user: selector,
          password: Accounts._hashPassword(password)
        },
        code
      }
    }],

    userCallback(error) {
      if (error) {
        reportError(error, callback);
      } else {
        callback && callback();
      }
    }

  });
};

const {
  loginWithPassword
} = Meteor;

Meteor.loginWithPassword = function (email, password, cb) {
  loginWithPassword(email, password, error => {
    process2faReturn({
      error,
      originalCallback: cb,
      emailOrUsername: email,
      onCode: code => {
        Meteor.loginWithPasswordAndTOTP(email, password, code, error => {
          if (isTotpInvalidError(error)) {
            dispatchToastMessage({
              type: 'error',
              message: t('Invalid_two_factor_code')
            });
            cb();
            return;
          }

          cb(error);
        });
      }
    });
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TOTPSaml.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPSaml.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
module.link("../../meteor-accounts-saml/client/saml_client");
let reportError;
module.link("../../../client/lib/2fa/utils", {
  reportError(v) {
    reportError = v;
  }

}, 2);
let overrideLoginMethod;
module.link("../../../client/lib/2fa/overrideLoginMethod", {
  overrideLoginMethod(v) {
    overrideLoginMethod = v;
  }

}, 3);

Meteor.loginWithSamlTokenAndTOTP = function (credentialToken, code, callback) {
  Accounts.callLoginMethod({
    methodArguments: [{
      totp: {
        login: {
          saml: true,
          credentialToken
        },
        code
      }
    }],

    userCallback(error) {
      if (error) {
        reportError(error, callback);
      } else {
        callback && callback();
      }
    }

  });
};

const {
  loginWithSamlToken
} = Meteor;

Meteor.loginWithSamlToken = function (options, callback) {
  overrideLoginMethod(loginWithSamlToken, [options], callback, Meteor.loginWithSamlTokenAndTOTP);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/index.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./TOTPPassword");
module.link("./TOTPOAuth");
module.link("./TOTPGoogle");
module.link("./TOTPSaml");
module.link("./TOTPLDAP");
module.link("./TOTPCrowd");
module.link("./overrideMeteorCall");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"overrideMeteorCall.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/overrideMeteorCall.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let t;
module.link("../../utils/client", {
  t(v) {
    t = v;
  }

}, 1);
let process2faReturn;
module.link("../../../client/lib/2fa/process2faReturn", {
  process2faReturn(v) {
    process2faReturn = v;
  }

}, 2);
let isTotpInvalidError;
module.link("../../../client/lib/2fa/utils", {
  isTotpInvalidError(v) {
    isTotpInvalidError = v;
  }

}, 3);
let dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 4);
const {
  call
} = Meteor;

const callWithTotp = (methodName, args, callback) => (twoFactorCode, twoFactorMethod) => call(methodName, ...args, {
  twoFactorCode,
  twoFactorMethod
}, (error, result) => {
  if (isTotpInvalidError(error)) {
    error.toastrShowed = true;
    dispatchToastMessage({
      type: 'error',
      message: t('Invalid_two_factor_code')
    });
    callback(error);
    return;
  }

  callback(error, result);
});

const callWithoutTotp = (methodName, args, callback) => () => call(methodName, ...args, (error, result) => {
  process2faReturn({
    error,
    result,
    onCode: callWithTotp(methodName, args, callback),
    originalCallback: callback,
    emailOrUsername: undefined
  });
});

Meteor.call = function (methodName) {
  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }

  const callback = args.length > 0 && typeof args[args.length - 1] === 'function' ? args.pop() : () => undefined;
  return callWithoutTotp(methodName, args, callback)();
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"analytics":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/analytics/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./loadScript");
module.link("./trackEvents");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"loadScript.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/analytics/client/loadScript.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 2);
Template.body.onRendered(function () {
  this.autorun(c => {
    const piwikUrl = settings.get('PiwikAnalytics_enabled') && settings.get('PiwikAnalytics_url');
    const piwikSiteId = piwikUrl && settings.get('PiwikAnalytics_siteId');
    const piwikPrependDomain = piwikUrl && settings.get('PiwikAnalytics_prependDomain');
    const piwikCookieDomain = piwikUrl && settings.get('PiwikAnalytics_cookieDomain');
    const piwikDomains = piwikUrl && settings.get('PiwikAnalytics_domains');
    const piwikAdditionalTracker = piwikUrl && settings.get('PiwikAdditionalTrackers');
    const googleId = settings.get('GoogleAnalytics_enabled') && settings.get('GoogleAnalytics_ID');

    if (piwikSiteId || googleId) {
      c.stop();

      if (piwikSiteId) {
        window._paq = window._paq || [];

        if (Meteor.userId()) {
          window._paq.push(['setUserId', Meteor.userId()]);
        }

        window._paq.push(['trackPageView']);

        window._paq.push(['enableLinkTracking']);

        if (piwikPrependDomain) {
          window._paq.push(['setDocumentTitle', "".concat(window.location.hostname, "/").concat(document.title)]);
        }

        const upperLevelDomain = "*.".concat(window.location.hostname.split('.').slice(1).join('.'));

        if (piwikCookieDomain) {
          window._paq.push(['setCookieDomain', upperLevelDomain]);
        }

        if (piwikDomains) {
          // array
          const domainsArray = piwikDomains.split(/\n/);
          const domains = [];

          for (let i = 0; i < domainsArray.length; i++) {
            // only push domain if it contains a non whitespace character.
            if (/\S/.test(domainsArray[i])) {
              domains.push("*.".concat(domainsArray[i].trim()));
            }
          }

          window._paq.push(['setDomains', domains]);
        }

        (() => {
          try {
            if (/\S/.test(piwikAdditionalTracker)) {
              // piwikAdditionalTracker is not empty or whitespace only
              const addTrackers = JSON.parse(piwikAdditionalTracker);

              for (let i = 0; i < addTrackers.length; i++) {
                const tracker = addTrackers[i];

                window._paq.push(['addTracker', "".concat(tracker.trackerURL, "js/"), tracker.siteId]);
              }
            }
          } catch (e) {
            // parsing JSON faild
            console.log('Error while parsing JSON value of "piwikAdditionalTracker": ', e);
          }

          window._paq.push(['setTrackerUrl', "".concat(piwikUrl, "js/")]);

          window._paq.push(['setSiteId', Number.parseInt(piwikSiteId)]);

          const d = document;
          const g = d.createElement('script');
          const s = d.getElementsByTagName('script')[0];
          g.type = 'text/javascript';
          g.async = true;
          g.defer = true;
          g.src = "".concat(piwikUrl, "js/");
          s.parentNode.insertBefore(g, s);
        })();
      }

      if (googleId) {
        /*eslint-disable */
        (function (i, s, o, g, r, a, m) {
          i['GoogleAnalyticsObject'] = r;
          i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments);
          }, i[r].l = 1 * new Date();
          a = s.createElement(o), m = s.getElementsByTagName(o)[0];
          a.async = 1;
          a.src = g;
          m.parentNode.insertBefore(a, m);
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', googleId, 'auto');
        ga('send', 'pageview');
        /* eslint-enable */
      }
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"trackEvents.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/analytics/client/trackEvents.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 4);
let ChatRoom;
module.link("../../models", {
  ChatRoom(v) {
    ChatRoom = v;
  }

}, 5);

function trackEvent(category, action, label) {
  if (window._paq) {
    window._paq.push(['trackEvent', category, action, label]);
  }

  if (window.ga) {
    window.ga('send', 'event', category, action, label);
  }
}

if (!window._paq || window.ga) {
  // Trigger the trackPageView manually as the page views are only loaded when the loadScript.js code is executed
  FlowRouter.triggers.enter([route => {
    if (window._paq) {
      const http = location.protocol;
      const slashes = http.concat('//');
      const host = slashes.concat(window.location.hostname);

      window._paq.push(['setCustomUrl', host + route.path]);

      window._paq.push(['trackPageView']);
    }

    if (window.ga) {
      window.ga('send', 'pageview', route.path);
    }
  }]); // Login page has manual switches

  callbacks.add('loginPageStateChange', state => {
    trackEvent('Navigation', 'Login Page State Change', state);
  }, callbacks.priority.MEDIUM, 'analytics-login-state-change'); // Messsages

  callbacks.add('afterSaveMessage', message => {
    if ((window._paq || window.ga) && settings.get('Analytics_features_messages')) {
      const room = ChatRoom.findOne({
        _id: message.rid
      });
      trackEvent('Message', 'Send', "".concat(room.name, " (").concat(room._id, ")"));
    }
  }, 2000, 'trackEvents'); // Rooms

  callbacks.add('afterCreateChannel', (owner, room) => {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Create', "".concat(room.name, " (").concat(room._id, ")"));
    }
  }, callbacks.priority.MEDIUM, 'analytics-after-create-channel');
  callbacks.add('roomNameChanged', room => {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Changed Name', "".concat(room.name, " (").concat(room._id, ")"));
    }
  }, callbacks.priority.MEDIUM, 'analytics-room-name-changed');
  callbacks.add('roomTopicChanged', room => {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Changed Topic', "".concat(room.name, " (").concat(room._id, ")"));
    }
  }, callbacks.priority.MEDIUM, 'analytics-room-topic-changed');
  callbacks.add('roomAnnouncementChanged', room => {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Changed Announcement', "".concat(room.name, " (").concat(room._id, ")"));
    }
  }, callbacks.priority.MEDIUM, 'analytics-room-announcement-changed');
  callbacks.add('roomTypeChanged', room => {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Changed Room Type', "".concat(room.name, " (").concat(room._id, ")"));
    }
  }, callbacks.priority.MEDIUM, 'analytics-room-type-changed');
  callbacks.add('archiveRoom', room => {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Archived', "".concat(room.name, " (").concat(room._id, ")"));
    }
  }, callbacks.priority.MEDIUM, 'analytics-archive-room');
  callbacks.add('unarchiveRoom', room => {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Unarchived', "".concat(room.name, " (").concat(room._id, ")"));
    }
  }, callbacks.priority.MEDIUM, 'analytics-unarchive-room'); // Users
  // Track logins and associate user ids with piwik

  (() => {
    let oldUserId = null;
    Tracker.autorun(() => {
      const newUserId = Meteor.userId();

      if (oldUserId === null && newUserId) {
        if (window._paq && settings.get('Analytics_features_users')) {
          trackEvent('User', 'Login', newUserId);

          window._paq.push(['setUserId', newUserId]);
        }
      } else if (newUserId === null && oldUserId) {
        if (window._paq && settings.get('Analytics_features_users')) {
          trackEvent('User', 'Logout', oldUserId);
        }
      }

      oldUserId = Meteor.userId();
    });
  })();

  callbacks.add('userRegistered', () => {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Registered');
    }
  }, callbacks.priority.MEDIUM, 'piwik-user-resitered');
  callbacks.add('usernameSet', () => {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Username Set');
    }
  }, callbacks.priority.MEDIUM, 'piweik-username-set');
  callbacks.add('userPasswordReset', () => {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Reset Password');
    }
  }, callbacks.priority.MEDIUM, 'piwik-user-password-reset');
  callbacks.add('userConfirmationEmailRequested', () => {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Confirmation Email Requested');
    }
  }, callbacks.priority.MEDIUM, 'piwik-user-confirmation-email-requested');
  callbacks.add('userForgotPasswordEmailRequested', () => {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Forgot Password Email Requested');
    }
  }, callbacks.priority.MEDIUM, 'piwik-user-forgot-password-email-requested');
  callbacks.add('userStatusManuallySet', status => {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Status Manually Changed', status);
    }
  }, callbacks.priority.MEDIUM, 'analytics-user-status-manually-set');
  callbacks.add('userAvatarSet', service => {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Avatar Changed', service);
    }
  }, callbacks.priority.MEDIUM, 'analytics-user-avatar-set');
  callbacks.add('roomAvatarChanged', room => {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Changed Avatar', "".concat(room.name, " (").concat(room._id, ")"));
    }
  }, callbacks.priority.MEDIUM, 'analytics-room-avatar-changed');
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"autolinker":{"client":{"client.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "meteor/meteor",
  "meteor/random",
  "autolinker",
  "@rocket.chat/string-helpers"
],"index.js":[
  "./client"
]}},"blockstack":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/blockstack/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration(v) {
    ServiceConfiguration = v;
  }

}, 1);
let check, Match;
module.link("meteor/check", {
  check(v) {
    check = v;
  },

  Match(v) {
    Match = v;
  }

}, 2);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 3);
module.link("./routes");

const handleError = error => error && Session.set('errorMessage', error.reason || 'Unknown error'); // TODO: allow serviceConfig.loginStyle == popup


Meteor.loginWithBlockstack = function (options) {
  let callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : handleError;

  if (!options || !options.redirectURI) {
    options = ServiceConfiguration.configurations.findOne({
      service: 'blockstack'
    });
    options.blockstackIDHost = Meteor.Device.isDesktop() ? 'http://localhost:8888/auth' : 'https://blockstack.org/auth';
    options.scopes = ['store_write'];
  }

  try {
    check(options, Match.ObjectIncluding({
      blockstackIDHost: String,
      redirectURI: String,
      manifestURI: String
    }));
    module.dynamicImport('blockstack/dist/blockstack').then(_ref => {
      let {
        redirectToSignIn
      } = _ref;
      return redirectToSignIn(options.redirectURI, options.manifestURI, options.scopes);
    });
  } catch (err) {
    callback.call(Meteor, err);
  }
};

const meteorLogout = Meteor.logout;

Meteor.logout = function () {
  const serviceConfig = ServiceConfiguration.configurations.findOne({
    service: 'blockstack'
  });
  const blockstackAuth = Session.get('blockstack_auth');

  if (serviceConfig && blockstackAuth) {
    Session.delete('blockstack_auth');
    module.dynamicImport('blockstack/dist/blockstack').then(_ref2 => {
      let {
        signUserOut
      } = _ref2;
      return signUserOut(window.location.href);
    });
  }

  return meteorLogout(...arguments);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/blockstack/client/routes.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 2);

const blockstackLogin = function (authResponse) {
  let userData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  Accounts.callLoginMethod({
    methodArguments: [{
      blockstack: true,
      authResponse,
      userData
    }],

    userCallback() {
      FlowRouter.go('home');
    }

  });
};

FlowRouter.route('/_blockstack/validate', {
  name: 'blockstackValidate',

  async action(params, queryParams) {
    const blockstack = await module.dynamicImport('blockstack/dist/blockstack');

    if (Meteor.userId()) {
      console.log('Blockstack Auth requested when already logged in. Reloading.');
      return FlowRouter.go('home');
    }

    if (queryParams.authResponse == null) {
      throw new Meteor.Error('Blockstack: Auth request without response param.');
    }

    let userData;

    if (blockstack.isUserSignedIn()) {
      userData = blockstack.loadUserData();
    }

    if (blockstack.isSignInPending()) {
      userData = await blockstack.handlePendingSignIn();
    }

    blockstackLogin(queryParams.authResponse, userData);
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"cas":{"client":{"cas_client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/cas/client/cas_client.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 2);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 3);

const openCenteredPopup = function (url, width, height) {
  const screenX = typeof window.screenX !== 'undefined' ? window.screenX : window.screenLeft;
  const screenY = typeof window.screenY !== 'undefined' ? window.screenY : window.screenTop;
  const outerWidth = typeof window.outerWidth !== 'undefined' ? window.outerWidth : document.body.clientWidth;
  const outerHeight = typeof window.outerHeight !== 'undefined' ? window.outerHeight : document.body.clientHeight - 22; // XXX what is the 22?
  // Use `outerWidth - width` and `outerHeight - height` for help in
  // positioning the popup centered relative to the current window

  const left = screenX + (outerWidth - width) / 2;
  const top = screenY + (outerHeight - height) / 2;
  const features = "width=".concat(width, ",height=").concat(height, ",left=").concat(left, ",top=").concat(top, ",scrollbars=yes");
  const newwindow = window.open(url, 'Login', features);

  if (newwindow.focus) {
    newwindow.focus();
  }

  return newwindow;
};

Meteor.loginWithCas = function (options, callback) {
  options = options || {};
  const credentialToken = Random.id();
  const login_url = settings.get('CAS_login_url');
  const popup_width = settings.get('CAS_popup_width');
  const popup_height = settings.get('CAS_popup_height');

  if (!login_url) {
    return;
  }

  const appUrl = Meteor.absoluteUrl().replace(/\/$/, '') + __meteor_runtime_config__.ROOT_URL_PATH_PREFIX; // check if the provided CAS URL already has some parameters


  const delim = login_url.split('?').length > 1 ? '&' : '?';
  const loginUrl = "".concat(login_url).concat(delim, "service=").concat(appUrl, "/_cas/").concat(credentialToken);
  const popup = openCenteredPopup(loginUrl, popup_width || 800, popup_height || 600);
  const checkPopupOpen = setInterval(function () {
    let popupClosed;

    try {
      // Fix for #328 - added a second test criteria (popup.closed === undefined)
      // to humour this Android quirk:
      // http://code.google.com/p/android/issues/detail?id=21061
      popupClosed = popup.closed || popup.closed === undefined;
    } catch (e) {
      // For some unknown reason, IE9 (and others?) sometimes (when
      // the popup closes too quickly?) throws "SCRIPT16386: No such
      // interface supported" when trying to read 'popup.closed'. Try
      // again in 100ms.
      return;
    }

    if (popupClosed) {
      clearInterval(checkPopupOpen); // check auth on server.

      Accounts.callLoginMethod({
        methodArguments: [{
          cas: {
            credentialToken
          }
        }],
        userCallback: callback
      });
    }
  }, 100);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/cas/client/index.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./cas_client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"colors":{"client":{"client.js":[
  "./style.css"
],"index.js":[
  "./client"
],"style.css":[]}},"cors":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/cors/client/index.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../settings/client", {
  settings(v) {
    settings = v;
  }

}, 2);
Meteor.startup(function () {
  Tracker.autorun(function () {
    Meteor.absoluteUrl.defaultOptions.secure = Boolean(settings.get('Force_SSL'));
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"crowd":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/crowd/client/index.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./loginHelper");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"loginHelper.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/crowd/client/loginHelper.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);

Meteor.loginWithCrowd = function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  // Pull username and password
  const username = args.shift();
  const password = args.shift();
  const callback = args.shift();
  const loginRequest = {
    crowd: true,
    username,
    crowdPassword: password
  };
  Accounts.callLoginMethod({
    methodArguments: [loginRequest],

    userCallback(error) {
      if (callback) {
        if (error) {
          return callback(error);
        }

        return callback();
      }
    }

  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"custom":{"client":{"index.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"custom-oauth":{"client":{"custom_oauth_client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-oauth/client/custom_oauth_client.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CustomOAuth: () => CustomOAuth
});
let capitalize;
module.link("@rocket.chat/string-helpers", {
  capitalize(v) {
    capitalize = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Match;
module.link("meteor/check", {
  Match(v) {
    Match = v;
  }

}, 2);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 3);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 4);
let ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration(v) {
    ServiceConfiguration = v;
  }

}, 5);
let OAuth;
module.link("meteor/oauth", {
  OAuth(v) {
    OAuth = v;
  }

}, 6);
module.link("./swapSessionStorage");
let isURL;
module.link("../../utils/lib/isURL", {
  isURL(v) {
    isURL = v;
  }

}, 7);

class CustomOAuth {
  constructor(name, options) {
    this.name = name;

    if (!Match.test(this.name, String)) {
      throw new Meteor.Error('CustomOAuth: Name is required and must be String');
    }

    this.configure(options);
    Accounts.oauth.registerService(this.name);
    this.configureLogin();
  }

  configure(options) {
    if (!Match.test(options, Object)) {
      throw new Meteor.Error('CustomOAuth: Options is required and must be Object');
    }

    if (!Match.test(options.serverURL, String)) {
      throw new Meteor.Error('CustomOAuth: Options.serverURL is required and must be String');
    }

    if (!Match.test(options.authorizePath, String)) {
      options.authorizePath = '/oauth/authorize';
    }

    if (!Match.test(options.scope, String)) {
      options.scope = 'openid';
    }

    this.serverURL = options.serverURL;
    this.authorizePath = options.authorizePath;
    this.scope = options.scope;

    if (!isURL(this.authorizePath)) {
      this.authorizePath = this.serverURL + this.authorizePath;
    }
  }

  configureLogin() {
    const loginWithService = "loginWith".concat(capitalize(String(this.name || '')));

    Meteor[loginWithService] = (options, callback) => {
      // support a callback without options
      if (!callback && typeof options === 'function') {
        callback = options;
        options = null;
      }

      const credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(callback);
      this.requestCredential(options, credentialRequestCompleteCallback);
    };
  }

  requestCredential(options, credentialRequestCompleteCallback) {
    // support both (options, callback) and (callback).
    if (!credentialRequestCompleteCallback && typeof options === 'function') {
      credentialRequestCompleteCallback = options;
      options = {};
    }

    const config = ServiceConfiguration.configurations.findOne({
      service: this.name
    });

    if (!config) {
      if (credentialRequestCompleteCallback) {
        credentialRequestCompleteCallback(new ServiceConfiguration.ConfigError());
      }

      return;
    }

    const credentialToken = Random.secret();

    const loginStyle = OAuth._loginStyle(this.name, config, options);

    const separator = this.authorizePath.indexOf('?') !== -1 ? '&' : '?';
    const loginUrl = "".concat(this.authorizePath).concat(separator, "client_id=").concat(config.clientId, "&redirect_uri=").concat(encodeURIComponent(OAuth._redirectUri(this.name, config)), "&response_type=code") + "&state=".concat(encodeURIComponent(OAuth._stateParam(loginStyle, credentialToken, options.redirectUrl)), "&scope=").concat(encodeURIComponent(this.scope));
    OAuth.launchLogin({
      loginService: this.name,
      loginStyle,
      loginUrl,
      credentialRequestCompleteCallback,
      credentialToken,
      popupOptions: {
        width: 900,
        height: 450
      }
    });
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"swapSessionStorage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-oauth/client/swapSessionStorage.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let OAuth;
module.link("meteor/oauth", {
  OAuth(v) {
    OAuth = v;
  }

}, 1);
let Reload;
module.link("meteor/reload", {
  Reload(v) {
    Reload = v;
  }

}, 2);

// TODO: This is a nasty workaround and should be removed as soon as possible
// Firefox is losing the sessionStorage data (v >= 79.0) after the redirect
if (navigator.userAgent.indexOf('Firefox') !== -1) {
  const KEY_NAME = 'Swapped_Storage_Workaround';

  OAuth.saveDataForRedirect = (loginService, credentialToken) => {
    Meteor._localStorage.setItem(KEY_NAME, JSON.stringify({
      loginService,
      credentialToken
    }));

    Reload._migrate(null, {
      immediateMigration: true
    });
  };

  OAuth.getDataAfterRedirect = () => {
    let migrationData = Meteor._localStorage.getItem(KEY_NAME);

    Meteor._localStorage.removeItem(KEY_NAME);

    try {
      migrationData = JSON.parse(migrationData);
    } catch (error) {
      migrationData = null;
    }

    if (!(migrationData && migrationData.credentialToken)) {
      return null;
    }

    const {
      credentialToken
    } = migrationData;
    const key = OAuth._storageTokenPrefix + credentialToken;
    let credentialSecret;

    try {
      credentialSecret = sessionStorage.getItem(key);
      sessionStorage.removeItem(key);
    } catch (e) {
      Meteor._debug('error retrieving credentialSecret', e);
    }

    return {
      loginService: migrationData.loginService,
      credentialToken,
      credentialSecret
    };
  };
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-oauth/index.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  let Meteor;
  module1.link("meteor/meteor", {
    Meteor(v) {
      Meteor = v;
    }

  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/custom_oauth_client.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/custom_oauth_server.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"favico":{"client":{"favico.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/favico/client/favico.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Favico: () => Favico
});

const Favico = function (opt) {
  'use strict';

  opt = opt ? opt : {};
  var _def = {
    bgColor: '#d00',
    textColor: '#fff',
    fontFamily: 'sans-serif',
    //Arial,Verdana,Times New Roman,serif,sans-serif,...
    fontStyle: 'bold',
    //normal,italic,oblique,bold,bolder,lighter,100,200,300,400,500,600,700,800,900
    type: 'circle',
    position: 'down',
    // down, up, left, leftup (upleft)
    animation: 'slide',
    elementId: false,
    dataUrl: false,
    win: window
  };

  var _opt, _orig, _h, _w, _canvas, _context, _img, _ready, _lastBadge, _running, _readyCb, _stop, _browser, _animTimeout, _drawTimeout, _doc;

  _browser = {};
  _browser.ff = typeof InstallTrigger !== 'undefined';
  _browser.chrome = !!window.chrome;
  _browser.opera = !!window.opera || navigator.userAgent.indexOf('Opera') >= 0;
  _browser.ie =
  /*@cc_on!@*/
  false;
  _browser.safari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0;
  _browser.supported = _browser.chrome || _browser.ff || _browser.opera;
  var _queue = [];

  _readyCb = function () {};

  _ready = _stop = false;
  /**
   * Initialize favico
   */

  var init = function () {
    //merge initial options
    _opt = merge(_def, opt);
    _opt.bgColor = hexToRgb(_opt.bgColor);
    _opt.textColor = hexToRgb(_opt.textColor);
    _opt.position = _opt.position.toLowerCase();
    _opt.animation = animation.types['' + _opt.animation] ? _opt.animation : _def.animation;
    _doc = _opt.win.document;
    var isUp = _opt.position.indexOf('up') > -1;
    var isLeft = _opt.position.indexOf('left') > -1; //transform the animations

    if (isUp || isLeft) {
      for (var a in animation.types) {
        for (var i = 0; i < animation.types[a].length; i++) {
          var step = animation.types[a][i];

          if (isUp) {
            if (step.y < 0.6) {
              step.y = step.y - 0.4;
            } else {
              step.y = step.y - 2 * step.y + (1 - step.w);
            }
          }

          if (isLeft) {
            if (step.x < 0.6) {
              step.x = step.x - 0.4;
            } else {
              step.x = step.x - 2 * step.x + (1 - step.h);
            }
          }

          animation.types[a][i] = step;
        }
      }
    }

    _opt.type = type['' + _opt.type] ? _opt.type : _def.type;
    _orig = link.getIcons(); //create temp canvas

    _canvas = document.createElement('canvas'); //create temp image

    _img = document.createElement('img');
    var lastIcon = _orig[_orig.length - 1];

    if (lastIcon.hasAttribute('href')) {
      _img.setAttribute('crossOrigin', 'anonymous'); //get width/height


      _img.onload = function () {
        _h = _img.height > 0 ? _img.height : 32;
        _w = _img.width > 0 ? _img.width : 32;
        _canvas.height = _h;
        _canvas.width = _w;
        _context = _canvas.getContext('2d');
        icon.ready();
      };

      _img.setAttribute('src', lastIcon.getAttribute('href'));
    } else {
      _img.onload = function () {
        _h = 32;
        _w = 32;
        _img.height = _h;
        _img.width = _w;
        _canvas.height = _h;
        _canvas.width = _w;
        _context = _canvas.getContext('2d');
        icon.ready();
      };

      _img.setAttribute('src', '');
    }
  };
  /**
   * Icon namespace
   */


  var icon = {};
  /**
   * Icon is ready (reset icon) and start animation (if ther is any)
   */

  icon.ready = function () {
    _ready = true;
    icon.reset();

    _readyCb();
  };
  /**
   * Reset icon to default state
   */


  icon.reset = function () {
    //reset
    if (!_ready) {
      return;
    }

    _queue = [];
    _lastBadge = false;
    _running = false;

    _context.clearRect(0, 0, _w, _h);

    _context.drawImage(_img, 0, 0, _w, _h); //_stop=true;


    link.setIcon(_canvas); //webcam('stop');
    //video('stop');

    window.clearTimeout(_animTimeout);
    window.clearTimeout(_drawTimeout);
  };
  /**
   * Start animation
   */


  icon.start = function () {
    if (!_ready || _running) {
      return;
    }

    var finished = function () {
      _lastBadge = _queue[0];
      _running = false;

      if (_queue.length > 0) {
        _queue.shift();

        icon.start();
      }
    };

    if (_queue.length > 0) {
      _running = true;

      var run = function () {
        // apply options for this animation
        ['type', 'animation', 'bgColor', 'textColor', 'fontFamily', 'fontStyle'].forEach(function (a) {
          if (a in _queue[0].options) {
            _opt[a] = _queue[0].options[a];
          }
        });
        animation.run(_queue[0].options, function () {
          finished();
        }, false);
      };

      if (_lastBadge) {
        animation.run(_lastBadge.options, function () {
          run();
        }, true);
      } else {
        run();
      }
    }
  };
  /**
   * Badge types
   */


  var type = {};

  var options = function (opt) {
    opt.n = typeof opt.n === 'number' ? Math.abs(opt.n | 0) : opt.n;
    opt.x = _w * opt.x;
    opt.y = _h * opt.y;
    opt.w = _w * opt.w;
    opt.h = _h * opt.h;
    opt.len = ('' + opt.n).length;
    return opt;
  };
  /**
   * Generate circle
   * @param {Object} opt Badge options
   */


  type.circle = function (opt) {
    opt = options(opt);
    var more = false;

    if (opt.len === 2) {
      opt.x = opt.x - opt.w * 0.4;
      opt.w = opt.w * 1.4;
      more = true;
    } else if (opt.len >= 3) {
      opt.x = opt.x - opt.w * 0.65;
      opt.w = opt.w * 1.65;
      more = true;
    }

    _context.clearRect(0, 0, _w, _h);

    _context.drawImage(_img, 0, 0, _w, _h);

    _context.beginPath();

    _context.font = _opt.fontStyle + ' ' + Math.floor(opt.h * (opt.n > 99 ? 0.85 : 1)) + 'px ' + _opt.fontFamily;
    _context.textAlign = 'center';

    if (more) {
      _context.moveTo(opt.x + opt.w / 2, opt.y);

      _context.lineTo(opt.x + opt.w - opt.h / 2, opt.y);

      _context.quadraticCurveTo(opt.x + opt.w, opt.y, opt.x + opt.w, opt.y + opt.h / 2);

      _context.lineTo(opt.x + opt.w, opt.y + opt.h - opt.h / 2);

      _context.quadraticCurveTo(opt.x + opt.w, opt.y + opt.h, opt.x + opt.w - opt.h / 2, opt.y + opt.h);

      _context.lineTo(opt.x + opt.h / 2, opt.y + opt.h);

      _context.quadraticCurveTo(opt.x, opt.y + opt.h, opt.x, opt.y + opt.h - opt.h / 2);

      _context.lineTo(opt.x, opt.y + opt.h / 2);

      _context.quadraticCurveTo(opt.x, opt.y, opt.x + opt.h / 2, opt.y);
    } else {
      _context.arc(opt.x + opt.w / 2, opt.y + opt.h / 2, opt.h / 2, 0, 2 * Math.PI);
    }

    _context.fillStyle = 'rgba(' + _opt.bgColor.r + ',' + _opt.bgColor.g + ',' + _opt.bgColor.b + ',' + opt.o + ')';

    _context.fill();

    _context.closePath();

    _context.beginPath();

    _context.stroke();

    _context.fillStyle = 'rgba(' + _opt.textColor.r + ',' + _opt.textColor.g + ',' + _opt.textColor.b + ',' + opt.o + ')'; //_context.fillText((more) ? '9+' : opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));

    if (typeof opt.n === 'number' && opt.n > 999) {
      _context.fillText((opt.n > 9999 ? 9 : Math.floor(opt.n / 1000)) + 'k+', Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.2));
    } else {
      _context.fillText(opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));
    }

    _context.closePath();
  };
  /**
   * Generate rectangle
   * @param {Object} opt Badge options
   */


  type.rectangle = function (opt) {
    opt = options(opt);
    var more = false;

    if (opt.len === 2) {
      opt.x = opt.x - opt.w * 0.4;
      opt.w = opt.w * 1.4;
      more = true;
    } else if (opt.len >= 3) {
      opt.x = opt.x - opt.w * 0.65;
      opt.w = opt.w * 1.65;
      more = true;
    }

    _context.clearRect(0, 0, _w, _h);

    _context.drawImage(_img, 0, 0, _w, _h);

    _context.beginPath();

    _context.font = _opt.fontStyle + ' ' + Math.floor(opt.h * (opt.n > 99 ? 0.9 : 1)) + 'px ' + _opt.fontFamily;
    _context.textAlign = 'center';
    _context.fillStyle = 'rgba(' + _opt.bgColor.r + ',' + _opt.bgColor.g + ',' + _opt.bgColor.b + ',' + opt.o + ')';

    _context.fillRect(opt.x, opt.y, opt.w, opt.h);

    _context.fillStyle = 'rgba(' + _opt.textColor.r + ',' + _opt.textColor.g + ',' + _opt.textColor.b + ',' + opt.o + ')'; //_context.fillText((more) ? '9+' : opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));

    if (typeof opt.n === 'number' && opt.n > 999) {
      _context.fillText((opt.n > 9999 ? 9 : Math.floor(opt.n / 1000)) + 'k+', Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.2));
    } else {
      _context.fillText(opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));
    }

    _context.closePath();
  };
  /**
   * Set badge
   */


  var badge = function (number, opts) {
    opts = (typeof opts === 'string' ? {
      animation: opts
    } : opts) || {};

    _readyCb = function () {
      try {
        if (typeof number === 'number' ? number > 0 : number !== '') {
          var q = {
            type: 'badge',
            options: {
              n: number
            }
          };

          if ('animation' in opts && animation.types['' + opts.animation]) {
            q.options.animation = '' + opts.animation;
          }

          if ('type' in opts && type['' + opts.type]) {
            q.options.type = '' + opts.type;
          }

          ['bgColor', 'textColor'].forEach(function (o) {
            if (o in opts) {
              q.options[o] = hexToRgb(opts[o]);
            }
          });
          ['fontStyle', 'fontFamily'].forEach(function (o) {
            if (o in opts) {
              q.options[o] = opts[o];
            }
          });

          _queue.push(q);

          if (_queue.length > 100) {
            throw new Error('Too many badges requests in queue.');
          }

          icon.start();
        } else {
          icon.reset();
        }
      } catch (e) {
        throw new Error('Error setting badge. Message: ' + e.message);
      }
    };

    if (_ready) {
      _readyCb();
    }
  };
  /**
   * Set image as icon
   */


  var image = function (imageElement) {
    _readyCb = function () {
      try {
        var w = imageElement.width;
        var h = imageElement.height;
        var newImg = document.createElement('img');
        var ratio = w / _w < h / _h ? w / _w : h / _h;
        newImg.setAttribute('crossOrigin', 'anonymous');

        newImg.onload = function () {
          _context.clearRect(0, 0, _w, _h);

          _context.drawImage(newImg, 0, 0, _w, _h);

          link.setIcon(_canvas);
        };

        newImg.setAttribute('src', imageElement.getAttribute('src'));
        newImg.height = h / ratio;
        newImg.width = w / ratio;
      } catch (e) {
        throw new Error('Error setting image. Message: ' + e.message);
      }
    };

    if (_ready) {
      _readyCb();
    }
  };
  /**
   * Set video as icon
   */


  var video = function (videoElement) {
    _readyCb = function () {
      try {
        if (videoElement === 'stop') {
          _stop = true;
          icon.reset();
          _stop = false;
          return;
        } //var w = videoElement.width;
        //var h = videoElement.height;
        //var ratio = (w / _w < h / _h) ? (w / _w) : (h / _h);


        videoElement.addEventListener('play', function () {
          drawVideo(this);
        }, false);
      } catch (e) {
        throw new Error('Error setting video. Message: ' + e.message);
      }
    };

    if (_ready) {
      _readyCb();
    }
  };
  /**
   * Set video as icon
   */


  var webcam = function (action) {
    //UR
    if (!window.URL || !window.URL.createObjectURL) {
      window.URL = window.URL || {};

      window.URL.createObjectURL = function (obj) {
        return obj;
      };
    }

    if (_browser.supported) {
      var newVideo = false;
      navigator.getUserMedia = navigator.getUserMedia || navigator.oGetUserMedia || navigator.msGetUserMedia || navigator.mozGetUserMedia || navigator.webkitGetUserMedia;

      _readyCb = function () {
        try {
          if (action === 'stop') {
            _stop = true;
            icon.reset();
            _stop = false;
            return;
          }

          newVideo = document.createElement('video');
          newVideo.width = _w;
          newVideo.height = _h;
          navigator.getUserMedia({
            video: true,
            audio: false
          }, function (stream) {
            newVideo.src = URL.createObjectURL(stream);
            newVideo.play();
            drawVideo(newVideo);
          }, function () {});
        } catch (e) {
          throw new Error('Error setting webcam. Message: ' + e.message);
        }
      };

      if (_ready) {
        _readyCb();
      }
    }
  };
  /**
   * Draw video to context and repeat :)
   */


  function drawVideo(video) {
    if (video.paused || video.ended || _stop) {
      return false;
    } //nasty hack for FF webcam (Thanks to Julian Ćwirko, kontakt@redsunmedia.pl)


    try {
      _context.clearRect(0, 0, _w, _h);

      _context.drawImage(video, 0, 0, _w, _h);
    } catch (e) {}

    _drawTimeout = setTimeout(function () {
      drawVideo(video);
    }, animation.duration);
    link.setIcon(_canvas);
  }

  var link = {};
  /**
   * Get icons from HEAD tag or create a new <link> element
   */

  link.getIcons = function () {
    var elms = []; //get link element

    var getLinks = function () {
      var icons = [];

      var links = _doc.getElementsByTagName('head')[0].getElementsByTagName('link');

      for (var i = 0; i < links.length; i++) {
        if (/(^|\s)icon(\s|$)/i.test(links[i].getAttribute('rel'))) {
          icons.push(links[i]);
        }
      }

      return icons;
    };

    if (_opt.element) {
      elms = [_opt.element];
    } else if (_opt.elementId) {
      //if img element identified by elementId
      elms = [_doc.getElementById(_opt.elementId)];
      elms[0].setAttribute('href', elms[0].getAttribute('src'));
    } else {
      //if link element
      elms = getLinks();

      if (elms.length === 0) {
        elms = [_doc.createElement('link')];
        elms[0].setAttribute('rel', 'icon');

        _doc.getElementsByTagName('head')[0].appendChild(elms[0]);
      }
    }

    elms.forEach(function (item) {
      item.setAttribute('type', 'image/png');
    });
    return elms;
  };

  link.setIcon = function (canvas) {
    var url = canvas.toDataURL('image/png');

    if (_opt.dataUrl) {
      //if using custom exporter
      _opt.dataUrl(url);
    }

    if (_opt.element) {
      _opt.element.setAttribute('href', url);

      _opt.element.setAttribute('src', url);
    } else if (_opt.elementId) {
      //if is attached to element (image)
      var elm = _doc.getElementById(_opt.elementId);

      elm.setAttribute('href', url);
      elm.setAttribute('src', url);
    } else {
      //if is attached to fav icon
      if (_browser.ff || _browser.opera) {
        //for FF we need to "recreate" element, atach to dom and remove old <link>
        //var originalType = _orig.getAttribute('rel');
        var old = _orig[_orig.length - 1];

        var newIcon = _doc.createElement('link');

        _orig = [newIcon]; //_orig.setAttribute('rel', originalType);

        if (_browser.opera) {
          newIcon.setAttribute('rel', 'icon');
        }

        newIcon.setAttribute('rel', 'icon');
        newIcon.setAttribute('type', 'image/png');

        _doc.getElementsByTagName('head')[0].appendChild(newIcon);

        newIcon.setAttribute('href', url);

        if (old.parentNode) {
          old.parentNode.removeChild(old);
        }
      } else {
        _orig.forEach(function (icon) {
          icon.setAttribute('href', url);
        });
      }
    }
  }; //http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb#answer-5624139
  //HEX to RGB convertor


  function hexToRgb(hex) {
    var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
    hex = hex.replace(shorthandRegex, function (m, r, g, b) {
      return r + r + g + g + b + b;
    });
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
    } : false;
  }
  /**
   * Merge options
   */


  function merge(def, opt) {
    var mergedOpt = {};
    var attrname;

    for (attrname in def) {
      mergedOpt[attrname] = def[attrname];
    }

    for (attrname in opt) {
      mergedOpt[attrname] = opt[attrname];
    }

    return mergedOpt;
  }
  /**
   * Cross-browser page visibility shim
   * http://stackoverflow.com/questions/12536562/detect-whether-a-window-is-visible
   */


  function isPageHidden() {
    return _doc.hidden || _doc.msHidden || _doc.webkitHidden || _doc.mozHidden;
  }
  /**
   * @namespace animation
   */


  var animation = {};
  /**
   * Animation "frame" duration
   */

  animation.duration = 40;
  /**
   * Animation types (none,fade,pop,slide)
   */

  animation.types = {};
  animation.types.fade = [{
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.0
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.1
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.2
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.3
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.4
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.5
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.6
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.7
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.8
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.9
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 1.0
  }];
  animation.types.none = [{
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 1
  }];
  animation.types.pop = [{
    x: 1,
    y: 1,
    w: 0,
    h: 0,
    o: 1
  }, {
    x: 0.9,
    y: 0.9,
    w: 0.1,
    h: 0.1,
    o: 1
  }, {
    x: 0.8,
    y: 0.8,
    w: 0.2,
    h: 0.2,
    o: 1
  }, {
    x: 0.7,
    y: 0.7,
    w: 0.3,
    h: 0.3,
    o: 1
  }, {
    x: 0.6,
    y: 0.6,
    w: 0.4,
    h: 0.4,
    o: 1
  }, {
    x: 0.5,
    y: 0.5,
    w: 0.5,
    h: 0.5,
    o: 1
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 1
  }];
  animation.types.popFade = [{
    x: 0.75,
    y: 0.75,
    w: 0,
    h: 0,
    o: 0
  }, {
    x: 0.65,
    y: 0.65,
    w: 0.1,
    h: 0.1,
    o: 0.2
  }, {
    x: 0.6,
    y: 0.6,
    w: 0.2,
    h: 0.2,
    o: 0.4
  }, {
    x: 0.55,
    y: 0.55,
    w: 0.3,
    h: 0.3,
    o: 0.6
  }, {
    x: 0.50,
    y: 0.50,
    w: 0.4,
    h: 0.4,
    o: 0.8
  }, {
    x: 0.45,
    y: 0.45,
    w: 0.5,
    h: 0.5,
    o: 0.9
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 1
  }];
  animation.types.slide = [{
    x: 0.4,
    y: 1,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.9,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.9,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.8,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.7,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.6,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.5,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 1
  }];
  /**
   * Run animation
   * @param {Object} opt Animation options
   * @param {Object} cb Callabak after all steps are done
   * @param {Object} revert Reverse order? true|false
   * @param {Object} step Optional step number (frame bumber)
   */

  animation.run = function (opt, cb, revert, step) {
    var animationType = animation.types[isPageHidden() ? 'none' : _opt.animation];

    if (revert === true) {
      step = typeof step !== 'undefined' ? step : animationType.length - 1;
    } else {
      step = typeof step !== 'undefined' ? step : 0;
    }

    cb = cb ? cb : function () {};

    if (step < animationType.length && step >= 0) {
      type[_opt.type](merge(opt, animationType[step]));

      _animTimeout = setTimeout(function () {
        if (revert) {
          step = step - 1;
        } else {
          step = step + 1;
        }

        animation.run(opt, cb, revert, step);
      }, animation.duration);
      link.setIcon(_canvas);
    } else {
      cb();
      return;
    }
  }; //auto init


  init();
  return {
    badge: badge,
    video: video,
    image: image,
    webcam: webcam,
    reset: icon.reset,
    browser: {
      supported: _browser.supported
    }
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/favico/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Favico: () => Favico
});
let Favico;
module.link("./favico", {
  Favico(v) {
    Favico = v;
  }

}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/favico/index.js                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client/index", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"highlight-words":{"client":{"client.js":[
  "./helper"
],"helper.js":[
  "@rocket.chat/string-helpers"
],"index.js":[
  "./client"
]},"index.js":[
  "./client/index"
]},"iframe-login":{"client":{"iframe_client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/iframe-login/client/iframe_client.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 1);
let IframeLogin;
module.link("../../ui-utils", {
  IframeLogin(v) {
    IframeLogin = v;
  }

}, 2);
const iframeLogin = new IframeLogin();
const {
  _unstoreLoginToken
} = Accounts;

Accounts._unstoreLoginToken = function () {
  iframeLogin.tryLogin();

  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  _unstoreLoginToken.apply(Accounts, args);
};

window.addEventListener('message', e => {
  if (!_.isObject(e.data)) {
    return;
  }

  switch (e.data.event) {
    case 'try-iframe-login':
      iframeLogin.tryLogin(error => {
        if (error) {
          e.source.postMessage({
            event: 'login-error',
            response: error.message
          }, e.origin);
        }
      });
      break;

    case 'login-with-token':
      iframeLogin.loginWithToken(e.data, error => {
        if (error) {
          e.source.postMessage({
            event: 'login-error',
            response: error.message
          }, e.origin);
        }
      });
      break;
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/iframe-login/client/index.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./iframe_client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"issuelinks":{"client":{"client.js":[],"index.js":[
  "./client"
]}},"katex":{"client":{"index.js":[
  "meteor/random",
  "katex",
  "@rocket.chat/string-helpers",
  "katex/dist/katex.min.css",
  "./style.css"
],"style.css":[]}},"logger":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/logger/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./logger");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"logger.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/logger/client/logger.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 1);
let getConfig;
module.link("../../../client/lib/utils/getConfig", {
  getConfig(v) {
    getConfig = v;
  }

}, 2);
Template.log = !!(getConfig('debug') || getConfig('debug-template'));

if (Template.log) {
  Template.logMatch = /.*/;

  Template.enableLogs = function (log) {
    Template.logMatch = /.*/;

    if (log === false) {
      Template.log = false;
      return false;
    }

    Template.log = true;

    if (log instanceof RegExp) {
      Template.logMatch = log;
      return log;
    }
  };

  const wrapHelpersAndEvents = function (original, prefix, color) {
    return function (dict) {
      const template = this;

      const fn1 = function (name, fn) {
        if (fn instanceof Function) {
          dict[name] = function () {
            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
              args[_key] = arguments[_key];
            }

            const result = fn.apply(this, args);

            if (Template.log === true) {
              const completeName = "".concat(prefix, ":").concat(template.viewName.replace('Template.', ''), ".").concat(name);

              if (Template.logMatch.test(completeName)) {
                console.log("%c".concat(completeName), "color: ".concat(color), {
                  args,
                  scope: this,
                  result
                });
              }
            }

            return result;
          };

          return dict[name];
        }
      };

      _.each(name, (fn, name) => {
        fn1(name, fn);
      });

      return original.call(template, dict);
    };
  };

  Template.prototype.helpers = wrapHelpersAndEvents(Template.prototype.helpers, 'helper', 'blue');
  Template.prototype.events = wrapHelpersAndEvents(Template.prototype.events, 'event', 'green');

  const wrapLifeCycle = function (original, prefix, color) {
    return function (fn) {
      const template = this;

      if (fn instanceof Function) {
        const wrap = function () {
          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
            args[_key2] = arguments[_key2];
          }

          const result = fn.apply(this, args);

          if (Template.log === true) {
            const completeName = "".concat(prefix, ":").concat(template.viewName.replace('Template.', ''), ".").concat(name);

            if (Template.logMatch.test(completeName)) {
              console.log("%c".concat(completeName), "color: ".concat(color, "; font-weight: bold"), {
                args,
                scope: this,
                result
              });
            }
          }

          return result;
        };

        return original.call(template, wrap);
      }

      return original.call(template, fn);
    };
  };

  Template.prototype.onCreated = wrapLifeCycle(Template.prototype.onCreated, 'onCreated', 'blue');
  Template.prototype.onRendered = wrapLifeCycle(Template.prototype.onRendered, 'onRendered', 'green');
  Template.prototype.onDestroyed = wrapLifeCycle(Template.prototype.onDestroyed, 'onDestroyed', 'red');
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"mail-messages":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mail-messages/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./startup");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mail-messages/client/startup.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let hasAllPermission;
module.link("../../authorization", {
  hasAllPermission(v) {
    hasAllPermission = v;
  }

}, 0);
let registerAdminSidebarItem;
module.link("../../../client/views/admin", {
  registerAdminSidebarItem(v) {
    registerAdminSidebarItem = v;
  }

}, 1);
registerAdminSidebarItem({
  href: 'admin-mailer',
  i18nLabel: 'Mailer',
  icon: 'mail',
  permissionGranted: () => hasAllPermission('access-mailer')
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"message-attachments":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-attachments/client/index.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./renderField", {
  registerFieldTemplate: "registerFieldTemplate"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"renderField.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-attachments/client/renderField.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  registerFieldTemplate: () => registerFieldTemplate
});

function registerFieldTemplate() {
  console.warn('registerFieldTemplate DEPRECATED');
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"message-mark-as-unread":{"client":{"actionButton.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-mark-as-unread/client/actionButton.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 1);
let RoomManager, MessageAction;
module.link("../../ui-utils", {
  RoomManager(v) {
    RoomManager = v;
  },

  MessageAction(v) {
    MessageAction = v;
  }

}, 2);
let messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs(v) {
    messageArgs = v;
  }

}, 3);
let ChatSubscription;
module.link("../../models", {
  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 4);
let roomTypes;
module.link("../../utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 5);
let handleError;
module.link("../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 6);
Meteor.startup(() => {
  MessageAction.addButton({
    id: 'mark-message-as-unread',
    icon: 'flag',
    label: 'Mark_unread',
    context: ['message', 'message-mobile', 'threads'],

    action() {
      const {
        msg: message
      } = messageArgs(this);
      return Meteor.call('unreadMessages', message, function (error) {
        if (error) {
          return handleError(error);
        }

        const subscription = ChatSubscription.findOne({
          rid: message.rid
        });

        if (subscription == null) {
          return;
        }

        RoomManager.close(subscription.t + subscription.name);
        return FlowRouter.go('home');
      });
    },

    condition(_ref) {
      let {
        msg,
        u,
        room
      } = _ref;
      const isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return msg.u._id !== u._id;
    },

    order: 10,
    group: 'menu'
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-mark-as-unread/client/index.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./actionButton");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"meteor-accounts-saml":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-accounts-saml/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./saml_client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"saml_client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-accounts-saml/client/saml_client.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 1);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 2);
let ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration(v) {
    ServiceConfiguration = v;
  }

}, 3);

if (!Accounts.saml) {
  Accounts.saml = {};
} // Override the standard logout behaviour.
//
// If we find a samlProvider, and we are using single
// logout we will initiate logout from rocketchat via saml.
// If not using single logout, we just do the standard logout.
// This can be overridden by a configured logout behaviour.
//
// TODO: This may need some work as it is not clear if we are really
// logging out of the idp when doing the standard logout.


const MeteorLogout = Meteor.logout;
const logoutBehaviour = {
  TERMINATE_SAML: 'SAML',
  ONLY_RC: 'Local'
};

Meteor.logout = function () {
  const samlService = ServiceConfiguration.configurations.findOne({
    service: 'saml'
  });

  if (samlService) {
    const provider = samlService.clientConfig && samlService.clientConfig.provider;

    if (provider) {
      if (samlService.logoutBehaviour == null || samlService.logoutBehaviour === logoutBehaviour.TERMINATE_SAML) {
        if (samlService.idpSLORedirectURL) {
          console.info('SAML session terminated via SLO');
          return Meteor.logoutWithSaml({
            provider
          });
        }
      }

      if (samlService.logoutBehaviour === logoutBehaviour.ONLY_RC) {
        console.info('SAML session not terminated, only the Rocket.Chat session is going to be killed');
      }
    }
  }

  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  return MeteorLogout.apply(Meteor, args);
};

Meteor.loginWithSaml = function (options
/* , callback*/
) {
  options = options || {};
  const credentialToken = "id-".concat(Random.id());
  options.credentialToken = credentialToken;
  window.location.href = "_saml/authorize/".concat(options.provider, "/").concat(options.credentialToken);
};

Meteor.logoutWithSaml = function (options
/* , callback*/
) {
  // Accounts.saml.idpInitiatedSLO(options, callback);
  Meteor.call('samlLogout', options.provider, function (err, result) {
    if (err || !result) {
      MeteorLogout.apply(Meteor);
      return;
    } // Remove the userId from the client to prevent calls to the server while the logout is processed.
    // If the logout fails, the userId will be reloaded on the resume call


    Meteor._localStorage.removeItem(Accounts.USER_ID_KEY); // A nasty bounce: 'result' has the SAML LogoutRequest but we need a proper 302 to redirected from the server.


    window.location.replace(Meteor.absoluteUrl("_saml/sloRedirect/".concat(options.provider, "/?redirect=").concat(encodeURIComponent(result))));
  });
};

Meteor.loginWithSamlToken = function (token, userCallback) {
  Accounts.callLoginMethod({
    methodArguments: [{
      saml: true,
      credentialToken: token
    }],
    userCallback
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"nrr":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/nrr/client/index.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./nrr");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"nrr.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/nrr/client/nrr.js                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 2);
let HTML;
module.link("meteor/htmljs", {
  HTML(v) {
    HTML = v;
  }

}, 3);
let Spacebars;
module.link("meteor/spacebars", {
  Spacebars(v) {
    Spacebars = v;
  }

}, 4);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 5);

const makeCursorReactive = function (obj) {
  if (obj instanceof Meteor.Collection.Cursor) {
    return obj._depend({
      added: true,
      removed: true,
      changed: true
    });
  }
};

const toHTMLWithDataNonReactive = function (content, data) {
  makeCursorReactive(data);

  if (data instanceof Spacebars.kw && Object.keys(data.hash).length > 0) {
    Object.entries(data.hash).forEach(_ref => {
      let [, value] = _ref;
      return makeCursorReactive(value);
    });
    return Tracker.nonreactive(() => Blaze.toHTMLWithData(content, data.hash));
  }

  return Tracker.nonreactive(() => Blaze.toHTMLWithData(content, data));
};

const renderNonReactive = function (templateName, data) {
  const {
    _arguments
  } = this.parentView.dataVar.get();
  [templateName, data] = _arguments;
  return Tracker.nonreactive(() => {
    console.warn('Nrr template is deprecated');
    const view = new Blaze.View('nrr', () => HTML.Raw(toHTMLWithDataNonReactive(Template[templateName], data)));
    view.onViewReady(() => {
      const {
        onViewReady
      } = Template[templateName];
      return onViewReady && onViewReady.call(view, data);
    });

    view._onViewRendered(() => {
      const {
        onViewRendered
      } = Template[templateName];
      return onViewRendered && onViewRendered.call(view, data);
    });

    return view;
  });
};

Template.nrr = new Blaze.Template('nrr', renderNonReactive);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"push-notifications":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/push-notifications/client/index.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./tabBar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/push-notifications/client/tabBar.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let lazy, useMemo;
module.link("react", {
  lazy(v) {
    lazy = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 0);
let useUserSubscription;
module.link("../../../client/contexts/UserContext", {
  useUserSubscription(v) {
    useUserSubscription = v;
  }

}, 1);
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 2);
addAction('push-notifications', _ref => {
  let {
    room
  } = _ref;
  const subscription = useUserSubscription(room === null || room === void 0 ? void 0 : room._id);
  return useMemo(() => subscription ? {
    groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
    id: 'push-notifications',
    title: 'Notifications_Preferences',
    icon: 'bell',
    template: /*#__PURE__*/lazy(() => module.dynamicImport('../../../client/views/room/contextualBar/NotificationPreferences')),
    order: 8
  } : null, [subscription]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slackbridge":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slackbridge/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./slackbridge_import.client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"slackbridge_import.client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slackbridge/client/slackbridge_import.client.js                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 0);
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 1);
settings.onload('SlackBridge_Enabled', (key, value) => {
  if (value) {
    slashCommands.add('slackbridge-import', null, {
      description: 'Import_old_messages_from_slackbridge'
    });
  } else {
    delete slashCommands.commands['slackbridge-import'];
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-archiveroom":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-archiveroom/client/client.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 0);
slashCommands.add('archive', null, {
  description: 'Archive',
  params: '#channel',
  permission: 'archive-room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-archiveroom/client/index.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-create":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-create/client/client.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 0);
slashCommands.add('create', null, {
  description: 'Create_A_New_Channel',
  params: '#channel',
  permission: ['create-c', 'create-p']
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-create/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-hide":{"client":{"hide.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-hide/client/hide.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 0);
slashCommands.add('hide', undefined, {
  description: 'Hide_room',
  params: '#room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-hide/client/index.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./hide");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-invite":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-invite/client/client.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 0);
slashCommands.add('invite', undefined, {
  description: 'Invite_user_to_join_channel',
  params: '@username',
  permission: 'add-user-to-joined-room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-invite/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-inviteall":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-inviteall/client/client.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 0);
slashCommands.add('invite-all-to', undefined, {
  description: 'Invite_user_to_join_channel_all_to',
  params: '#room',
  permission: ['add-user-to-joined-room', 'add-user-to-any-c-room', 'add-user-to-any-p-room']
});
slashCommands.add('invite-all-from', undefined, {
  description: 'Invite_user_to_join_channel_all_from',
  params: '#room',
  permission: 'add-user-to-joined-room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-inviteall/client/index.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-join":{"client":{"client.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-join/client/client.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let slashCommands;
module.link("../../utils/lib/slashCommand", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 0);
slashCommands.add('join', undefined, {
  description: 'Join_the_given_channel',
  params: '#channel',
  permission: 'view-c-room'
}, undefined, false, undefined, function (err, _result, params) {
  if (err.error === 'error-user-already-in-room') {
    params.cmd = 'open';
    params.msg.msg = params.msg.msg.replace('join', 'open');
    return slashCommands.run('open', params.params, params.msg, undefined);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-join/client/index.ts                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-kick":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-kick/client/client.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 0);
slashCommands.add('kick', function (command, params) {
  const username = params.trim();

  if (username === '') {
    return;
  }

  return username.replace('@', '');
}, {
  description: 'Remove_someone_from_room',
  params: '@username',
  permission: 'remove-user'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-kick/client/index.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-open":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-open/client/client.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Match;
module.link("meteor/check", {
  Match(v) {
    Match = v;
  }

}, 1);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 2);
let slashCommands, roomTypes;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  },

  roomTypes(v) {
    roomTypes = v;
  }

}, 3);
let ChatSubscription, Subscriptions;
module.link("../../models", {
  ChatSubscription(v) {
    ChatSubscription = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 4);

function Open(command, params
/* , item*/
) {
  const dict = {
    '#': ['c', 'p'],
    '@': ['d']
  };

  if (command !== 'open' || !Match.test(params, String)) {
    return;
  }

  let room = params.trim();
  const type = dict[room[0]];
  room = room.replace(/#|@/, '');
  const query = {
    name: room
  };

  if (type) {
    query.t = {
      $in: type
    };
  }

  const subscription = ChatSubscription.findOne(query);

  if (subscription) {
    roomTypes.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);
  }

  if (type && type.indexOf('d') === -1) {
    return;
  }

  return Meteor.call('createDirectMessage', room, function (err) {
    if (err) {
      return;
    }

    const subscription = Subscriptions.findOne(query);
    roomTypes.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);
  });
}

slashCommands.add('open', Open, {
  description: 'Opens_a_channel_group_or_direct_message',
  params: 'room_name',
  clientOnly: true,
  permission: ['view-c-room', 'view-c-room', 'view-d-room', 'view-joined-room', 'create-d']
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-open/client/index.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-unarchiveroom":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-unarchiveroom/client/client.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let slashCommands;
module.link("../../utils", {
  slashCommands(v) {
    slashCommands = v;
  }

}, 0);
slashCommands.add('unarchive', null, {
  description: 'Unarchive',
  params: '#channel',
  permission: 'unarchive-room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-unarchiveroom/client/index.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"version-check":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/version-check/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 2);
let banners;
module.link("../../../client/lib/banners", {
  "*"(v) {
    banners = v;
  }

}, 3);
Meteor.startup(function () {
  Tracker.autorun(() => {
    const user = Meteor.user();

    if (user && Object.keys(user.banners || {}).length > 0) {
      const firstBanner = Object.values(user.banners).filter(b => b.read !== true).sort((a, b) => b.priority - a.priority)[0];

      if (!firstBanner) {
        return;
      }

      firstBanner.textArguments = firstBanner.textArguments || [];
      banners.open({
        id: firstBanner.id,
        title: TAPi18n.__(firstBanner.title),
        text: TAPi18n.__(firstBanner.text, ...firstBanner.textArguments),
        modifiers: firstBanner.modifiers,

        action() {
          if (firstBanner.link) {
            window.open(firstBanner.link, '_system');
          }
        },

        onClose() {
          Meteor.call('banner/dismiss', {
            id: firstBanner.id
          });
        }

      });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"webrtc":{"client":{"WebRTCClass.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/WebRTCClass.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  WebRTC: () => WebRTC
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 3);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 4);
let ChromeScreenShare;
module.link("./screenShare", {
  ChromeScreenShare(v) {
    ChromeScreenShare = v;
  }

}, 5);
let t;
module.link("../../utils", {
  t(v) {
    t = v;
  }

}, 6);
let Notifications;
module.link("../../notifications", {
  Notifications(v) {
    Notifications = v;
  }

}, 7);
let settings;
module.link("../../settings", {
  settings(v) {
    settings = v;
  }

}, 8);
let modal;
module.link("../../ui-utils", {
  modal(v) {
    modal = v;
  }

}, 9);
let ChatSubscription;
module.link("../../models", {
  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 10);
let WEB_RTC_EVENTS;
module.link("..", {
  WEB_RTC_EVENTS(v) {
    WEB_RTC_EVENTS = v;
  }

}, 11);
let goToRoomById;
module.link("../../../client/lib/utils/goToRoomById", {
  goToRoomById(v) {
    goToRoomById = v;
  }

}, 12);

class WebRTCTransportClass extends Emitter {
  constructor(webrtcInstance) {
    super();
    this.debug = false;
    this.webrtcInstance = webrtcInstance;
    Notifications.onRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, (type, data) => {
      this.log('WebRTCTransportClass - onRoom', type, data);
      this.emit(type, data);
    });
  }

  log() {
    if (this.debug === true) {
      console.log(...arguments);
    }
  }

  onUserStream(type, data) {
    if (data.room !== this.webrtcInstance.room) {
      return;
    }

    this.log('WebRTCTransportClass - onUser', type, data);
    this.emit(type, data);
  }

  startCall(data) {
    this.log('WebRTCTransportClass - startCall', this.webrtcInstance.room, this.webrtcInstance.selfId);
    Notifications.notifyUsersOfRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.CALL, {
      from: this.webrtcInstance.selfId,
      room: this.webrtcInstance.room,
      media: data.media,
      monitor: data.monitor
    });
  }

  joinCall(data) {
    this.log('WebRTCTransportClass - joinCall', this.webrtcInstance.room, this.webrtcInstance.selfId);

    if (data.monitor === true) {
      Notifications.notifyUser(data.to, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.JOIN, {
        from: this.webrtcInstance.selfId,
        room: this.webrtcInstance.room,
        media: data.media,
        monitor: data.monitor
      });
    } else {
      Notifications.notifyUsersOfRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.JOIN, {
        from: this.webrtcInstance.selfId,
        room: this.webrtcInstance.room,
        media: data.media,
        monitor: data.monitor
      });
    }
  }

  sendCandidate(data) {
    data.from = this.webrtcInstance.selfId;
    data.room = this.webrtcInstance.room;
    this.log('WebRTCTransportClass - sendCandidate', data);
    Notifications.notifyUser(data.to, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.CANDIDATE, data);
  }

  sendDescription(data) {
    data.from = this.webrtcInstance.selfId;
    data.room = this.webrtcInstance.room;
    this.log('WebRTCTransportClass - sendDescription', data);
    Notifications.notifyUser(data.to, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.DESCRIPTION, data);
  }

  sendStatus(data) {
    this.log('WebRTCTransportClass - sendStatus', data, this.webrtcInstance.room);
    data.from = this.webrtcInstance.selfId;
    Notifications.notifyRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.STATUS, data);
  }

  onRemoteCall(fn) {
    return this.on(WEB_RTC_EVENTS.CALL, fn);
  }

  onRemoteJoin(fn) {
    return this.on(WEB_RTC_EVENTS.JOIN, fn);
  }

  onRemoteCandidate(fn) {
    return this.on(WEB_RTC_EVENTS.CANDIDATE, fn);
  }

  onRemoteDescription(fn) {
    return this.on(WEB_RTC_EVENTS.DESCRIPTION, fn);
  }

  onRemoteStatus(fn) {
    return this.on(WEB_RTC_EVENTS.STATUS, fn);
  }

}

class WebRTCClass {
  /*
   		@param seldId {String}
   		@param room {String}
    */
  constructor(selfId, room) {
    let autoAccept = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

    this.resetCallInProgress = () => {
      this.callInProgress.set(false);
    };

    this.stopPeerConnection = id => {
      const peerConnection = this.peerConnections[id];

      if (peerConnection == null) {
        return;
      }

      delete this.peerConnections[id];
      peerConnection.close();
      this.updateRemoteItems();
    };

    this.config = {
      iceServers: []
    };
    this.debug = false;
    this.TransportClass = WebRTCTransportClass;
    this.selfId = selfId;
    this.room = room;
    let servers = settings.get('WebRTC_Servers');

    if (servers && servers.trim() !== '') {
      servers = servers.replace(/\s/g, '');
      servers = servers.split(',');
      servers.forEach(server => {
        server = server.split('@');
        const serverConfig = {
          urls: server.pop()
        };

        if (server.length === 1) {
          server = server[0].split(':');
          serverConfig.username = decodeURIComponent(server[0]);
          serverConfig.credential = decodeURIComponent(server[1]);
        }

        this.config.iceServers.push(serverConfig);
      });
    }

    this.peerConnections = {};
    this.remoteItems = new ReactiveVar([]);
    this.remoteItemsById = new ReactiveVar({});
    this.callInProgress = new ReactiveVar(false);
    this.audioEnabled = new ReactiveVar(false);
    this.videoEnabled = new ReactiveVar(false);
    this.overlayEnabled = new ReactiveVar(false);
    this.screenShareEnabled = new ReactiveVar(false);
    this.localUrl = new ReactiveVar();
    this.active = false;
    this.remoteMonitoring = false;
    this.monitor = false;
    this.autoAccept = autoAccept;
    this.navigator = undefined;
    const userAgent = navigator.userAgent.toLocaleLowerCase();

    if (userAgent.indexOf('electron') !== -1) {
      this.navigator = 'electron';
    } else if (userAgent.indexOf('chrome') !== -1) {
      this.navigator = 'chrome';
    } else if (userAgent.indexOf('firefox') !== -1) {
      this.navigator = 'firefox';
    } else if (userAgent.indexOf('safari') !== -1) {
      this.navigator = 'safari';
    }

    this.screenShareAvailable = ['chrome', 'firefox', 'electron'].includes(this.navigator);
    this.media = {
      video: true,
      audio: true
    };
    this.transport = new this.TransportClass(this);
    this.transport.onRemoteCall(this.onRemoteCall.bind(this));
    this.transport.onRemoteJoin(this.onRemoteJoin.bind(this));
    this.transport.onRemoteCandidate(this.onRemoteCandidate.bind(this));
    this.transport.onRemoteDescription(this.onRemoteDescription.bind(this));
    this.transport.onRemoteStatus(this.onRemoteStatus.bind(this));
    Meteor.setInterval(this.checkPeerConnections.bind(this), 1000); // Meteor.setInterval(this.broadcastStatus.bind(@), 1000);
  }

  onUserStream() {
    return this.transport.onUserStream(...arguments);
  }

  log() {
    if (this.debug === true) {
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      console.log.apply(console, args);
    }
  }

  onError() {
    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    console.error.apply(console, args);
  }

  checkPeerConnections() {
    const {
      peerConnections
    } = this;
    const date = Date.now();
    Object.entries(peerConnections).some(_ref => {
      let [id, peerConnection] = _ref;

      if (!['connected', 'completed'].includes(peerConnection.iceConnectionState) && peerConnection.createdAt + 5000 < date) {
        this.stopPeerConnection(id);
        return true;
      }

      return false;
    });
  }

  updateRemoteItems() {
    const items = [];
    const itemsById = {};
    const {
      peerConnections
    } = this;
    Object.entries(peerConnections).forEach(_ref2 => {
      let [id, peerConnection] = _ref2;
      peerConnection.getRemoteStreams().forEach(remoteStream => {
        const item = {
          id,
          url: remoteStream,
          state: peerConnection.iceConnectionState
        };

        switch (peerConnection.iceConnectionState) {
          case 'checking':
            item.stateText = 'Connecting...';
            break;

          case 'connected':
          case 'completed':
            item.stateText = 'Connected';
            item.connected = true;
            break;

          case 'disconnected':
            item.stateText = 'Disconnected';
            break;

          case 'failed':
            item.stateText = 'Failed';
            break;

          case 'closed':
            item.stateText = 'Closed';
        }

        items.push(item);
        itemsById[id] = item;
      });
    });
    this.remoteItems.set(items);
    this.remoteItemsById.set(itemsById);
  }

  broadcastStatus() {
    if (this.active !== true || this.monitor === true || this.remoteMonitoring === true) {
      return;
    }

    const remoteConnections = [];
    const {
      peerConnections
    } = this;
    Object.keys(peerConnections).entries(_ref3 => {
      let [id, {
        remoteMedia: media
      }] = _ref3;
      remoteConnections.push({
        id,
        media
      });
    });
    this.transport.sendStatus({
      media: this.media,
      remoteConnections
    });
  }
  /*
   		@param data {Object}
   			from {String}
   			media {Object}
   			remoteConnections {Array[Object]}
   				id {String}
   				media {Object}
    */


  onRemoteStatus(data) {
    // this.log(onRemoteStatus, arguments);
    this.callInProgress.set(true);
    Meteor.clearTimeout(this.callInProgressTimeout);
    this.callInProgressTimeout = Meteor.setTimeout(this.resetCallInProgress, 2000);

    if (this.active !== true) {
      return;
    }

    const remoteConnections = [{
      id: data.from,
      media: data.media
    }, ...data.remoteConnections];
    remoteConnections.forEach(remoteConnection => {
      if (remoteConnection.id !== this.selfId && this.peerConnections[remoteConnection.id] == null) {
        this.log('reconnecting with', remoteConnection.id);
        this.onRemoteJoin({
          from: remoteConnection.id,
          media: remoteConnection.media
        });
      }
    });
  }
  /*
   		@param id {String}
    */


  getPeerConnection(id) {
    if (this.peerConnections[id] != null) {
      return this.peerConnections[id];
    }

    const peerConnection = new RTCPeerConnection(this.config);
    peerConnection.createdAt = Date.now();
    peerConnection.remoteMedia = {};
    this.peerConnections[id] = peerConnection;
    const eventNames = ['icecandidate', 'addstream', 'removestream', 'iceconnectionstatechange', 'datachannel', 'identityresult', 'idpassertionerror', 'idpvalidationerror', 'negotiationneeded', 'peeridentity', 'signalingstatechange'];
    eventNames.forEach(eventName => {
      peerConnection.addEventListener(eventName, e => {
        this.log(id, e.type, e);
      });
    });
    peerConnection.addEventListener('icecandidate', e => {
      if (e.candidate == null) {
        return;
      }

      this.transport.sendCandidate({
        to: id,
        candidate: {
          candidate: e.candidate.candidate,
          sdpMLineIndex: e.candidate.sdpMLineIndex,
          sdpMid: e.candidate.sdpMid
        }
      });
    });
    peerConnection.addEventListener('addstream', () => {
      this.updateRemoteItems();
    });
    peerConnection.addEventListener('removestream', () => {
      this.updateRemoteItems();
    });
    peerConnection.addEventListener('iceconnectionstatechange', () => {
      if ((peerConnection.iceConnectionState === 'disconnected' || peerConnection.iceConnectionState === 'closed') && peerConnection === this.peerConnections[id]) {
        this.stopPeerConnection(id);
        Meteor.setTimeout(() => {
          if (Object.keys(this.peerConnections).length === 0) {
            this.stop();
          }
        }, 3000);
      }

      this.updateRemoteItems();
    });
    return peerConnection;
  }

  _getUserMedia(media, onSuccess, onError) {
    const onSuccessLocal = stream => {
      if (AudioContext && stream.getAudioTracks().length > 0) {
        const audioContext = new AudioContext();
        const source = audioContext.createMediaStreamSource(stream);
        const volume = audioContext.createGain();
        source.connect(volume);
        const peer = audioContext.createMediaStreamDestination();
        volume.connect(peer);
        volume.gain.value = 0.6;
        stream.removeTrack(stream.getAudioTracks()[0]);
        stream.addTrack(peer.stream.getAudioTracks()[0]);
        stream.volume = volume;
        this.audioContext = audioContext;
      }

      onSuccess(stream);
    };

    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
      return navigator.mediaDevices.getUserMedia(media).then(onSuccessLocal).catch(onError);
    }

    navigator.getUserMedia(media, onSuccessLocal, onError);
  }

  getUserMedia(media, onSuccess) {
    let onError = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.onError;

    if (media.desktop !== true) {
      this._getUserMedia(media, onSuccess, onError);

      return;
    }

    if (this.screenShareAvailable !== true) {
      console.log('Screen share is not avaliable');
      return;
    }

    const getScreen = audioStream => {
      const refresh = function () {
        modal.open({
          type: 'warning',
          title: TAPi18n.__('Refresh_your_page_after_install_to_enable_screen_sharing')
        });
      };

      const isChromeExtensionInstalled = this.navigator === 'chrome' && ChromeScreenShare.installed;
      const isFirefoxExtensionInstalled = this.navigator === 'firefox' && window.rocketchatscreenshare != null;

      if (!isChromeExtensionInstalled && !isFirefoxExtensionInstalled) {
        modal.open({
          type: 'warning',
          title: TAPi18n.__('Screen_Share'),
          text: TAPi18n.__('You_need_install_an_extension_to_allow_screen_sharing'),
          html: true,
          showCancelButton: true,
          confirmButtonText: TAPi18n.__('Install_Extension'),
          cancelButtonText: TAPi18n.__('Cancel')
        }, isConfirm => {
          if (isConfirm) {
            if (this.navigator === 'chrome') {
              const url = 'https://chrome.google.com/webstore/detail/rocketchat-screen-share/nocfbnnmjnndkbipkabodnheejiegccf';

              try {
                chrome.webstore.install(url, refresh, function () {
                  window.open(url);
                  refresh();
                });
              } catch (_error) {
                console.log(_error);
                window.open(url);
                refresh();
              }
            } else if (this.navigator === 'firefox') {
              window.open('https://addons.mozilla.org/en-GB/firefox/addon/rocketchat-screen-share/');
              refresh();
            }
          }
        });
        return onError(false);
      }

      const getScreenSuccess = stream => {
        if (audioStream != null) {
          stream.addTrack(audioStream.getAudioTracks()[0]);
        }

        onSuccess(stream);
      };

      if (this.navigator === 'firefox') {
        media = {
          audio: media.audio,
          video: {
            mozMediaSource: 'window',
            mediaSource: 'window'
          }
        };

        this._getUserMedia(media, getScreenSuccess, onError);
      } else {
        ChromeScreenShare.getSourceId(this.navigator, id => {
          media = {
            audio: false,
            video: {
              mandatory: {
                chromeMediaSource: 'desktop',
                chromeMediaSourceId: id,
                maxWidth: 1280,
                maxHeight: 720
              }
            }
          };

          this._getUserMedia(media, getScreenSuccess, onError);
        });
      }
    };

    if (this.navigator === 'firefox' || media.audio == null || media.audio === false) {
      getScreen();
    } else {
      const getAudioSuccess = audioStream => {
        getScreen(audioStream);
      };

      const getAudioError = () => {
        getScreen();
      };

      this._getUserMedia({
        audio: media.audio
      }, getAudioSuccess, getAudioError);
    }
  }
  /*
   		@param callback {Function}
    */


  getLocalUserMedia(callback) {
    for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
      args[_key3 - 1] = arguments[_key3];
    }

    this.log('getLocalUserMedia', [callback, ...args]);

    if (this.localStream != null) {
      return callback(null, this.localStream);
    }

    const onSuccess = stream => {
      this.localStream = stream;
      !this.audioEnabled.get() && this.disableAudio();
      !this.videoEnabled.get() && this.disableVideo();
      this.localUrl.set(stream);
      const {
        peerConnections
      } = this;
      Object.entries(peerConnections).forEach(_ref4 => {
        let [, peerConnection] = _ref4;
        return peerConnection.addStream(stream);
      });
      document.querySelector('video#localVideo').srcObject = stream;
      callback(null, this.localStream);
    };

    const onError = error => {
      callback(false);
      this.onError(error);
    };

    this.getUserMedia(this.media, onSuccess, onError);
  }
  /*
   		@param id {String}
    */


  stopAllPeerConnections() {
    const {
      peerConnections
    } = this;
    Object.keys(peerConnections).forEach(this.stopPeerConnection);
    window.audioContext && window.audioContext.close();
  }

  setAudioEnabled() {
    let enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

    if (this.localStream != null) {
      this.localStream.getAudioTracks().forEach(function (audio) {
        audio.enabled = enabled;
      });
      this.audioEnabled.set(enabled);
    }
  }

  disableAudio() {
    this.setAudioEnabled(false);
  }

  enableAudio() {
    this.setAudioEnabled(true);
  }

  toggleAudio() {
    if (this.audioEnabled.get()) {
      return this.disableAudio();
    }

    return this.enableAudio();
  }

  setVideoEnabled() {
    let enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

    if (this.localStream != null) {
      this.localStream.getVideoTracks().forEach(function (video) {
        video.enabled = enabled;
      });
      this.videoEnabled.set(enabled);
    }
  }

  disableScreenShare() {
    this.setScreenShareEnabled(false);
  }

  enableScreenShare() {
    this.setScreenShareEnabled(true);
  }

  setScreenShareEnabled() {
    let enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

    if (this.localStream != null) {
      this.media.desktop = enabled;
      delete this.localStream;
      this.getLocalUserMedia(err => {
        if (err != null) {
          return;
        }

        this.screenShareEnabled.set(enabled);
        this.stopAllPeerConnections();
        this.joinCall();
      });
    }
  }

  disableVideo() {
    this.setVideoEnabled(false);
  }

  enableVideo() {
    this.setVideoEnabled(true);
  }

  toggleVideo() {
    if (this.videoEnabled.get()) {
      return this.disableVideo();
    }

    return this.enableVideo();
  }

  stop() {
    this.active = false;
    this.monitor = false;
    this.remoteMonitoring = false;

    if (this.localStream != null && typeof this.localStream !== 'undefined') {
      this.localStream.getTracks().forEach(track => track.stop());
    }

    this.localUrl.set(undefined);
    delete this.localStream;
    this.stopAllPeerConnections();
  }
  /*
   		@param media {Object}
   			audio {Boolean}
   			video {Boolean}
    */


  startCall() {
    let media = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

    for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {
      args[_key4 - 1] = arguments[_key4];
    }

    this.log('startCall', [media, ...args]);
    this.media = media;
    this.getLocalUserMedia(() => {
      this.active = true;
      this.transport.startCall({
        media: this.media
      });
    });
  }

  startCallAsMonitor() {
    let media = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

    for (var _len5 = arguments.length, args = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {
      args[_key5 - 1] = arguments[_key5];
    }

    this.log('startCallAsMonitor', [media, ...args]);
    this.media = media;
    this.active = true;
    this.monitor = true;
    this.transport.startCall({
      media: this.media,
      monitor: true
    });
  }
  /*
   		@param data {Object}
   			from {String}
   			monitor {Boolean}
   			media {Object}
   				audio {Boolean}
   				video {Boolean}
    */


  onRemoteCall(data) {
    if (this.autoAccept === true) {
      Meteor.defer(() => {
        this.joinCall({
          to: data.from,
          monitor: data.monitor,
          media: data.media
        });
      });
      return;
    }

    const user = Meteor.users.findOne(data.from);
    let fromUsername = undefined;

    if (user && user.username) {
      fromUsername = user.username;
    }

    const subscription = ChatSubscription.findOne({
      rid: data.room
    });
    let icon;
    let title;

    if (data.monitor === true) {
      icon = 'eye';
      title = t('WebRTC_monitor_call_from_%s', fromUsername);
    } else if (subscription && subscription.t === 'd') {
      if (data.media && data.media.video) {
        icon = 'videocam';
        title = t('WebRTC_direct_video_call_from_%s', fromUsername);
      } else {
        icon = 'phone';
        title = t('WebRTC_direct_audio_call_from_%s', fromUsername);
      }
    } else if (data.media && data.media.video) {
      icon = 'videocam';
      title = t('WebRTC_group_video_call_from_%s', subscription.name);
    } else {
      icon = 'phone';
      title = t('WebRTC_group_audio_call_from_%s', subscription.name);
    }

    modal.open({
      title: "<i class='icon-".concat(icon, " alert-icon success-color'></i>").concat(title),
      text: t('Do_you_want_to_accept'),
      html: true,
      showCancelButton: true,
      confirmButtonText: t('Yes'),
      cancelButtonText: t('No')
    }, isConfirm => {
      if (isConfirm) {
        goToRoomById(data.room);
        return this.joinCall({
          to: data.from,
          monitor: data.monitor,
          media: data.media
        });
      }

      this.stop();
    });
  }
  /*
   		@param data {Object}
   			to {String}
   			monitor {Boolean}
   			media {Object}
   				audio {Boolean}
   				video {Boolean}
   				desktop {Boolean}
    */


  joinCall() {
    let data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    data.media = this.media;

    for (var _len6 = arguments.length, args = new Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {
      args[_key6 - 1] = arguments[_key6];
    }

    this.log('joinCall', [data, ...args]);
    this.getLocalUserMedia(() => {
      this.remoteMonitoring = data.monitor;
      this.active = true;
      this.transport.joinCall(data);
    });
  }

  onRemoteJoin(data) {
    if (this.active !== true) {
      return;
    }

    for (var _len7 = arguments.length, args = new Array(_len7 > 1 ? _len7 - 1 : 0), _key7 = 1; _key7 < _len7; _key7++) {
      args[_key7 - 1] = arguments[_key7];
    }

    this.log('onRemoteJoin', [data, ...args]);
    let peerConnection = this.getPeerConnection(data.from); // needsRefresh = false
    // if peerConnection.iceConnectionState isnt 'new'
    // needsAudio = data.media.audio is true and peerConnection.remoteMedia.audio isnt true
    // needsVideo = data.media.video is true and peerConnection.remoteMedia.video isnt true
    // needsRefresh = needsAudio or needsVideo or data.media.desktop isnt peerConnection.remoteMedia.desktop
    // # if peerConnection.signalingState is "have-local-offer" or needsRefresh

    if (peerConnection.signalingState !== 'checking') {
      this.stopPeerConnection(data.from);
      peerConnection = this.getPeerConnection(data.from);
    }

    if (peerConnection.iceConnectionState !== 'new') {
      return;
    }

    peerConnection.remoteMedia = data.media;

    if (this.localStream) {
      peerConnection.addStream(this.localStream);
    }

    const onOffer = offer => {
      const onLocalDescription = () => {
        this.transport.sendDescription({
          to: data.from,
          type: 'offer',
          ts: peerConnection.createdAt,
          media: this.media,
          description: {
            sdp: offer.sdp,
            type: offer.type
          }
        });
      };

      peerConnection.setLocalDescription(new RTCSessionDescription(offer), onLocalDescription, this.onError);
    };

    if (data.monitor === true) {
      peerConnection.createOffer(onOffer, this.onError, {
        mandatory: {
          OfferToReceiveAudio: data.media.audio,
          OfferToReceiveVideo: data.media.video
        }
      });
    } else {
      peerConnection.createOffer(onOffer, this.onError);
    }
  }

  onRemoteOffer(data) {
    if (this.active !== true) {
      return;
    }

    for (var _len8 = arguments.length, args = new Array(_len8 > 1 ? _len8 - 1 : 0), _key8 = 1; _key8 < _len8; _key8++) {
      args[_key8 - 1] = arguments[_key8];
    }

    this.log('onRemoteOffer', [data, ...args]);
    let peerConnection = this.getPeerConnection(data.from);

    if (['have-local-offer', 'stable'].includes(peerConnection.signalingState) && peerConnection.createdAt < data.ts) {
      this.stopPeerConnection(data.from);
      peerConnection = this.getPeerConnection(data.from);
    }

    if (peerConnection.iceConnectionState !== 'new') {
      return;
    }

    peerConnection.setRemoteDescription(new RTCSessionDescription(data.description));

    try {
      if (this.localStream) {
        peerConnection.addStream(this.localStream);
      }
    } catch (error) {
      console.log(error);
    }

    const onAnswer = answer => {
      const onLocalDescription = () => {
        this.transport.sendDescription({
          to: data.from,
          type: 'answer',
          ts: peerConnection.createdAt,
          description: {
            sdp: answer.sdp,
            type: answer.type
          }
        });
      };

      peerConnection.setLocalDescription(new RTCSessionDescription(answer), onLocalDescription, this.onError);
    };

    peerConnection.createAnswer(onAnswer, this.onError);
  }
  /*
   		@param data {Object}
   			to {String}
   			from {String}
   			candidate {RTCIceCandidate JSON encoded}
    */


  onRemoteCandidate(data) {
    var _this$remoteItems$get;

    if (this.active !== true) {
      return;
    }

    if (data.to !== this.selfId) {
      return;
    }

    for (var _len9 = arguments.length, args = new Array(_len9 > 1 ? _len9 - 1 : 0), _key9 = 1; _key9 < _len9; _key9++) {
      args[_key9 - 1] = arguments[_key9];
    }

    this.log('onRemoteCandidate', [data, ...args]);
    const peerConnection = this.getPeerConnection(data.from);

    if (peerConnection.iceConnectionState !== 'closed' && peerConnection.iceConnectionState !== 'failed' && peerConnection.iceConnectionState !== 'disconnected' && peerConnection.iceConnectionState !== 'completed') {
      peerConnection.addIceCandidate(new RTCIceCandidate(data.candidate));
    }

    document.querySelector('video#remoteVideo').srcObject = (_this$remoteItems$get = this.remoteItems.get()[0]) === null || _this$remoteItems$get === void 0 ? void 0 : _this$remoteItems$get.url;
  }
  /*
   		@param data {Object}
   			to {String}
   			from {String}
   			type {String} [offer, answer]
   			description {RTCSessionDescription JSON encoded}
   			ts {Integer}
   			media {Object}
   				audio {Boolean}
   				video {Boolean}
   				desktop {Boolean}
    */


  onRemoteDescription(data) {
    if (this.active !== true) {
      return;
    }

    if (data.to !== this.selfId) {
      return;
    }

    for (var _len10 = arguments.length, args = new Array(_len10 > 1 ? _len10 - 1 : 0), _key10 = 1; _key10 < _len10; _key10++) {
      args[_key10 - 1] = arguments[_key10];
    }

    this.log('onRemoteDescription', [data, ...args]);
    const peerConnection = this.getPeerConnection(data.from);

    if (data.type === 'offer') {
      peerConnection.remoteMedia = data.media;
      this.onRemoteOffer({
        from: data.from,
        ts: data.ts,
        description: data.description
      });
    } else {
      peerConnection.setRemoteDescription(new RTCSessionDescription(data.description));
    }
  }

}

const WebRTC = new class {
  constructor() {
    this.instancesByRoomId = {};
  }

  getInstanceByRoomId(rid) {
    let visitorId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    let enabled = false;

    if (!visitorId) {
      const subscription = ChatSubscription.findOne({
        rid
      });

      if (!subscription) {
        return;
      }

      switch (subscription.t) {
        case 'd':
          enabled = settings.get('WebRTC_Enable_Direct');
          break;

        case 'p':
          enabled = settings.get('WebRTC_Enable_Private');
          break;

        case 'c':
          enabled = settings.get('WebRTC_Enable_Channel');
          break;

        case 'l':
          enabled = settings.get('Omnichannel_call_provider') === 'WebRTC';
      }
    } else {
      enabled = settings.get('Omnichannel_call_provider') === 'WebRTC';
    }

    enabled = enabled && settings.get('WebRTC_Enabled');

    if (enabled === false) {
      return;
    }

    if (this.instancesByRoomId[rid] == null) {
      let uid = Meteor.userId();
      let autoAccept = false;

      if (visitorId) {
        uid = visitorId;
        autoAccept = true;
      }

      this.instancesByRoomId[rid] = new WebRTCClass(uid, rid, autoAccept);
    }

    return this.instancesByRoomId[rid];
  }

}();
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (Meteor.userId()) {
      Notifications.onUser(WEB_RTC_EVENTS.WEB_RTC, (type, data) => {
        if (data.room == null) {
          return;
        }

        const webrtc = WebRTC.getInstanceByRoomId(data.room);
        webrtc.onUserStream(type, data);
      });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"actionLink.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/actionLink.tsx                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 0);
let toastr;
module.link("toastr", {
  default(v) {
    toastr = v;
  }

}, 1);
let actionLinks;
module.link("../../action-links/client", {
  actionLinks(v) {
    actionLinks = v;
  }

}, 2);
let APIClient;
module.link("../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 3);
let Rooms;
module.link("../../models/client", {
  Rooms(v) {
    Rooms = v;
  }

}, 4);
let Notifications;
module.link("../../notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 5);
actionLinks.register('joinLivechatWebRTCCall', message => {
  const {
    callStatus,
    _id
  } = Rooms.findOne({
    _id: message.rid
  });

  if (callStatus === 'declined' || callStatus === 'ended') {
    toastr.info(TAPi18n.__('Call_Already_Ended'));
    return;
  }

  window.open("/meet/".concat(_id), _id);
});
actionLinks.register('endLivechatWebRTCCall', async message => {
  const {
    callStatus,
    _id
  } = Rooms.findOne({
    _id: message.rid
  });

  if (callStatus === 'declined' || callStatus === 'ended') {
    toastr.info(TAPi18n.__('Call_Already_Ended'));
    return;
  }

  await APIClient.v1.put("livechat/webrtc.call/".concat(message._id), {}, {
    rid: _id,
    status: 'ended'
  });
  Notifications.notifyRoom(_id, 'webrtc', 'callStatus', {
    callStatus: 'ended'
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"adapter.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/adapter.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
window.RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;
window.RTCSessionDescription = window.RTCSessionDescription || window.mozRTCSessionDescription || window.webkitRTCSessionDescription;
window.RTCIceCandidate = window.RTCIceCandidate || window.mozRTCIceCandidate || window.webkitRTCIceCandidate;
window.RTCSessionDescription = window.RTCSessionDescription || window.mozRTCSessionDescription || window.webkitRTCSessionDescription;
window.AudioContext = window.AudioContext || window.mozAudioContext || window.webkitAudioContext;
navigator.getUserMedia = navigator.getUserMedia || navigator.mozGetUserMedia || navigator.webkitGetUserMedia;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./adapter");
module.link("./tabBar");
module.link("./actionLink");
module.link("./WebRTCClass", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"screenShare.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/screenShare.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ChromeScreenShare: () => ChromeScreenShare
});
let fireGlobalEvent;
module.link("../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 0);
const ChromeScreenShare = {
  callbacks: {},
  installed: false,

  init() {
    this.callbacks['get-RocketChatScreenSharingExtensionVersion'] = version => {
      if (version) {
        this.installed = true;
      }
    };

    window.postMessage('get-RocketChatScreenSharingExtensionVersion', '*');
  },

  getSourceId(navigator, callback) {
    if (callback == null) {
      throw new Error('"callback" parameter is mandatory.');
    }

    this.callbacks.getSourceId = callback;

    if (navigator === 'electron') {
      return fireGlobalEvent('get-sourceId', '*');
    }

    return window.postMessage('get-sourceId', '*');
  }

};
ChromeScreenShare.init();
window.addEventListener('message', function (e) {
  if (e.origin !== window.location.origin) {
    return;
  }

  if (e.data === 'PermissionDeniedError') {
    if (ChromeScreenShare.callbacks.getSourceId != null) {
      return ChromeScreenShare.callbacks.getSourceId('PermissionDeniedError');
    }

    throw new Error('PermissionDeniedError');
  }

  if (e.data.version != null) {
    ChromeScreenShare.callbacks['get-RocketChatScreenSharingExtensionVersion'] && ChromeScreenShare.callbacks['get-RocketChatScreenSharingExtensionVersion'](e.data.version);
  } else if (e.data.sourceId != null) {
    return typeof ChromeScreenShare.callbacks.getSourceId === 'function' && ChromeScreenShare.callbacks.getSourceId(e.data.sourceId);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/tabBar.tsx                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo, useCallback;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  },

  useCallback(v) {
    useCallback = v;
  }

}, 0);
let useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 1);
let addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 2);
let APIClient;
module.link("../../utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 3);
addAction('webRTCVideo', _ref => {
  let {
    room
  } = _ref;
  const enabled = useSetting('WebRTC_Enabled') && useSetting('Omnichannel_call_provider') === 'WebRTC' && room.servedBy;
  const handleClick = useCallback(async () => {
    if (!room.callStatus || room.callStatus === 'declined' || room.callStatus === 'ended') {
      await APIClient.v1.get('livechat/webrtc.call', {
        rid: room._id
      });
    }

    window.open("/meet/".concat(room._id), room._id);
  }, [room._id, room.callStatus]);
  return useMemo(() => enabled ? {
    groups: ['live'],
    id: 'webRTCVideo',
    title: 'WebRTC_Call',
    icon: 'phone',
    action: handleClick,
    full: true,
    order: 4
  } : null, [enabled, handleClick]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/index.js                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  WEB_RTC_EVENTS: () => WEB_RTC_EVENTS
});
const WEB_RTC_EVENTS = {
  WEB_RTC: 'webrtc',
  STATUS: 'status',
  CALL: 'call',
  JOIN: 'join',
  CANDIDATE: 'candidate',
  DESCRIPTION: 'description'
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ee":{"app":{"livechat-enterprise":{"client":{"views":{"app":{"customTemplates":{"visitorEditCustomFieldsForm.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/visitorEditCustomFieldsForm.html                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.visitorEditCustomFieldsForm.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.visitorEditCustomFieldsForm.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/template.visitorEditCustomFieldsForm.js                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("visitorEditCustomFieldsForm");
Template["visitorEditCustomFieldsForm"] = new Template("Template.visitorEditCustomFieldsForm", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("showPriorities"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "form-group"
    }, "\n\t\t\t", HTML.LABEL({
      class: "rc-input__label"
    }, "\n\t\t\t\t", HTML.DIV({
      class: "rc-input__title"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Priority");
    })), "\n\t\t\t\t", HTML.DIV({
      class: "rc-select"
    }, "\n\t\t\t\t\t", HTML.SELECT({
      name: "priorityId",
      id: "prioritySelect",
      class: "rc-select__element customFormField"
    }, HTML.Raw('\n\t\t\t\t\t\t<option value=""></option>\n\t\t\t\t\t\t'), Blaze.Each(function() {
      return Spacebars.call(view.lookup("availablePriorities"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.OPTION({
        class: "rc-select__option",
        value: function() {
          return Spacebars.mustache(view.lookup("_id"));
        },
        selected: function() {
          return Spacebars.mustache(view.lookup("$eq"), view.lookup("priorityId"), view.lookup("_id"));
        }
      }, Blaze.View("lookup:name", function() {
        return Spacebars.mustache(view.lookup("name"));
      })), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-select__arrow"),
        icon: Spacebars.call("arrow-down")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"visitorInfoCustomForm.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/visitorInfoCustomForm.html                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.visitorInfoCustomForm.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.visitorInfoCustomForm.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/template.visitorInfoCustomForm.js                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("visitorInfoCustomForm");
Template["visitorInfoCustomForm"] = new Template("Template.visitorInfoCustomForm", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("priority"));
  }, function() {
    return HTML.LI(HTML.STRONG(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Priority");
    })), ": ", Blaze.View("lookup:priority.name", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("priority"), "name"));
    }), " ");
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"visitorEditCustomFieldsForm.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/visitorEditCustomFieldsForm.js                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let APIClient;
module.link("../../../../../../../app/utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 2);
module.link("./visitorEditCustomFieldsForm.html");
Template.visitorEditCustomFieldsForm.helpers({
  availablePriorities() {
    return Template.instance().priorities.get();
  },

  priorityId() {
    return Template.instance().roomPriority.get();
  },

  showPriorities() {
    return Template.instance().priorities.get().length > 0;
  }

});
Template.visitorEditCustomFieldsForm.onCreated(async function () {
  this.priorities = new ReactiveVar([]);
  this.roomPriority = new ReactiveVar(null);
  const {
    priorityId
  } = this.data;

  if (priorityId) {
    this.roomPriority.set(priorityId);
  }

  const {
    priorities
  } = await APIClient.v1.get('livechat/priorities.list');
  this.priorities.set(priorities);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"visitorInfoCustomForm.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/visitorInfoCustomForm.js                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
let APIClient;
module.link("../../../../../../../app/utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 2);
module.link("./visitorInfoCustomForm.html");
Template.visitorInfoCustomForm.helpers({
  priority() {
    return Template.instance().priority.get();
  }

});
Template.visitorInfoCustomForm.onCreated(function () {
  this.priority = new ReactiveVar(null);
  this.autorun(async () => {
    // To make this template reactive we expect a ReactiveVar through the data property,
    // because the parent form may not be rerender, only the dynamic template data
    const {
      priorityId = null
    } = this.data.get();
    let priority;

    if (priorityId) {
      priority = await APIClient.v1.get("livechat/priorities.getOne?priorityId=".concat(priorityId));
    }

    this.priority.set(priority);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"registerCustomTemplates.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/registerCustomTemplates.js                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let addCustomFormTemplate;
module.link("../../../../../../app/livechat/client/views/app/customTemplates/register", {
  addCustomFormTemplate(v) {
    addCustomFormTemplate = v;
  }

}, 0);
module.link("./customTemplates/visitorEditCustomFieldsForm");
module.link("./customTemplates/visitorInfoCustomForm");
addCustomFormTemplate('livechatDepartmentForm', 'livechatDepartmentCustomFieldsForm');
addCustomFormTemplate('livechatVisitorEditForm', 'visitorEditCustomFieldsForm');
addCustomFormTemplate('livechatVisitorInfo', 'visitorInfoCustomForm');
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"business-hours":{"Multiple.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/business-hours/Multiple.ts                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  MultipleBusinessHoursBehavior: () => MultipleBusinessHoursBehavior
});
let LivechatBusinessHourTypes;
module.link("../../../../../../definition/ILivechatBusinessHour", {
  LivechatBusinessHourTypes(v) {
    LivechatBusinessHourTypes = v;
  }

}, 0);

class MultipleBusinessHoursBehavior {
  getView() {
    return 'livechatBusinessHours';
  }

  showCustomTemplate(businessHourData) {
    return !businessHourData._id || businessHourData.type !== LivechatBusinessHourTypes.DEFAULT;
  }

  showTimezoneTemplate() {
    return true;
  }

  showBackButton() {
    return true;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"livechatSideNavItems.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/livechatSideNavItems.js                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let registerOmnichannelSidebarItem;
module.link("../../../../../client/views/omnichannel/sidebarItems", {
  registerOmnichannelSidebarItem(v) {
    registerOmnichannelSidebarItem = v;
  }

}, 0);
let hasPermission;
module.link("../../../../../app/authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 1);
registerOmnichannelSidebarItem({
  href: 'omnichannel-monitors',
  i18nLabel: 'Livechat_Monitors',
  permissionGranted: () => hasPermission('manage-livechat-monitors')
});
registerOmnichannelSidebarItem({
  href: 'omnichannel/units',
  i18nLabel: 'Units',
  permissionGranted: () => hasPermission('manage-livechat-units')
});
registerOmnichannelSidebarItem({
  href: 'omnichannel-canned-responses',
  i18nLabel: 'Canned_Responses',
  permissionGranted: () => hasPermission('manage-livechat-canned-responses')
});
registerOmnichannelSidebarItem({
  href: 'omnichannel/tags',
  i18nLabel: 'Tags',
  permissionGranted: () => hasPermission('manage-livechat-tags')
});
registerOmnichannelSidebarItem({
  href: 'omnichannel/priorities',
  i18nLabel: 'Priorities',
  permissionGranted: () => hasPermission('manage-livechat-priorities')
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"components":{"modals":{"PlaceChatOnHoldModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext"
]}},"SingleBusinessHour.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/SingleBusinessHour.ts                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  EESingleBusinessHourBehaviour: () => EESingleBusinessHourBehaviour
});
let SingleBusinessHourBehavior;
module.link("../../../../app/livechat/client/views/app/business-hours/Single", {
  SingleBusinessHourBehavior(v) {
    SingleBusinessHourBehavior = v;
  }

}, 0);

class EESingleBusinessHourBehaviour extends SingleBusinessHourBehavior {
  showTimezoneTemplate() {
    return true;
  }

}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/index.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let hasLicense;
module.link("../../license/client", {
  hasLicense(v) {
    hasLicense = v;
  }

}, 0);
module.link("../lib/messageTypes");
module.link("./route");
module.link("./startup");
hasLicense('livechat-enterprise').then(enabled => {
  if (!enabled) {
    return;
  }

  require('./views/app/registerCustomTemplates');

  require('./views/livechatSideNavItems');

  require('./views/business-hours/Multiple');

  require('../lib/QuickActions/defaultActions');

  require('./messageTypes');
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageTypes.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/messageTypes.ts                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 0);
let MessageTypes;
module.link("../../../../app/ui-utils/client", {
  MessageTypes(v) {
    MessageTypes = v;
  }

}, 1);
MessageTypes.registerType({
  id: 'livechat_transfer_history_fallback',
  system: true,
  message: 'New_chat_transfer_fallback',

  data(message) {
    if (!message.transferData) {
      return;
    }

    const from = message.transferData.prevDepartment;
    const to = message.transferData.department.name;
    return {
      fallback: TAPi18n.__('Livechat_transfer_failed_fallback', {
        from,
        to
      })
    };
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"route.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/route.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let AccountBox;
module.link("../../../../app/ui-utils", {
  AccountBox(v) {
    AccountBox = v;
  }

}, 0);
let livechatManagerRoutes, load;
module.link("../../../../app/livechat/client/route", {
  livechatManagerRoutes(v) {
    livechatManagerRoutes = v;
  },

  load(v) {
    load = v;
  }

}, 1);
AccountBox.addRoute({
  name: 'livechat-tag-edit',
  path: '/tags/:_id/edit',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Edit_Tag',
  pageTemplate: 'livechatTagForm'
}, livechatManagerRoutes);
AccountBox.addRoute({
  name: 'livechat-tag-new',
  path: '/tags/new',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'New_Tag',
  pageTemplate: 'livechatTagForm'
}, livechatManagerRoutes);
AccountBox.addRoute({
  name: 'livechat-priority-edit',
  path: '/priorities/:_id/edit',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Edit_Priority',
  pageTemplate: 'livechatPriorityForm'
}, livechatManagerRoutes);
AccountBox.addRoute({
  name: 'livechat-priority-new',
  path: '/priorities/new',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'New_Priority',
  pageTemplate: 'livechatPriorityForm'
}, livechatManagerRoutes);
AccountBox.addRoute({
  name: 'livechat-business-hour-edit',
  path: '/business-hours/:_id/:type/edit',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Edit_Business_Hour',
  pageTemplate: 'livechatBusinessHoursForm'
}, livechatManagerRoutes, load);
AccountBox.addRoute({
  name: 'livechat-business-hour-new',
  path: '/business-hours/new',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'New_Business_Hour',
  pageTemplate: 'livechatBusinessHoursForm'
}, livechatManagerRoutes, load);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"startup.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/startup.ts                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let MultipleBusinessHoursBehavior;
module.link("./views/business-hours/Multiple", {
  MultipleBusinessHoursBehavior(v) {
    MultipleBusinessHoursBehavior = v;
  }

}, 1);
let settings;
module.link("../../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 2);
let businessHourManager;
module.link("../../../../app/livechat/client/views/app/business-hours/BusinessHours", {
  businessHourManager(v) {
    businessHourManager = v;
  }

}, 3);
let EESingleBusinessHourBehaviour;
module.link("./SingleBusinessHour", {
  EESingleBusinessHourBehaviour(v) {
    EESingleBusinessHourBehaviour = v;
  }

}, 4);
let hasLicense;
module.link("../../license/client", {
  hasLicense(v) {
    hasLicense = v;
  }

}, 5);
const businessHours = {
  Multiple: new MultipleBusinessHoursBehavior(),
  Single: new EESingleBusinessHourBehaviour()
};
Meteor.startup(function () {
  settings.onload('Livechat_business_hour_type', async (_, value) => {
    if (await hasLicense('livechat-enterprise')) {
      businessHourManager.registerBusinessHourBehavior(businessHours[value]);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"QuickActions":{"defaultActions.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/lib/QuickActions/defaultActions.ts                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let addAction, QuickActionsEnum;
module.link("../../../../../client/views/room/lib/QuickActions", {
  addAction(v) {
    addAction = v;
  },

  QuickActionsEnum(v) {
    QuickActionsEnum = v;
  }

}, 0);
addAction(QuickActionsEnum.OnHoldChat, {
  groups: ['live'],
  id: QuickActionsEnum.OnHoldChat,
  title: 'Omnichannel_onHold_Chat',
  icon: 'pause-unfilled',
  order: 4
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"messageTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/lib/messageTypes.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 0);
let MessageTypes;
module.link("../../../../app/ui-utils", {
  MessageTypes(v) {
    MessageTypes = v;
  }

}, 1);
MessageTypes.registerType({
  id: 'livechat_priority_history',
  system: true,
  message: 'New_chat_priority',

  data(message) {
    if (!message.priorityData) {
      return;
    }

    const {
      definedBy: {
        username
      },
      priority: {
        name = null
      } = {}
    } = message.priorityData;
    return {
      user: username,
      priority: name || TAPi18n.__('Without_priority')
    };
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"auditing":{"client":{"templates":{"audit":{"audit.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/templates/audit/audit.html                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.audit.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.audit.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/templates/audit/template.audit.js                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("audit");
Template["audit"] = new Template("Template.audit", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isLoading"));
  }, function() {
    return [ "\n\t\t", Blaze._TemplateWith(function() {
      return {
        class: Spacebars.call("loading-animation--primary")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("loading"));
    }), "\n\t" ];
  }, function() {
    return [ "\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("hasResults"));
    }, function() {
      return [ "\n\t\t\t", HTML.UL({
        "aria-live": "polite"
      }, "\n\t\t\t\t", Spacebars.With(function() {
        return Spacebars.call(view.lookup("messageContext"));
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(view.lookup("messages")),
            _variable: "msg"
          };
        }, function() {
          return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
            return Spacebars.dataMustache(view.lookup("nrrargs"), "message", Spacebars.kw({
              shouldCollapseReplies: true,
              msg: view.lookup("msg"),
              room: view.lookup("room"),
              subscription: view.lookup("subscription"),
              settings: view.lookup("settings"),
              u: view.lookup("u")
            }));
          }, function() {
            return Spacebars.include(view.lookupTemplate("nrr"));
          }), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\t\t" ];
    }, function() {
      return [ "\n\t\t\t", Blaze._TemplateWith(function() {
        return {
          class: Spacebars.call("rc-audit-empty")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("roomSearchEmpty"));
      }), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"audit.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/templates/audit/audit.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 2);
let hasAllPermission;
module.link("../../../../../../app/authorization/client", {
  hasAllPermission(v) {
    hasAllPermission = v;
  }

}, 3);
let messageContext;
module.link("../../../../../../app/ui-utils/client/lib/messageContext", {
  messageContext(v) {
    messageContext = v;
  }

}, 4);
let call;
module.link("../../utils.js", {
  call(v) {
    call = v;
  }

}, 5);
module.link("./audit.html");

const loadMessages = async function (_ref) {
  let {
    rid,
    users,
    startDate,
    endDate = new Date(),
    msg,
    type,
    visitor,
    agent
  } = _ref;
  this.messages = this.messages || new ReactiveVar([]);
  this.loading = this.loading || new ReactiveVar(true);

  try {
    this.loading.set(true);
    const messages = type === 'l' ? await call('auditGetOmnichannelMessages', {
      rid,
      users,
      startDate,
      endDate,
      msg,
      type,
      visitor,
      agent
    }) : await call('auditGetMessages', {
      rid,
      users,
      startDate,
      endDate,
      msg,
      type,
      visitor,
      agent
    });
    this.messagesContext.set(_objectSpread(_objectSpread({}, messageContext({
      rid
    })), {}, {
      messages
    }));
  } catch (e) {
    this.messagesContext.set({});
  } finally {
    this.loading.set(false);
  }
};

Template.audit.helpers({
  isLoading() {
    return Template.instance().loading.get();
  },

  messageContext() {
    return Template.instance().messagesContext.get();
  },

  hasResults() {
    return Template.instance().hasResults.get();
  }

});
Template.audit.onCreated(async function () {
  this.messagesContext = new ReactiveVar({});
  this.loading = new ReactiveVar(false);
  this.hasResults = new ReactiveVar(false);

  if (!hasAllPermission('can-audit')) {
    return FlowRouter.go('/home');
  }

  this.autorun(() => {
    const messagesContext = this.messagesContext.get();
    this.hasResults.set(messagesContext && messagesContext.messages && messagesContext.messages.length > 0);
  });
  this.loadMessages = loadMessages.bind(this);
  const {
    visitor,
    agent,
    users,
    rid
  } = this.data;

  if (rid || users.length || agent || visitor) {
    await this.loadMessages(this.data);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/templates/index.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./audit/audit.js");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/index.css                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let hasLicense;
module.link("../../license/client", {
  hasLicense(v) {
    hasLicense = v;
  }

}, 0);
let AccountBox;
module.link("../../../../app/ui-utils/client", {
  AccountBox(v) {
    AccountBox = v;
  }

}, 1);
let hasAllPermission;
module.link("../../../../app/authorization/client", {
  hasAllPermission(v) {
    hasAllPermission = v;
  }

}, 2);
hasLicense('auditing').then(enabled => {
  if (!enabled) {
    return;
  }

  require('./templates');

  require('./index.css');

  AccountBox.addItem({
    href: 'audit-home',
    name: 'Message_auditing',
    icon: 'document-eye',
    condition: () => hasAllPermission('can-audit')
  });
  AccountBox.addItem({
    href: 'audit-log',
    name: 'Message_auditing_log',
    icon: 'document-eye',
    condition: () => hasAllPermission('can-audit-log')
  });
}).catch(error => {
  console.error('Error checking license.', error);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"utils.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/utils.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  convertDate: () => convertDate,
  scrollTo: () => scrollTo
});
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: "call"
}, 0);

const convertDate = date => {
  const [y, m, d] = date.split('-');
  return new Date(y, m - 1, d);
};

const scrollTo = function scrollTo(element, to, duration) {
  if (duration <= 0) {
    return;
  }

  const difference = to - element.scrollTop;
  const perTick = difference / duration * 10;
  setTimeout(function () {
    element.scrollTop += perTick;

    if (element.scrollTop === to) {
      return;
    }

    scrollTo(element, to, duration - 10);
  }, 10);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"canned-responses":{"client":{"views":{"popup":{"messagePopupCannedResponse.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/popup/messagePopupCannedResponse.html                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupCannedResponse.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupCannedResponse.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/popup/template.messagePopupCannedResponse.js                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupCannedResponse");
Template["messagePopupCannedResponse"] = new Template("Template.messagePopupCannedResponse", (function() {
  var view = this;
  return HTML.DIV({
    class: "popup-canned-response"
  }, "\n\t\t", HTML.DIV({
    class: "popup-canned-response-format"
  }, HTML.STRONG("!", Blaze.View("lookup:shortcut", function() {
    return Spacebars.mustache(view.lookup("shortcut"));
  }))), "\n\t\t", HTML.DIV({
    class: "popup-canned-response-description"
  }, Blaze.View("lookup:text", function() {
    return Spacebars.mustache(view.lookup("text"));
  })), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"addMessagePopupCannedResponse.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/popup/addMessagePopupCannedResponse.js                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let CannedResponse;
module.link("../../collections/CannedResponse", {
  CannedResponse(v) {
    CannedResponse = v;
  }

}, 2);
let addMessagePopup, removeMessagePopup;
module.link("../../../../../../app/ui-message/client/popup/customMessagePopups", {
  addMessagePopup(v) {
    addMessagePopup = v;
  },

  removeMessagePopup(v) {
    removeMessagePopup = v;
  }

}, 3);
let t;
module.link("../../../../../../app/utils", {
  t(v) {
    t = v;
  }

}, 4);
let settings;
module.link("../../../../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 5);
Tracker.autorun(() => {
  const templateFunc = template => ({
    title: t('Canned_Responses'),
    collection: CannedResponse,
    trigger: '!',
    prefix: '',
    suffix: ' ',
    triggerAnywhere: true,
    template: 'messagePopupCannedResponse',
    rid: template.data.rid,
    getInput: template.data.getInput,
    textFilterDelay: 500,
    getFilter: (collection, filter) => {
      const exp = new RegExp(filter, 'i');
      const records = collection.find({
        shortcut: exp
      }, {
        reactive: 1,
        limit: 12,
        sort: {
          shortcut: -1
        }
      }).fetch();
      return records;
    },
    getValue: (_id, collection, records) => {
      const record = _.findWhere(records, {
        _id
      });

      return record && record.text;
    }
  });

  const settingValue = settings.get('Canned_Responses_Enable');

  if (settingValue) {
    addMessagePopup(templateFunc, 'cannedResponses');
  } else {
    removeMessagePopup('cannedResponses');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"tabbar":{"cannedResponses.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/cannedResponses.html                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.cannedResponses.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.cannedResponses.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/template.cannedResponses.js                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("cannedResponses");
Template["cannedResponses"] = new Template("Template.cannedResponses", (function() {
  var view = this;
  return Blaze._TemplateWith(function() {
    return "view-canned-responses";
  }, function() {
    return Spacebars.include(view.lookupTemplate("requiresPermission"), function() {
      return [ "\n\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isDetailScreen"));
      }, function() {
        return [ "\n\t\t\t", Spacebars.With(function() {
          return Spacebars.call(view.lookup("cannedResponse"));
        }, function() {
          return [ "\n\t\t\t\t", HTML.UL({
            class: "canned-response-list"
          }, "\n\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("isExistingResponse"));
          }, function() {
            return [ "\n\t\t\t\t\t\t", HTML.LI("\n\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-form-wrapper"
            }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-creator-data"
            }, HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="canned-response-label">Created by</div>\n\t\t\t\t\t\t\t\t\t'), HTML.DIV({
              class: "canned-response-created-by canned-response-info"
            }, Blaze.View("lookup:createdByString", function() {
              return Spacebars.mustache(view.lookup("createdByString"));
            })), "\n\t\t\t\t\t\t\t\t"), "\n\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(view.lookup("canDeleteResponse"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
                class: "canned-response-delete-button"
              }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
                return {
                  block: Spacebars.call("rc-header__icon"),
                  icon: Spacebars.call("trash")
                };
              }, function() {
                return Spacebars.include(view.lookupTemplate("icon"));
              }), "\n\t\t\t\t\t\t\t\t\t\t", HTML.A({
                href: "#",
                class: "delete-canned-response",
                "data-id": function() {
                  return Spacebars.mustache(view.lookup("_id"));
                }
              }, Blaze.View("lookup:_", function() {
                return Spacebars.mustache(view.lookup("_"), "Delete");
              })), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
          }), "\n\n\t\t\t\t\t", HTML.LI("\n\t\t\t\t\t\t", HTML.DIV({
            class: "canned-response-form-wrapper"
          }, "\n\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("canModifyResponse"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", HTML.FIELDSET("\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
              type: "hidden",
              name: "id",
              value: function() {
                return Spacebars.mustache(view.lookup("_id"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input"
            }, "\n\t\t\t\t\t\t\t\t\t\t", HTML.LABEL({
              class: "rc-input__label"
            }, "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input__title"
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Shortcut");
            })), "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input__wrapper"
            }, HTML.Raw('\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="rc-input__icon canned-response-shortcut-prefix">!</div>\n\t\t\t\t\t\t\t\t\t\t\t\t'), HTML.INPUT({
              class: "rc-input__element",
              type: "text",
              name: "shortcut",
              autocomplete: "off",
              value: function() {
                return Spacebars.mustache(view.lookup("shortcut"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input"
            }, "\n\t\t\t\t\t\t\t\t\t\t", HTML.LABEL({
              class: "rc-input__label"
            }, "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input__title"
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Text");
            })), "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input__wrapper"
            }, "\n\t\t\t\t\t\t\t\t\t\t\t\t", HTML.TEXTAREA({
              class: "rc-input__element",
              name: "text",
              rows: "8",
              style: "height: auto",
              value: function() {
                return Spacebars.mustache(view.lookup("text"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t"), "\n\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-button__group"
            }, "\n\t\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
              class: "rc-button rc-button--primary save-canned-response-btn"
            }, HTML.SPAN(Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Save");
            }))), "\n\t\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
              class: "rc-button rc-button--secondary cancel-canned-response-btn"
            }, HTML.SPAN(Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Cancel");
            }))), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-shortcut-preview"
            }, "! ", Blaze.View("lookup:shortcut", function() {
              return Spacebars.mustache(view.lookup("shortcut"));
            })), "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-text-preview"
            }, Blaze.View("lookup:text", function() {
              return Spacebars.mustache(view.lookup("text"));
            })), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
        }), "\n\n\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("isUserContext"));
        }, function() {
          return [ "\n\t\t\t\t", HTML.DIV({
            class: "rc-button__group canned-response-buttons"
          }, "\n\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("isExistingResponse"));
          }, function() {
            return [ "\n\t\t\t\t\t\t", HTML.A({
              href: "#",
              class: "rc-button rc-button--primary use-canned-response-btn"
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Use_this_response");
            })), "\n\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(view.lookup("isPreviewMode"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
                class: "rc-button rc-button--secondary cancel-canned-response-btn"
              }, HTML.SPAN(Blaze.View("lookup:_", function() {
                return Spacebars.mustache(view.lookup("_"), "Cancel");
              }))), "\n\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t" ];
          }), "\n\t\t\t\t"), "\n\t\t\t" ];
        }), "\n\t\t" ];
      }, function() {
        return [ "\n\n\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("hasNoCannedResponses"));
        }, function() {
          return [ "\n\t\t\t\t", HTML.H2({
            class: "thread-empty"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), "No_Canned_Responses");
          })), "\n\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t", HTML.DIV({
            class: "canned-response-list-wrapper"
          }, "\n\t\t\t\t\t", HTML.UL({
            class: "canned-response-list"
          }, "\n\n\t\t\t\t\t\t", HTML.LI({
            class: "canned-response-search-item"
          }, "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "canned-response-wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__icon"
          }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
            return {
              block: Spacebars.call("rc-input__icon-svg"),
              icon: Spacebars.call("magnifier")
            };
          }, function() {
            return Spacebars.include(view.lookupTemplate("icon"));
          }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t", HTML.INPUT({
            type: "text",
            class: "rc-input__element js-search",
            name: "response-search",
            id: "response-search",
            placeholder: function() {
              return Spacebars.mustache(view.lookup("_"), "Search");
            },
            autocomplete: "off",
            value: function() {
              return Spacebars.mustache(view.lookup("searchText"));
            }
          }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\n\t\t\t\t\t", Blaze.Each(function() {
            return Spacebars.call(view.lookup("cannedResponses"));
          }, function() {
            return [ "\n\t\t\t\t\t\t", HTML.LI({
              "data-id": function() {
                return Spacebars.mustache(view.lookup("_id"));
              },
              class: "canned-response"
            }, "\n\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-wrapper"
            }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-shortcut"
            }, Blaze.View("lookup:shortcut", function() {
              return Spacebars.mustache(view.lookup("shortcut"));
            })), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-text"
            }, Blaze.View("lookup:text", function() {
              return Spacebars.mustache(view.lookup("text"));
            })), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-scope"
            }, Blaze.View("lookup:scope", function() {
              return Spacebars.mustache(view.lookup("scope"));
            })), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
          }), "\n\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
        }), "\n\n\t\t\t", HTML.DIV({
          class: "rc-button__group canned-response-buttons"
        }, "\n\t\t\t\t", HTML.A({
          href: "#",
          class: "rc-button rc-button--primary new-canned-response-btn"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "New_Canned_Response");
        })), "\n\t\t\t"), "\n\t\t" ];
      }), "\n\n\t" ];
    });
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"departmentCannedResponses.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/departmentCannedResponses.html                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.departmentCannedResponses.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.departmentCannedResponses.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/template.departmentCannedResponses.js                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("departmentCannedResponses");
Template["departmentCannedResponses"] = new Template("Template.departmentCannedResponses", (function() {
  var view = this;
  return Blaze._TemplateWith(function() {
    return {
      context: Spacebars.call("department"),
      departmentId: Spacebars.call(view.lookup("departmentId"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("cannedResponses"));
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"cannedResponses.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/cannedResponses.js                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 2);
let CannedResponse;
module.link("../../collections/CannedResponse", {
  CannedResponse(v) {
    CannedResponse = v;
  }

}, 3);
let t;
module.link("../../../../../../app/utils", {
  t(v) {
    t = v;
  }

}, 4);
let chatMessages;
module.link("../../../../../../app/ui/client", {
  chatMessages(v) {
    chatMessages = v;
  }

}, 5);
let handleError;
module.link("../../../../../../client/lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 6);
let dispatchToastMessage;
module.link("../../../../../../client/lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 7);
module.link("./cannedResponses.html");
Template.cannedResponses.helpers({
  cannedResponses() {
    const searchText = Template.instance().searchText.get().toLocaleLowerCase();
    let query = {};

    if (Template.instance().context.get() === 'department') {
      query = {
        scope: 'department',
        departmentId: Template.instance().departmentId
      };
    }

    if (searchText) {
      const regex = new RegExp(searchText, 'i');
      query.$or = [{
        shortcut: {
          $regex: regex
        }
      }, {
        text: {
          $regex: regex
        }
      }];
    }

    return CannedResponse.find(query);
  },

  hasNoCannedResponses() {
    return CannedResponse.find().count() === 0;
  },

  isDetailScreen() {
    return ['edit', 'new', 'view'].includes(Template.instance().action.get());
  },

  isNewResponse() {
    return Template.instance().action.get() === 'new';
  },

  isExistingResponse() {
    return ['edit', 'view'].includes(Template.instance().action.get());
  },

  isUserContext() {
    return Template.instance().context.get() === 'user';
  },

  searchText() {
    return Template.instance().searchText.get();
  },

  isDepartmentContext() {
    return Template.instance().context.get() === 'department';
  },

  cannedResponse() {
    return Template.instance().cannedResponse.get();
  },

  canDeleteResponse() {
    const action = Template.instance().action.get();

    if (action !== 'edit') {
      return false;
    }

    const response = Template.instance().cannedResponse.get();
    const context = Template.instance().context.get();
    return response.scope === context;
  },

  canModifyResponse() {
    const action = Template.instance().action.get();

    if (action === 'new') {
      return true;
    }

    const response = Template.instance().cannedResponse.get();
    const context = Template.instance().context.get();
    return response.scope === context;
  },

  createdByString() {
    const username = this.createdBy;
    const me = Meteor.users.findOne(Meteor.userId());

    if (me.username === username) {
      return t('Me');
    }

    return username;
  },

  isPreviewMode() {
    return Template.instance().action.get() === 'view';
  }

});
Template.cannedResponses.events({
  'click .new-canned-response-btn'(e, instance) {
    e.preventDefault();
    e.stopPropagation();
    instance.cannedResponse.set({
      shortcut: '',
      text: ''
    });
    instance.action.set('new');
  },

  'click .canned-response'(e, instance) {
    e.preventDefault();
    e.stopPropagation();
    const {
      _id
    } = this;
    const cannedResponse = CannedResponse.findOne({
      _id
    });

    if (!cannedResponse) {
      dispatchToastMessage({
        type: 'success',
        message: t('Invalid Canned Response')
      });
    }

    instance.cannedResponse.set(cannedResponse);
    const canEdit = instance.context.get() === cannedResponse.scope;
    instance.action.set(canEdit ? 'edit' : 'view');
  },

  'click .delete-canned-response'(e, instance) {
    e.preventDefault();
    e.stopPropagation();

    const _id = instance.$('input[name=id]').val();

    Meteor.call('removeCannedResponse', _id, error => {
      if (error) {
        return handleError(error);
      }

      dispatchToastMessage({
        type: 'success',
        message: t('Canned_Response_Removed')
      });
      instance.action.set(null);
    });
  },

  'click .cancel-canned-response-btn'(e, instance) {
    e.preventDefault();
    e.stopPropagation();
    instance.action.set(null);
  },

  'click .use-canned-response-btn'(e, instance) {
    e.preventDefault();
    e.stopPropagation();
    const {
      rid
    } = Template.currentData();

    if (!rid) {
      return;
    }

    const object = instance.cannedResponse.get();
    const {
      input
    } = chatMessages[rid];
    const {
      text
    } = object;

    if (document.selection) {
      input.focus();
      const sel = document.selection.createRange();
      sel.text = text;
      return;
    }

    if (input.selectionStart || input.selectionStart === 0) {
      const startPos = input.selectionStart;
      const endPos = input.selectionEnd;
      const prefix = input.value.substring(0, startPos);
      const suffix = input.value.substring(endPos, input.value.length);
      input.value = "".concat(prefix).concat(text).concat(suffix);
      input.selectionStart = startPos + text.length;
      input.selectionEnd = startPos + text.length;
      input.focus();
      instance.action.set(null);
      return;
    }

    input.value += text;
  },

  'click .save-canned-response-btn'(e, instance) {
    e.preventDefault();
    e.stopPropagation();

    const _id = instance.$('input[name=id]').val();

    const shortcut = instance.$('input[name=shortcut]').val();
    const text = instance.$('textarea[name=text]').val();
    const responseData = {
      shortcut,
      text
    };
    const context = instance.context.get();

    if (context === 'department') {
      if (!instance.departmentId) {
        dispatchToastMessage({
          type: 'error',
          message: t('Invalid_Department')
        });
        return;
      }

      responseData.scope = 'department';
      responseData.departmentId = instance.departmentId;
    } else {
      responseData.scope = 'user';
    }

    Meteor.call('saveCannedResponse', _id, responseData, function (error
    /* , result*/
    ) {
      if (error) {
        return handleError(error);
      }

      dispatchToastMessage({
        type: 'success',
        message: t('Saved')
      });
      instance.action.set(null);
    });
  },

  'keyup .js-search'(event, instance) {
    instance.searchText.set(event.currentTarget.value || '');
  }

});
Template.cannedResponses.onCreated(function () {
  this.action = new ReactiveVar();
  this.context = new ReactiveVar();
  this.cannedResponse = new ReactiveVar();
  this.searchText = new ReactiveVar('');
  this.departmentId = null;

  if (this.data && this.data.context) {
    this.context.set(this.data.context);

    if (this.data.context === 'department') {
      this.departmentId = this.data.departmentId;
    }
  } else {
    this.context.set('user');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"departmentCannedResponses.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/departmentCannedResponses.js                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 1);
module.link("./departmentCannedResponses.html");
Template.departmentCannedResponses.helpers({
  departmentId() {
    return FlowRouter.getParam('_id');
  }

});
Template.departmentCannedResponses.events({});
Template.departmentCannedResponses.onCreated(function () {});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"icons.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/icons.html                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.icons.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.icons.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/template.icons.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.body.addContent((function() {
  var view = this;
  return HTML.SVG({
    xmlns: "http://www.w3.org/2000/svg",
    "xmlns:xlink": "http://www.w3.org/1999/xlink",
    style: "display:none"
  }, "\n\t    ", HTML.SYMBOL({
    id: "icon-canned-response",
    viewBox: "0 0 25 23",
    "xml:space": "preserve"
  }, "\n\t        ", HTML.PATH({
    d: "M12.6889524,19.36425 C17.769052,19.381125 19.3479714,18.5475 19.8178072,18.00975 C19.7026071,17.941125 19.560301,17.866875 19.4496186,17.8095 C18.7347001,17.43375 17.055263,16.552875 17.9090992,14.723625 C17.996064,14.5155 18.1090053,14.273625 18.223076,14.028375 C18.5517352,13.3275 18.8623238,12.66375 18.8623238,12 C18.8623238,7.93875 15.5384614,4.634625 11.4533746,4.634625 C7.36828776,4.634625 4.04442532,7.93875 4.04442532,12 C4.04442532,16.267125 7.59304095,19.36425 12.4822698,19.36425 L12.6889524,19.36425 Z M20.2176194,16.363875 C20.8015259,16.669875 22.0145155,17.306625 21.4577149,18.483375 C20.4039725,20.712 16.1404385,21 12.9137056,21 L12.6810465,21 L12.4822698,20.998875 C6.64094579,20.998875 2.4,17.214375 2.4,12 C2.4,7.0365 6.46136913,3 11.4533746,3 C16.44538,3 20.5078785,7.0365 20.5078785,12 C20.5078785,13.026 20.0866075,13.926 19.7139012,14.719125 C19.6099952,14.941875 19.5072186,15.162375 19.4157362,15.3795 C19.2553595,15.726 19.2067948,15.83175 20.2176194,16.363875 Z M10.5,7.66036163 C10.5,7.20154045 10.9029437,6.8295924 11.4,6.8295924 C11.8970563,6.8295924 12.3,7.20154045 12.3,7.66036163 L12.18,11.9988232 C12.18,12.4576443 11.8970563,12.8295924 11.4,12.8295924 C10.9029437,12.8295924 10.62,12.4576443 10.62,11.9988232 L10.5,7.66036163 Z M11.4,16.08 C10.7372583,16.08 10.2,15.5427417 10.2,14.88 C10.2,14.2172583 10.7372583,13.68 11.4,13.68 C12.0627417,13.68 12.6,14.2172583 12.6,14.88 C12.6,15.5427417 12.0627417,16.08 11.4,16.08 Z",
    id: "path-1"
  }), "\n\t    "), "\n\t");
}));
Meteor.startup(Template.body.renderToDocument);

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"collections":{"CannedResponse.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/collections/CannedResponse.js                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CannedResponse: () => CannedResponse
});
let Mongo;
module.link("meteor/mongo", {
  Mongo(v) {
    Mongo = v;
  }

}, 0);
const CannedResponse = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"startup":{"responses.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/startup/responses.js                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let hasPermission;
module.link("../../../../../app/authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 2);
let settings;
module.link("../../../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let APIClient;
module.link("../../../../../app/utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 4);
let CannedResponse;
module.link("../collections/CannedResponse", {
  CannedResponse(v) {
    CannedResponse = v;
  }

}, 5);
let cannedResponsesStreamer;
module.link("../streamer", {
  cannedResponsesStreamer(v) {
    cannedResponsesStreamer = v;
  }

}, 6);
const events = {
  changed: response => {
    delete response.type;
    CannedResponse.upsert({
      _id: response._id
    }, response);
  },
  removed: response => CannedResponse.remove({
    _id: response._id
  })
};
Meteor.startup(() => {
  Tracker.autorun(async c => {
    if (!Meteor.userId()) {
      return;
    }

    if (!settings.get('Canned_Responses_Enable')) {
      return;
    }

    if (!hasPermission('view-canned-responses')) {
      return;
    }

    try {
      cannedResponsesStreamer.on('canned-responses', (response, options) => {
        const {
          agentsId
        } = options || {};

        if (Array.isArray(agentsId) && !agentsId.includes(Meteor.userId())) {
          return;
        }

        events[response.type](response);
      });
      const {
        responses
      } = await APIClient.v1.get('canned-responses.get');
      responses.forEach(response => CannedResponse.insert(response));
      c.stop();
    } catch (error) {
      console.log(error);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"stylesheets":{"cannedResponses.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/stylesheets/cannedResponses.css                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/index.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./tabBar");
module.link("./startup/responses");
module.link("./stylesheets/cannedResponses.css");
module.link("./views/icons.html");
module.link("./views/tabbar/cannedResponses");
module.link("./views/tabbar/departmentCannedResponses");
module.link("./views/popup/addMessagePopupCannedResponse");
module.link("./views/popup/messagePopupCannedResponse.html");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"streamer.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/streamer.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  cannedResponsesStreamer: () => cannedResponsesStreamer
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
const cannedResponsesStreamer = new Meteor.Streamer('canned-responses');
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/tabBar.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let lazy, useMemo;
module.link("react", {
  lazy(v) {
    lazy = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 0);
let useHasLicense;
module.link("../../../client/hooks/useHasLicense", {
  useHasLicense(v) {
    useHasLicense = v;
  }

}, 1);
let useSetting;
module.link("../../../../client/contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 2);
let addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 3);
addAction('canned-responses', () => {
  const hasLicense = useHasLicense('canned-responses');
  const enabled = useSetting('Canned_Responses_Enable');
  return useMemo(() => hasLicense && enabled ? {
    groups: ['live'],
    id: 'canned-responses',
    title: 'Canned_Responses',
    icon: 'canned-response',
    template: /*#__PURE__*/lazy(() => module.dynamicImport('../../../client/omnichannel/components/contextualBar/CannedResponse')),
    order: 0
  } : null, [hasLicense, enabled]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"authorization":{"lib":{"addRoleRestrictions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/authorization/lib/addRoleRestrictions.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  addRoleRestrictions: () => addRoleRestrictions
});
let AuthorizationUtils;
module.link("../../../../app/authorization/lib/AuthorizationUtils", {
  AuthorizationUtils(v) {
    AuthorizationUtils = v;
  }

}, 0);
let guestPermissions;
module.link("./guestPermissions", {
  guestPermissions(v) {
    guestPermissions = v;
  }

}, 1);

const addRoleRestrictions = function () {
  AuthorizationUtils.addRolePermissionWhiteList('guest', guestPermissions);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"guestPermissions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/authorization/lib/guestPermissions.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  guestPermissions: () => guestPermissions
});
const guestPermissions = ['view-d-room', 'view-joined-room', 'view-p-room', 'start-discussion'];
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/authorization/client/index.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let addRoleRestrictions;
module.link("../lib/addRoleRestrictions", {
  addRoleRestrictions(v) {
    addRoleRestrictions = v;
  }

}, 1);
Meteor.startup(() => {
  Meteor.call('license:isEnterprise', (err, result) => {
    if (err) {
      throw err;
    }

    if (result) {
      addRoleRestrictions();
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ecdh":{"client":{"ClientSession.ts":[
  "../Session"
]},"Session.ts":[
  "sodium-plus"
]},"license":{"client":{"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/license/client/index.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  hasLicense: () => hasLicense
});
let fetchFeatures;
module.link("../../../client/lib/fetchFeatures", {
  fetchFeatures(v) {
    fetchFeatures = v;
  }

}, 0);
let queryClient;
module.link("../../../../client/lib/queryClient", {
  queryClient(v) {
    queryClient = v;
  }

}, 1);
const allModules = queryClient.fetchQuery({
  queryKey: ['ee.features'],
  queryFn: fetchFeatures
}).then(features => new Set(features)).catch(e => {
  console.error('Error getting modules', e);
  return Promise.reject(e);
});

async function hasLicense(feature) {
  try {
    const features = await allModules;
    return features.has(feature);
  } catch (e) {
    return false;
  }
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}}},"client":{"lib":{"fetchFeatures.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/lib/fetchFeatures.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  fetchFeatures: () => fetchFeatures
});
let CachedCollectionManager;
module.link("../../../app/ui-cached-collection/client", {
  CachedCollectionManager(v) {
    CachedCollectionManager = v;
  }

}, 0);
let call;
module.link("../../../client/lib/utils/call", {
  call(v) {
    call = v;
  }

}, 1);

const fetchFeatures = () => new Promise((resolve, reject) => {
  CachedCollectionManager.onLogin(() => {
    call('license:getModules').then(resolve, reject);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getFromRestApi.ts":[
  "../../../app/utils/client/lib/RestApiClient"
],"onToggledFeature.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/lib/onToggledFeature.ts                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onToggledFeature: () => onToggledFeature
});
let QueryObserver;
module.link("react-query", {
  QueryObserver(v) {
    QueryObserver = v;
  }

}, 0);
let queryClient;
module.link("../../../client/lib/queryClient", {
  queryClient(v) {
    queryClient = v;
  }

}, 1);
let fetchFeatures;
module.link("./fetchFeatures", {
  fetchFeatures(v) {
    fetchFeatures = v;
  }

}, 2);

const onToggledFeature = (feature, _ref) => {
  let {
    up,
    down
  } = _ref;
  const observer = new QueryObserver(queryClient, {
    queryKey: ['ee.features'],
    queryFn: fetchFeatures
  });
  let enabled = false;
  return observer.subscribe(result => {
    if (!result.isSuccess) {
      return;
    }

    const features = result.data;
    const hasFeature = features.includes(feature);

    if (!enabled && hasFeature) {
      up === null || up === void 0 ? void 0 : up();
      enabled = true;
    }

    if (enabled && !hasFeature) {
      down === null || down === void 0 ? void 0 : down();
      enabled = false;
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"omnichannel":{"components":{"CannedResponse":{"modals":{"CreateCannedResponse":{"CreateCannedResponseModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../../client/contexts/TranslationContext",
  "../../../../cannedResponses/components/cannedResponseForm"
],"PreviewText.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../../client/components/MarkdownText"
],"SharingOptions.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../../client/contexts/TranslationContext"
],"index.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../../../../../client/contexts/AuthorizationContext",
  "../../../../../../../client/contexts/ModalContext",
  "../../../../../../../client/contexts/ServerContext",
  "../../../../../../../client/contexts/ToastMessagesContext",
  "../../../../../../../client/contexts/TranslationContext",
  "../../../../../../../client/hooks/useForm",
  "./CreateCannedResponseModal"
]},"index.ts":[
  "./CreateCannedResponse"
]},"MarkdownTextEditor":{"InsertPlaceholderDropdown.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext"
],"index.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../app/emoji/client",
  "../../../../../../client/components/Backdrop",
  "../../../../../../client/contexts/UserContext",
  "../TextEditor",
  "./InsertPlaceholderDropdown"
]},"TextEditor":{"IconButton.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"TextButton.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext"
],"Textarea.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Toolbox.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./IconButton",
  "./TextButton"
],"index.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./Textarea",
  "./Toolbox"
]}},"contextualBar":{"CannedResponse":{"CannedResponse.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/components/VerticalBar",
  "../../../../../../client/contexts/TranslationContext",
  "../../../hooks/useScopeDict"
],"CannedResponseList.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../../../client/components/ScrollableContentWrapper",
  "../../../../../../client/components/VerticalBar",
  "../../../../../../client/contexts/TranslationContext",
  "../../../../../../client/views/room/providers/ToolboxProvider",
  "./Item",
  "./WrapCannedResponse"
],"Item.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "../../../hooks/useScopeDict"
],"WrapCannedResponse.tsx":[
  "react",
  "../../../../../../client/contexts/AuthorizationContext",
  "../../../../../../client/contexts/ModalContext",
  "../../CannedResponse/modals",
  "./CannedResponse"
],"index.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/ui",
  "../../../../../../client/contexts/ModalContext",
  "../../../../../../client/contexts/RouterContext",
  "../../../../../../client/hooks/lists/useRecordList",
  "../../../../../../client/lib/asyncState",
  "../../../../../../client/views/room/contexts/RoomContext",
  "../../../hooks/useCannedResponseFilterOptions",
  "../../../hooks/useCannedResponseList",
  "../../CannedResponse/modals",
  "./CannedResponseList"
]}}},"cannedResponses":{"components":{"cannedResponseForm.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../client/components/AutoCompleteDepartment",
  "../../../../../client/components/Omnichannel/Tags",
  "../../../../../client/contexts/TranslationContext",
  "../../components/CannedResponse/MarkdownTextEditor",
  "../../components/CannedResponse/modals/CreateCannedResponse/PreviewText",
  "../../components/CannedResponse/modals/CreateCannedResponse/SharingOptions"
]},"CannedResponseEdit.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/Page",
  "../../../../client/contexts/AuthorizationContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useForm",
  "./components/cannedResponseForm"
],"CannedResponseEditWithData.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./CannedResponseEdit",
  "./CannedResponseEditWithDepartmentData"
],"CannedResponseEditWithDepartmentData.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./CannedResponseEdit"
],"CannedResponseFilter.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/AutoCompleteAgent",
  "../../../../client/contexts/TranslationContext"
],"CannedResponseNew.tsx":[
  "react",
  "./CannedResponseEdit"
],"CannedResponsesPage.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericTable",
  "../../../../client/components/GenericTable/NoResults",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext"
],"CannedResponsesRoute.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericTable",
  "../../../../client/components/NotAuthorizedPage",
  "../../../../client/components/PageSkeleton",
  "../../../../client/components/avatar/UserAvatar",
  "../../../../client/contexts/AuthorizationContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useEndpointData",
  "../../../../client/hooks/useForm",
  "../../../../client/hooks/useFormatDateAndTime",
  "../../../../client/lib/asyncState",
  "./CannedResponseEditWithData",
  "./CannedResponseFilter",
  "./CannedResponseNew",
  "./CannedResponsesPage",
  "./RemoveCannedResponseButton"
],"RemoveCannedResponseButton.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericModal",
  "../../../../client/contexts/ModalContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext"
]},"additionalForms":{"BusinessHoursMultiple.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/AutoCompleteDepartmentMultiple",
  "../../../../client/contexts/TranslationContext"
],"BusinessHoursMultipleContainer.js":[
  "react",
  "../../../../client/hooks/useForm",
  "./BusinessHoursMultiple"
],"BusinessHoursTimeZone.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useForm",
  "../../../../client/hooks/useTimezoneNameList"
],"ContactManager.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/UserAutoComplete",
  "../../../../client/contexts/TranslationContext"
],"CustomFieldsAdditionalForm.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext"
],"CustomFieldsAdditionalFormContainer.js":[
  "react",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useForm",
  "./CustomFieldsAdditionalForm"
],"DepartmentBusinessHours.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useEndpointData"
],"DepartmentForwarding.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/Omnichannel/hooks/useDepartmentsList",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/lists/useRecordList",
  "../../../../client/hooks/useAsyncState"
],"EeNumberInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext"
],"EeTextAreaInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext"
],"EeTextInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext"
],"MaxChatsPerAgent.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext"
],"MaxChatsPerAgentContainer.js":[
  "react",
  "../../../../client/hooks/useForm",
  "./MaxChatsPerAgent"
],"MaxChatsPerAgentDisplay.js":[
  "react",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/views/room/contextualBar/UserInfo"
],"PrioritiesSelect.js":[
  "@rocket.chat/fuselage",
  "react"
],"register.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/omnichannel/additionalForms/register.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo, lazy;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  },

  lazy(v) {
    lazy = v;
  }

}, 0);
let registerForm;
module.link("../../../../client/views/omnichannel/additionalForms", {
  registerForm(v) {
    registerForm = v;
  }

}, 1);
let hasLicense;
module.link("../../../app/license/client", {
  hasLicense(v) {
    hasLicense = v;
  }

}, 2);
hasLicense('livechat-enterprise').then(enabled => {
  if (!enabled) {
    return;
  }

  registerForm({
    useCustomFieldsAdditionalForm: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./CustomFieldsAdditionalFormContainer')), [])
  });
  registerForm({
    useMaxChatsPerAgent: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./MaxChatsPerAgentContainer')), [])
  });
  registerForm({
    useMaxChatsPerAgentDisplay: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./MaxChatsPerAgentDisplay')), [])
  });
  registerForm({
    useEeNumberInput: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./EeNumberInput')), [])
  });
  registerForm({
    useEeTextAreaInput: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./EeTextAreaInput')), [])
  });
  registerForm({
    useEeTextInput: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./EeTextInput')), [])
  });
  registerForm({
    useBusinessHoursMultiple: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./BusinessHoursMultipleContainer')), [])
  });
  registerForm({
    useBusinessHoursTimeZone: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./BusinessHoursTimeZone')), [])
  });
  registerForm({
    useContactManager: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./ContactManager')), [])
  });
  registerForm({
    useCurrentChatTags: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('../tags/CurrentChatTags')), [])
  });
  registerForm({
    useDepartmentBusinessHours: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./DepartmentBusinessHours')), [])
  });
  registerForm({
    useDepartmentForwarding: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./DepartmentForwarding')), [])
  });
  registerForm({
    usePrioritiesSelect: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('./PrioritiesSelect')), [])
  });
  registerForm({
    useSelectForwardDepartment: () => useMemo(() => /*#__PURE__*/lazy(() => module.dynamicImport('../../../../client/components/AutoCompleteDepartment')), [])
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"hooks":{"useCannedResponseFilterOptions.ts":[
  "react",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/TranslationContext"
],"useCannedResponseList.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../../client/contexts/ServerContext",
  "../../../../client/hooks/lists/useScrollableRecordList",
  "../../../../client/hooks/useComponentDidUpdate",
  "../../../../client/lib/lists/CannedResponseList"
],"useScopeDict.ts":[
  "../../../../client/contexts/TranslationContext"
]},"monitors":{"MonitorsPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/Page",
  "../../../../client/components/UserAutoComplete",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./MonitorsTable"
],"MonitorsPageContainer.js":[
  "react",
  "../../../../client/components/NotAuthorizedPage",
  "../../../../client/components/PageSkeleton",
  "../../hooks/useHasLicense",
  "./MonitorsPage"
],"MonitorsRow.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericModal",
  "../../../../client/contexts/ModalContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext"
],"MonitorsTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../client/components/FilterByText",
  "../../../../client/components/GenericTable",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useResizeInlineBreakpoint",
  "./MonitorsRow"
]},"priorities":{"PrioritiesPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/FilterByText",
  "../../../../client/components/GenericTable",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext"
],"PrioritiesRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericTable",
  "../../../../client/components/NotAuthorizedPage",
  "../../../../client/components/VerticalBar",
  "../../../../client/contexts/AuthorizationContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useEndpointData",
  "./PrioritiesPage",
  "./PriorityEditWithData",
  "./PriorityNew",
  "./RemovePriorityButton"
],"PriorityEdit.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/VerticalBar",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useForm"
],"PriorityEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./PriorityEdit"
],"PriorityNew.js":[
  "react",
  "./PriorityEdit"
],"RemovePriorityButton.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericModal",
  "../../../../client/contexts/ModalContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext"
]},"tags":{"AutoCompleteTagsMultiple.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/lists/useRecordList",
  "../../../../client/hooks/useAsyncState",
  "../../hooks/useTagsList"
],"CurrentChatTags.tsx":[
  "react",
  "./AutoCompleteTagsMultiple"
],"RemoveTagButton.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericModal",
  "../../../../client/contexts/ModalContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext"
],"TagEdit.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/AutoCompleteDepartmentMultiple",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useForm"
],"TagEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./TagEdit",
  "./TagEditWithDepartmentData"
],"TagEditWithDepartmentData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./TagEdit"
],"TagsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/FilterByText",
  "../../../../client/components/GenericTable",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext"
],"TagsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericTable",
  "../../../../client/components/NotAuthorizedPage",
  "../../../../client/contexts/AuthorizationContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useEndpointData",
  "./RemoveTagButton",
  "./TagEditWithData",
  "./TagsPage"
]},"units":{"RemoveUnitButton.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericModal",
  "../../../../client/contexts/ModalContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext"
],"UnitEdit.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/lists/useRecordList",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useForm",
  "../../../../client/views/hooks/useDepartmentsByUnitsList",
  "../../../../client/views/hooks/useMonitorsList"
],"UnitEditWithData.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./UnitEdit"
],"UnitsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/FilterByText",
  "../../../../client/components/GenericTable",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext"
],"UnitsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericTable",
  "../../../../client/components/NotAuthorizedPage",
  "../../../../client/contexts/AuthorizationContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useEndpointData",
  "./RemoveUnitButton",
  "./UnitEditWithData",
  "./UnitsPage"
]},"BusinessHoursRow.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../client/contexts/RouterContext",
  "../../../client/contexts/TranslationContext",
  "./RemoveBusinessHourButton"
],"BusinessHoursTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../client/components/FilterByText",
  "../../../client/components/GenericTable",
  "../../../client/contexts/TranslationContext",
  "../../../client/hooks/useResizeInlineBreakpoint",
  "./BusinessHoursRow"
],"BusinessHoursTableContainer.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../client/contexts/TranslationContext",
  "../../../client/hooks/useAsyncState",
  "../../../client/hooks/useEndpointData",
  "./BusinessHoursTable"
],"ContactManagerInfo.js":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../../client/components/UserCard",
  "../../../client/components/UserStatus",
  "../../../client/components/avatar/UserAvatar",
  "../../../client/hooks/useAsyncState",
  "../../../client/hooks/useEndpointData"
],"RemoveBusinessHourButton.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../client/components/GenericModal",
  "../../../client/contexts/ModalContext",
  "../../../client/contexts/ServerContext",
  "../../../client/contexts/ToastMessagesContext",
  "../../../client/contexts/TranslationContext"
],"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/omnichannel/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./additionalForms/register");
module.link("./routes");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/omnichannel/routes.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let registerOmnichannelRoute;
module.link("../../../client/views/omnichannel/routes", {
  registerOmnichannelRoute(v) {
    registerOmnichannelRoute = v;
  }

}, 0);
registerOmnichannelRoute('/monitors', {
  name: 'omnichannel-monitors',
  lazyRouteComponent: () => module.dynamicImport('./monitors/MonitorsPageContainer')
});
registerOmnichannelRoute('/priorities/:context?/:id?', {
  name: 'omnichannel-priorities',
  lazyRouteComponent: () => module.dynamicImport('./priorities/PrioritiesRoute')
});
registerOmnichannelRoute('/canned-responses/:context?/:id?', {
  name: 'omnichannel-canned-responses',
  lazyRouteComponent: () => module.dynamicImport('./cannedResponses/CannedResponsesRoute')
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"views":{"admin":{"engagementDashboard":{"channels":{"ChannelsTab.tsx":[
  "@rocket.chat/fuselage",
  "moment",
  "react",
  "../../../../../../client/components/data/Growth",
  "../../../../../../client/contexts/TranslationContext",
  "../Section",
  "../data/DownloadDataButton",
  "../data/PeriodSelector",
  "../data/usePeriodSelectorState",
  "./useChannelsList"
],"useChannelsList.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
]},"data":{"DownloadDataButton.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/ToastMessagesContext",
  "../../../../../../client/contexts/TranslationContext",
  "../../../../../../client/lib/download"
],"LegendSymbol.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"PeriodSelector.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "./periods"
],"periods.ts":[
  "moment"
],"usePeriodLabel.ts":[
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "./periods"
],"usePeriodSelectorState.ts":[
  "react"
]},"messages":{"MessagesPerChannelSection.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@nivo/pie",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "../Section",
  "../data/DownloadDataButton",
  "../data/LegendSymbol",
  "../data/PeriodSelector",
  "../data/usePeriodSelectorState",
  "./useMessageOrigins",
  "./useTopFivePopularChannels"
],"MessagesSentSection.tsx":[
  "@nivo/bar",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors.json",
  "moment",
  "react",
  "../../../../../../client/components/data/CounterSet",
  "../../../../../../client/contexts/TranslationContext",
  "../Section",
  "../data/DownloadDataButton",
  "../data/PeriodSelector",
  "../data/usePeriodLabel",
  "../data/usePeriodSelectorState",
  "./useMessagesSent"
],"MessagesTab.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./MessagesPerChannelSection",
  "./MessagesSentSection"
],"useMessageOrigins.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
],"useMessagesSent.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
],"useTopFivePopularChannels.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
]},"users":{"ActiveUsersSection.tsx":[
  "@nivo/line",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors.json",
  "moment",
  "react",
  "../../../../../../client/components/data/CounterSet",
  "../../../../../../client/contexts/TranslationContext",
  "../../../../../../client/hooks/useFormatDate",
  "../Section",
  "../data/DownloadDataButton",
  "../data/LegendSymbol",
  "./useActiveUsers"
],"BusiestChatTimesSection.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "../Section",
  "./ContentForDays",
  "./ContentForHours"
],"ContentForDays.tsx":[
  "@nivo/bar",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "moment",
  "react",
  "./useWeeklyChatActivity"
],"ContentForHours.tsx":[
  "@nivo/bar",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-tokens/colors.json",
  "moment",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "./useHourlyChatActivity"
],"NewUsersSection.tsx":[
  "@nivo/bar",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-tokens/colors.json",
  "moment",
  "react",
  "../../../../../../client/components/data/CounterSet",
  "../../../../../../client/contexts/TranslationContext",
  "../../../../../../client/hooks/useFormatDate",
  "../Section",
  "../data/DownloadDataButton",
  "../data/PeriodSelector",
  "../data/usePeriodLabel",
  "../data/usePeriodSelectorState",
  "./useNewUsers"
],"UsersByTimeOfTheDaySection.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@nivo/heatmap",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors.json",
  "moment",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "../Section",
  "../data/DownloadDataButton",
  "../data/PeriodSelector",
  "../data/usePeriodSelectorState",
  "./useUsersByTimeOfTheDay"
],"UsersTab.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "./ActiveUsersSection",
  "./BusiestChatTimesSection",
  "./NewUsersSection",
  "./UsersByTimeOfTheDaySection"
],"useActiveUsers.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "moment",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
],"useHourlyChatActivity.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "moment",
  "react-query",
  "../../../../lib/getFromRestApi"
],"useNewUsers.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
],"useUsersByTimeOfTheDay.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
],"useWeeklyChatActivity.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "moment",
  "react-query",
  "../../../../lib/getFromRestApi"
]},"EngagementDashboardPage.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../client/components/Page",
  "../../../../../client/contexts/TranslationContext",
  "./channels/ChannelsTab",
  "./messages/MessagesTab",
  "./users/UsersTab"
],"EngagementDashboardRoute.tsx":[
  "react",
  "../../../../../client/components/NotAuthorizedPage",
  "../../../../../client/contexts/AuthorizationContext",
  "../../../../../client/contexts/RouterContext",
  "./EngagementDashboardPage"
],"Section.tsx":[
  "@rocket.chat/fuselage",
  "react"
]},"users":{"SeatsCapUsage":{"SeatsCapUsage.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext"
],"index.ts":[
  "./SeatsCapUsage"
]},"CloseToSeatsCapModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../client/components/ExternalLink",
  "../../../../../client/contexts/TranslationContext",
  "./SeatsCapUsage"
],"ReachedSeatsCapModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../client/components/ExternalLink",
  "../../../../../client/contexts/TranslationContext",
  "./SeatsCapUsage"
],"UserPageHeaderContentWithSeatsCap.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../client/components/ExternalLink",
  "../../../../../client/contexts/ModalContext",
  "../../../../../client/contexts/RouterContext",
  "../../../../../client/contexts/TranslationContext",
  "./CloseToSeatsCapModal",
  "./ReachedSeatsCapModal",
  "./SeatsCapUsage",
  "./useRequestSeatsLink"
],"useRequestSeatsLink.ts":[
  "../../../../../client/contexts/ServerContext"
],"useSeatsCap.ts":[
  "../../../../../client/hooks/useEndpointData"
]},"info":{"SeatsCard.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../../client/components/Card",
  "../../../../../client/components/ExternalLink",
  "../../../../../client/contexts/TranslationContext",
  "../../../../../client/views/admin/info/UsagePieGraph",
  "../users/useRequestSeatsLink",
  "../users/useSeatsCap"
]}}},"audit":{"RoomAutoComplete":{"Avatar.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/avatar/RoomAvatar"
],"RoomAutoComplete.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/hooks/useEndpointData",
  "./Avatar"
],"index.ts":[
  "./RoomAutoComplete"
]},"Tabs":{"ChannelTab.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext",
  "../RoomAutoComplete"
],"DirectTab.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/UserAutoCompleteMultiple",
  "../../../../client/contexts/TranslationContext"
],"UsersTab.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/UserAutoCompleteMultiple",
  "../../../../client/contexts/TranslationContext"
],"VisitorsTab.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/AutoCompleteAgent",
  "../../../../client/contexts/TranslationContext",
  "../VisitorAutoComplete"
]},"AuditLogPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../client/components/Page",
  "../../../client/contexts/TranslationContext",
  "../../../client/hooks/useMethodData",
  "./AuditLogTable",
  "./DateRangePicker"
],"AuditLogTable.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "../../../client/components/GenericTable",
  "../../../client/contexts/TranslationContext",
  "../../../client/hooks/useFormatDate",
  "../../../client/hooks/useFormatDateAndTime",
  "./UserRow"
],"AuditPage.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../client/contexts/TranslationContext",
  "../../../client/hooks/useForm",
  "./AuditPageBase"
],"AuditPageBase.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../client/components/Page",
  "../../../client/contexts/TranslationContext",
  "./DateRangePicker",
  "./Result",
  "./Tabs/ChannelTab",
  "./Tabs/DirectTab",
  "./Tabs/UsersTab",
  "./Tabs/VisitorsTab"
],"DateRangePicker.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../client/contexts/TranslationContext"
],"FilterDisplay.js":[
  "@rocket.chat/fuselage",
  "react"
],"Result.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/blaze",
  "meteor/templating",
  "react",
  "../../app/auditing/client/templates/audit/audit.html"
],"UserRow.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../client/components/avatar/UserAvatar",
  "../../../client/contexts/TranslationContext",
  "./FilterDisplay"
],"VisitorAutoComplete.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../client/hooks/useEndpointData"
]},"hooks":{"useHasLicense.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/hooks/useHasLicense.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  useHasLicense: () => useHasLicense
});
let useState, useEffect;
module.link("react", {
  useState(v) {
    useState = v;
  },

  useEffect(v) {
    useEffect = v;
  }

}, 0);
let hasLicense;
module.link("../../app/license/client", {
  hasLicense(v) {
    hasLicense = v;
  }

}, 1);

const useHasLicense = licenseName => {
  const [license, setLicense] = useState('loading');
  useEffect(() => {
    hasLicense(licenseName).then(enabled => {
      if (enabled) {
        return setLicense(true);
      }

      setLicense(false);
    });
  }, [licenseName]);
  return license;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useTagsList.ts":[
  "react",
  "../../../client/contexts/ServerContext",
  "../../../client/hooks/lists/useScrollableRecordList",
  "../../../client/hooks/useComponentDidUpdate",
  "../../../client/lib/lists/RecordList"
]},"startup":{"engagementDashboard.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/startup/engagementDashboard.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let hasAllPermission;
module.link("../../../app/authorization/client", {
  hasAllPermission(v) {
    hasAllPermission = v;
  }

}, 1);
let registerAdminRoute, registerAdminSidebarItem, unregisterAdminSidebarItem;
module.link("../../../client/views/admin", {
  registerAdminRoute(v) {
    registerAdminRoute = v;
  },

  registerAdminSidebarItem(v) {
    registerAdminSidebarItem = v;
  },

  unregisterAdminSidebarItem(v) {
    unregisterAdminSidebarItem = v;
  }

}, 2);
let onToggledFeature;
module.link("../lib/onToggledFeature", {
  onToggledFeature(v) {
    onToggledFeature = v;
  }

}, 3);
const [registerRoute, unregisterRoute] = registerAdminRoute('/engagement-dashboard/:tab?', {
  name: 'engagement-dashboard',
  lazyRouteComponent: () => module.dynamicImport('../views/admin/engagementDashboard/EngagementDashboardRoute'),
  ready: false
});
onToggledFeature('engagement-dashboard', {
  up: () => Meteor.startup(() => {
    registerAdminSidebarItem({
      href: '/admin/engagement-dashboard',
      i18nLabel: 'Engagement Dashboard',
      icon: 'file-keynote',
      permissionGranted: () => hasAllPermission('view-engagement-dashboard')
    });
    registerRoute();
  }),
  down: () => Meteor.startup(() => {
    unregisterAdminSidebarItem('Engagement Dashboard');
    unregisterRoute();
  })
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/startup/index.ts                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./engagementDashboard");
module.link("./routes");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/startup/routes.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let appLayout;
module.link("../../../client/lib/appLayout", {
  appLayout(v) {
    appLayout = v;
  }

}, 1);
FlowRouter.route('/audit', {
  name: 'audit-home',

  action() {
    appLayout.renderMainLayout({
      center: 'auditPage'
    });
  }

});
FlowRouter.route('/audit-log', {
  name: 'audit-log',

  action() {
    appLayout.renderMainLayout({
      center: 'auditLogPage'
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ecdh.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/ecdh.ts                                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let APIClient;
module.link("../../app/utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 1);
let resolveSession;
const sessionPromise = new Promise(resolve => {
  resolveSession = resolve;
});

function init(session) {
  Meteor.connection._stream.allowConnection();

  const _didMessage = Meteor.connection._stream.socket._didMessage.bind(Meteor.connection._stream.socket);

  const send = Meteor.connection._stream.socket.send.bind(Meteor.connection._stream.socket);

  Meteor.connection._stream.socket._didMessage = async data => {
    const decryptedData = await session.decrypt(data);
    decryptedData.split('\n').forEach(d => _didMessage(d));
  };

  Meteor.connection._stream.socket.send = async data => {
    send(await session.encrypt(data));
  };
}

async function initEncryptedSession() {
  if (!window.ECDH_Enabled) {
    Meteor.connection._stream.allowConnection();

    return resolveSession();
  }

  const {
    ClientSession
  } = await module.dynamicImport('../app/ecdh/client/ClientSession');
  const session = new ClientSession();
  const clientPublicKey = await session.init();

  try {
    const response = await fetch('/api/ecdh_proxy/initEncryptedSession', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        clientPublicKey
      })
    });

    if (response.status !== 200) {
      resolveSession();
      return Meteor.connection._stream.allowConnection();
    }

    const data = await response.json();

    if (data.success === false) {
      resolveSession();
      return Meteor.connection._stream.allowConnection();
    }

    await session.setServerKey(data.publicKeyString);
    resolveSession(session);
    init(session);
  } catch (e) {
    console.log(e);
    resolveSession();

    Meteor.connection._stream.allowConnection();
  }
}

initEncryptedSession();

const _jqueryCall = APIClient._jqueryCall.bind(APIClient);

APIClient._jqueryCall = async function (method, endpoint, params, body) {
  let headers = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
  const session = await sessionPromise;

  if (!session) {
    return _jqueryCall(method, endpoint, params, body, headers);
  }

  const result = await _jqueryCall(method, endpoint, params, body, headers, 'text');
  const decrypted = await session.decrypt(result);
  const parsed = JSON.parse(decrypted);
  return parsed;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/index.ts                                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../app/auditing/client");
module.link("../app/authorization/client");
module.link("../app/canned-responses/client");
module.link("../app/license/client");
module.link("../app/livechat-enterprise/client");
module.link("./omnichannel");
module.link("./startup");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"client":{"views":{"room":{"contextualBar":{"Call":{"Jitsi":{"lib":{"Jitsi.js":[
  "postis"
],"JitsiBridge.js":[
  "@rocket.chat/emitter",
  "./Jitsi"
]},"components":{"CallModal.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../contexts/TranslationContext"
]},"CallJitsi.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext"
],"CallJitsiWithData.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/memo",
  "react",
  "../../../../../../app/videobridge/constants",
  "../../../../../contexts/ConnectionStatusContext",
  "../../../../../contexts/ModalContext",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/SettingsContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../contexts/UserContext",
  "../../../contexts/RoomContext",
  "../../../providers/ToolboxProvider",
  "./CallJitsi",
  "./components/CallModal",
  "./lib/JitsiBridge"
],"index.ts":[
  "./CallJitsiWithData"
]},"BBB":{"CallBBB.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext"
],"D.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/ui-utils/client",
  "../../../../../contexts/AuthorizationContext",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/SettingsContext",
  "../../../contexts/RoomContext",
  "../../../providers/ToolboxProvider",
  "./CallBBB"
],"index.ts":[
  "./D"
]}},"RoomFiles":{"lib":{"getDifference.js":[]},"components":{"FileItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../../hooks/useFormatDateAndTime",
  "./FileItemIcon",
  "./MenuItem"
],"FileItemIcon.js":[
  "react"
],"MenuItem.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../app/utils/client",
  "../../../../../contexts/TranslationContext",
  "../../../../../lib/download"
]},"hooks":{"useFilesList.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/lists/useScrollableMessageList",
  "../../../../../hooks/lists/useStreamUpdatesForMessageList",
  "../../../../../hooks/useComponentDidUpdate",
  "../../../../../lib/lists/FilesList",
  "../../../../../lib/utils/getConfig"
],"useMessageDeletionIsAllowed.js":[
  "react",
  "../../../../../contexts/AuthorizationContext",
  "../../../../../contexts/SettingsContext",
  "../lib/getDifference"
]},"RoomFiles.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../components/ScrollableContentWrapper",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "./Row"
],"RoomFilesWithData.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/ModalContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../contexts/UserContext",
  "../../../../hooks/lists/useRecordList",
  "../../../../hooks/useAsyncState",
  "../../providers/ToolboxProvider",
  "./RoomFiles",
  "./hooks/useFilesList",
  "./hooks/useMessageDeletionIsAllowed"
],"Row.js":[
  "react",
  "./components/FileItem"
],"index.ts":[
  "./RoomFilesWithData"
]},"RoomMembers":{"List":{"components":{"MemberItem.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../components/UserStatus",
  "../../../../../../components/avatar/UserAvatar",
  "../../../../../../hooks/usePreventProgation",
  "./UserActions"
],"UserActions.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../hooks/useActionSpread",
  "../../../../hooks/useUserInfoActions"
]},"DefaultRow.js":[
  "react",
  "./components/MemberItem"
],"RoomMembers.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../../components/ScrollableContentWrapper",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext",
  "./DefaultRow"
],"RoomMembersWithData.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../contexts/AuthorizationContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/lists/useRecordList",
  "../../../../../hooks/useAsyncState",
  "../../../../hooks/useMembersList",
  "../../../providers/ToolboxProvider",
  "../../UserInfo",
  "../AddUsers",
  "../InviteUsers",
  "./RoomMembers"
]},"AddUsers":{"AddUsers.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/UserAutoCompleteMultiple",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext"
],"AddUsersWithData.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useForm",
  "../../../providers/ToolboxProvider",
  "./AddUsers"
],"index.ts":[
  "./AddUsersWithData"
]},"EditInvite":{"EditInvite.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext"
],"EditInviteWithData.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../providers/ToolboxProvider",
  "./EditInvite"
],"index.ts":[
  "./EditInviteWithData"
]},"InviteUsers":{"InviteUsers.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useClipboardWithToast"
],"WrappedInviteUsers.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useFormatDateAndTime",
  "../../../providers/ToolboxProvider",
  "../EditInvite",
  "./InviteUsers"
],"index.ts":[
  "./WrappedInviteUsers"
]},"index.ts":[
  "./List/RoomMembersWithData"
]},"Discussions":{"components":{"Message.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/RawText",
  "../../../../../components/avatar/UserAvatar",
  "../../../components/MessageTemplate"
]},"DiscussionList.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../components/ScrollableContentWrapper",
  "../../../../components/VerticalBar",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext",
  "../../../../lib/utils/goToRoomById",
  "./Row",
  "./withData"
],"Row.js":[
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useTimeAgo",
  "../../../../lib/clickableItem",
  "./components/Message",
  "./mapProps",
  "./normalizeThreadMessage"
],"index.ts":[
  "./DiscussionList"
],"mapProps.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react"
],"normalizeThreadMessage.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/string-helpers",
  "../../../../lib/utils/renderMessageBody"
],"useDiscussionsList.ts":[
  "react",
  "../../../../contexts/ServerContext",
  "../../../../hooks/lists/useScrollableMessageList",
  "../../../../hooks/lists/useStreamUpdatesForMessageList",
  "../../../../lib/lists/DiscussionsList",
  "../../../../lib/utils/getConfig"
],"withData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/UserContext",
  "../../../../hooks/lists/useRecordList",
  "../../../../hooks/useAsyncState",
  "../../hooks/useUserRoom",
  "../../providers/ToolboxProvider",
  "./useDiscussionsList"
]},"Info":{"ChannelToTeamModal":{"ChannelToTeamModal.js":[
  "react",
  "./StepOne",
  "./StepTwo"
],"StepOne.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../../../teams/contextualBar/TeamAutocomplete"
],"StepTwo.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext"
]},"EditRoomInfo":{"EditChannel.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/e2e/client/rocketchat.e2e",
  "../../../../../../app/lib/lib/MessageTypes",
  "../../../../../../app/utils/client",
  "../../../../../components/GenericModal",
  "../../../../../components/RawText",
  "../../../../../components/VerticalBar",
  "../../../../../components/avatar/RoomAvatarEditor",
  "../../../../../contexts/AuthorizationContext",
  "../../../../../contexts/ModalContext",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/SettingsContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useEndpointActionExperimental",
  "../../../../../hooks/useForm"
],"EditChannelWithData.js":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../hooks/useUserRoom",
  "../../../providers/ToolboxProvider",
  "./EditChannel"
],"index.ts":[
  "./EditChannelWithData"
]},"RoomInfo":{"RoomInfo.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/MarkdownText",
  "../../../../../components/VerticalBar",
  "../../../../../components/avatar/RoomAvatar",
  "../../../../../contexts/TranslationContext",
  "../../../../InfoPanel",
  "../../../../InfoPanel/RetentionPolicyCallout",
  "../../../../hooks/useActionSpread"
],"RoomInfoWithData.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/ui-utils/client/lib/RoomManager",
  "../../../../../../app/utils/client",
  "../../../../../components/GenericModal",
  "../../../../../contexts/AuthorizationContext",
  "../../../../../contexts/ModalContext",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/SettingsContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/useEndpointActionExperimental",
  "../../../../admin/apps/WarningModal",
  "../../../providers/ToolboxProvider",
  "../ChannelToTeamModal/ChannelToTeamModal",
  "./RoomInfo"
],"index.ts":[
  "./RoomInfoWithData"
]},"index.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "./EditRoomInfo",
  "./RoomInfo"
]},"NotificationPreferences":{"components":{"NotificationByDevice.js":[
  "@rocket.chat/fuselage",
  "react"
],"NotificationToogle.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react"
],"Preferences.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
]},"NotificationPreferences.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "./components/NotificationByDevice",
  "./components/NotificationToogle",
  "./components/Preferences"
],"NotificationPreferencesWithData.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/CustomSoundContext",
  "../../../../contexts/TranslationContext",
  "../../../../contexts/UserContext",
  "../../../../hooks/useEndpointActionExperimental",
  "../../../../hooks/useForm",
  "../../providers/ToolboxProvider",
  "./NotificationPreferences"
],"index.ts":[
  "./NotificationPreferencesWithData"
]},"Threads":{"components":{"Message.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/Message/Metrics",
  "../../../../../components/Message/NotificationStatus",
  "../../../../../components/Message/helpers/followSyle",
  "../../../../../components/RawText",
  "../../../../../components/avatar/UserAvatar",
  "../../../components/MessageTemplate"
]},"Row.tsx":[
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useTimeAgo",
  "../../../../lib/clickableItem",
  "../../../../lib/utils/callWithErrorHandling",
  "./components/Message",
  "./mapProps",
  "./normalizeThreadMessage"
],"ThreadList.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../components/ScrollableContentWrapper",
  "../../../../components/VerticalBar",
  "../../../../contexts/RouterContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext",
  "../../providers/ToolboxProvider",
  "../../threads/ThreadComponent",
  "./Row",
  "./withData"
],"index.ts":[
  "./ThreadList"
],"mapProps.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react"
],"normalizeThreadMessage.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/string-helpers",
  "../../../../lib/utils/renderMessageBody"
],"useThreadsList.ts":[
  "react",
  "../../../../contexts/ServerContext",
  "../../../../hooks/lists/useScrollableMessageList",
  "../../../../hooks/lists/useStreamUpdatesForMessageList",
  "../../../../lib/lists/ThreadsList",
  "../../../../lib/utils/getConfig"
],"withData.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/UserContext",
  "../../../../hooks/lists/useRecordList",
  "../../../../hooks/useAsyncState",
  "../../hooks/useUserRoom",
  "../../providers/ToolboxProvider",
  "./useThreadsList"
]},"UserInfo":{"UserWebRTC":{"UserWebRTC.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "./UserWebRTCRemote",
  "./UserWebRTCVideo"
],"UserWebRTCButtons.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext"
],"UserWebRTCRemote.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "./UserWebRTCVideo"
],"UserWebRTCVideo.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react"
],"UserWebRTCWithData.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors.json",
  "react",
  "react-dom",
  "../../../../../components/VerticalBar",
  "../../../../../lib/utils/createAnchor",
  "../../../hooks/useWebRTC",
  "./UserWebRTC",
  "./UserWebRTCButtons"
],"index.ts":[
  "./UserWebRTCWithData"
]},"actions":{"UserActions.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "..",
  "../../../../hooks/useActionSpread",
  "../../../hooks/useUserInfoActions"
]},"Action.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"Avatar.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../components/avatar/UserAvatar"
],"UserInfo.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/MarkdownText",
  "../../../../components/UTCClock",
  "../../../../components/UserCard",
  "../../../../components/VerticalBar",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useTimeAgo",
  "../../../InfoPanel",
  "./Avatar"
],"UserInfoWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../lib/getUserEmailAddress",
  "../../../../components/Skeleton",
  "../../../../components/UserCard",
  "../../../../components/UserStatus",
  "../../../../components/VerticalBar",
  "../../../../contexts/AuthorizationContext",
  "../../../../contexts/SessionContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "../../../../lib/utils/getUserEmailVerified",
  "../../hooks/useWebRTC",
  "./UserInfo",
  "./UserWebRTC",
  "./actions/UserActions"
],"Username.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../components/UserCard"
],"index.js":[
  "react",
  "../../../InfoPanel",
  "./Action",
  "./Avatar",
  "./UserInfoWithData",
  "./Username"
]},"Apps":{"Apps.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../../../../app/utils/lib/getURL",
  "../../../../components/VerticalBar",
  "../../../blocks/ModalBlock"
],"AppsWithData.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/apps-engine/definition/uikit/UIKitIncomingInteractionContainer",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../../../../app/ui-message/client/ActionManager",
  "../../providers/ToolboxProvider",
  "./Apps"
],"index.ts":[
  "./AppsWithData"
]},"AutoTranslate":{"AutoTranslate.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext"
],"AutoTranslateWithData.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../contexts/UserContext",
  "../../../../hooks/useEndpointActionExperimental",
  "../../../../hooks/useEndpointData",
  "../../providers/ToolboxProvider",
  "./AutoTranslate"
],"index.ts":[
  "./AutoTranslateWithData"
]},"ExportMessages":{"ExportMessages.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "../../providers/ToolboxProvider",
  "./FileExport",
  "./MailExportForm"
],"FileExport.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useForm"
],"MailExportForm.js":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../../lib/emailValidator",
  "../../../../components/UserAutoCompleteMultiple",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useForm",
  "../../hooks/useUserRoom"
],"index.ts":[
  "./ExportMessages"
]},"KeyboardShortcuts":{"KeyboardShortcuts.js":[
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "./ShortcutSection"
],"KeyboardShortcutsWithClose.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "./KeyboardShortcuts"
],"ShortcutSection.js":[
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./KeyboardShortcutsWithClose"
]},"OTR":{"OTR.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext"
],"OTRModal.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext"
],"OTRWithData.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/otr/client/rocketchat.otr",
  "../../../../contexts/ModalContext",
  "../../../../hooks/usePresence",
  "../../../../hooks/useReactiveValue",
  "./OTR",
  "./OTRModal"
],"index.ts":[
  "./OTRWithData"
]},"PruneMessages":{"DateTimeRow.js":[
  "@rocket.chat/fuselage",
  "react"
],"PruneMessages.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/UserAutoCompleteMultiple",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "./DateTimeRow"
],"PruneMessagesWithData.js":[
  "@rocket.chat/fuselage-hooks",
  "moment",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/ModalContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../contexts/UserContext",
  "../../../../hooks/useForm",
  "./PruneMessages"
],"index.ts":[
  "./PruneMessagesWithData"
]}},"lib":{"QuickActions":{"QuickActionsContext.tsx":[
  "react",
  ".",
  "./defaultActions"
],"defaultActions.ts":[
  "."
],"index.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/lib/QuickActions/index.tsx                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  listen: () => listen,
  addAction: () => addAction,
  deleteAction: () => deleteAction,
  actions: () => actions,
  QuickActionsEnum: () => QuickActionsEnum
});
let generator;
module.link("../Toolbox/generator", {
  generator(v) {
    generator = v;
  }

}, 0);
const {
  listen,
  add: addAction,
  remove: deleteAction,
  store: actions
} = generator();
var QuickActionsEnum;

(function (QuickActionsEnum) {
  QuickActionsEnum["MoveQueue"] = "rocket-move-to-queue";
  QuickActionsEnum["ChatForward"] = "rocket-chat-forward";
  QuickActionsEnum["Transcript"] = "rocket-transcript";
  QuickActionsEnum["CloseChat"] = "rocket-close-chat";
  QuickActionsEnum["OnHoldChat"] = "rocket-on-hold-chat";
})(QuickActionsEnum || module.runSetters(QuickActionsEnum = {}, ["QuickActionsEnum"]));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"Toolbox":{"IframeButtons.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/lib/Toolbox/IframeButtons.tsx                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  listen: () => listen,
  add: () => add,
  remove: () => remove,
  store: () => store
});
let generator;
module.link("./generator", {
  generator(v) {
    generator = v;
  }

}, 0);
const {
  listen,
  add,
  remove,
  store
} = generator();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ToolboxContext.tsx":[
  "react",
  ".",
  "./defaultActions"
],"defaultActions.ts":[
  "react",
  ".",
  "../../../../contexts/AuthorizationContext"
],"generator.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/lib/Toolbox/generator.tsx                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  generator: () => generator
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);

const generator = function generator(name) {
  const store = new Map();
  const emitter = new Emitter();

  const add = (id, action) => {
    store.set(id, action);
    emitter.emit('change', store);
    return store;
  };

  const remove = id => {
    const result = store.delete(id);
    emitter.emit('change', store);
    return result;
  };

  const listen = handler => emitter.on('change', handler);

  return Object.freeze({
    store,
    add,
    remove,
    listen,
    name
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/lib/Toolbox/index.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  listen: () => listen,
  addAction: () => addAction,
  deleteAction: () => deleteAction,
  actions: () => actions
});
let generator;
module.link("./generator", {
  generator(v) {
    generator = v;
  }

}, 0);
const {
  listen,
  add: addAction,
  remove: deleteAction,
  store: actions
} = generator();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"Header":{"Omnichannel":{"QuickActions":{"hooks":{"useQuickActions.tsx":[
  "@rocket.chat/fuselage-hooks",
  "meteor/kadira:flow-router",
  "meteor/session",
  "react",
  "../../../../../../../app/ui-utils/client",
  "../../../../../../../ee/app/livechat-enterprise/client/components/modals/PlaceChatOnHoldModal",
  "../../../../../../components/Omnichannel/modals/CloseChatModal",
  "../../../../../../components/Omnichannel/modals/CloseChatModalData",
  "../../../../../../components/Omnichannel/modals/ForwardChatModal",
  "../../../../../../components/Omnichannel/modals/ReturnChatQueueModal",
  "../../../../../../components/Omnichannel/modals/TranscriptModal",
  "../../../../../../contexts/AuthorizationContext",
  "../../../../../../contexts/ModalContext",
  "../../../../../../contexts/OmnichannelContext",
  "../../../../../../contexts/ServerContext",
  "../../../../../../contexts/SettingsContext",
  "../../../../../../contexts/ToastMessagesContext",
  "../../../../../../contexts/TranslationContext",
  "../../../../../../contexts/UserContext",
  "../../../../../../lib/utils/handleError",
  "../../../../lib/QuickActions",
  "../../../../lib/QuickActions/QuickActionsContext"
]},"QuickActions.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/Header",
  "../../../../../contexts/TranslationContext",
  "./hooks/useQuickActions"
],"index.ts":[
  "./QuickActions"
]},"BackButton.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/Header",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext"
],"OmnichannelRoomHeader.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../../components/BurgerMenu",
  "../../../../components/Header",
  "../../../../contexts/LayoutContext",
  "../../../../contexts/RouterContext",
  "../../contexts/RoomContext",
  "../../lib/Toolbox/ToolboxContext",
  "../RoomHeader",
  "./BackButton",
  "./QuickActions",
  "./QuickActions/hooks/useQuickActions"
]},"ToolBox":{"ToolBox.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/Header",
  "../../../../contexts/LayoutContext",
  "../../../../contexts/TranslationContext",
  "../../lib/Toolbox/ToolboxContext",
  "../../providers/ToolboxProvider"
],"index.ts":[
  "./ToolBox"
]},"icons":{"Encrypted.js":[
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../components/Header",
  "../../../../contexts/ServerContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext"
],"Favorite.js":[
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../components/Header",
  "../../../../contexts/ServerContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext"
],"Translate.tsx":[
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../components/Header",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext"
]},"DirectRoomHeader.js":[
  "react",
  "../../../contexts/UserContext",
  "../../../hooks/usePresence",
  "./RoomHeader"
],"Header.js":[
  "react",
  "../../../components/BurgerMenu",
  "../../../components/Header",
  "../../../contexts/LayoutContext",
  "./DirectRoomHeader",
  "./Omnichannel/OmnichannelRoomHeader",
  "./RoomHeader"
],"HeaderIconWithRoom.js":[
  "react",
  "../../../../definition/IRoom",
  "../../../components/Header",
  "../../../components/RoomIcon/OmnichannelRoomIcon",
  "../../../hooks/useRoomIcon"
],"ParentRoom.js":[
  "react",
  "../../../../app/utils/client",
  "../../../components/Header",
  "../../../hooks/useRoomIcon"
],"ParentRoomWithData.js":[
  "react",
  "../../../contexts/UserContext",
  "./ParentRoom",
  "./ParentRoomWithEndpointData"
],"ParentRoomWithEndpointData.js":[
  "react",
  "../../../components/Header",
  "../../../contexts/ServerContext",
  "../../../hooks/useAsyncState",
  "./ParentRoom"
],"ParentTeam.js":[
  "react",
  "../../../../definition/ITeam",
  "../../../components/Header",
  "../../../contexts/UserContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../../../lib/utils/goToRoomById"
],"RoomHeader.tsx":[
  "react",
  "../../../components/Header",
  "../../../components/MarkdownText",
  "../../../components/avatar/RoomAvatar",
  "./ParentRoomWithData",
  "./ParentTeam",
  "./RoomTitle",
  "./ToolBox",
  "./icons/Encrypted",
  "./icons/Favorite",
  "./icons/Translate"
],"RoomTitle.tsx":[
  "react",
  "../../../components/Header",
  "./HeaderIconWithRoom"
],"index.ts":[
  "./Header"
]},"components":{"RoomTemplate":{"slots":{"Aside.tsx":[
  "react"
],"Body.tsx":[
  "react"
],"Footer.tsx":[
  "react"
],"Header.tsx":[
  "react"
]},"RoomTemplate.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "react-keyed-flatten-children",
  "../../../../components/VerticalBar/VerticalBar",
  "./slots/Aside",
  "./slots/Body",
  "./slots/Footer",
  "./slots/Header"
]},"MessageTemplate":{"BodyClamp.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "./isIterable"
],"Container.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"Header.js":[
  "@rocket.chat/fuselage",
  "react"
],"Message.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./isIterable"
],"Timestamp.js":[
  "@rocket.chat/fuselage",
  "react"
],"Username.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./Container",
  "./Header",
  "./Username",
  "./Timestamp",
  "./Message",
  "./BodyClamp"
],"isIterable.js":[]},"BlazeTemplate.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "meteor/blaze",
  "meteor/templating",
  "react"
],"VerticalBarOldActions.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/TranslationContext",
  "../providers/ToolboxProvider",
  "./BlazeTemplate"
]},"Room":{"RoomNotFound":{"RoomNotFound.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/BurgerMenu",
  "../../../../components/Header",
  "../../../../contexts/LayoutContext",
  "../../../../contexts/TranslationContext",
  "../../components/RoomTemplate/RoomTemplate"
],"index.ts":[
  "./RoomNotFound"
]},"Aside.js":[
  "react"
],"Body.js":[
  "react"
],"Footer.js":[
  "react"
],"LazyComponent.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/VerticalBar"
],"Room.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/ErrorBoundary",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../Header",
  "../components/BlazeTemplate",
  "../components/RoomTemplate/RoomTemplate",
  "../components/VerticalBarOldActions",
  "../contexts/RoomContext",
  "../contextualBar/Apps",
  "../hooks/useAppsContextualBar",
  "../providers/ToolboxProvider",
  "./Aside",
  "./Body",
  "./Footer",
  "./LazyComponent"
],"RoomWithData.js":[
  "react",
  "../../../lib/RoomManager",
  "../providers/RoomProvider",
  "./Room"
],"Skeleton.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Header",
  "../../../components/VerticalBar/VerticalBarSkeleton",
  "../components/RoomTemplate/RoomTemplate"
],"index.ts":[
  "./RoomWithData"
]},"modals":{"FileUploadModal":{"FilePreview.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/FilePreview.tsx                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  FilePreviewType: () => FilePreviewType
});
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 0);
let isIE11;
module.link("../../../../lib/utils/isIE11", {
  isIE11(v) {
    isIE11 = v;
  }

}, 1);
let GenericPreview;
module.link("./GenericPreview", {
  default(v) {
    GenericPreview = v;
  }

}, 2);
let MediaPreview;
module.link("./MediaPreview", {
  default(v) {
    MediaPreview = v;
  }

}, 3);
var FilePreviewType;

(function (FilePreviewType) {
  FilePreviewType["IMAGE"] = "image";
  FilePreviewType["AUDIO"] = "audio";
  FilePreviewType["VIDEO"] = "video";
})(FilePreviewType || module.runSetters(FilePreviewType = {}, ["FilePreviewType"]));

const getFileType = fileType => {
  if (!fileType) {
    return;
  }

  for (const type of Object.values(FilePreviewType)) {
    if (fileType.indexOf(type) > -1) {
      return type;
    }
  }
};

const shouldShowMediaPreview = (file, fileType) => {
  if (!fileType) {
    return false;
  }

  if (isIE11) {
    return false;
  } // Avoid preview if file size bigger than 10mb


  if (file.size > 10000000) {
    return false;
  }

  if (!Object.values(FilePreviewType).includes(fileType)) {
    return false;
  }

  return true;
};

const FilePreview = _ref => {
  let {
    file
  } = _ref;
  const fileType = getFileType(file.type);

  if (shouldShowMediaPreview(file, fileType)) {
    return /*#__PURE__*/React.createElement(MediaPreview, {
      file: file,
      fileType: fileType
    });
  }

  return /*#__PURE__*/React.createElement(GenericPreview, {
    file: file
  });
};

module.exportDefault(FilePreview);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"FileUploadModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/FileUploadModal.tsx                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Modal, Box, Field, FieldGroup, TextInput, ButtonGroup, Button;
module.link("@rocket.chat/fuselage", {
  Modal(v) {
    Modal = v;
  },

  Box(v) {
    Box = v;
  },

  Field(v) {
    Field = v;
  },

  FieldGroup(v) {
    FieldGroup = v;
  },

  TextInput(v) {
    TextInput = v;
  },

  ButtonGroup(v) {
    ButtonGroup = v;
  },

  Button(v) {
    Button = v;
  }

}, 0);
let useAutoFocus;
module.link("@rocket.chat/fuselage-hooks", {
  useAutoFocus(v) {
    useAutoFocus = v;
  }

}, 1);
let React, memo, useState, useEffect;
module.link("react", {
  default(v) {
    React = v;
  },

  memo(v) {
    memo = v;
  },

  useState(v) {
    useState = v;
  },

  useEffect(v) {
    useEffect = v;
  }

}, 2);
let useToastMessageDispatch;
module.link("../../../../contexts/ToastMessagesContext", {
  useToastMessageDispatch(v) {
    useToastMessageDispatch = v;
  }

}, 3);
let useTranslation;
module.link("../../../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 4);
let FilePreview;
module.link("./FilePreview", {
  default(v) {
    FilePreview = v;
  }

}, 5);

const FileUploadModal = _ref => {
  let {
    onClose,
    file,
    fileName,
    onSubmit,
    invalidContentType
  } = _ref;
  const [name, setName] = useState(fileName);
  const [description, setDescription] = useState('');
  const t = useTranslation();
  const dispatchToastMessage = useToastMessageDispatch();
  const ref = useAutoFocus();

  const handleName = e => {
    setName(e.currentTarget.value);
  };

  const handleDescription = e => {
    setDescription(e.currentTarget.value);
  };

  const handleSubmit = e => {
    e.preventDefault();

    if (!name) {
      return dispatchToastMessage({
        type: 'error',
        message: t('error-the-field-is-required', {
          field: t('Name')
        })
      });
    }

    onSubmit(name, description);
  };

  useEffect(() => {
    if (invalidContentType) {
      dispatchToastMessage({
        type: 'error',
        message: t('FileUpload_MediaType_NotAccepted__type__', {
          type: file.type
        })
      });
      onClose();
      return;
    }

    if (file.size === 0) {
      dispatchToastMessage({
        type: 'error',
        message: t('FileUpload_File_Empty')
      });
      onClose();
    }
  }, [file, dispatchToastMessage, invalidContentType, t, onClose]);
  return /*#__PURE__*/React.createElement(Modal, null, /*#__PURE__*/React.createElement(Box, {
    is: "form",
    display: "flex",
    flexDirection: "column",
    height: "100%",
    onSubmit: handleSubmit
  }, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, null, t('FileUpload')), /*#__PURE__*/React.createElement(Modal.Close, {
    onClick: onClose
  })), /*#__PURE__*/React.createElement(Modal.Content, {
    overflow: "hidden"
  }, /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    maxHeight: "x360",
    w: "full",
    justifyContent: "center",
    alignContent: "center",
    mbe: "x16"
  }, /*#__PURE__*/React.createElement(FilePreview, {
    file: file
  })), /*#__PURE__*/React.createElement(FieldGroup, null, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Upload_file_name')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {
    value: name,
    onChange: handleName
  })), !name && /*#__PURE__*/React.createElement(Field.Error, null, t('error-the-field-is-required', {
    field: t('Name')
  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Upload_file_description')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {
    value: description,
    onChange: handleDescription,
    placeholder: t('Description'),
    ref: ref
  }))))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(ButtonGroup, {
    align: "end"
  }, /*#__PURE__*/React.createElement(Button, {
    ghost: true,
    onClick: onClose
  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {
    primary: true,
    type: "submit",
    disabled: !name
  }, t('Send'))))));
};

module.exportDefault( /*#__PURE__*/memo(FileUploadModal));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"GenericPreview.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/GenericPreview.tsx                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box, Icon;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  Icon(v) {
    Icon = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);
let formatBytes;
module.link("../../../../lib/utils/formatBytes", {
  formatBytes(v) {
    formatBytes = v;
  }

}, 2);

const GenericPreview = _ref => {
  let {
    file
  } = _ref;
  return /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    alignItems: "center",
    w: "full",
    fontScale: "h4"
  }, /*#__PURE__*/React.createElement(Icon, {
    name: "file",
    size: "x24",
    mis: -2,
    mie: 4
  }), "".concat(file.name, " - ").concat(formatBytes(file.size, 2)));
};

module.exportDefault(GenericPreview);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ImagePreview.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/ImagePreview.tsx                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 0);
let React, useState;
module.link("react", {
  default(v) {
    React = v;
  },

  useState(v) {
    useState = v;
  }

}, 1);
let GenericPreview;
module.link("./GenericPreview", {
  default(v) {
    GenericPreview = v;
  }

}, 2);
let PreviewSkeleton;
module.link("./PreviewSkeleton", {
  default(v) {
    PreviewSkeleton = v;
  }

}, 3);

const ImagePreview = _ref => {
  let {
    url,
    file
  } = _ref;
  const [error, setError] = useState(false);
  const [loading, setLoading] = useState(true);

  const handleLoad = () => setLoading(false);

  const handleError = () => {
    setLoading(false);
    setError(true);
  };

  if (error) {
    return /*#__PURE__*/React.createElement(GenericPreview, {
      file: file
    });
  }

  return /*#__PURE__*/React.createElement(React.Fragment, null, loading && /*#__PURE__*/React.createElement(PreviewSkeleton, null), /*#__PURE__*/React.createElement(Box, {
    is: "img",
    src: url,
    maxWidth: "full",
    style: {
      objectFit: 'contain'
    },
    onLoad: handleLoad,
    onError: handleError,
    display: loading ? 'none' : 'initial'
  }));
};

module.exportDefault(ImagePreview);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"MediaPreview.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/MediaPreview.tsx                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box, Icon;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  Icon(v) {
    Icon = v;
  }

}, 0);
let React, useEffect, useState, memo;
module.link("react", {
  default(v) {
    React = v;
  },

  useEffect(v) {
    useEffect = v;
  },

  useState(v) {
    useState = v;
  },

  memo(v) {
    memo = v;
  }

}, 1);
let useTranslation;
module.link("../../../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 2);
let FilePreviewType;
module.link("./FilePreview", {
  FilePreviewType(v) {
    FilePreviewType = v;
  }

}, 3);
let ImagePreview;
module.link("./ImagePreview", {
  default(v) {
    ImagePreview = v;
  }

}, 4);
let PreviewSkeleton;
module.link("./PreviewSkeleton", {
  default(v) {
    PreviewSkeleton = v;
  }

}, 5);

const readFileAsDataURL = (file, callback) => {
  const reader = new FileReader();

  reader.onload = e => {
    var _e$target;

    return callback((e === null || e === void 0 ? void 0 : (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.result) || null);
  };

  return reader.readAsDataURL(file);
};

const useFileAsDataURL = file => {
  const [loaded, setLoaded] = useState(false);
  const [url, setUrl] = useState(null);
  useEffect(() => {
    setLoaded(false);
    readFileAsDataURL(file, url => {
      setUrl(url);
      setLoaded(true);
    });
  }, [file]);
  return [loaded, url];
};

const MediaPreview = _ref => {
  let {
    file,
    fileType
  } = _ref;
  const [loaded, url] = useFileAsDataURL(file);
  const t = useTranslation();

  if (!loaded) {
    return /*#__PURE__*/React.createElement(PreviewSkeleton, null);
  }

  if (typeof url !== 'string') {
    return /*#__PURE__*/React.createElement(Box, {
      display: "flex",
      alignItems: "center",
      w: "full"
    }, /*#__PURE__*/React.createElement(Icon, {
      name: "image",
      size: "x24",
      mie: "x4"
    }), t('FileUpload_Cannot_preview_file'));
  }

  if (fileType === FilePreviewType.IMAGE) {
    return /*#__PURE__*/React.createElement(ImagePreview, {
      url: url,
      file: file
    });
  }

  if (fileType === FilePreviewType.VIDEO) {
    return /*#__PURE__*/React.createElement(Box, {
      is: "video",
      w: "full",
      controls: true
    }, /*#__PURE__*/React.createElement("source", {
      src: url,
      type: file.type
    }), t('Browser_does_not_support_video_element'));
  }

  if (fileType === FilePreviewType.AUDIO) {
    return /*#__PURE__*/React.createElement(Box, {
      is: "audio",
      w: "full",
      controls: true
    }, /*#__PURE__*/React.createElement("source", {
      src: url,
      type: file.type
    }), t('Browser_does_not_support_audio_element'));
  }

  throw new Error('Wrong props provided for MediaPreview');
};

module.exportDefault( /*#__PURE__*/memo(MediaPreview));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"PreviewSkeleton.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/PreviewSkeleton.tsx                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Skeleton;
module.link("@rocket.chat/fuselage", {
  Skeleton(v) {
    Skeleton = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const PreviewSkeleton = () => /*#__PURE__*/React.createElement(Skeleton, {
  variant: "rect",
  w: "full",
  h: "x200"
});

module.exportDefault(PreviewSkeleton);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/index.ts                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./FileUploadModal", {
  default: "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ReactionListModal":{"ReactionListModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReactionListModal/ReactionListModal.tsx                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMutableCallback;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback(v) {
    useMutableCallback = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);
let openUserCard;
module.link("../../../../../app/ui/client/lib/UserCard", {
  openUserCard(v) {
    openUserCard = v;
  }

}, 2);
let GenericModal;
module.link("../../../../components/GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 3);
let useTranslation;
module.link("../../../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 4);
let Reactions;
module.link("./Reactions", {
  default(v) {
    Reactions = v;
  }

}, 5);

const ReactionList = _ref => {
  let {
    rid,
    reactions,
    tabBar,
    onClose
  } = _ref;
  const t = useTranslation();
  const onClick = useMutableCallback(e => {
    const {
      username
    } = e.currentTarget.dataset;

    if (!username) {
      return;
    }

    openUserCard({
      username,
      rid,
      target: e.currentTarget,
      open: e => {
        e.preventDefault();
        onClose();
        tabBar.openUserInfo(username);
      }
    });
  });
  return /*#__PURE__*/React.createElement(GenericModal, {
    variant: "info",
    title: t('Users_reacted'),
    onClose: onClose,
    onConfirm: onClose
  }, /*#__PURE__*/React.createElement(Reactions, {
    reactions: reactions,
    onClick: onClick
  }));
};

module.exportDefault(ReactionList);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ReactionUserTag.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReactionListModal/ReactionUserTag.tsx                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box, Tag;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  Tag(v) {
    Tag = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const ReactionUserTag = _ref => {
  let {
    username,
    onClick,
    displayName
  } = _ref;
  return /*#__PURE__*/React.createElement(Box, {
    mie: "x4",
    mbe: "x4",
    "data-username": username,
    onClick: onClick,
    key: displayName
  }, /*#__PURE__*/React.createElement(Tag, {
    variant: "secondary"
  }, displayName));
};

module.exportDefault(ReactionUserTag);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Reactions.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReactionListModal/Reactions.tsx                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);
let Emoji;
module.link("../../../../components/Emoji", {
  default(v) {
    Emoji = v;
  }

}, 2);
let useSetting;
module.link("../../../../contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 3);
let ReactionUserTag;
module.link("./ReactionUserTag", {
  default(v) {
    ReactionUserTag = v;
  }

}, 4);

const Reactions = _ref => {
  let {
    reactions,
    onClick
  } = _ref;
  const useRealName = useSetting('UI_Use_Real_Name');
  return /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    flexDirection: "column"
  }, Object.entries(reactions).map(_ref2 => {
    let [reaction, {
      names = [],
      usernames
    }] = _ref2;
    return /*#__PURE__*/React.createElement(Box, {
      key: reaction,
      display: "flex",
      alignItems: "center",
      flexDirection: "row",
      overflowX: "hidden",
      mb: "x8"
    }, /*#__PURE__*/React.createElement(Emoji, {
      emojiHandle: reaction
    }), /*#__PURE__*/React.createElement(Box, {
      display: "flex",
      flexWrap: "wrap",
      paddingBlock: "x4",
      mis: "x4"
    }, usernames.map((username, i) => /*#__PURE__*/React.createElement(ReactionUserTag, {
      key: username,
      displayName: useRealName ? names[i] || username : username,
      username: username,
      onClick: onClick
    }))));
  }));
};

module.exportDefault(Reactions);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReactionListModal/index.ts                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./ReactionListModal", {
  default: "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ReadReceiptsModal":{"ReadReceiptRow.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReadReceiptsModal/ReadReceiptRow.tsx                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _templateObject;

let _taggedTemplateLiteral;

module.link("@babel/runtime/helpers/taggedTemplateLiteral", {
  default(v) {
    _taggedTemplateLiteral = v;
  }

}, 0);
let css;
module.link("@rocket.chat/css-in-js", {
  css(v) {
    css = v;
  }

}, 0);
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 1);
let colors;
module.link("@rocket.chat/fuselage-tokens/colors", {
  default(v) {
    colors = v;
  }

}, 2);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 3);
let UserAvatar;
module.link("../../../../components/avatar/UserAvatar", {
  default(v) {
    UserAvatar = v;
  }

}, 4);
let useFormatDateAndTime;
module.link("../../../../hooks/useFormatDateAndTime", {
  useFormatDateAndTime(v) {
    useFormatDateAndTime = v;
  }

}, 5);
let useUserDisplayName;
module.link("../../../../hooks/useUserDisplayName", {
  useUserDisplayName(v) {
    useUserDisplayName = v;
  }

}, 6);
const hoverStyle = css(_templateObject || (_templateObject = _taggedTemplateLiteral(["\n\t&:hover {\n\t\tbackground-color: ", ";\n\t}\n"])), colors.n400);

const ReadReceiptRow = _ref => {
  let {
    user,
    ts
  } = _ref;
  const displayName = useUserDisplayName(user);
  const formatDateAndTime = useFormatDateAndTime();
  return /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    flexDirection: "row",
    justifyContent: "space-between",
    alignItems: "center",
    p: "x4",
    pi: "x32",
    mi: "neg-x32",
    className: hoverStyle
  }, /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(UserAvatar, {
    username: user.username || '',
    size: "x24"
  }), /*#__PURE__*/React.createElement(Box, {
    is: "span",
    mis: "x8"
  }, displayName)), /*#__PURE__*/React.createElement(Box, {
    is: "span",
    fontScale: "c1",
    color: "info"
  }, formatDateAndTime(ts)));
};

module.exportDefault(ReadReceiptRow);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ReadReceiptsModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReadReceiptsModal/ReadReceiptsModal.tsx                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let Skeleton;
module.link("@rocket.chat/fuselage", {
  Skeleton(v) {
    Skeleton = v;
  }

}, 0);
let React, useMemo, useEffect;
module.link("react", {
  default(v) {
    React = v;
  },

  useMemo(v) {
    useMemo = v;
  },

  useEffect(v) {
    useEffect = v;
  }

}, 1);
let GenericModal;
module.link("../../../../components/GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 2);
let useToastMessageDispatch;
module.link("../../../../contexts/ToastMessagesContext", {
  useToastMessageDispatch(v) {
    useToastMessageDispatch = v;
  }

}, 3);
let useTranslation;
module.link("../../../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 4);
let useMethodData;
module.link("../../../../hooks/useMethodData", {
  useMethodData(v) {
    useMethodData = v;
  }

}, 5);
let AsyncStatePhase;
module.link("../../../../lib/asyncState", {
  AsyncStatePhase(v) {
    AsyncStatePhase = v;
  }

}, 6);
let ReadReceiptRow;
module.link("./ReadReceiptRow", {
  default(v) {
    ReadReceiptRow = v;
  }

}, 7);

const ReadReceiptsModal = _ref => {
  let {
    messageId,
    onClose
  } = _ref;
  const t = useTranslation();
  const dispatchToastMessage = useToastMessageDispatch();
  const {
    phase,
    value,
    error
  } = useMethodData('getReadReceipts', useMemo(() => [{
    messageId
  }], [messageId]));
  useEffect(() => {
    if (error) {
      dispatchToastMessage({
        type: 'error',
        message: error
      });
      onClose();
    }
  }, [error, dispatchToastMessage, t, onClose]);

  if (phase === AsyncStatePhase.LOADING || !value || error) {
    return /*#__PURE__*/React.createElement(GenericModal, {
      title: t('Read_by'),
      onConfirm: onClose,
      onClose: onClose
    }, /*#__PURE__*/React.createElement(Skeleton, {
      type: "rect",
      w: "full",
      h: "x120"
    }));
  }

  return /*#__PURE__*/React.createElement(GenericModal, {
    title: t('Read_by'),
    onConfirm: onClose,
    onClose: onClose
  }, value.length < 1 && t('No_results_found'), value.map(receipt => /*#__PURE__*/React.createElement(ReadReceiptRow, _extends({}, receipt, {
    key: receipt._id
  }))));
};

module.exportDefault(ReadReceiptsModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReadReceiptsModal/index.ts                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./ReadReceiptsModal", {
  default: "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"Announcement":{"Announcement.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/MarkdownText",
  "../../../contexts/ModalContext",
  "./AnnouncementComponent",
  "./AnnouncementModal"
],"AnnouncementComponent.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react"
],"AnnouncementModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/MarkdownText",
  "../../../contexts/TranslationContext"
],"index.tsx":[
  "./Announcement"
]},"UserCard":{"index.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Backdrop",
  "../../../components/LocalTime",
  "../../../components/UserCard",
  "../../../components/UserStatus",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../../hooks/useActionSpread",
  "../hooks/useUserInfoActions"
]},"contexts":{"RoomContext.ts":[
  "react",
  "../../../../definition/IRoom"
]},"hooks":{"useAppsContextualBar.ts":[
  "react",
  "../../../../app/apps/client/orchestrator",
  "../../../../app/ui-message/client/ActionManager",
  "../../../contexts/RouterContext",
  "../contexts/RoomContext"
],"useUserInfoActions.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/string-helpers",
  "react",
  "../../../../app/models/client",
  "../../../../app/utils/client",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useEndpointActionExperimental",
  "../../../hooks/useReactiveValue",
  "../../teams/contextualBar/members/RemoveUsersModal",
  "./useUserRoom",
  "./useWebRTC"
],"useUserRoom.js":[
  "react",
  "../../../../app/models/client",
  "../../../hooks/useReactiveValue"
],"useWebRTC.ts":[
  "react",
  "../../../../app/webrtc/client"
]},"providers":{"RoomProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../../app/ui",
  "../../../../app/utils/client",
  "../../../contexts/UserContext",
  "../../../lib/RoomManager",
  "../../../lib/asyncState",
  "../Room/Skeleton",
  "../contexts/RoomContext",
  "./ToolboxProvider"
],"ToolboxProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/SessionContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/UserContext",
  "../lib/Toolbox/ToolboxContext",
  "./VirtualAction"
],"VirtualAction.tsx":[
  "react"
]},"threads":{"ThreadComponent.tsx":[
  "@rocket.chat/fuselage-hooks",
  "meteor/blaze",
  "meteor/templating",
  "meteor/tracker",
  "react",
  "../../../../app/models/client",
  "../../../../app/threads/client/lib/normalizeThreadTitle",
  "../../../../app/utils/client",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/UserContext",
  "../../../lib/utils/mapMessageFromApi",
  "../providers/ToolboxProvider",
  "./ThreadSkeleton",
  "./ThreadView"
],"ThreadSkeleton.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar"
],"ThreadView.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/TranslationContext",
  "../../../providers/LayoutProvider"
]},"webdav":{"AddWebdavAccountModal.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "react-hook-form",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
]},"MemberListRouter.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "../../contexts/UserContext",
  "./contexts/RoomContext",
  "./contextualBar/RoomMembers",
  "./contextualBar/UserInfo",
  "./providers/ToolboxProvider"
]},"admin":{"apps":{"lib":{"getManifestFromZippedApp.ts":[
  "fflate"
]},"components":{"CategoryDropDown.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react",
  "./CategoryDropDownAnchor",
  "./CategoryDropDownList",
  "./CategoryDropDownListWrapper"
],"CategoryDropDownAnchor.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"CategoryDropDownList.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"CategoryDropDownListWrapper.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react"
],"TagList.tsx":[
  "@rocket.chat/fuselage",
  "react"
]},"helpers":{"filterAppByCategories.ts":[],"filterAppByText.ts":[]},"hooks":{"useAppInfo.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../../../app/apps/client/orchestrator",
  "../AppsContext",
  "../helpers"
],"useCategories.ts":[
  "react",
  "../../../../../app/apps/client/orchestrator",
  "../../../../contexts/TranslationContext",
  "../helpers",
  "./useCategoryFlatList",
  "./useCategoryToggle"
],"useCategoryFlatList.ts":[
  "react"
],"useCategoryToggle.ts":[
  "react"
],"useFilteredApps.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../../lib/asyncState",
  "../helpers/filterAppByCategories",
  "../helpers/filterAppByText"
]},"APIsDisplay.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "./helpers"
],"AppDetailsPage.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/apps/client/orchestrator",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./APIsDisplay",
  "./AppDetailsPageContent",
  "./LoadingDetails",
  "./SettingsDisplay",
  "./helpers",
  "./hooks/useAppInfo"
],"AppDetailsPageContent.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/ExternalLink",
  "../../../components/avatar/AppAvatar",
  "../../../contexts/TranslationContext",
  "./AppMenu",
  "./AppStatus",
  "./PriceDisplay"
],"AppInstallPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/apps/client/orchestrator",
  "../../../components/Page",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFileInput",
  "../../../hooks/useForm",
  "./AppPermissionsReviewModal",
  "./AppUpdateModal",
  "./helpers",
  "./lib/getManifestFromZippedApp"
],"AppLogsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime",
  "./LogItem",
  "./LogsLoading"
],"AppMenu.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "./CloudLoginModal",
  "./IframeModal",
  "./WarningModal",
  "./helpers"
],"AppPermissionsReviewModal.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"AppRow.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/avatar/AppAvatar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./AppMenu",
  "./AppStatus"
],"AppSetting.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/MarkdownText",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../settings/MemoizedSetting"
],"AppSettingsAssembler.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/string-helpers",
  "react",
  "./AppSetting"
],"AppStatus.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/apps/client/orchestrator",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "./AppPermissionsReviewModal",
  "./CloudLoginModal",
  "./IframeModal",
  "./helpers"
],"AppUpdateModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"AppsContext.tsx":[
  "react",
  "../../../lib/asyncState"
],"AppsPage.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "./AppsTable"
],"AppsProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/apps/client/communication",
  "../../../../app/apps/client/orchestrator",
  "../../../lib/asyncState",
  "./AppsContext",
  "./helpers"
],"AppsRoute.tsx":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/PageSkeleton",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "./AppDetailsPage",
  "./AppInstallPage",
  "./AppLogsPage",
  "./AppsPage",
  "./AppsProvider"
],"AppsTable.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/GenericTable/hooks/usePagination",
  "../../../components/GenericTable/hooks/useSort",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useResizeInlineBreakpoint",
  "../../../lib/asyncState",
  "./AppRow",
  "./AppsContext",
  "./MarketplaceRow",
  "./components/CategoryDropDown",
  "./components/TagList",
  "./hooks/useCategories",
  "./hooks/useFilteredApps"
],"AppsWhatIsIt.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/apps/client",
  "../../../components/ExternalLink",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext"
],"CloudLoginModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext"
],"IframeModal.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"LoadingDetails.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"LogEntry.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useHighlightedCode"
],"LogItem.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "./LogEntry"
],"LogsLoading.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"MarketplaceRow.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/avatar/AppAvatar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./AppMenu",
  "./AppStatus",
  "./PriceDisplay"
],"PriceDisplay.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "./helpers"
],"SettingsDisplay.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./AppSettingsAssembler"
],"WarningModal.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"helpers.js":[
  "@rocket.chat/apps-engine/definition/AppStatus",
  "semver",
  "../../../../app/apps/lib/misc/Utilities",
  "../../../../app/utils/client",
  "../../../lib/toast"
]},"info":{"FederationCard":{"components":{"FederationModal":{"DNSRecordItem.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../Section",
  "../SectionStatusIcon"
],"DNSRecords.tsx":[
  "@rocket.chat/fuselage",
  "lodash",
  "react",
  "../../../../../../contexts/TranslationContext",
  "../Section",
  "./DNSRecordItem",
  "./DNSText",
  "./Types"
],"DNSText.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"FederationModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "psl",
  "react",
  "../../../../../../contexts/SettingsContext",
  "../../../../../../contexts/TranslationContext",
  "../../../../../../hooks/useForm",
  "./DNSRecords",
  "./InviteUsers",
  "./Types"
],"InviteUsers.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../contexts/RouterContext",
  "../../../../../../contexts/TranslationContext"
],"Types.ts":[],"index.ts":[
  "./FederationModal"
]},"CardHeader.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Section.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/Card",
  "./SectionStatusIcon"
],"SectionStatusIcon.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./Section"
],"index.ts":[
  "./CardHeader",
  "./Section"
]},"FederationCard.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/Card",
  "../../../../contexts/ModalContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext",
  "../../../../providers/SettingsProvider",
  "./components",
  "./components/FederationModal",
  "./components/Section"
],"index.ts":[
  "./FederationCard"
]},"DeploymentCard.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Card",
  "../../../contexts/ModalContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime",
  "./InstancesModal"
],"DescriptionList.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./DescriptionListEntry"
],"DescriptionListEntry.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"Feature.js":[
  "@rocket.chat/fuselage",
  "react"
],"InformationPage.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../ee/client/views/admin/info/SeatsCard",
  "../../../components/Card",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./DeploymentCard",
  "./FederationCard",
  "./LicenseCard",
  "./UsageCard"
],"InformationRoute.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../lib/download",
  "./InformationPage"
],"InstancesModal.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime",
  "./DescriptionList"
],"LicenseCard.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Card",
  "../../../components/PlanTag",
  "../../../contexts/ModalContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./Feature",
  "./OfflineLicenseModal"
],"OfflineLicenseModal.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointActionExperimental"
],"TextSeparator.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/DotLeader"
],"UsageCard.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../ee/client/hooks/useHasLicense",
  "../../../components/Card",
  "../../../components/UserStatus",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatMemorySize",
  "./TextSeparator"
],"UsagePieGraph.tsx":[
  "@nivo/pie",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../hooks/useLocalePercentage"
]},"integrations":{"edit":{"EditIncomingWebhook.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/ModalContext",
  "../../../../contexts/RouterContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointAction",
  "../../../../hooks/useForm",
  "../IncomingWebhookForm"
],"EditIncomingWebhookWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./EditIncomingWebhook"
],"EditIntegrationsPage.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/Page",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "./EditIncomingWebhookWithData",
  "./EditOutgoingWebhookWithData"
],"EditOutgoingWebhook.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/ModalContext",
  "../../../../contexts/RouterContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointAction",
  "../../../../hooks/useForm",
  "../OutgoiongWebhookForm",
  "../helpers/triggerWords"
],"EditOutgoingWebhookWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./EditOutgoingWebhook"
],"HistoryContent.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "./HistoryItem"
],"HistoryItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/integrations/lib/rocketchat",
  "../../../../contexts/ServerContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useFormatDateAndTime",
  "../../../../hooks/useHighlightedCode"
],"OutgoingWebhookHistoryPage.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/integrations/client/streamer",
  "../../../../components/Page",
  "../../../../contexts/RouterContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./HistoryContent"
]},"helpers":{"triggerWords.ts":[]},"new":{"NewBot.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext"
],"NewIncomingWebhook.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointAction",
  "../../../../hooks/useForm",
  "../IncomingWebhookForm"
],"NewIntegrationsPage.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/Page",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "./NewIncomingWebhook",
  "./NewOutgoingWebhook"
],"NewOutgoingWebhook.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointAction",
  "../../../../hooks/useForm",
  "../OutgoiongWebhookForm",
  "../helpers/triggerWords"
],"NewZapier.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext"
]},"FilterByTypeAndText.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"IncomingWebhookForm.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useHighlightedCode",
  "./exampleIncomingData"
],"IntegrationRow.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../hooks/useFormatDateAndTime"
],"IntegrationsPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./IntegrationsTable",
  "./new/NewBot",
  "./new/NewZapier"
],"IntegrationsRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "./IntegrationsPage",
  "./edit/EditIntegrationsPage",
  "./edit/OutgoingWebhookHistoryPage",
  "./new/NewIntegrationsPage"
],"IntegrationsTable.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./FilterByTypeAndText",
  "./IntegrationRow"
],"OutgoiongWebhookForm.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/integrations/lib/rocketchat",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "../../../hooks/useHighlightedCode",
  "./exampleIncomingData"
],"exampleIncomingData.js":[
  "@babel/runtime/helpers/objectSpread2",
  "react"
]},"permissions":{"hooks":{"usePermissionsAndRoles.ts":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/authorization/client/lib/ChatPermissions",
  "../../../../../app/authorization/lib",
  "../../../../../app/models/client",
  "../../../../hooks/useReactiveValue"
]},"EditRolePage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./RoleForm"
],"EditRolePageContainer.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "./EditRolePage",
  "./useRole"
],"FilterComponent.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"NewRolePage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./RoleForm"
],"PermissionRow.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/authorization/lib",
  "../../../contexts/ToastMessagesContext",
  "./RoleCell"
],"PermissionsContextBar.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./EditRolePageContainer",
  "./NewRolePage"
],"PermissionsRouter.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "./PermissionsTable",
  "./UsersInRolePageContainer"
],"PermissionsTable.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/Page",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "./FilterComponent",
  "./PermissionRow",
  "./PermissionsContextBar",
  "./RoleHeader",
  "./hooks/usePermissionsAndRoles"
],"RoleCell.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/authorization/lib"
],"RoleForm.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"RoleHeader.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable"
],"UserRow.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../lib/getUserEmailAddress",
  "../../../components/avatar/UserAvatar"
],"UsersInRolePage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../components/RoomAutoComplete",
  "../../../components/UserAutoComplete",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./UsersInRoleTableContainer"
],"UsersInRolePageContainer.js":[
  "react",
  "../../../contexts/RouterContext",
  "./UsersInRolePage",
  "./useRole"
],"UsersInRoleTable.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../components/GenericTable",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./UserRow"
],"UsersInRoleTableContainer.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../hooks/useEndpointData",
  "./UsersInRoleTable"
],"useRole.js":[
  "react",
  "../../../../app/models/client",
  "../../../hooks/useReactiveValue"
]},"settings":{"groups":{"AssetsGroupPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/EditableSettingsContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../GroupPage",
  "../Section"
],"GenericGroupPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../contexts/EditableSettingsContext",
  "../GroupPage",
  "../Section"
],"LDAPGroupPage.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/EditableSettingsContext",
  "../../../../contexts/ModalContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "./TabbedGroupPage"
],"OAuthGroupPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "underscore.string",
  "../../../../contexts/EditableSettingsContext",
  "../../../../contexts/ModalContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../GroupPage",
  "../Section"
],"TabbedGroupPage.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/EditableSettingsContext",
  "../../../../contexts/TranslationContext",
  "../GroupPage",
  "../Section",
  "./GenericGroupPage"
]},"inputs":{"ActionSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext"
],"AssetSettingInput.css":[],"AssetSettingInput.js":[
  "@rocket.chat/fuselage",
  "meteor/random",
  "react",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "./AssetSettingInput.css"
],"BooleanSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
],"CodeMirror.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react"
],"CodeSettingInput.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/TranslationContext",
  "../ResetSettingButton",
  "./CodeMirror"
],"ColorSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../ResetSettingButton"
],"FontSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
],"GenericSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
],"IntSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
],"LanguageSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../ResetSettingButton"
],"MultiSelectSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../ResetSettingButton"
],"PasswordSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
],"RelativeUrlSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/ServerContext",
  "../ResetSettingButton"
],"RoomPickSettingInput.js":[
  "@rocket.chat/fuselage",
  "meteor/blaze",
  "meteor/templating",
  "react",
  "../ResetSettingButton"
],"SelectSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../ResetSettingButton"
],"SelectTimezoneSettingInput.js":[
  "@rocket.chat/fuselage",
  "moment-timezone",
  "react",
  "../ResetSettingButton"
],"StringSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
]},"GroupPage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/EditableSettingsContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "./GroupPageSkeleton"
],"GroupPageSkeleton.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./Section"
],"GroupSelector.tsx":[
  "react",
  "../../../contexts/SettingsContext",
  "./GroupPage",
  "./groups/AssetsGroupPage",
  "./groups/LDAPGroupPage",
  "./groups/OAuthGroupPage",
  "./groups/TabbedGroupPage"
],"MemoizedSetting.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./inputs/ActionSettingInput",
  "./inputs/AssetSettingInput",
  "./inputs/BooleanSettingInput",
  "./inputs/CodeSettingInput",
  "./inputs/ColorSettingInput",
  "./inputs/FontSettingInput",
  "./inputs/GenericSettingInput",
  "./inputs/IntSettingInput",
  "./inputs/LanguageSettingInput",
  "./inputs/MultiSelectSettingInput",
  "./inputs/PasswordSettingInput",
  "./inputs/RelativeUrlSettingInput",
  "./inputs/RoomPickSettingInput",
  "./inputs/SelectSettingInput",
  "./inputs/SelectTimezoneSettingInput",
  "./inputs/StringSettingInput"
],"ResetSettingButton.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"Section.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/EditableSettingsContext",
  "../../../contexts/TranslationContext",
  "./SectionSkeleton",
  "./Setting"
],"SectionSkeleton.js":[
  "@rocket.chat/fuselage",
  "react",
  "./Setting"
],"Setting.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/MarkdownText",
  "../../../contexts/EditableSettingsContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "./MemoizedSetting",
  "./SettingSkeleton"
],"SettingSkeleton.js":[
  "@rocket.chat/fuselage",
  "react"
],"SettingsRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/RouterContext",
  "../../../contexts/SettingsContext",
  "../../../providers/EditableSettingsProvider",
  "./GroupSelector"
]},"cloud":{"CloudPage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./ConnectToCloudSection",
  "./ManualWorkspaceRegistrationModal",
  "./TroubleshootingSection",
  "./WhatIsItSection",
  "./WorkspaceLoginSection",
  "./WorkspaceRegistrationSection",
  "./constants"
],"CloudRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./CloudPage"
],"ConnectToCloudSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Subtitle",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"CopyStep.tsx":[
  "@rocket.chat/fuselage",
  "clipboard",
  "react",
  "../../../components/MarkdownText",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./constants"
],"ManualWorkspaceRegistrationModal.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "./CopyStep",
  "./PasteStep"
],"PasteStep.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"TroubleshootingSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Subtitle",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./constants"
],"WhatIsItSection.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Subtitle",
  "../../../contexts/TranslationContext"
],"WorkspaceLoginSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"WorkspaceRegistrationSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"constants.js":[]},"customEmoji":{"AddCustomEmoji.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointUpload",
  "../../../hooks/useFileInput"
],"CustomEmoji.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/GenericTable/hooks/usePagination",
  "../../../components/GenericTable/hooks/useSort",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../../../lib/asyncState"
],"CustomEmojiRoute.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./AddCustomEmoji",
  "./CustomEmoji",
  "./EditCustomEmojiWithData"
],"EditCustomEmoji.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction",
  "../../../hooks/useEndpointUpload",
  "../../../hooks/useFileInput"
],"EditCustomEmojiWithData.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditCustomEmoji"
]},"customSounds":{"AddCustomSound.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFileInput",
  "./lib"
],"AdminSounds.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../contexts/CustomSoundContext",
  "../../../contexts/TranslationContext"
],"AdminSoundsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./AddCustomSound",
  "./AdminSounds",
  "./EditCustomSound"
],"EditCustomSound.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditSound"
],"EditSound.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFileInput",
  "./lib"
],"lib.js":[]},"customUserStatus":{"AddCustomUserStatus.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"CustomUserStatus.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/MarkdownText",
  "../../../contexts/TranslationContext"
],"CustomUserStatusRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./AddCustomUserStatus",
  "./CustomUserStatus",
  "./EditCustomUserStatusWithData"
],"EditCustomUserStatus.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"EditCustomUserStatusWithData.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditCustomUserStatus"
]},"emailInbox":{"EmailInboxEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EmailInboxForm",
  "./Skeleton"
],"EmailInboxForm.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../lib/emailValidator",
  "../../../components/AutoCompleteDepartment",
  "../../../components/GenericModal",
  "../../../components/Page",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useComponentDidUpdate",
  "../../../hooks/useForm"
],"EmailInboxPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./EmailInboxEditWithData",
  "./EmailInboxForm",
  "./EmailInboxTable"
],"EmailInboxRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./EmailInboxPage"
],"EmailInboxTable.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./SendTestButton"
],"SendTestButton.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"Skeleton.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
]},"federationDashboard":{"FederationDashboardPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./OverviewSection",
  "./ServersSection"
],"FederationDashboardRoute.tsx":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./FederationDashboardPage"
],"OverviewSection.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/data/CounterSet",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/usePolledMethodData"
],"ServersSection.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../hooks/useAsyncState",
  "../../../hooks/usePolledMethodData"
]},"import":{"ImportHistoryPage.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/importer/lib/ImporterProgressStep",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./ImportOperationSummary"
],"ImportOperationSummary.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/importer/lib/ImporterProgressStep",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime",
  "./ImportOperationSummarySkeleton"
],"ImportOperationSummarySkeleton.js":[
  "@rocket.chat/fuselage",
  "react"
],"ImportProgressPage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "react",
  "underscore.string",
  "../../../../app/importer/lib/ImporterProgressStep",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./useErrorHandler"
],"ImportRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./ImportHistoryPage",
  "./ImportProgressPage",
  "./NewImportPage",
  "./PrepareImportPage"
],"NewImportPage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/importer/client/index",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatMemorySize",
  "./useErrorHandler"
],"PrepareChannels.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"PrepareImportPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "react",
  "underscore.string",
  "../../../../app/importer/lib/ImporterProgressStep",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "./PrepareChannels",
  "./PrepareUsers",
  "./useErrorHandler"
],"PrepareUsers.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"useErrorHandler.js":[
  "@rocket.chat/fuselage-hooks",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
]},"invites":{"InviteRow.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime",
  "../../../hooks/useTimeFromNow"
],"InvitesPage.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../components/GenericTable",
  "../../../components/Page",
  "../../../contexts/ModalContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../../../lib/asyncState",
  "./InviteRow"
],"InvitesRoute.tsx":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./InvitesPage"
]},"mailer":{"Mailer.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../lib/emailValidator",
  "../../../../lib/utils/isJSON",
  "../../../components/Page",
  "../../../contexts/TranslationContext"
],"MailerRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./Mailer"
]},"oauthApps":{"EditOauthApp.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"EditOauthAppWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditOauthApp"
],"OAuthAddApp.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"OAuthAppsPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./EditOauthAppWithData",
  "./OAuthAddApp",
  "./OAuthAppsTable"
],"OAuthAppsRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./OAuthAppsPage"
],"OAuthAppsTable.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../../../hooks/useFormatDateAndTime"
]},"rooms":{"EditRoom.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/utils/client",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../components/avatar/RoomAvatarEditor",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointActionExperimental",
  "../../../hooks/useForm"
],"EditRoomContextBar.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./EditRoomWithData"
],"EditRoomWithData.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditRoom"
],"FilterByTypeAndText.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"RoomsPage.js":[
  "react",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./EditRoomContextBar",
  "./RoomsTable"
],"RoomsRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./RoomsPage"
],"RoomsTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/utils/client",
  "../../../components/GenericTable",
  "../../../components/avatar/RoomAvatar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../../../lib/asyncState",
  "./FilterByTypeAndText"
]},"sidebar":{"AdminSidebar.js":[
  "react",
  "../../../../app/ui-utils/client",
  "../../../components/PlanTag",
  "../../../components/Sidebar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../lib/utils/isLayoutEmbedded",
  "../../../providers/SettingsProvider",
  "./AdminSidebarPages",
  "./AdminSidebarSettings"
],"AdminSidebarPages.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "use-subscription",
  "../../../components/Sidebar",
  "../sidebarItems"
],"AdminSidebarSettings.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Sidebar",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext"
]},"users":{"AddUser.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction",
  "../../../hooks/useEndpointData",
  "../../../hooks/useForm",
  "./UserForm"
],"EditUser.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/avatar/UserAvatarEditor",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction",
  "../../../hooks/useEndpointUpload",
  "../../../hooks/useForm",
  "./UserForm"
],"EditUserWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Skeleton",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditUser"
],"InviteUsers.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../lib/emailValidator",
  "../../../components/VerticalBar",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"UserForm.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../lib/emailValidator",
  "../../../components/CustomFieldsForm",
  "../../../components/VerticalBar",
  "../../../contexts/TranslationContext"
],"UserInfo.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../lib/getUserEmailAddress",
  "../../../components/Skeleton",
  "../../../components/UserCard",
  "../../../components/UserStatus",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../../../lib/utils/getUserEmailVerified",
  "../../room/contextualBar/UserInfo/UserInfo",
  "./UserInfoActions"
],"UserInfoActions.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/ConfirmOwnerChangeWarningModal",
  "../../../components/GenericModal",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../hooks/useActionSpread",
  "../../room/contextualBar/UserInfo"
],"UserPageHeaderContent.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext"
],"UserRow.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/string-helpers",
  "react",
  "../../../components/avatar/UserAvatar",
  "../../../contexts/TranslationContext"
],"UsersPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../ee/client/views/admin/users/UserPageHeaderContentWithSeatsCap",
  "../../../../ee/client/views/admin/users/useSeatsCap",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./AddUser",
  "./EditUserWithData",
  "./InviteUsers",
  "./UserInfo",
  "./UserPageHeaderContent",
  "./UsersTable"
],"UsersRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./UsersPage"
],"UsersTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./UserRow"
]},"viewLogs":{"ServerLogs.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./ansispan"
],"ViewLogsPage.tsx":[
  "react",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./ServerLogs"
],"ViewLogsRoute.tsx":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./ViewLogsPage"
],"ansispan.ts":[]},"AdministrationLayout.tsx":[
  "react",
  "../../../app/ui-utils/client"
],"AdministrationRouter.js":[
  "react",
  "../../components/PageSkeleton",
  "../../contexts/RouterContext",
  "../../providers/SettingsProvider",
  "./AdministrationLayout"
],"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/admin/index.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./routes", {
  registerAdminRoute: "registerAdminRoute"
}, 0);
module.link("./sidebarItems", {
  registerAdminSidebarItem: "registerAdminSidebarItem",
  unregisterSidebarItem: "unregisterAdminSidebarItem"
}, 1);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/admin/routes.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  registerAdminRoute: () => registerAdminRoute
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let appLayout;
module.link("../../lib/appLayout", {
  appLayout(v) {
    appLayout = v;
  }

}, 1);
let createRouteGroup;
module.link("../../lib/createRouteGroup", {
  createRouteGroup(v) {
    createRouteGroup = v;
  }

}, 2);
const registerAdminRoute = createRouteGroup('admin', '/admin', () => module.dynamicImport('./AdministrationRouter'));
registerAdminRoute('/custom-sounds/:context?/:id?', {
  name: 'custom-sounds',
  lazyRouteComponent: () => module.dynamicImport('./customSounds/AdminSoundsRoute')
});
registerAdminRoute('/apps/what-is-it', {
  name: 'admin-apps-disabled',
  lazyRouteComponent: () => module.dynamicImport('./apps/AppsWhatIsIt')
});
registerAdminRoute('/marketplace/:context?/:id?/:version?', {
  name: 'admin-marketplace',
  lazyRouteComponent: () => module.dynamicImport('./apps/AppsRoute')
});
registerAdminRoute('/apps/:context?/:id?/:version?', {
  name: 'admin-apps',
  lazyRouteComponent: () => module.dynamicImport('./apps/AppsRoute')
});
registerAdminRoute('/apps/:context?/:id?/:version?', {
  name: 'admin-apps',
  lazyRouteComponent: () => module.dynamicImport('./apps/AppsRoute')
});
registerAdminRoute('/info', {
  name: 'admin-info',
  lazyRouteComponent: () => module.dynamicImport('./info/InformationRoute')
});
registerAdminRoute('/import', {
  name: 'admin-import',
  lazyRouteComponent: () => module.dynamicImport('./import/ImportRoute'),
  props: {
    page: 'history'
  }
});
registerAdminRoute('/import/new/:importerKey?', {
  name: 'admin-import-new',
  lazyRouteComponent: () => module.dynamicImport('./import/ImportRoute'),
  props: {
    page: 'new'
  }
});
registerAdminRoute('/import/prepare', {
  name: 'admin-import-prepare',
  lazyRouteComponent: () => module.dynamicImport('./import/ImportRoute'),
  props: {
    page: 'prepare'
  }
});
registerAdminRoute('/import/progress', {
  name: 'admin-import-progress',
  lazyRouteComponent: () => module.dynamicImport('./import/ImportRoute'),
  props: {
    page: 'progress'
  }
});
registerAdminRoute('/mailer', {
  name: 'admin-mailer',
  lazyRouteComponent: () => module.dynamicImport('./mailer/MailerRoute')
});
registerAdminRoute('/oauth-apps/:context?/:id?', {
  name: 'admin-oauth-apps',
  lazyRouteComponent: () => module.dynamicImport('./oauthApps/OAuthAppsRoute')
});
registerAdminRoute('/integrations/:context?/:type?/:id?', {
  name: 'admin-integrations',
  lazyRouteComponent: () => module.dynamicImport('./integrations/IntegrationsRoute')
});
registerAdminRoute('/custom-user-status/:context?/:id?', {
  name: 'custom-user-status',
  lazyRouteComponent: () => module.dynamicImport('./customUserStatus/CustomUserStatusRoute')
});
registerAdminRoute('/emoji-custom/:context?/:id?', {
  name: 'emoji-custom',
  lazyRouteComponent: () => module.dynamicImport('./customEmoji/CustomEmojiRoute')
});
registerAdminRoute('/users/:context?/:id?', {
  name: 'admin-users',
  lazyRouteComponent: () => module.dynamicImport('./users/UsersRoute')
});
registerAdminRoute('/rooms/:context?/:id?', {
  name: 'admin-rooms',
  lazyRouteComponent: () => module.dynamicImport('./rooms/RoomsRoute')
});
registerAdminRoute('/invites', {
  name: 'invites',
  lazyRouteComponent: () => module.dynamicImport('./invites/InvitesRoute')
});
registerAdminRoute('/cloud/:page?', {
  name: 'cloud',
  lazyRouteComponent: () => module.dynamicImport('./cloud/CloudRoute')
});
registerAdminRoute('/view-logs', {
  name: 'admin-view-logs',
  lazyRouteComponent: () => module.dynamicImport('./viewLogs/ViewLogsRoute')
});
registerAdminRoute('/federation-dashboard', {
  name: 'federation-dashboard',
  lazyRouteComponent: () => module.dynamicImport('./federationDashboard/FederationDashboardRoute')
});
registerAdminRoute('/permissions/:context?/:_id?', {
  name: 'admin-permissions',
  lazyRouteComponent: () => module.dynamicImport('./permissions/PermissionsRouter')
});
registerAdminRoute('/email-inboxes/:context?/:_id?', {
  name: 'admin-email-inboxes',
  lazyRouteComponent: () => module.dynamicImport('./emailInbox/EmailInboxRoute')
});
Meteor.startup(() => {
  registerAdminRoute('/:group+', {
    name: 'admin',
    lazyRouteComponent: () => module.dynamicImport('./settings/SettingsRoute')
  });
});
registerAdminRoute('/chatpal', {
  name: 'chatpal-admin',

  action() {
    appLayout.renderMainLayout({
      center: 'ChatpalAdmin'
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"sidebarItems.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/admin/sidebarItems.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  registerAdminSidebarItem: () => registerAdminSidebarItem,
  unregisterSidebarItem: () => unregisterSidebarItem,
  itemsSubscription: () => itemsSubscription
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let hasPermission, hasRole;
module.link("../../../app/authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  },

  hasRole(v) {
    hasRole = v;
  }

}, 1);
let createSidebarItems;
module.link("../../lib/createSidebarItems", {
  createSidebarItems(v) {
    createSidebarItems = v;
  }

}, 2);
const {
  registerSidebarItem: registerAdminSidebarItem,
  unregisterSidebarItem,
  itemsSubscription
} = createSidebarItems([{
  href: 'admin-info',
  i18nLabel: 'Info',
  icon: 'info-circled',
  permissionGranted: () => hasPermission('view-statistics')
}, {
  href: 'admin-import',
  i18nLabel: 'Import',
  icon: 'import',
  permissionGranted: () => hasPermission('run-import')
}, {
  href: 'admin-users',
  i18nLabel: 'Users',
  icon: 'team',
  permissionGranted: () => hasPermission('view-user-administration')
}, {
  href: 'admin-rooms',
  i18nLabel: 'Rooms',
  icon: 'hashtag',
  permissionGranted: () => hasPermission('view-room-administration')
}, {
  href: 'invites',
  i18nLabel: 'Invites',
  icon: 'user-plus',
  permissionGranted: () => hasPermission('create-invite-links')
}, {
  icon: 'cloud-plus',
  href: 'cloud',
  i18nLabel: 'Connectivity_Services',
  permissionGranted: () => hasPermission('manage-cloud')
}, {
  href: 'admin-view-logs',
  i18nLabel: 'View_Logs',
  icon: 'post',
  permissionGranted: () => hasPermission('view-logs')
}, {
  href: 'custom-sounds',
  i18nLabel: 'Custom_Sounds',
  icon: 'volume',
  permissionGranted: () => hasPermission(['manage-sounds'])
}, {
  icon: 'discover',
  href: 'federation-dashboard',
  i18nLabel: 'Federation Dashboard',
  permissionGranted: () => hasRole(Meteor.userId(), 'admin')
}, {
  icon: 'cube',
  href: 'admin-marketplace',
  i18nLabel: 'Apps',
  permissionGranted: () => hasPermission(['manage-apps'])
}, {
  icon: 'mail',
  href: 'admin-email-inboxes',
  i18nLabel: 'Email_Inboxes',
  tag: 'Alpha',
  permissionGranted: () => hasPermission(['manage-email-inbox'])
}]);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"omnichannel":{"directory":{"chats":{"contextualBar":{"AgentField.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/UserCard",
  "../../../../../components/UserStatus",
  "../../../../../components/avatar/UserAvatar",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"ChatInfo.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "moment",
  "react",
  "../../../../../../app/authorization/client",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../hooks/useFormatDateAndTime",
  "../../../../../hooks/useFormatDuration",
  "../../../../room/contexts/RoomContext",
  "../../../components/CustomField",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "./AgentField",
  "./ContactField",
  "./DepartmentField",
  "./PriorityField",
  "./SourceField",
  "./VisitorClientInfo"
],"ChatInfoDirectory.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "moment",
  "react",
  "../../../../../../app/authorization/client",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../hooks/useFormatDateAndTime",
  "../../../../../hooks/useFormatDuration",
  "../../../components/CustomField",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "./AgentField",
  "./ContactField",
  "./DepartmentField",
  "./PriorityField",
  "./VisitorClientInfo"
],"ChatsContextualBar.js":[
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/TranslationContext",
  "../../../../room/providers/ToolboxProvider",
  "./ChatInfo",
  "./RoomEditWithData"
],"ContactField.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../app/utils/client",
  "../../../../../components/UserCard",
  "../../../../../components/UserStatus",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../lib/asyncState",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"DepartmentField.js":[
  "react",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"PriorityField.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../lib/asyncState",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"RoomEdit.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../../../../app/authorization/client",
  "../../../../../components/CustomFieldsForm",
  "../../../../../components/Omnichannel/Tags",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../../../../hooks/useForm",
  "../../../additionalForms",
  "../../Skeleton"
],"RoomEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../Skeleton",
  "./VisitorData"
],"SourceField.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/RoomIcon/OmnichannelRoomIcon",
  "../../../../../contexts/TranslationContext",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label"
],"VisitorClientInfo.js":[
  "react",
  "ua-parser-js",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../lib/asyncState",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"VisitorData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../Skeleton",
  "./RoomEdit"
]},"Chat.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../app/ui-utils/client/lib/openRoom",
  "../../../room/Room"
],"ChatTab.js":[
  "react",
  "../../../../components/NotAuthorizedPage",
  "../../../../contexts/AuthorizationContext",
  "./ChatTable"
],"ChatTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "moment",
  "react",
  "../../../../components/FilterByText",
  "../../../../components/GenericTable",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointData"
]},"contacts":{"contextualBar":{"ContactEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../Skeleton",
  "./ContactNewEdit"
],"ContactInfo.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/authorization/client",
  "../../../../../../ee/client/omnichannel/ContactManagerInfo",
  "../../../../../components/UserCard/UserCard",
  "../../../../../components/UserStatus",
  "../../../../../components/VerticalBar",
  "../../../../../components/avatar/UserAvatar",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../../../../hooks/useFormatDate",
  "../../../components/CustomField",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"ContactNewEdit.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../../../../app/authorization/client",
  "../../../../../../lib/emailValidator",
  "../../../../../components/CustomFieldsForm",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useComponentDidUpdate",
  "../../../../../hooks/useEndpointData",
  "../../../../../hooks/useForm",
  "../../../../../lib/utils/createToken",
  "../../../additionalForms",
  "../../Skeleton"
],"ContactsContextualBar.tsx":[
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/TranslationContext",
  "../../../../room/contexts/RoomContext",
  "../../../../room/providers/ToolboxProvider",
  "./ContactEditWithData",
  "./ContactInfo"
]},"ContactTab.js":[
  "react",
  "../../../../components/NotAuthorizedPage",
  "../../../../contexts/AuthorizationContext",
  "./ContactTable"
],"ContactTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/FilterByText",
  "../../../../components/GenericTable",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointData",
  "../../../../hooks/useFormatDate"
]},"ChatsContextualBar.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./Skeleton",
  "./chats/Chat",
  "./chats/contextualBar/ChatInfoDirectory",
  "./chats/contextualBar/RoomEditWithData"
],"ContactContextualBar.js":[
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./contacts/contextualBar/ContactEditWithData",
  "./contacts/contextualBar/ContactInfo",
  "./contacts/contextualBar/ContactNewEdit"
],"ContextualBar.js":[
  "react",
  "../../../contexts/RouterContext",
  "./ChatsContextualBar",
  "./ContactContextualBar"
],"OmnichannelDirectoryPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./ContextualBar",
  "./chats/ChatTab",
  "./contacts/ContactTab"
],"Skeleton.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
]},"queueList":{"hooks":{"useQuery.ts":[
  "react"
]},"QueueListFilter.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/AutoCompleteAgent",
  "../../../components/AutoCompleteDepartment",
  "../../../contexts/TranslationContext"
],"QueueListPage.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/GenericTable",
  "../../../components/Page",
  "./QueueListFilter"
],"index.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/avatar/UserAvatar",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./QueueListPage",
  "./hooks/useQuery"
]},"realTimeMonitoring":{"charts":{"AgentStatusChart.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./useUpdateChartData"
],"Chart.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"ChatDurationChart.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../../app/utils/lib/timeConverter",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./getMomentChartLabelsAndData",
  "./getMomentCurrentLabel",
  "./useUpdateChartData"
],"ChatsChart.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./useUpdateChartData"
],"ChatsPerAgentChart.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./useUpdateChartData"
],"ChatsPerDepartmentChart.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./useUpdateChartData"
],"ResponseTimesChart.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../../app/utils/lib/timeConverter",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./getMomentChartLabelsAndData",
  "./getMomentCurrentLabel",
  "./useUpdateChartData"
],"getMomentChartLabelsAndData.js":[
  "moment"
],"getMomentCurrentLabel.js":[
  "moment"
],"useUpdateChartData.js":[
  "@rocket.chat/fuselage-hooks",
  "../../../../../app/livechat/client/lib/chartHandler"
]},"counter":{"CounterContainer.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "./CounterItem",
  "./CounterRow"
],"CounterItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"CounterRow.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "react-keyed-flatten-children"
]},"overviews":{"AgentsOverview.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../hooks/useEndpointData",
  "../counter/CounterContainer"
],"ChatsOverview.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../hooks/useEndpointData",
  "../counter/CounterContainer"
],"ConversationOverview.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../hooks/useEndpointData",
  "../counter/CounterContainer"
],"ProductivityOverview.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../hooks/useEndpointData",
  "../counter/CounterContainer"
]},"RealTimeMonitoringPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/AutoCompleteDepartment",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "../../../lib/utils/getDateRange",
  "../components/Label",
  "./charts/AgentStatusChart",
  "./charts/ChatDurationChart",
  "./charts/ChatsChart",
  "./charts/ChatsPerAgentChart",
  "./charts/ChatsPerDepartmentChart",
  "./charts/ResponseTimesChart",
  "./overviews/AgentsOverview",
  "./overviews/ChatsOverview",
  "./overviews/ConversationOverview",
  "./overviews/ProductivityOverview"
]},"agents":{"AddAgent.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/UserAutoComplete",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
],"AgentEdit.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../../lib/getUserEmailAddress",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "../../room/contextualBar/UserInfo",
  "../additionalForms"
],"AgentEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Skeleton",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./AgentEdit"
],"AgentInfo.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "use-subscription",
  "../../../components/Skeleton",
  "../../../components/UserStatus",
  "../../../components/VerticalBar",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../../room/contextualBar/UserInfo",
  "../additionalForms",
  "./AgentInfoAction"
],"AgentInfoAction.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"AgentInfoActions.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction",
  "./AgentInfo"
],"AgentsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/Page",
  "./AddAgent"
],"AgentsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/NotAuthorizedPage",
  "../../../components/VerticalBar",
  "../../../components/avatar/UserAvatar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./AgentEditWithData",
  "./AgentInfo",
  "./AgentInfoActions",
  "./AgentsPage",
  "./RemoveAgentButton"
],"RemoveAgentButton.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
]},"analytics":{"AgentOverview.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext"
],"AnalyticsPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/AutoCompleteDepartment",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./AgentOverview",
  "./DateRangePicker",
  "./InterchangeableChart",
  "./Overview"
],"DateRangePicker.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "moment",
  "react",
  "../../../contexts/TranslationContext"
],"InterchangeableChart.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/livechat/client/lib/chartHandler",
  "../../../../app/utils/lib/timeConverter",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../realTimeMonitoring/charts/Chart"
],"Overview.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../realTimeMonitoring/counter/CounterItem",
  "../realTimeMonitoring/counter/CounterRow"
]},"appearance":{"AppearanceForm.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"AppearancePage.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./AppearanceForm"
],"AppearancePageContainer.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./AppearancePage"
]},"businessHours":{"BusinessHoursForm.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "./TimeRangeFieldsAssembler"
],"BusinessHoursFormContainer.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../../app/livechat/client/views/app/business-hours/BusinessHours",
  "../../../hooks/useForm",
  "../../../hooks/useReactiveValue",
  "../additionalForms",
  "./BusinessHoursForm"
],"BusinessHoursPage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext"
],"BusinessHoursRouter.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/livechat/client/views/app/business-hours/BusinessHours",
  "../../../contexts/RouterContext",
  "../../../hooks/useReactiveValue",
  "./BusinessHoursPage",
  "./EditBusinessHoursPage",
  "./NewBusinessHoursPage"
],"EditBusinessHoursPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./BusinessHoursFormContainer",
  "./BusinessHoursRouter",
  "./mapBusinessHoursForm"
],"NewBusinessHoursPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./BusinessHoursForm",
  "./BusinessHoursFormContainer",
  "./mapBusinessHoursForm"
],"TimeRangeFieldsAssembler.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext",
  "./BusinessHoursForm",
  "./TimeRangeInput"
],"TimeRangeInput.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"mapBusinessHoursForm.js":[]},"components":{"CustomField.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../directory/Skeleton",
  "./Field",
  "./Info",
  "./Label"
],"Field.js":[
  "@rocket.chat/fuselage",
  "react"
],"Info.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "react",
  "../../../components/UserCard"
],"Label.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
]},"currentChats":{"CurrentChatsPage.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/GenericTable",
  "../../../components/Page",
  "./FilterByText"
],"CurrentChatsRoute.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/kadira:flow-router",
  "moment",
  "react",
  "../../../components/GenericTable",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./CurrentChatsPage",
  "./RemoveChatButton"
],"FilterByText.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "moment",
  "react",
  "use-subscription",
  "../../../components/AutoCompleteAgent",
  "../../../components/AutoCompleteDepartment",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../additionalForms",
  "./Label",
  "./RemoveAllClosed"
],"Label.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"RemoveAllClosed.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/TranslationContext"
],"RemoveChatButton.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
]},"customFields":{"CustomFieldsForm.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"CustomFieldsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext"
],"CustomFieldsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./CustomFieldsPage",
  "./EditCustomFieldsPageContainer",
  "./NewCustomFieldsPage",
  "./RemoveCustomFieldButton"
],"EditCustomFieldsPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "../additionalForms",
  "./CustomFieldsForm"
],"EditCustomFieldsPageContainer.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditCustomFieldsPage"
],"NewCustomFieldsPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "../additionalForms",
  "./CustomFieldsForm"
],"RemoveCustomFieldButton.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
]},"departments":{"AddAgent.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/AutoCompleteAgent",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
],"AgentRow.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/avatar/UserAvatar",
  "./Count",
  "./Order",
  "./RemoveAgentButton"
],"Count.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"DepartmentsAgentsTable.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/TranslationContext",
  "./AddAgent",
  "./AgentRow"
],"DepartmentsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext"
],"DepartmentsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./DepartmentsPage",
  "./EditDepartmentWithData",
  "./RemoveDepartmentButton"
],"EditDepartment.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../../lib/emailValidator",
  "../../../components/Page",
  "../../../components/RoomAutoComplete/hooks/useRoomsList",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/lists/useRecordList",
  "../../../hooks/useComponentDidUpdate",
  "../../../hooks/useForm",
  "../../../lib/asyncState",
  "../additionalForms",
  "./DepartmentsAgentsTable"
],"EditDepartmentWithAllowedForwardData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Skeleton",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditDepartment"
],"EditDepartmentWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Skeleton",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditDepartment",
  "./EditDepartmentWithAllowedForwardData"
],"Order.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"RemoveAgentButton.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"RemoveDepartmentButton.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
]},"facebook":{"FacebookPage.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./PageToggleAssembler"
],"FacebookPageContainer.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useMethodData",
  "./FacebookPage"
],"PageToggle.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react"
],"PageToggleAssembler.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./PageToggle"
]},"installation":{"Installation.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../components/RawText",
  "../../../components/TextCopy",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "./Wrapper"
],"Wrapper.js":[
  "@rocket.chat/fuselage",
  "react"
]},"managers":{"AddManager.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/UserAutoComplete",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
],"ManagersPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/Page",
  "./AddManager"
],"ManagersRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/NotAuthorizedPage",
  "../../../components/avatar/UserAvatar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./ManagersPage",
  "./RemoveManagerButton"
],"RemoveManagerButton.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
]},"sidebar":{"OmnichannelSidebar.tsx":[
  "react",
  "use-subscription",
  "../../../../app/ui-utils/client",
  "../../../components/Sidebar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../lib/utils/isLayoutEmbedded",
  "../../../providers/SettingsProvider",
  "../sidebarItems"
]},"triggers":{"EditTriggerPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./TriggersForm"
],"EditTriggerPageContainer.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/PageSkeleton",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditTriggerPage"
],"NewTriggerPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./TriggersForm"
],"TriggersForm.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useComponentDidUpdate"
],"TriggersPage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./EditTriggerPageContainer",
  "./NewTriggerPage",
  "./TriggersTableContainer"
],"TriggersRow.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"TriggersTable.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/TranslationContext",
  "../../../hooks/useResizeInlineBreakpoint",
  "./TriggersRow"
],"TriggersTableContainer.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./TriggersTable"
]},"webhooks":{"WebhooksPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/ExternalLink",
  "../../../components/Page",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm"
],"WebhooksPageContainer.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./WebhooksPage"
]},"OmnichannelRouter.tsx":[
  "react",
  "../../../app/ui-utils/client",
  "../../components/PageSkeleton",
  "../../contexts/RouterContext"
],"additionalForms.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/omnichannel/additionalForms.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  registerForm: () => registerForm,
  unregisterForm: () => unregisterForm,
  formsSubscription: () => formsSubscription
});

const createFormSubscription = () => {
  let forms = {};

  let updateCb = () => {};

  const formsSubscription = {
    subscribe: cb => {
      updateCb = cb;
      return () => {
        updateCb = () => {};
      };
    },
    getCurrentValue: () => forms
  };

  const registerForm = newForm => {
    forms = _objectSpread(_objectSpread({}, forms), newForm);
    updateCb();
  };

  const unregisterForm = form => {
    delete forms[form];
    updateCb();
  };

  return {
    registerForm,
    unregisterForm,
    formsSubscription
  };
};

const {
  registerForm,
  unregisterForm,
  formsSubscription
} = createFormSubscription();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/omnichannel/routes.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  registerOmnichannelRoute: () => registerOmnichannelRoute
});
let createRouteGroup;
module.link("../../lib/createRouteGroup", {
  createRouteGroup(v) {
    createRouteGroup = v;
  }

}, 0);
const registerOmnichannelRoute = createRouteGroup('omnichannel', '/omnichannel', () => module.dynamicImport('./OmnichannelRouter'));
registerOmnichannelRoute('/installation', {
  name: 'omnichannel-installation',
  lazyRouteComponent: () => module.dynamicImport('./installation/Installation')
});
registerOmnichannelRoute('/managers', {
  name: 'omnichannel-managers',
  lazyRouteComponent: () => module.dynamicImport('./managers/ManagersRoute')
});
registerOmnichannelRoute('/agents/:context?/:id?', {
  name: 'omnichannel-agents',
  lazyRouteComponent: () => module.dynamicImport('./agents/AgentsRoute')
});
registerOmnichannelRoute('/webhooks', {
  name: 'omnichannel-webhooks',
  lazyRouteComponent: () => module.dynamicImport('./webhooks/WebhooksPageContainer')
});
registerOmnichannelRoute('/customfields/:context?/:id?', {
  name: 'omnichannel-customfields',
  lazyRouteComponent: () => module.dynamicImport('./customFields/CustomFieldsRoute')
});
registerOmnichannelRoute('/appearance', {
  name: 'omnichannel-appearance',
  lazyRouteComponent: () => module.dynamicImport('./appearance/AppearancePageContainer')
});
registerOmnichannelRoute('/businessHours/:context?/:type?/:id?', {
  name: 'omnichannel-businessHours',
  lazyRouteComponent: () => module.dynamicImport('./businessHours/BusinessHoursRouter')
});
registerOmnichannelRoute('/units/:context?/:id?', {
  name: 'omnichannel-units',
  lazyRouteComponent: () => module.dynamicImport('../../../ee/client/omnichannel/units/UnitsRoute')
});
registerOmnichannelRoute('/tags/:context?/:id?', {
  name: 'omnichannel-tags',
  lazyRouteComponent: () => module.dynamicImport('../../../ee/client/omnichannel/tags/TagsRoute')
});
registerOmnichannelRoute('/priorities/:context?/:id?', {
  name: 'omnichannel-priorities',
  lazyRouteComponent: () => module.dynamicImport('../../../ee/client/omnichannel/priorities/PrioritiesRoute')
});
registerOmnichannelRoute('/triggers/:context?/:id?', {
  name: 'omnichannel-triggers',
  lazyRouteComponent: () => module.dynamicImport('./triggers/TriggersPage')
});
registerOmnichannelRoute('/facebook', {
  name: 'omnichannel-facebook',
  lazyRouteComponent: () => module.dynamicImport('./facebook/FacebookPageContainer')
});
registerOmnichannelRoute('/current', {
  name: 'omnichannel-current-chats',
  lazyRouteComponent: () => module.dynamicImport('./currentChats/CurrentChatsRoute')
});
registerOmnichannelRoute('/departments/:context?/:id?/:tab?', {
  name: 'omnichannel-departments',
  lazyRouteComponent: () => module.dynamicImport('./departments/DepartmentsRoute')
});
registerOmnichannelRoute('/realtime-monitoring', {
  name: 'omnichannel-realTime',
  lazyRouteComponent: () => module.dynamicImport('./realTimeMonitoring/RealTimeMonitoringPage')
});
registerOmnichannelRoute('/analytics', {
  name: 'omnichannel-analytics',
  lazyRouteComponent: () => module.dynamicImport('./analytics/AnalyticsPage')
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"sidebarItems.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/omnichannel/sidebarItems.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  registerOmnichannelSidebarItem: () => registerOmnichannelSidebarItem,
  unregisterSidebarItem: () => unregisterSidebarItem,
  itemsSubscription: () => itemsSubscription
});
let hasPermission;
module.link("../../../app/authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 0);
let createSidebarItems;
module.link("../../lib/createSidebarItems", {
  createSidebarItems(v) {
    createSidebarItems = v;
  }

}, 1);
const {
  registerSidebarItem: registerOmnichannelSidebarItem,
  unregisterSidebarItem,
  itemsSubscription
} = createSidebarItems([{
  href: 'omnichannel/current',
  i18nLabel: 'Current_Chats',
  permissionGranted: () => hasPermission('view-livechat-current-chats')
}, {
  href: 'omnichannel-analytics',
  i18nLabel: 'Analytics',
  permissionGranted: () => hasPermission('view-livechat-analytics')
}, {
  href: 'omnichannel-realTime',
  i18nLabel: 'Real_Time_Monitoring',
  permissionGranted: () => hasPermission('view-livechat-real-time-monitoring')
}, {
  href: 'omnichannel/managers',
  i18nLabel: 'Managers',
  permissionGranted: () => hasPermission('manage-livechat-managers')
}, {
  href: 'omnichannel/agents',
  i18nLabel: 'Agents',
  permissionGranted: () => hasPermission('manage-livechat-agents')
}, {
  href: 'omnichannel/departments',
  i18nLabel: 'Departments',
  permissionGranted: () => hasPermission('view-livechat-departments')
}, {
  href: 'omnichannel-customfields',
  i18nLabel: 'Custom_Fields',
  permissionGranted: () => hasPermission('view-livechat-customfields')
}, {
  href: 'omnichannel-triggers',
  i18nLabel: 'Livechat_Triggers',
  permissionGranted: () => hasPermission('view-livechat-triggers')
}, {
  href: 'omnichannel-installation',
  i18nLabel: 'Livechat_Installation',
  permissionGranted: () => hasPermission('view-livechat-installation')
}, {
  href: 'omnichannel-appearance',
  i18nLabel: 'Livechat_Appearance',
  permissionGranted: () => hasPermission('view-livechat-appearance')
}, {
  href: 'omnichannel-webhooks',
  i18nLabel: 'Webhooks',
  permissionGranted: () => hasPermission('view-livechat-webhooks')
}, {
  href: 'omnichannel-facebook',
  i18nLabel: 'Facebook Messenger',
  permissionGranted: () => hasPermission('view-livechat-facebook')
}, {
  href: 'omnichannel-businessHours',
  i18nLabel: 'Business_Hours',
  permissionGranted: () => hasPermission('view-livechat-business-hours')
}]);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"teams":{"contextualBar":{"channels":{"AddExistingModal":{"AddExistingModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useForm",
  "./RoomsInput"
],"RoomsInput.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/utils/client",
  "../../../../../components/avatar/RoomAvatar",
  "../../../../../hooks/useEndpointData"
],"index.ts":[
  "./AddExistingModal"
]},"ConfirmationModal":{"ConfirmationModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext"
],"index.ts":[
  "./ConfirmationModal"
]},"hooks":{"useTeamsChannelList.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../contexts/ServerContext",
  "../../../../../hooks/lists/useScrollableRecordList",
  "../../../../../hooks/useComponentDidUpdate",
  "../../../../../lib/lists/RecordList",
  "../../../../../lib/utils/getConfig",
  "../../../../../lib/utils/mapMessageFromApi"
]},"BaseTeamsChannels.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../components/ScrollableContentWrapper",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "./Row"
],"RoomActions.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../contexts/AuthorizationContext",
  "../../../../contexts/ModalContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointActionExperimental",
  "./ConfirmationModal"
],"Row.js":[
  "react",
  "./TeamsChannelItem"
],"TeamsChannelItem.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../components/avatar/RoomAvatar",
  "../../../../contexts/AuthorizationContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/usePreventProgation",
  "./RoomActions"
],"TeamsChannels.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../contexts/AuthorizationContext",
  "../../../../contexts/ModalContext",
  "../../../../hooks/lists/useRecordList",
  "../../../../lib/asyncState",
  "../../../../sidebar/header/CreateChannelWithData",
  "../../../room/contextualBar/Info",
  "../../../room/providers/ToolboxProvider",
  "./AddExistingModal",
  "./BaseTeamsChannels",
  "./hooks/useTeamsChannelList"
],"index.ts":[
  "./TeamsChannels"
],"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/teams/contextualBar/channels/tabBar.ts                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let lazy;
module.link("react", {
  lazy(v) {
    lazy = v;
  }

}, 0);
let addAction;
module.link("../../../room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
addAction('team-channels', {
  groups: ['team'],
  id: 'team-channels',
  anonymous: true,
  full: true,
  title: 'Team_Channels',
  icon: 'hash',
  template: /*#__PURE__*/lazy(() => module.dynamicImport('./index')),
  order: 2
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"info":{"Delete":{"ChannelDeletionTable.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericTable",
  "../../../../../contexts/TranslationContext",
  "./ChannelRow"
],"ChannelRow.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../hooks/useRoomIcon"
],"DeleteTeamModal.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "."
],"StepOne.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "./ChannelDeletionTable"
],"StepTwo.js":[
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../RoomLinkList"
],"index.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "./DeleteTeamModal",
  "./StepOne",
  "./StepTwo"
]},"Leave":{"LeaveTeamModal.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "."
],"StepOne.js":[
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../../ChannelDesertionTable"
],"StepTwo.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext"
],"index.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../lib/asyncState",
  "./LeaveTeamModal",
  "./StepOne",
  "./StepTwo"
]},"TeamsInfo.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/VerticalBar",
  "../../../../components/avatar/RoomAvatar",
  "../../../../contexts/TranslationContext",
  "../../../InfoPanel",
  "../../../InfoPanel/RetentionPolicyCallout",
  "../../../hooks/useActionSpread"
],"TeamsInfoWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../components/GenericModal",
  "../../../../components/MarkdownText",
  "../../../../contexts/AuthorizationContext",
  "../../../../contexts/ModalContext",
  "../../../../contexts/RouterContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../contexts/UserContext",
  "../../../../hooks/useDontAskAgain",
  "../../../../hooks/useEndpointActionExperimental",
  "../../../room/providers/ToolboxProvider",
  "../../ConvertToChannelModal",
  "./Delete",
  "./Leave",
  "./TeamsInfo"
],"index.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "../../../room/contextualBar/Info/EditRoomInfo",
  "./TeamsInfoWithData"
],"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/teams/contextualBar/info/tabBar.ts                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let lazy;
module.link("react", {
  lazy(v) {
    lazy = v;
  }

}, 0);
let addAction;
module.link("../../../room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 1);
addAction('team-info', {
  groups: ['team'],
  id: 'team-info',
  anonymous: true,
  full: true,
  title: 'Teams_Info',
  icon: 'info-circled',
  template: /*#__PURE__*/lazy(() => module.dynamicImport('./index.js')),
  order: 1
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"members":{"RemoveUsersModal":{"BaseRemoveUsersModal.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../contexts/AuthorizationContext",
  "./RemoveUsersFirstStep",
  "./RemoveUsersSecondStep"
],"RemoveUsersFirstStep.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../../ChannelDesertionTable"
],"RemoveUsersModal.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../lib/asyncState",
  "./BaseRemoveUsersModal"
],"RemoveUsersSecondStep.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext"
],"index.ts":[
  "./RemoveUsersModal"
]}},"TeamAutocomplete":{"Avatar.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/avatar/RoomAvatar"
],"TeamAutocomplete.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../../hooks/useEndpointData",
  "./Avatar"
],"index.ts":[
  "./TeamAutocomplete"
]},"ChannelRow.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../hooks/useRoomIcon"
],"RoomLinkList.js":[
  "react",
  "../../../../app/utils/client"
]},"ConvertToChannelModal":{"ModalSteps":{"FirstStep.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/TranslationContext",
  "../../ChannelDesertionTable"
],"SecondStep.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/TranslationContext"
]},"BaseConvertToChannelModal.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "./ModalSteps/FirstStep",
  "./ModalSteps/SecondStep"
],"ConvertToChannelModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../../../lib/asyncState",
  "./BaseConvertToChannelModal"
],"index.ts":[
  "./ConvertToChannelModal"
]},"CreateTeamModal":{"CreateTeamModal.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointActionExperimental",
  "../../../hooks/useForm",
  "../../../lib/utils/goToRoomById",
  "./TeamNameInput",
  "./UsersInput"
],"TeamNameInput.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"UsersInput.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/avatar/UserAvatar",
  "../../../hooks/useEndpointData"
],"index.ts":[
  "./CreateTeamModal"
]},"ChannelDesertionTable.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../components/GenericTable",
  "../../contexts/TranslationContext",
  "../../hooks/useFormatDateAndTime",
  "./contextualBar/ChannelRow"
],"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/teams/index.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./contextualBar/channels/tabBar");
module.link("./contextualBar/info/tabBar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"account":{"preferences":{"AccountPreferencesPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./PreferencesGlobalSection",
  "./PreferencesHighlightsSection",
  "./PreferencesLocalizationSection",
  "./PreferencesMessagesSection",
  "./PreferencesMyDataSection",
  "./PreferencesNotificationsSection",
  "./PreferencesSoundSection",
  "./PreferencesUserPresenceSection"
],"MyDataModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"PreferencesGlobalSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesHighlightsSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesLocalizationSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesMessagesSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesMyDataSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./MyDataModal"
],"PreferencesNotificationsSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/ui",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesSoundSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/custom-sounds/client",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesUserPresenceSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
]},"security":{"AccountSecurityPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "./EndToEnd",
  "./TwoFactorEmail",
  "./TwoFactorTOTP"
],"BackupCodesModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/TextCopy",
  "../../../contexts/TranslationContext"
],"EndToEnd.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "react",
  "../../../../app/e2e/client/rocketchat.e2e",
  "../../../../lib/callbacks",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"TwoFactorEmail.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useEndpointAction"
],"TwoFactorTOTP.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "yaqrcode",
  "../../../components/TextCopy",
  "../../../components/TwoFactorModal/TwoFactorTotpModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm",
  "./BackupCodesModal"
]},"tokens":{"AccountTokensPage.js":[
  "react",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./AccountTokensTable",
  "./AddToken"
],"AccountTokensRow.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime"
],"AccountTokensTable.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useResizeInlineBreakpoint",
  "./AccountTokensRow",
  "./InfoModal"
],"AddToken.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm",
  "./InfoModal"
],"InfoModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
]},"AccountIntegrationsPage.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../app/models/client",
  "../../components/Page",
  "../../contexts/ServerContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext",
  "../../hooks/useForm",
  "../../hooks/useReactiveValue"
],"AccountProfileForm.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../lib/emailValidator",
  "../../../lib/getUserEmailAddress",
  "../../components/CustomFieldsForm",
  "../../components/UserStatus",
  "../../components/UserStatusMenu",
  "../../components/avatar/UserAvatarEditor",
  "../../contexts/ServerContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext"
],"AccountProfilePage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "meteor/sha",
  "react",
  "../../../lib/getUserEmailAddress",
  "../../components/ConfirmOwnerChangeWarningModal",
  "../../components/Page",
  "../../contexts/ModalContext",
  "../../contexts/ServerContext",
  "../../contexts/SettingsContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../../hooks/useForm",
  "../../hooks/useUpdateAvatar",
  "./AccountProfileForm",
  "./ActionConfirmModal"
],"AccountRoute.js":[
  "react",
  "../../../app/ui-utils/client",
  "../../components/NotAuthorizedPage",
  "../../contexts/AuthorizationContext",
  "../../contexts/RouterContext",
  "../../contexts/SettingsContext",
  "./AccountIntegrationsPage",
  "./AccountProfilePage",
  "./preferences/AccountPreferencesPage",
  "./security/AccountSecurityPage",
  "./tokens/AccountTokensPage",
  "./sidebarItems"
],"AccountSidebar.js":[
  "react",
  "use-subscription",
  "../../../app/ui-utils/client",
  "../../components/Sidebar",
  "../../contexts/RouterContext",
  "../../contexts/TranslationContext",
  "../../lib/utils/isLayoutEmbedded",
  "../../providers/SettingsProvider",
  "./sidebarItems"
],"ActionConfirmModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../components/GenericModal",
  "../../contexts/TranslationContext"
],"sidebarItems.js":[
  "../../../app/authorization/client",
  "../../../app/settings/client",
  "../../lib/createSidebarItems"
]},"login":{"AppleOauth":{"AppleOauthButton.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "meteor/accounts-base",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext"
]},"LoginLayout":{"Footer.tsx":[
  "meteor/meteor",
  "react",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../lib/utils/filterLanguage"
],"Header.tsx":[
  "react",
  "./useAssetPath"
],"LoginLayout.tsx":[
  "react",
  "./Footer",
  "./Header",
  "./useAssetPath"
],"index.ts":[
  "./LoginLayout"
],"useAssetPath.ts":[
  "../../../contexts/SettingsContext"
]},"ResetPassword":{"ResetPassword.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useMethodData",
  "../LoginLayout"
]}},"root":{"MainLayout":{"AuthenticationCheck.tsx":[
  "react",
  "../../../contexts/SessionContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/UserContext",
  "./LoginPage",
  "./UsernameCheck"
],"LayoutWithSidebar.tsx":[
  "react",
  "../../../contexts/LayoutContext",
  "../../../contexts/RouterContext",
  "../../../contexts/SettingsContext",
  "../../../hooks/useReactiveValue",
  "../BlazeTemplate"
],"LoginPage.tsx":[
  "react",
  "../BlazeTemplate",
  "./useIframeLogin"
],"MainLayout.tsx":[
  "react",
  "../BlazeTemplate",
  "./AuthenticationCheck",
  "./Preload"
],"PasswordChangeCheck.tsx":[
  "react",
  "../../../contexts/UserContext",
  "./TwoFactorAuthSetupCheck"
],"Preload.tsx":[
  "react",
  "../../../../app/models/client",
  "../../../../app/settings/client",
  "../../../../app/ui-cached-collection",
  "../../../../app/ui-utils/client",
  "../../../contexts/UserContext",
  "../../../hooks/useReactiveVar",
  "../../../lib/userData",
  "../PageLoading"
],"TwoFactorAuthSetupCheck.tsx":[
  "react",
  "../../../../app/models/client",
  "../../../contexts/LayoutContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/UserContext",
  "../../../hooks/useReactiveValue",
  "./LayoutWithSidebar"
],"UsernameCheck.tsx":[
  "react",
  "../../../../app/models/client",
  "../../../contexts/SettingsContext",
  "../../../contexts/UserContext",
  "../../../hooks/useReactiveValue",
  "../BlazeTemplate",
  "./PasswordChangeCheck",
  "./useCustomScript",
  "./useViewportScrolling"
],"index.ts":[
  "./MainLayout"
],"useCustomScript.ts":[
  "react",
  "../../../lib/utils/fireGlobalEvent"
],"useIframeLogin.ts":[
  "../../../../app/ui-utils/client",
  "../../../hooks/useReactiveValue"
],"useViewportScrolling.ts":[
  "react"
]},"AppLayout.tsx":[
  "react",
  "use-subscription",
  "../../lib/appLayout",
  "../../lib/portals/blazePortals",
  "./PageLoading",
  "./useTooltipHandling"
],"AppRoot.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/root/AppRoot.tsx                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let React, lazy, Suspense;
module.link("react", {
  default(v) {
    React = v;
  },

  lazy(v) {
    lazy = v;
  },

  Suspense(v) {
    Suspense = v;
  }

}, 0);
let QueryClientProvider;
module.link("react-query", {
  QueryClientProvider(v) {
    QueryClientProvider = v;
  }

}, 1);
let OmnichannelRoomIconProvider;
module.link("../../components/RoomIcon/OmnichannelRoomIcon/provider/OmnichannelRoomIconProvider", {
  OmnichannelRoomIconProvider(v) {
    OmnichannelRoomIconProvider = v;
  }

}, 2);
let queryClient;
module.link("../../lib/queryClient", {
  queryClient(v) {
    queryClient = v;
  }

}, 3);
let PageLoading;
module.link("./PageLoading", {
  default(v) {
    PageLoading = v;
  }

}, 4);
const ConnectionStatusBar = /*#__PURE__*/lazy(() => module.dynamicImport('../../components/connectionStatus/ConnectionStatusBar'));
const MeteorProvider = /*#__PURE__*/lazy(() => module.dynamicImport('../../providers/MeteorProvider'));
const BannerRegion = /*#__PURE__*/lazy(() => module.dynamicImport('../banners/BannerRegion'));
const AppLayout = /*#__PURE__*/lazy(() => module.dynamicImport('./AppLayout'));
const PortalsWrapper = /*#__PURE__*/lazy(() => module.dynamicImport('./PortalsWrapper'));

const AppRoot = () => /*#__PURE__*/React.createElement(Suspense, {
  fallback: /*#__PURE__*/React.createElement(PageLoading, null)
}, /*#__PURE__*/React.createElement(MeteorProvider, null, /*#__PURE__*/React.createElement(QueryClientProvider, {
  client: queryClient
}, /*#__PURE__*/React.createElement(OmnichannelRoomIconProvider, null, /*#__PURE__*/React.createElement(ConnectionStatusBar, null), /*#__PURE__*/React.createElement(BannerRegion, null), /*#__PURE__*/React.createElement(AppLayout, null), /*#__PURE__*/React.createElement(PortalsWrapper, null)))));

module.exportDefault(AppRoot);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"BlazeTemplate.tsx":[
  "meteor/blaze",
  "meteor/reactive-dict",
  "meteor/templating",
  "react"
],"CMSPage.tsx":[
  "react",
  "../../contexts/RouterContext",
  "../../contexts/SettingsContext"
],"PageLoading.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/root/PageLoading.tsx                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 0);

const PageLoading = () => /*#__PURE__*/React.createElement("div", {
  className: "page-loading"
}, /*#__PURE__*/React.createElement("div", {
  className: "loading-animation"
}, /*#__PURE__*/React.createElement("div", {
  className: "bounce bounce1"
}), /*#__PURE__*/React.createElement("div", {
  className: "bounce bounce2"
}), /*#__PURE__*/React.createElement("div", {
  className: "bounce bounce3"
})));

module.exportDefault(PageLoading);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"PortalWrapper.ts":[
  "react"
],"PortalsWrapper.tsx":[
  "react",
  "use-subscription",
  "../../lib/portals/portalsSubscription",
  "./PortalWrapper"
],"useTooltipHandling.ts":[
  "react",
  "../../../app/ui/client/components/tooltip",
  "../../contexts/UserContext",
  "../../lib/utils/domEvents"
]},"setupWizard":{"contexts":{"SetupWizardContext.tsx":[
  "react"
]},"hooks":{"useBodyPosition.ts":[
  "react"
],"useParameters.ts":[
  "react",
  "../../../contexts/ServerContext"
],"useRouteLock.ts":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/UserContext"
],"useStepRouting.ts":[
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/UserContext"
]},"providers":{"OnboardingI18nProvider.tsx":[
  "i18next",
  "i18next-http-backend",
  "react",
  "react-i18next",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../root/PageLoading"
],"SetupWizardProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "react",
  "../../../../lib/callbacks",
  "../../../../lib/emailValidator",
  "../../../contexts/ServerContext",
  "../../../contexts/SessionContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../contexts/SetupWizardContext",
  "../hooks/useParameters",
  "../hooks/useStepRouting"
]},"steps":{"AdminInfoStep.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/onboarding-ui",
  "react",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../contexts/SetupWizardContext"
],"CloudAccountConfirmation.tsx":[
  "@rocket.chat/onboarding-ui",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../contexts/SetupWizardContext"
],"OrganizationInfoStep.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/onboarding-ui",
  "react",
  "../../../contexts/TranslationContext",
  "../contexts/SetupWizardContext"
],"RegisterServerStep.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/onboarding-ui",
  "react",
  "../contexts/SetupWizardContext"
],"StandaloneServerStep.tsx":[
  "@rocket.chat/onboarding-ui",
  "react",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../contexts/SetupWizardContext"
]},"SetupWizardPage.tsx":[
  "react",
  "./contexts/SetupWizardContext",
  "./steps/AdminInfoStep",
  "./steps/CloudAccountConfirmation",
  "./steps/OrganizationInfoStep",
  "./steps/RegisterServerStep",
  "./steps/StandaloneServerStep"
],"SetupWizardRoute.tsx":[
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/onboarding-ui",
  "react",
  "./SetupWizardPage",
  "./hooks/useBodyPosition",
  "./hooks/useRouteLock",
  "./providers/OnboardingI18nProvider",
  "./providers/SetupWizardProvider"
]},"InfoPanel":{"Action.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"ActionGroup.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./Section"
],"Avatar.tsx":[
  "react",
  "./Section"
],"Field.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"InfoPanel.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Label.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"RetentionPolicyCallout.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/TranslationContext",
  "../../hooks/useFormattedRelativeTime"
],"Section.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Text.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react"
],"Title.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./Action",
  "./ActionGroup",
  "./Avatar",
  "./Field",
  "./InfoPanel",
  "./Label",
  "./Section",
  "./Text",
  "./Title"
]},"banners":{"BannerRegion.tsx":[
  "react",
  "use-subscription",
  "../../lib/banners",
  "./LegacyBanner",
  "./UiKitBanner"
],"LegacyBanner.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../lib/banners"
],"UiKitBanner.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../UIKit/hooks/useUIKitHandleAction",
  "../../UIKit/hooks/useUIKitHandleClose",
  "../../UIKit/hooks/useUIKitStateManager",
  "../../components/MarkdownText",
  "../../lib/banners"
]},"blocks":{"ConnectedModalBlock.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/apps-engine/definition/uikit/UIKitIncomingInteractionContainer",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../../app/ui-message/client/ActionManager",
  "./ModalBlock",
  "./textParsers"
],"MessageBlock.js":[
  "@rocket.chat/apps-engine/definition/uikit/UIKitIncomingInteractionContainer",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../../app/ui-message/client/ActionManager",
  "../../components/Message/hooks/useBlockRendered",
  "../../lib/utils/renderMessageBody",
  "./textParsers"
],"ModalBlock.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../../app/utils/lib/getURL",
  "./textParsers"
],"textParsers.js":[
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../lib/utils/renderMessageBody"
]},"directory":{"ChannelsTab.js":[
  "react",
  "../../components/NotAuthorizedPage",
  "../../contexts/AuthorizationContext",
  "./ChannelsTable"
],"ChannelsTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../app/utils/client",
  "../../components/FilterByText",
  "../../components/GenericTable",
  "../../components/MarkdownText",
  "../../contexts/RouterContext",
  "../../contexts/TranslationContext",
  "../../hooks/useEndpointData",
  "../../hooks/useFormatDate",
  "./RoomTags",
  "./hooks"
],"DirectoryPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../components/Page",
  "../../contexts/RouterContext",
  "../../contexts/SettingsContext",
  "../../contexts/TranslationContext",
  "./ChannelsTab",
  "./TeamsTab",
  "./UserTab"
],"RoomTags.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/TranslationContext"
],"TeamsTab.js":[
  "react",
  "../../components/NotAuthorizedPage",
  "../../contexts/AuthorizationContext",
  "./TeamsTable"
],"TeamsTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../app/utils/client",
  "../../components/FilterByText",
  "../../components/GenericTable",
  "../../components/MarkdownText",
  "../../contexts/RouterContext",
  "../../contexts/TranslationContext",
  "../../hooks/useEndpointData",
  "../../hooks/useFormatDate",
  "./RoomTags",
  "./hooks"
],"UserTab.js":[
  "react",
  "../../components/NotAuthorizedPage",
  "../../contexts/AuthorizationContext",
  "./UserTable"
],"UserTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../components/FilterByText",
  "../../components/GenericTable",
  "../../components/MarkdownText",
  "../../components/avatar/UserAvatar",
  "../../contexts/AuthorizationContext",
  "../../contexts/RouterContext",
  "../../contexts/TranslationContext",
  "../../hooks/useEndpointData",
  "../../hooks/useFormatDate",
  "./hooks"
],"hooks.js":[
  "@babel/runtime/helpers/objectSpread2",
  "react"
]},"e2e":{"EnterE2EPasswordModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/e2e/EnterE2EPasswordModal.tsx                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box, PasswordInput, Field, FieldGroup;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  PasswordInput(v) {
    PasswordInput = v;
  },

  Field(v) {
    Field = v;
  },

  FieldGroup(v) {
    FieldGroup = v;
  }

}, 0);
let useMutableCallback;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback(v) {
    useMutableCallback = v;
  }

}, 1);
let React, useState, useCallback;
module.link("react", {
  default(v) {
    React = v;
  },

  useState(v) {
    useState = v;
  },

  useCallback(v) {
    useCallback = v;
  }

}, 2);
let GenericModal;
module.link("../../components/GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 3);
let useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 4);

const EnterE2EPasswordModal = _ref => {
  let {
    onConfirm,
    onClose,
    onCancel
  } = _ref;
  const t = useTranslation();
  const [password, setPassword] = useState('');
  const [passwordError, setPasswordError] = useState();
  const handleChange = useCallback(e => {
    e.target.value !== '' && setPasswordError(undefined);
    setPassword(e.currentTarget.value);
  }, [setPassword]);
  const handleConfirm = useMutableCallback(() => {
    if (password === '') {
      setPasswordError(t('Invalid_pass'));
      return;
    }

    return onConfirm(password);
  });
  return /*#__PURE__*/React.createElement(GenericModal, {
    variant: "warning",
    title: t('Enter_E2E_password'),
    cancelText: t('Do_It_Later'),
    confirmText: t('Decode_Key'),
    onConfirm: handleConfirm,
    onClose: onClose,
    onCancel: onCancel
  }, /*#__PURE__*/React.createElement(Box, {
    dangerouslySetInnerHTML: {
      __html: t('E2E_password_request_text')
    }
  }), /*#__PURE__*/React.createElement(FieldGroup, {
    mbs: "x24",
    w: "full"
  }, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(PasswordInput, {
    error: passwordError,
    value: password,
    onChange: handleChange,
    placeholder: t('New_Password_Placeholder')
  })), /*#__PURE__*/React.createElement(Field.Error, null, passwordError))));
};

module.exportDefault(EnterE2EPasswordModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"SaveE2EPasswordModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/e2e/SaveE2EPasswordModal.tsx                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);
let GenericModal;
module.link("../../components/GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 2);
let useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 3);

const SaveE2EPasswordModal = _ref => {
  let {
    passwordRevealText,
    onClose,
    onCancel,
    onConfirm
  } = _ref;
  const t = useTranslation();
  return /*#__PURE__*/React.createElement(GenericModal, {
    onClose: onClose,
    onCancel: onCancel,
    onConfirm: onConfirm,
    cancelText: t('Do_It_Later'),
    confirmText: t('I_Saved_My_Password'),
    variant: "warning",
    title: t('Save_Your_Encryption_Password')
  }, /*#__PURE__*/React.createElement(Box, {
    dangerouslySetInnerHTML: {
      __html: passwordRevealText
    }
  }));
};

module.exportDefault(SaveE2EPasswordModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"hooks":{"useActionSpread.ts":[
  "react"
],"useDepartmentsByUnitsList.ts":[
  "react",
  "../../contexts/ServerContext",
  "../../hooks/lists/useScrollableRecordList",
  "../../hooks/useComponentDidUpdate",
  "../../lib/lists/RecordList"
],"useImperativeModal.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../lib/imperativeModal"
],"useMembersList.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../contexts/ServerContext",
  "../../hooks/lists/useScrollableRecordList",
  "../../hooks/useComponentDidUpdate",
  "../../lib/lists/RecordList",
  "../../lib/utils/getConfig"
],"useMonitorsList.ts":[
  "react",
  "../../contexts/ServerContext",
  "../../hooks/lists/useScrollableRecordList",
  "../../hooks/useComponentDidUpdate",
  "../../lib/lists/RecordList"
]},"invite":{"InvitePage.tsx":[
  "react",
  "react-query",
  "../../../app/utils/client",
  "../../contexts/RouterContext",
  "../../contexts/SessionContext",
  "../../contexts/SettingsContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../root/PageLoading"
],"SecretURLPage.tsx":[
  "react",
  "react-query",
  "../../../app/ui",
  "../../contexts/RouterContext",
  "../../contexts/SessionContext",
  "../../contexts/SettingsContext",
  "../../contexts/TranslationContext",
  "../../lib/utils/call",
  "../root/PageLoading"
]},"location":{"MapView.tsx":[
  "react",
  "../../contexts/SettingsContext",
  "./MapViewFallback",
  "./MapViewImage",
  "./useAsyncImage"
],"MapViewFallback.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../components/ExternalLink",
  "../../contexts/TranslationContext"
],"MapViewImage.tsx":[
  "react",
  "../../components/ExternalLink",
  "../../contexts/TranslationContext"
],"MessageLocation.tsx":[
  "react",
  "./MapView"
],"useAsyncImage.ts":[
  "react",
  "../../hooks/useAsyncState"
]},"mailer":{"MailerUnsubscriptionPage.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/RouterContext",
  "../../contexts/ServerContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext",
  "../../hooks/useAsyncState"
]},"meet":{"CallPage.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "moment",
  "react",
  "../../../app/notifications/client",
  "../../../app/webrtc/client",
  "../../../app/webrtc/index",
  "../../components/avatar/UserAvatar",
  "../../contexts/TranslationContext",
  "./OngoingCallDuration",
  "./styles.css"
],"MeetPage.tsx":[
  "@rocket.chat/fuselage",
  "meteor/meteor",
  "react",
  "../../../app/utils/client",
  "../../components/avatar/UserAvatar",
  "../../contexts/RouterContext",
  "../notFound/NotFoundPage",
  "../root/PageLoading",
  "./CallPage",
  "./styles.css"
],"OngoingCallDuration.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"styles.css":[]},"notFound":{"NotFoundPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/RouterContext",
  "../../contexts/TranslationContext"
]}},"components":{"RoomIcon":{"OmnichannelRoomIcon":{"lib":{"OmnichannelRoomIcon.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomIcon/OmnichannelRoomIcon/lib/OmnichannelRoomIcon.ts                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);
let DOMPurify;
module.link("dompurify", {
  default(v) {
    DOMPurify = v;
  }

}, 1);
let APIClient;
module.link("../../../../../app/utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 2);
const OmnichannelRoomIcon = new class extends Emitter {
  constructor() {
    super();
    this.icons = new Map();
  }

  get(appId, icon) {
    if (!appId || !icon) {
      return;
    }

    if (this.icons.has("".concat(appId, "-").concat(icon))) {
      return "".concat(appId, "-").concat(icon);
    }

    APIClient.get("apps/public/".concat(appId, "/get-sidebar-icon"), {
      icon
    }).then(response => {
      this.icons.set("".concat(appId, "-").concat(icon), DOMPurify.sanitize(response, {
        FORBID_ATTR: ['id'],
        NAMESPACE: 'http://www.w3.org/2000/svg',
        USE_PROFILES: {
          svg: true,
          svgFilters: true
        }
      }).replace("<svg", "<symbol id=\"".concat(appId, "-").concat(icon, "\"")).replace("</svg>", '</symbol>'));
      this.emit('change');
      this.emit("".concat(appId, "-").concat(icon));
    });
  }

}();
module.exportDefault(OmnichannelRoomIcon);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"context":{"OmnichannelRoomIconContext.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomIcon/OmnichannelRoomIcon/context/OmnichannelRoomIconContext.tsx                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  OmnichannelRoomIconContext: () => OmnichannelRoomIconContext,
  useOmnichannelRoomIcon: () => useOmnichannelRoomIcon
});
let createContext, useMemo, useContext;
module.link("react", {
  createContext(v) {
    createContext = v;
  },

  useMemo(v) {
    useMemo = v;
  },

  useContext(v) {
    useContext = v;
  }

}, 0);
let useSubscription;
module.link("use-subscription", {
  useSubscription(v) {
    useSubscription = v;
  }

}, 1);
let AsyncStatePhase;
module.link("../../../../lib/asyncState/AsyncStatePhase", {
  AsyncStatePhase(v) {
    AsyncStatePhase = v;
  }

}, 2);
const OmnichannelRoomIconContext = /*#__PURE__*/createContext({
  queryIcon: () => ({
    getCurrentValue: () => ({
      phase: AsyncStatePhase.LOADING,
      value: undefined,
      error: undefined
    }),
    subscribe: () => () => undefined
  })
});

const useOmnichannelRoomIcon = (app, icon) => {
  const {
    queryIcon
  } = useContext(OmnichannelRoomIconContext);
  return useSubscription(useMemo(() => queryIcon(app, icon), [app, queryIcon, icon]));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"provider":{"OmnichannelRoomIconProvider.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomIcon/OmnichannelRoomIcon/provider/OmnichannelRoomIconProvider.tsx                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  OmnichannelRoomIconProvider: () => OmnichannelRoomIconProvider
});
let React, useMemo;
module.link("react", {
  default(v) {
    React = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 0);
let createPortal;
module.link("react-dom", {
  createPortal(v) {
    createPortal = v;
  }

}, 1);
let useSubscription;
module.link("use-subscription", {
  useSubscription(v) {
    useSubscription = v;
  }

}, 2);
let AsyncStatePhase;
module.link("../../../../lib/asyncState/AsyncStatePhase", {
  AsyncStatePhase(v) {
    AsyncStatePhase = v;
  }

}, 3);
let OmnichannelRoomIconContext;
module.link("../context/OmnichannelRoomIconContext", {
  OmnichannelRoomIconContext(v) {
    OmnichannelRoomIconContext = v;
  }

}, 4);
let OmnichannelRoomIcon;
module.link("../lib/OmnichannelRoomIcon", {
  default(v) {
    OmnichannelRoomIcon = v;
  }

}, 5);

const OmnichannelRoomIconProvider = _ref => {
  let {
    children
  } = _ref;
  const svgIcons = useSubscription(useMemo(() => ({
    getCurrentValue: () => Array.from(OmnichannelRoomIcon.icons.values()),
    subscribe: callback => OmnichannelRoomIcon.on('change', callback)
  }), []));
  return /*#__PURE__*/React.createElement(OmnichannelRoomIconContext.Provider, {
    value: useMemo(() => ({
      queryIcon: (app, iconName) => ({
        getCurrentValue: () => {
          const icon = OmnichannelRoomIcon.get(app, iconName);

          if (!icon) {
            return {
              phase: AsyncStatePhase.LOADING,
              value: undefined,
              error: undefined
            };
          }

          return {
            phase: AsyncStatePhase.RESOLVED,
            value: icon,
            error: undefined
          };
        },
        subscribe: callback => OmnichannelRoomIcon.on("".concat(app, "-").concat(iconName), callback)
      })
    }), [])
  }, /*#__PURE__*/createPortal( /*#__PURE__*/React.createElement("svg", {
    xmlns: "http://www.w3.org/2000/svg",
    xmlnsXlink: "http://www.w3.org/1999/xlink",
    style: {
      display: 'none'
    },
    dangerouslySetInnerHTML: {
      __html: svgIcons.join('')
    }
  }), document.body, 'custom-icons'), children);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"OmnichannelAppSourceRoomIcon.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../lib/asyncState/AsyncStatePhase",
  "./context/OmnichannelRoomIconContext"
],"OmnichannelCoreSourceRoomIcon.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"OmnichannelRoomIcon.tsx":[
  "react",
  "../../../../definition/IRoom",
  "./OmnichannelAppSourceRoomIcon",
  "./OmnichannelCoreSourceRoomIcon"
],"index.tsx":[
  "./OmnichannelRoomIcon"
]},"RoomIcon.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../definition/IRoom",
  "../UserStatus",
  "./OmnichannelRoomIcon"
],"index.tsx":[
  "./RoomIcon"
]},"Message":{"Attachments":{"Attachment":{"Action.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Attachment.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../context/AttachmentContext"
],"Author.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"AuthorAvatar.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"AuthorName.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Block.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./Attachment"
],"Collapse.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../contexts/TranslationContext",
  "./Action"
],"Content.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Details.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Download.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../contexts/TranslationContext",
  "./Action"
],"Inner.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Row.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Size.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../hooks/useFormatMemorySize",
  "./Title"
],"Text.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Thumb.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Title.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"TitleLink.tsx":[
  "react",
  "./Title"
],"index.tsx":[
  "../components/Image",
  "./Attachment",
  "./Author",
  "./AuthorAvatar",
  "./AuthorName",
  "./Block",
  "./Collapse",
  "./Content",
  "./Details",
  "./Download",
  "./Inner",
  "./Row",
  "./Size",
  "./Text",
  "./Thumb",
  "./Title",
  "./TitleLink"
]},"FieldsAttachment":{"Field.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"ShortField.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./Field"
],"index.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./Field",
  "./ShortField"
]},"Files":{"AudioAttachment.tsx":[
  "react",
  "../../../MarkdownText",
  "../Attachment",
  "../context/AttachmentContext",
  "../hooks/useCollapse"
],"GenericFileAttachment.tsx":[
  "react",
  "../../../MarkdownText",
  "../Attachment",
  "../context/AttachmentContext"
],"ImageAttachment.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "../../../MarkdownText",
  "../Attachment",
  "../components/Image",
  "../context/AttachmentContext",
  "../hooks/useCollapse",
  "../hooks/useLoadImage"
],"VideoAttachment.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../MarkdownText",
  "../Attachment",
  "../context/AttachmentContext",
  "../hooks/useCollapse"
],"index.tsx":[
  "react",
  "../../../../../definition/IMessage/MessageAttachment/Files/AudioAttachmentProps",
  "../../../../../definition/IMessage/MessageAttachment/Files/ImageAttachmentProps",
  "../../../../../definition/IMessage/MessageAttachment/Files/VideoAttachmentProps",
  "./AudioAttachment",
  "./GenericFileAttachment",
  "./ImageAttachment",
  "./VideoAttachment"
]},"components":{"Image.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../context/AttachmentContext",
  "./ImageBox",
  "./Load",
  "./Retry"
],"ImageBox.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Load.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../contexts/TranslationContext",
  "./ImageBox"
],"Retry.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../contexts/TranslationContext",
  "./ImageBox"
]},"context":{"AttachmentContext.tsx":[
  "react"
]},"hooks":{"useCollapse.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../Attachment",
  "../context/AttachmentContext"
],"useLoadImage.tsx":[
  "react",
  "../context/AttachmentContext"
]},"providers":{"AttachmentProvider.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../contexts/LayoutContext",
  "../../../../contexts/UserContext",
  "../context/AttachmentContext"
]},"ActionAttachtment.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Attachments.tsx":[
  "react",
  "../hooks/useBlockRendered",
  "./Item"
],"DefaultAttachment.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../definition/IMessage/MessageAttachment/MessageAttachmentAction",
  "../../MarkdownText",
  "./ActionAttachtment",
  "./Attachment",
  "./FieldsAttachment",
  "./hooks/useCollapse"
],"Item.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "../../../../definition/IMessage/MessageAttachment/Files/FileAttachmentProps",
  "../../../../definition/IMessage/MessageAttachment/MessageQuoteAttachment",
  "./DefaultAttachment",
  "./Files",
  "./QuoteAttachment"
],"QuoteAttachment.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  ".",
  "../../../hooks/useTimeAgo",
  "../../MarkdownText",
  "./Attachment"
],"index.tsx":[
  "./Attachments"
]},"Actions":{"Action.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"Actions.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../Metrics/Content",
  "./Action"
],"index.tsx":[
  "./Actions"
]},"Body":{"BigEmoji.tsx":[
  "react",
  "../../Emoji"
],"Body.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./BigEmoji",
  "./Code",
  "./Heading",
  "./OrderedList",
  "./Paragraph",
  "./Quote",
  "./TaskList",
  "./UnorderedList"
],"Bold.tsx":[
  "react",
  "./Italic",
  "./Link",
  "./Strike"
],"Code.tsx":[
  "react",
  "../../../../app/markdown/lib/hljs",
  "./CodeLine"
],"CodeLine.tsx":[
  "react"
],"Heading.tsx":[
  "react"
],"Image.tsx":[
  "react"
],"Inline.tsx":[
  "react",
  "../../Emoji",
  "./Bold",
  "./Image",
  "./InlineCode",
  "./Italic",
  "./Link",
  "./Mention",
  "./Plain",
  "./Strike"
],"InlineCode.tsx":[
  "react"
],"Italic.tsx":[
  "react",
  "./Bold",
  "./Link",
  "./Strike"
],"Link.tsx":[
  "react",
  "../../../lib/baseURI",
  "./Bold",
  "./Italic",
  "./Strike"
],"Mention.tsx":[
  "react",
  "../../../contexts/UserContext"
],"OrderedList.tsx":[
  "react",
  "./Inline"
],"Paragraph.tsx":[
  "react",
  "./Inline"
],"Plain.tsx":[
  "react"
],"Quote.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "./Paragraph"
],"Strike.tsx":[
  "react",
  "./Bold",
  "./Italic",
  "./Link"
],"TaskList.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./Inline"
],"UnorderedList.tsx":[
  "react",
  "./Inline"
],"index.ts":[
  "./Body"
]},"Metrics":{"Broadcast.tsx":[
  "react",
  "../../../contexts/TranslationContext",
  "../hooks/useBlockRendered",
  "./Content",
  "./Reply"
],"Content.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"ContentItem.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Discussion.tsx":[
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useTimeAgo",
  "../hooks/useBlockRendered",
  "./Content",
  "./Reply",
  "./index"
],"Metrics.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./ContentItem"
],"MetricsFollowing.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"MetricsItem.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"MetricsItemIcon.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"MetricsItemLabel.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Reply.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./ContentItem"
],"Thread.tsx":[
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useTimeAgo",
  "../NotificationStatus",
  "../helpers/followSyle",
  "../hooks/useBlockRendered",
  "./Content",
  "./Reply",
  "./index"
],"index.tsx":[
  "./Metrics",
  "./MetricsFollowing",
  "./MetricsItem",
  "./MetricsItemIcon",
  "./MetricsItemLabel"
]},"NotificationStatus":{"All.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "./NotificationStatus"
],"Me.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "./NotificationStatus"
],"NotificationStatus.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"Unread.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "./NotificationStatus"
],"index.ts":[
  "./All",
  "./Me",
  "./Unread"
]},"helpers":{"followSyle.js":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js"
]},"hooks":{"useBlockRendered.js":[
  "react"
]}},"Omnichannel":{"modals":{"ModalSeparator":{"ModalSeparator.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "./style.css"
],"index.ts":[
  "./ModalSeparator"
],"style.css":[]},"CloseChatModal.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useComponentDidUpdate",
  "../../../hooks/useForm",
  "../../GenericModal",
  "../Tags"
],"CloseChatModalData.js":[
  "react",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../Skeleton",
  "./CloseChatModal"
],"ForwardChatModal.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/lists/useRecordList",
  "../../../hooks/useAsyncState",
  "../../../hooks/useForm",
  "../../UserAutoComplete",
  "../hooks/useDepartmentsList",
  "./ModalSeparator"
],"ReturnChatQueueModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"TranscriptModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useComponentDidUpdate",
  "../../../hooks/useForm"
]},"hooks":{"useAgentsList.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/lists/useScrollableRecordList",
  "../../../hooks/useComponentDidUpdate",
  "../../../lib/lists/RecordList"
],"useDepartmentsList.ts":[
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/lists/useScrollableRecordList",
  "../../../hooks/useComponentDidUpdate",
  "../../../lib/lists/RecordList"
]},"Skeleton.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Tags.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext",
  "../../hooks/useAsyncState",
  "../../hooks/useEndpointData",
  "../../views/omnichannel/additionalForms",
  "./Skeleton"
]},"GenericTable":{"V2":{"GenericTable.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../ScrollableContentWrapper"
],"GenericTableBody.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"GenericTableCell.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"GenericTableHeader.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./GenericTableRow"
],"GenericTableHeaderCell.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../SortIcon"
],"GenericTableLoadingRow.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"GenericTableLoadingTable.tsx":[
  "react",
  "./GenericTableLoadingRow"
],"GenericTableRow.tsx":[
  "@rocket.chat/fuselage",
  "react"
]},"hooks":{"useCurrent.ts":[
  "react"
],"useItemsPerPage.ts":[
  "react"
],"useItemsPerPageLabel.ts":[
  "react",
  "../../../contexts/TranslationContext"
],"usePagination.ts":[
  "./useCurrent",
  "./useItemsPerPage",
  "./useItemsPerPageLabel",
  "./useShowingResultsLabel"
],"useShowingResultsLabel.ts":[
  "react",
  "../../../contexts/TranslationContext"
],"useSort.ts":[
  "react"
]},"GenericTable.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-keyed-flatten-children",
  "../../contexts/TranslationContext",
  "./V2/GenericTable",
  "./V2/GenericTableBody",
  "./V2/GenericTableHeader",
  "./V2/GenericTableLoadingTable",
  "./hooks/usePagination"
],"HeaderCell.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./SortIcon"
],"NoResults.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"SortIcon.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./GenericTable",
  "./HeaderCell",
  "./V2/GenericTable",
  "./V2/GenericTableBody",
  "./V2/GenericTableCell",
  "./V2/GenericTableHeader",
  "./V2/GenericTableHeaderCell",
  "./V2/GenericTableLoadingRow",
  "./V2/GenericTableLoadingTable",
  "./V2/GenericTableRow"
]},"RoomAutoComplete":{"hooks":{"useRoomsList.ts":[
  "react",
  "../../../contexts/ServerContext",
  "../../../hooks/lists/useScrollableRecordList",
  "../../../hooks/useComponentDidUpdate",
  "../../../lib/lists/RecordList"
]},"Avatar.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomAutoComplete/Avatar.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["value", "type", "avatarETag"];

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
let Options;
module.link("@rocket.chat/fuselage", {
  Options(v) {
    Options = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);
let RoomAvatar;
module.link("../avatar/RoomAvatar", {
  default(v) {
    RoomAvatar = v;
  }

}, 2);

const Avatar = _ref => {
  let {
    value,
    type,
    avatarETag
  } = _ref,
      props = _objectWithoutProperties(_ref, _excluded);

  return /*#__PURE__*/React.createElement(RoomAvatar, _extends({
    size: Options.AvatarSize,
    room: {
      type,
      _id: value,
      avatarETag
    }
  }, props));
};

module.exportDefault(Avatar);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomAutoComplete.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomAutoComplete/RoomAutoComplete.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["value", "label"];

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 2);
let AutoComplete, Option, Box;
module.link("@rocket.chat/fuselage", {
  AutoComplete(v) {
    AutoComplete = v;
  },

  Option(v) {
    Option = v;
  },

  Box(v) {
    Box = v;
  }

}, 0);
let React, memo, useMemo, useState;
module.link("react", {
  default(v) {
    React = v;
  },

  memo(v) {
    memo = v;
  },

  useMemo(v) {
    useMemo = v;
  },

  useState(v) {
    useState = v;
  }

}, 1);
let useEndpointData;
module.link("../../hooks/useEndpointData", {
  useEndpointData(v) {
    useEndpointData = v;
  }

}, 2);
let RoomAvatar;
module.link("../avatar/RoomAvatar", {
  default(v) {
    RoomAvatar = v;
  }

}, 3);
let Avatar;
module.link("./Avatar", {
  default(v) {
    Avatar = v;
  }

}, 4);

const query = function () {
  let term = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  return {
    selector: JSON.stringify({
      name: term
    })
  };
};

const RoomAutoComplete = props => {
  const [filter, setFilter] = useState('');
  const {
    value: data
  } = useEndpointData('rooms.autocomplete.channelAndPrivate', useMemo(() => query(filter), [filter]));
  const options = useMemo(() => data && data.items.map(_ref => {
    let {
      name,
      _id,
      avatarETag,
      t
    } = _ref;
    return {
      value: _id,
      label: {
        name,
        avatarETag,
        type: t
      }
    };
  }) || [], [data]);
  return /*#__PURE__*/React.createElement(AutoComplete, _extends({}, props, {
    filter: filter,
    setFilter: setFilter,
    renderSelected: _ref2 => {
      let {
        value,
        label
      } = _ref2;
      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Box, {
        margin: "none",
        mi: "x2"
      }, /*#__PURE__*/React.createElement(RoomAvatar, {
        size: "x20",
        room: _objectSpread({
          type: (label === null || label === void 0 ? void 0 : label.type) || 'c',
          _id: value
        }, label)
      }), ' '), /*#__PURE__*/React.createElement(Box, {
        margin: "none",
        mi: "x2"
      }, label === null || label === void 0 ? void 0 : label.name));
    },
    renderItem: _ref3 => {
      let {
        value,
        label
      } = _ref3,
          props = _objectWithoutProperties(_ref3, _excluded);

      return /*#__PURE__*/React.createElement(Option, _extends({
        key: value
      }, props, {
        label: label.name,
        avatar: /*#__PURE__*/React.createElement(Avatar, _extends({
          value: value
        }, label))
      }));
    },
    options: options
  }));
};

module.exportDefault( /*#__PURE__*/memo(RoomAutoComplete));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomAutoComplete/index.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./RoomAutoComplete", {
  default: "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"avatar":{"UserAvatarEditor":{"UserAvatarEditor.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFileInput",
  "../UserAvatar",
  "./UserAvatarSuggestions"
],"UserAvatarSuggestions.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./UserAvatarEditor"
]},"AppAvatar.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./BaseAvatar"
],"BaseAvatar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/avatar/BaseAvatar.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["size"];

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
let Avatar, Skeleton;
module.link("@rocket.chat/fuselage", {
  Avatar(v) {
    Avatar = v;
  },

  Skeleton(v) {
    Skeleton = v;
  }

}, 0);
let React, useState;
module.link("react", {
  default(v) {
    React = v;
  },

  useState(v) {
    useState = v;
  }

}, 1);

const BaseAvatar = _ref => {
  let {
    size
  } = _ref,
      props = _objectWithoutProperties(_ref, _excluded);

  const [error, setError] = useState(false);

  if (error) {
    return /*#__PURE__*/React.createElement(Skeleton, _extends({
      variant: "rect"
    }, props));
  }

  return /*#__PURE__*/React.createElement(Avatar, _extends({
    onError: setError,
    size: size
  }, props));
};

module.exportDefault(BaseAvatar);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomAvatar.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/avatar/RoomAvatar.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["room"],
      _excluded2 = ["url"];

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
let React, memo;
module.link("react", {
  default(v) {
    React = v;
  },

  memo(v) {
    memo = v;
  }

}, 0);
let useRoomAvatarPath;
module.link("../../contexts/AvatarUrlContext", {
  useRoomAvatarPath(v) {
    useRoomAvatarPath = v;
  }

}, 1);
let BaseAvatar;
module.link("./BaseAvatar", {
  default(v) {
    BaseAvatar = v;
  }

}, 2);

function RoomAvatar(_ref) {
  let {
    room
  } = _ref,
      rest = _objectWithoutProperties(_ref, _excluded);

  const getRoomPathAvatar = useRoomAvatarPath();

  const {
    url = getRoomPathAvatar(room)
  } = rest,
        props = _objectWithoutProperties(rest, _excluded2);

  return /*#__PURE__*/React.createElement(BaseAvatar, _extends({
    url: url
  }, props));
}

module.exportDefault( /*#__PURE__*/memo(RoomAvatar));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomAvatarEditor.js":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../app/utils/lib/getAvatarURL",
  "../../contexts/TranslationContext",
  "../../hooks/useFileInput",
  "./RoomAvatar"
],"UserAvatar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/avatar/UserAvatar.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["username", "etag"],
      _excluded2 = ["url"];

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
let React, memo;
module.link("react", {
  default(v) {
    React = v;
  },

  memo(v) {
    memo = v;
  }

}, 0);
let useUserAvatarPath;
module.link("../../contexts/AvatarUrlContext", {
  useUserAvatarPath(v) {
    useUserAvatarPath = v;
  }

}, 1);
let BaseAvatar;
module.link("./BaseAvatar", {
  default(v) {
    BaseAvatar = v;
  }

}, 2);

const UserAvatar = _ref => {
  let {
    username,
    etag
  } = _ref,
      rest = _objectWithoutProperties(_ref, _excluded);

  const getUserAvatarPath = useUserAvatarPath();

  const {
    url = getUserAvatarPath(username, etag)
  } = rest,
        props = _objectWithoutProperties(rest, _excluded2);

  return /*#__PURE__*/React.createElement(BaseAvatar, _extends({
    url: url,
    title: username
  }, props));
};

module.exportDefault( /*#__PURE__*/memo(UserAvatar));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"BurgerMenu":{"BurgerBadge.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react"
],"BurgerIcon.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "./Line",
  "./Wrapper"
],"BurgerMenu.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../contexts/LayoutContext",
  "../../contexts/SessionContext",
  "../../hooks/useEmbeddedLayout",
  "./BurgerMenuButton"
],"BurgerMenuButton.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/TranslationContext",
  "./BurgerBadge",
  "./BurgerIcon"
],"Line.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react"
],"Wrapper.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./BurgerMenu"
]},"Card":{"Body.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Card.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"CardDivider.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"CardIcon.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Col.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"ColSection.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"ColTitle.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Footer.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Title.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./Body",
  "./Card",
  "./CardDivider",
  "./CardIcon",
  "./Col",
  "./ColSection",
  "./ColTitle",
  "./Footer",
  "./Title"
]},"CreateDiscussion":{"CreateDiscussion.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/CreateDiscussion/CreateDiscussion.tsx                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
let Modal, Field, FieldGroup, ToggleSwitch, TextInput, TextAreaInput, ButtonGroup, Button, Icon, Box;
module.link("@rocket.chat/fuselage", {
  Modal(v) {
    Modal = v;
  },

  Field(v) {
    Field = v;
  },

  FieldGroup(v) {
    FieldGroup = v;
  },

  ToggleSwitch(v) {
    ToggleSwitch = v;
  },

  TextInput(v) {
    TextInput = v;
  },

  TextAreaInput(v) {
    TextAreaInput = v;
  },

  ButtonGroup(v) {
    ButtonGroup = v;
  },

  Button(v) {
    Button = v;
  },

  Icon(v) {
    Icon = v;
  },

  Box(v) {
    Box = v;
  }

}, 0);
let useMutableCallback;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback(v) {
    useMutableCallback = v;
  }

}, 1);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 2);
let useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 3);
let useEndpointActionExperimental;
module.link("../../hooks/useEndpointActionExperimental", {
  useEndpointActionExperimental(v) {
    useEndpointActionExperimental = v;
  }

}, 4);
let useForm;
module.link("../../hooks/useForm", {
  useForm(v) {
    useForm = v;
  }

}, 5);
let goToRoomById;
module.link("../../lib/utils/goToRoomById", {
  goToRoomById(v) {
    goToRoomById = v;
  }

}, 6);
let RoomAutoComplete;
module.link("../RoomAutoComplete", {
  default(v) {
    RoomAutoComplete = v;
  }

}, 7);
let UserAutoCompleteMultiple;
module.link("../UserAutoCompleteMultiple", {
  default(v) {
    UserAutoCompleteMultiple = v;
  }

}, 8);
let DefaultParentRoomField;
module.link("./DefaultParentRoomField", {
  default(v) {
    DefaultParentRoomField = v;
  }

}, 9);

const CreateDiscussion = _ref => {
  let {
    onClose,
    defaultParentRoom,
    parentMessageId,
    nameSuggestion
  } = _ref;
  const t = useTranslation();
  const {
    values,
    handlers
  } = useForm({
    name: nameSuggestion || '',
    parentRoom: '',
    encrypted: false,
    usernames: [],
    firstMessage: ''
  });
  const {
    name,
    parentRoom,
    encrypted,
    usernames,
    firstMessage
  } = values;
  const {
    handleName,
    handleParentRoom,
    handleEncrypted,
    handleUsernames,
    handleFirstMessage
  } = handlers;
  const canCreate = (parentRoom || defaultParentRoom) && name;
  const createDiscussion = useEndpointActionExperimental('POST', 'rooms.createDiscussion');
  const create = useMutableCallback(async () => {
    try {
      const result = await createDiscussion(_objectSpread({
        prid: defaultParentRoom || parentRoom,
        // eslint-disable-next-line @typescript-eslint/camelcase
        t_name: name,
        users: usernames,
        reply: encrypted ? undefined : firstMessage
      }, parentMessageId && {
        pmid: parentMessageId
      }));
      goToRoomById(result.discussion._id);
      onClose();
    } catch (error) {
      console.warn(error);
    }
  });
  const onChangeUsers = useMutableCallback((value, action) => {
    if (!action) {
      if (usernames.includes(value)) {
        return;
      }

      return handleUsernames([...usernames, value]);
    }

    handleUsernames(usernames.filter(current => current !== value));
  });
  return /*#__PURE__*/React.createElement(Modal, null, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, null, t('Discussion_title')), /*#__PURE__*/React.createElement(Modal.Close, {
    onClick: onClose
  })), /*#__PURE__*/React.createElement(Modal.Content, null, /*#__PURE__*/React.createElement(FieldGroup, null, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Description, null, t('Discussion_description'))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_target_channel')), /*#__PURE__*/React.createElement(Field.Row, null, defaultParentRoom && /*#__PURE__*/React.createElement(DefaultParentRoomField, {
    defaultParentRoom: defaultParentRoom
  }), !defaultParentRoom && /*#__PURE__*/React.createElement(RoomAutoComplete, {
    value: parentRoom,
    onChange: handleParentRoom,
    placeholder: t('Discussion_target_channel_description'),
    disabled: defaultParentRoom
  }))), /*#__PURE__*/React.createElement(Field, {
    display: "flex",
    alignItems: "center",
    flexDirection: "row",
    justifyContent: "spaceBetween",
    flexGrow: 1
  }, /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    flexDirection: "column",
    width: "full"
  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Encrypted'))), /*#__PURE__*/React.createElement(ToggleSwitch, {
    checked: encrypted,
    onChange: handleEncrypted
  })), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_name')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {
    value: name,
    onChange: handleName,
    addon: /*#__PURE__*/React.createElement(Icon, {
      name: "baloons",
      size: "x20"
    }),
    placeholder: t('New_discussion_name')
  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Invite_Users')), /*#__PURE__*/React.createElement(Field.Row, {
    w: "full",
    display: "flex",
    flexDirection: "column",
    alignItems: "stretch"
  }, /*#__PURE__*/React.createElement(UserAutoCompleteMultiple, {
    value: usernames,
    onChange: onChangeUsers,
    placeholder: t('Username_Placeholder')
  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_first_message_title')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextAreaInput, {
    value: firstMessage,
    onChange: handleFirstMessage,
    placeholder: t('New_discussion_first_message'),
    rows: 5,
    disabled: encrypted
  })), encrypted && /*#__PURE__*/React.createElement(Field.Description, null, t('Discussion_first_message_disabled_due_to_e2e'))))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(ButtonGroup, {
    align: "end"
  }, /*#__PURE__*/React.createElement(Button, {
    onClick: onClose
  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {
    primary: true,
    disabled: !canCreate,
    onClick: create
  }, t('Create')))));
};

module.exportDefault(CreateDiscussion);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"DefaultParentRoomField.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/CreateDiscussion/DefaultParentRoomField.tsx                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Skeleton, TextInput, Callout;
module.link("@rocket.chat/fuselage", {
  Skeleton(v) {
    Skeleton = v;
  },

  TextInput(v) {
    TextInput = v;
  },

  Callout(v) {
    Callout = v;
  }

}, 0);
let React, useMemo;
module.link("react", {
  default(v) {
    React = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 1);
let roomTypes;
module.link("../../../app/utils/client/lib/roomTypes", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 2);
let useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 3);
let AsyncStatePhase;
module.link("../../hooks/useAsyncState", {
  AsyncStatePhase(v) {
    AsyncStatePhase = v;
  }

}, 4);
let useEndpointData;
module.link("../../hooks/useEndpointData", {
  useEndpointData(v) {
    useEndpointData = v;
  }

}, 5);

const DefaultParentRoomField = _ref => {
  let {
    defaultParentRoom
  } = _ref;
  const t = useTranslation();
  const {
    value,
    phase
  } = useEndpointData('rooms.info', useMemo(() => ({
    roomId: defaultParentRoom
  }), [defaultParentRoom]));

  if (phase === AsyncStatePhase.LOADING) {
    return /*#__PURE__*/React.createElement(Skeleton, {
      width: "full"
    });
  }

  if (!value || !value.room) {
    return /*#__PURE__*/React.createElement(Callout, {
      type: 'danger'
    }, t('Error'));
  }

  return /*#__PURE__*/React.createElement(TextInput, {
    value: roomTypes.getRoomName(value.room.t, value.room),
    disabled: true,
    onChange: () => ''
  });
};

module.exportDefault(DefaultParentRoomField);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":[
  "./CreateDiscussion"
]},"Header":{"Avatar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Avatar.tsx                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 0);
let Button;
module.link("./Button", {
  default(v) {
    Button = v;
  }

}, 1);

const Avatar = props => /*#__PURE__*/React.createElement(Button, _extends({
  width: "x36"
}, props));

module.exportDefault(Avatar);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Button.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Button.tsx                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const Button = props => /*#__PURE__*/React.createElement(Box, _extends({
  mi: "x4",
  display: "flex",
  alignItems: "center"
}, props));

module.exportDefault(Button);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Content.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Content.tsx                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const Content = props => /*#__PURE__*/React.createElement(Box, _extends({
  flexGrow: 1,
  width: 1,
  flexShrink: 1,
  mi: "x4",
  display: "flex",
  justifyContent: "center",
  flexDirection: "column"
}, props));

module.exportDefault(Content);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Header.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Header.tsx                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);
let useLayout;
module.link("../../contexts/LayoutContext", {
  useLayout(v) {
    useLayout = v;
  }

}, 2);
let HeaderDivider;
module.link("./HeaderDivider", {
  default(v) {
    HeaderDivider = v;
  }

}, 3);

const Header = props => {
  const {
    isMobile
  } = useLayout();
  return /*#__PURE__*/React.createElement(Box, {
    "rcx-room-header": true,
    is: "header",
    height: "x64",
    display: "flex",
    justifyContent: "center",
    flexDirection: "column",
    overflow: "hidden",
    flexShrink: 0
  }, /*#__PURE__*/React.createElement(Box, _extends({
    height: "x64",
    mi: "neg-x4",
    pi: isMobile ? 'x12' : 'x24',
    display: "flex",
    flexGrow: 1,
    justifyContent: "center",
    alignItems: "center",
    overflow: "hidden",
    flexDirection: "row"
  }, props)), /*#__PURE__*/React.createElement(HeaderDivider, null));
};

module.exportDefault(Header);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderDivider.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderDivider.tsx                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Divider;
module.link("@rocket.chat/fuselage", {
  Divider(v) {
    Divider = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const HeaderDivider = () => /*#__PURE__*/React.createElement(Divider, {
  mbs: -2,
  mbe: 0
});

module.exportDefault(HeaderDivider);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderIcon.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderIcon.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box, Icon;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  Icon(v) {
    Icon = v;
  }

}, 0);
let React, isValidElement;
module.link("react", {
  default(v) {
    React = v;
  },

  isValidElement(v) {
    isValidElement = v;
  }

}, 1);

const HeaderIcon = _ref => {
  let {
    icon
  } = _ref;
  return icon && /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    flexShrink: 0,
    alignItems: "center",
    size: 18,
    overflow: "hidden",
    justifyContent: "center"
  }, /*#__PURE__*/isValidElement(icon) ? icon : /*#__PURE__*/React.createElement(Icon, {
    color: "info",
    size: "x18",
    name: icon.name
  }));
};

module.exportDefault(HeaderIcon);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderLink.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderLink.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _templateObject;

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _taggedTemplateLiteral;

module.link("@babel/runtime/helpers/taggedTemplateLiteral", {
  default(v) {
    _taggedTemplateLiteral = v;
  }

}, 1);
let css;
module.link("@rocket.chat/css-in-js", {
  css(v) {
    css = v;
  }

}, 0);
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 1);
let colors;
module.link("@rocket.chat/fuselage-tokens/colors", {
  default(v) {
    colors = v;
  }

}, 2);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 3);

const HeaderLink = props => /*#__PURE__*/React.createElement(Box, _extends({
  is: "a"
}, props, {
  withTruncatedText: true,
  className: [css(_templateObject || (_templateObject = _taggedTemplateLiteral(["\n\t\t\t\tcolor: ", " !important;\n\t\t\t\t&:hover,\n\t\t\t\t&:focus {\n\t\t\t\t\tcolor: ", " !important;\n\t\t\t\t}\n\t\t\t\t&:visited {\n\t\t\t\t\tcolor: ", ";\n\t\t\t\t}\n\t\t\t"])), colors.n700, colors.n800, colors.n800)].filter(Boolean)
}));

module.exportDefault(HeaderLink);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderTag.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderTag.tsx                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["children"];

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 0);
let Box, Tag;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  Tag(v) {
    Tag = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const HeaderTag = _ref => {
  let {
    children
  } = _ref,
      props = _objectWithoutProperties(_ref, _excluded);

  return /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    minWidth: "65px",
    mi: "x4"
  }, /*#__PURE__*/React.createElement(Tag, props, /*#__PURE__*/React.createElement(Box, {
    alignItems: "center",
    fontScale: "c2",
    display: "flex",
    minWidth: 0
  }, children)));
};

module.exportDefault(HeaderTag);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderTagIcon.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderTagIcon.tsx                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let Box, Icon;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  Icon(v) {
    Icon = v;
  }

}, 0);
let colors;
module.link("@rocket.chat/fuselage-tokens/colors", {
  default(v) {
    colors = v;
  }

}, 1);
let React, isValidElement;
module.link("react", {
  default(v) {
    React = v;
  },

  isValidElement(v) {
    isValidElement = v;
  }

}, 2);

const HeaderTagIcon = _ref => {
  let {
    icon
  } = _ref;
  return icon ? /*#__PURE__*/React.createElement(Box, {
    w: "x16",
    mie: "x2",
    display: "inline-flex",
    justifyContent: "center"
  }, /*#__PURE__*/isValidElement(icon) ? icon : /*#__PURE__*/React.createElement(Icon, _extends({
    size: "x16",
    color: colors.n700
  }, icon))) : null;
};

module.exportDefault(HeaderTagIcon);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderTagSkeleton.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderTagSkeleton.tsx                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Skeleton;
module.link("@rocket.chat/fuselage", {
  Skeleton(v) {
    Skeleton = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const HeaderTagSkeleton = () => /*#__PURE__*/React.createElement(Skeleton, {
  width: "x48"
});

module.exportDefault(HeaderTagSkeleton);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Row.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Row.tsx                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const Row = props => /*#__PURE__*/React.createElement(Box, _extends({
  alignItems: "center",
  flexShrink: 1,
  flexGrow: 1,
  display: "flex"
}, props));

module.exportDefault(Row);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"State.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/State.tsx                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let Icon, ActionButton;
module.link("@rocket.chat/fuselage", {
  Icon(v) {
    Icon = v;
  },

  ActionButton(v) {
    ActionButton = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const State = props => props.onClick ? /*#__PURE__*/React.createElement(ActionButton, _extends({
  ghost: true,
  mini: true
}, props)) : /*#__PURE__*/React.createElement(Icon, _extends({
  size: 16,
  name: props.icon
}, props));

module.exportDefault(State);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Subtitle.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Subtitle.tsx                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const Subtitle = props => /*#__PURE__*/React.createElement(Box, _extends({
  color: "hint",
  fontScale: "p2",
  withTruncatedText: true
}, props));

module.exportDefault(Subtitle);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Title.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Title.tsx                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const Title = props => /*#__PURE__*/React.createElement(Box, _extends({
  color: "default",
  mi: "x4",
  fontScale: "h4",
  withTruncatedText: true
}, props));

module.exportDefault(Title);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ToolBox.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/ToolBox.tsx                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);
let ButtonGroup;
module.link("@rocket.chat/fuselage", {
  ButtonGroup(v) {
    ButtonGroup = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const ToolBox = props => /*#__PURE__*/React.createElement(ButtonGroup, _extends({
  mi: "x4",
  medium: true
}, props));

module.exportDefault(ToolBox);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ToolBoxAction.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/ToolBoxAction.tsx                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["id", "icon", "color", "title", "action", "className", "index"];

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
let ActionButton;
module.link("@rocket.chat/fuselage", {
  ActionButton(v) {
    ActionButton = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);

const ToolBoxAction = _ref => {
  let {
    id,
    icon,
    color,
    title,
    action,
    className,
    index
  } = _ref,
      props = _objectWithoutProperties(_ref, _excluded);

  return /*#__PURE__*/React.createElement(ActionButton, _extends({
    className: className,
    onClick: action,
    title: title,
    "data-toolbox": index,
    key: id,
    icon: icon,
    position: "relative",
    ghost: true,
    tiny: true,
    overflow: "visible",
    color: !!color && color
  }, props));
};

module.exportDefault(ToolBoxAction);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ToolBoxActionBadge.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/ToolBoxActionBadge.tsx                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _templateObject;

let _taggedTemplateLiteral;

module.link("@babel/runtime/helpers/taggedTemplateLiteral", {
  default(v) {
    _taggedTemplateLiteral = v;
  }

}, 0);
let css;
module.link("@rocket.chat/css-in-js", {
  css(v) {
    css = v;
  }

}, 0);
let Box, Badge;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  Badge(v) {
    Badge = v;
  }

}, 1);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 2);

const ToolBoxActionBadge = props => /*#__PURE__*/React.createElement(Box, {
  position: "absolute",
  className: css(_templateObject || (_templateObject = _taggedTemplateLiteral(["\n\t\t\ttop: 0;\n\t\t\tright: 0;\n\t\t\ttransform: translate(30%, -30%);\n\t\t"])))
}, /*#__PURE__*/React.createElement(Badge, props));

module.exportDefault(ToolBoxActionBadge);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/index.ts                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Avatar;
module.link("./Avatar", {
  default(v) {
    Avatar = v;
  }

}, 0);
let Button;
module.link("./Button", {
  default(v) {
    Button = v;
  }

}, 1);
let Content;
module.link("./Content", {
  default(v) {
    Content = v;
  }

}, 2);
let Header;
module.link("./Header", {
  default(v) {
    Header = v;
  }

}, 3);
let HeaderDivider;
module.link("./HeaderDivider", {
  default(v) {
    HeaderDivider = v;
  }

}, 4);
let HeaderIcon;
module.link("./HeaderIcon", {
  default(v) {
    HeaderIcon = v;
  }

}, 5);
let HeaderLink;
module.link("./HeaderLink", {
  default(v) {
    HeaderLink = v;
  }

}, 6);
let HeaderTag;
module.link("./HeaderTag", {
  default(v) {
    HeaderTag = v;
  }

}, 7);
let HeaderTagIcon;
module.link("./HeaderTagIcon", {
  default(v) {
    HeaderTagIcon = v;
  }

}, 8);
let HeaderTagSkeleton;
module.link("./HeaderTagSkeleton", {
  default(v) {
    HeaderTagSkeleton = v;
  }

}, 9);
let Row;
module.link("./Row", {
  default(v) {
    Row = v;
  }

}, 10);
let State;
module.link("./State", {
  default(v) {
    State = v;
  }

}, 11);
let Subtitle;
module.link("./Subtitle", {
  default(v) {
    Subtitle = v;
  }

}, 12);
let Title;
module.link("./Title", {
  default(v) {
    Title = v;
  }

}, 13);
let ToolBox;
module.link("./ToolBox", {
  default(v) {
    ToolBox = v;
  }

}, 14);
let ToolBoxAction;
module.link("./ToolBoxAction", {
  default(v) {
    ToolBoxAction = v;
  }

}, 15);
let ToolBoxActionBadge;
module.link("./ToolBoxActionBadge", {
  default(v) {
    ToolBoxActionBadge = v;
  }

}, 16);
module.exportDefault(Object.assign(Header, {
  Button,
  State,
  Avatar,
  Content: Object.assign(Content, {
    Row
  }),
  Title,
  Subtitle,
  ToolBox,
  ToolBoxAction: Object.assign(ToolBoxAction, {
    Badge: ToolBoxActionBadge
  }),
  Divider: HeaderDivider,
  Icon: HeaderIcon,
  Link: HeaderLink,
  Tag: Object.assign(HeaderTag, {
    Icon: HeaderTagIcon,
    Skeleton: HeaderTagSkeleton
  }),
  Badge: ToolBoxActionBadge
}));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"Page":{"Page.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./PageContext"
],"PageContent.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"PageContext.ts":[
  "react"
],"PageHeader.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/LayoutContext",
  "../BurgerMenu",
  "../Header",
  "./PageContext"
],"PageScrollableContent.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../ScrollableContentWrapper"
],"PageScrollableContentWithShadow.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "./PageContext",
  "./PageScrollableContent"
],"index.ts":[
  "./Page",
  "./PageContent",
  "./PageHeader",
  "./PageScrollableContent",
  "./PageScrollableContentWithShadow"
]},"Sidebar":{"Content.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../ScrollableContentWrapper"
],"GenericItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react"
],"Header.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"ItemsAssembler.js":[
  "react",
  "../../contexts/TranslationContext",
  "./Sidebar"
],"ListItem.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"NavigationItem.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/RouterContext",
  "./Sidebar"
],"Sidebar.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./Content",
  "./GenericItem",
  "./Header",
  "./ItemsAssembler",
  "./ListItem",
  "./NavigationItem",
  "./Sidebar"
]},"SortList":{"GroupingList.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/ServerContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../Sidebar/ListItem"
],"SortList.js":[
  "@rocket.chat/fuselage",
  "react",
  "./GroupingList",
  "./SortModeList",
  "./ViewModeList"
],"SortModeList.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/ServerContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../Sidebar/ListItem"
],"ViewModeList.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/ServerContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../Sidebar/ListItem"
],"index.ts":[
  "./SortList"
]},"TwoFactorModal":{"TwoFactorEmailModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/TwoFactorModal/TwoFactorEmailModal.tsx                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box, TextInput, Icon;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  TextInput(v) {
    TextInput = v;
  },

  Icon(v) {
    Icon = v;
  }

}, 0);
let useAutoFocus;
module.link("@rocket.chat/fuselage-hooks", {
  useAutoFocus(v) {
    useAutoFocus = v;
  }

}, 1);
let React, useState;
module.link("react", {
  default(v) {
    React = v;
  },

  useState(v) {
    useState = v;
  }

}, 2);
let useEndpoint;
module.link("../../contexts/ServerContext", {
  useEndpoint(v) {
    useEndpoint = v;
  }

}, 3);
let useToastMessageDispatch;
module.link("../../contexts/ToastMessagesContext", {
  useToastMessageDispatch(v) {
    useToastMessageDispatch = v;
  }

}, 4);
let useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 5);
let GenericModal;
module.link("../GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 6);
let Method;
module.link("./TwoFactorModal", {
  Method(v) {
    Method = v;
  }

}, 7);

const TwoFactorEmailModal = _ref => {
  let {
    onConfirm,
    onClose,
    emailOrUsername
  } = _ref;
  const dispatchToastMessage = useToastMessageDispatch();
  const t = useTranslation();
  const [code, setCode] = useState('');
  const ref = useAutoFocus();
  const sendEmailCode = useEndpoint('POST', 'users.2fa.sendEmailCode');

  const onClickResendCode = async () => {
    try {
      await sendEmailCode({
        emailOrUsername
      });
      dispatchToastMessage({
        type: 'success',
        message: t('Email_sent')
      });
    } catch (error) {
      dispatchToastMessage({
        type: 'error',
        message: t('error-email-send-failed', {
          message: error
        })
      });
    }
  };

  const onConfirmEmailCode = () => {
    onConfirm(code, Method.EMAIL);
  };

  const onChange = _ref2 => {
    let {
      currentTarget
    } = _ref2;
    setCode(currentTarget.value);
  };

  return /*#__PURE__*/React.createElement(GenericModal, {
    onConfirm: onConfirmEmailCode,
    onCancel: onClose,
    confirmText: t('Verify'),
    title: t('Two-factor_authentication_email'),
    onClose: onClose,
    variant: "warning",
    icon: /*#__PURE__*/React.createElement(Icon, {
      size: "x20",
      name: "info",
      color: "default"
    }),
    confirmDisabled: !code
  }, /*#__PURE__*/React.createElement(Box, {
    mbe: "x16"
  }, t('Verify_your_email_for_the_code_we_sent')), /*#__PURE__*/React.createElement(Box, {
    mbe: "x4",
    display: "flex",
    justifyContent: "stretch"
  }, /*#__PURE__*/React.createElement(TextInput, {
    ref: ref,
    value: code,
    onChange: onChange,
    placeholder: t('Enter_authentication_code')
  })), /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    justifyContent: "end",
    is: "a",
    onClick: onClickResendCode
  }, t('Cloud_resend_email')));
};

module.exportDefault(TwoFactorEmailModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TwoFactorModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/TwoFactorModal/TwoFactorModal.tsx                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["onConfirm", "onClose"];

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 0);
module.export({
  Method: () => Method
});
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 0);
let TwoFactorEmail;
module.link("./TwoFactorEmailModal", {
  default(v) {
    TwoFactorEmail = v;
  }

}, 1);
let TwoFactorPassword;
module.link("./TwoFactorPasswordModal", {
  default(v) {
    TwoFactorPassword = v;
  }

}, 2);
let TwoFactorTotp;
module.link("./TwoFactorTotpModal", {
  default(v) {
    TwoFactorTotp = v;
  }

}, 3);
var Method;

(function (Method) {
  Method["TOTP"] = "totp";
  Method["EMAIL"] = "email";
  Method["PASSWORD"] = "password";
})(Method || module.runSetters(Method = {}, ["Method"]));

const TwoFactorModal = _ref => {
  let {
    onConfirm,
    onClose
  } = _ref,
      props = _objectWithoutProperties(_ref, _excluded);

  if (props.method === Method.TOTP) {
    return /*#__PURE__*/React.createElement(TwoFactorTotp, {
      onConfirm: onConfirm,
      onClose: onClose
    });
  }

  if (props.method === Method.EMAIL) {
    const {
      emailOrUsername
    } = props;
    return /*#__PURE__*/React.createElement(TwoFactorEmail, {
      onConfirm: onConfirm,
      onClose: onClose,
      emailOrUsername: emailOrUsername
    });
  }

  if (props.method === Method.PASSWORD) {
    return /*#__PURE__*/React.createElement(TwoFactorPassword, {
      onConfirm: onConfirm,
      onClose: onClose
    });
  }

  throw new Error('Invalid Two Factor method');
};

module.exportDefault(TwoFactorModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TwoFactorPasswordModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/TwoFactorModal/TwoFactorPasswordModal.tsx                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box, PasswordInput, Icon;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  PasswordInput(v) {
    PasswordInput = v;
  },

  Icon(v) {
    Icon = v;
  }

}, 0);
let useAutoFocus;
module.link("@rocket.chat/fuselage-hooks", {
  useAutoFocus(v) {
    useAutoFocus = v;
  }

}, 1);
let React, useState;
module.link("react", {
  default(v) {
    React = v;
  },

  useState(v) {
    useState = v;
  }

}, 2);
let useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 3);
let GenericModal;
module.link("../GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 4);
let Method;
module.link("./TwoFactorModal", {
  Method(v) {
    Method = v;
  }

}, 5);

const TwoFactorPasswordModal = _ref => {
  let {
    onConfirm,
    onClose
  } = _ref;
  const t = useTranslation();
  const [code, setCode] = useState('');
  const ref = useAutoFocus();

  const onConfirmTotpCode = () => {
    onConfirm(code, Method.PASSWORD);
  };

  const onChange = _ref2 => {
    let {
      currentTarget
    } = _ref2;
    setCode(currentTarget.value);
  };

  return /*#__PURE__*/React.createElement(GenericModal, {
    onConfirm: onConfirmTotpCode,
    onCancel: onClose,
    confirmText: t('Verify'),
    title: t('Please_enter_your_password'),
    onClose: onClose,
    variant: "warning",
    icon: /*#__PURE__*/React.createElement(Icon, {
      size: "x20",
      name: "info",
      color: "default"
    }),
    confirmDisabled: !code
  }, /*#__PURE__*/React.createElement(Box, {
    mbe: "x16"
  }, t('For_your_security_you_must_enter_your_current_password_to_continue')), /*#__PURE__*/React.createElement(Box, {
    mbe: "x16",
    display: "flex",
    justifyContent: "stretch"
  }, /*#__PURE__*/React.createElement(PasswordInput, {
    ref: ref,
    value: code,
    onChange: onChange,
    placeholder: t('Password')
  })));
};

module.exportDefault(TwoFactorPasswordModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TwoFactorTotpModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/TwoFactorModal/TwoFactorTotpModal.tsx                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box, TextInput, Icon;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  TextInput(v) {
    TextInput = v;
  },

  Icon(v) {
    Icon = v;
  }

}, 0);
let useAutoFocus;
module.link("@rocket.chat/fuselage-hooks", {
  useAutoFocus(v) {
    useAutoFocus = v;
  }

}, 1);
let React, useState;
module.link("react", {
  default(v) {
    React = v;
  },

  useState(v) {
    useState = v;
  }

}, 2);
let useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 3);
let GenericModal;
module.link("../GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 4);
let Method;
module.link("./TwoFactorModal", {
  Method(v) {
    Method = v;
  }

}, 5);

const TwoFactorTotpModal = _ref => {
  let {
    onConfirm,
    onClose
  } = _ref;
  const t = useTranslation();
  const [code, setCode] = useState('');
  const ref = useAutoFocus();

  const onConfirmTotpCode = () => {
    onConfirm(code, Method.TOTP);
  };

  const onChange = _ref2 => {
    let {
      currentTarget
    } = _ref2;
    setCode(currentTarget.value);
  };

  return /*#__PURE__*/React.createElement(GenericModal, {
    onConfirm: onConfirmTotpCode,
    onCancel: onClose,
    confirmText: t('Verify'),
    title: t('Two Factor Authentication'),
    onClose: onClose,
    variant: "warning",
    icon: /*#__PURE__*/React.createElement(Icon, {
      size: "x20",
      name: "info",
      color: "default"
    }),
    confirmDisabled: !code
  }, /*#__PURE__*/React.createElement(Box, {
    mbe: "x16"
  }, t('Open_your_authentication_app_and_enter_the_code')), /*#__PURE__*/React.createElement(Box, {
    mbe: "x16",
    display: "flex",
    justifyContent: "stretch"
  }, /*#__PURE__*/React.createElement(TextInput, {
    ref: ref,
    value: code,
    onChange: onChange,
    placeholder: t('Enter_authentication_code')
  })));
};

module.exportDefault(TwoFactorTotpModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/TwoFactorModal/index.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./TwoFactorModal", {
  default: "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"UserAutoComplete":{"Avatar.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../avatar/UserAvatar"
],"UserAutoComplete.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../hooks/useEndpointData",
  "../avatar/UserAvatar",
  "./Avatar"
],"index.js":[
  "./UserAutoComplete"
]},"UserAutoCompleteMultiple":{"UserAutoCompleteMultiple.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/UserAutoCompleteMultiple/UserAutoCompleteMultiple.js                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["value", "label"];

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 0);

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 1);
let AutoComplete, Box, Option, Chip;
module.link("@rocket.chat/fuselage", {
  AutoComplete(v) {
    AutoComplete = v;
  },

  Box(v) {
    Box = v;
  },

  Option(v) {
    Option = v;
  },

  Chip(v) {
    Chip = v;
  }

}, 0);
let useMutableCallback, useDebouncedValue;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback(v) {
    useMutableCallback = v;
  },

  useDebouncedValue(v) {
    useDebouncedValue = v;
  }

}, 1);
let React, memo, useMemo, useState;
module.link("react", {
  default(v) {
    React = v;
  },

  memo(v) {
    memo = v;
  },

  useMemo(v) {
    useMemo = v;
  },

  useState(v) {
    useState = v;
  }

}, 2);
let useEndpointData;
module.link("../../hooks/useEndpointData", {
  useEndpointData(v) {
    useEndpointData = v;
  }

}, 3);
let UserAvatar;
module.link("../avatar/UserAvatar", {
  default(v) {
    UserAvatar = v;
  }

}, 4);

const query = function () {
  let term = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  return {
    selector: JSON.stringify({
      term
    })
  };
};

const UserAutoCompleteMultiple = props => {
  const [filter, setFilter] = useState('');
  const debouncedFilter = useDebouncedValue(filter, 1000);
  const {
    value: data
  } = useEndpointData('users.autocomplete', useMemo(() => query(debouncedFilter), [debouncedFilter]));
  const options = useMemo(() => data && data.items.map(user => ({
    value: user.username,
    label: user.name
  })) || [], [data]);
  const onClickRemove = useMutableCallback(e => {
    e.stopPropagation();
    e.preventDefault();
    props.onChange(e.currentTarget.value, 'remove');
  });
  return /*#__PURE__*/React.createElement(AutoComplete, _extends({}, props, {
    filter: filter,
    setFilter: setFilter,
    renderSelected: _ref => {
      let {
        value: selected
      } = _ref;
      return selected === null || selected === void 0 ? void 0 : selected.map(value => /*#__PURE__*/React.createElement(Chip, _extends({
        key: value
      }, props, {
        height: "x20",
        value: value,
        onClick: onClickRemove,
        mie: "x4"
      }), /*#__PURE__*/React.createElement(UserAvatar, {
        size: "x20",
        username: value
      }), /*#__PURE__*/React.createElement(Box, {
        is: "span",
        margin: "none",
        mis: "x4"
      }, value)));
    },
    renderItem: _ref2 => {
      let {
        value,
        label
      } = _ref2,
          props = _objectWithoutProperties(_ref2, _excluded);

      return /*#__PURE__*/React.createElement(Option, _extends({
        key: value
      }, props), /*#__PURE__*/React.createElement(Option.Avatar, null, /*#__PURE__*/React.createElement(UserAvatar, {
        username: value,
        size: "x20"
      })), /*#__PURE__*/React.createElement(Option.Content, null, label, " ", /*#__PURE__*/React.createElement(Option.Description, null, "(", value, ")")));
    },
    options: options
  }));
};

module.exportDefault( /*#__PURE__*/memo(UserAutoCompleteMultiple));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/UserAutoCompleteMultiple/index.ts                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./UserAutoCompleteMultiple", {
  default: "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"UserCard":{"Action.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"Info.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Role.js":[
  "@rocket.chat/fuselage",
  "react"
],"Roles.js":[
  "react",
  "./Info"
],"UserCard.js":[
  "@rocket.chat/fuselage",
  "react",
  "../MarkdownText",
  "../UserStatus",
  "../avatar/UserAvatar",
  "./Info",
  "./Roles",
  "./UserCardContainer",
  "./Username"
],"UserCardContainer.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Username.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../UserStatus"
],"index.ts":[
  "./Action",
  "./Info",
  "./Role",
  "./Roles",
  "./UserCard",
  "./Username"
]},"UserStatus":{"Away.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./UserStatus"
],"Busy.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./UserStatus"
],"Loading.tsx":[
  "react",
  "./UserStatus"
],"Offline.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./UserStatus"
],"Online.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./UserStatus"
],"ReactiveUserStatus.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../hooks/usePresence",
  "./UserStatus"
],"UserStatus.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/TranslationContext"
],"index.ts":[
  "./UserStatus",
  "./Busy",
  "./Away",
  "./Online",
  "./Offline",
  "./Loading",
  "./ReactiveUserStatus"
]},"VerticalBar":{"VerticalBar.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../providers/LayoutProvider"
],"VerticalBarAction.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarActionBack.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./VerticalBarAction"
],"VerticalBarActions.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarButton.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarClose.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "../../contexts/TranslationContext",
  "./VerticalBarAction"
],"VerticalBarContent.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "../Page"
],"VerticalBarFooter.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarHeader.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarIcon.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarInnerContent.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarScrollableContent.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../Page"
],"VerticalBarSkeleton.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./VerticalBar",
  "./VerticalBarHeader"
],"VerticalBarText.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./VerticalBar",
  "./VerticalBarAction",
  "./VerticalBarActionBack",
  "./VerticalBarActions",
  "./VerticalBarButton",
  "./VerticalBarClose",
  "./VerticalBarContent",
  "./VerticalBarFooter",
  "./VerticalBarHeader",
  "./VerticalBarIcon",
  "./VerticalBarInnerContent",
  "./VerticalBarScrollableContent",
  "./VerticalBarSkeleton",
  "./VerticalBarText"
]},"connectionStatus":{"ConnectionStatusBar.css":[],"ConnectionStatusBar.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/ConnectionStatusContext",
  "../../contexts/TranslationContext",
  "./ConnectionStatusBar.css"
]},"data":{"Counter.js":[
  "@rocket.chat/fuselage",
  "react",
  "./Growth"
],"CounterSet.js":[
  "@rocket.chat/fuselage",
  "react",
  "./Counter"
],"Growth.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./NegativeGrowthSymbol",
  "./PositiveGrowthSymbol"
],"NegativeGrowthSymbol.js":[
  "@babel/runtime/helpers/extends",
  "react"
],"PositiveGrowthSymbol.js":[
  "@babel/runtime/helpers/extends",
  "react"
]},"AutoCompleteAgent.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../hooks/lists/useRecordList",
  "../lib/asyncState",
  "./Omnichannel/hooks/useAgentsList"
],"AutoCompleteDepartment.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../contexts/TranslationContext",
  "../hooks/lists/useRecordList",
  "../hooks/useAsyncState",
  "./Omnichannel/hooks/useDepartmentsList"
],"AutoCompleteDepartmentMultiple.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../contexts/TranslationContext",
  "../hooks/lists/useRecordList",
  "../hooks/useAsyncState",
  "./Omnichannel/hooks/useDepartmentsList"
],"Backdrop.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"ConfirmOwnerChangeWarningModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../contexts/TranslationContext",
  "./GenericModal",
  "./RawText"
],"CustomFieldsForm.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/string-helpers",
  "react",
  "../contexts/SettingsContext",
  "../contexts/TranslationContext",
  "../hooks/useComponentDidUpdate",
  "../hooks/useForm"
],"DotLeader.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Emoji.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Emoji.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 0);
let renderEmoji;
module.link("../lib/utils/renderEmoji", {
  renderEmoji(v) {
    renderEmoji = v;
  }

}, 1);

function Emoji(_ref) {
  let {
    emojiHandle,
    className = undefined
  } = _ref;
  const markup = {
    __html: "".concat(renderEmoji(emojiHandle))
  };
  return /*#__PURE__*/React.createElement("span", {
    className: className,
    dangerouslySetInnerHTML: markup
  });
}

module.exportDefault(Emoji);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ErrorBoundary.tsx":[
  "react"
],"ExternalLink.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"FilterByText.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../contexts/TranslationContext"
],"GenericModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/GenericModal.tsx                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["variant", "children", "cancelText", "confirmText", "title", "icon", "onCancel", "onClose", "onConfirm", "dontAskAgain", "confirmDisabled"];

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
module.export({
  GenericModalDoNotAskAgain: () => GenericModalDoNotAskAgain
});
let Box, Button, ButtonGroup, Icon, Modal;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  Button(v) {
    Button = v;
  },

  ButtonGroup(v) {
    ButtonGroup = v;
  },

  Icon(v) {
    Icon = v;
  },

  Modal(v) {
    Modal = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);
let useTranslation;
module.link("../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 2);
let withDoNotAskAgain;
module.link("./withDoNotAskAgain", {
  withDoNotAskAgain(v) {
    withDoNotAskAgain = v;
  }

}, 3);
const iconMap = {
  danger: 'modal-warning',
  warning: 'modal-warning',
  info: 'info',
  success: 'check'
};

const getButtonProps = variant => {
  switch (variant) {
    case 'danger':
      return {
        primary: true,
        danger: true
      };

    case 'warning':
      return {
        primary: true
      };

    default:
      return {};
  }
};

const renderIcon = (icon, variant) => {
  if (icon === null) {
    return null;
  }

  if (icon === undefined) {
    return /*#__PURE__*/React.createElement(Icon, {
      color: variant,
      name: iconMap[variant],
      size: 24
    });
  }

  if (typeof icon === 'string') {
    return /*#__PURE__*/React.createElement(Icon, {
      color: variant,
      name: icon,
      size: 24
    });
  }

  return icon;
};

const GenericModal = _ref => {
  let {
    variant = 'info',
    children,
    cancelText,
    confirmText,
    title,
    icon,
    onCancel,
    onClose = onCancel,
    onConfirm,
    dontAskAgain,
    confirmDisabled
  } = _ref,
      props = _objectWithoutProperties(_ref, _excluded);

  const t = useTranslation();
  return /*#__PURE__*/React.createElement(Modal, props, /*#__PURE__*/React.createElement(Modal.Header, null, renderIcon(icon, variant), /*#__PURE__*/React.createElement(Modal.Title, null, title !== null && title !== void 0 ? title : t('Are_you_sure')), /*#__PURE__*/React.createElement(Modal.Close, {
    onClick: onClose
  })), /*#__PURE__*/React.createElement(Modal.Content, {
    fontScale: "p2"
  }, children), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    flexDirection: "row",
    justifyContent: "space-between",
    alignItems: "center"
  }, dontAskAgain, /*#__PURE__*/React.createElement(ButtonGroup, {
    align: "end",
    flexGrow: 1,
    maxWidth: "full"
  }, onCancel && /*#__PURE__*/React.createElement(Button, {
    ghost: true,
    onClick: onCancel
  }, cancelText !== null && cancelText !== void 0 ? cancelText : t('Cancel')), /*#__PURE__*/React.createElement(Button, _extends({}, getButtonProps(variant), {
    onClick: onConfirm,
    disabled: confirmDisabled
  }), confirmText !== null && confirmText !== void 0 ? confirmText : t('Ok'))))));
};

const GenericModalDoNotAskAgain = withDoNotAskAgain(GenericModal);
module.exportDefault(GenericModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"LocalTime.tsx":[
  "react",
  "../contexts/TranslationContext",
  "../hooks/useUTCClock"
],"MarkdownText.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "dompurify",
  "marked",
  "react",
  "../lib/utils/renderMessageEmoji"
],"ModalPortal.tsx":[
  "react",
  "react-dom"
],"NotAuthorizedPage.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../contexts/TranslationContext",
  "./Page"
],"PageSkeleton.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./Page"
],"PlanTag.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../contexts/ServerContext"
],"RawText.js":[
  "react"
],"RoomForeword.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../app/models/client",
  "../../app/utils/client",
  "../contexts/TranslationContext",
  "../contexts/UserContext",
  "../hooks/useReactiveValue"
],"ScrollableContentWrapper.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "rc-scrollbars",
  "react"
],"Skeleton.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Subtitle.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"TextCopy.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../contexts/ToastMessagesContext",
  "../contexts/TranslationContext"
],"TooltipComponent.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"UTCClock.tsx":[
  "react",
  "../hooks/useUTCClock"
],"UrlChangeModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/UrlChangeModal.tsx                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Box;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);
let useTranslation;
module.link("../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 2);
let GenericModal;
module.link("./GenericModal", {
  default(v) {
    GenericModal = v;
  }

}, 3);

const UrlChangeModal = _ref => {
  let {
    onConfirm,
    siteUrl,
    currentUrl,
    onClose
  } = _ref;
  const t = useTranslation();
  return /*#__PURE__*/React.createElement(GenericModal, {
    variant: "warning",
    title: t('Warning'),
    onConfirm: onConfirm,
    onClose: onClose,
    onCancel: onClose,
    confirmText: t('Yes')
  }, /*#__PURE__*/React.createElement(Box, {
    is: "p",
    mbe: "x16",
    dangerouslySetInnerHTML: {
      __html: t('The_setting_s_is_configured_to_s_and_you_are_accessing_from_s', t('Site_Url'), siteUrl, currentUrl)
    }
  }), /*#__PURE__*/React.createElement("p", {
    dangerouslySetInnerHTML: {
      __html: t('Do_you_want_to_change_to_s_question', currentUrl)
    }
  }));
};

module.exportDefault(UrlChangeModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserStatusMenu.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../contexts/SettingsContext",
  "../contexts/TranslationContext",
  "./UserStatus"
],"withDoNotAskAgain.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/withDoNotAskAgain.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["onConfirm", "dontAskAgain"];

let _extends;

module.link("@babel/runtime/helpers/extends", {
  default(v) {
    _extends = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
module.export({
  withDoNotAskAgain: () => withDoNotAskAgain
});
let Box, CheckBox;
module.link("@rocket.chat/fuselage", {
  Box(v) {
    Box = v;
  },

  CheckBox(v) {
    CheckBox = v;
  }

}, 0);
let React, useState;
module.link("react", {
  default(v) {
    React = v;
  },

  useState(v) {
    useState = v;
  }

}, 1);
let useMethod;
module.link("../contexts/ServerContext", {
  useMethod(v) {
    useMethod = v;
  }

}, 2);
let useTranslation;
module.link("../contexts/TranslationContext", {
  useTranslation(v) {
    useTranslation = v;
  }

}, 3);
let useUserPreference;
module.link("../contexts/UserContext", {
  useUserPreference(v) {
    useUserPreference = v;
  }

}, 4);

function withDoNotAskAgain(Component) {
  var _ref2, _Component$displayNam;

  const WrappedComponent = function (_ref) {
    let {
      onConfirm,
      dontAskAgain
    } = _ref,
        props = _objectWithoutProperties(_ref, _excluded);

    const t = useTranslation();
    const dontAskAgainList = useUserPreference('dontAskAgainList');
    const {
      action,
      label
    } = dontAskAgain;
    const saveFn = useMethod('saveUserPreferences');
    const [state, setState] = useState(false);

    const handleConfirm = async () => {
      try {
        if (state) {
          await saveFn({
            dontAskAgainList: [...(dontAskAgainList || []), {
              action,
              label
            }]
          });
        }

        await onConfirm();
      } catch (e) {
        console.error(e);
      }
    };

    const onChange = () => {
      setState(!state);
    };

    return /*#__PURE__*/React.createElement(Component, _extends({}, props, {
      dontAskAgain: /*#__PURE__*/React.createElement(Box, {
        display: "flex",
        flexDirection: "row"
      }, /*#__PURE__*/React.createElement(CheckBox, {
        checked: state,
        onChange: onChange,
        mie: "x4",
        name: "dont_ask_again"
      }), /*#__PURE__*/React.createElement("label", {
        htmlFor: "dont_ask_again"
      }, t('Dont_ask_me_again'))),
      onConfirm: handleConfirm
    }));
  };

  WrappedComponent.displayName = "withDoNotAskAgain(".concat((_ref2 = (_Component$displayNam = Component.displayName) !== null && _Component$displayNam !== void 0 ? _Component$displayNam : Component.name) !== null && _ref2 !== void 0 ? _ref2 : 'Component', ")");
  return WrappedComponent;
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"2fa":{"overrideLoginMethod.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/2fa/overrideLoginMethod.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  overrideLoginMethod: () => overrideLoginMethod
});
let t;
module.link("../../../app/utils/client", {
  t(v) {
    t = v;
  }

}, 0);
let dispatchToastMessage;
module.link("../toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 1);
let process2faReturn;
module.link("./process2faReturn", {
  process2faReturn(v) {
    process2faReturn = v;
  }

}, 2);
let isTotpInvalidError, isTotpRequiredError;
module.link("./utils", {
  isTotpInvalidError(v) {
    isTotpInvalidError = v;
  },

  isTotpRequiredError(v) {
    isTotpRequiredError = v;
  }

}, 3);

const overrideLoginMethod = (loginMethod, loginArgs, callback, loginMethodTOTP, emailOrUsername) => {
  loginMethod.call(null, ...loginArgs, (error, result) => {
    if (!isTotpRequiredError(error)) {
      callback(error);
      return;
    }

    process2faReturn({
      error,
      result,
      emailOrUsername,
      originalCallback: callback,
      onCode: code => {
        loginMethodTOTP === null || loginMethodTOTP === void 0 ? void 0 : loginMethodTOTP.call(null, ...loginArgs, code, error => {
          if (isTotpInvalidError(error)) {
            dispatchToastMessage({
              type: 'error',
              message: t('Invalid_two_factor_code')
            });
            callback(null);
            return;
          }

          callback(error);
        });
      }
    });
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"process2faReturn.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/2fa/process2faReturn.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  process2faReturn: () => process2faReturn
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let SHA256;
module.link("meteor/sha", {
  SHA256(v) {
    SHA256 = v;
  }

}, 1);
let TwoFactorModal;
module.link("../../components/TwoFactorModal", {
  default(v) {
    TwoFactorModal = v;
  }

}, 2);
let imperativeModal;
module.link("../imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 3);
let isTotpRequiredError;
module.link("./utils", {
  isTotpRequiredError(v) {
    isTotpRequiredError = v;
  }

}, 4);
const twoFactorMethods = ['totp', 'email', 'password'];

const isTwoFactorMethod = method => twoFactorMethods.includes(method);

const hasRequiredTwoFactorMethod = error => {
  const details = error.details;
  return typeof details === 'object' && details !== null && typeof details.method === 'string' && isTwoFactorMethod(details.method);
};

function assertModalProps(props) {
  if (props.method === 'email' && typeof props.emailOrUsername !== 'string') {
    throw new Error('Invalid Two Factor method');
  }
}

function process2faReturn(_ref) {
  var _Meteor$user;

  let {
    error,
    result,
    originalCallback,
    onCode,
    emailOrUsername
  } = _ref;

  if (!isTotpRequiredError(error) || !hasRequiredTwoFactorMethod(error)) {
    originalCallback(error, result);
    return;
  }

  const props = {
    method: error.details.method,
    emailOrUsername: emailOrUsername !== null && emailOrUsername !== void 0 ? emailOrUsername : (_Meteor$user = Meteor.user()) === null || _Meteor$user === void 0 ? void 0 : _Meteor$user.username
  };
  assertModalProps(props);
  imperativeModal.open({
    component: TwoFactorModal,
    props: _objectSpread(_objectSpread({}, props), {}, {
      onConfirm: (code, method) => {
        imperativeModal.close();
        onCode(method === 'password' ? SHA256(code) : code, method);
      },
      onClose: () => {
        imperativeModal.close();
        originalCallback(new Meteor.Error('totp-canceled'));
      }
    })
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"utils.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/2fa/utils.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isTotpRequiredError: () => isTotpRequiredError,
  isTotpInvalidError: () => isTotpInvalidError,
  isLoginCancelledError: () => isLoginCancelledError,
  reportError: () => reportError,
  convertError: () => convertError
});
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);

const isTotpRequiredError = error => typeof error === 'object' && ((error === null || error === void 0 ? void 0 : error.error) === 'totp-required' || (error === null || error === void 0 ? void 0 : error.errorType) === 'totp-required');

const isTotpInvalidError = error => (error === null || error === void 0 ? void 0 : error.error) === 'totp-invalid' || (error === null || error === void 0 ? void 0 : error.errorType) === 'totp-invalid';

const isLoginCancelledError = error => error instanceof Meteor.Error && error.error === Accounts.LoginCancelledError.numericError;

const reportError = (error, callback) => {
  if (callback) {
    callback(error);
    return;
  }

  throw error;
};

const convertError = error => {
  if (isLoginCancelledError(error)) {
    return new Accounts.LoginCancelledError(error.reason);
  }

  return error;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"asyncState":{"AsyncState.ts":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/asyncState/AsyncState.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"AsyncStatePhase.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/asyncState/AsyncStatePhase.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AsyncStatePhase: () => AsyncStatePhase
});
var AsyncStatePhase;

(function (AsyncStatePhase) {
  AsyncStatePhase["LOADING"] = "loading";
  AsyncStatePhase["RESOLVED"] = "resolved";
  AsyncStatePhase["REJECTED"] = "rejected";
  AsyncStatePhase["UPDATING"] = "updating";
})(AsyncStatePhase || module.runSetters(AsyncStatePhase = {}, ["AsyncStatePhase"]));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"functions.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/asyncState/functions.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  loading: () => loading,
  updating: () => updating,
  resolved: () => resolved,
  rejected: () => rejected,
  reload: () => reload,
  update: () => update,
  resolve: () => resolve,
  reject: () => reject,
  value: () => value,
  error: () => error
});
let AsyncStatePhase;
module.link("./AsyncStatePhase", {
  AsyncStatePhase(v) {
    AsyncStatePhase = v;
  }

}, 0);

const loading = () => ({
  phase: AsyncStatePhase.LOADING,
  value: undefined,
  error: undefined
});

const updating = value => ({
  phase: AsyncStatePhase.UPDATING,
  value,
  error: undefined
});

const resolved = value => ({
  phase: AsyncStatePhase.RESOLVED,
  value,
  error: undefined
});

const rejected = error => ({
  phase: AsyncStatePhase.REJECTED,
  value: undefined,
  error
});

const reload = prevState => {
  switch (prevState.phase) {
    case AsyncStatePhase.LOADING:
      return prevState;

    case AsyncStatePhase.UPDATING:
    case AsyncStatePhase.RESOLVED:
      return {
        phase: AsyncStatePhase.LOADING,
        value: prevState.value,
        error: undefined
      };

    case AsyncStatePhase.REJECTED:
      return {
        phase: AsyncStatePhase.LOADING,
        value: undefined,
        error: prevState.error
      };
  }
};

const update = prevState => {
  switch (prevState.phase) {
    case AsyncStatePhase.LOADING:
    case AsyncStatePhase.UPDATING:
      return prevState;

    case AsyncStatePhase.RESOLVED:
      return {
        phase: AsyncStatePhase.UPDATING,
        value: prevState.value,
        error: undefined
      };

    case AsyncStatePhase.REJECTED:
      return {
        phase: AsyncStatePhase.LOADING,
        value: undefined,
        error: prevState.error
      };
  }
};

const resolve = (prevState, value) => {
  switch (prevState.phase) {
    case AsyncStatePhase.LOADING:
    case AsyncStatePhase.UPDATING:
      return {
        phase: AsyncStatePhase.RESOLVED,
        value,
        error: undefined
      };

    case AsyncStatePhase.RESOLVED:
    case AsyncStatePhase.REJECTED:
      return prevState;
  }
};

const reject = (prevState, error) => {
  switch (prevState.phase) {
    case AsyncStatePhase.LOADING:
    case AsyncStatePhase.UPDATING:
      return {
        phase: AsyncStatePhase.REJECTED,
        value: undefined,
        error
      };

    case AsyncStatePhase.RESOLVED:
    case AsyncStatePhase.REJECTED:
      return prevState;
  }
};

const value = state => state.value;

const error = state => state.error;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/asyncState/index.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./AsyncState", {
  AsyncState: "AsyncState"
}, 0);
module.link("./AsyncStatePhase", {
  AsyncStatePhase: "AsyncStatePhase"
}, 1);
module.link("./functions", {
  "*": "asyncState"
}, 2);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lists":{"CannedResponseList.ts":[
  "./RecordList"
],"DiscussionsList.ts":[
  "@rocket.chat/string-helpers",
  "./MessageList"
],"FilesList.ts":[
  "./MessageList"
],"MessageList.ts":[
  "./RecordList"
],"RecordList.ts":[
  "@babel/runtime/helpers/classPrivateFieldLooseBase",
  "@babel/runtime/helpers/classPrivateFieldLooseKey",
  "@rocket.chat/emitter",
  "../asyncState"
],"ThreadsList.ts":[
  "@rocket.chat/string-helpers",
  "./MessageList"
]},"minimongo":{"bson.ts":[
  "./types"
],"comparisons.ts":[],"index.ts":[
  "./query",
  "./sort",
  "./types"
],"lookups.ts":[
  "./comparisons"
],"query.ts":[
  "./bson",
  "./comparisons",
  "./lookups"
],"sort.ts":[
  "./bson",
  "./comparisons",
  "./lookups"
],"types.ts":[]},"portals":{"blazePortals.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/blazePortals.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  blazePortals: () => blazePortals
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 1);

class BlazePortalsSubscriptions extends Emitter {
  constructor() {
    super(...arguments);
    this.map = new Map();

    this.getCurrentValue = () => Array.from(this.map.values());

    this.subscribe = callback => this.on('update', callback);

    this.register = (template, node) => {
      const entry = this.map.get(template);

      if (!entry) {
        this.map.set(template, {
          key: Random.id(),
          node
        });
        this.emit('update');
        return;
      }

      if (entry.node === node) {
        return;
      }

      this.map.set(template, _objectSpread(_objectSpread({}, entry), {}, {
        node
      }));
      this.emit('update');
    };

    this.unregister = template => {
      if (this.map.delete(template)) {
        this.emit('update');
      }
    };
  }

}

const blazePortals = new BlazePortalsSubscriptions();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createEphemeralPortal.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/createEphemeralPortal.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createEphemeralPortal: () => createEphemeralPortal
});
let createLazyPortal;
module.link("./createLazyPortal", {
  createLazyPortal(v) {
    createLazyPortal = v;
  }

}, 0);
let registerPortal;
module.link("./portalsSubscription", {
  registerPortal(v) {
    registerPortal = v;
  }

}, 1);

const createEphemeralPortal = (factory, propsFn, container) => {
  const portal = createLazyPortal(factory, propsFn, container);
  return registerPortal(container, portal);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createLazyElement.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/createLazyElement.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createLazyElement: () => createLazyElement
});
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 0);
let createElement, lazy, useEffect, useState, Suspense;
module.link("react", {
  createElement(v) {
    createElement = v;
  },

  lazy(v) {
    lazy = v;
  },

  useEffect(v) {
    useEffect = v;
  },

  useState(v) {
    useState = v;
  },

  Suspense(v) {
    Suspense = v;
  }

}, 1);

const createLazyElement = (factory, getProps) => {
  const LazyComponent = /*#__PURE__*/lazy(factory);

  if (!getProps) {
    return /*#__PURE__*/createElement(LazyComponent);
  }

  const WrappedComponent = () => {
    const [props, setProps] = useState(() => Tracker.nonreactive(getProps));
    useEffect(() => {
      const computation = Tracker.autorun(() => {
        setProps(getProps());
      });
      return () => {
        computation.stop();
      };
    }, []);
    return /*#__PURE__*/createElement(Suspense, {
      fallback: null
    }, /*#__PURE__*/createElement(LazyComponent, props));
  };

  return /*#__PURE__*/createElement(WrappedComponent);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createLazyPortal.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/createLazyPortal.ts                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createLazyPortal: () => createLazyPortal
});
let createPortal;
module.link("react-dom", {
  createPortal(v) {
    createPortal = v;
  }

}, 0);
let createLazyElement;
module.link("./createLazyElement", {
  createLazyElement(v) {
    createLazyElement = v;
  }

}, 1);

const createLazyPortal = (factory, getProps, container) => /*#__PURE__*/createPortal(createLazyElement(factory, getProps), container);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createTemplateForComponent.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/createTemplateForComponent.ts                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  createTemplateForComponent: () => createTemplateForComponent
});
let Blaze;
module.link("meteor/blaze", {
  Blaze(v) {
    Blaze = v;
  }

}, 0);
let HTML;
module.link("meteor/htmljs", {
  HTML(v) {
    HTML = v;
  }

}, 1);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 2);
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 3);
let blazePortals;
module.link("./blazePortals", {
  blazePortals(v) {
    blazePortals = v;
  }

}, 4);
let createLazyPortal;
module.link("./createLazyPortal", {
  createLazyPortal(v) {
    createLazyPortal = v;
  }

}, 5);

const createTemplateForComponent = function (name, factory) {
  let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {
    renderContainerView: () => HTML.DIV()
  };

  if (Template[name]) {
    return name;
  }

  const renderFunction = 'renderContainerView' in options && options.renderContainerView || 'attachment' in options && options.attachment === 'at-parent' && (() => HTML.Comment('anchor')) || (() => HTML.DIV());

  const template = new Blaze.Template(name, renderFunction);
  template.onRendered(function () {
    const props = new ReactiveVar(this.data);
    this.autorun(() => {
      props.set(_objectSpread(_objectSpread({}, 'props' in options && typeof options.props === 'function' && options.props()), Template.currentData()));
    });
    const container = 'renderContainerView' in options && this.firstNode || 'attachment' in options && options.attachment === 'at-parent' && this.firstNode.parentElement || null;

    if (!container) {
      return;
    }

    const portal = createLazyPortal(factory, () => props.get(), container);
    blazePortals.register(this, portal);
  });
  template.onDestroyed(function () {
    blazePortals.unregister(this);
  });
  Template[name] = template;
  return name;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"portalsSubscription.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/portalsSubscription.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  portalsSubscription: () => portalsSubscription,
  unregisterPortal: () => unregisterPortal,
  registerPortal: () => registerPortal
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 1);

const createPortalsSubscription = () => {
  const portalsMap = new Map();
  const emitter = new Emitter();
  return {
    getCurrentValue: () => Array.from(portalsMap.values()),
    subscribe: callback => emitter.on('update', callback),
    delete: key => {
      portalsMap.delete(key);
      emitter.emit('update');
    },
    set: (key, portal) => {
      portalsMap.set(key, {
        portal,
        key: Random.id()
      });
      emitter.emit('update');
    },
    has: key => portalsMap.has(key)
  };
};

const portalsSubscription = createPortalsSubscription();

const unregisterPortal = key => {
  portalsSubscription.delete(key);
};

const registerPortal = (key, portal) => {
  portalsSubscription.set(key, portal);
  return () => {
    unregisterPortal(key);
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"settings":{"PrivateSettingsCachedCollection.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "../../../app/notifications/client",
  "../../../app/ui-cached-collection/client"
],"PublicSettingsCachedCollection.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/settings/PublicSettingsCachedCollection.ts                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  PublicSettingsCachedCollection: () => PublicSettingsCachedCollection
});
let CachedCollection;
module.link("../../../app/ui-cached-collection/client", {
  CachedCollection(v) {
    CachedCollection = v;
  }

}, 0);

class PublicSettingsCachedCollection extends CachedCollection {
  constructor() {
    super({
      name: 'public-settings',
      eventType: 'onAll',
      userRelated: false,
      listenChangesForLoggedUsersOnly: true
    });
  }

  static get() {
    if (!PublicSettingsCachedCollection.instance) {
      PublicSettingsCachedCollection.instance = new PublicSettingsCachedCollection();
    }

    return PublicSettingsCachedCollection.instance;
  }

}

PublicSettingsCachedCollection.instance = void 0;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"utils":{"applyCustomTranslations.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/applyCustomTranslations.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  applyCustomTranslations: () => applyCustomTranslations
});
let TAPi18n, TAPi18next;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  },

  TAPi18next(v) {
    TAPi18next = v;
  }

}, 0);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 1);

const applyCustomTranslations = () => {
  const customTranslations = settings.get('Custom_Translations');

  if (!customTranslations) {
    return;
  }

  try {
    const parsedCustomTranslations = JSON.parse(customTranslations);

    for (const [lang, translations] of Object.entries(parsedCustomTranslations)) {
      TAPi18next.addResourceBundle(lang, 'project', translations);
    }

    TAPi18n._language_changed_tracker.changed();
  } catch (e) {
    console.error('Invalid setting Custom_Translations', e);
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"call.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/call.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  call: () => call
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);

const call = function (method) {
  for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    params[_key - 1] = arguments[_key];
  }

  return new Promise((resolve, reject) => {
    Meteor.call(method, ...params, (error, result) => {
      if (error) {
        reject(error);
        return;
      }

      resolve(result);
    });
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"callWithErrorHandling.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/callWithErrorHandling.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  callWithErrorHandling: () => callWithErrorHandling
});
let call;
module.link("./call", {
  call(v) {
    call = v;
  }

}, 0);
let handleError;
module.link("./handleError", {
  handleError(v) {
    handleError = v;
  }

}, 1);

const callWithErrorHandling = async function (method) {
  try {
    for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      params[_key - 1] = arguments[_key];
    }

    return await call(method, ...params);
  } catch (error) {
    handleError(error);
    throw error;
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"canDeleteMessage.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/canDeleteMessage.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  canDeleteMessage: () => canDeleteMessage
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 1);
let hasPermission;
module.link("../../../app/authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 2);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);

const canDeleteMessage = _ref => {
  let {
    rid,
    ts,
    uid
  } = _ref;
  const userId = Meteor.userId();
  const forceDelete = hasPermission('force-delete-message', rid);

  if (forceDelete) {
    return true;
  }

  const isDeleteAllowed = settings.get('Message_AllowDeleting');

  if (!isDeleteAllowed) {
    return false;
  }

  const allowed = hasPermission('delete-message', rid);
  const deleteOwn = allowed || uid === userId && hasPermission('delete-own-message');

  if (!allowed && !deleteOwn) {
    return false;
  }

  const blockDeleteInMinutes = settings.get('Message_AllowDeleting_BlockDeleteInMinutes');

  if (blockDeleteInMinutes && blockDeleteInMinutes !== 0) {
    if (!ts) {
      return false;
    }

    const msgTs = moment(ts);
    const now = moment();
    return now.diff(msgTs, 'minutes') < blockDeleteInMinutes;
  }

  return true;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createAnchor.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/createAnchor.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createAnchor: () => createAnchor
});

const createAnchor = function (id) {
  let target = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document.body;
  const div = document.createElement('div');
  div.id = id;
  target.appendChild(div);
  return div;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createToken.ts":[],"domEvents.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/domEvents.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  delegate: () => delegate,
  triggerClick: () => triggerClick
});

const delegate = _ref => {
  let {
    parent = document,
    eventName,
    elementSelector,
    listener
  } = _ref;

  const effectiveListener = function (e) {
    // loop parent nodes from the target to the delegation node
    for (let {
      target
    } = e; target && target instanceof Element && target !== this; target = target.parentNode) {
      if (target.matches(elementSelector)) {
        listener.call(target, e, target);
        break;
      }
    }
  };

  parent.addEventListener(eventName, effectiveListener, false);
  return () => {
    parent.removeEventListener(eventName, effectiveListener, false);
  };
};

const triggerClick = target => {
  const clickEvent = document.createEvent('HTMLEvents');
  clickEvent.initEvent('click', true, false);
  target === null || target === void 0 ? void 0 : target.dispatchEvent(clickEvent);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"filterLanguage.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/filterLanguage.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  filterLanguage: () => filterLanguage
});

const filterLanguage = language => {
  // Fix browsers having all-lowercase language settings eg. pt-br, en-us
  const regex = /([a-z]{2,3})-([a-z]{2,4})/;
  const matches = regex.exec(language);

  if (matches) {
    return "".concat(matches[1], "-").concat(matches[2].toUpperCase());
  }

  return language;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"fireGlobalEvent.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/fireGlobalEvent.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  fireGlobalEvent: () => fireGlobalEvent
});
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 0);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 1);

const fireGlobalEvent = (eventName, detail) => {
  window.dispatchEvent(new CustomEvent(eventName, {
    detail
  }));
  Tracker.autorun(computation => {
    const enabled = settings.get('Iframe_Integration_send_enable');

    if (enabled === undefined) {
      return;
    }

    computation.stop();

    if (enabled) {
      parent.postMessage({
        eventName,
        data: detail
      }, settings.get('Iframe_Integration_send_target_origin'));
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"formatBytes.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/formatBytes.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  formatBytes: () => formatBytes
});

const formatBytes = (bytes, decimals) => {
  if (bytes === 0) {
    return '0 Bytes';
  }

  const k = 1024;
  const dm = decimals || 0;
  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return "".concat(parseFloat((bytes / Math.pow(k, i)).toFixed(dm)), " ").concat(sizes[i]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"formatDate.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/formatDate.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  formatDate: () => formatDate
});
let mem;
module.link("mem", {
  default(v) {
    mem = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 2);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
const formatDate = mem(time => {
  const messageDateFormat = Tracker.nonreactive(() => settings.get('Message_DateFormat'));
  return moment(time).format(messageDateFormat);
}, {
  maxAge: 5000
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"formatDateAndTime.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/formatDateAndTime.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  formatDateAndTime: () => formatDateAndTime
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 2);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let getUserPreference;
module.link("../../../app/utils/lib/getUserPreference", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 4);

const formatDateAndTime = time => {
  const clockMode = Tracker.nonreactive(() => getUserPreference(Meteor.userId(), 'clockMode', false));
  const messageTimeAndDateFormat = Tracker.nonreactive(() => settings.get('Message_TimeAndDateFormat'));

  switch (clockMode) {
    case 1:
      return moment(time).format('MMMM D, Y h:mm A');

    case 2:
      return moment(time).format('MMMM D, Y H:mm');

    default:
      return moment(time).format(messageTimeAndDateFormat);
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"formatTime.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/formatTime.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  formatTime: () => formatTime
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 2);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let getUserPreference;
module.link("../../../app/utils/lib/getUserPreference", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 4);
const dayFormat = ['h:mm A', 'H:mm'];

const formatTime = time => {
  const clockMode = Tracker.nonreactive(() => getUserPreference(Meteor.userId(), 'clockMode', false));
  const messageTimeFormat = Tracker.nonreactive(() => settings.get('Message_TimeFormat'));
  const sameDay = dayFormat[clockMode - 1] || messageTimeFormat;

  switch (clockMode) {
    case 1:
    case 2:
      return moment(time).format(sameDay);

    default:
      return moment(time).format(messageTimeFormat);
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getAvatarAsPng.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/getAvatarAsPng.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getAvatarAsPng: () => getAvatarAsPng
});
let getUserAvatarURL;
module.link("../../../app/utils/lib/getUserAvatarURL", {
  getUserAvatarURL(v) {
    getUserAvatarURL = v;
  }

}, 0);

const getAvatarAsPng = (username, cb) => {
  const image = new Image();

  const onLoad = () => {
    const canvas = document.createElement('canvas');
    canvas.width = image.width;
    canvas.height = image.height;
    const context = canvas.getContext('2d');

    if (!context) {
      throw new Error('failed to get canvas context');
    }

    context.drawImage(image, 0, 0);

    try {
      return cb(canvas.toDataURL('image/png'));
    } catch (e) {
      return cb('');
    }
  };

  const onError = () => cb('');

  image.onload = onLoad;
  image.onerror = onError;
  image.src = getUserAvatarURL(username);
  return onError;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getConfig.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/getConfig.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getConfig: () => getConfig
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);

const getConfig = key => {
  const searchParams = new URLSearchParams(window.location.search);
  return searchParams.get(key) || Meteor._localStorage.getItem("rc-config-".concat(key));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getDateRange.ts":[
  "moment"
],"getUidDirectMessage.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/getUidDirectMessage.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getUidDirectMessage: () => getUidDirectMessage
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Rooms;
module.link("../../../app/models/client", {
  Rooms(v) {
    Rooms = v;
  }

}, 1);

const getUidDirectMessage = function (rid) {
  let userId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Meteor.userId();
  const room = Rooms.findOne({
    _id: rid
  }, {
    fields: {
      uids: 1
    }
  });

  if (!room || !room.uids || room.uids.length > 2) {
    return undefined;
  }

  return room.uids.filter(uid => uid !== userId)[0];
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getUserEmailVerified.ts":[],"goToRoomById.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/goToRoomById.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  goToRoomById: () => goToRoomById
});
let memoize;
module.link("@rocket.chat/memo", {
  memoize(v) {
    memoize = v;
  }

}, 0);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 1);
let ChatSubscription;
module.link("../../../app/models/client", {
  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 2);
let roomTypes;
module.link("../../../app/utils/client", {
  roomTypes(v) {
    roomTypes = v;
  }

}, 3);
let callWithErrorHandling;
module.link("./callWithErrorHandling", {
  callWithErrorHandling(v) {
    callWithErrorHandling = v;
  }

}, 4);
const getRoomById = memoize(rid => callWithErrorHandling('getRoomById', rid));

const goToRoomById = async rid => {
  if (!rid) {
    return;
  }

  const subscription = ChatSubscription.findOne({
    rid
  });

  if (subscription) {
    roomTypes.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);
    return;
  }

  const room = await getRoomById(rid);
  roomTypes.openRouteLink(room.t, _objectSpread({
    rid: room._id
  }, room), FlowRouter.current().queryParams);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"handleError.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/handleError.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  handleError: () => handleError
});
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 0);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 1);
let toastr;
module.link("toastr", {
  default(v) {
    toastr = v;
  }

}, 2);

const hasXHR = error => 'xhr' in error;

const hasDetails = error => 'details' in error && typeof error.details === 'object';

const hasToastrShowed = error => 'toastrShowed' in error && error.toastrShowed === true;

const hasError = error => 'error' in error && typeof error.error === 'string';

const hasMessage = error => 'error' in error && typeof error.message === 'string';

const hasErrorTitle = details => 'errorTitle' in details && typeof details === 'string';

const handleError = function (error) {
  let useToastr = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

  if (hasXHR(error) && error.xhr.responseJSON) {
    return handleError(error.xhr.responseJSON, useToastr);
  }

  const message = hasError(error) && error.error || hasMessage(error) && error.message || undefined;
  const details = hasDetails(error) ? error.details : {};

  if (useToastr) {
    if (hasToastrShowed(error)) {
      return;
    }

    return toastr.error(TAPi18n.__(message, Object.fromEntries(Object.entries(details).map(_ref => {
      let [key, value] = _ref;
      return [key, escapeHTML(TAPi18n.__(value))];
    }))), hasErrorTitle(details) ? TAPi18n.__(details.errorTitle) : undefined);
  }

  return escapeHTML(TAPi18n.__(message, Object.fromEntries(Object.entries(details).map(_ref2 => {
    let [key, value] = _ref2;
    return [key, TAPi18n.__(value)];
  }))));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"isIE11.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/isIE11.ts                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isIE11: () => isIE11
});

const isIE11 = (() => {
  const {
    userAgent
  } = window.navigator;
  const msieIdx = userAgent.indexOf('MSIE');

  if (msieIdx > 0) {
    return parseInt(userAgent.substring(msieIdx + 5, userAgent.indexOf('.', msieIdx))) === 11;
  } // If MSIE detection fails, check the Trident engine version


  if (navigator.userAgent.match(/Trident\/7\./)) {
    return true;
  }

  return false;
})();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"isIOsDevice.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/isIOsDevice.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isIOsDevice: () => isIOsDevice
});
const isIOsDevice = !!navigator.platform.match(/iPhone|iPod|iPad/);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"isLayoutEmbedded.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/isLayoutEmbedded.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isLayoutEmbedded: () => isLayoutEmbedded
});
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);

const isLayoutEmbedded = () => FlowRouter.getQueryParam('layout') === 'embedded';
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"isRTL.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/isRTL.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isRTL: () => isRTL
});
// http://stackoverflow.com/a/14824756
const ltrChars = "A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF\u2C00-\uFB1C\uFDFE-\uFE6F\uFEFD-\uFFFF";
const rtlChars = "\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC";
const rtlRegExp = new RegExp("^[^".concat(ltrChars, "]*[").concat(rtlChars, "]"));

const isRTL = text => rtlRegExp.test(text);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"keyCodes.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/keyCodes.ts                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  keyCodes: () => keyCodes
});
const keyCodes = {
  TAB: 9,
  CARRIAGE_RETURN: 10,
  NEW_LINE: 13,
  SHIFT: 16,
  CONTROL: 17,
  ALT: 18,
  PAUSE_BREAK: 19,
  CAPS_LOCK: 20,
  ESCAPE: 27,
  PAGE_DOWN: 33,
  PAGE_UP: 34,
  END: 35,
  HOME: 36,
  ARROW_LEFT: 37,
  ARROW_UP: 38,
  ARROW_RIGHT: 39,
  ARROW_DOWN: 40,
  INSERT: 45,
  SUPER: 91,
  MENU: 93,
  F1: 112,
  F2: 113,
  F3: 114,
  F4: 115,
  F5: 116,
  F6: 117,
  F7: 118,
  F8: 119,
  F9: 120,
  F10: 121,
  F11: 122,
  F12: 123,
  NUM_LOCK: 144,
  SCROLL_LOCK: 145
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"mapMessageFromApi.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties"
],"prependReplies.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/prependReplies.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  prependReplies: () => prependReplies
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Rooms, Users;
module.link("../../../app/models/client", {
  Rooms(v) {
    Rooms = v;
  },

  Users(v) {
    Users = v;
  }

}, 1);
let MessageAction;
module.link("../../../app/ui-utils/client/lib/MessageAction", {
  MessageAction(v) {
    MessageAction = v;
  }

}, 2);

const prependReplies = async function (msg) {
  let replies = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
  let mention = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  const {
    username
  } = Users.findOne({
    _id: Meteor.userId()
  }, {
    fields: {
      username: 1
    }
  });
  const chunks = await Promise.all(replies.map(async _ref => {
    let {
      _id,
      rid,
      u
    } = _ref;
    const permalink = await MessageAction.getPermaLink(_id);
    const room = Rooms.findOne(rid, {
      fields: {
        t: 1
      }
    });
    let chunk = "[ ](".concat(permalink, ")");

    if ((room === null || room === void 0 ? void 0 : room.t) === 'd' && u.username !== username && mention) {
      chunk += " @".concat(u.username);
    }

    return chunk;
  }));
  chunks.push(msg);
  return chunks.join(' ');
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"renderEmoji.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/renderEmoji.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  renderEmoji: () => renderEmoji
});
let emoji;
module.link("../../../app/emoji/lib/rocketchat", {
  emoji(v) {
    emoji = v;
  }

}, 0);
const emojiList = emoji.list;
const emojiPackages = emoji.packages;

const renderEmoji = emojiName => {
  var _emojiList$emojiName;

  const emojiPackageName = (_emojiList$emojiName = emojiList[emojiName]) === null || _emojiList$emojiName === void 0 ? void 0 : _emojiList$emojiName.emojiPackage;

  if (emojiPackageName) {
    const emojiPackage = emojiPackages[emojiPackageName];
    return emojiPackage.render(emojiName);
  }

  return undefined;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"renderMessageBody.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/renderMessageBody.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  renderMessageBody: () => renderMessageBody
});
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 0);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 1);

const renderMessageBody = message => {
  var _message$msg;

  message.html = (_message$msg = message.msg) !== null && _message$msg !== void 0 && _message$msg.trim() ? escapeHTML(message.msg.trim()) : '';
  const {
    tokens,
    html
  } = callbacks.run('renderMessage', message);
  return (Array.isArray(tokens) ? tokens.reverse() : []).reduce((html, _ref) => {
    let {
      token,
      text
    } = _ref;
    return html.replace(token, () => text);
  }, html !== null && html !== void 0 ? html : '');
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"renderMessageEmoji.ts":[
  "../../../app/emoji/client/emojiParser.js"
],"timeAgo.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/timeAgo.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  timeAgo: () => timeAgo
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 2);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let t;
module.link("../../../app/utils/client", {
  t(v) {
    t = v;
  }

}, 4);
let getUserPreference;
module.link("../../../app/utils/lib/getUserPreference", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 5);
const dayFormat = ['h:mm A', 'H:mm'];

const timeAgo = date => {
  const clockMode = Tracker.nonreactive(() => getUserPreference(Meteor.userId(), 'clockMode', false));
  const messageTimeFormat = Tracker.nonreactive(() => settings.get('Message_TimeFormat'));
  const sameDay = dayFormat[clockMode - 1] || messageTimeFormat;
  return moment(date).calendar(null, {
    lastDay: "[".concat(t('yesterday'), "]"),
    sameDay,
    lastWeek: 'dddd',

    sameElse(now) {
      const diff = Math.ceil(this.diff(now, 'years', true));
      return diff < 0 ? 'MMM D YYYY' : 'MMM D';
    }

  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"waitUntilFind.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/waitUntilFind.ts                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  waitUntilFind: () => waitUntilFind
});
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 0);

const waitUntilFind = fn => new Promise(resolve => {
  Tracker.autorun(c => {
    const result = fn();

    if (result === undefined) {
      return;
    }

    c.stop();
    resolve(result);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"RoomManager.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/RoomManager.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["resolve", "update"];

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 0);
module.export({
  RoomStore: () => RoomStore,
  RoomManager: () => RoomManager,
  useHandleRoom: () => useHandleRoom,
  useVisitedRooms: () => useVisitedRooms,
  useOpenedRoom: () => useOpenedRoom,
  useRoomStore: () => useRoomStore
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);
let useEffect, useMemo;
module.link("react", {
  useEffect(v) {
    useEffect = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 1);
let useSubscription;
module.link("use-subscription", {
  useSubscription(v) {
    useSubscription = v;
  }

}, 2);
let useUserId, useUserRoom, useUserSubscription;
module.link("../contexts/UserContext", {
  useUserId(v) {
    useUserId = v;
  },

  useUserRoom(v) {
    useUserRoom = v;
  },

  useUserSubscription(v) {
    useUserSubscription = v;
  }

}, 3);
let useAsyncState;
module.link("../hooks/useAsyncState", {
  useAsyncState(v) {
    useAsyncState = v;
  }

}, 4);
let getConfig;
module.link("./utils/getConfig", {
  getConfig(v) {
    getConfig = v;
  }

}, 5);
const debug = !!(getConfig('debug') || getConfig('debug-RoomStore'));

class RoomStore extends Emitter {
  constructor(rid) {
    super();
    this.rid = void 0;
    this.lastTime = void 0;
    this.scroll = void 0;
    this.lm = void 0;
    this.atBottom = true;
    this.rid = rid;
    debug && this.on('changed', () => console.log("RoomStore ".concat(this.rid, " changed"), this));
  }

  update(_ref) {
    let {
      scroll,
      lastTime,
      atBottom
    } = _ref;

    if (scroll !== undefined) {
      this.scroll = scroll;
    }

    if (lastTime !== undefined) {
      this.lastTime = lastTime;
    }

    if (atBottom !== undefined) {
      this.atBottom = atBottom;
    }

    if (scroll || lastTime) {
      this.emit('changed');
    }
  }

}

const debugRoomManager = !!(getConfig('debug') || getConfig('debug-RoomManager'));
const RoomManager = new class RoomManager extends Emitter {
  constructor() {
    super();
    this.rid = void 0;
    this.lastRid = void 0;
    this.rooms = new Map();
    debugRoomManager && this.on('opened', rid => {
      console.log('room opened ->', rid);
    });
    debugRoomManager && this.on('back', rid => {
      console.log('room moved to back ->', rid);
    });
    debugRoomManager && this.on('closed', rid => {
      console.log('room close ->', rid);
    });
  }

  get lastOpened() {
    return this.lastRid;
  }

  get opened() {
    return this.rid;
  }

  visitedRooms() {
    return [...this.rooms.keys()];
  }

  back(rid) {
    if (rid === this.rid) {
      this.lastRid = rid;
      this.rid = undefined;
      this.emit('back', rid);
      this.emit('changed', this.rid);
    }
  }

  close(rid) {
    if (!this.rooms.has(rid)) {
      this.rooms.delete(rid);
      this.emit('closed', rid);
    }

    this.emit('changed', this.rid);
  }

  open(rid) {
    if (rid === this.rid) {
      return;
    }

    this.back(rid);

    if (!this.rooms.has(rid)) {
      this.rooms.set(rid, new RoomStore(rid));
    }

    this.rid = rid;
    this.emit('opened', this.rid);
    this.emit('changed', this.rid);
  }

  getStore(rid) {
    return this.rooms.get(rid);
  }

}();
const subscribeVisitedRooms = {
  getCurrentValue: () => RoomManager.visitedRooms(),

  subscribe(callback) {
    return RoomManager.on('changed', callback);
  }

};
const subscribeOpenedRoom = {
  getCurrentValue: () => RoomManager.opened,

  subscribe(callback) {
    return RoomManager.on('opened', callback);
  }

};
const fields = {};

const useHandleRoom = rid => {
  const _useAsyncState = useAsyncState(),
        {
    resolve,
    update
  } = _useAsyncState,
        state = _objectWithoutProperties(_useAsyncState, _excluded);

  const uid = useUserId();
  const subscription = useUserSubscription(rid, fields);

  const _room = useUserRoom(rid, fields);

  const room = uid ? subscription || _room : _room;
  useEffect(() => {
    if (room) {
      update();
      resolve(room);
    }
  }, [resolve, update, room]);
  return state;
};

const useVisitedRooms = () => useSubscription(subscribeVisitedRooms);

const useOpenedRoom = () => useSubscription(subscribeOpenedRoom);

const useRoomStore = rid => {
  const subscribeStore = useMemo(() => ({
    getCurrentValue: () => RoomManager.getStore(rid),

    subscribe(callback) {
      return RoomManager.on('changed', callback);
    }

  }), [rid]);
  const store = useSubscription(subscribeStore);

  if (!store) {
    throw new Error('Something wrong');
  }

  return store;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"appLayout.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/appLayout.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  appLayout: () => appLayout
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);
let createElement, lazy;
module.link("react", {
  createElement(v) {
    createElement = v;
  },

  lazy(v) {
    lazy = v;
  }

}, 1);
const MainLayout = /*#__PURE__*/lazy(() => module.dynamicImport('../views/root/MainLayout'));

class AppLayoutSubscription extends Emitter {
  constructor() {
    super(...arguments);
    this.descriptor = null;

    this.getCurrentValue = () => this.descriptor;

    this.subscribe = callback => this.on('update', callback);
  }

  setCurrentValue(descriptor) {
    this.descriptor = descriptor;
    this.emit('update');
  }

  renderMainLayout() {
    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    this.setCurrentValue( /*#__PURE__*/createElement(MainLayout, props));
  }

  render(element) {
    this.setCurrentValue(element);
  }

}

const appLayout = new AppLayoutSubscription();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"banners.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/banners.ts                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isLegacyPayload: () => isLegacyPayload,
  firstSubscription: () => firstSubscription,
  open: () => open,
  closeById: () => closeById,
  close: () => close,
  clear: () => clear
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);

const isLegacyPayload = payload => !('blocks' in payload);

const queue = [];
const emitter = new Emitter();
const firstSubscription = {
  getCurrentValue: () => {
    var _queue$;

    return (_queue$ = queue[0]) !== null && _queue$ !== void 0 ? _queue$ : null;
  },
  subscribe: callback => emitter.on('update-first', callback)
};

const open = payload => {
  let index = queue.findIndex(_payload => {
    if (isLegacyPayload(_payload)) {
      return _payload.id === payload.id;
    }

    return _payload.viewId === payload.viewId;
  });

  if (index === -1) {
    index = queue.length;
  }

  queue[index] = payload;
  emitter.emit('update');

  if (index === 0) {
    emitter.emit('update-first');
  }
};

const closeById = id => {
  const index = queue.findIndex(banner => {
    if (!isLegacyPayload(banner)) {
      return banner.viewId === id;
    }

    return banner.id === id;
  });

  if (index < 0) {
    return;
  }

  queue.splice(index, 1);
  emitter.emit('update');
  index === 0 && emitter.emit('update-first');
};

const close = () => {
  queue.shift();
  emitter.emit('update');
  emitter.emit('update-first');
};

const clear = () => {
  queue.splice(0, queue.length);
  emitter.emit('update');
  emitter.emit('update-first');
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"baseURI.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/baseURI.ts                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  baseURI: () => baseURI
});

const baseURI = (() => {
  if (document.baseURI) {
    return document.baseURI;
  } // Should be exactly one tag:
  //   https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base


  const base = document.getElementsByTagName('base'); // Return location from BASE tag.

  if (base.length > 0) {
    return base[0].href;
  } // Else use implementation of documentURI:
  //   http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-baseURI


  return document.URL;
})();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"clickableItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage-tokens/colors",
  "react"
],"createRouteGroup.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/createRouteGroup.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["lazyRouteComponent", "props", "ready"];

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
module.export({
  createRouteGroup: () => createRouteGroup
});
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let createElement, lazy;
module.link("react", {
  createElement(v) {
    createElement = v;
  },

  lazy(v) {
    lazy = v;
  }

}, 3);
let appLayout;
module.link("./appLayout", {
  appLayout(v) {
    appLayout = v;
  }

}, 4);
let createTemplateForComponent;
module.link("./portals/createTemplateForComponent", {
  createTemplateForComponent(v) {
    createTemplateForComponent = v;
  }

}, 5);

const registerLazyComponentRoute = (routeGroup, importRouter, path, _ref) => {
  var _rest$triggersEnter, _rest$triggersExit;

  let {
    lazyRouteComponent,
    props,
    ready = true
  } = _ref,
      rest = _objectWithoutProperties(_ref, _excluded);

  const enabled = new ReactiveVar(ready ? true : undefined);
  let computation;

  const handleEnter = (_context, _redirect, stop) => {
    const _enabled = Tracker.nonreactive(() => enabled.get());

    if (_enabled === false) {
      stop();
      return;
    }

    computation = Tracker.autorun(() => {
      const _enabled = enabled.get();

      if (_enabled === false) {
        FlowRouter.go('/');
      }
    });
  };

  const handleExit = () => {
    var _computation;

    (_computation = computation) === null || _computation === void 0 ? void 0 : _computation.stop();
  };

  const RouteComponent = /*#__PURE__*/lazy(lazyRouteComponent);

  const renderRoute = () => /*#__PURE__*/createElement(RouteComponent, props);

  routeGroup.route(path, _objectSpread(_objectSpread({}, rest), {}, {
    triggersEnter: [handleEnter, ...((_rest$triggersEnter = rest.triggersEnter) !== null && _rest$triggersEnter !== void 0 ? _rest$triggersEnter : [])],
    triggersExit: [handleExit, ...((_rest$triggersExit = rest.triggersExit) !== null && _rest$triggersExit !== void 0 ? _rest$triggersExit : [])],

    action() {
      const center = createTemplateForComponent(Tracker.nonreactive(() => FlowRouter.getRouteName()), importRouter, {
        attachment: 'at-parent',
        props: () => ({
          renderRoute
        })
      });
      appLayout.renderMainLayout({
        center
      });
    }

  }));
  return [() => enabled.set(true), () => enabled.set(false)];
};

const createRouteGroup = (name, prefix, importRouter) => {
  const routeGroup = FlowRouter.group({
    name,
    prefix
  });

  function registerRoute(path, options) {
    if ('lazyRouteComponent' in options) {
      return registerLazyComponentRoute(routeGroup, importRouter, path, options);
    }

    routeGroup.route(path, options);
  }

  registerRoute('/', {
    name: "".concat(name, "-index"),

    action() {
      const center = createTemplateForComponent("".concat(name, "-index"), importRouter, {
        attachment: 'at-parent'
      });
      appLayout.renderMainLayout({
        center
      });
    }

  });
  return registerRoute;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createSidebarItems.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/createSidebarItems.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createSidebarItems: () => createSidebarItems
});

const createSidebarItems = function () {
  let initialItems = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  const items = initialItems;

  let updateCb = () => undefined;

  const itemsSubscription = {
    subscribe: cb => {
      updateCb = cb;
      return () => {
        updateCb = () => undefined;
      };
    },
    getCurrentValue: () => items
  };

  const registerSidebarItem = item => {
    items.push(item);
    updateCb();
  };

  const unregisterSidebarItem = i18nLabel => {
    const index = items.findIndex(item => item.i18nLabel === i18nLabel);
    delete items[index];
    updateCb();
  };

  return {
    registerSidebarItem,
    unregisterSidebarItem,
    itemsSubscription
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"download.ts":[
  "@babel/runtime/helpers/objectWithoutProperties"
],"getLocalePercentage.ts":[],"getUserDisplayName.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/getUserDisplayName.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getUserDisplayName: () => getUserDisplayName
});

const getUserDisplayName = (name, username, useRealName) => useRealName ? name || username : username;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"imperativeModal.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/imperativeModal.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  imperativeModal: () => imperativeModal
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);

class ImperativeModalEmmiter extends Emitter {
  constructor() {
    super(...arguments);

    this.open = descriptor => {
      // There are some TS shenanigans causing errors if this is not asserted
      // Since this method is for internal use only, it's ok to use this here
      // This will not affect prop types inference when using the method.
      this.update(descriptor);
    };

    this.close = () => {
      this.update(null);
    };
  }

  update(descriptor) {
    this.emit('update', descriptor);
  }

}

const imperativeModal = new ImperativeModalEmmiter();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"meteorCallWrapper.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/meteorCallWrapper.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
let DDPCommon;
module.link("meteor/ddp-common", {
  DDPCommon(v) {
    DDPCommon = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let APIClient;
module.link("../../app/utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 3);
const bypassMethods = ['setUserStatus', 'logout'];

function shouldBypass(_ref) {
  var _params$;

  let {
    method,
    params
  } = _ref;

  if (method === 'login' && (_params$ = params[0]) !== null && _params$ !== void 0 && _params$.resume) {
    return true;
  }

  if (method.startsWith('UserPresence:') || bypassMethods.includes(method)) {
    return true;
  }

  if (method.startsWith('stream-')) {
    return true;
  }

  return false;
}

function wrapMeteorDDPCalls() {
  const {
    _send
  } = Meteor.connection;

  Meteor.connection._send = function _DDPSendOverREST(message) {
    if (message.msg !== 'method' || shouldBypass(message)) {
      return _send.call(Meteor.connection, message);
    }

    const endpoint = Tracker.nonreactive(() => !Meteor.userId() ? 'method.callAnon' : 'method.call');
    const restParams = {
      message: DDPCommon.stringifyDDP(_objectSpread({}, message))
    };

    const processResult = _message => {
      Meteor.connection._livedata_data({
        msg: 'updated',
        methods: [message.id]
      });

      Meteor.connection.onMessage(_message);
    };

    APIClient.v1.post("".concat(endpoint, "/").concat(encodeURIComponent(message.method.replace(/\//g, ':'))), restParams).then(_ref2 => {
      let {
        message: _message
      } = _ref2;
      processResult(_message);

      if (message.method === 'login') {
        var _parsedMessage$result;

        const parsedMessage = DDPCommon.parseDDP(_message);

        if ((_parsedMessage$result = parsedMessage.result) !== null && _parsedMessage$result !== void 0 && _parsedMessage$result.token) {
          Meteor.loginWithToken(parsedMessage.result.token);
        }
      }
    }).catch(error => {
      console.error(error);
    });
  };
}

window.USE_REST_FOR_DDP_CALLS && wrapMeteorDDPCalls();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"onClientBeforeSendMessage.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/onClientBeforeSendMessage.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onClientBeforeSendMessage: () => onClientBeforeSendMessage
});
let createAsyncTransformChain;
module.link("../../lib/transforms", {
  createAsyncTransformChain(v) {
    createAsyncTransformChain = v;
  }

}, 0);
const onClientBeforeSendMessage = createAsyncTransformChain();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"onClientMessageReceived.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/onClientMessageReceived.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onClientMessageReceived: () => onClientMessageReceived
});
let createAsyncTransformChain;
module.link("../../lib/transforms", {
  createAsyncTransformChain(v) {
    createAsyncTransformChain = v;
  }

}, 0);
const onClientMessageReceived = createAsyncTransformChain();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"presence.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/presence.ts                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  STATUS_MAP: () => STATUS_MAP,
  Presence: () => Presence
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let APIClient;
module.link("../../app/utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 2);
let UserStatus;
module.link("../../definition/UserStatus", {
  UserStatus(v) {
    UserStatus = v;
  }

}, 3);
const STATUS_MAP = [UserStatus.OFFLINE, UserStatus.ONLINE, UserStatus.AWAY, UserStatus.BUSY];
const emitter = new Emitter();
const store = new Map();

const isUid = eventType => Boolean(eventType) && typeof eventType === 'string' && !['reset', 'restart', 'remove'].includes(eventType);

const uids = new Set();

const update = update => {
  if (update !== null && update !== void 0 && update._id) {
    store.set(update._id, update);
    uids.delete(update._id);
  }
};

const notify = presence => {
  if (presence._id) {
    update(presence);
    emitter.emit(presence._id, presence);
  }
};

const getPresence = (() => {
  let timer;
  const deletedUids = new Set();

  const fetch = function () {
    let delay = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 500;
    timer && clearTimeout(timer);
    timer = setTimeout(async () => {
      const currentUids = new Set(uids);
      uids.clear();
      const ids = Array.from(currentUids);
      const removed = Array.from(deletedUids);
      Meteor.subscribe('stream-user-presence', '', _objectSpread(_objectSpread({}, ids.length > 0 && {
        added: Array.from(currentUids)
      }), removed.length && {
        removed: Array.from(deletedUids)
      }));
      deletedUids.clear();

      if (ids.length === 0) {
        return;
      }

      try {
        const params = {
          ids: [...currentUids]
        };
        const {
          users
        } = await APIClient.v1.get('users.presence', params);
        users.forEach(user => {
          if (!store.has(user._id)) {
            notify(user);
          }

          currentUids.delete(user._id);
        });
        currentUids.forEach(uid => {
          notify({
            _id: uid,
            status: UserStatus.OFFLINE
          });
        });
        currentUids.clear();
      } catch (_unused) {
        fetch(delay + delay);
      } finally {
        currentUids.forEach(item => uids.add(item));
      }
    }, delay);
  };

  const get = uid => {
    uids.add(uid);
    fetch();
  };

  const stop = uid => {
    deletedUids.add(uid);
    fetch();
  };

  emitter.on('remove', uid => {
    if (emitter.has(uid)) {
      return;
    }

    store.delete(uid);
    stop(uid);
  });
  emitter.on('reset', () => {
    emitter.events().filter(isUid).forEach(uid => {
      emitter.emit(uid, undefined);
    });
    emitter.once('restart', () => {
      emitter.events().filter(isUid).forEach(get);
    });
  });
  return get;
})();

const listen = (uid, handler) => {
  if (!uid) {
    return;
  }

  emitter.on(uid, handler);
  const user = store.has(uid) && store.get(uid);

  if (user) {
    return;
  }

  getPresence(uid);
};

const stop = (uid, handler) => {
  setTimeout(() => {
    emitter.off(uid, handler);
    emitter.emit('remove', uid);
  }, 5000);
};

const reset = () => {
  store.clear();
  emitter.emit('reset');
};

const restart = () => {
  emitter.emit('restart');
};

const get = async uid => new Promise(resolve => {
  const user = store.has(uid) && store.get(uid);

  if (user) {
    return resolve(user);
  }

  const callback = args => {
    resolve(args);
    stop(uid, callback);
  };

  listen(uid, callback);
});

const Presence = {
  listen,
  stop,
  reset,
  restart,
  notify,
  store,
  get
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"queryClient.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/queryClient.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  queryClient: () => queryClient
});
let QueryClient;
module.link("react-query", {
  QueryClient(v) {
    QueryClient = v;
  }

}, 0);
const queryClient = new QueryClient();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"toast.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/toast.ts                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  dispatchToastMessage: () => dispatchToastMessage,
  subscribeToToastMessages: () => subscribeToToastMessages
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);
const emitter = new Emitter();

const dispatchToastMessage = payload => {
  // TODO: buffer it if there is no subscriber
  emitter.emit('notify', payload);
};

const subscribeToToastMessages = callback => emitter.on('notify', callback);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userData.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/userData.ts                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["type", "id"];

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
module.export({
  isSyncReady: () => isSyncReady,
  synchronizeUserData: () => synchronizeUserData,
  removeLocalUserData: () => removeLocalUserData
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let Users;
module.link("../../app/models/client", {
  Users(v) {
    Users = v;
  }

}, 2);
let Notifications;
module.link("../../app/notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 3);
let APIClient;
module.link("../../app/utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 4);
const isSyncReady = new ReactiveVar(false);

const updateUser = userData => {
  const user = Users.findOne({
    _id: userData._id
  });

  if (!user || !user._updatedAt || user._updatedAt.getTime() < userData._updatedAt.getTime()) {
    Meteor.users.upsert({
      _id: userData._id
    }, userData);
    return;
  } // delete data already on user's collection as those are newer


  Object.keys(user).forEach(key => {
    delete userData[key];
  });
  Meteor.users.update({
    _id: user._id
  }, {
    $set: userData
  });
};

let cancel;

const synchronizeUserData = async uid => {
  var _cancel;

  if (!uid) {
    return;
  } // Remove data from any other user that we may have retained


  Meteor.users.remove({
    _id: {
      $ne: uid
    }
  });
  (_cancel = cancel) === null || _cancel === void 0 ? void 0 : _cancel();
  cancel = await Notifications.onUser('userData', data => {
    switch (data.type) {
      case 'inserted':
        // eslint-disable-next-line @typescript-eslint/no-unused-vars
        const {
          type,
          id
        } = data,
              user = _objectWithoutProperties(data, _excluded);

        Meteor.users.insert(user);
        break;

      case 'updated':
        Meteor.users.upsert({
          _id: uid
        }, {
          $set: data.diff,
          $unset: data.unset
        });
        break;

      case 'removed':
        Meteor.users.remove({
          _id: uid
        });
        break;
    }
  });
  const userData = await APIClient.v1.get('me');

  if (userData) {
    updateUser(_objectSpread(_objectSpread({}, userData), {}, {
      createdAt: new Date(userData.createdAt),
      _updatedAt: new Date(userData._updatedAt)
    }));
  }

  isSyncReady.set(true);
  return userData;
};

const removeLocalUserData = () => Meteor.users.remove({});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"sidebar":{"header":{"actions":{"CreateRoom.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "react-dom",
  "../../../contexts/AuthorizationContext",
  "../hooks/useDropdownVisibility",
  "./CreateRoomList"
],"CreateRoomList.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/ui-utils/client",
  "../../../components/CreateDiscussion",
  "../../../components/Sidebar/ListItem",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ModalContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../views/teams/CreateTeamModal",
  "../CreateChannelWithData",
  "../CreateDirectMessage"
],"Directory.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/LayoutContext",
  "../../../contexts/RouterContext"
],"Home.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/LayoutContext",
  "../../../contexts/RouterContext",
  "../../../contexts/SettingsContext"
],"Login.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/SessionContext",
  "../../../contexts/TranslationContext"
],"Search.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "tinykeys",
  "../../search/SearchList"
],"Sort.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "react-dom",
  "../../../components/SortList",
  "../hooks/useDropdownVisibility"
]},"hooks":{"useDropdownVisibility.ts":[
  "@rocket.chat/fuselage-hooks",
  "react"
]},"CreateChannel.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../components/UserAutoCompleteMultiple",
  "../../contexts/ServerContext",
  "../../contexts/SettingsContext",
  "../../contexts/TranslationContext"
],"CreateChannelWithData.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../contexts/AuthorizationContext",
  "../../contexts/SettingsContext",
  "../../hooks/useEndpointActionExperimental",
  "../../hooks/useForm",
  "../../lib/utils/goToRoomById",
  "./CreateChannel"
],"CreateDirectMessage.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../components/UserAutoCompleteMultiple",
  "../../contexts/TranslationContext",
  "../../hooks/useEndpointActionExperimental",
  "../../lib/utils/goToRoomById"
],"EditStatusModal.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../components/UserStatus",
  "../../components/UserStatusMenu",
  "../../contexts/ServerContext",
  "../../contexts/SettingsContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext"
],"UserAvatarButton.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "react-dom",
  "../../components/UserStatus",
  "../../components/avatar/UserAvatar",
  "../../contexts/UserContext",
  "./UserDropdown",
  "./hooks/useDropdownVisibility"
],"UserDropdown.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/kadira:flow-router",
  "react",
  "../../../app/ui-utils/client",
  "../../../app/user-status/client",
  "../../../definition/UserStatus",
  "../../../lib/callbacks",
  "../../components/MarkdownText",
  "../../components/UserStatus",
  "../../components/avatar/UserAvatar",
  "../../contexts/AuthorizationContext",
  "../../contexts/LayoutContext",
  "../../contexts/RouterContext",
  "../../contexts/SettingsContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../../hooks/useReactiveValue",
  "../../hooks/useUserDisplayName",
  "../../lib/imperativeModal",
  "./EditStatusModal"
],"index.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../hooks/useSidebarPaletteColor",
  "./UserAvatarButton",
  "./actions/CreateRoom",
  "./actions/Directory",
  "./actions/Home",
  "./actions/Login",
  "./actions/Search",
  "./actions/Sort"
]},"Item":{"Condensed.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react"
],"Extended.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../hooks/useTimeAgo"
],"Medium.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react"
]},"RoomList":{"RoomList.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../contexts/SessionContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../hooks/useAvatarTemplate",
  "../hooks/usePreventDefault",
  "../hooks/useRoomList",
  "../hooks/useShortcutOpenMenu",
  "../hooks/useSidebarPaletteColor",
  "../hooks/useTemplateByViewMode",
  "./Row",
  "./ScrollerWithCustomProps"
],"Row.js":[
  "@rocket.chat/fuselage",
  "react",
  "../sections/Omnichannel",
  "./SideBarItemTemplateWithData"
],"ScrollerWithCustomProps.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../components/ScrollableContentWrapper"
],"SideBarItemTemplateWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../app/utils/client",
  "../../components/RoomIcon",
  "../../contexts/LayoutContext",
  "../RoomMenu",
  "./normalizeSidebarMessage"
],"index.ts":[
  "./RoomList"
],"normalizeSidebarMessage.js":[
  "@rocket.chat/string-helpers",
  "../../../app/markdown/lib/markdown"
]},"footer":{"SidebarFooter.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors.json",
  "react",
  "../../../app/settings/client"
],"index.ts":[
  "./SidebarFooter"
]},"hooks":{"useAvatarTemplate.js":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../components/avatar/RoomAvatar",
  "../../contexts/UserContext"
],"usePreventDefault.js":[
  "react"
],"useQueryOptions.js":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../contexts/SettingsContext",
  "../../contexts/UserContext"
],"useRoomList.ts":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../contexts/OmnichannelContext",
  "../../contexts/SettingsContext",
  "../../contexts/UserContext",
  "./useQueryOptions"
],"useShortcutOpenMenu.js":[
  "react",
  "tinykeys"
],"useSidebarPaletteColor.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../contexts/SettingsContext",
  "../../lib/utils/isIE11"
],"useTemplateByViewMode.js":[
  "react",
  "../../contexts/UserContext",
  "../Item/Condensed",
  "../Item/Extended",
  "../Item/Medium"
]},"search":{"Row.js":[
  "react",
  "../RoomList/SideBarItemTemplateWithData",
  "./UserItem"
],"ScrollerWithCustomProps.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../components/ScrollableContentWrapper"
],"SearchList.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteral",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/string-helpers",
  "meteor/meteor",
  "react",
  "react-virtuoso",
  "tinykeys",
  "../../contexts/SettingsContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../../hooks/useAsyncState",
  "../../hooks/useMethodData",
  "../hooks/useAvatarTemplate",
  "../hooks/useTemplateByViewMode",
  "./Row",
  "./ScrollerWithCustomProps"
],"UserItem.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../app/utils/client",
  "../../components/UserStatus"
]},"sections":{"Omnichannel.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../app/authorization/client",
  "../../contexts/LayoutContext",
  "../../contexts/OmnichannelContext",
  "../../contexts/RouterContext",
  "../../contexts/ServerContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext"
]},"RoomMenu.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../app/ui-utils/client/lib/RoomManager",
  "../../app/utils/client",
  "../components/GenericModal",
  "../contexts/AuthorizationContext",
  "../contexts/ModalContext",
  "../contexts/RouterContext",
  "../contexts/ServerContext",
  "../contexts/SettingsContext",
  "../contexts/ToastMessagesContext",
  "../contexts/TranslationContext",
  "../contexts/UserContext",
  "../hooks/useDontAskAgain",
  "../views/admin/apps/WarningModal"
]},"UIKit":{"hooks":{"useUIKitHandleAction.tsx":[
  "@rocket.chat/apps-engine/definition/uikit/UIKitIncomingInteractionContainer",
  "@rocket.chat/fuselage-hooks",
  "../../../app/ui-message/client/ActionManager"
],"useUIKitHandleClose.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "../../../app/ui-message/client/ActionManager",
  "../../contexts/ToastMessagesContext"
],"useUIKitStateManager.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../app/ui-message/client/ActionManager",
  "../../../definition/UIKit"
]}},"contexts":{"ServerContext":{"ServerContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/ServerContext/ServerContext.ts                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ServerContext: () => ServerContext,
  useServerInformation: () => useServerInformation,
  useAbsoluteUrl: () => useAbsoluteUrl,
  useMethod: () => useMethod,
  useEndpoint: () => useEndpoint,
  useUpload: () => useUpload,
  useStream: () => useStream
});
let createContext, useCallback, useContext, useMemo;
module.link("react", {
  createContext(v) {
    createContext = v;
  },

  useCallback(v) {
    useCallback = v;
  },

  useContext(v) {
    useContext = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 0);
const ServerContext = /*#__PURE__*/createContext({
  info: undefined,
  absoluteUrl: path => path,
  callEndpoint: () => {
    throw new Error('not implemented');
  },
  uploadToEndpoint: async () => undefined,
  getStream: () => () => () => undefined
});

const useServerInformation = () => {
  const {
    info
  } = useContext(ServerContext);

  if (!info) {
    throw new Error('useServerInformation: no info available');
  }

  return info;
};

const useAbsoluteUrl = () => useContext(ServerContext).absoluteUrl;

const useMethod = methodName => {
  const {
    callMethod
  } = useContext(ServerContext);
  return useCallback(function () {
    if (!callMethod) {
      throw new Error("cannot use useMethod(".concat(methodName, ") hook without a wrapping ServerContext"));
    }

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    return callMethod(methodName, ...args);
  }, [callMethod, methodName]);
};

const useEndpoint = (method, path) => {
  const {
    callEndpoint
  } = useContext(ServerContext);
  return useCallback(params => callEndpoint(method, path, params), [callEndpoint, path, method]);
};

const useUpload = endpoint => {
  const {
    uploadToEndpoint
  } = useContext(ServerContext);
  return useCallback((params, formData) => uploadToEndpoint(endpoint, params, formData), [endpoint, uploadToEndpoint]);
};

const useStream = (streamName, options) => {
  const {
    getStream
  } = useContext(ServerContext);
  return useMemo(() => getStream(streamName, options), [getStream, streamName, options]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/ServerContext/index.ts                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./ServerContext", {
  "*": "*"
}, 0);
module.link("./methods", {
  "*": "*"
}, 1);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"methods.ts":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/ServerContext/methods.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"AuthorizationContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/AuthorizationContext.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RoleStore: () => RoleStore,
  AuthorizationContext: () => AuthorizationContext,
  usePermission: () => usePermission,
  useAtLeastOnePermission: () => useAtLeastOnePermission,
  useAllPermissions: () => useAllPermissions,
  useRolesDescription: () => useRolesDescription,
  useRole: () => useRole
});
let Emitter;
module.link("@rocket.chat/emitter", {
  Emitter(v) {
    Emitter = v;
  }

}, 0);
let createContext, useContext, useMemo, useCallback;
module.link("react", {
  createContext(v) {
    createContext = v;
  },

  useContext(v) {
    useContext = v;
  },

  useMemo(v) {
    useMemo = v;
  },

  useCallback(v) {
    useCallback = v;
  }

}, 1);
let useSubscription;
module.link("use-subscription", {
  useSubscription(v) {
    useSubscription = v;
  }

}, 2);

class RoleStore extends Emitter {
  constructor() {
    super(...arguments);
    this.roles = {};
  }

}

const AuthorizationContext = /*#__PURE__*/createContext({
  queryPermission: () => ({
    getCurrentValue: () => false,
    subscribe: () => () => undefined
  }),
  queryAtLeastOnePermission: () => ({
    getCurrentValue: () => false,
    subscribe: () => () => undefined
  }),
  queryAllPermissions: () => ({
    getCurrentValue: () => false,
    subscribe: () => () => undefined
  }),
  queryRole: () => ({
    getCurrentValue: () => false,
    subscribe: () => () => undefined
  }),
  roleStore: new RoleStore()
});

const usePermission = (permission, scope) => {
  const {
    queryPermission
  } = useContext(AuthorizationContext);
  const subscription = useMemo(() => queryPermission(permission, scope), [queryPermission, permission, scope]);
  return useSubscription(subscription);
};

const useAtLeastOnePermission = (permissions, scope) => {
  const {
    queryAtLeastOnePermission
  } = useContext(AuthorizationContext);
  const subscription = useMemo(() => queryAtLeastOnePermission(permissions, scope), [queryAtLeastOnePermission, permissions, scope]);
  return useSubscription(subscription);
};

const useAllPermissions = (permissions, scope) => {
  const {
    queryAllPermissions
  } = useContext(AuthorizationContext);
  const subscription = useMemo(() => queryAllPermissions(permissions, scope), [queryAllPermissions, permissions, scope]);
  return useSubscription(subscription);
};

const useRolesDescription = () => {
  const {
    roleStore
  } = useContext(AuthorizationContext);
  const subscription = useMemo(() => ({
    getCurrentValue: () => roleStore.roles,
    subscribe: callback => {
      roleStore.on('change', callback);
      return () => {
        roleStore.off('change', callback);
      };
    }
  }), [roleStore]);
  const roles = useSubscription(subscription);
  return useCallback(values => values.map(role => roles[role] && roles[role].description || role), [roles]);
};

const useRole = role => {
  const {
    queryRole
  } = useContext(AuthorizationContext);
  const subscription = useMemo(() => queryRole(role), [queryRole, role]);
  return useSubscription(subscription);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"AvatarUrlContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/AvatarUrlContext.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AvatarUrlContext: () => AvatarUrlContext,
  useRoomAvatarPath: () => useRoomAvatarPath,
  useUserAvatarPath: () => useUserAvatarPath
});
let createContext, useContext;
module.link("react", {
  createContext(v) {
    createContext = v;
  },

  useContext(v) {
    useContext = v;
  }

}, 0);
const dummy = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQYV2Oora39DwAFaQJ3y3rKeAAAAABJRU5ErkJggg==';
const AvatarUrlContextValueDefault = {
  getUserPathAvatar: () => dummy,
  getRoomPathAvatar: () => dummy
};
const AvatarUrlContext = /*#__PURE__*/createContext(AvatarUrlContextValueDefault);

const useRoomAvatarPath = () => useContext(AvatarUrlContext).getRoomPathAvatar;

const useUserAvatarPath = () => useContext(AvatarUrlContext).getUserPathAvatar;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ConnectionStatusContext.ts":[
  "react"
],"CustomSoundContext.ts":[
  "react"
],"EditableSettingsContext.ts":[
  "react",
  "use-subscription"
],"LayoutContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/LayoutContext.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  LayoutContext: () => LayoutContext,
  useLayout: () => useLayout
});
let createContext, useContext;
module.link("react", {
  createContext(v) {
    createContext = v;
  },

  useContext(v) {
    useContext = v;
  }

}, 0);
const LayoutContext = /*#__PURE__*/createContext({
  isEmbedded: false,
  showTopNavbarEmbeddedLayout: false,
  isMobile: false,
  sidebar: {},
  size: {
    sidebar: '380px',
    contextualBar: '380px'
  },
  contextualBarPosition: 'relative',
  contextualBarExpanded: false
});

const useLayout = () => useContext(LayoutContext);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ModalContext.ts":[
  "react",
  "../../app/ui-utils/client"
],"OmnichannelContext.ts":[
  "react"
],"RouterContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/RouterContext.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RouterContext: () => RouterContext,
  useRoute: () => useRoute,
  useRoutePath: () => useRoutePath,
  useRouteUrl: () => useRouteUrl,
  useRouteParameter: () => useRouteParameter,
  useQueryStringParameter: () => useQueryStringParameter,
  useCurrentRoute: () => useCurrentRoute
});
let createContext, useContext, useMemo;
module.link("react", {
  createContext(v) {
    createContext = v;
  },

  useContext(v) {
    useContext = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 0);
let useSubscription;
module.link("use-subscription", {
  useSubscription(v) {
    useSubscription = v;
  }

}, 1);
const RouterContext = /*#__PURE__*/createContext({
  queryRoutePath: () => ({
    getCurrentValue: () => undefined,
    subscribe: () => () => undefined
  }),
  queryRouteUrl: () => ({
    getCurrentValue: () => undefined,
    subscribe: () => () => undefined
  }),
  pushRoute: () => undefined,
  replaceRoute: () => undefined,
  queryRouteParameter: () => ({
    getCurrentValue: () => undefined,
    subscribe: () => () => undefined
  }),
  queryQueryStringParameter: () => ({
    getCurrentValue: () => undefined,
    subscribe: () => () => undefined
  }),
  queryCurrentRoute: () => ({
    getCurrentValue: () => [undefined, {}, {}, undefined],
    subscribe: () => () => undefined
  })
});

const useRoute = name => {
  const {
    queryRoutePath,
    queryRouteUrl,
    pushRoute,
    replaceRoute
  } = useContext(RouterContext);
  return useMemo(() => ({
    getPath: (parameters, queryStringParameters) => queryRoutePath(name, parameters, queryStringParameters).getCurrentValue(),
    getUrl: (parameters, queryStringParameters) => queryRouteUrl(name, parameters, queryStringParameters).getCurrentValue(),
    push: (parameters, queryStringParameters) => pushRoute(name, parameters, queryStringParameters),
    replace: (parameters, queryStringParameters) => replaceRoute(name, parameters, queryStringParameters)
  }), [queryRoutePath, queryRouteUrl, name, pushRoute, replaceRoute]);
};

const useRoutePath = (name, parameters, queryStringParameters) => {
  const {
    queryRoutePath
  } = useContext(RouterContext);
  return useSubscription(useMemo(() => queryRoutePath(name, parameters, queryStringParameters), [queryRoutePath, name, parameters, queryStringParameters]));
};

const useRouteUrl = (name, parameters, queryStringParameters) => {
  const {
    queryRouteUrl
  } = useContext(RouterContext);
  return useSubscription(useMemo(() => queryRouteUrl(name, parameters, queryStringParameters), [queryRouteUrl, name, parameters, queryStringParameters]));
};

const useRouteParameter = name => {
  const {
    queryRouteParameter
  } = useContext(RouterContext);
  return useSubscription(useMemo(() => queryRouteParameter(name), [queryRouteParameter, name]));
};

const useQueryStringParameter = name => {
  const {
    queryQueryStringParameter
  } = useContext(RouterContext);
  return useSubscription(useMemo(() => queryQueryStringParameter(name), [queryQueryStringParameter, name]));
};

const useCurrentRoute = () => {
  const {
    queryCurrentRoute
  } = useContext(RouterContext);
  return useSubscription(useMemo(() => queryCurrentRoute(), [queryCurrentRoute]));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"SessionContext.ts":[
  "react",
  "use-subscription"
],"SettingsContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/SettingsContext.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  SettingsContext: () => SettingsContext,
  useIsPrivilegedSettingsContext: () => useIsPrivilegedSettingsContext,
  useIsSettingsContextLoading: () => useIsSettingsContextLoading,
  useSettingStructure: () => useSettingStructure,
  useSetting: () => useSetting,
  useSettings: () => useSettings,
  useSettingsDispatch: () => useSettingsDispatch,
  useSettingSetValue: () => useSettingSetValue
});
let createContext, useCallback, useContext, useMemo;
module.link("react", {
  createContext(v) {
    createContext = v;
  },

  useCallback(v) {
    useCallback = v;
  },

  useContext(v) {
    useContext = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 0);
let useSubscription;
module.link("use-subscription", {
  useSubscription(v) {
    useSubscription = v;
  }

}, 1);
const SettingsContext = /*#__PURE__*/createContext({
  hasPrivateAccess: false,
  isLoading: false,
  querySetting: () => ({
    getCurrentValue: () => undefined,
    subscribe: () => () => undefined
  }),
  querySettings: () => ({
    getCurrentValue: () => [],
    subscribe: () => () => undefined
  }),
  dispatch: async () => undefined
});

const useIsPrivilegedSettingsContext = () => useContext(SettingsContext).hasPrivateAccess;

const useIsSettingsContextLoading = () => useContext(SettingsContext).isLoading;

const useSettingStructure = _id => {
  const {
    querySetting
  } = useContext(SettingsContext);
  const subscription = useMemo(() => querySetting(_id), [querySetting, _id]);
  return useSubscription(subscription);
};

const useSetting = _id => {
  var _useSettingStructure;

  return (_useSettingStructure = useSettingStructure(_id)) === null || _useSettingStructure === void 0 ? void 0 : _useSettingStructure.value;
};

const useSettings = query => {
  const {
    querySettings
  } = useContext(SettingsContext);
  const subscription = useMemo(() => querySettings(query !== null && query !== void 0 ? query : {}), [querySettings, query]);
  return useSubscription(subscription);
};

const useSettingsDispatch = () => useContext(SettingsContext).dispatch;

const useSettingSetValue = _id => {
  const dispatch = useSettingsDispatch();
  return useCallback(value => dispatch([{
    _id,
    value
  }]), [dispatch, _id]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"SidebarContext.ts":[
  "react"
],"ToastMessagesContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/ToastMessagesContext.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ToastMessagesContext: () => ToastMessagesContext,
  useToastMessageDispatch: () => useToastMessageDispatch
});
let createContext, useContext;
module.link("react", {
  createContext(v) {
    createContext = v;
  },

  useContext(v) {
    useContext = v;
  }

}, 0);
const ToastMessagesContext = /*#__PURE__*/createContext({
  dispatch: () => undefined
});

const useToastMessageDispatch = () => useContext(ToastMessagesContext).dispatch;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TranslationContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/TranslationContext.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  TranslationContext: () => TranslationContext,
  useLanguages: () => useLanguages,
  useLanguage: () => useLanguage,
  useLoadLanguage: () => useLoadLanguage,
  useTranslation: () => useTranslation
});
let createContext, useContext;
module.link("react", {
  createContext(v) {
    createContext = v;
  },

  useContext(v) {
    useContext = v;
  }

}, 0);
const TranslationContext = /*#__PURE__*/createContext({
  languages: [{
    name: 'Default',
    en: 'Default',
    key: ''
  }],
  language: '',
  loadLanguage: async () => undefined,
  translate: Object.assign(key => key, {
    has: () => true
  })
});

const useLanguages = () => useContext(TranslationContext).languages;

const useLanguage = () => useContext(TranslationContext).language;

const useLoadLanguage = () => useContext(TranslationContext).loadLanguage;

const useTranslation = () => useContext(TranslationContext).translate;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/UserContext.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  UserContext: () => UserContext,
  useUserId: () => useUserId,
  useUser: () => useUser,
  useLoginWithPassword: () => useLoginWithPassword,
  useLogout: () => useLogout,
  useUserPreference: () => useUserPreference,
  useUserSubscription: () => useUserSubscription,
  useUserRoom: () => useUserRoom,
  useUserSubscriptions: () => useUserSubscriptions,
  useUserSubscriptionByName: () => useUserSubscriptionByName
});
let useMutableCallback;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback(v) {
    useMutableCallback = v;
  }

}, 0);
let createContext, useContext, useMemo;
module.link("react", {
  createContext(v) {
    createContext = v;
  },

  useContext(v) {
    useContext = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 1);
let useSubscription;
module.link("use-subscription", {
  useSubscription(v) {
    useSubscription = v;
  }

}, 2);
let useRoute;
module.link("./RouterContext", {
  useRoute(v) {
    useRoute = v;
  }

}, 3);
const UserContext = /*#__PURE__*/createContext({
  userId: null,
  user: null,
  loginWithPassword: async () => undefined,
  logout: () => Promise.resolve(),
  queryPreference: () => ({
    getCurrentValue: () => undefined,
    subscribe: () => () => undefined
  }),
  querySubscription: () => ({
    getCurrentValue: () => undefined,
    subscribe: () => () => undefined
  }),
  queryRoom: () => ({
    getCurrentValue: () => undefined,
    subscribe: () => () => undefined
  }),
  querySubscriptions: () => ({
    getCurrentValue: () => [],
    subscribe: () => () => undefined
  })
});

const useUserId = () => useContext(UserContext).userId;

const useUser = () => useContext(UserContext).user;

const useLoginWithPassword = () => useContext(UserContext).loginWithPassword;

const useLogout = () => {
  const router = useRoute('home');
  const {
    logout
  } = useContext(UserContext);
  const handleLogout = useMutableCallback(() => {
    logout();
    router.push({});
  });
  return handleLogout;
};

const useUserPreference = (key, defaultValue) => {
  const {
    queryPreference
  } = useContext(UserContext);
  const subscription = useMemo(() => queryPreference(key, defaultValue), [queryPreference, key, defaultValue]);
  return useSubscription(subscription);
};

const useUserSubscription = (rid, fields) => {
  const {
    querySubscription
  } = useContext(UserContext);
  const subscription = useMemo(() => querySubscription({
    rid
  }, fields), [querySubscription, rid, fields]);
  return useSubscription(subscription);
};

const useUserRoom = (rid, fields) => {
  const {
    queryRoom
  } = useContext(UserContext);
  const subscription = useMemo(() => queryRoom({
    _id: rid
  }, fields), [queryRoom, rid, fields]);
  return useSubscription(subscription);
};

const useUserSubscriptions = (query, options) => {
  const {
    querySubscriptions
  } = useContext(UserContext);
  const subscription = useMemo(() => querySubscriptions(query, options), [querySubscriptions, query, options]);
  return useSubscription(subscription);
};

const useUserSubscriptionByName = (name, fields, sort) => {
  const {
    querySubscription
  } = useContext(UserContext);
  const subscription = useMemo(() => querySubscription({
    name
  }, fields, sort), [querySubscription, name, fields, sort]);
  return useSubscription(subscription);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"hooks":{"lists":{"useRecordList.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react"
],"useScrollableMessageList.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../lib/utils/mapMessageFromApi",
  "./useScrollableRecordList"
],"useScrollableRecordList.ts":[
  "react",
  "../../lib/asyncState"
],"useStreamUpdatesForMessageList.ts":[
  "react",
  "../../contexts/ServerContext",
  "../../lib/minimongo"
]},"useAsyncState.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useAsyncState.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  useAsyncState: () => useAsyncState,
  AsyncStatePhase: () => AsyncStatePhase,
  AsyncState: () => AsyncState
});
let useSafely;
module.link("@rocket.chat/fuselage-hooks", {
  useSafely(v) {
    useSafely = v;
  }

}, 0);
let useCallback, useMemo, useState;
module.link("react", {
  useCallback(v) {
    useCallback = v;
  },

  useMemo(v) {
    useMemo = v;
  },

  useState(v) {
    useState = v;
  }

}, 1);
let AsyncStatePhase, AsyncState, asyncState;
module.link("../lib/asyncState", {
  AsyncStatePhase(v) {
    AsyncStatePhase = v;
  },

  AsyncState(v) {
    AsyncState = v;
  },

  asyncState(v) {
    asyncState = v;
  }

}, 2);

const useAsyncState = initialValue => {
  const [state, setState] = useSafely(useState(() => {
    if (typeof initialValue === 'undefined') {
      return asyncState.loading();
    }

    return asyncState.resolved(typeof initialValue === 'function' ? initialValue() : initialValue);
  }));
  const resolve = useCallback(value => {
    setState(state => {
      if (typeof value === 'function') {
        return asyncState.resolve(state, value(state.value));
      }

      return asyncState.resolve(state, value);
    });
  }, [setState]);
  const reject = useCallback(error => {
    setState(state => asyncState.reject(state, error));
  }, [setState]);
  const update = useCallback(() => {
    setState(state => asyncState.update(state));
  }, [setState]);
  const reset = useCallback(() => {
    setState(state => asyncState.reload(state));
  }, [setState]);
  return useMemo(() => _objectSpread(_objectSpread({}, state), {}, {
    resolve,
    reject,
    reset,
    update
  }), [state, resolve, reject, reset, update]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useClipboardWithToast.js":[
  "@rocket.chat/fuselage-hooks",
  "../contexts/ToastMessagesContext",
  "../contexts/TranslationContext"
],"useComponentDidUpdate.js":[
  "react"
],"useDontAskAgain.ts":[
  "../contexts/UserContext"
],"useEmbeddedLayout.js":[
  "../contexts/RouterContext"
],"useEndpointAction.ts":[
  "react",
  "../contexts/ServerContext",
  "../contexts/ToastMessagesContext"
],"useEndpointActionExperimental.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useEndpointActionExperimental.ts                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  useEndpointActionExperimental: () => useEndpointActionExperimental
});
let useCallback;
module.link("react", {
  useCallback(v) {
    useCallback = v;
  }

}, 0);
let useEndpoint;
module.link("../contexts/ServerContext", {
  useEndpoint(v) {
    useEndpoint = v;
  }

}, 1);
let useToastMessageDispatch;
module.link("../contexts/ToastMessagesContext", {
  useToastMessageDispatch(v) {
    useToastMessageDispatch = v;
  }

}, 2);

const useEndpointActionExperimental = (method, path, successMessage) => {
  const sendData = useEndpoint(method, path);
  const dispatchToastMessage = useToastMessageDispatch();
  return useCallback(async params => {
    try {
      const data = await sendData(params);

      if (successMessage) {
        dispatchToastMessage({
          type: 'success',
          message: successMessage
        });
      }

      return data;
    } catch (error) {
      dispatchToastMessage({
        type: 'error',
        message: error
      }); // return { success: false };

      throw error;
    }
  }, [dispatchToastMessage, sendData, successMessage]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useEndpointData.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useEndpointData.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["resolve", "reject", "reset"];

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
module.export({
  useEndpointData: () => useEndpointData
});
let useCallback, useEffect;
module.link("react", {
  useCallback(v) {
    useCallback = v;
  },

  useEffect(v) {
    useEffect = v;
  }

}, 0);
let useEndpoint;
module.link("../contexts/ServerContext", {
  useEndpoint(v) {
    useEndpoint = v;
  }

}, 1);
let useToastMessageDispatch;
module.link("../contexts/ToastMessagesContext", {
  useToastMessageDispatch(v) {
    useToastMessageDispatch = v;
  }

}, 2);
let useAsyncState;
module.link("./useAsyncState", {
  useAsyncState(v) {
    useAsyncState = v;
  }

}, 3);

const useEndpointData = function (endpoint) {
  let params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;
  let initialValue = arguments.length > 2 ? arguments[2] : undefined;

  const _useAsyncState = useAsyncState(initialValue),
        {
    resolve,
    reject,
    reset
  } = _useAsyncState,
        state = _objectWithoutProperties(_useAsyncState, _excluded);

  const dispatchToastMessage = useToastMessageDispatch();
  const getData = useEndpoint('GET', endpoint);
  const fetchData = useCallback(() => {
    reset();
    getData(params).then(resolve).catch(error => {
      console.error(error);
      dispatchToastMessage({
        type: 'error',
        message: error
      });
      reject(error);
    });
  }, [reset, getData, params, resolve, dispatchToastMessage, reject]);
  useEffect(() => {
    fetchData();
  }, [fetchData]);
  return _objectSpread(_objectSpread({}, state), {}, {
    reload: fetchData
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useEndpointUpload.js":[
  "react",
  "../contexts/ServerContext",
  "../contexts/ToastMessagesContext"
],"useFileInput.js":[
  "@rocket.chat/fuselage-hooks",
  "react"
],"useForm.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useForm.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  useForm: () => useForm
});
let capitalize;
module.link("@rocket.chat/string-helpers", {
  capitalize(v) {
    capitalize = v;
  }

}, 0);
let useCallback, useReducer, useMemo;
module.link("react", {
  useCallback(v) {
    useCallback = v;
  },

  useReducer(v) {
    useReducer = v;
  },

  useMemo(v) {
    useMemo = v;
  }

}, 1);

const reduceForm = (state, action) => action(state);

const initForm = initialValues => {
  const fields = [];

  for (const [fieldName, initialValue] of Object.entries(initialValues)) {
    fields.push({
      name: fieldName,
      currentValue: initialValue,
      initialValue,
      changed: false
    });
  }

  return {
    fields,
    values: _objectSpread({}, initialValues),
    hasUnsavedChanges: false
  };
};

const valueChanged = (fieldName, newValue) => state => {
  let {
    fields
  } = state;
  const field = fields.find(_ref => {
    let {
      name
    } = _ref;
    return name === fieldName;
  });

  if (!field || field.currentValue === newValue) {
    return state;
  }

  const newField = _objectSpread(_objectSpread({}, field), {}, {
    currentValue: newValue,
    changed: JSON.stringify(newValue) !== JSON.stringify(field.initialValue)
  });

  fields = state.fields.map(field => {
    if (field.name === fieldName) {
      return newField;
    }

    return field;
  });
  return _objectSpread(_objectSpread({}, state), {}, {
    fields,
    values: _objectSpread(_objectSpread({}, state.values), {}, {
      [newField.name]: newField.currentValue
    }),
    hasUnsavedChanges: newField.changed || fields.some(field => field.changed)
  });
};

const formCommitted = () => state => _objectSpread(_objectSpread({}, state), {}, {
  fields: state.fields.map(field => _objectSpread(_objectSpread({}, field), {}, {
    initialValue: field.currentValue,
    changed: false
  })),
  hasUnsavedChanges: false
});

const formReset = () => state => _objectSpread(_objectSpread({}, state), {}, {
  fields: state.fields.map(field => _objectSpread(_objectSpread({}, field), {}, {
    currentValue: field.initialValue,
    changed: false
  })),
  values: state.fields.reduce((values, field) => _objectSpread(_objectSpread({}, values), {}, {
    [field.name]: field.initialValue
  }), {}),
  hasUnsavedChanges: false
});

const isChangeEvent = x => (typeof x === 'object' || typeof x === 'function') && typeof (x === null || x === void 0 ? void 0 : x.currentTarget) !== 'undefined';

const getValue = eventOrValue => {
  if (!isChangeEvent(eventOrValue)) {
    return eventOrValue;
  }

  const target = eventOrValue.currentTarget;

  if (target instanceof HTMLTextAreaElement) {
    return target.value;
  }

  if (target instanceof HTMLSelectElement) {
    return target.value;
  }

  if (!(target instanceof HTMLInputElement)) {
    return undefined;
  }

  if (target.type === 'checkbox' || target.type === 'radio') {
    return target.checked;
  }

  return target.value;
};
/**
 * @deprecated prefer react-hook-form's `useForm`
 */


const useForm = function (initialValues) {
  let onChange = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => undefined;
  const [state, dispatch] = useReducer(reduceForm, initialValues, initForm);
  const commit = useCallback(() => {
    dispatch(formCommitted());
  }, []);
  const reset = useCallback(() => {
    dispatch(formReset());
  }, []);
  const handlers = useMemo(() => state.fields.reduce((handlers, _ref2) => {
    let {
      name,
      initialValue
    } = _ref2;
    return _objectSpread(_objectSpread({}, handlers), {}, {
      ["handle".concat(capitalize(name))]: eventOrValue => {
        const newValue = getValue(eventOrValue);
        dispatch(valueChanged(name, newValue));
        onChange({
          initialValue,
          value: newValue,
          key: name,
          values: state.values
        });
      }
    });
  }, {}), [onChange, state.fields, state.values]);
  return {
    handlers,
    values: state.values,
    hasUnsavedChanges: state.hasUnsavedChanges,
    commit,
    reset
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useFormatDate.js":[
  "moment",
  "react",
  "../contexts/SettingsContext"
],"useFormatDateAndTime.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useFormatDateAndTime.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  useFormatDateAndTime: () => useFormatDateAndTime
});
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 0);
let useCallback;
module.link("react", {
  useCallback(v) {
    useCallback = v;
  }

}, 1);
let useSetting;
module.link("../contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 2);
let useUserPreference;
module.link("../contexts/UserContext", {
  useUserPreference(v) {
    useUserPreference = v;
  }

}, 3);

const useFormatDateAndTime = () => {
  const clockMode = useUserPreference('clockMode', false);
  const format = useSetting('Message_TimeAndDateFormat');
  return useCallback(time => {
    switch (clockMode) {
      case 1:
        return moment(time).format('MMMM D, Y h:mm A');

      case 2:
        return moment(time).format('MMMM D, Y H:mm');

      default:
        return moment(time).format(format);
    }
  }, [clockMode, format]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useFormatDuration.js":[
  "react",
  "../contexts/TranslationContext"
],"useFormatMemorySize.js":[
  "underscore.string"
],"useFormatTime.ts":[
  "moment",
  "react",
  "../contexts/SettingsContext",
  "../contexts/UserContext"
],"useFormattedRelativeTime.ts":[
  "moment",
  "react"
],"useHighlightedCode.js":[
  "highlight.js",
  "react"
],"useLocalePercentage.ts":[
  "../contexts/TranslationContext",
  "../lib/getLocalePercentage"
],"useMethodData.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useMethodData.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
const _excluded = ["resolve", "reject", "reset"];

let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);

let _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default(v) {
    _objectWithoutProperties = v;
  }

}, 1);
module.export({
  useMethodData: () => useMethodData
});
let useCallback, useEffect;
module.link("react", {
  useCallback(v) {
    useCallback = v;
  },

  useEffect(v) {
    useEffect = v;
  }

}, 0);
let useMethod;
module.link("../contexts/ServerContext", {
  useMethod(v) {
    useMethod = v;
  }

}, 1);
let useToastMessageDispatch;
module.link("../contexts/ToastMessagesContext", {
  useToastMessageDispatch(v) {
    useToastMessageDispatch = v;
  }

}, 2);
let useAsyncState;
module.link("./useAsyncState", {
  useAsyncState(v) {
    useAsyncState = v;
  }

}, 3);
const defaultArgs = [];

const useMethodData = function (methodName) {
  let args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultArgs;
  let initialValue = arguments.length > 2 ? arguments[2] : undefined;

  const _useAsyncState = useAsyncState(initialValue),
        {
    resolve,
    reject,
    reset
  } = _useAsyncState,
        state = _objectWithoutProperties(_useAsyncState, _excluded);

  const dispatchToastMessage = useToastMessageDispatch();
  const getData = useMethod(methodName);
  const fetchData = useCallback(() => {
    reset();
    getData(...args).then(resolve).catch(error => {
      console.error(error);
      dispatchToastMessage({
        type: 'error',
        message: error
      });
      reject(error);
    });
  }, [reset, getData, args, resolve, dispatchToastMessage, reject]);
  useEffect(() => {
    fetchData();
  }, [fetchData]);
  return _objectSpread(_objectSpread({}, state), {}, {
    reload: fetchData
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"usePolledMethodData.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "./useMethodData"
],"usePresence.ts":[
  "react",
  "use-subscription",
  "../lib/presence"
],"usePreventProgation.ts":[
  "@rocket.chat/fuselage-hooks"
],"useReactiveValue.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useReactiveValue.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  useReactiveValue: () => useReactiveValue
});
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 0);
let useMemo;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  }

}, 1);
let useSubscription;
module.link("use-subscription", {
  useSubscription(v) {
    useSubscription = v;
  }

}, 2);

const useReactiveValue = computeCurrentValue => {
  const subscription = useMemo(() => {
    const callbacks = new Set();
    let currentValue;
    const computation = Tracker.autorun(() => {
      currentValue = computeCurrentValue();
      callbacks.forEach(callback => {
        callback();
      });
    });
    return {
      getCurrentValue: () => currentValue,
      subscribe: callback => {
        callbacks.add(callback);
        return () => {
          callbacks.delete(callback);

          if (callbacks.size === 0) {
            computation.stop();
          }
        };
      }
    };
  }, [computeCurrentValue]);
  return useSubscription(subscription);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useReactiveVar.ts":[
  "meteor/tracker",
  "react"
],"useResizeInlineBreakpoint.js":[
  "@rocket.chat/fuselage-hooks",
  "react"
],"useRoomIcon.tsx":[
  "react",
  "../../definition/IRoom",
  "../components/UserStatus"
],"useTimeAgo.js":[
  "moment",
  "react"
],"useTimeFromNow.ts":[
  "moment",
  "react"
],"useTimezoneNameList.js":[
  "moment-timezone",
  "react"
],"useTimezoneTime.ts":[
  "moment",
  "react",
  "./useFormatTime"
],"useUTCClock.ts":[
  "./useTimezoneTime"
],"useUpdateAvatar.js":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../contexts/ServerContext",
  "../contexts/ToastMessagesContext",
  "../contexts/TranslationContext",
  "./useEndpointAction",
  "./useEndpointUpload"
],"useUserDisplayName.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useUserDisplayName.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  useUserDisplayName: () => useUserDisplayName
});
let useSetting;
module.link("../contexts/SettingsContext", {
  useSetting(v) {
    useSetting = v;
  }

}, 0);
let getUserDisplayName;
module.link("../lib/getUserDisplayName", {
  getUserDisplayName(v) {
    getUserDisplayName = v;
  }

}, 1);

const useUserDisplayName = _ref => {
  let {
    name,
    username
  } = _ref;
  const useRealName = useSetting('UI_Use_Real_Name');
  return getUserDisplayName(name, username, !!useRealName);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"startup":{"afterLogoutCleanUp":{"customScriptOnLogout.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/afterLogoutCleanUp/customScriptOnLogout.ts                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 1);
let fireGlobalEvent;
module.link("../../lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 2);
Meteor.startup(() => {
  callbacks.add('afterLogoutCleanUp', () => fireGlobalEvent('Custom_Script_On_Logout'), callbacks.priority.LOW, 'custom-script-on-logout');
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/afterLogoutCleanUp/index.ts                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./customScriptOnLogout");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"contextualBar":{"exportMessages.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/contextualBar/exportMessages.ts                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let useMemo, lazy;
module.link("react", {
  useMemo(v) {
    useMemo = v;
  },

  lazy(v) {
    lazy = v;
  }

}, 0);
let usePermission;
module.link("../../contexts/AuthorizationContext", {
  usePermission(v) {
    usePermission = v;
  }

}, 1);
let addAction;
module.link("../../views/room/lib/Toolbox", {
  addAction(v) {
    addAction = v;
  }

}, 2);
addAction('export-messages', _ref => {
  let {
    room
  } = _ref;
  const hasPermission = usePermission('mail-messages', room._id);
  return useMemo(() => hasPermission ? {
    groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
    id: 'export-messages',
    anonymous: true,
    title: 'Export_Messages',
    icon: 'mail',
    template: /*#__PURE__*/lazy(() => module.dynamicImport('../../views/room/contextualBar/ExportMessages')),
    full: true,
    order: 12
  } : null, [hasPermission]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/contextualBar/index.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./exportMessages");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"notifications":{"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/notifications/index.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./konchatNotifications");
module.link("./updateAvatar");
module.link("./usersNameChanged");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"konchatNotifications.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/notifications/konchatNotifications.ts                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let CachedChatSubscription;
module.link("../../../app/models/client", {
  CachedChatSubscription(v) {
    CachedChatSubscription = v;
  }

}, 4);
let Notifications;
module.link("../../../app/notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 5);
let readMessage;
module.link("../../../app/ui-utils/client", {
  readMessage(v) {
    readMessage = v;
  }

}, 6);
let KonchatNotification;
module.link("../../../app/ui/client", {
  KonchatNotification(v) {
    KonchatNotification = v;
  }

}, 7);
let getUserPreference;
module.link("../../../app/utils/client", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 8);
let fireGlobalEvent;
module.link("../../lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 9);
let isLayoutEmbedded;
module.link("../../lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded(v) {
    isLayoutEmbedded = v;
  }

}, 10);

const notifyNewRoom = sub => {
  if (Session.equals("user_".concat(Meteor.userId(), "_status"), 'busy')) {
    return;
  }

  if ((!FlowRouter.getParam('name') || FlowRouter.getParam('name') !== sub.name) && !sub.ls && sub.alert === true) {
    KonchatNotification.newRoom(sub.rid);
  }
};

function notifyNewMessageAudio(rid) {
  const openedRoomId = Session.get('openedRoom'); // This logic is duplicated in /client/startup/unread.coffee.

  const hasFocus = readMessage.isEnable();
  const messageIsInOpenedRoom = openedRoomId === rid;
  const muteFocusedConversations = getUserPreference(Meteor.userId(), 'muteFocusedConversations');

  if (isLayoutEmbedded()) {
    if (!hasFocus && messageIsInOpenedRoom) {
      // Play a notification sound
      KonchatNotification.newMessage(rid);
    }
  } else if (!hasFocus || !messageIsInOpenedRoom || !muteFocusedConversations) {
    // Play a notification sound
    KonchatNotification.newMessage(rid);
  }
}

Meteor.startup(() => {
  Tracker.autorun(() => {
    if (!Meteor.userId()) {
      return;
    }

    Notifications.onUser('notification', notification => {
      let openedRoomId = undefined;

      if (['channel', 'group', 'direct'].includes(FlowRouter.getRouteName())) {
        openedRoomId = Session.get('openedRoom');
      } // This logic is duplicated in /client/startup/unread.coffee.


      const hasFocus = readMessage.isEnable();
      const messageIsInOpenedRoom = openedRoomId === notification.payload.rid;
      fireGlobalEvent('notification', {
        notification,
        fromOpenedRoom: messageIsInOpenedRoom,
        hasFocus
      });

      if (isLayoutEmbedded()) {
        if (!hasFocus && messageIsInOpenedRoom) {
          // Show a notification.
          KonchatNotification.showDesktop(notification);
        }
      } else if (!hasFocus || !messageIsInOpenedRoom) {
        // Show a notification.
        KonchatNotification.showDesktop(notification);
      }

      notifyNewMessageAudio(notification.payload.rid);
    });

    CachedChatSubscription.onSyncData = (action, sub) => {
      if (action !== 'removed') {
        notifyNewRoom(sub);
      }
    };

    Notifications.onUser('subscriptions-changed', (_action, sub) => {
      notifyNewRoom(sub);
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"updateAvatar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/notifications/updateAvatar.ts                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Notifications;
module.link("../../../app/notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 1);
Meteor.startup(() => {
  Notifications.onLogged('updateAvatar', data => {
    const {
      username,
      etag
    } = data;
    username && Meteor.users.update({
      username
    }, {
      $set: {
        avatarETag: etag
      }
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"usersNameChanged.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/notifications/usersNameChanged.ts                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Messages, RoomRoles, Subscriptions;
module.link("../../../app/models/client", {
  Messages(v) {
    Messages = v;
  },

  RoomRoles(v) {
    RoomRoles = v;
  },

  Subscriptions(v) {
    Subscriptions = v;
  }

}, 1);
let Notifications;
module.link("../../../app/notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 2);
Meteor.startup(() => {
  Notifications.onLogged('Users:NameChanged', _ref => {
    let {
      _id,
      name,
      username
    } = _ref;
    Messages.update({
      'u._id': _id
    }, {
      $set: {
        'u.username': username,
        'u.name': name
      }
    }, {
      multi: true
    });
    Messages.update({
      mentions: {
        $elemMatch: {
          _id
        }
      }
    }, {
      $set: {
        'mentions.$.username': username,
        'mentions.$.name': name
      }
    }, {
      multi: true
    });
    Subscriptions.update({
      name: username,
      t: 'd'
    }, {
      $set: {
        fname: name
      }
    });
    RoomRoles.update({
      'u._id': _id
    }, {
      $set: {
        'u.name': name
      }
    }, {
      multi: true
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"renderMessage":{"autolinker.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/autolinker.ts                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 2);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const isEnabled = settings.get('AutoLinker') === true;

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'autolinker');
      return;
    }

    const options = {
      stripPrefix: settings.get('AutoLinker_StripPrefix'),
      urls: {
        schemeMatches: settings.get('AutoLinker_Urls_Scheme'),
        wwwMatches: settings.get('AutoLinker_Urls_www'),
        tldMatches: settings.get('AutoLinker_Urls_TLD')
      },
      email: settings.get('AutoLinker_Email'),
      phone: settings.get('AutoLinker_Phone')
    };
    module.dynamicImport('../../../app/autolinker/client').then(_ref => {
      let {
        createAutolinkerMessageRenderer
      } = _ref;
      const renderMessage = createAutolinkerMessageRenderer(options);
      callbacks.remove('renderMessage', 'autolinker');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.MEDIUM, 'autolinker');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"autotranslate.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/autotranslate.ts                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let hasPermission;
module.link("../../../app/authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 2);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 4);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const isEnabled = settings.get('AutoTranslate_Enabled') && hasPermission('auto-translate');

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'autotranslate');
      return;
    }

    module.dynamicImport('../../../app/autotranslate/client').then(_ref => {
      let {
        createAutoTranslateMessageRenderer
      } = _ref;
      const renderMessage = createAutoTranslateMessageRenderer();
      callbacks.remove('renderMessage', 'autotranslate');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.HIGH - 3, 'autotranslate');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emoji.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/emoji.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let getUserPreference;
module.link("../../../app/utils/client", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 2);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const isEnabled = getUserPreference(Meteor.userId(), 'useEmojis');

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'emoji');
      return;
    }

    module.dynamicImport('../../../app/emoji/client').then(_ref => {
      let {
        createEmojiMessageRenderer
      } = _ref;
      const renderMessage = createEmojiMessageRenderer();
      callbacks.remove('renderMessage', 'emoji');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.LOW, 'emoji');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hexcolor.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/hexcolor.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 2);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const isEnabled = settings.get('HexColorPreview_Enabled') === true;

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'hexcolor');
      return;
    }

    module.dynamicImport('../../../app/colors/client').then(_ref => {
      let {
        createHexColorPreviewMessageRenderer
      } = _ref;
      const renderMessage = createHexColorPreviewMessageRenderer();
      callbacks.remove('renderMessage', 'hexcolor');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.MEDIUM, 'hexcolor');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"highlightWords.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/highlightWords.ts                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let getUserPreference;
module.link("../../../app/utils/client", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 2);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);
Meteor.startup(() => {
  Tracker.autorun(() => {
    var _highlights$some;

    const highlights = getUserPreference(Meteor.userId(), 'highlights');
    const isEnabled = (_highlights$some = highlights === null || highlights === void 0 ? void 0 : highlights.some(highlight => highlight === null || highlight === void 0 ? void 0 : highlight.trim())) !== null && _highlights$some !== void 0 ? _highlights$some : false;

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'highlight-words');
      return;
    }

    const options = {
      wordsToHighlight: highlights === null || highlights === void 0 ? void 0 : highlights.filter(highlight => highlight === null || highlight === void 0 ? void 0 : highlight.trim())
    };
    module.dynamicImport('../../../app/highlight-words').then(_ref => {
      let {
        createHighlightWordsMessageRenderer
      } = _ref;
      const renderMessage = createHighlightWordsMessageRenderer(options);
      callbacks.remove('renderMessage', 'highlight-words');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.MEDIUM + 1, 'highlight-words');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/index.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./autolinker");
module.link("./autotranslate");
module.link("./emoji");
module.link("./hexcolor");
module.link("./highlightWords");
module.link("./issuelink");
module.link("./katex");
module.link("./markdown");
module.link("./mentionsMessage");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"issuelink.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/issuelink.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 2);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const isEnabled = settings.get('IssueLinks_Enabled');

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'issuelink');
      return;
    }

    const options = {
      template: settings.get('IssueLinks_Template')
    };
    module.dynamicImport('../../../app/issuelinks/client').then(_ref => {
      let {
        createIssueLinksMessageRenderer
      } = _ref;
      const renderMessage = createIssueLinksMessageRenderer(options);
      callbacks.remove('renderMessage', 'issuelink');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.MEDIUM, 'issuelink');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"katex.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/katex.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 2);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const isEnabled = settings.get('Katex_Enabled');

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'katex');
      return;
    }

    const options = {
      dollarSyntax: settings.get('Katex_Dollar_Syntax'),
      parenthesisSyntax: settings.get('Katex_Parenthesis_Syntax')
    };
    module.dynamicImport('../../../app/katex/client').then(_ref => {
      let {
        createKatexMessageRendering
      } = _ref;
      const renderMessage = createKatexMessageRendering(options);
      callbacks.remove('renderMessage', 'katex');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.HIGH + 1, 'katex');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"markdown.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/markdown.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 2);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 3);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const options = {
      parser: settings.get('Markdown_Parser'),
      supportSchemesForLink: settings.get('Markdown_SupportSchemesForLink'),
      headers: settings.get('Markdown_Headers'),
      rootUrl: Meteor.absoluteUrl(),
      marked: {
        gfm: settings.get('Markdown_Marked_GFM'),
        tables: settings.get('Markdown_Marked_Tables'),
        breaks: settings.get('Markdown_Marked_Breaks'),
        pedantic: settings.get('Markdown_Marked_Pedantic'),
        smartLists: settings.get('Markdown_Marked_SmartLists'),
        smartypants: settings.get('Markdown_Marked_Smartypants')
      }
    };
    module.dynamicImport('../../../app/markdown/client').then(_ref => {
      let {
        createMarkdownMessageRenderer
      } = _ref;
      const renderMessage = createMarkdownMessageRenderer(options);
      callbacks.remove('renderMessage', 'markdown');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.HIGH, 'markdown');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"mentionsMessage.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/mentionsMessage.ts                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let Users;
module.link("../../../app/models/client", {
  Users(v) {
    Users = v;
  }

}, 2);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 4);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const uid = Meteor.userId();
    const options = {
      me: uid && (Users.findOne(uid, {
        fields: {
          username: 1
        }
      }) || {}).username,
      pattern: settings.get('UTF8_User_Names_Validation'),
      useRealName: settings.get('UI_Use_Real_Name')
    };
    module.dynamicImport('../../../app/mentions/client').then(_ref => {
      let {
        createMentionsMessageRenderer
      } = _ref;
      const renderMessage = createMentionsMessageRenderer(options);
      callbacks.remove('renderMessage', 'mentions-message');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.MEDIUM, 'mentions-message');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"renderNotification":{"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderNotification/index.ts                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./markdown");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"markdown.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderNotification/markdown.ts                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 1);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 2);
Meteor.startup(() => {
  const options = {
    supportSchemesForLink: settings.get('Markdown_SupportSchemesForLink')
  };
  module.dynamicImport('../../../app/markdown/client').then(_ref => {
    let {
      createMarkdownNotificationRenderer
    } = _ref;
    const renderNotification = createMarkdownNotificationRenderer(options);
    callbacks.remove('renderNotification', 'filter-markdown');
    callbacks.add('renderNotification', renderNotification, callbacks.priority.HIGH, 'filter-markdown');
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"streamMessage":{"autotranslate.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/streamMessage/autotranslate.ts                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let hasPermission;
module.link("../../../app/authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 2);
let settings;
module.link("../../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
let callbacks;
module.link("../../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 4);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const isEnabled = settings.get('AutoTranslate_Enabled') && hasPermission('auto-translate');

    if (!isEnabled) {
      callbacks.remove('streamMessage', 'autotranslate-stream');
      return;
    }

    module.dynamicImport('../../../app/autotranslate/client').then(_ref => {
      let {
        createAutoTranslateMessageStreamHandler
      } = _ref;
      const streamMessage = createAutoTranslateMessageStreamHandler();
      callbacks.remove('streamMessage', 'autotranslate-stream');
      callbacks.add('streamMessage', streamMessage, callbacks.priority.HIGH - 3, 'autotranslate-stream');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/streamMessage/index.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./autotranslate");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"UserDeleted.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/UserDeleted.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ChatMessage;
module.link("../../app/models/client", {
  ChatMessage(v) {
    ChatMessage = v;
  }

}, 1);
let Notifications;
module.link("../../app/notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 2);
Meteor.startup(() => {
  Notifications.onLogged('Users:Deleted', _ref => {
    let {
      userId
    } = _ref;
    ChatMessage.remove({
      'u._id': userId
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"absoluteUrl.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/absoluteUrl.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let baseURI;
module.link("../lib/baseURI", {
  baseURI(v) {
    baseURI = v;
  }

}, 1);
Meteor.absoluteUrl.defaultOptions.rootUrl = baseURI;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"appRoot.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/appRoot.tsx                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let React;
module.link("react", {
  default(v) {
    React = v;
  }

}, 1);
let render;
module.link("react-dom", {
  render(v) {
    render = v;
  }

}, 2);
let AppRoot;
module.link("../views/root/AppRoot", {
  default(v) {
    AppRoot = v;
  }

}, 3);

const createContainer = () => {
  const container = document.getElementById('react-root');

  if (!container) {
    throw new Error('could not find the element #react-root on DOM tree');
  }

  document.body.insertBefore(container, document.body.firstChild);
  return container;
};

Meteor.startup(() => {
  const container = createContainer();
  render( /*#__PURE__*/React.createElement(AppRoot, null), container);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"banners.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/banners.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let Notifications;
module.link("../../app/notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 2);
let APIClient;
module.link("../../app/utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 3);
let BannerPlatform;
module.link("../../definition/IBanner", {
  BannerPlatform(v) {
    BannerPlatform = v;
  }

}, 4);
let banners;
module.link("../lib/banners", {
  "*"(v) {
    banners = v;
  }

}, 5);

const fetchInitialBanners = async () => {
  const response = await APIClient.get('v1/banners', {
    platform: BannerPlatform.Web
  });

  for (const banner of response.banners) {
    banners.open(_objectSpread(_objectSpread({}, banner.view), {}, {
      viewId: banner.view.viewId || banner._id
    }));
  }
};

const handleBanner = async event => {
  const response = await APIClient.get("v1/banners/".concat(event.bannerId), {
    platform: BannerPlatform.Web
  });

  if (!response.banners.length) {
    return banners.closeById(event.bannerId);
  }

  for (const banner of response.banners) {
    banners.open(_objectSpread(_objectSpread({}, banner.view), {}, {
      viewId: banner.view.viewId || banner._id
    }));
  }
};

const watchBanners = () => {
  fetchInitialBanners();
  Notifications.onLogged('banner-changed', handleBanner);
  return () => {
    Notifications.unLogged(handleBanner);
    banners.clear();
  };
};

Meteor.startup(() => {
  let unwatchBanners;
  Tracker.autorun(() => {
    var _unwatchBanners;

    (_unwatchBanners = unwatchBanners) === null || _unwatchBanners === void 0 ? void 0 : _unwatchBanners();

    if (!Meteor.userId()) {
      return;
    }

    unwatchBanners = Tracker.nonreactive(watchBanners);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"callbacks.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/callbacks.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let performance;
module.link("universal-perf-hooks", {
  performance(v) {
    performance = v;
  }

}, 0);
let callbacks;
module.link("../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 1);
let getConfig;
module.link("../lib/utils/getConfig", {
  getConfig(v) {
    getConfig = v;
  }

}, 2);

if ([getConfig('debug'), getConfig('timed-callbacks')].includes('true')) {
  callbacks.setMetricsTrackers({
    trackCallback: _ref => {
      let {
        hook,
        id,
        stack
      } = _ref;
      const start = performance.now();
      return () => {
        var _stack$split, _stack$split$, _stack$split$$match;

        const end = performance.now();
        console.log(String(end - start), hook, id, stack === null || stack === void 0 ? void 0 : (_stack$split = stack.split('\n')) === null || _stack$split === void 0 ? void 0 : (_stack$split$ = _stack$split[2]) === null || _stack$split$ === void 0 ? void 0 : (_stack$split$$match = _stack$split$.match(/\(.+\)/)) === null || _stack$split$$match === void 0 ? void 0 : _stack$split$$match[0]);
      };
    },
    trackHook: _ref2 => {
      let {
        hook
      } = _ref2;
      const start = performance.now();
      return () => {
        const end = performance.now();
        console.log("".concat(hook, ":"), end - start);
      };
    }
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"customOAuth.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/customOAuth.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration(v) {
    ServiceConfiguration = v;
  }

}, 1);
let CustomOAuth;
module.link("../../app/custom-oauth/client/custom_oauth_client", {
  CustomOAuth(v) {
    CustomOAuth = v;
  }

}, 2);
let isOauthCustomConfiguration;
module.link("../../definition/rest/v1/settings", {
  isOauthCustomConfiguration(v) {
    isOauthCustomConfiguration = v;
  }

}, 3);
Meteor.startup(() => {
  ServiceConfiguration.configurations.find({
    custom: true
  }).observe({
    added(record) {
      if (!isOauthCustomConfiguration(record)) {
        return;
      }

      new CustomOAuth(record.service, {
        serverURL: record.serverURL,
        authorizePath: record.authorizePath,
        scope: record.scope
      });
    }

  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"customTranslations.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/customTranslations.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 1);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let applyCustomTranslations;
module.link("../lib/utils/applyCustomTranslations", {
  applyCustomTranslations(v) {
    applyCustomTranslations = v;
  }

}, 4);
Meteor.startup(() => {
  Tracker.autorun(() => {
    // Re apply translations if tap language was changed
    Session.get(TAPi18n._loaded_lang_session_key);
    applyCustomTranslations();
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"e2e.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/e2e.ts                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let e2e;
module.link("../../app/e2e/client/rocketchat.e2e", {
  e2e(v) {
    e2e = v;
  }

}, 3);
let Subscriptions, Rooms;
module.link("../../app/models/client", {
  Subscriptions(v) {
    Subscriptions = v;
  },

  Rooms(v) {
    Rooms = v;
  }

}, 4);
let Notifications;
module.link("../../app/notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 5);
let settings;
module.link("../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 6);
let onClientBeforeSendMessage;
module.link("../lib/onClientBeforeSendMessage", {
  onClientBeforeSendMessage(v) {
    onClientBeforeSendMessage = v;
  }

}, 7);
let onClientMessageReceived;
module.link("../lib/onClientMessageReceived", {
  onClientMessageReceived(v) {
    onClientMessageReceived = v;
  }

}, 8);
let isLayoutEmbedded;
module.link("../lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded(v) {
    isLayoutEmbedded = v;
  }

}, 9);
let waitUntilFind;
module.link("../lib/utils/waitUntilFind", {
  waitUntilFind(v) {
    waitUntilFind = v;
  }

}, 10);

const handle = async (roomId, keyId) => {
  const e2eRoom = await e2e.getInstanceByRoomId(roomId);

  if (!e2eRoom) {
    return;
  }

  e2eRoom.provideKeyToUser(keyId);
};

Meteor.startup(() => {
  Tracker.autorun(() => {
    if (!Meteor.userId()) {
      return;
    }

    const adminEmbedded = isLayoutEmbedded() && FlowRouter.current().path.startsWith('/admin');

    if (!adminEmbedded && settings.get('E2E_Enable') && window.crypto) {
      e2e.startClient();
      e2e.enabled.set(true);
    } else {
      e2e.enabled.set(false);
      e2e.closeAlert();
    }
  });
  let observable = null;
  let offClientMessageReceived;
  let offClientBeforeSendMessage;
  Tracker.autorun(() => {
    if (!e2e.isReady()) {
      var _offClientMessageRece, _observable, _offClientBeforeSendM;

      (_offClientMessageRece = offClientMessageReceived) === null || _offClientMessageRece === void 0 ? void 0 : _offClientMessageRece();
      Notifications.unUser('e2ekeyRequest', handle);
      (_observable = observable) === null || _observable === void 0 ? void 0 : _observable.stop();
      (_offClientBeforeSendM = offClientBeforeSendMessage) === null || _offClientBeforeSendM === void 0 ? void 0 : _offClientBeforeSendM();
      return;
    }

    Notifications.onUser('e2ekeyRequest', handle);
    observable = Subscriptions.find().observe({
      changed: async doc => {
        if (!doc.encrypted && !doc.E2EKey) {
          e2e.removeInstanceByRoomId(doc.rid);
          return;
        }

        const e2eRoom = await e2e.getInstanceByRoomId(doc.rid);

        if (!e2eRoom) {
          return;
        }

        doc.encrypted ? e2eRoom.resume() : e2eRoom.pause(); // Cover private groups and direct messages

        if (!e2eRoom.isSupportedRoomType(doc.t)) {
          e2eRoom.disable();
          return;
        }

        if (doc.E2EKey && e2eRoom.isWaitingKeys()) {
          e2eRoom.keyReceived();
          return;
        }

        if (!e2eRoom.isReady()) {
          return;
        }

        e2eRoom.decryptSubscription();
      },
      added: async doc => {
        if (!doc.encrypted && !doc.E2EKey) {
          return;
        }

        return e2e.getInstanceByRoomId(doc.rid);
      },
      removed: doc => {
        e2e.removeInstanceByRoomId(doc.rid);
      }
    });
    offClientMessageReceived = onClientMessageReceived.use(async msg => {
      const e2eRoom = await e2e.getInstanceByRoomId(msg.rid);

      if (!e2eRoom || !e2eRoom.shouldConvertReceivedMessages()) {
        return msg;
      }

      return e2e.decryptMessage(msg);
    }); // Encrypt messages before sending

    offClientBeforeSendMessage = onClientBeforeSendMessage.use(async message => {
      const e2eRoom = await e2e.getInstanceByRoomId(message.rid);

      if (!e2eRoom) {
        return message;
      }

      const subscription = await waitUntilFind(() => Rooms.findOne({
        _id: message.rid
      }));
      subscription.encrypted ? e2eRoom.resume() : e2eRoom.pause();

      if (!(await e2eRoom.shouldConvertSentMessages())) {
        return message;
      } // Should encrypt this message.


      const msg = await e2eRoom.encrypt(message);
      message.msg = msg;
      message.t = 'e2e';
      message.e2e = 'pending';
      return message;
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emailVerification.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/emailVerification.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 1);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let settings;
module.link("../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 4);
let dispatchToastMessage;
module.link("../lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 5);
Meteor.startup(() => {
  Tracker.autorun(() => {
    var _user$emails;

    const user = Meteor.user();

    if (user !== null && user !== void 0 && (_user$emails = user.emails) !== null && _user$emails !== void 0 && _user$emails[0] && user.emails[0].verified !== true && settings.get('Accounts_EmailVerification') === true && !Session.get('Accounts_EmailVerification_Warning')) {
      dispatchToastMessage({
        type: 'warning',
        message: TAPi18n.__('You_have_not_verified_your_email')
      });
      Session.set('Accounts_EmailVerification_Warning', true);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"i18n.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/i18n.ts                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar(v) {
    ReactiveVar = v;
  }

}, 1);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 2);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 3);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 4);
let Users;
module.link("../../app/models/client", {
  Users(v) {
    Users = v;
  }

}, 5);
let settings;
module.link("../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 6);
let isRtl;
module.link("../../app/utils/client", {
  isRtl(v) {
    isRtl = v;
  }

}, 7);
let filterLanguage;
module.link("../lib/utils/filterLanguage", {
  filterLanguage(v) {
    filterLanguage = v;
  }

}, 8);
const currentLanguage = new ReactiveVar(null);
Meteor.startup(() => {
  // eslint-disable-next-line @typescript-eslint/camelcase
  TAPi18n.conf.i18n_files_route = Meteor._relativeToSiteRootUrl('/tap-i18n');
  currentLanguage.set(Meteor._localStorage.getItem('userLanguage'));
  const availableLanguages = TAPi18n.getLanguages();

  const getBrowserLanguage = () => {
    var _window$navigator$use;

    return filterLanguage((_window$navigator$use = window.navigator.userLanguage) !== null && _window$navigator$use !== void 0 ? _window$navigator$use : window.navigator.language);
  };

  const loadMomentLocale = language => new Promise((resolve, reject) => {
    if (moment.locales().includes(language.toLowerCase())) {
      resolve(language);
      return;
    }

    Meteor.call('loadLocale', language, (error, localeSrc) => {
      if (error) {
        reject(error);
        return;
      }

      Function(localeSrc).call({
        moment
      });
      resolve(language);
    });
  });

  const applyLanguage = function () {
    let language = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'en';
    language = filterLanguage(language);

    if (!availableLanguages[language]) {
      language = language.split('-').shift();
    }

    if (!language) {
      return;
    }

    document.documentElement.classList[isRtl(language) ? 'add' : 'remove']('rtl');
    document.documentElement.setAttribute('dir', isRtl(language) ? 'rtl' : 'ltr');
    document.documentElement.lang = language;
    TAPi18n.setLanguage(language);
    loadMomentLocale(language).then(locale => moment.locale(locale)).catch(error => {
      moment.locale('en');
      console.error('Error loading moment locale:', error);
    });
  };

  const setLanguage = language => {
    const lang = filterLanguage(language);
    currentLanguage.set(lang);

    Meteor._localStorage.setItem('userLanguage', lang);
  };

  window.setLanguage = setLanguage;

  const defaultUserLanguage = () => settings.get('Language') || getBrowserLanguage() || 'en';

  window.defaultUserLanguage = defaultUserLanguage;
  Tracker.autorun(() => {
    const user = Users.findOne(Meteor.userId(), {
      fields: {
        language: 1
      }
    });
    setLanguage((user === null || user === void 0 ? void 0 : user.language) || defaultUserLanguage());
  });
  Tracker.autorun(() => {
    const language = currentLanguage.get();

    if (language) {
      applyLanguage(language);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/index.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./absoluteUrl");
module.link("./afterLogoutCleanUp");
module.link("./appRoot");
module.link("./banners");
module.link("./callbacks");
module.link("./contextualBar");
module.link("./customOAuth");
module.link("./customTranslations");
module.link("./e2e");
module.link("./emailVerification");
module.link("./i18n");
module.link("./ldap");
module.link("./loginViaQuery");
module.link("./messageTypes");
module.link("./notifications");
module.link("./oauth");
module.link("./readReceipt");
module.link("./renderMessage");
module.link("./renderNotification");
module.link("./roomObserve");
module.link("./rootUrlChange");
module.link("./routes");
module.link("./setupWizard");
module.link("./slashCommands");
module.link("./startup");
module.link("./streamMessage");
module.link("./theme");
module.link("./unread");
module.link("./UserDeleted");
module.link("./userRoles");
module.link("./userSetUtcOffset");
module.link("./usersObserve");
module.link("./userStatusManuallySet");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ldap.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/ldap.ts                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);

Meteor.loginWithLDAP = function (username, password, callback) {
  Accounts.callLoginMethod({
    methodArguments: [{
      ldap: true,
      username,
      ldapPass: password,
      ldapOptions: {}
    }],
    userCallback: callback
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"loginViaQuery.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/loginViaQuery.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
Meteor.startup(() => {
  Tracker.afterFlush(() => {
    const resumeToken = FlowRouter.getQueryParam('resumeToken');

    if (!resumeToken) {
      return;
    }

    Meteor.loginWithToken(resumeToken, () => {
      if (FlowRouter.getRouteName()) {
        FlowRouter.setQueryParams({
          resumeToken: null,
          userId: null
        });
        return;
      }

      FlowRouter.go('/home');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageTypes.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/messageTypes.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML(v) {
    escapeHTML = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let MessageTypes;
module.link("../../app/ui-utils/client", {
  MessageTypes(v) {
    MessageTypes = v;
  }

}, 2);
let t;
module.link("../../app/utils/client", {
  t(v) {
    t = v;
  }

}, 3);
Meteor.startup(() => {
  MessageTypes.registerType({
    id: 'room_changed_privacy',
    system: true,
    message: 'room_changed_privacy',

    data(message) {
      return {
        // eslint-disable-next-line @typescript-eslint/camelcase
        user_by: message.u && message.u.username,
        // eslint-disable-next-line @typescript-eslint/camelcase
        room_type: t(message.msg)
      };
    }

  });
  MessageTypes.registerType({
    id: 'room_changed_topic',
    system: true,
    message: 'room_changed_topic',

    data(message) {
      return {
        // eslint-disable-next-line @typescript-eslint/camelcase
        user_by: message.u && message.u.username,
        // eslint-disable-next-line @typescript-eslint/camelcase
        room_topic: escapeHTML(message.msg || "(".concat(t('None').toLowerCase(), ")"))
      };
    }

  });
  MessageTypes.registerType({
    id: 'room_changed_avatar',
    system: true,
    message: 'room_changed_avatar',

    data(message) {
      return {
        // eslint-disable-next-line @typescript-eslint/camelcase
        user_by: message.u && message.u.username
      };
    }

  });
  MessageTypes.registerType({
    id: 'room_changed_announcement',
    system: true,
    message: 'room_changed_announcement',

    data(message) {
      return {
        // eslint-disable-next-line @typescript-eslint/camelcase
        user_by: message.u && message.u.username,
        // eslint-disable-next-line @typescript-eslint/camelcase
        room_announcement: escapeHTML(message.msg || "(".concat(t('None').toLowerCase(), ")"))
      };
    }

  });
  MessageTypes.registerType({
    id: 'room_changed_description',
    system: true,
    message: 'room_changed_description',

    data(message) {
      return {
        // eslint-disable-next-line @typescript-eslint/camelcase
        user_by: message.u && message.u.username,
        // eslint-disable-next-line @typescript-eslint/camelcase
        room_description: escapeHTML(message.msg || "(".concat(t('None').toLowerCase(), ")"))
      };
    }

  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oauth.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/oauth.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let OAuth;
module.link("meteor/oauth", {
  OAuth(v) {
    OAuth = v;
  }

}, 1);
// OAuth._retrieveCredentialSecret is a meteor method modified to also check the global localStorage
// This was necessary because of the "Forget User Session on Window Close" setting.
// The setting changes Meteor._localStorage to use the browser's session storage instead, but that doesn't happen on the Oauth's popup code.
Meteor.startup(() => {
  const meteorOAuthRetrieveCredentialSecret = OAuth._retrieveCredentialSecret;

  OAuth._retrieveCredentialSecret = credentialToken => {
    let secret = meteorOAuthRetrieveCredentialSecret.call(OAuth, credentialToken);

    if (!secret) {
      const localStorageKey = "".concat(OAuth._storageTokenPrefix).concat(credentialToken);
      secret = localStorage.getItem(localStorageKey);
      localStorage.removeItem(localStorageKey);
    }

    return secret;
  };
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"readReceipt.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/readReceipt.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let settings;
module.link("../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 2);
let MessageAction, messageArgs;
module.link("../../app/ui-utils/client", {
  MessageAction(v) {
    MessageAction = v;
  },

  messageArgs(v) {
    messageArgs = v;
  }

}, 3);
let imperativeModal;
module.link("../lib/imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 4);
let ReadReceiptsModal;
module.link("../views/room/modals/ReadReceiptsModal", {
  default(v) {
    ReadReceiptsModal = v;
  }

}, 5);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const enabled = settings.get('Message_Read_Receipt_Store_Users');

    if (!enabled) {
      return MessageAction.removeButton('receipt-detail');
    }

    MessageAction.addButton({
      id: 'receipt-detail',
      icon: 'info-circled',
      label: 'Info',
      context: ['starred', 'message', 'message-mobile', 'threads'],

      action() {
        const {
          msg: message
        } = messageArgs(this);
        imperativeModal.open({
          component: ReadReceiptsModal,
          props: {
            messageId: message._id,
            onClose: imperativeModal.close
          }
        });
      },

      order: 10,
      group: 'menu'
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomObserve.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/roomObserve.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let ChatRoom;
module.link("../../app/models/client", {
  ChatRoom(v) {
    ChatRoom = v;
  }

}, 2);
Meteor.startup(() => {
  ChatRoom.find().observe({
    added(data) {
      Session.set("roomData".concat(data._id), data);
    },

    changed(data) {
      Session.set("roomData".concat(data._id), data);
    },

    removed(data) {
      Session.set("roomData".concat(data._id), undefined);
    }

  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rootUrlChange.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/rootUrlChange.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let hasRole;
module.link("../../app/authorization/client", {
  hasRole(v) {
    hasRole = v;
  }

}, 2);
let Roles;
module.link("../../app/models/client", {
  Roles(v) {
    Roles = v;
  }

}, 3);
let settings;
module.link("../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 4);
let t;
module.link("../../app/utils/client", {
  t(v) {
    t = v;
  }

}, 5);
let UrlChangeModal;
module.link("../components/UrlChangeModal", {
  default(v) {
    UrlChangeModal = v;
  }

}, 6);
let imperativeModal;
module.link("../lib/imperativeModal", {
  imperativeModal(v) {
    imperativeModal = v;
  }

}, 7);
let dispatchToastMessage;
module.link("../lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 8);
let isSyncReady;
module.link("../lib/userData", {
  isSyncReady(v) {
    isSyncReady = v;
  }

}, 9);
Meteor.startup(() => {
  Tracker.autorun(c => {
    if (!Meteor.userId()) {
      return;
    }

    if (!Roles.ready.get() || !isSyncReady.get()) {
      return;
    }

    if (hasRole(Meteor.userId(), 'admin') === false) {
      return c.stop();
    }

    const siteUrl = settings.get('Site_Url');

    if (!siteUrl) {
      return;
    }

    const currentUrl = location.origin + window.__meteor_runtime_config__.ROOT_URL_PATH_PREFIX;

    if (window.__meteor_runtime_config__.ROOT_URL.replace(/\/$/, '') !== currentUrl) {
      const confirm = () => {
        imperativeModal.close();
        Meteor.call('saveSetting', 'Site_Url', currentUrl, () => {
          dispatchToastMessage({
            type: 'success',
            message: t('Saved')
          });
        });
      };

      imperativeModal.open({
        component: UrlChangeModal,
        props: {
          onConfirm: confirm,
          siteUrl,
          currentUrl,
          onClose: imperativeModal.close
        }
      });
    }

    const documentDomain = settings.get('Document_Domain');

    if (documentDomain) {
      window.document.domain = documentDomain;
    }

    return c.stop();
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/routes.tsx                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 0);
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 1);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 2);
let TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n(v) {
    TAPi18n = v;
  }

}, 3);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 4);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 5);
let React, lazy;
module.link("react", {
  default(v) {
    React = v;
  },

  lazy(v) {
    lazy = v;
  }

}, 6);
let toastr;
module.link("toastr", {
  default(v) {
    toastr = v;
  }

}, 7);
let KonchatNotification;
module.link("../../app/ui/client", {
  KonchatNotification(v) {
    KonchatNotification = v;
  }

}, 8);
let APIClient;
module.link("../../app/utils/client", {
  APIClient(v) {
    APIClient = v;
  }

}, 9);
let appLayout;
module.link("../lib/appLayout", {
  appLayout(v) {
    appLayout = v;
  }

}, 10);
let createTemplateForComponent;
module.link("../lib/portals/createTemplateForComponent", {
  createTemplateForComponent(v) {
    createTemplateForComponent = v;
  }

}, 11);
let dispatchToastMessage;
module.link("../lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 12);
let handleError;
module.link("../lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 13);
const InvitePage = /*#__PURE__*/lazy(() => module.dynamicImport('../views/invite/InvitePage'));
const SecretURLPage = /*#__PURE__*/lazy(() => module.dynamicImport('../views/invite/SecretURLPage'));
const CMSPage = /*#__PURE__*/lazy(() => module.dynamicImport('../views/root/CMSPage'));
const ResetPasswordPage = /*#__PURE__*/lazy(() => module.dynamicImport('../views/login/ResetPassword/ResetPassword'));
const SetupWizardRoute = /*#__PURE__*/lazy(() => module.dynamicImport('../views/setupWizard/SetupWizardRoute'));
const MailerUnsubscriptionPage = /*#__PURE__*/lazy(() => module.dynamicImport('../views/mailer/MailerUnsubscriptionPage'));
const NotFoundPage = /*#__PURE__*/lazy(() => module.dynamicImport('../views/notFound/NotFoundPage'));
const MeetPage = /*#__PURE__*/lazy(() => module.dynamicImport('../views/meet/MeetPage'));
FlowRouter.wait();
FlowRouter.route('/', {
  name: 'index',

  action() {
    appLayout.renderMainLayout({
      center: 'loading'
    });

    if (!Meteor.userId()) {
      return FlowRouter.go('home');
    }

    Tracker.autorun(c => {
      if (FlowRouter.subsReady() === true) {
        Meteor.defer(() => {
          const user = Meteor.user();

          if (user !== null && user !== void 0 && user.defaultRoom) {
            const room = user.defaultRoom.split('/');
            FlowRouter.go(room[0], {
              name: room[1]
            }, FlowRouter.current().queryParams);
          } else {
            FlowRouter.go('home');
          }
        });
        c.stop();
      }
    });
  }

});
FlowRouter.route('/login', {
  name: 'login',

  action() {
    FlowRouter.go('home');
  }

});
FlowRouter.route('/meet/:rid', {
  name: 'meet',

  async action(_params, queryParams) {
    if ((queryParams === null || queryParams === void 0 ? void 0 : queryParams.token) !== undefined) {
      // visitor login
      const visitor = await APIClient.v1.get("livechat/visitor/".concat(queryParams === null || queryParams === void 0 ? void 0 : queryParams.token));

      if (visitor !== null && visitor !== void 0 && visitor.visitor) {
        appLayout.render( /*#__PURE__*/React.createElement(MeetPage, null));
        return;
      }

      toastr.error(TAPi18n.__('Visitor_does_not_exist'));
      return;
    }

    if (!Meteor.userId()) {
      FlowRouter.go('home');
      return;
    }

    appLayout.render( /*#__PURE__*/React.createElement(MeetPage, null));
  }

});
FlowRouter.route('/home', {
  name: 'home',

  action(_params, queryParams) {
    KonchatNotification.getDesktopPermission();

    if ((queryParams === null || queryParams === void 0 ? void 0 : queryParams.saml_idp_credentialToken) !== undefined) {
      const token = queryParams.saml_idp_credentialToken;
      FlowRouter.setQueryParams({
        // eslint-disable-next-line @typescript-eslint/camelcase
        saml_idp_credentialToken: null
      });
      Meteor.loginWithSamlToken(token, error => {
        if (error) {
          if (error.reason) {
            dispatchToastMessage({
              type: 'error',
              message: error.reason
            });
          } else {
            handleError(error);
          }
        }

        appLayout.renderMainLayout({
          center: 'home'
        });
      });
      return;
    }

    appLayout.renderMainLayout({
      center: 'home'
    });
  }

});
FlowRouter.route('/directory/:tab?', {
  name: 'directory',
  action: () => {
    const DirectoryPage = createTemplateForComponent('DirectoryPage', () => module.dynamicImport('../views/directory/DirectoryPage'), {
      attachment: 'at-parent'
    });
    appLayout.renderMainLayout({
      center: DirectoryPage
    });
  }
});
FlowRouter.route('/omnichannel-directory/:page?/:bar?/:id?/:tab?/:context?', {
  name: 'omnichannel-directory',
  action: () => {
    const OmnichannelDirectoryPage = createTemplateForComponent('OmnichannelDirectoryPage', () => module.dynamicImport('../views/omnichannel/directory/OmnichannelDirectoryPage'), {
      attachment: 'at-parent'
    });
    appLayout.renderMainLayout({
      center: OmnichannelDirectoryPage
    });
  }
});
FlowRouter.route('/livechat-queue', {
  name: 'livechat-queue',
  action: () => {
    const OmnichannelQueueList = createTemplateForComponent('QueueList', () => module.dynamicImport('../views/omnichannel/queueList'), {
      attachment: 'at-parent'
    });
    appLayout.renderMainLayout({
      center: OmnichannelQueueList
    });
  }
});
FlowRouter.route('/account/:group?', {
  name: 'account',
  action: () => {
    const AccountRoute = createTemplateForComponent('AccountRoute', () => module.dynamicImport('../views/account/AccountRoute'), {
      attachment: 'at-parent'
    });
    appLayout.renderMainLayout({
      center: AccountRoute
    });
  }
});
FlowRouter.route('/terms-of-service', {
  name: 'terms-of-service',
  action: () => {
    appLayout.render( /*#__PURE__*/React.createElement(CMSPage, {
      page: "Layout_Terms_of_Service"
    }));
  }
});
FlowRouter.route('/privacy-policy', {
  name: 'privacy-policy',
  action: () => {
    appLayout.render( /*#__PURE__*/React.createElement(CMSPage, {
      page: "Layout_Privacy_Policy"
    }));
  }
});
FlowRouter.route('/legal-notice', {
  name: 'legal-notice',
  action: () => {
    appLayout.render( /*#__PURE__*/React.createElement(CMSPage, {
      page: "Layout_Legal_Notice"
    }));
  }
});
FlowRouter.route('/room-not-found/:type/:name', {
  name: 'room-not-found',
  action: function () {
    let {
      type,
      name
    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    Session.set('roomNotFound', {
      type,
      name
    });
    appLayout.renderMainLayout({
      center: 'roomNotFound'
    });
  }
});
FlowRouter.route('/register/:hash', {
  name: 'register-secret-url',
  action: () => {
    appLayout.render( /*#__PURE__*/React.createElement(SecretURLPage, null));
  }
});
FlowRouter.route('/invite/:hash', {
  name: 'invite',
  action: () => {
    appLayout.render( /*#__PURE__*/React.createElement(InvitePage, null));
  }
});
FlowRouter.route('/setup-wizard/:step?', {
  name: 'setup-wizard',
  action: () => {
    appLayout.render( /*#__PURE__*/React.createElement(SetupWizardRoute, null));
  }
});
FlowRouter.route('/mailer/unsubscribe/:_id/:createdAt', {
  name: 'mailer-unsubscribe',
  action: () => {
    appLayout.render( /*#__PURE__*/React.createElement(MailerUnsubscriptionPage, null));
  }
});
FlowRouter.route('/login-token/:token', {
  name: 'tokenLogin',

  action(params) {
    Accounts.callLoginMethod({
      methodArguments: [{
        loginToken: params === null || params === void 0 ? void 0 : params.token
      }],

      userCallback(error) {
        console.error(error);
        FlowRouter.go('/');
      }

    });
  }

});
FlowRouter.route('/reset-password/:token', {
  name: 'resetPassword',

  action() {
    appLayout.render( /*#__PURE__*/React.createElement(ResetPasswordPage, null));
  }

});
FlowRouter.route('/snippet/:snippetId/:snippetName', {
  name: 'snippetView',

  action() {
    appLayout.renderMainLayout({
      center: 'snippetPage'
    });
  }

});
FlowRouter.route('/oauth/authorize', {
  name: 'oauth/authorize',

  action(_params, queryParams) {
    appLayout.renderMainLayout({
      center: 'authorize',
      modal: true,
      // eslint-disable-next-line @typescript-eslint/camelcase
      client_id: queryParams === null || queryParams === void 0 ? void 0 : queryParams.client_id,
      // eslint-disable-next-line @typescript-eslint/camelcase
      redirect_uri: queryParams === null || queryParams === void 0 ? void 0 : queryParams.redirect_uri,
      // eslint-disable-next-line @typescript-eslint/camelcase
      response_type: queryParams === null || queryParams === void 0 ? void 0 : queryParams.response_type,
      state: queryParams === null || queryParams === void 0 ? void 0 : queryParams.state
    });
  }

});
FlowRouter.route('/oauth/error/:error', {
  name: 'oauth/error',

  action(params) {
    appLayout.renderMainLayout({
      center: 'oauth404',
      modal: true,
      error: params === null || params === void 0 ? void 0 : params.error
    });
  }

});
FlowRouter.notFound = {
  action: () => {
    appLayout.render( /*#__PURE__*/React.createElement(NotFoundPage, null));
  }
};
Meteor.startup(() => {
  FlowRouter.initialize();
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"setupWizard.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/setupWizard.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter(v) {
    FlowRouter = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let hasRole;
module.link("../../app/authorization/client", {
  hasRole(v) {
    hasRole = v;
  }

}, 3);
let settings;
module.link("../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 4);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const userId = Meteor.userId();
    const setupWizardState = settings.get('Show_Setup_Wizard');
    const mustRedirect = !userId && setupWizardState === 'pending' || !!userId && !!hasRole(userId, 'admin') && setupWizardState === 'in_progress';

    if (mustRedirect) {
      FlowRouter.go('setup-wizard');
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"slashCommands.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/slashCommands.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let slashCommands, APIClient;
module.link("../../app/utils/client", {
  slashCommands(v) {
    slashCommands = v;
  },

  APIClient(v) {
    APIClient = v;
  }

}, 2);
let oldUserId = null;
Tracker.autorun(() => {
  const newUserId = Meteor.userId();

  if (oldUserId === null && newUserId) {
    APIClient.v1.get('commands.list').then(result => {
      result.commands.forEach(command => {
        slashCommands.commands[command.command] = command;
      });
    });
  }

  oldUserId = Meteor.userId();
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"startup.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/startup.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Accounts;
module.link("meteor/accounts-base", {
  Accounts(v) {
    Accounts = v;
  }

}, 0);
let UserPresence;
module.link("meteor/konecty:user-presence", {
  UserPresence(v) {
    UserPresence = v;
  }

}, 1);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 2);
let TimeSync;
module.link("meteor/mizzao:timesync", {
  TimeSync(v) {
    TimeSync = v;
  }

}, 3);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 4);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 5);
let toastr;
module.link("toastr", {
  default(v) {
    toastr = v;
  }

}, 6);
let hasPermission;
module.link("../../app/authorization/client", {
  hasPermission(v) {
    hasPermission = v;
  }

}, 7);
let register;
module.link("../../app/markdown/lib/hljs", {
  register(v) {
    register = v;
  }

}, 8);
let settings;
module.link("../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 9);
let getUserPreference, t;
module.link("../../app/utils/client", {
  getUserPreference(v) {
    getUserPreference = v;
  },

  t(v) {
    t = v;
  }

}, 10);
module.link("highlight.js/styles/github.css");
let banners;
module.link("../lib/banners", {
  "*"(v) {
    banners = v;
  }

}, 11);
let synchronizeUserData, removeLocalUserData;
module.link("../lib/userData", {
  synchronizeUserData(v) {
    synchronizeUserData = v;
  },

  removeLocalUserData(v) {
    removeLocalUserData = v;
  }

}, 12);
let fireGlobalEvent;
module.link("../lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 13);

if (window.DISABLE_ANIMATION) {
  toastr.options.timeOut = 1;
  toastr.options.showDuration = 0;
  toastr.options.hideDuration = 0;
  toastr.options.extendedTimeOut = 0;
}

Meteor.startup(() => {
  fireGlobalEvent('startup', true);
  Accounts.onLogout(() => Session.set('openedRoom', null));
  TimeSync.loggingEnabled = false;
  Session.setDefault('AvatarRandom', 0);
  window.lastMessageWindow = {};
  window.lastMessageWindowHistory = {};
  let status = undefined;
  Tracker.autorun(async () => {
    const uid = Meteor.userId();

    if (!uid) {
      removeLocalUserData();
      return;
    }

    if (!Meteor.status().connected) {
      return;
    }

    const user = await synchronizeUserData(uid);

    if (!user) {
      return;
    }

    if (getUserPreference(user, 'enableAutoAway')) {
      const idleTimeLimit = getUserPreference(user, 'idleTimeLimit') || 300;
      UserPresence.awayTime = idleTimeLimit * 1000;
    } else {
      delete UserPresence.awayTime;
      UserPresence.stopTimer();
    }

    UserPresence.start();

    if (user.status !== status) {
      status = user.status;
      fireGlobalEvent('status-changed', status);
    }
  });
  Tracker.autorun(async c => {
    const uid = Meteor.userId();

    if (!uid) {
      return;
    }

    if (!hasPermission('manage-cloud')) {
      return;
    }

    Meteor.call('cloud:checkRegisterStatus', (err, data) => {
      if (err) {
        console.log(err);
        return;
      }

      c.stop();
      const {
        connectToCloud = false,
        workspaceRegistered = false
      } = data;

      if (connectToCloud === true && workspaceRegistered !== true) {
        banners.open({
          id: 'cloud-registration',
          title: t('Cloud_registration_pending_title'),
          html: t('Cloud_registration_pending_html'),
          modifiers: ['large', 'danger']
        });
      }
    });
  });
});
Meteor.startup(() => {
  Tracker.autorun(() => {
    const code = settings.get('Message_Code_highlight');
    code === null || code === void 0 ? void 0 : code.split(',').forEach(language => {
      language.trim() && register(language.trim());
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"theme.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/theme.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let createLess;
module.link("less/browser", {
  default(v) {
    createLess = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 1);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 2);
let settings;
module.link("../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 3);
const variables = new Map();
const lessExpressions = new Map([['default-action-color', 'darken(@secondary-background-color, 15%)'], ['default-action-contrast', 'contrast(@default-action-color, #444444)'], ['primary-background-contrast', 'contrast(@primary-background-color, #444444)'], ['primary-action-contrast', 'contrast(@primary-action-color, #444444)'], ['secondary-background-contrast', 'contrast(@secondary-background-color, #444444)'], ['secondary-action-contrast', 'contrast(@secondary-action-color, #444444)'], ['selection-background', 'lighten(@selection-color, 30%)'], ['success-background', 'lighten(@success-color, 45%)'], ['success-border', 'lighten(@success-color, 30%)'], ['error-background', 'lighten(@error-color, 45%)'], ['error-border', 'lighten(@error-color, 30%)'], ['error-contrast', 'contrast(@error-color)'], ['pending-background', 'lighten(@pending-color, 45%)'], ['pending-border', 'lighten(@pending-color, 30%)'], ['transparent-darkest', 'rgba(17, 12, 12, 0.5)'], ['transparent-darker', 'rgba(0, 0, 0, 0.15)'], ['transparent-dark', 'rgba(15, 34, 0, 0.05)'], ['transparent-light', 'rgba(255, 255, 255, 0.1)'], ['transparent-lighter', 'rgba(255, 255, 255, 0.3)'], ['transparent-lightest', 'rgba(255, 255, 255, 0.6)']]);
const less = createLess(window, {});

const compileLess = async () => {
  if (lessExpressions.size === 0) {
    return '';
  }

  const lessCode = [...Array.from(variables.entries(), _ref => {
    let [name, value] = _ref;
    return "@".concat(name, ": ").concat(value, ";");
  }), ...Array.from(lessExpressions.entries(), _ref2 => {
    let [name, expression] = _ref2;
    return "@".concat(name, ": ").concat(expression, ";");
  }), ':root {', ...Array.from(lessExpressions.entries(), _ref3 => {
    let [name] = _ref3;
    return "--".concat(name, ": @").concat(name, ";");
  }), '}'].join('\n');

  try {
    const {
      css
    } = await less.render(lessCode);
    return css;
  } catch (error) {
    console.error(error);
    return '';
  }
};

let cssVariablesElement = null;

const updateCssVariables = _.debounce(async () => {
  if (!cssVariablesElement) {
    cssVariablesElement = document.querySelector('#css-variables');
  }

  if (!cssVariablesElement) {
    return;
  }

  cssVariablesElement.innerHTML = [':root {', ...Array.from(variables.entries(), _ref4 => {
    let [name, value] = _ref4;
    return "--".concat(name, ": ").concat(value, ";");
  }), '}', await compileLess()].join('\n');
}, 50);

const handleThemeColorChanged = _ref5 => {
  let {
    _id,
    value,
    editor
  } = _ref5;

  if (typeof value !== 'string') {
    return;
  }

  try {
    var _$exec;

    const name = (_$exec = /^theme-color-(.*)$/.exec(_id)) === null || _$exec === void 0 ? void 0 : _$exec[1];

    if (!name) {
      return;
    }

    const legacy = name.slice(0, 3) !== 'rc-';

    if (editor === 'color') {
      variables.set(name, value);
      return;
    }

    if (legacy) {
      lessExpressions.set(name, value);
      return;
    }

    variables.set(name, "var(--".concat(value, ")"));
  } finally {
    updateCssVariables();
  }
};

const handleThemeFontChanged = _ref6 => {
  let {
    _id,
    value
  } = _ref6;

  try {
    var _$exec2;

    const name = (_$exec2 = /^theme-font-(.*)$/.exec(_id)) === null || _$exec2 === void 0 ? void 0 : _$exec2[1];

    if (!name) {
      return;
    }

    variables.set(name, value);
  } finally {
    updateCssVariables();
  }
};

Meteor.startup(() => {
  settings.collection.find({
    _id: /^theme-color-/i
  }, {
    fields: {
      value: 1,
      editor: 1
    }
  }).observe({
    added: handleThemeColorChanged,
    changed: handleThemeColorChanged
  });
  settings.collection.find({
    _id: /^theme-font-/i
  }, {
    fields: {
      value: 1
    }
  }).observe({
    added: handleThemeFontChanged,
    changed: handleThemeFontChanged
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"unread.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/unread.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let Favico;
module.link("../../app/favico/client", {
  Favico(v) {
    Favico = v;
  }

}, 3);
let ChatSubscription, ChatRoom;
module.link("../../app/models/client", {
  ChatSubscription(v) {
    ChatSubscription = v;
  },

  ChatRoom(v) {
    ChatRoom = v;
  }

}, 4);
let settings;
module.link("../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 5);
let menu;
module.link("../../app/ui-utils/client", {
  menu(v) {
    menu = v;
  }

}, 6);
let getUserPreference;
module.link("../../app/utils/client", {
  getUserPreference(v) {
    getUserPreference = v;
  }

}, 7);
let fireGlobalEvent;
module.link("../lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 8);

const fetchSubscriptions = () => ChatSubscription.find({
  open: true,
  hideUnreadStatus: {
    $ne: true
  },
  archived: {
    $ne: true
  }
}, {
  fields: {
    unread: 1,
    alert: 1,
    rid: 1,
    t: 1,
    name: 1,
    ls: 1,
    unreadAlert: 1,
    fname: 1,
    prid: 1
  }
}).fetch();

Meteor.startup(() => {
  Tracker.autorun(() => {
    const userUnreadAlert = getUserPreference(Meteor.userId(), 'unreadAlert');
    let unreadAlert = false;
    const unreadCount = fetchSubscriptions().reduce((ret, subscription) => Tracker.nonreactive(() => {
      const room = ChatRoom.findOne({
        _id: subscription.rid
      }, {
        fields: {
          usersCount: 1
        }
      });
      fireGlobalEvent('unread-changed-by-subscription', _objectSpread(_objectSpread({}, subscription), {}, {
        usersCount: room === null || room === void 0 ? void 0 : room.usersCount
      }));

      if (subscription.alert || subscription.unread > 0) {
        // Increment the total unread count.
        if (subscription.alert === true && subscription.unreadAlert !== 'nothing') {
          if (subscription.unreadAlert === 'all' || userUnreadAlert !== false) {
            unreadAlert = '•';
          }
        }

        return ret + subscription.unread;
      }

      return ret;
    }), 0);
    menu.updateUnreadBars();

    if (unreadCount > 0) {
      if (unreadCount > 999) {
        Session.set('unread', '999+');
      } else {
        Session.set('unread', unreadCount);
      }
    } else if (unreadAlert !== false) {
      Session.set('unread', unreadAlert);
    } else {
      Session.set('unread', '');
    }
  });
});
Meteor.startup(() => {
  const favicon = new Favico({
    position: 'up',
    animation: 'none'
  });
  window.favico = favicon;
  Tracker.autorun(() => {
    var _settings$get;

    const siteName = (_settings$get = settings.get('Site_Name')) !== null && _settings$get !== void 0 ? _settings$get : '';
    const unread = Session.get('unread');
    fireGlobalEvent('unread-changed', unread);

    if (favicon) {
      favicon.badge(unread, {
        bgColor: typeof unread !== 'number' ? '#3d8a3a' : '#ac1b1b'
      });
    }

    document.title = unread === '' ? siteName : "(".concat(unread, ") ").concat(siteName);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userRoles.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/userRoles.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let UserRoles, RoomRoles, ChatMessage;
module.link("../../app/models/client", {
  UserRoles(v) {
    UserRoles = v;
  },

  RoomRoles(v) {
    RoomRoles = v;
  },

  ChatMessage(v) {
    ChatMessage = v;
  }

}, 2);
let Notifications;
module.link("../../app/notifications/client", {
  Notifications(v) {
    Notifications = v;
  }

}, 3);
let handleError;
module.link("../lib/utils/handleError", {
  handleError(v) {
    handleError = v;
  }

}, 4);
Meteor.startup(() => {
  Tracker.autorun(() => {
    if (Meteor.userId()) {
      Meteor.call('getUserRoles', (error, results) => {
        if (error) {
          return handleError(error);
        }

        for (const record of results) {
          UserRoles.upsert({
            _id: record._id
          }, record);
        }
      });
      Notifications.onLogged('roles-change', role => {
        if (role.type === 'added') {
          if (role.scope) {
            RoomRoles.upsert({
              'rid': role.scope,
              'u._id': role.u._id
            }, {
              $setOnInsert: {
                u: role.u
              },
              $addToSet: {
                roles: role._id
              }
            });
          } else {
            UserRoles.upsert({
              _id: role.u._id
            }, {
              $addToSet: {
                roles: role._id
              },
              $set: {
                username: role.u.username
              }
            });
            ChatMessage.update({
              'u._id': role.u._id
            }, {
              $addToSet: {
                roles: role._id
              }
            }, {
              multi: true
            });
          }

          return;
        }

        if (role.type === 'removed') {
          if (role.scope) {
            RoomRoles.update({
              'rid': role.scope,
              'u._id': role.u._id
            }, {
              $pull: {
                roles: role._id
              }
            });
          } else {
            UserRoles.update({
              _id: role.u._id
            }, {
              $pull: {
                roles: role._id
              }
            });
            ChatMessage.update({
              'u._id': role.u._id
            }, {
              $pull: {
                roles: role._id
              }
            }, {
              multi: true
            });
          }

          return;
        }

        if (role.type === 'changed') {
          ChatMessage.update({
            roles: role._id
          }, {
            $inc: {
              rerender: 1
            }
          }, {
            multi: true
          });
        }
      });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userSetUtcOffset.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/userSetUtcOffset.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 1);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 2);
let Users;
module.link("../../app/models/client", {
  Users(v) {
    Users = v;
  }

}, 3);
Meteor.startup(() => {
  Tracker.autorun(() => {
    const user = Users.findOne({
      _id: Meteor.userId()
    }, {
      fields: {
        statusConnection: 1,
        utcOffset: 1
      }
    });

    if (user && user.statusConnection === 'online') {
      const utcOffset = moment().utcOffset() / 60;

      if (user.utcOffset !== utcOffset) {
        Meteor.call('userSetUtcOffset', utcOffset);
      }
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userStatusManuallySet.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/userStatusManuallySet.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let callbacks;
module.link("../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 1);
let fireGlobalEvent;
module.link("../lib/utils/fireGlobalEvent", {
  fireGlobalEvent(v) {
    fireGlobalEvent = v;
  }

}, 2);

/* fire user state change globally, to listen on desktop electron client */
Meteor.startup(() => {
  callbacks.add('userStatusManuallySet', status => {
    fireGlobalEvent('user-status-manually-set', status);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"usersObserve.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/usersObserve.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let Session;
module.link("meteor/session", {
  Session(v) {
    Session = v;
  }

}, 1);
let RoomManager;
module.link("../../app/ui-utils/client", {
  RoomManager(v) {
    RoomManager = v;
  }

}, 2);
Meteor.startup(() => {
  Meteor.users.find({}, {
    fields: {
      name: 1,
      username: 1,
      status: 1,
      utcOffset: 1,
      statusText: 1
    }
  }).observe({
    added(user) {
      Session.set("user_".concat(user.username, "_status"), user.status);
      Session.set("user_".concat(user.username, "_status_text"), user.statusText);
      RoomManager.updateUserStatus(user, user.status, user.utcOffset);
    },

    changed(user) {
      Session.set("user_".concat(user.username, "_status"), user.status);

      if (user.statusText !== undefined) {
        Session.set("user_".concat(user.username, "_status_text"), user.statusText);
      }

      RoomManager.updateUserStatus(user, user.status, user.utcOffset);
    },

    removed(user) {
      Session.set("user_".concat(user.username, "_status"), null);
      Session.set("user_".concat(user.username, "_status_text"), null);
      RoomManager.updateUserStatus(user, 'offline', null);
    }

  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"methods":{"deleteMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/deleteMessage.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ChatMessage;
module.link("../../app/models/client", {
  ChatMessage(v) {
    ChatMessage = v;
  }

}, 1);
let canDeleteMessage;
module.link("../lib/utils/canDeleteMessage", {
  canDeleteMessage(v) {
    canDeleteMessage = v;
  }

}, 2);
Meteor.methods({
  deleteMessage(msg) {
    if (!Meteor.userId()) {
      return false;
    } // We're now only passed in the `_id` property to lower the amount of data sent to the server


    const message = ChatMessage.findOne({
      _id: msg._id
    });

    if (!canDeleteMessage({
      rid: message.rid,
      ts: message.ts,
      uid: message.u._id
    })) {
      return false;
    }

    ChatMessage.remove({
      '_id': message._id,
      'u._id': Meteor.userId()
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hideRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/hideRoom.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ChatSubscription;
module.link("../../app/models/client", {
  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 1);
Meteor.methods({
  hideRoom(rid) {
    if (!Meteor.userId()) {
      return false;
    }

    ChatSubscription.update({
      rid,
      'u._id': Meteor.userId()
    }, {
      $set: {
        alert: false,
        open: false
      }
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"openRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/openRoom.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ChatSubscription;
module.link("../../app/models/client", {
  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 1);
Meteor.methods({
  openRoom(rid) {
    if (!Meteor.userId()) {
      return false;
    }

    ChatSubscription.update({
      rid,
      'u._id': Meteor.userId()
    }, {
      $set: {
        open: true
      }
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"setUserActiveStatus.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/setUserActiveStatus.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
Meteor.methods({
  setUserActiveStatus(userId, active) {
    Meteor.users.update(userId, {
      $set: {
        active
      }
    });
    return true;
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"toggleFavorite.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/toggleFavorite.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let ChatSubscription;
module.link("../../app/models/client", {
  ChatSubscription(v) {
    ChatSubscription = v;
  }

}, 1);
Meteor.methods({
  toggleFavorite(rid, f) {
    if (!Meteor.userId()) {
      return false;
    }

    ChatSubscription.update({
      rid,
      'u._id': Meteor.userId()
    }, {
      $set: {
        f
      }
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"updateMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/updateMessage.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let TimeSync;
module.link("meteor/mizzao:timesync", {
  TimeSync(v) {
    TimeSync = v;
  }

}, 1);
let Tracker;
module.link("meteor/tracker", {
  Tracker(v) {
    Tracker = v;
  }

}, 2);
let moment;
module.link("moment", {
  default(v) {
    moment = v;
  }

}, 3);

let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 4);
let hasAtLeastOnePermission;
module.link("../../app/authorization/client", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 5);
let ChatMessage;
module.link("../../app/models/client", {
  ChatMessage(v) {
    ChatMessage = v;
  }

}, 6);
let settings;
module.link("../../app/settings/client", {
  settings(v) {
    settings = v;
  }

}, 7);
let t;
module.link("../../app/utils/client", {
  t(v) {
    t = v;
  }

}, 8);
let callbacks;
module.link("../../lib/callbacks", {
  callbacks(v) {
    callbacks = v;
  }

}, 9);
let dispatchToastMessage;
module.link("../lib/toast", {
  dispatchToastMessage(v) {
    dispatchToastMessage = v;
  }

}, 10);
Meteor.methods({
  updateMessage(message) {
    if (!Meteor.userId()) {
      return false;
    }

    const originalMessage = ChatMessage.findOne(message._id);
    const hasPermission = hasAtLeastOnePermission('edit-message', message.rid);
    const editAllowed = settings.get('Message_AllowEditing');
    let editOwn = false;

    if (originalMessage.msg === message.msg) {
      return;
    }

    if (originalMessage && originalMessage.u && originalMessage.u._id) {
      editOwn = originalMessage.u._id === Meteor.userId();
    }

    const me = Meteor.users.findOne(Meteor.userId());

    if (!(hasPermission || editAllowed && editOwn)) {
      dispatchToastMessage({
        type: 'error',
        message: t('error-action-not-allowed', {
          action: t('Message_editing')
        })
      });
      return false;
    }

    const blockEditInMinutes = settings.get('Message_AllowEditing_BlockEditInMinutes');

    if (_.isNumber(blockEditInMinutes) && blockEditInMinutes !== 0) {
      if (originalMessage.ts) {
        const msgTs = moment(originalMessage.ts);

        if (msgTs) {
          const currentTsDiff = moment().diff(msgTs, 'minutes');

          if (currentTsDiff > blockEditInMinutes) {
            dispatchToastMessage({
              type: 'error',
              message: t('error-message-editing-blocked')
            });
            return false;
          }
        }
      }
    }

    Tracker.nonreactive(() => {
      if (isNaN(TimeSync.serverOffset())) {
        message.editedAt = new Date();
      } else {
        message.editedAt = new Date(Date.now() + TimeSync.serverOffset());
      }

      message.editedBy = {
        _id: Meteor.userId(),
        username: me.username
      };
      message = callbacks.run('beforeSaveMessage', message);
      const messageObject = {
        editedAt: message.editedAt,
        editedBy: message.editedBy,
        msg: message.msg
      };

      if (originalMessage.attachments) {
        if (originalMessage.attachments[0].description !== undefined) {
          delete messageObject.msg;
        }
      }

      ChatMessage.update({
        '_id': message._id,
        'u._id': Meteor.userId()
      }, {
        $set: messageObject
      });
    });
  }

});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"polyfills":{"childNodeRemove.ts":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/childNodeRemove.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
(function (arr) {
  arr.forEach(item => {
    if (item.hasOwnProperty('remove')) {
      return;
    }

    Object.defineProperty(item, 'remove', {
      configurable: true,
      enumerable: true,
      writable: true,
      value: function remove() {
        this.parentNode.removeChild(this);
      }
    });
  });
})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"cssVars.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/cssVars.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _;

module.link("underscore", {
  default(v) {
    _ = v;
  }

}, 0);

const findDeclarations = code => {
  var _code$match;

  return ((_code$match = code.match(/(--[^:; ]+:..*?;)/g)) !== null && _code$match !== void 0 ? _code$match : []).map(declaration => {
    const matches = /(.*?):\s*(.*?)\s*;/.exec(declaration);

    if (matches === null) {
      throw new Error();
    }

    const [, name, value] = matches;
    return [name, value.indexOf('var(') >= 0 ? variables => value.replace(/var\((--.*?)\)/gm, (_, name) => {
      var _variables$name;

      return (_variables$name = variables[name]) === null || _variables$name === void 0 ? void 0 : _variables$name.call(null, variables);
    }) : () => value];
  });
};

const replaceReferences = (code, variables) => code.replace(/var\((--.*?)\)/gm, (_, name) => {
  var _variables$name2;

  return (_variables$name2 = variables[name]) === null || _variables$name2 === void 0 ? void 0 : _variables$name2.call(null, variables);
});

let cssVariablesElement;
const originalCodes = new Map();

const update = _.debounce(() => {
  const declarations = [].concat(...Array.from(originalCodes.values(), findDeclarations), findDeclarations(cssVariablesElement.innerHTML));
  const variables = Object.fromEntries(declarations);
  originalCodes.forEach((originalCode, element) => {
    const patchedCode = replaceReferences(originalCode, variables);
    let patchedElement = element.nextElementSibling;

    if (!patchedElement || !patchedElement.classList.contains('patched-css-variables')) {
      patchedElement = document.createElement('style');
      patchedElement.type = 'text/css';
      patchedElement.classList.add('patched-css-variables');
      element.insertAdjacentElement('afterend', patchedElement);
    }

    const {
      sheet
    } = patchedElement;

    while (sheet.cssRules.length > 0) {
      sheet.deleteRule(0);
    }

    sheet.insertRule("@media all {".concat(patchedCode, "}"), 0);
  });
}, 100);

const findAndPatchFromLinkElements = () => {
  Array.from(document.querySelectorAll('link[type="text/css"].__meteor-css__')).forEach(async linkElement => {
    const url = linkElement.getAttribute('href');

    if (url === null) {
      return;
    }

    try {
      const response = await fetch(url);
      const code = await response.text();
      originalCodes.set(linkElement, code);
    } catch (error) {
      console.warn(error);
    } finally {
      update();
    }
  });
};

const waitAndInitialize = () => {
  if (document.readyState !== 'complete') {
    requestAnimationFrame(waitAndInitialize);
    return;
  }

  const element = document.getElementById('css-variables');

  if (element === null) {
    requestAnimationFrame(waitAndInitialize);
    return;
  }

  cssVariablesElement = element;
  const cssVariablesElementObserver = new MutationObserver(() => {
    update();
  });
  cssVariablesElementObserver.observe(cssVariablesElement, {
    childList: true
  });
  findAndPatchFromLinkElements();
};

(() => {
  if (window.CSS && window.CSS.supports && window.CSS.supports('(--foo: red)')) {
    return;
  }

  waitAndInitialize();
})();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"customEventPolyfill.ts":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/customEventPolyfill.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
(() => {
  if (typeof window.CustomEvent === 'function') {
    return;
  }

  const CustomEvent = function (type) {
    let {
      bubbles = false,
      cancelable = false,
      detail = null
    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    const evt = document.createEvent('CustomEvent');
    evt.initCustomEvent(type, bubbles, cancelable, detail);
    return evt;
  };

  window.CustomEvent = CustomEvent;
})();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hoverTouchClick.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/hoverTouchClick.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let domEvents;
module.link("../lib/utils/domEvents", {
  "*"(v) {
    domEvents = v;
  }

}, 0);
let isIOsDevice;
module.link("../lib/utils/isIOsDevice", {
  isIOsDevice(v) {
    isIOsDevice = v;
  }

}, 1);

(() => {
  if (!isIOsDevice || !window.matchMedia('(hover: none)').matches) {
    return;
  }

  domEvents.delegate({
    parent: document.body,
    eventName: 'touchend',
    elementSelector: 'a:hover',
    listener: (_, element) => {
      domEvents.triggerClick(element);
    }
  });
})();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/index.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("@rocket.chat/fuselage-polyfills");
module.link("url-polyfill");
module.link("./childNodeRemove");
module.link("./cssVars");
module.link("./customEventPolyfill");
module.link("./hoverTouchClick");
module.link("./objectFromEntries");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"objectFromEntries.ts":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/objectFromEntries.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
Object.fromEntries = Object.fromEntries || function fromEntries(entries) {
  return [...entries].reduce((obj, _ref) => {
    let {
      0: key,
      1: val
    } = _ref;
    return Object.assign(obj, {
      [key]: val
    });
  }, {});
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"providers":{"AuthorizationProvider.tsx":[
  "meteor/meteor",
  "react",
  "../../app/authorization/client",
  "../../app/models/client/models/Roles",
  "../contexts/AuthorizationContext",
  "../hooks/useReactiveValue",
  "./createReactiveSubscriptionFactory"
],"AvatarUrlProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../app/utils/client",
  "../../app/utils/lib/getURL",
  "../contexts/AvatarUrlContext",
  "../contexts/SettingsContext"
],"ConnectionStatusProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "meteor/meteor",
  "react",
  "../contexts/ConnectionStatusContext",
  "../hooks/useReactiveValue"
],"CustomSoundProvider.tsx":[
  "react",
  "../../app/custom-sounds/client/lib/CustomSounds",
  "../contexts/CustomSoundContext"
],"EditableSettingsProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "meteor/mongo",
  "meteor/tracker",
  "react",
  "../contexts/EditableSettingsContext",
  "../contexts/SettingsContext",
  "./createReactiveSubscriptionFactory"
],"LayoutProvider.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../app/ui-utils/client",
  "../contexts/LayoutContext",
  "../contexts/RouterContext",
  "../contexts/SettingsContext"
],"MeteorProvider.tsx":[
  "react",
  "../components/Message/Attachments/providers/AttachmentProvider",
  "./AuthorizationProvider",
  "./AvatarUrlProvider",
  "./ConnectionStatusProvider",
  "./CustomSoundProvider",
  "./LayoutProvider",
  "./ModalProvider",
  "./OmnichannelProvider",
  "./RouterProvider",
  "./ServerProvider",
  "./SessionProvider",
  "./SettingsProvider",
  "./SidebarProvider",
  "./ToastMessagesProvider",
  "./TranslationProvider",
  "./UserProvider"
],"ModalProvider.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../app/ui-utils/client/lib/modal",
  "../components/ModalPortal",
  "../contexts/ModalContext",
  "../views/hooks/useImperativeModal"
],"OmnichannelProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../app/livechat/client/collections/LivechatInquiry",
  "../../app/livechat/client/lib/stream/queueManager",
  "../../app/notifications/client",
  "../contexts/AuthorizationContext",
  "../contexts/OmnichannelContext",
  "../contexts/ServerContext",
  "../contexts/SettingsContext",
  "../contexts/UserContext",
  "../hooks/useReactiveValue"
],"RouterProvider.tsx":[
  "meteor/kadira:flow-router",
  "meteor/tracker",
  "react",
  "../contexts/RouterContext"
],"ServerProvider.tsx":[
  "meteor/meteor",
  "react",
  "../../app/utils/client",
  "../contexts/ServerContext"
],"SessionProvider.tsx":[
  "meteor/session",
  "react",
  "../contexts/SessionContext",
  "./createReactiveSubscriptionFactory"
],"SettingsProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "meteor/tracker",
  "react",
  "../contexts/AuthorizationContext",
  "../contexts/ServerContext",
  "../contexts/SettingsContext",
  "../lib/settings/PrivateSettingsCachedCollection",
  "../lib/settings/PublicSettingsCachedCollection",
  "./createReactiveSubscriptionFactory"
],"SidebarProvider.tsx":[
  "react",
  "../../app/ui-utils/client",
  "../contexts/SidebarContext",
  "../hooks/useReactiveValue"
],"ToastMessagesProvider.tsx":[
  "react",
  "toastr",
  "../contexts/ToastMessagesContext",
  "../lib/toast",
  "../lib/utils/handleError"
],"TranslationProvider.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "meteor/rocketchat:tap-i18n",
  "react",
  "../contexts/TranslationContext",
  "../hooks/useReactiveValue"
],"UserProvider.tsx":[
  "meteor/meteor",
  "react",
  "../../app/models/client",
  "../../app/utils/client",
  "../../lib/callbacks",
  "../contexts/UserContext",
  "../hooks/useReactiveValue",
  "./createReactiveSubscriptionFactory"
],"createReactiveSubscriptionFactory.ts":[
  "meteor/tracker"
]},"templateHelpers":{"avatarUrlFromUsername.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/avatarUrlFromUsername.ts                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let getUserAvatarURL;
module.link("../../app/utils/lib/getUserAvatarURL", {
  getUserAvatarURL(v) {
    getUserAvatarURL = v;
  }

}, 1);
Template.registerHelper('avatarUrlFromUsername', getUserAvatarURL);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emojiUrlFromName.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/emojiUrlFromName.ts                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let getEmojiUrlFromName;
module.link("../../app/emoji-custom/client/lib/emojiCustom", {
  getEmojiUrlFromName(v) {
    getEmojiUrlFromName = v;
  }

}, 1);
Template.registerHelper('emojiUrlFromName', getEmojiUrlFromName);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hasPermission.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/hasPermission.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let hasAtLeastOnePermission;
module.link("../../app/authorization/client", {
  hasAtLeastOnePermission(v) {
    hasAtLeastOnePermission = v;
  }

}, 1);
Template.registerHelper('hasPermission', hasAtLeastOnePermission);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/index.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./log");
module.link("./renderEmoji");
module.link("./avatarUrlFromUsername");
module.link("./emojiUrlFromName");
module.link("./nrrargs");
module.link("./hasPermission");
module.link("./userHasAllPermission");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"log.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/log.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
Template.registerHelper('log', function () {
  console.log(...arguments);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"nrrargs.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/nrrargs.ts                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
Template.registerHelper('nrrargs', function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  return {
    _arguments: args
  };
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"renderEmoji.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/renderEmoji.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let renderEmoji;
module.link("../lib/utils/renderEmoji", {
  renderEmoji(v) {
    renderEmoji = v;
  }

}, 1);
Template.registerHelper('renderEmoji', renderEmoji);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userHasAllPermission.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/userHasAllPermission.ts                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let Template;
module.link("meteor/templating", {
  Template(v) {
    Template = v;
  }

}, 0);
let userHasAllPermission;
module.link("../../app/authorization/client", {
  userHasAllPermission(v) {
    userHasAllPermission = v;
  }

}, 1);
Template.registerHelper('userHasAllPermission', (userId, permission, scope) => userHasAllPermission(permission, scope, userId));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"importPackages.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/importPackages.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../app/cors/client");
module.link("../app/2fa/client");
module.link("../app/analytics/client");
module.link("../app/authorization");
module.link("../app/autotranslate/client");
module.link("../app/cas/client");
module.link("../app/channel-settings");
module.link("../app/crowd/client");
module.link("../app/custom-oauth");
module.link("../app/custom-sounds/client");
module.link("../app/dolphin/client");
module.link("../app/drupal/client");
module.link("../app/emoji/client");
module.link("../app/emoji-emojione/client");
module.link("../app/emoji-custom/client");
module.link("../app/favico");
module.link("../app/file-upload");
module.link("../app/github-enterprise/client");
module.link("../app/gitlab/client");
module.link("../app/iframe-login/client");
module.link("../app/importer/client");
module.link("../app/importer-csv/client");
module.link("../app/importer-hipchat-enterprise/client");
module.link("../app/importer-slack/client");
module.link("../app/importer-slack-users/client");
module.link("../app/integrations/client/startup");
module.link("../app/lib/client");
module.link("../app/livestream/client");
module.link("../app/logger/client");
module.link("../app/markdown/client");
module.link("../app/mentions-flextab/client");
module.link("../app/message-attachments/client");
module.link("../app/message-mark-as-unread/client");
module.link("../app/message-pin/client");
module.link("../app/message-snippet/client");
module.link("../app/message-star/client");
module.link("../app/nextcloud/client");
module.link("../app/oauth2-server-config/client");
module.link("../app/oembed/client");
module.link("../app/otr/client");
module.link("../app/push-notifications/client");
module.link("../app/apps/client");
module.link("../app/slackbridge/client");
module.link("../app/slashcommands-archiveroom/client");
module.link("../app/slashcommand-asciiarts/client");
module.link("../app/slashcommands-create/client");
module.link("../app/slashcommands-hide/client");
module.link("../app/slashcommands-invite/client");
module.link("../app/slashcommands-inviteall/client");
module.link("../app/slashcommands-join/client");
module.link("../app/slashcommands-kick/client");
module.link("../app/slashcommands-open/client");
module.link("../app/slashcommands-topic/client");
module.link("../app/slashcommands-unarchiveroom/client");
module.link("../app/tokenpass/client");
module.link("../app/ui/client");
module.link("../app/ui-account/client");
module.link("../app/ui-clean-history/client");
module.link("../app/ui-login/client");
module.link("../app/ui-master/client");
module.link("../app/ui-message/client");
module.link("../app/ui-sidenav/client");
module.link("../app/ui-vrecord/client");
module.link("../app/videobridge/client");
module.link("../app/webdav/client");
module.link("../app/webrtc/client");
module.link("../app/wordpress/client");
module.link("../app/nrr/client");
module.link("../app/meteor-accounts-saml/client");
module.link("../app/e2e/client");
module.link("../app/blockstack/client");
module.link("../app/version-check/client");
module.link("../app/search/client");
module.link("../app/chatpal-search/client");
module.link("../app/lazy-load/client");
module.link("../app/discussion/client");
module.link("../app/threads/client");
module.link("../app/mail-messages/client");
module.link("../app/user-status/client");
module.link("../app/utils/client");
module.link("../app/settings/client");
module.link("../app/models/client");
module.link("../app/notifications/client");
module.link("../app/ui-utils/client");
module.link("../app/ui-cached-collection/client");
module.link("../app/action-links/client");
module.link("../app/reactions/client");
module.link("../app/livechat/client");
module.link("../app/meteor-autocomplete/client");
module.link("../app/theme/client");
module.link("../app/custom/client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"templates.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templates.ts                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let HTML;
module.link("meteor/htmljs", {
  HTML(v) {
    HTML = v;
  }

}, 0);
let createTemplateForComponent;
module.link("./lib/portals/createTemplateForComponent", {
  createTemplateForComponent(v) {
    createTemplateForComponent = v;
  }

}, 1);
createTemplateForComponent('MessageActions', () => module.dynamicImport('./components/Message/Actions'));
createTemplateForComponent('reactAttachments', () => module.dynamicImport('./components/Message/Attachments'));
createTemplateForComponent('ThreadMetric', () => module.dynamicImport('./components/Message/Metrics/Thread'), {
  renderContainerView: () => HTML.DIV({
    style: 'min-height: 36px;'
  })
});
createTemplateForComponent('DiscussionMetric', () => module.dynamicImport('./components/Message/Metrics/Discussion'), {
  renderContainerView: () => HTML.DIV({
    style: 'min-height: 36px;'
  })
});
createTemplateForComponent('MessageBody', () => module.dynamicImport('./components/Message/Body'));
createTemplateForComponent('BroadCastMetric', () => module.dynamicImport('./components/Message/Metrics/Broadcast'));
createTemplateForComponent('Checkbox', async () => {
  const {
    CheckBox
  } = await module.dynamicImport('@rocket.chat/fuselage');
  return {
    default: CheckBox
  };
}, {
  attachment: 'at-parent'
});
createTemplateForComponent('RoomForeword', () => module.dynamicImport('./components/RoomForeword'), {
  attachment: 'at-parent'
});
createTemplateForComponent('messageLocation', () => module.dynamicImport('./views/location/MessageLocation'));
createTemplateForComponent('sidebarHeader', () => module.dynamicImport('./sidebar/header'));
createTemplateForComponent('sidebarChats', () => module.dynamicImport('./sidebar/RoomList/index'), {
  renderContainerView: () => HTML.DIV({
    style: 'display: flex; flex: 1 1 100%;'
  })
});
createTemplateForComponent('omnichannelFlex', () => module.dynamicImport('./views/omnichannel/sidebar/OmnichannelSidebar'), {
  renderContainerView: () => HTML.DIV({
    style: 'height: 100%; position: relative;'
  })
});
createTemplateForComponent('auditPage', () => module.dynamicImport('../ee/client/audit/AuditPage'), {
  attachment: 'at-parent'
});
createTemplateForComponent('auditLogPage', () => module.dynamicImport('../ee/client/audit/AuditLogPage'), {
  attachment: 'at-parent'
});
createTemplateForComponent('DiscussionMessageList', () => module.dynamicImport('./views/room/contextualBar/Discussions'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('ThreadsList', () => module.dynamicImport('./views/room/contextualBar/Threads'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('ExportMessages', () => module.dynamicImport('./views/room/contextualBar/ExportMessages'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('KeyboardShortcuts', () => module.dynamicImport('./views/room/contextualBar/KeyboardShortcuts'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('room', () => module.dynamicImport('./views/room/Room'), {
  renderContainerView: () => HTML.DIV({
    style: 'height: 100%; position: relative;'
  })
});
createTemplateForComponent('AutoTranslate', () => module.dynamicImport('./views/room/contextualBar/AutoTranslate'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('NotificationsPreferences', () => module.dynamicImport('./views/room/contextualBar/NotificationPreferences'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('InviteUsers', () => module.dynamicImport('./views/room/contextualBar/RoomMembers/InviteUsers'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('EditInvite', () => module.dynamicImport('./views/room/contextualBar/RoomMembers/EditInvite'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('AddUsers', () => module.dynamicImport('./views/room/contextualBar/RoomMembers/AddUsers'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('membersList', () => module.dynamicImport('./views/room/contextualBar/RoomMembers'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('OTR', () => module.dynamicImport('./views/room/contextualBar/OTR'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('EditRoomInfo', () => module.dynamicImport('./views/room/contextualBar/Info/EditRoomInfo'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('RoomInfo', () => module.dynamicImport('./views/room/contextualBar/Info/RoomInfo'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('UserInfoWithData', () => module.dynamicImport('./views/room/contextualBar/UserInfo'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('channelFilesList', () => module.dynamicImport('./views/room/contextualBar/RoomFiles'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('RoomAnnouncement', () => module.dynamicImport('./views/room/Announcement'));
createTemplateForComponent('PruneMessages', () => module.dynamicImport('./views/room/contextualBar/PruneMessages'), {
  renderContainerView: () => HTML.DIV({
    class: 'contextual-bar'
  })
});
createTemplateForComponent('Burger', () => module.dynamicImport('./components/BurgerMenu'));
createTemplateForComponent('loginLayoutHeader', () => module.dynamicImport('./views/login/LoginLayout/Header'));
createTemplateForComponent('loginLayoutFooter', () => module.dynamicImport('./views/login/LoginLayout/Footer'));
createTemplateForComponent('ModalBlock', () => module.dynamicImport('./views/blocks/ConnectedModalBlock'), {
  renderContainerView: () => HTML.DIV({
    style: 'display: flex; width: 100%; height: 100%;'
  })
});
createTemplateForComponent('Blocks', () => module.dynamicImport('./views/blocks/MessageBlock'));
createTemplateForComponent('adminFlex', () => module.dynamicImport('./views/admin/sidebar/AdminSidebar'), {
  renderContainerView: () => HTML.DIV({
    style: 'height: 100%; position: relative;'
  })
});
createTemplateForComponent('accountFlex', () => module.dynamicImport('./views/account/AccountSidebar'), {
  renderContainerView: () => HTML.DIV({
    style: 'height: 100%; position: relative;'
  })
});
createTemplateForComponent('SortList', () => module.dynamicImport('./components/SortList'));
createTemplateForComponent('CreateRoomList', () => module.dynamicImport('./sidebar/header/actions/CreateRoomList'));
createTemplateForComponent('AppleOauthButton', () => module.dynamicImport('./views/login/AppleOauth/AppleOauthButton'), {
  renderContainerView: () => HTML.DIV({
    style: 'display: flex; justify-content: center;'
  })
});
createTemplateForComponent('UserDropdown', () => module.dynamicImport('./sidebar/header/UserDropdown'));
createTemplateForComponent('sidebarFooter', () => module.dynamicImport('./sidebar/footer'));
createTemplateForComponent('roomNotFound', () => module.dynamicImport('./views/room/Room/RoomNotFound'), {
  renderContainerView: () => HTML.DIV({
    style: 'height: 100%;'
  })
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"main.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/main.ts                                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../ee/client/ecdh");
module.link("./polyfills");
module.link("./lib/meteorCallWrapper");
module.link("./importPackages");
module.link("../ee/client");
module.link("./templateHelpers");
module.link("./methods/deleteMessage");
module.link("./methods/hideRoom");
module.link("./methods/openRoom");
module.link("./methods/setUserActiveStatus");
module.link("./methods/toggleFavorite");
module.link("./methods/updateMessage");
module.link("./startup");
module.link("./views/admin");
module.link("./views/teams");
module.link("./templates");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"imports":{"client":{"sodium-plus":{"lib":{"backend":{"libsodium-wrappers.js":"/node_modules/sodium-plus/lib/backend/libsodium-wrappers.js","sodiumnative.js":"/node_modules/sodium-plus/lib/backend/sodiumnative.js"},"keytypes":{"ed25519pk.js":"/node_modules/sodium-plus/lib/keytypes/ed25519pk.js","ed25519sk.js":"/node_modules/sodium-plus/lib/keytypes/ed25519sk.js","x25519pk.js":"/node_modules/sodium-plus/lib/keytypes/x25519pk.js","x25519sk.js":"/node_modules/sodium-plus/lib/keytypes/x25519sk.js"},"backend.js":"/node_modules/sodium-plus/lib/backend.js","cryptography-key.js":"/node_modules/sodium-plus/lib/cryptography-key.js","polyfill.js":"/node_modules/sodium-plus/lib/polyfill.js","sodium-error.js":"/node_modules/sodium-plus/lib/sodium-error.js","sodiumplus.js":"/node_modules/sodium-plus/lib/sodiumplus.js","util.js":"/node_modules/sodium-plus/lib/util.js"},"index.js":"/node_modules/sodium-plus/index.js"},"poly1305-js":{"lib":{"poly1305.js":"/node_modules/poly1305-js/lib/poly1305.js","util.js":"/node_modules/poly1305-js/lib/util.js"},"index.js":"/node_modules/poly1305-js/index.js"},"@rocket.chat":{"apps-engine":{"definition":{"uikit":{"blocks":{"BlockBuilder.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/blocks/BlockBuilder.js","Blocks.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/blocks/Blocks.js","Elements.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/blocks/Elements.js","Objects.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/blocks/Objects.js","index.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/blocks/index.js"},"livechat":{"IUIKitLivechatActionHandler.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/livechat/IUIKitLivechatActionHandler.js","IUIKitLivechatIncomingInteraction.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/livechat/IUIKitLivechatIncomingInteraction.js","UIKitLivechatIncomingInteractionType.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/livechat/UIKitLivechatIncomingInteractionType.js","UIKitLivechatInteractionContext.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/livechat/UIKitLivechatInteractionContext.js","index.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/livechat/index.js"},"IUIKitActionHandler.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/IUIKitActionHandler.js","IUIKitIncomingInteraction.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/IUIKitIncomingInteraction.js","IUIKitInteractionType.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/IUIKitInteractionType.js","IUIKitSurface.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/IUIKitSurface.js","UIKitIncomingInteractionContainer.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/UIKitIncomingInteractionContainer.js","UIKitInteractionContext.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/UIKitInteractionContext.js","UIKitInteractionPayloadFormatter.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/UIKitInteractionPayloadFormatter.js","UIKitInteractionResponder.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/UIKitInteractionResponder.js","index.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/index.js"},"metadata":{"AppInterface.js":"/node_modules/@rocket.chat/apps-engine/definition/metadata/AppInterface.js","AppMethod.js":"/node_modules/@rocket.chat/apps-engine/definition/metadata/AppMethod.js","RocketChatAssociations.js":"/node_modules/@rocket.chat/apps-engine/definition/metadata/RocketChatAssociations.js","index.js":"/node_modules/@rocket.chat/apps-engine/definition/metadata/index.js"},"ui":{"IUIActionButtonDescriptor.js":"/node_modules/@rocket.chat/apps-engine/definition/ui/IUIActionButtonDescriptor.js","UIActionButtonContext.js":"/node_modules/@rocket.chat/apps-engine/definition/ui/UIActionButtonContext.js","index.js":"/node_modules/@rocket.chat/apps-engine/definition/ui/index.js"},"AppStatus.js":"/node_modules/@rocket.chat/apps-engine/definition/AppStatus.js"},"client":{"constants":{"index.js":"/node_modules/@rocket.chat/apps-engine/client/constants/index.js"},"definition":{"AppsEngineUIMethods.js":"/node_modules/@rocket.chat/apps-engine/client/definition/AppsEngineUIMethods.js","IAppsEngineUIResponse.js":"/node_modules/@rocket.chat/apps-engine/client/definition/IAppsEngineUIResponse.js","IExternalComponentRoomInfo.js":"/node_modules/@rocket.chat/apps-engine/client/definition/IExternalComponentRoomInfo.js","IExternalComponentUserInfo.js":"/node_modules/@rocket.chat/apps-engine/client/definition/IExternalComponentUserInfo.js","index.js":"/node_modules/@rocket.chat/apps-engine/client/definition/index.js"},"AppClientManager.js":"/node_modules/@rocket.chat/apps-engine/client/AppClientManager.js","AppServerCommunicator.js":"/node_modules/@rocket.chat/apps-engine/client/AppServerCommunicator.js","AppsEngineUIHost.js":"/node_modules/@rocket.chat/apps-engine/client/AppsEngineUIHost.js"}}},"map-age-cleaner":{"dist":{"index.js":"/node_modules/map-age-cleaner/dist/index.js"}},"mem":{"dist":{"index.js":"/node_modules/mem/dist/index.js"}},"scheduler":{"cjs":{"scheduler-tracing.development.js":"/node_modules/scheduler/cjs/scheduler-tracing.development.js","scheduler-tracing.production.min.js":"/node_modules/scheduler/cjs/scheduler-tracing.production.min.js","scheduler.development.js":"/node_modules/scheduler/cjs/scheduler.development.js","scheduler.production.min.js":"/node_modules/scheduler/cjs/scheduler.production.min.js"},"index.js":"/node_modules/scheduler/index.js","tracing.js":"/node_modules/scheduler/tracing.js"},"mimic-fn":{"index.js":"/node_modules/mem/node_modules/mimic-fn/index.js"},"p-defer":{"index.js":"/node_modules/p-defer/index.js"},"sodium-native":{"index.js":"/node_modules/sodium-native/index.js"}}},"lib":{"utils":{"isJSON.ts":[]},"callbacks.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// lib/callbacks.ts                                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  callbacks: () => callbacks
});
let Meteor;
module.link("meteor/meteor", {
  Meteor(v) {
    Meteor = v;
  }

}, 0);
let getRandomId;
module.link("./random", {
  getRandomId(v) {
    getRandomId = v;
  }

}, 1);
var CallbackPriority;

(function (CallbackPriority) {
  CallbackPriority[CallbackPriority["HIGH"] = -1000] = "HIGH";
  CallbackPriority[CallbackPriority["MEDIUM"] = 0] = "MEDIUM";
  CallbackPriority[CallbackPriority["LOW"] = 1000] = "LOW";
})(CallbackPriority || (CallbackPriority = {}));

class Callbacks {
  constructor() {
    this.logger = undefined;
    this.trackCallback = undefined;
    this.trackHook = undefined;
    this.callbacks = new Map();
    this.sequentialRunners = new Map();
    this.asyncRunners = new Map();
    this.priority = CallbackPriority;
  }

  setLogger(logger) {
    this.logger = logger;
  }

  setMetricsTrackers(_ref) {
    let {
      trackCallback,
      trackHook
    } = _ref;
    this.trackCallback = trackCallback;
    this.trackHook = trackHook;
  }

  runOne(callback, item, constant) {
    var _this$trackCallback;

    const stopTracking = (_this$trackCallback = this.trackCallback) === null || _this$trackCallback === void 0 ? void 0 : _this$trackCallback.call(this, callback);

    try {
      return callback(item, constant);
    } finally {
      stopTracking === null || stopTracking === void 0 ? void 0 : stopTracking();
    }
  }

  createSequentialRunner(hook, callbacks) {
    const wrapCallback = callback => (item, constant) => {
      var _this$logger, _this$runOne;

      (_this$logger = this.logger) === null || _this$logger === void 0 ? void 0 : _this$logger.debug("Executing callback with id ".concat(callback.id, " for hook ").concat(callback.hook));
      return (_this$runOne = this.runOne(callback, item, constant)) !== null && _this$runOne !== void 0 ? _this$runOne : item;
    };

    const identity = item => item;

    const pipe = (curr, next) => (item, constant) => next(curr(item, constant), constant);

    const fn = callbacks.map(wrapCallback).reduce(pipe, identity);
    return (item, constant) => {
      var _this$trackHook;

      const stopTracking = (_this$trackHook = this.trackHook) === null || _this$trackHook === void 0 ? void 0 : _this$trackHook.call(this, {
        hook,
        length: callbacks.length
      });

      try {
        return fn(item, constant);
      } finally {
        stopTracking === null || stopTracking === void 0 ? void 0 : stopTracking();
      }
    };
  }

  createAsyncRunner(_, callbacks) {
    return (item, constant) => {
      if (typeof window !== 'undefined') {
        throw new Error('callbacks.runAsync on client server not allowed');
      }

      for (const callback of callbacks) {
        Meteor.defer(() => {
          this.runOne(callback, item, constant);
        });
      }

      return item;
    };
  }

  getCallbacks(hook) {
    var _this$callbacks$get;

    return (_this$callbacks$get = this.callbacks.get(hook)) !== null && _this$callbacks$get !== void 0 ? _this$callbacks$get : [];
  }

  setCallbacks(hook, callbacks) {
    this.callbacks.set(hook, callbacks);
    this.sequentialRunners.set(hook, this.createSequentialRunner(hook, callbacks));
    this.asyncRunners.set(hook, this.createAsyncRunner(hook, callbacks));
  }

  add(hook, callback) {
    let priority = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.priority.MEDIUM;
    let id = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : getRandomId();
    const callbacks = this.getCallbacks(hook);

    if (callbacks.some(cb => cb.id === id)) {
      return;
    }

    callbacks.push(Object.assign(callback, {
      hook,
      priority,
      id,
      stack: new Error().stack
    }));

    const rank = callback => {
      var _callback$priority;

      return (_callback$priority = callback.priority) !== null && _callback$priority !== void 0 ? _callback$priority : this.priority.MEDIUM;
    };

    callbacks.sort((a, b) => rank(a) - rank(b));
    this.setCallbacks(hook, callbacks);
  }
  /**
   * Remove a callback from a hook
   *
   * @param hook the name of the hook
   * @param id the callback's id
   */


  remove(hook, id) {
    const hooks = this.getCallbacks(hook).filter(callback => callback.id !== id);
    this.setCallbacks(hook, hooks);
  }

  run(hook, item, constant) {
    var _this$sequentialRunne;

    const runner = (_this$sequentialRunne = this.sequentialRunners.get(hook)) !== null && _this$sequentialRunne !== void 0 ? _this$sequentialRunne : (item, _constant) => item;
    return runner(item, constant);
  }

  runAsync(hook, item, constant) {
    var _this$asyncRunners$ge;

    const runner = (_this$asyncRunners$ge = this.asyncRunners.get(hook)) !== null && _this$asyncRunners$ge !== void 0 ? _this$asyncRunners$ge : (item, _constant) => item;
    return runner(item, constant);
  }

}
/**
 * Callback hooks provide an easy way to add extra steps to common operations.
 * @deprecated
 */


const callbacks = new Callbacks();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emailValidator.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// lib/emailValidator.ts                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  validateEmail: () => validateEmail
});

const validateEmail = function (email) {
  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
    style: 'basic'
  };
  const basicEmailRegex = /^[^@]+@[^@]+$/;
  const rfcEmailRegex = /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;

  switch (options.style) {
    case 'rfc':
      return rfcEmailRegex.test(email);

    case 'basic':
    default:
      return basicEmailRegex.test(email);
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getImageExtensionFromMime.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// lib/getImageExtensionFromMime.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getImageExtensionFromMime: () => getImageExtensionFromMime
});
const extensionsMap = {
  'image/apng': 'apng',
  'image/avif': 'avif',
  'image/gif': 'gif',
  'image/jpeg': 'jpg',
  'image/png': 'png',
  'image/svg+xml': 'svg',
  'image/webp': 'webp',
  'image/bmp': 'bmp',
  'image/x-icon': 'ico',
  'image/tiff': 'tif'
};

const getImageExtensionFromMime = mime => extensionsMap[mime];
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getUserEmailAddress.ts":[],"random.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// lib/random.ts                                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getRandomId: () => getRandomId
});
let Random;
module.link("meteor/random", {
  Random(v) {
    Random = v;
  }

}, 0);

const getRandomId = length => Random.id(length);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"transforms.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// lib/transforms.ts                                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createTransformChain: () => createTransformChain,
  createAsyncTransformChain: () => createAsyncTransformChain
});

const createTransformChain = function () {
  for (var _len = arguments.length, transforms = new Array(_len), _key = 0; _key < _len; _key++) {
    transforms[_key] = arguments[_key];
  }

  let chain = transforms;

  const call = x => chain.reduce((x, transform) => transform(x), x);

  const use = transform => {
    chain.push(transform);
    return () => {
      chain = chain.filter(t => t !== transform);
    };
  };

  return Object.assign(call, {
    use
  });
};

const createAsyncTransformChain = function () {
  for (var _len2 = arguments.length, transforms = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
    transforms[_key2] = arguments[_key2];
  }

  let chain = transforms;

  const call = x => chain.reduce((x, transform) => x.then(transform), Promise.resolve(x));

  const use = transform => {
    chain.push(transform);
    return () => {
      chain = chain.filter(t => t !== transform);
    };
  };

  return Object.assign(call, {
    use
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"definition":{"IMessage":{"MessageAttachment":{"Files":{"AudioAttachmentProps.ts":[],"FileAttachmentProps.ts":[],"ImageAttachmentProps.ts":[],"VideoAttachmentProps.ts":[]},"MessageAttachmentAction.ts":[],"MessageQuoteAttachment.ts":[]}},"rest":{"v1":{"settings.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/rest/v1/settings.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isOauthCustomConfiguration: () => isOauthCustomConfiguration,
  isSettingsUpdatePropsActions: () => isSettingsUpdatePropsActions,
  isSettingsUpdatePropsColor: () => isSettingsUpdatePropsColor,
  isSettingsUpdatePropDefault: () => isSettingsUpdatePropDefault
});

const isOauthCustomConfiguration = config => Boolean(config);

const isSettingsUpdatePropsActions = props => 'execute' in props;

const isSettingsUpdatePropsColor = props => 'editor' in props && 'value' in props;

const isSettingsUpdatePropDefault = props => 'value' in props;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"IBanner.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/IBanner.ts                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  BannerPlatform: () => BannerPlatform,
  isInactiveBanner: () => isInactiveBanner
});
var BannerPlatform;

(function (BannerPlatform) {
  BannerPlatform["Web"] = "web";
  BannerPlatform["Mobile"] = "mobile";
})(BannerPlatform || module.runSetters(BannerPlatform = {}, ["BannerPlatform"]));

const isInactiveBanner = banner => banner.active === false;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ILivechatBusinessHour.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/ILivechatBusinessHour.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  LivechatBusinessHourTypes: () => LivechatBusinessHourTypes,
  LivechatBusinessHourBehaviors: () => LivechatBusinessHourBehaviors
});
var LivechatBusinessHourTypes;

(function (LivechatBusinessHourTypes) {
  LivechatBusinessHourTypes["DEFAULT"] = "default";
  LivechatBusinessHourTypes["CUSTOM"] = "custom";
})(LivechatBusinessHourTypes || module.runSetters(LivechatBusinessHourTypes = {}, ["LivechatBusinessHourTypes"]));

var LivechatBusinessHourBehaviors;

(function (LivechatBusinessHourBehaviors) {
  LivechatBusinessHourBehaviors["SINGLE"] = "Single";
  LivechatBusinessHourBehaviors["MULTIPLE"] = "Multiple";
})(LivechatBusinessHourBehaviors || module.runSetters(LivechatBusinessHourBehaviors = {}, ["LivechatBusinessHourBehaviors"]));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"IRoom.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/IRoom.ts                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isTeamRoom: () => isTeamRoom,
  isPrivateTeamRoom: () => isPrivateTeamRoom,
  isPublicTeamRoom: () => isPublicTeamRoom,
  isDiscussion: () => isDiscussion,
  isPrivateDiscussion: () => isPrivateDiscussion,
  isPublicDiscussion: () => isPublicDiscussion,
  isDirectMessageRoom: () => isDirectMessageRoom,
  isMultipleDirectMessageRoom: () => isMultipleDirectMessageRoom,
  OmnichannelSourceType: () => OmnichannelSourceType,
  isOmnichannelRoom: () => isOmnichannelRoom,
  isOmnichannelRoomFromAppSource: () => isOmnichannelRoomFromAppSource
});

const isTeamRoom = room => !!room.teamMain;

const isPrivateTeamRoom = room => isTeamRoom(room) && room.t === 'p';

const isPublicTeamRoom = room => isTeamRoom(room) && room.t === 'c';

const isDiscussion = room => !!room.prid;

const isPrivateDiscussion = room => isDiscussion(room) && room.t === 'p';

const isPublicDiscussion = room => isDiscussion(room) && room.t === 'c';

const isDirectMessageRoom = room => room.t === 'd';

const isMultipleDirectMessageRoom = room => isDirectMessageRoom(room) && room.uids.length > 2;

var OmnichannelSourceType;

(function (OmnichannelSourceType) {
  OmnichannelSourceType["WIDGET"] = "widget";
  OmnichannelSourceType["EMAIL"] = "email";
  OmnichannelSourceType["SMS"] = "sms";
  OmnichannelSourceType["APP"] = "app";
  OmnichannelSourceType["API"] = "api";
  OmnichannelSourceType["OTHER"] = "other";
})(OmnichannelSourceType || module.runSetters(OmnichannelSourceType = {}, ["OmnichannelSourceType"]));

const isOmnichannelRoom = room => room.t === 'l';

const isOmnichannelRoomFromAppSource = room => {
  var _room$source;

  if (!isOmnichannelRoom(room)) {
    return false;
  }

  return ((_room$source = room.source) === null || _room$source === void 0 ? void 0 : _room$source.type) === OmnichannelSourceType.APP;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ITeam.ts":[],"UIKit.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/UIKit.ts                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
let _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default(v) {
    _objectSpread = v;
  }

}, 0);
module.export({
  UIKitInteractionTypes: () => UIKitInteractionTypes,
  isErrorType: () => isErrorType
});
let UIKitInteractionTypeApi;
module.link("@rocket.chat/apps-engine/definition/uikit", {
  UIKitInteractionType(v) {
    UIKitInteractionTypeApi = v;
  }

}, 0);
var UIKitInteractionTypeExtended;

(function (UIKitInteractionTypeExtended) {
  UIKitInteractionTypeExtended["BANNER_OPEN"] = "banner.open";
  UIKitInteractionTypeExtended["BANNER_UPDATE"] = "banner.update";
  UIKitInteractionTypeExtended["BANNER_CLOSE"] = "banner.close";
})(UIKitInteractionTypeExtended || (UIKitInteractionTypeExtended = {}));

const UIKitInteractionTypes = _objectSpread(_objectSpread({}, UIKitInteractionTypeApi), UIKitInteractionTypeExtended);

const isErrorType = result => result.type === UIKitInteractionTypeApi.ERRORS;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserStatus.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/UserStatus.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  UserStatus: () => UserStatus
});
var UserStatus;

(function (UserStatus) {
  UserStatus["ONLINE"] = "online";
  UserStatus["AWAY"] = "away";
  UserStatus["OFFLINE"] = "offline";
  UserStatus["BUSY"] = "busy";
})(UserStatus || module.runSetters(UserStatus = {}, ["UserStatus"]));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},{
  "extensions": [
    ".js",
    ".json",
    ".html",
    ".ts",
    ".mjs",
    ".css",
    ".tsx",
    ".less",
    ".info"
  ]
});

var exports = require("/client/main.ts");