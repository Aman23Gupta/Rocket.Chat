{"version":3,"sources":["meteor://ðŸ’»app/app/webdav/client/startup/sync.js"],"names":["_regeneratorRuntime","module","link","default","v","Meteor","Tracker","APIClient","WebdavAccounts","Notifications","events","changed","account","upsert","_id","removed","remove","autorun","userId","v1","get","accounts","forEach","insert","onUser","type"],"mappings":";;;;;;;;AAAA,IAAIA,mBAAJ;;AAAwBC,MAAM,CAACC,IAAP,CAAY,4BAAZ,EAAyC;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,uBAAmB,GAACI,CAApB;AAAsB;AAA3C,CAAzC,EAAsF,CAAtF;AAAxB,IAAIC,MAAJ;AAAWJ,MAAM,CAACC,IAAP,CAAY,eAAZ,EAA4B;AAACG,QAAM,EAAC,UAASD,CAAT,EAAW;AAACC,UAAM,GAACD,CAAP;AAAS;AAA7B,CAA5B,EAA2D,CAA3D;AAA8D,IAAIE,OAAJ;AAAYL,MAAM,CAACC,IAAP,CAAY,gBAAZ,EAA6B;AAACI,SAAO,EAAC,UAASF,CAAT,EAAW;AAACE,WAAO,GAACF,CAAR;AAAU;AAA/B,CAA7B,EAA8D,CAA9D;AAAiE,IAAIG,SAAJ;AAAcN,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACK,WAAS,EAAC,UAASH,CAAT,EAAW;AAACG,aAAS,GAACH,CAAV;AAAY;AAAnC,CAApC,EAAyE,CAAzE;AAA4E,IAAII,cAAJ;AAAmBP,MAAM,CAACC,IAAP,CAAY,wBAAZ,EAAqC;AAACM,gBAAc,EAAC,UAASJ,CAAT,EAAW;AAACI,kBAAc,GAACJ,CAAf;AAAiB;AAA7C,CAArC,EAAoF,CAApF;AAAuF,IAAIK,aAAJ;AAAkBR,MAAM,CAACC,IAAP,CAAY,+BAAZ,EAA4C;AAACO,eAAa,EAAC,UAASL,CAAT,EAAW;AAACK,iBAAa,GAACL,CAAd;AAAgB;AAA3C,CAA5C,EAAyF,CAAzF;AAO5W,IAAMM,MAAM,GAAG;AACdC,SAAO,EAAE,UAACC,OAAD;AAAA,WAAaJ,cAAc,CAACK,MAAf,CAAsB;AAAEC,SAAG,EAAEF,OAAO,CAACE;AAAf,KAAtB,EAA4CF,OAA5C,CAAb;AAAA,GADK;AAEdG,SAAO,EAAE;AAAA,QAAGD,GAAH,QAAGA,GAAH;AAAA,WAAaN,cAAc,CAACQ,MAAf,CAAsB;AAAEF,SAAG,EAAHA;AAAF,KAAtB,CAAb;AAAA;AAFK,CAAf;AAKAR,OAAO,CAACW,OAAR;AAAgB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACVZ,MAAM,CAACa,MAAP,EADU;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,+CAIYX,SAAS,CAACY,EAAV,CAAaC,GAAb,CAAiB,sBAAjB,CAJZ;;AAAA;AAAA;AAIPC,sBAJO,yBAIPA,QAJO;AAKfA,sBAAQ,CAACC,OAAT,CAAiB,UAACV,OAAD;AAAA,uBAAaJ,cAAc,CAACe,MAAf,CAAsBX,OAAtB,CAAb;AAAA,eAAjB;AACAH,2BAAa,CAACe,MAAd,CAAqB,QAArB,EAA+B;AAAA,oBAAGC,IAAH,SAAGA,IAAH;AAAA,oBAASb,OAAT,SAASA,OAAT;AAAA,uBAAuBF,MAAM,CAACe,IAAD,CAAN,CAAab,OAAb,CAAvB;AAAA,eAA/B;;AANe;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAhB;AAAA,K","file":"dynamic/app/webdav/client/startup/sync.js","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Tracker } from 'meteor/tracker';\n\nimport { APIClient } from '../../../utils/client';\nimport { WebdavAccounts } from '../../../models/client';\nimport { Notifications } from '../../../notifications/client';\n\nconst events = {\n\tchanged: (account) => WebdavAccounts.upsert({ _id: account._id }, account),\n\tremoved: ({ _id }) => WebdavAccounts.remove({ _id }),\n};\n\nTracker.autorun(async () => {\n\tif (!Meteor.userId()) {\n\t\treturn;\n\t}\n\tconst { accounts } = await APIClient.v1.get('webdav.getMyAccounts');\n\taccounts.forEach((account) => WebdavAccounts.insert(account));\n\tNotifications.onUser('webdav', ({ type, account }) => events[type](account));\n});\n"]}