{"version":3,"sources":["meteor://ðŸ’»app/ee/client/audit/AuditPage.js"],"names":["_toConsumableArray","module","link","default","v","_slicedToArray","useMutableCallback","React","useRef","useState","useTranslation","useForm","AuditPageBase","initialValues","msg","type","dateRange","start","end","visitor","agent","rid","users","AuditPage","t","values","handlers","setData","errors","setErrors","startDate","endDate","handleMsg","handleType","handleVisitor","handleAgent","handleUsers","handleRid","handleDateRange","onChangeUsers","value","action","includes","filter","current","apply","length","Date","exportDefault"],"mappings":"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","file":"dynamic/ee/client/audit/AuditPage.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useRef, useState } from 'react';\n\nimport { useTranslation } from '../../../client/contexts/TranslationContext';\nimport { useForm } from '../../../client/hooks/useForm';\nimport { AuditPageBase } from './AuditPageBase';\n\nconst initialValues = {\n\tmsg: '',\n\ttype: '',\n\tdateRange: {\n\t\tstart: '',\n\t\tend: '',\n\t},\n\tvisitor: '',\n\tagent: 'all',\n\trid: '',\n\tusers: [],\n};\n\nconst AuditPage = () => {\n\tconst t = useTranslation();\n\n\tconst { values, handlers } = useForm(initialValues);\n\tconst setData = useRef(() => {});\n\n\tconst [errors, setErrors] = useState({});\n\n\tconst {\n\t\tmsg,\n\t\ttype,\n\t\tdateRange: { start: startDate, end: endDate },\n\t\tvisitor,\n\t\tagent,\n\t\tusers,\n\t\trid,\n\t} = values;\n\n\tconst { handleMsg, handleType, handleVisitor, handleAgent, handleUsers, handleRid, handleDateRange } = handlers;\n\n\tconst onChangeUsers = useMutableCallback((value, action) => {\n\t\tif (!action) {\n\t\t\tif (users.includes(value)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleUsers([...users, value]);\n\t\t}\n\t\thandleUsers(users.filter((current) => current !== value));\n\t});\n\n\tconst apply = useMutableCallback(() => {\n\t\tif (!rid && type === '') {\n\t\t\treturn setErrors({\n\t\t\t\trid: t('The_field_is_required', t('Channel_name')),\n\t\t\t});\n\t\t}\n\n\t\tif (users.length < 2 && type === 'd') {\n\t\t\treturn setErrors({\n\t\t\t\tusers: t('Select_at_least_two_users'),\n\t\t\t});\n\t\t}\n\n\t\tif (type === 'l') {\n\t\t\tconst errors = {};\n\n\t\t\tif (agent === '') {\n\t\t\t\terrors.agent = t('The_field_is_required', t('Agent'));\n\t\t\t}\n\n\t\t\tif (visitor === '') {\n\t\t\t\terrors.visitor = t('The_field_is_required', t('Visitor'));\n\t\t\t}\n\n\t\t\tif (errors.visitor || errors.agent) {\n\t\t\t\treturn setErrors(errors);\n\t\t\t}\n\t\t}\n\n\t\tsetErrors({});\n\n\t\tsetData.current({\n\t\t\tmsg,\n\t\t\ttype,\n\t\t\tstartDate: new Date(startDate),\n\t\t\tendDate: new Date(`${endDate}T23:59:00`),\n\t\t\tvisitor,\n\t\t\tagent,\n\t\t\tusers,\n\t\t\trid,\n\t\t});\n\t});\n\n\treturn (\n\t\t<AuditPageBase\n\t\t\ttype={type}\n\t\t\thandleType={handleType}\n\t\t\tmsg={msg}\n\t\t\thandleMsg={handleMsg}\n\t\t\thandleDateRange={handleDateRange}\n\t\t\terrors={errors}\n\t\t\trid={rid}\n\t\t\thandleRid={handleRid}\n\t\t\tusers={users}\n\t\t\thandleUsers={handleUsers}\n\t\t\tonChangeUsers={onChangeUsers}\n\t\t\tvisitor={visitor}\n\t\t\thandleVisitor={handleVisitor}\n\t\t\tagent={agent}\n\t\t\thandleAgent={handleAgent}\n\t\t\tapply={apply}\n\t\t\tsetData={setData}\n\t\t/>\n\t);\n};\n\nexport default AuditPage;\n"]}