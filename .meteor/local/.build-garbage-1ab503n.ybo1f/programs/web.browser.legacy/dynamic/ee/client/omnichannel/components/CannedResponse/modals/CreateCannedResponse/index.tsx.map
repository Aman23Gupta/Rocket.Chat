{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/components/CannedResponse/modals/CreateCannedResponse/index.tsx"],"names":[],"mappings":"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","file":"dynamic/ee/client/omnichannel/components/CannedResponse/modals/CreateCannedResponse/index.tsx","sourcesContent":["import React, { FC, memo, useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { usePermission } from '../../../../../../../client/contexts/AuthorizationContext';\nimport { useSetModal } from '../../../../../../../client/contexts/ModalContext';\nimport { useEndpoint } from '../../../../../../../client/contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../../../../../client/contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../../../../client/contexts/TranslationContext';\nimport { useForm } from '../../../../../../../client/hooks/useForm';\nimport CreateCannedResponseModal from './CreateCannedResponseModal';\n\nconst WrapCreateCannedResponseModal: FC<{ data?: any; reloadCannedList?: any }> = ({ data, reloadCannedList }) => {\n\tconst t = useTranslation();\n\tconst closeModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst saveCannedResponse = useEndpoint('POST', 'canned-responses');\n\n\tconst hasManagerPermission = usePermission('view-all-canned-responses');\n\tconst hasMonitorPermission = usePermission('save-department-canned-responses');\n\n\tconst form = useForm({\n\t\t_id: data ? data._id : '',\n\t\tshortcut: data ? data.shortcut : '',\n\t\ttext: data ? data.text : '',\n\t\ttags: data?.tags && Array.isArray(data.tags) ? data.tags.map((tag: string) => ({ label: tag, value: tag })) : [],\n\t\tscope: data ? data.scope : 'user',\n\t\tdepartmentId: data?.departmentId ? data.departmentId : '',\n\t});\n\n\tconst { values, handlers, hasUnsavedChanges } = form;\n\n\tconst [errors, setErrors] = useState<any>({});\n\tconst [radioDescription, setRadioDescription] = useState<string>(t('Canned_Response_Sharing_Private_Description'));\n\tconst [preview, setPreview] = useState(false);\n\n\tconst listErrors = useMemo(() => {\n\t\tconst empty: any = {};\n\n\t\tfor (const [key, value] of Object.entries(values)) {\n\t\t\tif (['shortcut', 'text'].includes(key) && !value) {\n\t\t\t\tempty[key] = t('Field_required');\n\t\t\t}\n\t\t}\n\n\t\tif (values.scope === 'department' && !values.departmentId) {\n\t\t\tempty.departmentId = t('Field_required');\n\t\t}\n\n\t\treturn empty;\n\t}, [t, values]);\n\n\tuseEffect(() => {\n\t\tsetErrors(listErrors);\n\t}, [values.shortcut, values.text, values.departmentId, listErrors]);\n\n\tconst radioHandlers = {\n\t\tsetPublic: (): void => {\n\t\t\thandlers.handleScope('global');\n\t\t\thandlers.handleDepartmentId('');\n\t\t\tsetRadioDescription(t('Canned_Response_Sharing_Public_Description'));\n\t\t},\n\t\tsetDepartment: (): void => {\n\t\t\thandlers.handleScope('department');\n\t\t\tsetRadioDescription(t('Canned_Response_Sharing_Department_Description'));\n\t\t},\n\t\tsetPrivate: (): void => {\n\t\t\thandlers.handleScope('user');\n\t\t\thandlers.handleDepartmentId('');\n\t\t\tsetRadioDescription(t('Canned_Response_Sharing_Private_Description'));\n\t\t},\n\t};\n\n\tconst onSave = useCallback(async (): Promise<void> => {\n\t\ttry {\n\t\t\tconst { _id, shortcut, text, scope, tags, departmentId } = values as {\n\t\t\t\t_id: string;\n\t\t\t\tshortcut: string;\n\t\t\t\ttext: string;\n\t\t\t\tscope: string;\n\t\t\t\ttags: any;\n\t\t\t\tdepartmentId: { value: string; label: string };\n\t\t\t};\n\t\t\tconst mappedTags = tags.map((tag: string | { value: string; label: string }) => (typeof tag === 'object' ? tag?.value : tag));\n\t\t\tawait saveCannedResponse({\n\t\t\t\t...(_id && { _id }),\n\t\t\t\tshortcut,\n\t\t\t\ttext,\n\t\t\t\tscope,\n\t\t\t\t...(tags.length > 0 && { tags: mappedTags }),\n\t\t\t\t...(departmentId && { departmentId: departmentId.value }),\n\t\t\t});\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'success',\n\t\t\t\tmessage: t(_id ? 'Canned_Response_Updated' : 'Canned_Response_Created'),\n\t\t\t});\n\t\t\tcloseModal(null);\n\t\t\treloadCannedList?.();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [values, saveCannedResponse, dispatchToastMessage, t, closeModal, reloadCannedList]);\n\n\tconst onPreview = (): void => {\n\t\tsetPreview(!preview);\n\t};\n\n\treturn (\n\t\t<CreateCannedResponseModal\n\t\t\tisManager={hasManagerPermission}\n\t\t\tisMonitor={hasMonitorPermission}\n\t\t\tvalues={values}\n\t\t\thandlers={handlers}\n\t\t\terrors={errors}\n\t\t\thasUnsavedChanges={hasUnsavedChanges}\n\t\t\tradioHandlers={radioHandlers}\n\t\t\tradioDescription={radioDescription}\n\t\t\tonClose={closeModal}\n\t\t\tonSave={onSave}\n\t\t\tonPreview={onPreview}\n\t\t\tpreviewState={preview}\n\t\t/>\n\t);\n};\n\nexport default memo(WrapCreateCannedResponseModal);\n"]}