{"version":3,"sources":["meteor://ğŸ’»app/client/hooks/useFileInput.js"],"names":["module","export","useFileInput","useMutableCallback","link","v","useRef","useEffect","onSetFile","fileType","fileField","ref","fileInput","document","createElement","setAttribute","body","appendChild","current","remove","handleFiles","formData","FormData","append","files","addEventListener","removeEventListener","onClick","click","reset","value"],"mappings":";;;;;;;;AAAAA,MAAM,CAACC,MAAP,CAAc;AAACC,cAAY,EAAC,YAAU;AAAC,WAAOA,YAAP;AAAoB;AAA7C,CAAd;AAA8D,IAAIC,kBAAJ;AAAuBH,MAAM,CAACI,IAAP,CAAY,6BAAZ,EAA0C;AAACD,oBAAkB,EAAC,UAASE,CAAT,EAAW;AAACF,sBAAkB,GAACE,CAAnB;AAAqB;AAArD,CAA1C,EAAiG,CAAjG;AAAoG,IAAIC,MAAJ,EAAWC,SAAX;AAAqBP,MAAM,CAACI,IAAP,CAAY,OAAZ,EAAoB;AAACE,QAAM,EAAC,UAASD,CAAT,EAAW;AAACC,UAAM,GAACD,CAAP;AAAS,GAA7B;AAA8BE,WAAS,EAAC,UAASF,CAAT,EAAW;AAACE,aAAS,GAACF,CAAV;AAAY;AAAhE,CAApB,EAAsF,CAAtF;;AAGvM,IAAMH,YAAY,GAAG,UAACM,SAAD,EAA0D;AAAA,MAA9CC,QAA8C,uEAAnC,SAAmC;AAAA,MAAxBC,SAAwB,uEAAZ,OAAY;AACrF,MAAMC,GAAG,GAAGL,MAAM,EAAlB;AAEAC,WAAS,CAAC,YAAM;AACf,QAAMK,SAAS,GAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAlB;AACAF,aAAS,CAACG,YAAV,CAAuB,MAAvB,EAA+B,MAA/B;AACAH,aAAS,CAACG,YAAV,CAAuB,OAAvB,EAAgC,eAAhC;AACAF,YAAQ,CAACG,IAAT,CAAcC,WAAd,CAA0BL,SAA1B;AACAD,OAAG,CAACO,OAAJ,GAAcN,SAAd;AAEA,WAAO,YAAM;AACZD,SAAG,CAACO,OAAJ,GAAc,IAAd;AACAN,eAAS,CAACO,MAAV;AACA,KAHD;AAIA,GAXQ,EAWN,EAXM,CAAT;AAaAZ,WAAS,CAAC,YAAM;AACf,QAAMK,SAAS,GAAGD,GAAG,CAACO,OAAtB;;AACA,QAAI,CAACN,SAAL,EAAgB;AACf;AACA;;AAEDA,aAAS,CAACG,YAAV,CAAuB,QAAvB,EAAiCN,QAAjC;AACA,GAPQ,EAON,CAACA,QAAD,CAPM,CAAT;AASAF,WAAS,CAAC,YAAM;AACf,QAAMK,SAAS,GAAGD,GAAG,CAACO,OAAtB;;AACA,QAAI,CAACN,SAAL,EAAgB;AACf;AACA;;AAED,QAAMQ,WAAW,GAAG,YAAM;AACzB,UAAMC,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,cAAQ,CAACE,MAAT,CAAgBb,SAAhB,EAA2BE,SAAS,CAACY,KAAV,CAAgB,CAAhB,CAA3B;AACAhB,eAAS,CAACI,SAAS,CAACY,KAAV,CAAgB,CAAhB,CAAD,EAAqBH,QAArB,CAAT;AACA,KAJD;;AAMAT,aAAS,CAACa,gBAAV,CAA2B,QAA3B,EAAqCL,WAArC,EAAkD,KAAlD;AAEA,WAAO,YAAM;AACZR,eAAS,CAACc,mBAAV,CAA8B,QAA9B,EAAwCN,WAAxC,EAAqD,KAArD;AACA,KAFD;AAGA,GAjBQ,EAiBN,CAACV,SAAD,EAAYD,QAAZ,EAAsBD,SAAtB,CAjBM,CAAT;AAmBA,MAAMmB,OAAO,GAAGxB,kBAAkB,CAAC;AAAA,WAAMQ,GAAG,CAACO,OAAJ,CAAYU,KAAZ,EAAN;AAAA,GAAD,CAAlC;AACA,MAAMC,KAAK,GAAG1B,kBAAkB,CAAC,YAAM;AACtCQ,OAAG,CAACO,OAAJ,CAAYY,KAAZ,GAAoB,EAApB;AACA,GAF+B,CAAhC;AAGA,SAAO,CAACH,OAAD,EAAUE,KAAV,CAAP;AACA,CAjDM,C","file":"dynamic/client/hooks/useFileInput.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useRef, useEffect } from 'react';\n\nexport const useFileInput = (onSetFile, fileType = 'image/*', fileField = 'image') => {\n\tconst ref = useRef();\n\n\tuseEffect(() => {\n\t\tconst fileInput = document.createElement('input');\n\t\tfileInput.setAttribute('type', 'file');\n\t\tfileInput.setAttribute('style', 'display: none');\n\t\tdocument.body.appendChild(fileInput);\n\t\tref.current = fileInput;\n\n\t\treturn () => {\n\t\t\tref.current = null;\n\t\t\tfileInput.remove();\n\t\t};\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst fileInput = ref.current;\n\t\tif (!fileInput) {\n\t\t\treturn;\n\t\t}\n\n\t\tfileInput.setAttribute('accept', fileType);\n\t}, [fileType]);\n\n\tuseEffect(() => {\n\t\tconst fileInput = ref.current;\n\t\tif (!fileInput) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleFiles = () => {\n\t\t\tconst formData = new FormData();\n\t\t\tformData.append(fileField, fileInput.files[0]);\n\t\t\tonSetFile(fileInput.files[0], formData);\n\t\t};\n\n\t\tfileInput.addEventListener('change', handleFiles, false);\n\n\t\treturn () => {\n\t\t\tfileInput.removeEventListener('change', handleFiles, false);\n\t\t};\n\t}, [fileField, fileType, onSetFile]);\n\n\tconst onClick = useMutableCallback(() => ref.current.click());\n\tconst reset = useMutableCallback(() => {\n\t\tref.current.value = '';\n\t});\n\treturn [onClick, reset];\n};\n"]}