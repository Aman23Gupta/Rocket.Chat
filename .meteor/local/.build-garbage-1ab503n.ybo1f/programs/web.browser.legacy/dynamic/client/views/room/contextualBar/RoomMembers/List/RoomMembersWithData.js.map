{"version":3,"sources":["meteor://ğŸ’»app/client/views/room/contextualBar/RoomMembers/List/RoomMembersWithData.js"],"names":["_slicedToArray","module","link","default","v","useMutableCallback","useDebouncedValue","useLocalStorage","React","useCallback","useMemo","useState","useAtLeastOnePermission","useUserRoom","useRecordList","AsyncStatePhase","useMembersList","useTabBarClose","UserInfoWithData","AddUsers","InviteUsers","RoomMembers","RoomMembersWithData","rid","state","setState","onClickClose","room","isTeam","teamMain","isDirect","t","type","setType","text","setText","debouncedText","limit","roomType","membersList","loadMoreItems","reload","phase","items","total","itemCount","canAddUsers","handleTextChange","event","currentTarget","value","viewUser","e","username","dataset","tab","createInvite","addUser","handleBack","LOADING","exportDefault"],"mappings":"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","file":"dynamic/client/views/room/contextualBar/RoomMembers/List/RoomMembersWithData.js","sourcesContent":["import { useMutableCallback, useDebouncedValue, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport React, { useCallback, useMemo, useState } from 'react';\n\nimport { useAtLeastOnePermission } from '../../../../../contexts/AuthorizationContext';\nimport { useUserRoom } from '../../../../../contexts/UserContext';\nimport { useRecordList } from '../../../../../hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../../hooks/useAsyncState';\nimport { useMembersList } from '../../../../hooks/useMembersList';\nimport { useTabBarClose } from '../../../providers/ToolboxProvider';\nimport UserInfoWithData from '../../UserInfo';\nimport AddUsers from '../AddUsers';\nimport InviteUsers from '../InviteUsers';\nimport RoomMembers from './RoomMembers';\n\nconst RoomMembersWithData = ({ rid }) => {\n\tconst [state, setState] = useState({});\n\tconst onClickClose = useTabBarClose();\n\tconst room = useUserRoom(rid);\n\tconst isTeam = room.teamMain;\n\tconst isDirect = room.t === 'd';\n\n\troom.type = room.t;\n\troom.rid = rid;\n\n\tconst [type, setType] = useLocalStorage('members-list-type', 'online');\n\tconst [text, setText] = useState('');\n\n\tconst debouncedText = useDebouncedValue(text, 800);\n\n\tconst { membersList, loadMoreItems, reload } = useMembersList(\n\t\tuseMemo(() => ({ rid, type, limit: 50, debouncedText, roomType: room.t }), [rid, type, debouncedText, room.t]),\n\t);\n\n\tconst { phase, items, itemCount: total } = useRecordList(membersList);\n\n\tconst canAddUsers = useAtLeastOnePermission(\n\t\tuseMemo(() => [room.t === 'p' ? 'add-user-to-any-p-room' : 'add-user-to-any-c-room', 'add-user-to-joined-room'], [room.t]),\n\t\trid,\n\t);\n\n\tconst handleTextChange = useCallback((event) => {\n\t\tsetText(event.currentTarget.value);\n\t}, []);\n\n\tconst viewUser = useMutableCallback((e) => {\n\t\tconst { username } = e.currentTarget.dataset;\n\t\tsetState({\n\t\t\ttab: 'UserInfo',\n\t\t\tusername,\n\t\t});\n\t});\n\n\tconst createInvite = useMutableCallback(() => {\n\t\tsetState({ tab: 'InviteUsers' });\n\t});\n\n\tconst addUser = useMutableCallback(() => {\n\t\tsetState({ tab: 'AddUsers' });\n\t});\n\n\tconst handleBack = useCallback(() => {\n\t\tsetState({});\n\t\treload();\n\t}, [setState, reload]);\n\n\tif (state.tab === 'UserInfo') {\n\t\treturn <UserInfoWithData rid={rid} onClickClose={onClickClose} onClickBack={handleBack} username={state.username} />;\n\t}\n\n\tif (state.tab === 'InviteUsers') {\n\t\treturn <InviteUsers onClickClose={onClickClose} rid={rid} onClickBack={handleBack} />;\n\t}\n\n\tif (state.tab === 'AddUsers') {\n\t\treturn <AddUsers onClickClose={onClickClose} rid={rid} onClickBack={handleBack} reload={reload} />;\n\t}\n\n\treturn (\n\t\t<RoomMembers\n\t\t\trid={rid}\n\t\t\tisTeam={isTeam}\n\t\t\tisDirect={isDirect}\n\t\t\tloading={phase === AsyncStatePhase.LOADING}\n\t\t\ttype={type}\n\t\t\ttext={text}\n\t\t\tsetType={setType}\n\t\t\tsetText={handleTextChange}\n\t\t\tmembers={items}\n\t\t\ttotal={total}\n\t\t\tonClickClose={onClickClose}\n\t\t\tonClickView={viewUser}\n\t\t\tonClickAdd={canAddUsers && addUser}\n\t\t\tonClickInvite={canAddUsers && createInvite}\n\t\t\tloadMoreItems={loadMoreItems}\n\t\t\treload={reload}\n\t\t/>\n\t);\n};\n\nexport default RoomMembersWithData;\n"]}