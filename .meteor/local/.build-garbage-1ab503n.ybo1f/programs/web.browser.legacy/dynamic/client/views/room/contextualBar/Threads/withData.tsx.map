{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Threads/withData.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/room/contextualBar/Threads/withData.tsx","sourcesContent":["import { useDebouncedValue, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { useUserId, useUserSubscription } from '../../../../contexts/UserContext';\nimport { useRecordList } from '../../../../hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { ThreadsListOptions } from '../../../../lib/lists/ThreadsList';\nimport { useUserRoom } from '../../hooks/useUserRoom';\nimport { useTabBarClose } from '../../providers/ToolboxProvider';\nimport { ThreadListProps } from './ThreadList';\nimport { useThreadsList } from './useThreadsList';\n\nconst subscriptionFields = { tunread: true, tunreadUser: true, tunreadGroup: true };\nconst roomFields = { t: 1, name: 1 };\n\nexport function withData(Component: FC<ThreadListProps>): FC<{ rid: string }> {\n\tconst WrappedComponent: FC<{ rid: string }> = ({ rid, ...props }) => {\n\t\tconst userId = useUserId();\n\t\tconst onClose = useTabBarClose();\n\t\tconst room = useUserRoom(rid, roomFields);\n\t\tconst subscription = useUserSubscription(rid, subscriptionFields);\n\n\t\tconst [type, setType] = useLocalStorage<'all' | 'following' | 'unread'>('thread-list-type', 'all');\n\n\t\tconst [text, setText] = useState('');\n\t\tconst debouncedText = useDebouncedValue(text, 400);\n\t\tconst options: ThreadsListOptions = useDebouncedValue(\n\t\t\tuseMemo(() => {\n\t\t\t\tif (type === 'all' || !subscription || !userId) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\trid,\n\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\ttype: 'all',\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase 'following':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trid,\n\t\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\tuid: userId,\n\t\t\t\t\t\t};\n\t\t\t\t\tcase 'unread':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trid,\n\t\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\ttunread: subscription?.tunread,\n\t\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t\t}, [rid, debouncedText, type, subscription?.tunread?.sort().join(), userId]),\n\t\t\t300,\n\t\t);\n\n\t\tconst { threadsList, loadMoreItems } = useThreadsList(options, userId as string);\n\t\tconst { phase, error, items: threads, itemCount: totalItemCount } = useRecordList(threadsList);\n\n\t\tconst handleTextChange = useCallback((event) => {\n\t\t\tsetText(event.currentTarget.value);\n\t\t}, []);\n\n\t\treturn (\n\t\t\t<Component\n\t\t\t\t{...props}\n\t\t\t\tunread={subscription?.tunread}\n\t\t\t\tunreadUser={subscription?.tunreadUser}\n\t\t\t\tunreadGroup={subscription?.tunreadGroup}\n\t\t\t\tuserId={userId}\n\t\t\t\terror={error}\n\t\t\t\tthreads={threads}\n\t\t\t\ttotal={totalItemCount}\n\t\t\t\tloading={phase === AsyncStatePhase.LOADING}\n\t\t\t\tloadMoreItems={loadMoreItems}\n\t\t\t\troom={room}\n\t\t\t\ttext={text}\n\t\t\t\tsetText={handleTextChange}\n\t\t\t\ttype={type}\n\t\t\t\tsetType={setType as any}\n\t\t\t\tonClose={onClose as any}\n\t\t\t/>\n\t\t);\n\t};\n\n\tWrappedComponent.displayName = `withData(${Component.displayName ?? Component.name ?? 'Component'})`;\n\n\treturn WrappedComponent;\n}\n"]}