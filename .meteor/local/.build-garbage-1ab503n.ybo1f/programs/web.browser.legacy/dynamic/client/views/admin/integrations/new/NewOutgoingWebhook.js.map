{"version":3,"sources":["meteor://ğŸ’»app/client/views/admin/integrations/new/NewOutgoingWebhook.js"],"names":["_regeneratorRuntime","module","link","default","v","_extends","_objectSpread","_objectWithoutProperties","export","NewOutgoingWebhook","Field","Button","useUniqueId","React","useMemo","useCallback","useRoute","useTranslation","useEndpointAction","useForm","OutgoingWebhookForm","triggerWordsToArray","defaultData","type","enabled","impersonateUser","event","urls","triggerWords","targetRoom","channel","username","name","alias","avatar","emoji","scriptEnabled","script","retryFailedCalls","retryCount","retryDelay","triggerWordAnywhere","runOnEdits","data","onChange","setSaveAction","props","t","router","token","formValues","values","formHandlers","handlers","params","split","saveIntegration","handleSave","result","success","push","id","integration","_id","context","saveButton"],"mappings":"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","file":"dynamic/client/views/admin/integrations/new/NewOutgoingWebhook.js","sourcesContent":["import { Field, Button } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo, useCallback } from 'react';\n\nimport { useRoute } from '../../../../contexts/RouterContext';\nimport { useTranslation } from '../../../../contexts/TranslationContext';\nimport { useEndpointAction } from '../../../../hooks/useEndpointAction';\nimport { useForm } from '../../../../hooks/useForm';\nimport OutgoingWebhookForm from '../OutgoiongWebhookForm';\nimport { triggerWordsToArray } from '../helpers/triggerWords';\n\nconst defaultData = {\n\ttype: 'webhook-outgoing',\n\tenabled: true,\n\timpersonateUser: false,\n\tevent: 'sendMessage',\n\turls: '',\n\ttriggerWords: '',\n\ttargetRoom: '',\n\tchannel: '',\n\tusername: '',\n\tname: '',\n\talias: '',\n\tavatar: '',\n\temoji: '',\n\tscriptEnabled: false,\n\tscript: '',\n\tretryFailedCalls: true,\n\tretryCount: 6,\n\tretryDelay: 'powers-of-ten',\n\ttriggerWordAnywhere: false,\n\trunOnEdits: true,\n};\n\nexport default function NewOutgoingWebhook({ data = defaultData, onChange, setSaveAction, ...props }) {\n\tconst t = useTranslation();\n\tconst router = useRoute('admin-integrations');\n\n\tconst { values: formValues, handlers: formHandlers } = useForm({ ...data, token: useUniqueId() });\n\n\tconst { urls, triggerWords } = formValues;\n\n\tconst params = useMemo(\n\t\t() => ({\n\t\t\t...formValues,\n\t\t\turls: urls.split('\\n'),\n\t\t\ttriggerWords: triggerWordsToArray(triggerWords),\n\t\t}),\n\t\t[formValues, triggerWords, urls],\n\t);\n\tconst saveIntegration = useEndpointAction('POST', 'integrations.create', params, t('Integration_added'));\n\n\tconst handleSave = useCallback(async () => {\n\t\tconst result = await saveIntegration();\n\t\tif (result.success) {\n\t\t\trouter.push({ id: result.integration._id, context: 'edit', type: 'outgoing' });\n\t\t}\n\t}, [saveIntegration, router]);\n\n\tconst saveButton = useMemo(\n\t\t() => (\n\t\t\t<Field>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<Button w='full' mie='none' flexGrow={1} onClick={handleSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Field.Row>\n\t\t\t</Field>\n\t\t),\n\t\t[handleSave, t],\n\t);\n\n\treturn <OutgoingWebhookForm formValues={formValues} formHandlers={formHandlers} append={saveButton} {...props} />;\n}\n"]}