{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Call/BBB/D.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/room/contextualBar/Call/BBB/D.tsx","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { FC, useEffect } from 'react';\n\nimport { popout } from '../../../../../../app/ui-utils/client';\nimport { IRoom } from '../../../../../../definition/IRoom';\nimport { usePermission } from '../../../../../contexts/AuthorizationContext';\nimport { useMethod } from '../../../../../contexts/ServerContext';\nimport { useSetting } from '../../../../../contexts/SettingsContext';\nimport { useRoom } from '../../../contexts/RoomContext';\nimport { useTabBarClose } from '../../../providers/ToolboxProvider';\nimport CallBBB from './CallBBB';\n\ntype DProps = {\n\trid: IRoom['_id'];\n};\n\nconst D: FC<DProps> = ({ rid }) => {\n\tconst handleClose = useTabBarClose();\n\tconst openNewWindow = !!useSetting('bigbluebutton_Open_New_Window');\n\tconst hasCallManagement = usePermission('call-management', rid);\n\tconst room = useRoom();\n\tconst join = useMethod('bbbJoin');\n\tconst end = useMethod('bbbEnd');\n\n\tconst endCall = useMutableCallback(() => {\n\t\tend({ rid });\n\t});\n\n\tconst startCall = useMutableCallback(async () => {\n\t\tconst result = await join({ rid });\n\t\tif (!result) {\n\t\t\treturn;\n\t\t}\n\t\tif (openNewWindow) {\n\t\t\treturn window.open(result.url);\n\t\t}\n\t\tpopout.open({\n\t\t\tcontent: 'bbbLiveView',\n\t\t\tdata: {\n\t\t\t\tsource: result.url,\n\t\t\t\tstreamingOptions: result,\n\t\t\t\tcanOpenExternal: true,\n\t\t\t\tshowVideoControls: false,\n\t\t\t},\n\t\t\tonCloseCallback: () => false,\n\t\t});\n\t});\n\n\tuseEffect(() => {\n\t\tif (room?.streamingOptions?.type !== 'call' || openNewWindow || popout.context) {\n\t\t\treturn;\n\t\t}\n\t\tstartCall();\n\t\treturn (): void => {\n\t\t\tpopout.close();\n\t\t};\n\t}, [room?.streamingOptions?.type, startCall, openNewWindow]);\n\n\tconst canManageCall = room?.t === 'd' || hasCallManagement;\n\n\treturn (\n\t\t<CallBBB\n\t\t\thandleClose={handleClose as () => void}\n\t\t\topenNewWindow={openNewWindow}\n\t\t\tlive={room?.streamingOptions?.type === 'call'}\n\t\t\tendCall={endCall}\n\t\t\tstartCall={startCall}\n\t\t\tcanManageCall={canManageCall}\n\t\t/>\n\t);\n};\n\nexport default D;\n"]}