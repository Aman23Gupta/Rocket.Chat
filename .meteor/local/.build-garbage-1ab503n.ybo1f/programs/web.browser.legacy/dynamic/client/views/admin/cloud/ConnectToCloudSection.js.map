{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/cloud/ConnectToCloudSection.js"],"names":["_regeneratorRuntime","module","link","default","v","_extends","_slicedToArray","_objectWithoutProperties","Box","Button","ButtonGroup","Throbber","Callout","useSafely","React","useState","Subtitle","useMethod","useSetting","useToastMessageDispatch","useTranslation","ConnectToCloudSection","onRegisterStatusChange","props","t","dispatchToastMessage","isConnecting","setConnecting","registerWorkspace","syncWorkspace","hasAcceptedTerms","handleRegisterButtonClick","isRegistered","Error","isSynced","type","message","exportDefault"],"mappings":";;;;;;;;;;AAAA,IAAIA,mBAAJ;;AAAwBC,MAAM,CAACC,IAAP,CAAY,4BAAZ,EAAyC;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,uBAAmB,GAACI,CAApB;AAAsB;AAA3C,CAAzC,EAAsF,CAAtF;;AAAyF,IAAIC,QAAJ;;AAAaJ,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACC,YAAQ,GAACD,CAAT;AAAW;AAAhC,CAA7C,EAA+E,CAA/E;;AAAkF,IAAIE,cAAJ;;AAAmBL,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACE,kBAAc,GAACF,CAAf;AAAiB;AAAtC,CAAnD,EAA2F,CAA3F;;AAA8F,IAAIG,wBAAJ;;AAA6BN,MAAM,CAACC,IAAP,CAAY,gDAAZ,EAA6D;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACG,4BAAwB,GAACH,CAAzB;AAA2B;AAAhD,CAA7D,EAA+G,CAA/G;AAA9V,IAAII,GAAJ,EAAQC,MAAR,EAAeC,WAAf,EAA2BC,QAA3B,EAAoCC,OAApC;AAA4CX,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACM,KAAG,EAAC,UAASJ,CAAT,EAAW;AAACI,OAAG,GAACJ,CAAJ;AAAM,GAAvB;AAAwBK,QAAM,EAAC,UAASL,CAAT,EAAW;AAACK,UAAM,GAACL,CAAP;AAAS,GAApD;AAAqDM,aAAW,EAAC,UAASN,CAAT,EAAW;AAACM,eAAW,GAACN,CAAZ;AAAc,GAA3F;AAA4FO,UAAQ,EAAC,UAASP,CAAT,EAAW;AAACO,YAAQ,GAACP,CAAT;AAAW,GAA5H;AAA6HQ,SAAO,EAAC,UAASR,CAAT,EAAW;AAACQ,WAAO,GAACR,CAAR;AAAU;AAA3J,CAApC,EAAiM,CAAjM;AAAoM,IAAIS,SAAJ;AAAcZ,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACW,WAAS,EAAC,UAAST,CAAT,EAAW;AAACS,aAAS,GAACT,CAAV;AAAY;AAAnC,CAA1C,EAA+E,CAA/E;AAAkF,IAAIU,KAAJ,EAAUC,QAAV;AAAmBd,MAAM,CAACC,IAAP,CAAY,OAAZ,EAAoB;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACU,SAAK,GAACV,CAAN;AAAQ,GAA7B;AAA8BW,UAAQ,EAAC,UAASX,CAAT,EAAW;AAACW,YAAQ,GAACX,CAAT;AAAW;AAA9D,CAApB,EAAoF,CAApF;AAAuF,IAAIY,QAAJ;AAAaf,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACY,YAAQ,GAACZ,CAAT;AAAW;AAAhC,CAA3C,EAA6E,CAA7E;AAAgF,IAAIa,SAAJ;AAAchB,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAACe,WAAS,EAAC,UAASb,CAAT,EAAW;AAACa,aAAS,GAACb,CAAV;AAAY;AAAnC,CAA9C,EAAmF,CAAnF;AAAsF,IAAIc,UAAJ;AAAejB,MAAM,CAACC,IAAP,CAAY,mCAAZ,EAAgD;AAACgB,YAAU,EAAC,UAASd,CAAT,EAAW;AAACc,cAAU,GAACd,CAAX;AAAa;AAArC,CAAhD,EAAuF,CAAvF;AAA0F,IAAIe,uBAAJ;AAA4BlB,MAAM,CAACC,IAAP,CAAY,wCAAZ,EAAqD;AAACiB,yBAAuB,EAAC,UAASf,CAAT,EAAW;AAACe,2BAAuB,GAACf,CAAxB;AAA0B;AAA/D,CAArD,EAAsH,CAAtH;AAAyH,IAAIgB,cAAJ;AAAmBnB,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACkB,gBAAc,EAAC,UAAShB,CAAT,EAAW;AAACgB,kBAAc,GAAChB,CAAf;AAAiB;AAA7C,CAAnD,EAAkG,CAAlG;;AAU54B,SAASiB,qBAAT,OAAqE;AAAA,MAApCC,sBAAoC,QAApCA,sBAAoC;AAAA,MAATC,KAAS;;AACpE,MAAMC,CAAC,GAAGJ,cAAc,EAAxB;AACA,MAAMK,oBAAoB,GAAGN,uBAAuB,EAApD;;AAEA,mBAAsCN,SAAS,CAACE,QAAQ,CAAC,KAAD,CAAT,CAA/C;AAAA;AAAA,MAAOW,YAAP;AAAA,MAAqBC,aAArB;;AAEA,MAAMC,iBAAiB,GAAGX,SAAS,CAAC,yBAAD,CAAnC;AACA,MAAMY,aAAa,GAAGZ,SAAS,CAAC,qBAAD,CAA/B;AACA,MAAMa,gBAAgB,GAAGZ,UAAU,CAAC,kCAAD,CAAnC;;AAEA,MAAMa,yBAAyB;AAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACjCJ,6BAAa,CAAC,IAAD,CAAb;AADiC;AAAA;AAAA,iDAILC,iBAAiB,EAJZ;;AAAA;AAI1BI,4BAJ0B;;AAAA,oBAM3BA,YAN2B;AAAA;AAAA;AAAA;;AAAA,sBAOzBC,KAAK,CAACT,CAAC,CAAC,kBAAD,CAAF,CAPoB;;AAAA;AAAA;AAAA,iDAUTK,aAAa,EAVJ;;AAAA;AAU1BK,wBAV0B;;AAAA,oBAY3BA,QAZ2B;AAAA;AAAA;AAAA;;AAAA,sBAazBD,KAAK,CAACT,CAAC,CAAC,0BAAD,CAAF,CAboB;;AAAA;AAgBhCC,oCAAoB,CAAC;AAAEU,sBAAI,EAAE,SAAR;AAAmBC,yBAAO,EAAEZ,CAAC,CAAC,eAAD;AAA7B,iBAAD,CAApB;AAhBgC;AAAA;;AAAA;AAAA;AAAA;AAkBhCC,oCAAoB,CAAC;AAAEU,sBAAI,EAAE,OAAR;AAAiBC,yBAAO;AAAxB,iBAAD,CAApB;;AAlBgC;AAAA;AAAA;AAAA,iDAoBzBd,sBAAsB,IAAIA,sBAAsB,EApBvB;;AAAA;AAqBhCK,6BAAa,CAAC,KAAD,CAAb;AArBgC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAH;AAAA,KAA/B;;AAyBA,sBACC,oBAAC,GAAD;AAAK,MAAE,EAAC;AAAR,KAAsBJ,KAAtB,gBACC,oBAAC,QAAD,QAAWC,CAAC,CAAC,6BAAD,CAAZ,CADD,eAEC,oBAAC,GAAD;AAAK,mBAAe,MAApB;AAAqB,SAAK,EAAC;AAA3B,kBACC,+BAAIA,CAAC,CAAC,yCAAD,CAAL,CADD,CAFD,eAKC,oBAAC,WAAD,qBACC,oBAAC,MAAD;AAAQ,WAAO,MAAf;AAAgB,YAAQ,EAAEE,YAAY,IAAI,CAACI,gBAA3C;AAA6D,aAAS,EAAC,KAAvE;AAA6E,WAAO,EAAEC;AAAtF,KACEL,YAAY,gBAAG,oBAAC,QAAD;AAAU,MAAE,EAAC,MAAb;AAAoB,gBAAY;AAAhC,IAAH,GAAyCF,CAAC,CAAC,uCAAD,CADxD,CADD,CALD,EAUE,CAACM,gBAAD,iBACA,oBAAC,GAAD;AAAK,MAAE,EAAC;AAAR,kBACC,oBAAC,OAAD;AAAS,QAAI,EAAC;AAAd,KAAyBN,CAAC,CAAC,yDAAD,CAA1B,CADD,CAXF,CADD;AAkBA;;AA/DDvB,MAAM,CAACoC,aAAP,CAiEehB,qBAjEf,E","file":"dynamic/client/views/admin/cloud/ConnectToCloudSection.js","sourcesContent":["import { Box, Button, ButtonGroup, Throbber, Callout } from '@rocket.chat/fuselage';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport React, { useState } from 'react';\n\nimport Subtitle from '../../../components/Subtitle';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useSetting } from '../../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\n\nfunction ConnectToCloudSection({ onRegisterStatusChange, ...props }) {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [isConnecting, setConnecting] = useSafely(useState(false));\n\n\tconst registerWorkspace = useMethod('cloud:registerWorkspace');\n\tconst syncWorkspace = useMethod('cloud:syncWorkspace');\n\tconst hasAcceptedTerms = useSetting('Cloud_Service_Agree_PrivacyTerms');\n\n\tconst handleRegisterButtonClick = async () => {\n\t\tsetConnecting(true);\n\n\t\ttry {\n\t\t\tconst isRegistered = await registerWorkspace();\n\n\t\t\tif (!isRegistered) {\n\t\t\t\tthrow Error(t('An error occured'));\n\t\t\t}\n\n\t\t\tconst isSynced = await syncWorkspace();\n\n\t\t\tif (!isSynced) {\n\t\t\t\tthrow Error(t('An error occured syncing'));\n\t\t\t}\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Sync Complete') });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t} finally {\n\t\t\tawait (onRegisterStatusChange && onRegisterStatusChange());\n\t\t\tsetConnecting(false);\n\t\t}\n\t};\n\n\treturn (\n\t\t<Box is='section' {...props}>\n\t\t\t<Subtitle>{t('Cloud_registration_required')}</Subtitle>\n\t\t\t<Box withRichContent color='neutral-800'>\n\t\t\t\t<p>{t('Cloud_registration_required_description')}</p>\n\t\t\t</Box>\n\t\t\t<ButtonGroup>\n\t\t\t\t<Button primary disabled={isConnecting || !hasAcceptedTerms} minHeight='x40' onClick={handleRegisterButtonClick}>\n\t\t\t\t\t{isConnecting ? <Throbber is='span' inheritColor /> : t('Cloud_registration_required_link_text')}\n\t\t\t\t</Button>\n\t\t\t</ButtonGroup>\n\t\t\t{!hasAcceptedTerms && (\n\t\t\t\t<Box mb='x12'>\n\t\t\t\t\t<Callout type='warning'>{t('Cloud_Service_Agree_PrivacyTerms_Login_Disabled_Warning')}</Callout>\n\t\t\t\t</Box>\n\t\t\t)}\n\t\t</Box>\n\t);\n}\n\nexport default ConnectToCloudSection;\n"]}