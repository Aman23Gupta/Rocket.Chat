{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/triggers/NewTriggerPage.js"],"names":["_regeneratorRuntime","module","link","default","v","_objectSpread","_objectWithoutProperties","Button","FieldGroup","Box","Margins","useMutableCallback","React","useMemo","useRoute","useMethod","useToastMessageDispatch","useTranslation","useForm","TriggersForm","NewTriggerPage","onSave","dispatchToastMessage","t","router","save","name","description","enabled","runOnce","conditions","value","actions","params","sender","msg","values","handlers","handleSave","restValues","type","message","push","canSave","exportDefault"],"mappings":"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","file":"dynamic/client/views/omnichannel/triggers/NewTriggerPage.js","sourcesContent":["import { Button, FieldGroup, Box, Margins } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo } from 'react';\n\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useForm } from '../../../hooks/useForm';\nimport TriggersForm from './TriggersForm';\n\nconst NewTriggerPage = ({ onSave }) => {\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst router = useRoute('omnichannel-triggers');\n\n\tconst save = useMethod('livechat:saveTrigger');\n\n\tconst { values, handlers } = useForm({\n\t\tname: '',\n\t\tdescription: '',\n\t\tenabled: true,\n\t\trunOnce: false,\n\t\tconditions: {\n\t\t\tname: 'page-url',\n\t\t\tvalue: '',\n\t\t},\n\t\tactions: {\n\t\t\tname: '',\n\t\t\tparams: {\n\t\t\t\tsender: 'queue',\n\t\t\t\tmsg: '',\n\t\t\t\tname: '',\n\t\t\t},\n\t\t},\n\t});\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tconst {\n\t\t\t\tactions: {\n\t\t\t\t\tparams: { sender, msg, name },\n\t\t\t\t},\n\t\t\t\t...restValues\n\t\t\t} = values;\n\t\t\tawait save({\n\t\t\t\t...restValues,\n\t\t\t\tconditions: [values.conditions],\n\t\t\t\tactions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'send-message',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tsender,\n\t\t\t\t\t\t\tmsg,\n\t\t\t\t\t\t\t...(sender === 'custom' && { name }),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\tonSave();\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst {\n\t\tname,\n\t\tactions: {\n\t\t\tparams: { msg },\n\t\t},\n\t} = values;\n\n\tconst canSave = useMemo(() => name && msg, [name, msg]);\n\n\treturn (\n\t\t<>\n\t\t\t<FieldGroup>\n\t\t\t\t<TriggersForm values={values} handlers={handlers} />\n\t\t\t</FieldGroup>\n\t\t\t<Box display='flex' flexDirection='row' justifyContent='space-between' w='full'>\n\t\t\t\t<Margins inlineEnd='x4'>\n\t\t\t\t\t<Button flexGrow={1} primary onClick={handleSave} disabled={!canSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Margins>\n\t\t\t</Box>\n\t\t</>\n\t);\n};\n\nexport default NewTriggerPage;\n"]}