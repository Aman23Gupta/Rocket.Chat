{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/permissions/PermissionRow.js"],"names":["_extends","module","link","default","v","_slicedToArray","_objectWithoutProperties","_regeneratorRuntime","Table","useMutableCallback","React","useState","memo","CONSTANTS","useToastMessageDispatch","RoleCell","useChangeRole","onGrant","onRemove","permissionId","dispatchToastMessage","roleId","granted","type","message","getName","t","permission","level","SETTINGS_LEVEL","path","group","section","settingId","_id","PermissionRow","roleList","props","roles","hovered","setHovered","onMouseEnter","onMouseLeave","changeRole","map","name","description","exportDefault"],"mappings":"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","file":"dynamic/client/views/admin/permissions/PermissionRow.js","sourcesContent":["import { Table } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, memo } from 'react';\n\nimport { CONSTANTS } from '../../../../app/authorization/lib';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport RoleCell from './RoleCell';\n\nconst useChangeRole = ({ onGrant, onRemove, permissionId }) => {\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\treturn useMutableCallback(async (roleId, granted) => {\n\t\ttry {\n\t\t\tif (granted) {\n\t\t\t\tawait onRemove(permissionId, roleId);\n\t\t\t} else {\n\t\t\t\tawait onGrant(permissionId, roleId);\n\t\t\t}\n\t\t\treturn !granted;\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t\treturn granted;\n\t});\n};\n\nconst getName = (t, permission) => {\n\tif (permission.level === CONSTANTS.SETTINGS_LEVEL) {\n\t\tlet path = '';\n\t\tif (permission.group) {\n\t\t\tpath = `${t(permission.group)} > `;\n\t\t}\n\t\tif (permission.section) {\n\t\t\tpath = `${path}${t(permission.section)} > `;\n\t\t}\n\t\treturn `${path}${t(permission.settingId)}`;\n\t}\n\n\treturn t(permission._id);\n};\n\nconst PermissionRow = ({ permission, t, roleList, onGrant, onRemove, ...props }) => {\n\tconst { _id, roles } = permission;\n\n\tconst [hovered, setHovered] = useState(false);\n\n\tconst onMouseEnter = useMutableCallback(() => setHovered(true));\n\tconst onMouseLeave = useMutableCallback(() => setHovered(false));\n\n\tconst changeRole = useChangeRole({ onGrant, onRemove, permissionId: _id });\n\treturn (\n\t\t<Table.Row key={_id} role='link' action tabIndex={0} onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave} {...props}>\n\t\t\t<Table.Cell maxWidth='x300' withTruncatedText title={t(`${_id}_description`)}>\n\t\t\t\t{getName(t, permission)}\n\t\t\t</Table.Cell>\n\t\t\t{roleList.map(({ _id, name, description }) => (\n\t\t\t\t<RoleCell\n\t\t\t\t\tkey={_id}\n\t\t\t\t\t_id={_id}\n\t\t\t\t\tname={name}\n\t\t\t\t\tdescription={description}\n\t\t\t\t\tgrantedRoles={roles}\n\t\t\t\t\tonChange={changeRole}\n\t\t\t\t\tlineHovered={hovered}\n\t\t\t\t\tpermissionId={_id}\n\t\t\t\t/>\n\t\t\t))}\n\t\t</Table.Row>\n\t);\n};\n\nexport default memo(PermissionRow);\n"]}