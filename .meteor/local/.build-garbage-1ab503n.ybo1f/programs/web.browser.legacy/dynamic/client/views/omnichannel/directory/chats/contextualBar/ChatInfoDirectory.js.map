{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/directory/chats/contextualBar/ChatInfoDirectory.js"],"names":["_slicedToArray","module","link","default","v","Box","Margins","Tag","Button","Icon","ButtonGroup","useMutableCallback","Meteor","moment","React","useEffect","useState","hasPermission","VerticalBar","useRoute","useToastMessageDispatch","useTranslation","useUserSubscription","useEndpointData","useFormatDateAndTime","useFormatDuration","CustomField","Field","Info","Label","AgentField","ContactField","DepartmentField","PriorityField","VisitorClientInfo","ChatInfoDirectory","id","route","room","t","formatDateAndTime","allCustomFields","value","stateCustomFields","phase","customFields","setCustomFields","formatDuration","ts","tags","closedAt","departmentId","servedBy","metrics","topic","waitingResponse","responseBy","priorityId","livechatData","queuedAt","routePath","canViewCustomFields","subscription","hasGlobalEditRoomPermission","hasLocalEditRoomPermission","_id","userId","visitorId","queueStartedAt","dispatchToastMessage","customFieldsAPI","checkIsVisibleAndScopeRoom","key","field","find","visibility","scope","onEditClick","hasEditAccess","type","message","push","tab","context","page","bar","length","map","tag","display","from","fromNow","response","avg","lastMessageTs","Object","keys","exportDefault"],"mappings":"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","file":"dynamic/client/views/omnichannel/directory/chats/contextualBar/ChatInfoDirectory.js","sourcesContent":["import { Box, Margins, Tag, Button, Icon, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { Meteor } from 'meteor/meteor';\nimport moment from 'moment';\nimport React, { useEffect, useState } from 'react';\n\nimport { hasPermission } from '../../../../../../app/authorization/client';\nimport VerticalBar from '../../../../../components/VerticalBar';\nimport { useRoute } from '../../../../../contexts/RouterContext';\nimport { useToastMessageDispatch } from '../../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../../contexts/TranslationContext';\nimport { useUserSubscription } from '../../../../../contexts/UserContext';\nimport { useEndpointData } from '../../../../../hooks/useEndpointData';\nimport { useFormatDateAndTime } from '../../../../../hooks/useFormatDateAndTime';\nimport { useFormatDuration } from '../../../../../hooks/useFormatDuration';\nimport CustomField from '../../../components/CustomField';\nimport Field from '../../../components/Field';\nimport Info from '../../../components/Info';\nimport Label from '../../../components/Label';\nimport AgentField from './AgentField';\nimport ContactField from './ContactField';\nimport DepartmentField from './DepartmentField';\nimport PriorityField from './PriorityField';\nimport VisitorClientInfo from './VisitorClientInfo';\n\nfunction ChatInfoDirectory({ id, route, room }) {\n\tconst t = useTranslation();\n\n\tconst formatDateAndTime = useFormatDateAndTime();\n\tconst { value: allCustomFields, phase: stateCustomFields } = useEndpointData('livechat/custom-fields');\n\tconst [customFields, setCustomFields] = useState([]);\n\tconst formatDuration = useFormatDuration();\n\n\tconst { ts, tags, closedAt, departmentId, v, servedBy, metrics, topic, waitingResponse, responseBy, priorityId, livechatData, queuedAt } =\n\t\troom || { room: { v: {} } };\n\n\tconst routePath = useRoute(route || 'omnichannel-directory');\n\tconst canViewCustomFields = () => hasPermission('view-livechat-room-customfields');\n\tconst subscription = useUserSubscription(id);\n\tconst hasGlobalEditRoomPermission = hasPermission('save-others-livechat-room-info');\n\tconst hasLocalEditRoomPermission = servedBy?._id === Meteor.userId();\n\tconst visitorId = v?._id;\n\tconst queueStartedAt = queuedAt || ts;\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tuseEffect(() => {\n\t\tif (allCustomFields) {\n\t\t\tconst { customFields: customFieldsAPI } = allCustomFields;\n\t\t\tsetCustomFields(customFieldsAPI);\n\t\t}\n\t}, [allCustomFields, stateCustomFields]);\n\n\tconst checkIsVisibleAndScopeRoom = (key) => {\n\t\tconst field = customFields.find(({ _id }) => _id === key);\n\t\tif (field && field.visibility === 'visible' && field.scope === 'room') {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\tconst onEditClick = useMutableCallback(() => {\n\t\tconst hasEditAccess = !!subscription || hasLocalEditRoomPermission || hasGlobalEditRoomPermission;\n\t\tif (!hasEditAccess) {\n\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Not_authorized') });\n\t\t}\n\n\t\troutePath.push(\n\t\t\troute\n\t\t\t\t? {\n\t\t\t\t\t\ttab: 'room-info',\n\t\t\t\t\t\tcontext: 'edit',\n\t\t\t\t\t\tid,\n\t\t\t\t  }\n\t\t\t\t: {\n\t\t\t\t\t\tpage: 'chats',\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tbar: 'edit',\n\t\t\t\t  },\n\t\t);\n\t});\n\n\treturn (\n\t\t<>\n\t\t\t<VerticalBar.ScrollableContent p='x24'>\n\t\t\t\t<Margins block='x4'>\n\t\t\t\t\t{room && v && <ContactField contact={v} room={room} />}\n\t\t\t\t\t{visitorId && <VisitorClientInfo uid={visitorId} />}\n\t\t\t\t\t{servedBy && <AgentField agent={servedBy} />}\n\t\t\t\t\t{departmentId && <DepartmentField departmentId={departmentId} />}\n\t\t\t\t\t{tags && tags.length > 0 && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Tags')}</Label>\n\t\t\t\t\t\t\t<Info>\n\t\t\t\t\t\t\t\t{tags.map((tag) => (\n\t\t\t\t\t\t\t\t\t<Box key={tag} mie='x4' display='inline'>\n\t\t\t\t\t\t\t\t\t\t<Tag style={{ display: 'inline' }} disabled>\n\t\t\t\t\t\t\t\t\t\t\t{tag}\n\t\t\t\t\t\t\t\t\t\t</Tag>\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{topic && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Topic')}</Label>\n\t\t\t\t\t\t\t<Info>{topic}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{queueStartedAt && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Queue_Time')}</Label>\n\t\t\t\t\t\t\t{servedBy ? (\n\t\t\t\t\t\t\t\t<Info>{moment(servedBy.ts).from(moment(queueStartedAt), true)}</Info>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<Info>{moment(queueStartedAt).fromNow(true)}</Info>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{closedAt && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Chat_Duration')}</Label>\n\t\t\t\t\t\t\t<Info>{moment(closedAt).from(moment(ts), true)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{ts && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Created_at')}</Label>\n\t\t\t\t\t\t\t<Info>{formatDateAndTime(ts)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{closedAt && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Closed_At')}</Label>\n\t\t\t\t\t\t\t<Info>{formatDateAndTime(closedAt)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{servedBy?.ts && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Taken_at')}</Label>\n\t\t\t\t\t\t\t<Info>{formatDateAndTime(servedBy.ts)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{metrics?.response?.avg && formatDuration(metrics.response.avg) && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Avg_response_time')}</Label>\n\t\t\t\t\t\t\t<Info>{formatDuration(metrics.response.avg)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{!waitingResponse && responseBy?.lastMessageTs && (\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Label>{t('Inactivity_Time')}</Label>\n\t\t\t\t\t\t\t<Info>{moment(responseBy.lastMessageTs).fromNow(true)}</Info>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t)}\n\t\t\t\t\t{canViewCustomFields() &&\n\t\t\t\t\t\tlivechatData &&\n\t\t\t\t\t\tObject.keys(livechatData).map(\n\t\t\t\t\t\t\t(key) => checkIsVisibleAndScopeRoom(key) && livechatData[key] && <CustomField key={key} id={key} value={livechatData[key]} />,\n\t\t\t\t\t\t)}\n\t\t\t\t\t{priorityId && <PriorityField id={priorityId} />}\n\t\t\t\t</Margins>\n\t\t\t</VerticalBar.ScrollableContent>\n\t\t\t<VerticalBar.Footer>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button onClick={onEditClick}>\n\t\t\t\t\t\t<Icon name='pencil' size='x20' /> {t('Edit')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</VerticalBar.Footer>\n\t\t</>\n\t);\n}\n\nexport default ChatInfoDirectory;\n"]}