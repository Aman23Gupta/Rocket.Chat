{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/businessHours/EditBusinessHoursPage.js"],"names":["_regeneratorRuntime","module","link","default","v","_objectSpread","_objectWithoutProperties","_slicedToArray","Button","ButtonGroup","Callout","useMutableCallback","React","useRef","useMemo","useState","Page","PageSkeleton","useRoute","useMethod","useToastMessageDispatch","useTranslation","AsyncStatePhase","useEndpointData","BusinessHoursFormContainer","useIsSingleBusinessHours","mapBusinessHoursForm","EditBusinessHoursPage","id","type","t","dispatchToastMessage","isSingleBH","_id","data","value","state","phase","saveData","form","hasChanges","setHasChanges","save","deleteBH","router","handleSave","RESOLVED","success","current","multiple","departments","timezone","timezoneName","name","businessHour","message","field","mappedForm","departmentsToApplyBusinessHour","map","dep","join","payload","workHours","push","handleDelete","handleReturn","LOADING","REJECTED","exportDefault"],"mappings":";;;;;;;;;;AAAA,IAAIA,mBAAJ;;AAAwBC,MAAM,CAACC,IAAP,CAAY,4BAAZ,EAAyC;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,uBAAmB,GAACI,CAApB;AAAsB;AAA3C,CAAzC,EAAsF,CAAtF;;AAAyF,IAAIC,aAAJ;;AAAkBJ,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACC,iBAAa,GAACD,CAAd;AAAgB;AAArC,CAAnD,EAA0F,CAA1F;;AAA6F,IAAIE,wBAAJ;;AAA6BL,MAAM,CAACC,IAAP,CAAY,gDAAZ,EAA6D;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACE,4BAAwB,GAACF,CAAzB;AAA2B;AAAhD,CAA7D,EAA+G,CAA/G;;AAAkH,IAAIG,cAAJ;;AAAmBN,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACG,kBAAc,GAACH,CAAf;AAAiB;AAAtC,CAAnD,EAA2F,CAA3F;AAAlY,IAAII,MAAJ,EAAWC,WAAX,EAAuBC,OAAvB;AAA+BT,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACM,QAAM,EAAC,UAASJ,CAAT,EAAW;AAACI,UAAM,GAACJ,CAAP;AAAS,GAA7B;AAA8BK,aAAW,EAAC,UAASL,CAAT,EAAW;AAACK,eAAW,GAACL,CAAZ;AAAc,GAApE;AAAqEM,SAAO,EAAC,UAASN,CAAT,EAAW;AAACM,WAAO,GAACN,CAAR;AAAU;AAAnG,CAApC,EAAyI,CAAzI;AAA4I,IAAIO,kBAAJ;AAAuBV,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACS,oBAAkB,EAAC,UAASP,CAAT,EAAW;AAACO,sBAAkB,GAACP,CAAnB;AAAqB;AAArD,CAA1C,EAAiG,CAAjG;AAAoG,IAAIQ,KAAJ,EAAUC,MAAV,EAAiBC,OAAjB,EAAyBC,QAAzB;AAAkCd,MAAM,CAACC,IAAP,CAAY,OAAZ,EAAoB;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACQ,SAAK,GAACR,CAAN;AAAQ,GAA7B;AAA8BS,QAAM,EAAC,UAAST,CAAT,EAAW;AAACS,UAAM,GAACT,CAAP;AAAS,GAA1D;AAA2DU,SAAO,EAAC,UAASV,CAAT,EAAW;AAACU,WAAO,GAACV,CAAR;AAAU,GAAzF;AAA0FW,UAAQ,EAAC,UAASX,CAAT,EAAW;AAACW,YAAQ,GAACX,CAAT;AAAW;AAA1H,CAApB,EAAgJ,CAAhJ;AAAmJ,IAAIY,IAAJ;AAASf,MAAM,CAACC,IAAP,CAAY,0BAAZ,EAAuC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACY,QAAI,GAACZ,CAAL;AAAO;AAA5B,CAAvC,EAAqE,CAArE;AAAwE,IAAIa,YAAJ;AAAiBhB,MAAM,CAACC,IAAP,CAAY,kCAAZ,EAA+C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACa,gBAAY,GAACb,CAAb;AAAe;AAApC,CAA/C,EAAqF,CAArF;AAAwF,IAAIc,QAAJ;AAAajB,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAACgB,UAAQ,EAAC,UAASd,CAAT,EAAW;AAACc,YAAQ,GAACd,CAAT;AAAW;AAAjC,CAA9C,EAAiF,CAAjF;AAAoF,IAAIe,SAAJ;AAAclB,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAACiB,WAAS,EAAC,UAASf,CAAT,EAAW;AAACe,aAAS,GAACf,CAAV;AAAY;AAAnC,CAA9C,EAAmF,CAAnF;AAAsF,IAAIgB,uBAAJ;AAA4BnB,MAAM,CAACC,IAAP,CAAY,wCAAZ,EAAqD;AAACkB,yBAAuB,EAAC,UAAShB,CAAT,EAAW;AAACgB,2BAAuB,GAAChB,CAAxB;AAA0B;AAA/D,CAArD,EAAsH,CAAtH;AAAyH,IAAIiB,cAAJ;AAAmBpB,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACmB,gBAAc,EAAC,UAASjB,CAAT,EAAW;AAACiB,kBAAc,GAACjB,CAAf;AAAiB;AAA7C,CAAnD,EAAkG,CAAlG;AAAqG,IAAIkB,eAAJ;AAAoBrB,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAACoB,iBAAe,EAAC,UAASlB,CAAT,EAAW;AAACkB,mBAAe,GAAClB,CAAhB;AAAkB;AAA/C,CAA3C,EAA4F,CAA5F;AAA+F,IAAImB,eAAJ;AAAoBtB,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACqB,iBAAe,EAAC,UAASnB,CAAT,EAAW;AAACmB,mBAAe,GAACnB,CAAhB;AAAkB;AAA/C,CAA7C,EAA8F,EAA9F;AAAkG,IAAIoB,0BAAJ;AAA+BvB,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACoB,8BAA0B,GAACpB,CAA3B;AAA6B;AAAlD,CAA3C,EAA+F,EAA/F;AAAmG,IAAIqB,wBAAJ;AAA6BxB,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACuB,0BAAwB,EAAC,UAASrB,CAAT,EAAW;AAACqB,4BAAwB,GAACrB,CAAzB;AAA2B;AAAjE,CAApC,EAAuG,EAAvG;AAA2G,IAAIsB,oBAAJ;AAAyBzB,MAAM,CAACC,IAAP,CAAY,wBAAZ,EAAqC;AAACwB,sBAAoB,EAAC,UAAStB,CAAT,EAAW;AAACsB,wBAAoB,GAACtB,CAArB;AAAuB;AAAzD,CAArC,EAAgG,EAAhG;;AAgBnnD,IAAMuB,qBAAqB,GAAG,gBAAkB;AAAA,MAAfC,EAAe,QAAfA,EAAe;AAAA,MAAXC,IAAW,QAAXA,IAAW;AAC/C,MAAMC,CAAC,GAAGT,cAAc,EAAxB;AACA,MAAMU,oBAAoB,GAAGX,uBAAuB,EAApD;AACA,MAAMY,UAAU,GAAGP,wBAAwB,EAA3C;;AAEA,yBAAsCF,eAAe,CACpD,wBADoD,EAEpDT,OAAO,CAAC;AAAA,WAAO;AAAEmB,SAAG,EAAEL,EAAP;AAAWC,UAAI,EAAJA;AAAX,KAAP;AAAA,GAAD,EAA4B,CAACD,EAAD,EAAKC,IAAL,CAA5B,CAF6C,CAArD;AAAA,MAAeK,IAAf,oBAAQC,KAAR;AAAA,MAA4BC,KAA5B,oBAAqBC,KAArB;;AAKA,MAAMC,QAAQ,GAAGzB,MAAM,CAAC;AAAE0B,QAAI,EAAE;AAAR,GAAD,CAAvB;;AAEA,kBAAoCxB,QAAQ,CAAC,KAAD,CAA5C;AAAA;AAAA,MAAOyB,UAAP;AAAA,MAAmBC,aAAnB;;AAEA,MAAMC,IAAI,GAAGvB,SAAS,CAAC,2BAAD,CAAtB;AACA,MAAMwB,QAAQ,GAAGxB,SAAS,CAAC,6BAAD,CAA1B;AAEA,MAAMyB,MAAM,GAAG1B,QAAQ,CAAC,2BAAD,CAAvB;AAEA,MAAM2B,UAAU,GAAGlC,kBAAkB;AAAC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACjCyB,KAAK,KAAKd,eAAe,CAACwB,QAA1B,IAAsC,CAACZ,IAAI,CAACa,OADX;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,oCAOjCT,QAPiC,CAMpCU,OANoC,EAMzBT,IANyB,qBAMzBA,IANyB,4CAMnBU,QANmB;AAKrC,2EAC2D,EAD3D;AAC8BC,2BANO,yBAMPA,WANO,EAMSD,QANT,yGAM0BE,QAN1B;AAKrC,2EACkG,EADlG;AACiFC,4BAN5C,yBAMsCC,IANtC;;AAAA,sBASjCnB,IAAI,CAACoB,YAAL,CAAkBzB,IAAlB,KAA2B,SAA3B,IAAwCoB,QAAQ,CAACI,IAAT,KAAkB,EATzB;AAAA;AAAA;AAAA;;AAAA,iDAU7BtB,oBAAoB,CAAC;AAC3BF,sBAAI,EAAE,OADqB;AAE3B0B,yBAAO,EAAEzB,CAAC,CAAC,6BAAD,EAAgC;AAAE0B,yBAAK,EAAE1B,CAAC,CAAC,MAAD;AAAV,mBAAhC;AAFiB,iBAAD,CAVS;;AAAA;AAgB/B2B,0BAhB+B,GAgBlB/B,oBAAoB,CAACa,IAAD,EAAOL,IAAI,CAACoB,YAAZ,CAhBF;AAkB/BI,8CAlB+B,GAkBE,CAAAR,WAAW,SAAX,IAAAA,WAAW,WAAX,YAAAA,WAAW,CAAES,GAAb,CAAiB,UAACC,GAAD;AAAA,yBAASA,GAAG,CAACzB,KAAb;AAAA,iBAAjB,EAAqC0B,IAArC,CAA0C,GAA1C,MAAkD,EAlBpD;AAAA;AAqB9BC,uBArB8B,iDAsBhC5B,IAAI,CAACoB,YAtB2B,GAuBhCL,QAvBgC;AAwBnCS,gDAA8B,EAAEA,8BAAF,aAAEA,8BAAF,cAAEA,8BAAF,GAAoC,EAxB/B;AAyBnCN,8BAAY,EAAEA,YAAY,IAAIlB,IAAI,CAACoB,YAAL,CAAkBH,QAAlB,CAA2BE,IAzBtB;AA0BnCU,2BAAS,EAAEN;AA1BwB;AAAA;AAAA,iDA6B9Bf,IAAI,CAACoB,OAAD,CA7B0B;;AAAA;AA8BpC/B,oCAAoB,CAAC;AAAEF,sBAAI,EAAE,SAAR;AAAmB0B,yBAAO,EAAEzB,CAAC,CAAC,wBAAD;AAA7B,iBAAD,CAApB;AACAc,sBAAM,CAACoB,IAAP,CAAY,EAAZ;AA/BoC;AAAA;;AAAA;AAAA;AAAA;AAiCpCjC,oCAAoB,CAAC;AAAEF,sBAAI,EAAE,OAAR;AAAiB0B,yBAAO;AAAxB,iBAAD,CAApB;;AAjCoC;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAD;AAAA,MAArC;AAqCA,MAAMU,YAAY,GAAGtD,kBAAkB;AAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACnCkB,IAAI,KAAK,QAD0B;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA,iDAMhCc,QAAQ,CAACf,EAAD,EAAKC,IAAL,CANwB;;AAAA;AAOtCE,oCAAoB,CAAC;AAAEF,sBAAI,EAAE,SAAR;AAAmB0B,yBAAO,EAAEzB,CAAC,CAAC,uBAAD;AAA7B,iBAAD,CAApB;AACAc,sBAAM,CAACoB,IAAP,CAAY,EAAZ;AARsC;AAAA;;AAAA;AAAA;AAAA;AAUtCjC,oCAAoB,CAAC;AAAEF,sBAAI,EAAE,OAAR;AAAiB0B,yBAAO;AAAxB,iBAAD,CAApB;;AAVsC;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAD;AAAA,MAAvC;AAcA,MAAMW,YAAY,GAAGvD,kBAAkB,CAAC,YAAM;AAC7CiC,UAAM,CAACoB,IAAP,CAAY,EAAZ;AACA,GAFsC,CAAvC;;AAIA,MAAI5B,KAAK,KAAKd,eAAe,CAAC6C,OAA9B,EAAuC;AACtC,wBAAO,oBAAC,YAAD,OAAP;AACA;;AAED,MAAI/B,KAAK,KAAKd,eAAe,CAAC8C,QAA1B,IAAuC9C,eAAe,CAACwB,QAAhB,IAA4B,CAACZ,IAAI,CAACoB,YAA7E,EAA4F;AAC3F,wBACC,oBAAC,IAAD,qBACC,oBAAC,IAAD,CAAM,MAAN;AAAa,WAAK,EAAExB,CAAC,CAAC,gBAAD;AAArB,oBACC,oBAAC,MAAD;AAAQ,aAAO,EAAEoC;AAAjB,OAAgCpC,CAAC,CAAC,MAAD,CAAjC,CADD,CADD,eAIC,oBAAC,IAAD,CAAM,2BAAN,qBACC,oBAAC,OAAD;AAAS,UAAI,EAAC;AAAd,OAAwBA,CAAC,CAAC,OAAD,CAAzB,CADD,CAJD,CADD;AAUA;;AAED,sBACC,oBAAC,IAAD,qBACC,oBAAC,IAAD,CAAM,MAAN;AAAa,SAAK,EAAEA,CAAC,CAAC,gBAAD;AAArB,kBACC,oBAAC,WAAD,QACE,CAACE,UAAD,iBAAe,oBAAC,MAAD;AAAQ,WAAO,EAAEkC;AAAjB,KAAgCpC,CAAC,CAAC,MAAD,CAAjC,CADjB,EAEED,IAAI,KAAK,QAAT,iBACA,oBAAC,MAAD;AAAQ,WAAO,MAAf;AAAgB,UAAM,MAAtB;AAAuB,WAAO,EAAEoC;AAAhC,KACEnC,CAAC,CAAC,QAAD,CADH,CAHF,eAOC,oBAAC,MAAD;AAAQ,WAAO,MAAf;AAAgB,WAAO,EAAEe,UAAzB;AAAqC,YAAQ,EAAE,CAACL;AAAhD,KACEV,CAAC,CAAC,MAAD,CADH,CAPD,CADD,CADD,eAcC,oBAAC,IAAD,CAAM,2BAAN,qBACC,oBAAC,0BAAD;AAA4B,QAAI,EAAEI,IAAI,CAACoB,YAAvC;AAAqD,WAAO,EAAEhB,QAA9D;AAAwE,YAAQ,EAAEG;AAAlF,IADD,CAdD,CADD;AAoBA,CA/GD;;AAhBAxC,MAAM,CAACoE,aAAP,CAiIe1C,qBAjIf,E","file":"dynamic/client/views/omnichannel/businessHours/EditBusinessHoursPage.js","sourcesContent":["import { Button, ButtonGroup, Callout } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useRef, useMemo, useState } from 'react';\n\nimport Page from '../../../components/Page';\nimport PageSkeleton from '../../../components/PageSkeleton';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { AsyncStatePhase } from '../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../hooks/useEndpointData';\nimport BusinessHoursFormContainer from './BusinessHoursFormContainer';\nimport { useIsSingleBusinessHours } from './BusinessHoursRouter';\nimport { mapBusinessHoursForm } from './mapBusinessHoursForm';\n\nconst EditBusinessHoursPage = ({ id, type }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst isSingleBH = useIsSingleBusinessHours();\n\n\tconst { value: data, phase: state } = useEndpointData(\n\t\t'livechat/business-hour',\n\t\tuseMemo(() => ({ _id: id, type }), [id, type]),\n\t);\n\n\tconst saveData = useRef({ form: {} });\n\n\tconst [hasChanges, setHasChanges] = useState(false);\n\n\tconst save = useMethod('livechat:saveBusinessHour');\n\tconst deleteBH = useMethod('livechat:removeBusinessHour');\n\n\tconst router = useRoute('omnichannel-businessHours');\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tif (state !== AsyncStatePhase.RESOLVED || !data.success) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tcurrent: { form, multiple: { departments, ...multiple } = {}, timezone: { name: timezoneName } = {} },\n\t\t} = saveData;\n\n\t\tif (data.businessHour.type !== 'default' && multiple.name === '') {\n\t\t\treturn dispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: t('error-the-field-is-required', { field: t('Name') }),\n\t\t\t});\n\t\t}\n\n\t\tconst mappedForm = mapBusinessHoursForm(form, data.businessHour);\n\n\t\tconst departmentsToApplyBusinessHour = departments?.map((dep) => dep.value).join(',') || '';\n\n\t\ttry {\n\t\t\tconst payload = {\n\t\t\t\t...data.businessHour,\n\t\t\t\t...multiple,\n\t\t\t\tdepartmentsToApplyBusinessHour: departmentsToApplyBusinessHour ?? '',\n\t\t\t\ttimezoneName: timezoneName || data.businessHour.timezone.name,\n\t\t\t\tworkHours: mappedForm,\n\t\t\t};\n\n\t\t\tawait save(payload);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Business_hours_updated') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleDelete = useMutableCallback(async () => {\n\t\tif (type !== 'custom') {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tawait deleteBH(id, type);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Business_Hour_Removed') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleReturn = useMutableCallback(() => {\n\t\trouter.push({});\n\t});\n\n\tif (state === AsyncStatePhase.LOADING) {\n\t\treturn <PageSkeleton />;\n\t}\n\n\tif (state === AsyncStatePhase.REJECTED || (AsyncStatePhase.RESOLVED && !data.businessHour)) {\n\t\treturn (\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Business_Hours')}>\n\t\t\t\t\t<Button onClick={handleReturn}>{t('Back')}</Button>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t\t<Callout type='danger'>{t('Error')}</Callout>\n\t\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t</Page>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('Business_Hours')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t{!isSingleBH && <Button onClick={handleReturn}>{t('Back')}</Button>}\n\t\t\t\t\t{type === 'custom' && (\n\t\t\t\t\t\t<Button primary danger onClick={handleDelete}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button primary onClick={handleSave} disabled={!hasChanges}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<BusinessHoursFormContainer data={data.businessHour} saveRef={saveData} onChange={setHasChanges} />\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default EditBusinessHoursPage;\n"]}