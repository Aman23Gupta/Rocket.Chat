{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/analytics/InterchangeableChart.js"],"names":["_regeneratorRuntime","module","link","default","v","_extends","_objectSpread","_objectWithoutProperties","useMutableCallback","React","useRef","useEffect","drawLineChart","secondsToHHMMSS","useMethod","useToastMessageDispatch","useTranslation","Chart","getChartTooltips","chartName","callbacks","title","tooltipItem","data","labels","index","label","datasets","InterchangeableChart","departmentId","dateRange","props","t","dispatchToastMessage","canvas","context","start","end","loadData","draw","params","tooltipCallbacks","daterange","from","to","result","chartLabel","dataLabels","dataPoints","Error","current","type","message","chartOptions","name","exportDefault"],"mappings":"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","file":"dynamic/client/views/omnichannel/analytics/InterchangeableChart.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useRef, useEffect } from 'react';\n\nimport { drawLineChart } from '../../../../app/livechat/client/lib/chartHandler';\nimport { secondsToHHMMSS } from '../../../../app/utils/lib/timeConverter';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport Chart from '../realTimeMonitoring/charts/Chart';\n\nconst getChartTooltips = (chartName) => {\n\tswitch (chartName) {\n\t\tcase 'Avg_chat_duration':\n\t\tcase 'Avg_first_response_time':\n\t\tcase 'Best_first_response_time':\n\t\tcase 'Avg_response_time':\n\t\tcase 'Avg_reaction_time':\n\t\t\treturn {\n\t\t\t\tcallbacks: {\n\t\t\t\t\ttitle(tooltipItem, data) {\n\t\t\t\t\t\treturn data.labels[tooltipItem[0].index];\n\t\t\t\t\t},\n\t\t\t\t\tlabel(tooltipItem, data) {\n\t\t\t\t\t\treturn secondsToHHMMSS(data.datasets[0].data[tooltipItem.index]);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\tdefault:\n\t\t\treturn {};\n\t}\n};\n\nconst InterchangeableChart = ({ departmentId, dateRange, chartName, ...props }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst canvas = useRef();\n\tconst context = useRef();\n\n\tconst { start, end } = dateRange;\n\n\tconst loadData = useMethod('livechat:getAnalyticsChartData');\n\n\tconst draw = useMutableCallback(async (params) => {\n\t\ttry {\n\t\t\tconst tooltipCallbacks = getChartTooltips(chartName);\n\t\t\tif (!params?.daterange?.from || !params?.daterange?.to) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst result = await loadData(params);\n\t\t\tif (!result?.chartLabel || !result?.dataLabels || !result?.dataPoints) {\n\t\t\t\tthrow new Error('Error! fetching chart data. Details: livechat:getAnalyticsChartData => Missing Data');\n\t\t\t}\n\t\t\tcontext.current = await drawLineChart(canvas.current, context.current, [result.chartLabel], result.dataLabels, [result.dataPoints], {\n\t\t\t\ttooltipCallbacks,\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\tdraw({\n\t\t\tdaterange: {\n\t\t\t\tfrom: start,\n\t\t\t\tto: end,\n\t\t\t},\n\t\t\tchartOptions: { name: chartName },\n\t\t\t...(departmentId && { departmentId }),\n\t\t});\n\t}, [chartName, departmentId, draw, end, start, t, loadData]);\n\n\treturn <Chart border='none' pi='none' ref={canvas} {...props} />;\n};\n\nexport default InterchangeableChart;\n"]}