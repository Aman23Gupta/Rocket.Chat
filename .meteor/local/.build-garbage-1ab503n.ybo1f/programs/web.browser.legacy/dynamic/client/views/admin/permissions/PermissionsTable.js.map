{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/permissions/PermissionsTable.js"],"names":["_slicedToArray","module","link","default","v","Margins","Icon","Tabs","Button","useMutableCallback","React","useState","useCallback","GenericTable","Page","usePermission","useRoute","useMethod","useTranslation","FilterComponent","PermissionRow","PermissionsContextBar","RoleHeader","usePermissionsAndRoles","PermissionsTable","t","filter","setFilter","canViewPermission","canViewSettingPermission","defaultType","type","setType","limit","skip","params","setParams","router","grantRole","removeRole","permissionsData","permissions","total","roleList","handleParams","current","itemsPerPage","handlePermissionsTab","handleSettingsTab","handleAdd","push","context","map","_id","name","description","permission","exportDefault"],"mappings":"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","file":"dynamic/client/views/admin/permissions/PermissionsTable.js","sourcesContent":["import { Margins, Icon, Tabs, Button } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, useCallback } from 'react';\n\nimport GenericTable from '../../../components/GenericTable';\nimport Page from '../../../components/Page';\nimport { usePermission } from '../../../contexts/AuthorizationContext';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport FilterComponent from './FilterComponent';\nimport PermissionRow from './PermissionRow';\nimport PermissionsContextBar from './PermissionsContextBar';\nimport RoleHeader from './RoleHeader';\nimport { usePermissionsAndRoles } from './hooks/usePermissionsAndRoles';\n\nconst PermissionsTable = () => {\n\tconst t = useTranslation();\n\tconst [filter, setFilter] = useState('');\n\tconst canViewPermission = usePermission('access-permissions');\n\tconst canViewSettingPermission = usePermission('access-setting-permissions');\n\tconst defaultType = canViewPermission ? 'permissions' : 'settings';\n\tconst [type, setType] = useState(defaultType);\n\tconst [params, setParams] = useState({ limit: 25, skip: 0 });\n\n\tconst router = useRoute('admin-permissions');\n\n\tconst grantRole = useMethod('authorization:addPermissionToRole');\n\tconst removeRole = useMethod('authorization:removeRoleFromPermission');\n\n\tconst permissionsData = usePermissionsAndRoles(type, filter, params.limit, params.skip);\n\n\tconst [permissions, total, roleList] = permissionsData;\n\n\tconst handleParams = useMutableCallback(({ current, itemsPerPage }) => {\n\t\tsetParams({ skip: current, limit: itemsPerPage });\n\t});\n\n\tconst handlePermissionsTab = useMutableCallback(() => {\n\t\tif (type === 'permissions') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('permissions');\n\t});\n\n\tconst handleSettingsTab = useMutableCallback(() => {\n\t\tif (type === 'settings') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('settings');\n\t});\n\n\tconst handleAdd = useMutableCallback(() => {\n\t\trouter.push({\n\t\t\tcontext: 'new',\n\t\t});\n\t});\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Permissions')}>\n\t\t\t\t\t<Button primary onClick={handleAdd} aria-label={t('New')}>\n\t\t\t\t\t\t<Icon name='plus' /> {t('New_role')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Margins blockEnd='x16'>\n\t\t\t\t\t<Tabs>\n\t\t\t\t\t\t<Tabs.Item selected={type === 'permissions'} onClick={handlePermissionsTab} disabled={!canViewPermission}>\n\t\t\t\t\t\t\t{t('Permissions')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t<Tabs.Item selected={type === 'settings'} onClick={handleSettingsTab} disabled={!canViewSettingPermission}>\n\t\t\t\t\t\t\t{t('Settings')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t</Tabs>\n\t\t\t\t</Margins>\n\t\t\t\t<Page.Content mb='neg-x8'>\n\t\t\t\t\t<Margins block='x8'>\n\t\t\t\t\t\t<FilterComponent onChange={setFilter} />\n\t\t\t\t\t\t<GenericTable\n\t\t\t\t\t\t\theader={\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<GenericTable.HeaderCell width='x120'>{t('Name')}</GenericTable.HeaderCell>\n\t\t\t\t\t\t\t\t\t{roleList.map(({ _id, name, description }) => (\n\t\t\t\t\t\t\t\t\t\t<RoleHeader key={_id} _id={_id} name={name} description={description} router={router} />\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttotal={total}\n\t\t\t\t\t\t\tresults={permissions}\n\t\t\t\t\t\t\tparams={params}\n\t\t\t\t\t\t\tsetParams={handleParams}\n\t\t\t\t\t\t\tfixed={false}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{useCallback(\n\t\t\t\t\t\t\t\t(permission) => (\n\t\t\t\t\t\t\t\t\t<PermissionRow\n\t\t\t\t\t\t\t\t\t\tkey={permission._id}\n\t\t\t\t\t\t\t\t\t\tpermission={permission}\n\t\t\t\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\t\t\t\troleList={roleList}\n\t\t\t\t\t\t\t\t\t\tonGrant={grantRole}\n\t\t\t\t\t\t\t\t\t\tonRemove={removeRole}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t[grantRole, removeRole, roleList, t],\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</GenericTable>\n\t\t\t\t\t</Margins>\n\t\t\t\t</Page.Content>\n\t\t\t</Page>\n\t\t\t<PermissionsContextBar />\n\t\t</Page>\n\t);\n};\n\nexport default PermissionsTable;\n"]}