{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/info/FederationCard/FederationCard.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/admin/info/FederationCard/FederationCard.tsx","sourcesContent":["import { Box, Button, ButtonGroup, ToggleSwitch } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { FC } from 'react';\n\nimport Card from '../../../../components/Card';\nimport { useSetModal } from '../../../../contexts/ModalContext';\nimport { useSetting, useSettingSetValue } from '../../../../contexts/SettingsContext';\nimport { useTranslation } from '../../../../contexts/TranslationContext';\nimport SettingsProvider from '../../../../providers/SettingsProvider';\nimport { CardHeader, Section } from './components';\nimport { FederationModal } from './components/FederationModal';\nimport { SectionStatus } from './components/Section';\n\nconst FederationCard: FC = () => {\n\tconst t = useTranslation();\n\n\tconst setModal = useSetModal();\n\n\tconst federationEnabled = useSetting('FEDERATION_Enabled') as boolean;\n\tconst setFederationEnabled = useSettingSetValue('FEDERATION_Enabled');\n\n\tconst federationHealthy = useSetting('FEDERATION_Healthy') as boolean;\n\n\tconst federationPopulated = useSetting('FEDERATION_Populated') as boolean;\n\n\t// Set status of each section\n\n\t// - Enabled\n\tlet federationEnabledStatus = federationEnabled ? SectionStatus.SUCCESS : SectionStatus.UNKNOWN;\n\n\t// - Setup\n\tlet federationSetupStatus = federationHealthy ? SectionStatus.SUCCESS : SectionStatus.FAILED;\n\n\t// - Adding users\n\tlet federationAddingUsersStatus;\n\n\tif (federationPopulated) {\n\t\tfederationAddingUsersStatus = SectionStatus.SUCCESS;\n\t} else if (federationHealthy) {\n\t\tfederationAddingUsersStatus = SectionStatus.FAILED;\n\t} else {\n\t\tfederationAddingUsersStatus = SectionStatus.UNKNOWN;\n\t}\n\n\tif (!federationEnabled) {\n\t\tfederationEnabledStatus = SectionStatus.UNKNOWN;\n\t\tfederationSetupStatus = SectionStatus.UNKNOWN;\n\t\tfederationAddingUsersStatus = SectionStatus.UNKNOWN;\n\t}\n\n\t// Handle modal\n\n\tconst handleModal = useMutableCallback(() =>\n\t\tsetModal(\n\t\t\t<SettingsProvider privileged>\n\t\t\t\t<FederationModal\n\t\t\t\t\tonClose={(): void => {\n\t\t\t\t\t\tsetModal();\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</SettingsProvider>,\n\t\t),\n\t);\n\n\treturn (\n\t\t<Card>\n\t\t\t<CardHeader>\n\t\t\t\t<Card.Title>{t('Federation')}</Card.Title>\n\t\t\t\t<Box display='flex'>\n\t\t\t\t\t<Box mb='x8' fontScale='c1' display='flex'>\n\t\t\t\t\t\t{t('Enabled')}\n\t\t\t\t\t</Box>\n\t\t\t\t\t<ToggleSwitch\n\t\t\t\t\t\tmb='x6'\n\t\t\t\t\t\tmis='x6'\n\t\t\t\t\t\tchecked={federationEnabled}\n\t\t\t\t\t\tonChange={(): Promise<void> => setFederationEnabled(!federationEnabled)}\n\t\t\t\t\t/>\n\t\t\t\t</Box>\n\t\t\t</CardHeader>\n\t\t\t<Card.Body>\n\t\t\t\t<Card.Col span={2}>\n\t\t\t\t\t<Section status={federationEnabledStatus} title={t('Federation_Enable')} subtitle={t('Federation_Is_working_correctly')} />\n\t\t\t\t\t<Section status={federationSetupStatus} title={t('Federation_Adding_to_your_server')} subtitle={t('Federation_Changes_needed')}>\n\t\t\t\t\t\t{!federationHealthy && <a onClick={handleModal}>{t('Federation_Fix_now')}</a>}\n\t\t\t\t\t</Section>\n\t\t\t\t\t<Section\n\t\t\t\t\t\tstatus={federationAddingUsersStatus}\n\t\t\t\t\t\ttitle={t('Federation_Adding_Federated_Users')}\n\t\t\t\t\t\tsubtitle={t('Federation_Guide_adding_users')}\n\t\t\t\t\t/>\n\t\t\t\t</Card.Col>\n\t\t\t</Card.Body>\n\t\t\t<Card.Footer>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button small onClick={handleModal}>\n\t\t\t\t\t\t{t('Settings')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Card.Footer>\n\t\t</Card>\n\t);\n};\n\nexport default FederationCard;\n"]}