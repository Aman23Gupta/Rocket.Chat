{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/GroupPage.js"],"names":["_regeneratorRuntime","module","link","default","v","Accordion","Box","Button","ButtonGroup","useMutableCallback","React","useMemo","memo","Page","useEditableSettingsDispatch","useEditableSettings","useSettingsDispatch","useSettings","useToastMessageDispatch","useTranslation","useLoadLanguage","useUser","GroupPageSkeleton","GroupPage","children","undefined","headerButtons","_id","i18nLabel","i18nDescription","tabs","changedEditableSettings","group","changed","originalSettings","map","dispatch","dispatchToastMessage","t","loadLanguage","user","save","changes","value","editor","length","some","lng","language","filter","shift","type","message","dispatchToEditing","cancel","find","setting","Boolean","handleSubmit","event","preventDefault","handleCancelClick","handleSaveClick","has","exportDefault","Object","assign","Skeleton"],"mappings":"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","file":"dynamic/client/views/admin/settings/GroupPage.js","sourcesContent":["import { Accordion, Box, Button, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo, memo } from 'react';\n\nimport Page from '../../../components/Page';\nimport { useEditableSettingsDispatch, useEditableSettings } from '../../../contexts/EditableSettingsContext';\nimport { useSettingsDispatch, useSettings } from '../../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation, useLoadLanguage } from '../../../contexts/TranslationContext';\nimport { useUser } from '../../../contexts/UserContext';\nimport GroupPageSkeleton from './GroupPageSkeleton';\n\nfunction GroupPage({ children = undefined, headerButtons = undefined, _id, i18nLabel, i18nDescription = undefined, tabs = undefined }) {\n\tconst changedEditableSettings = useEditableSettings(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\tgroup: _id,\n\t\t\t\tchanged: true,\n\t\t\t}),\n\t\t\t[_id],\n\t\t),\n\t);\n\n\tconst originalSettings = useSettings(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\t_id: changedEditableSettings.map(({ _id }) => _id),\n\t\t\t}),\n\t\t\t[changedEditableSettings],\n\t\t),\n\t);\n\n\tconst dispatch = useSettingsDispatch();\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\tconst loadLanguage = useLoadLanguage();\n\tconst user = useUser();\n\n\tconst save = useMutableCallback(async () => {\n\t\tconst changes = changedEditableSettings.map(({ _id, value, editor }) => ({\n\t\t\t_id,\n\t\t\tvalue,\n\t\t\teditor,\n\t\t}));\n\n\t\tif (changes.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tawait dispatch(changes);\n\n\t\t\tif (changes.some(({ _id }) => _id === 'Language')) {\n\t\t\t\tconst lng = user?.language || changes.filter(({ _id }) => _id === 'Language').shift()?.value || 'en';\n\n\t\t\t\tawait loadLanguage(lng);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Settings_updated', { lng }) });\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Settings_updated') });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst dispatchToEditing = useEditableSettingsDispatch();\n\n\tconst cancel = useMutableCallback(() => {\n\t\tdispatchToEditing(\n\t\t\tchangedEditableSettings\n\t\t\t\t.map(({ _id }) => originalSettings.find((setting) => setting._id === _id))\n\t\t\t\t.map((setting) => {\n\t\t\t\t\tif (!setting) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\t_id: setting._id,\n\t\t\t\t\t\tvalue: setting.value,\n\t\t\t\t\t\teditor: setting.editor,\n\t\t\t\t\t\tchanged: false,\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t\t.filter(Boolean),\n\t\t);\n\t});\n\n\tconst handleSubmit = (event) => {\n\t\tevent.preventDefault();\n\t\tsave();\n\t};\n\n\tconst handleCancelClick = (event) => {\n\t\tevent.preventDefault();\n\t\tcancel();\n\t};\n\n\tconst handleSaveClick = (event) => {\n\t\tevent.preventDefault();\n\t\tsave();\n\t};\n\n\tif (!_id) {\n\t\treturn (\n\t\t\t<Page>\n\t\t\t\t<Page.Header />\n\t\t\t\t<Page.Content />\n\t\t\t</Page>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Page is='form' action='#' method='post' onSubmit={handleSubmit}>\n\t\t\t<Page.Header title={t(i18nLabel)}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t{changedEditableSettings.length > 0 && (\n\t\t\t\t\t\t<Button danger primary type='reset' onClick={handleCancelClick}>\n\t\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tchildren={t('Save_changes')}\n\t\t\t\t\t\tclassName='save'\n\t\t\t\t\t\tdisabled={changedEditableSettings.length === 0}\n\t\t\t\t\t\tprimary\n\t\t\t\t\t\ttype='submit'\n\t\t\t\t\t\tonClick={handleSaveClick}\n\t\t\t\t\t/>\n\t\t\t\t\t{headerButtons}\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\n\t\t\t{tabs}\n\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<Box marginBlock='none' marginInline='auto' width='full' maxWidth='x580'>\n\t\t\t\t\t{t.has(i18nDescription) && (\n\t\t\t\t\t\t<Box is='p' color='hint' fontScale='p2'>\n\t\t\t\t\t\t\t{t(i18nDescription)}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<Accordion className='page-settings'>{children}</Accordion>\n\t\t\t\t</Box>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n}\n\nexport default Object.assign(memo(GroupPage), {\n\tSkeleton: GroupPageSkeleton,\n});\n"]}