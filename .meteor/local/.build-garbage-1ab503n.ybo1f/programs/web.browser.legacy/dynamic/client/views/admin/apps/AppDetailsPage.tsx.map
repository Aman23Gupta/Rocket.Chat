{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/apps/AppDetailsPage.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/admin/apps/AppDetailsPage.tsx","sourcesContent":["import { ISetting } from '@rocket.chat/apps-engine/definition/settings';\nimport { Button, ButtonGroup, Icon, Box, Throbber } from '@rocket.chat/fuselage';\nimport React, { useState, useCallback, useRef, FC } from 'react';\n\nimport { Apps } from '../../../../app/apps/client/orchestrator';\nimport Page from '../../../components/Page';\nimport { useRoute, useCurrentRoute } from '../../../contexts/RouterContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport APIsDisplay from './APIsDisplay';\nimport AppDetailsPageContent from './AppDetailsPageContent';\nimport LoadingDetails from './LoadingDetails';\nimport SettingsDisplay from './SettingsDisplay';\nimport { handleAPIError } from './helpers';\nimport { useAppInfo } from './hooks/useAppInfo';\n\nconst AppDetailsPage: FC<{ id: string }> = function AppDetailsPage({ id }) {\n\tconst t = useTranslation();\n\n\tconst [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\n\tconst [isSaving, setIsSaving] = useState(false);\n\tconst settingsRef = useRef<Record<string, ISetting['value']>>({});\n\n\tconst data = useAppInfo(id);\n\n\tconst [currentRouteName] = useCurrentRoute();\n\tif (!currentRouteName) {\n\t\tthrow new Error('No current route name');\n\t}\n\tconst router = useRoute(currentRouteName);\n\tconst handleReturn = (): void => router.push({});\n\n\tconst { settings, apis } = { settings: {}, apis: [], ...data };\n\n\tconst showSettings = Object.values(settings).length;\n\tconst showApis = apis.length;\n\n\tconst saveAppSettings = useCallback(async () => {\n\t\tconst { current } = settingsRef;\n\t\tsetIsSaving(true);\n\t\ttry {\n\t\t\tawait Apps.setAppSettings(\n\t\t\t\tid,\n\t\t\t\tObject.values(settings).map((value) => ({ ...value, value: current?.[value.id] })),\n\t\t\t);\n\t\t} catch (e) {\n\t\t\thandleAPIError(e);\n\t\t}\n\t\tsetIsSaving(false);\n\t}, [id, settings]);\n\n\treturn (\n\t\t<Page flexDirection='column'>\n\t\t\t<Page.Header title={t('App_Details')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button primary disabled={!hasUnsavedChanges || isSaving} onClick={saveAppSettings}>\n\t\t\t\t\t\t{!isSaving && t('Save_changes')}\n\t\t\t\t\t\t{isSaving && <Throbber inheritColor />}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button onClick={handleReturn}>\n\t\t\t\t\t\t<Icon name='back' />\n\t\t\t\t\t\t{t('Back')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<Box maxWidth='x600' w='full' alignSelf='center'>\n\t\t\t\t\t{!data && <LoadingDetails />}\n\t\t\t\t\t{data && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<AppDetailsPageContent app={data} />\n\t\t\t\t\t\t\t{!!showApis && <APIsDisplay apis={apis} />}\n\t\t\t\t\t\t\t{!!showSettings && (\n\t\t\t\t\t\t\t\t<SettingsDisplay settings={settings} setHasUnsavedChanges={setHasUnsavedChanges} settingsRef={settingsRef} />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</Box>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default AppDetailsPage;\n"]}