{"version":3,"sources":["meteor://ðŸ’»app/client/views/account/AccountProfilePage.js"],"names":["_regeneratorRuntime","module","link","default","v","_objectSpread","_slicedToArray","ButtonGroup","Button","Box","Icon","SHA256","React","useMemo","useState","useCallback","getUserEmailAddress","ConfirmOwnerChangeWarningModal","Page","useSetModal","useEndpoint","useMethod","useSetting","useToastMessageDispatch","useTranslation","useUser","useLogout","useForm","useUpdateAvatar","AccountProfileForm","ActionConfirmModal","getInitialValues","user","realname","name","email","username","password","confirmationPassword","avatar","url","avatarUrl","statusText","statusType","status","bio","customFields","nickname","AccountProfilePage","t","dispatchToastMessage","values","handlers","hasUnsavedChanges","commit","reset","canSave","setCanSave","setModal","logout","loggingOut","setLoggingOut","logoutOtherClients","deleteOwnAccount","saveFn","closeModal","localPassword","Boolean","services","exists","erasureType","allowRealNameChange","allowUserStatusMessageChange","canChangeUsername","allowEmailChange","allowPasswordChange","allowOAuthPasswordChange","allowUserAvatarChange","allowDeleteOwnAccount","requireName","namesRegexSetting","namesRegex","RegExp","settings","handleAvatar","handlePassword","handleConfirmationPassword","updateAvatar","_id","onSave","save","typedPassword","newPassword","avatarResult","type","message","handleLogoutOtherLocations","handleConfirmOwnerChange","passwordOrUsername","shouldChangeOwner","shouldBeRemoved","handleConfirm","handleDeleteOwnAccount","error","details","emails","exportDefault"],"mappings":"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","file":"dynamic/client/views/account/AccountProfilePage.js","sourcesContent":["import { ButtonGroup, Button, Box, Icon } from '@rocket.chat/fuselage';\nimport { SHA256 } from 'meteor/sha';\nimport React, { useMemo, useState, useCallback } from 'react';\n\nimport { getUserEmailAddress } from '../../../lib/getUserEmailAddress';\nimport ConfirmOwnerChangeWarningModal from '../../components/ConfirmOwnerChangeWarningModal';\nimport Page from '../../components/Page';\nimport { useSetModal } from '../../contexts/ModalContext';\nimport { useEndpoint, useMethod } from '../../contexts/ServerContext';\nimport { useSetting } from '../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../contexts/TranslationContext';\nimport { useUser, useLogout } from '../../contexts/UserContext';\nimport { useForm } from '../../hooks/useForm';\nimport { useUpdateAvatar } from '../../hooks/useUpdateAvatar';\nimport AccountProfileForm from './AccountProfileForm';\nimport ActionConfirmModal from './ActionConfirmModal';\n\nconst getInitialValues = (user) => ({\n\trealname: user.name ?? '',\n\temail: getUserEmailAddress(user) ?? '',\n\tusername: user.username ?? '',\n\tpassword: '',\n\tconfirmationPassword: '',\n\tavatar: '',\n\turl: user.avatarUrl ?? '',\n\tstatusText: user.statusText ?? '',\n\tstatusType: user.status ?? '',\n\tbio: user.bio ?? '',\n\tcustomFields: user.customFields ?? {},\n\tnickname: user.nickname ?? '',\n});\n\nconst AccountProfilePage = () => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst user = useUser();\n\n\tconst { values, handlers, hasUnsavedChanges, commit, reset } = useForm(getInitialValues(user ?? {}));\n\tconst [canSave, setCanSave] = useState(true);\n\tconst setModal = useSetModal();\n\tconst logout = useLogout();\n\tconst [loggingOut, setLoggingOut] = useState(false);\n\n\tconst logoutOtherClients = useEndpoint('POST', 'users.logoutOtherClients');\n\tconst deleteOwnAccount = useMethod('deleteUserOwnAccount');\n\tconst saveFn = useMethod('saveUserProfile');\n\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\n\tconst localPassword = Boolean(user?.services?.password?.exists);\n\n\tconst erasureType = useSetting('Message_ErasureType');\n\tconst allowRealNameChange = useSetting('Accounts_AllowRealNameChange');\n\tconst allowUserStatusMessageChange = useSetting('Accounts_AllowUserStatusMessageChange');\n\tconst canChangeUsername = useSetting('Accounts_AllowUsernameChange');\n\tconst allowEmailChange = useSetting('Accounts_AllowEmailChange');\n\tlet allowPasswordChange = useSetting('Accounts_AllowPasswordChange');\n\tconst allowOAuthPasswordChange = useSetting('Accounts_AllowPasswordChangeForOAuthUsers');\n\tconst allowUserAvatarChange = useSetting('Accounts_AllowUserAvatarChange');\n\tconst allowDeleteOwnAccount = useSetting('Accounts_AllowDeleteOwnAccount');\n\tconst requireName = useSetting('Accounts_RequireNameForSignUp');\n\tconst namesRegexSetting = useSetting('UTF8_User_Names_Validation');\n\n\tif (allowPasswordChange && !allowOAuthPasswordChange) {\n\t\tallowPasswordChange = localPassword;\n\t}\n\n\tconst namesRegex = useMemo(() => new RegExp(`^${namesRegexSetting}$`), [namesRegexSetting]);\n\n\tconst settings = useMemo(\n\t\t() => ({\n\t\t\tallowRealNameChange,\n\t\t\tallowUserStatusMessageChange,\n\t\t\tallowEmailChange,\n\t\t\tallowPasswordChange,\n\t\t\tallowUserAvatarChange,\n\t\t\tallowDeleteOwnAccount,\n\t\t\tcanChangeUsername,\n\t\t\trequireName,\n\t\t\tnamesRegex,\n\t\t}),\n\t\t[\n\t\t\tallowDeleteOwnAccount,\n\t\t\tallowEmailChange,\n\t\t\tallowPasswordChange,\n\t\t\tallowRealNameChange,\n\t\t\tallowUserAvatarChange,\n\t\t\tallowUserStatusMessageChange,\n\t\t\tcanChangeUsername,\n\t\t\trequireName,\n\t\t\tnamesRegex,\n\t\t],\n\t);\n\n\tconst { realname, email, avatar, username, password, statusText, statusType, customFields, bio, nickname } = values;\n\n\tconst { handleAvatar, handlePassword, handleConfirmationPassword } = handlers;\n\n\tconst updateAvatar = useUpdateAvatar(avatar, user?._id);\n\n\tconst onSave = useCallback(async () => {\n\t\tconst save = async (typedPassword) => {\n\t\t\ttry {\n\t\t\t\tawait saveFn(\n\t\t\t\t\t{\n\t\t\t\t\t\t...(allowRealNameChange && { realname }),\n\t\t\t\t\t\t...(allowEmailChange && getUserEmailAddress(user) !== email && { email }),\n\t\t\t\t\t\t...(allowPasswordChange && { newPassword: password }),\n\t\t\t\t\t\t...(canChangeUsername && { username }),\n\t\t\t\t\t\t...(allowUserStatusMessageChange && { statusText }),\n\t\t\t\t\t\t...(typedPassword && { typedPassword: SHA256(typedPassword) }),\n\t\t\t\t\t\tstatusType,\n\t\t\t\t\t\tnickname,\n\t\t\t\t\t\tbio: bio || '',\n\t\t\t\t\t},\n\t\t\t\t\tcustomFields,\n\t\t\t\t);\n\t\t\t\thandlePassword('');\n\t\t\t\thandleConfirmationPassword('');\n\t\t\t\tconst avatarResult = await updateAvatar();\n\t\t\t\tif (avatarResult) {\n\t\t\t\t\thandleAvatar('');\n\t\t\t\t}\n\t\t\t\tcommit();\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Profile_saved_successfully') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\t\tsave();\n\t}, [\n\t\tsaveFn,\n\t\tallowEmailChange,\n\t\tallowPasswordChange,\n\t\tallowRealNameChange,\n\t\tallowUserStatusMessageChange,\n\t\tbio,\n\t\tcanChangeUsername,\n\t\temail,\n\t\tpassword,\n\t\trealname,\n\t\tstatusText,\n\t\tusername,\n\t\tuser,\n\t\tupdateAvatar,\n\t\thandleAvatar,\n\t\tdispatchToastMessage,\n\t\tt,\n\t\tcustomFields,\n\t\tstatusType,\n\t\tcommit,\n\t\tnickname,\n\t\thandlePassword,\n\t\thandleConfirmationPassword,\n\t]);\n\n\tconst handleLogoutOtherLocations = useCallback(async () => {\n\t\tsetLoggingOut(true);\n\t\ttry {\n\t\t\tawait logoutOtherClients();\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'success',\n\t\t\t\tmessage: t('Logged_out_of_other_clients_successfully'),\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t\tsetLoggingOut(false);\n\t}, [logoutOtherClients, dispatchToastMessage, t]);\n\n\tconst handleConfirmOwnerChange = useCallback(\n\t\t(passwordOrUsername, shouldChangeOwner, shouldBeRemoved) => {\n\t\t\tconst handleConfirm = async () => {\n\t\t\t\ttry {\n\t\t\t\t\tawait deleteOwnAccount(SHA256(passwordOrUsername), true);\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_deleted') });\n\t\t\t\t\tcloseModal();\n\t\t\t\t\tlogout();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn setModal(() => (\n\t\t\t\t<ConfirmOwnerChangeWarningModal\n\t\t\t\t\tonConfirm={handleConfirm}\n\t\t\t\t\tonCancel={closeModal}\n\t\t\t\t\tcontentTitle={t(`Delete_User_Warning_${erasureType}`)}\n\t\t\t\t\tconfirmLabel={t('Delete')}\n\t\t\t\t\tshouldChangeOwner={shouldChangeOwner}\n\t\t\t\t\tshouldBeRemoved={shouldBeRemoved}\n\t\t\t\t/>\n\t\t\t));\n\t\t},\n\t\t[closeModal, erasureType, setModal, t, deleteOwnAccount, dispatchToastMessage, logout],\n\t);\n\n\tconst handleDeleteOwnAccount = useCallback(async () => {\n\t\tconst handleConfirm = async (passwordOrUsername) => {\n\t\t\ttry {\n\t\t\t\tawait deleteOwnAccount(SHA256(passwordOrUsername));\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_deleted') });\n\t\t\t\tlogout();\n\t\t\t} catch (error) {\n\t\t\t\tif (error.error === 'user-last-owner') {\n\t\t\t\t\tconst { shouldChangeOwner, shouldBeRemoved } = error.details;\n\t\t\t\t\treturn handleConfirmOwnerChange(passwordOrUsername, shouldChangeOwner, shouldBeRemoved);\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\t\treturn setModal(() => <ActionConfirmModal onConfirm={handleConfirm} onCancel={closeModal} isPassword={localPassword} />);\n\t}, [closeModal, dispatchToastMessage, localPassword, setModal, handleConfirmOwnerChange, deleteOwnAccount, logout, t]);\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('Profile')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button primary danger disabled={!hasUnsavedChanges} onClick={reset}>\n\t\t\t\t\t\t{t('Reset')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button primary disabled={!hasUnsavedChanges || !canSave || loggingOut} onClick={onSave}>\n\t\t\t\t\t\t{t('Save_changes')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<Box maxWidth='600px' w='full' alignSelf='center'>\n\t\t\t\t\t<AccountProfileForm\n\t\t\t\t\t\tvalues={values}\n\t\t\t\t\t\thandlers={handlers}\n\t\t\t\t\t\tuser={user ?? { emails: [] }}\n\t\t\t\t\t\tsettings={settings}\n\t\t\t\t\t\tonSaveStateChange={setCanSave}\n\t\t\t\t\t/>\n\t\t\t\t\t<ButtonGroup stretch mb='x12'>\n\t\t\t\t\t\t<Button onClick={handleLogoutOtherLocations} flexGrow={0} disabled={loggingOut}>\n\t\t\t\t\t\t\t{t('Logout_Others')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t{allowDeleteOwnAccount && (\n\t\t\t\t\t\t\t<Button danger onClick={handleDeleteOwnAccount}>\n\t\t\t\t\t\t\t\t<Icon name='trash' size='x20' mie='x4' />\n\t\t\t\t\t\t\t\t{t('Delete_my_account')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Box>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default AccountProfilePage;\n"]}