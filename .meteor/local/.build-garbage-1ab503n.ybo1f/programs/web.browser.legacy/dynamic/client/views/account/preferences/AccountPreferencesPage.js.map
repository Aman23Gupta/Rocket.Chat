{"version":3,"sources":["meteor://ðŸ’»app/client/views/account/preferences/AccountPreferencesPage.js"],"names":["_regeneratorRuntime","module","link","default","v","_slicedToArray","ButtonGroup","Button","Box","Accordion","React","useState","useCallback","useRef","Page","useMethod","useSetting","useToastMessageDispatch","useTranslation","PreferencesGlobalSection","PreferencesHighlightsSection","PreferencesLocalizationSection","PreferencesMessagesSection","PreferencesMyDataSection","PreferencesNotificationsSection","PreferencesSoundSection","PreferencesUserPresenceSection","AccountPreferencesPage","t","dispatchToastMessage","hasAnyChange","setHasAnyChange","saveData","commitRef","dataDownloadEnabled","onChange","initialValue","value","key","current","JSON","stringify","anyChange","Object","values","length","saveFn","handleSave","data","highlights","assign","split","map","val","trim","filter","Boolean","dontAskAgainList","list","Array","isArray","action","label","forEach","fn","type","message","exportDefault"],"mappings":";;;;;;;;AAAA,IAAIA,mBAAJ;;AAAwBC,MAAM,CAACC,IAAP,CAAY,4BAAZ,EAAyC;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,uBAAmB,GAACI,CAApB;AAAsB;AAA3C,CAAzC,EAAsF,CAAtF;;AAAyF,IAAIC,cAAJ;;AAAmBJ,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACC,kBAAc,GAACD,CAAf;AAAiB;AAAtC,CAAnD,EAA2F,CAA3F;AAApI,IAAIE,WAAJ,EAAgBC,MAAhB,EAAuBC,GAAvB,EAA2BC,SAA3B;AAAqCR,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACI,aAAW,EAAC,UAASF,CAAT,EAAW;AAACE,eAAW,GAACF,CAAZ;AAAc,GAAvC;AAAwCG,QAAM,EAAC,UAASH,CAAT,EAAW;AAACG,UAAM,GAACH,CAAP;AAAS,GAApE;AAAqEI,KAAG,EAAC,UAASJ,CAAT,EAAW;AAACI,OAAG,GAACJ,CAAJ;AAAM,GAA3F;AAA4FK,WAAS,EAAC,UAASL,CAAT,EAAW;AAACK,aAAS,GAACL,CAAV;AAAY;AAA9H,CAApC,EAAoK,CAApK;AAAuK,IAAIM,KAAJ,EAAUC,QAAV,EAAmBC,WAAnB,EAA+BC,MAA/B;AAAsCZ,MAAM,CAACC,IAAP,CAAY,OAAZ,EAAoB;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACM,SAAK,GAACN,CAAN;AAAQ,GAA7B;AAA8BO,UAAQ,EAAC,UAASP,CAAT,EAAW;AAACO,YAAQ,GAACP,CAAT;AAAW,GAA9D;AAA+DQ,aAAW,EAAC,UAASR,CAAT,EAAW;AAACQ,eAAW,GAACR,CAAZ;AAAc,GAArG;AAAsGS,QAAM,EAAC,UAAST,CAAT,EAAW;AAACS,UAAM,GAACT,CAAP;AAAS;AAAlI,CAApB,EAAwJ,CAAxJ;AAA2J,IAAIU,IAAJ;AAASb,MAAM,CAACC,IAAP,CAAY,0BAAZ,EAAuC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACU,QAAI,GAACV,CAAL;AAAO;AAA5B,CAAvC,EAAqE,CAArE;AAAwE,IAAIW,SAAJ;AAAcd,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAACa,WAAS,EAAC,UAASX,CAAT,EAAW;AAACW,aAAS,GAACX,CAAV;AAAY;AAAnC,CAA9C,EAAmF,CAAnF;AAAsF,IAAIY,UAAJ;AAAef,MAAM,CAACC,IAAP,CAAY,mCAAZ,EAAgD;AAACc,YAAU,EAAC,UAASZ,CAAT,EAAW;AAACY,cAAU,GAACZ,CAAX;AAAa;AAArC,CAAhD,EAAuF,CAAvF;AAA0F,IAAIa,uBAAJ;AAA4BhB,MAAM,CAACC,IAAP,CAAY,wCAAZ,EAAqD;AAACe,yBAAuB,EAAC,UAASb,CAAT,EAAW;AAACa,2BAAuB,GAACb,CAAxB;AAA0B;AAA/D,CAArD,EAAsH,CAAtH;AAAyH,IAAIc,cAAJ;AAAmBjB,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACgB,gBAAc,EAAC,UAASd,CAAT,EAAW;AAACc,kBAAc,GAACd,CAAf;AAAiB;AAA7C,CAAnD,EAAkG,CAAlG;AAAqG,IAAIe,wBAAJ;AAA6BlB,MAAM,CAACC,IAAP,CAAY,4BAAZ,EAAyC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACe,4BAAwB,GAACf,CAAzB;AAA2B;AAAhD,CAAzC,EAA2F,CAA3F;AAA8F,IAAIgB,4BAAJ;AAAiCnB,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACgB,gCAA4B,GAAChB,CAA7B;AAA+B;AAApD,CAA7C,EAAmG,CAAnG;AAAsG,IAAIiB,8BAAJ;AAAmCpB,MAAM,CAACC,IAAP,CAAY,kCAAZ,EAA+C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACiB,kCAA8B,GAACjB,CAA/B;AAAiC;AAAtD,CAA/C,EAAuG,CAAvG;AAA0G,IAAIkB,0BAAJ;AAA+BrB,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACkB,8BAA0B,GAAClB,CAA3B;AAA6B;AAAlD,CAA3C,EAA+F,EAA/F;AAAmG,IAAImB,wBAAJ;AAA6BtB,MAAM,CAACC,IAAP,CAAY,4BAAZ,EAAyC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACmB,4BAAwB,GAACnB,CAAzB;AAA2B;AAAhD,CAAzC,EAA2F,EAA3F;AAA+F,IAAIoB,+BAAJ;AAAoCvB,MAAM,CAACC,IAAP,CAAY,mCAAZ,EAAgD;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACoB,mCAA+B,GAACpB,CAAhC;AAAkC;AAAvD,CAAhD,EAAyG,EAAzG;AAA6G,IAAIqB,uBAAJ;AAA4BxB,MAAM,CAACC,IAAP,CAAY,2BAAZ,EAAwC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACqB,2BAAuB,GAACrB,CAAxB;AAA0B;AAA/C,CAAxC,EAAyF,EAAzF;AAA6F,IAAIsB,8BAAJ;AAAmCzB,MAAM,CAACC,IAAP,CAAY,kCAAZ,EAA+C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACsB,kCAA8B,GAACtB,CAA/B;AAAiC;AAAtD,CAA/C,EAAuG,EAAvG;;AAiBl3D,IAAMuB,sBAAsB,GAAG,YAAM;AACpC,MAAMC,CAAC,GAAGV,cAAc,EAAxB;AACA,MAAMW,oBAAoB,GAAGZ,uBAAuB,EAApD;;AAEA,kBAAwCN,QAAQ,CAAC,KAAD,CAAhD;AAAA;AAAA,MAAOmB,YAAP;AAAA,MAAqBC,eAArB;;AAEA,MAAMC,QAAQ,GAAGnB,MAAM,CAAC,EAAD,CAAvB;AACA,MAAMoB,SAAS,GAAGpB,MAAM,CAAC,EAAD,CAAxB;AAEA,MAAMqB,mBAAmB,GAAGlB,UAAU,CAAC,yBAAD,CAAtC;AAEA,MAAMmB,QAAQ,GAAGvB,WAAW,CAC3B,gBAAkC;AAAA,QAA/BwB,YAA+B,QAA/BA,YAA+B;AAAA,QAAjBC,KAAiB,QAAjBA,KAAiB;AAAA,QAAVC,GAAU,QAAVA,GAAU;AACjC,QAAQC,OAAR,GAAoBP,QAApB,CAAQO,OAAR;;AACA,QAAIC,IAAI,CAACC,SAAL,CAAeL,YAAf,MAAiCI,IAAI,CAACC,SAAL,CAAeJ,KAAf,CAArC,EAA4D;AAC3DE,aAAO,CAACD,GAAD,CAAP,GAAeD,KAAf;AACA,KAFD,MAEO;AACN,aAAOE,OAAO,CAACD,GAAD,CAAd;AACA;;AAED,QAAMI,SAAS,GAAG,CAAC,CAACC,MAAM,CAACC,MAAP,CAAcL,OAAd,EAAuBM,MAA3C;;AACA,QAAIH,SAAS,KAAKZ,YAAlB,EAAgC;AAC/BC,qBAAe,CAACW,SAAD,CAAf;AACA;AACD,GAb0B,EAc3B,CAACZ,YAAD,CAd2B,CAA5B;AAiBA,MAAMgB,MAAM,GAAG/B,SAAS,CAAC,qBAAD,CAAxB;AAEA,MAAMgC,UAAU,GAAGnC,WAAW;AAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEZoC,oBAFY,GAEHhB,QAFG,CAErBO,OAFqB;;AAG7B,oBAAIS,IAAI,CAACC,UAAL,IAAmBD,IAAI,CAACC,UAAL,KAAoB,EAA3C,EAA+C;AAC9CN,wBAAM,CAACO,MAAP,CAAcF,IAAd,EAAoB;AACnBC,8BAAU,EAAED,IAAI,CAACC,UAAL,CACVE,KADU,CACJ,MADI,EAEVC,GAFU,CAEN,UAACC,GAAD;AAAA,6BAASA,GAAG,CAACC,IAAJ,EAAT;AAAA,qBAFM,EAGVC,MAHU,CAGHC,OAHG;AADO,mBAApB;AAMA;;AAED,oBAAIR,IAAI,CAACS,gBAAT,EAA2B;AACpBC,sBADoB,GAEzBC,KAAK,CAACC,OAAN,CAAcZ,IAAI,CAACS,gBAAnB,KAAwCT,IAAI,CAACS,gBAAL,CAAsBZ,MAAtB,GAA+B,CAAvE,GACGG,IAAI,CAACS,gBAAL,CAAsBL,GAAtB,CAA0B;AAAA;AAAA,wBAAES,MAAF;AAAA,wBAAUC,KAAV;;AAAA,2BAAsB;AAAED,4BAAM,EAANA,MAAF;AAAUC,2BAAK,EAALA;AAAV,qBAAtB;AAAA,mBAA1B,CADH,GAEG,EAJsB;AAK1BnB,wBAAM,CAACO,MAAP,CAAcF,IAAd,EAAoB;AAAES,oCAAgB,EAAEC;AAApB,mBAApB;AACA;;AAlB4B;AAAA,iDAoBvBZ,MAAM,CAACE,IAAD,CApBiB;;AAAA;AAqB7BhB,wBAAQ,CAACO,OAAT,GAAmB,EAAnB;AACAR,+BAAe,CAAC,KAAD,CAAf;AACAY,sBAAM,CAACC,MAAP,CAAcX,SAAS,CAACM,OAAxB,EAAiCwB,OAAjC,CAAyC,UAACC,EAAD;AAAA,yBAAQA,EAAE,EAAV;AAAA,iBAAzC;AAEAnC,oCAAoB,CAAC;AAAEoC,sBAAI,EAAE,SAAR;AAAmBC,yBAAO,EAAEtC,CAAC,CAAC,mBAAD;AAA7B,iBAAD,CAApB;AAzB6B;AAAA;;AAAA;AAAA;AAAA;AA2B7BC,oCAAoB,CAAC;AAAEoC,sBAAI,EAAE,OAAR;AAAiBC,yBAAO;AAAxB,iBAAD,CAApB;;AA3B6B;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAD;AAAA,OA6B3B,CAACrC,oBAAD,EAAuBiB,MAAvB,EAA+BlB,CAA/B,CA7B2B,CAA9B;AA+BA,sBACC,oBAAC,IAAD,qBACC,oBAAC,IAAD,CAAM,MAAN;AAAa,SAAK,EAAEA,CAAC,CAAC,aAAD;AAArB,kBACC,oBAAC,WAAD,qBACC,oBAAC,MAAD;AAAQ,WAAO,MAAf;AAAgB,YAAQ,EAAE,CAACE,YAA3B;AAAyC,WAAO,EAAEiB;AAAlD,KACEnB,CAAC,CAAC,cAAD,CADH,CADD,CADD,CADD,eAQC,oBAAC,IAAD,CAAM,2BAAN,qBACC,oBAAC,GAAD;AAAK,YAAQ,EAAC,MAAd;AAAqB,KAAC,EAAC,MAAvB;AAA8B,aAAS,EAAC;AAAxC,kBACC,oBAAC,SAAD,qBACC,oBAAC,8BAAD;AAAgC,aAAS,EAAEK,SAA3C;AAAsD,YAAQ,EAAEE,QAAhE;AAA0E,mBAAe;AAAzF,IADD,eAEC,oBAAC,wBAAD;AAA0B,aAAS,EAAEF,SAArC;AAAgD,YAAQ,EAAEE;AAA1D,IAFD,eAGC,oBAAC,8BAAD;AAAgC,aAAS,EAAEF,SAA3C;AAAsD,YAAQ,EAAEE;AAAhE,IAHD,eAIC,oBAAC,+BAAD;AAAiC,aAAS,EAAEF,SAA5C;AAAuD,YAAQ,EAAEE;AAAjE,IAJD,eAKC,oBAAC,0BAAD;AAA4B,aAAS,EAAEF,SAAvC;AAAkD,YAAQ,EAAEE;AAA5D,IALD,eAMC,oBAAC,4BAAD;AAA8B,aAAS,EAAEF,SAAzC;AAAoD,YAAQ,EAAEE;AAA9D,IAND,eAOC,oBAAC,uBAAD;AAAyB,aAAS,EAAEF,SAApC;AAA+C,YAAQ,EAAEE;AAAzD,IAPD,EAQED,mBAAmB,iBAAI,oBAAC,wBAAD;AAA0B,YAAQ,EAAEC;AAApC,IARzB,CADD,CADD,CARD,CADD;AAyBA,CAtFD;;AAjBAlC,MAAM,CAACkE,aAAP,CAyGexC,sBAzGf,E","file":"dynamic/client/views/account/preferences/AccountPreferencesPage.js","sourcesContent":["import { ButtonGroup, Button, Box, Accordion } from '@rocket.chat/fuselage';\nimport React, { useState, useCallback, useRef } from 'react';\n\nimport Page from '../../../components/Page';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useSetting } from '../../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport PreferencesGlobalSection from './PreferencesGlobalSection';\nimport PreferencesHighlightsSection from './PreferencesHighlightsSection';\nimport PreferencesLocalizationSection from './PreferencesLocalizationSection';\nimport PreferencesMessagesSection from './PreferencesMessagesSection';\nimport PreferencesMyDataSection from './PreferencesMyDataSection';\nimport PreferencesNotificationsSection from './PreferencesNotificationsSection';\nimport PreferencesSoundSection from './PreferencesSoundSection';\nimport PreferencesUserPresenceSection from './PreferencesUserPresenceSection';\n\nconst AccountPreferencesPage = () => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [hasAnyChange, setHasAnyChange] = useState(false);\n\n\tconst saveData = useRef({});\n\tconst commitRef = useRef({});\n\n\tconst dataDownloadEnabled = useSetting('UserData_EnableDownload');\n\n\tconst onChange = useCallback(\n\t\t({ initialValue, value, key }) => {\n\t\t\tconst { current } = saveData;\n\t\t\tif (JSON.stringify(initialValue) !== JSON.stringify(value)) {\n\t\t\t\tcurrent[key] = value;\n\t\t\t} else {\n\t\t\t\tdelete current[key];\n\t\t\t}\n\n\t\t\tconst anyChange = !!Object.values(current).length;\n\t\t\tif (anyChange !== hasAnyChange) {\n\t\t\t\tsetHasAnyChange(anyChange);\n\t\t\t}\n\t\t},\n\t\t[hasAnyChange],\n\t);\n\n\tconst saveFn = useMethod('saveUserPreferences');\n\n\tconst handleSave = useCallback(async () => {\n\t\ttry {\n\t\t\tconst { current: data } = saveData;\n\t\t\tif (data.highlights || data.highlights === '') {\n\t\t\t\tObject.assign(data, {\n\t\t\t\t\thighlights: data.highlights\n\t\t\t\t\t\t.split(/,|\\n/)\n\t\t\t\t\t\t.map((val) => val.trim())\n\t\t\t\t\t\t.filter(Boolean),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (data.dontAskAgainList) {\n\t\t\t\tconst list =\n\t\t\t\t\tArray.isArray(data.dontAskAgainList) && data.dontAskAgainList.length > 0\n\t\t\t\t\t\t? data.dontAskAgainList.map(([action, label]) => ({ action, label }))\n\t\t\t\t\t\t: [];\n\t\t\t\tObject.assign(data, { dontAskAgainList: list });\n\t\t\t}\n\n\t\t\tawait saveFn(data);\n\t\t\tsaveData.current = {};\n\t\t\tsetHasAnyChange(false);\n\t\t\tObject.values(commitRef.current).forEach((fn) => fn());\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Preferences_saved') });\n\t\t} catch (e) {\n\t\t\tdispatchToastMessage({ type: 'error', message: e });\n\t\t}\n\t}, [dispatchToastMessage, saveFn, t]);\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('Preferences')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button primary disabled={!hasAnyChange} onClick={handleSave}>\n\t\t\t\t\t\t{t('Save_changes')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<Box maxWidth='x600' w='full' alignSelf='center'>\n\t\t\t\t\t<Accordion>\n\t\t\t\t\t\t<PreferencesLocalizationSection commitRef={commitRef} onChange={onChange} defaultExpanded />\n\t\t\t\t\t\t<PreferencesGlobalSection commitRef={commitRef} onChange={onChange} />\n\t\t\t\t\t\t<PreferencesUserPresenceSection commitRef={commitRef} onChange={onChange} />\n\t\t\t\t\t\t<PreferencesNotificationsSection commitRef={commitRef} onChange={onChange} />\n\t\t\t\t\t\t<PreferencesMessagesSection commitRef={commitRef} onChange={onChange} />\n\t\t\t\t\t\t<PreferencesHighlightsSection commitRef={commitRef} onChange={onChange} />\n\t\t\t\t\t\t<PreferencesSoundSection commitRef={commitRef} onChange={onChange} />\n\t\t\t\t\t\t{dataDownloadEnabled && <PreferencesMyDataSection onChange={onChange} />}\n\t\t\t\t\t</Accordion>\n\t\t\t\t</Box>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default AccountPreferencesPage;\n"]}