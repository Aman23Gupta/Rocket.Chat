{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/NotificationPreferences/NotificationPreferencesWithData.js"],"names":["_toConsumableArray","module","link","default","v","useMutableCallback","React","memo","useCustomSound","useTranslation","useUserSubscription","useEndpointActionExperimental","useForm","useTabBarClose","NotificationPreferences","NotificationPreferencesWithData","rid","t","subscription","customSound","handleClose","saveSettings","turnOn","disableNotifications","muteGroupMentions","showCounter","hideUnreadStatus","desktopAlert","desktopPrefOrigin","desktopNotifications","desktopSound","audioNotificationValue","mobileAlert","mobilePrefOrigin","mobilePushNotifications","emailAlert","emailPrefOrigin","emailNotifications","values","handlers","hasUnsavedChanges","commit","defaultOption","customSoundAsset","Object","entries","list","get","map","value","name","handleOptions","alerts","audio","sound","handlePlaySound","play","handleSaveButton","notifications","roomId","exportDefault"],"mappings":"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","file":"dynamic/client/views/room/contextualBar/NotificationPreferences/NotificationPreferencesWithData.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { memo } from 'react';\n\nimport { useCustomSound } from '../../../../contexts/CustomSoundContext';\nimport { useTranslation } from '../../../../contexts/TranslationContext';\nimport { useUserSubscription } from '../../../../contexts/UserContext';\nimport { useEndpointActionExperimental } from '../../../../hooks/useEndpointActionExperimental';\nimport { useForm } from '../../../../hooks/useForm';\nimport { useTabBarClose } from '../../providers/ToolboxProvider';\nimport NotificationPreferences from './NotificationPreferences';\n\nconst NotificationPreferencesWithData = ({ rid }) => {\n\tconst t = useTranslation();\n\n\tconst subscription = useUserSubscription(rid);\n\n\tconst customSound = useCustomSound();\n\tconst handleClose = useTabBarClose();\n\tconst saveSettings = useEndpointActionExperimental('POST', 'rooms.saveNotification', t('Room_updated_successfully'));\n\n\tconst { values, handlers, hasUnsavedChanges, commit } = useForm({\n\t\tturnOn: !subscription?.disableNotifications,\n\t\tmuteGroupMentions: subscription?.muteGroupMentions,\n\t\tshowCounter: !subscription?.hideUnreadStatus,\n\t\tdesktopAlert: (subscription?.desktopPrefOrigin === 'subscription' && subscription.desktopNotifications) || 'default',\n\t\tdesktopSound: subscription?.audioNotificationValue || 'default',\n\t\tmobileAlert: (subscription?.mobilePrefOrigin === 'subscription' && subscription.mobilePushNotifications) || 'default',\n\t\temailAlert: (subscription?.emailPrefOrigin === 'subscription' && subscription.emailNotifications) || 'default',\n\t});\n\n\tconst defaultOption = [\n\t\t['default', t('Default')],\n\t\t['all', t('All_messages')],\n\t\t['mentions', t('Mentions')],\n\t\t['nothing', t('Nothing')],\n\t];\n\n\tconst customSoundAsset = Object.entries(customSound.list.get()).map((value) => [value[0], value[1].name]);\n\n\tconst handleOptions = {\n\t\talerts: defaultOption,\n\t\taudio: defaultOption,\n\t\tsound: [['none None', t('None')], ['default', t('Default')], ...customSoundAsset],\n\t};\n\n\tconst handlePlaySound = () => customSound.play(values.desktopSound);\n\n\tconst handleSaveButton = useMutableCallback(() => {\n\t\tconst notifications = {};\n\n\t\tnotifications.disableNotifications = values.turnOn ? '0' : '1';\n\t\tnotifications.muteGroupMentions = values.muteGroupMentions ? '1' : '0';\n\t\tnotifications.hideUnreadStatus = values.showCounter ? '0' : '1';\n\t\tnotifications.desktopNotifications = values.desktopAlert;\n\t\tnotifications.audioNotificationValue = values.desktopSound;\n\t\tnotifications.mobilePushNotifications = values.mobileAlert;\n\t\tnotifications.emailNotifications = values.emailAlert;\n\n\t\tsaveSettings({\n\t\t\troomId: rid,\n\t\t\tnotifications,\n\t\t});\n\n\t\tcommit();\n\t});\n\n\treturn (\n\t\t<NotificationPreferences\n\t\t\thandleClose={handleClose}\n\t\t\tformValues={values}\n\t\t\tformHandlers={handlers}\n\t\t\tformHasUnsavedChanges={hasUnsavedChanges}\n\t\t\thandlePlaySound={handlePlaySound}\n\t\t\thandleOptions={handleOptions}\n\t\t\thandleSaveButton={handleSaveButton}\n\t\t/>\n\t);\n};\n\nexport default memo(NotificationPreferencesWithData);\n"]}