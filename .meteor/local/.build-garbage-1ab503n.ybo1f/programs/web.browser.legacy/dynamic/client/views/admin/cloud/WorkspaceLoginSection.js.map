{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/cloud/WorkspaceLoginSection.js"],"names":["_regeneratorRuntime","module","link","default","v","_extends","_slicedToArray","_objectWithoutProperties","Box","Button","ButtonGroup","useSafely","React","useState","useEffect","useMethod","useToastMessageDispatch","useTranslation","WorkspaceLoginSection","onRegisterStatusChange","props","t","dispatchToastMessage","checkUserLoggedIn","getOAuthAuthorizationUrl","logout","disconnectWorkspace","isLoggedIn","setLoggedIn","isLoading","setLoading","handleLoginButtonClick","url","window","location","href","type","message","handleLogoutButtonClick","handleDisconnectButtonClick","success","Error","checkLoginState","exportDefault"],"mappings":"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","file":"dynamic/client/views/admin/cloud/WorkspaceLoginSection.js","sourcesContent":["import { Box, Button, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, useEffect } from 'react';\n\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\n\nfunction WorkspaceLoginSection({ onRegisterStatusChange, ...props }) {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst checkUserLoggedIn = useMethod('cloud:checkUserLoggedIn');\n\tconst getOAuthAuthorizationUrl = useMethod('cloud:getOAuthAuthorizationUrl');\n\tconst logout = useMethod('cloud:logout');\n\tconst disconnectWorkspace = useMethod('cloud:disconnectWorkspace');\n\n\tconst [isLoggedIn, setLoggedIn] = useSafely(useState(false));\n\tconst [isLoading, setLoading] = useSafely(useState(true));\n\n\tconst handleLoginButtonClick = async () => {\n\t\tsetLoading(true);\n\n\t\ttry {\n\t\t\tconst url = await getOAuthAuthorizationUrl();\n\t\t\twindow.location.href = url;\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t} finally {\n\t\t\tsetLoading(false);\n\t\t}\n\t};\n\n\tconst handleLogoutButtonClick = async () => {\n\t\tsetLoading(true);\n\n\t\ttry {\n\t\t\tawait logout();\n\t\t\tconst isLoggedIn = await checkUserLoggedIn();\n\t\t\tsetLoggedIn(isLoggedIn);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t} finally {\n\t\t\tsetLoading(false);\n\t\t}\n\t};\n\n\tconst handleDisconnectButtonClick = async () => {\n\t\tsetLoading(true);\n\n\t\ttry {\n\t\t\tconst success = await disconnectWorkspace();\n\n\t\t\tif (!success) {\n\t\t\t\tthrow Error(t('An error occured disconnecting'));\n\t\t\t}\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Disconnected') });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t} finally {\n\t\t\tawait (onRegisterStatusChange && onRegisterStatusChange());\n\t\t\tsetLoading(false);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tconst checkLoginState = async () => {\n\t\t\tsetLoading(true);\n\n\t\t\ttry {\n\t\t\t\tconst isLoggedIn = await checkUserLoggedIn();\n\t\t\t\tsetLoggedIn(isLoggedIn);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tsetLoading(false);\n\t\t\t}\n\t\t};\n\n\t\tcheckLoginState();\n\t}, [checkUserLoggedIn, dispatchToastMessage, setLoading, setLoggedIn]);\n\n\treturn (\n\t\t<Box is='section' {...props}>\n\t\t\t<Box withRichContent color='neutral-800'>\n\t\t\t\t<p>{t('Cloud_workspace_connected')}</p>\n\t\t\t</Box>\n\n\t\t\t<ButtonGroup>\n\t\t\t\t{isLoggedIn ? (\n\t\t\t\t\t<Button primary danger disabled={isLoading} onClick={handleLogoutButtonClick}>\n\t\t\t\t\t\t{t('Cloud_logout')}\n\t\t\t\t\t</Button>\n\t\t\t\t) : (\n\t\t\t\t\t<Button primary disabled={isLoading} onClick={handleLoginButtonClick}>\n\t\t\t\t\t\t{t('Cloud_login_to_cloud')}\n\t\t\t\t\t</Button>\n\t\t\t\t)}\n\t\t\t</ButtonGroup>\n\n\t\t\t<Box withRichContent color='neutral-800'>\n\t\t\t\t<p>{t('Cloud_workspace_disconnect')}</p>\n\t\t\t</Box>\n\n\t\t\t<ButtonGroup>\n\t\t\t\t<Button primary danger disabled={isLoading} onClick={handleDisconnectButtonClick}>\n\t\t\t\t\t{t('Disconnect')}\n\t\t\t\t</Button>\n\t\t\t</ButtonGroup>\n\t\t</Box>\n\t);\n}\n\nexport default WorkspaceLoginSection;\n"]}