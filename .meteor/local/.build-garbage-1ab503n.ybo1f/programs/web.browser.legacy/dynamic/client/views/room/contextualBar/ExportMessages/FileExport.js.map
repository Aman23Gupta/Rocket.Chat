{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/ExportMessages/FileExport.js"],"names":["_regeneratorRuntime","module","link","default","v","_objectSpread","Field","TextInput","Select","ButtonGroup","Button","FieldGroup","React","useMemo","useEndpoint","useToastMessageDispatch","useTranslation","useForm","FileExport","onCancel","rid","t","dateFrom","dateTo","format","values","handlers","handleDateFrom","handleDateTo","handleFormat","outputOptions","roomsExport","dispatchToastMessage","handleSubmit","type","Date","message","exportDefault"],"mappings":"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","file":"dynamic/client/views/room/contextualBar/ExportMessages/FileExport.js","sourcesContent":["import { Field, TextInput, Select, ButtonGroup, Button, FieldGroup } from '@rocket.chat/fuselage';\nimport React, { useMemo } from 'react';\n\nimport { useEndpoint } from '../../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../contexts/TranslationContext';\nimport { useForm } from '../../../../hooks/useForm';\n\nconst FileExport = ({ onCancel, rid }) => {\n\tconst t = useTranslation();\n\n\tconst { values, handlers } = useForm({\n\t\tdateFrom: '',\n\t\tdateTo: '',\n\t\tformat: 'html',\n\t});\n\n\tconst { dateFrom, dateTo, format } = values;\n\n\tconst { handleDateFrom, handleDateTo, handleFormat } = handlers;\n\n\tconst outputOptions = useMemo(\n\t\t() => [\n\t\t\t['html', t('HTML')],\n\t\t\t['json', t('JSON')],\n\t\t],\n\t\t[t],\n\t);\n\n\tconst roomsExport = useEndpoint('POST', 'rooms.export');\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst handleSubmit = async () => {\n\t\ttry {\n\t\t\tawait roomsExport({\n\t\t\t\trid,\n\t\t\t\ttype: 'file',\n\t\t\t\t...(dateFrom && { dateFrom: new Date(dateFrom) }),\n\t\t\t\t...(dateTo && { dateTo: new Date(dateTo) }),\n\t\t\t\tformat,\n\t\t\t});\n\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'success',\n\t\t\t\tmessage: t('Your_email_has_been_queued_for_sending'),\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: error,\n\t\t\t});\n\t\t}\n\t};\n\n\treturn (\n\t\t<FieldGroup>\n\t\t\t<Field>\n\t\t\t\t<Field.Label>{t('Date_From')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput type='date' value={dateFrom} onChange={handleDateFrom} />\n\t\t\t\t</Field.Row>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<Field.Label>{t('Date_to')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput type='date' value={dateTo} onChange={handleDateTo} />\n\t\t\t\t</Field.Row>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<Field.Label>{t('Output_format')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<Select value={format} onChange={handleFormat} placeholder={t('Format')} options={outputOptions} />\n\t\t\t\t</Field.Row>\n\t\t\t</Field>\n\t\t\t<ButtonGroup stretch mb='x12'>\n\t\t\t\t<Button onClick={onCancel}>{t('Cancel')}</Button>\n\t\t\t\t<Button primary onClick={() => handleSubmit()}>\n\t\t\t\t\t{t('Export')}\n\t\t\t\t</Button>\n\t\t\t</ButtonGroup>\n\t\t</FieldGroup>\n\t);\n};\n\nexport default FileExport;\n"]}