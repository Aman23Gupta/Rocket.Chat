{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/mailer/MailerRoute.js"],"names":["module","export","MailerRoute","React","link","v","NotAuthorizedPage","usePermission","useMethod","useToastMessageDispatch","useTranslation","Mailer","useSendMail","meteorSendMail","t","dispatchToastMessage","fromEmail","subject","emailBody","dryRun","query","error","type","message","length","indexOf","value","canAccessMailer","sendMail"],"mappings":"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","file":"dynamic/client/views/admin/mailer/MailerRoute.js","sourcesContent":["import React from 'react';\n\nimport NotAuthorizedPage from '../../../components/NotAuthorizedPage';\nimport { usePermission } from '../../../contexts/AuthorizationContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { Mailer } from './Mailer';\n\nconst useSendMail = () => {\n\tconst meteorSendMail = useMethod('Mailer.sendMail');\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\treturn ({ fromEmail, subject, emailBody, dryRun, query }) => {\n\t\tif (query.error) {\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: t('Query_is_not_valid_JSON'),\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (fromEmail.error || fromEmail.length < 1) {\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: t('error-invalid-from-address'),\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (emailBody.indexOf('[unsubscribe]') === -1) {\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: t('error-missing-unsubscribe-link'),\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tmeteorSendMail(fromEmail.value, subject, emailBody, dryRun, query.value);\n\t\tdispatchToastMessage({\n\t\t\ttype: 'success',\n\t\t\tmessage: t('The_emails_are_being_sent'),\n\t\t});\n\t};\n};\n\nexport default function MailerRoute() {\n\tconst canAccessMailer = usePermission('access-mailer');\n\tconst sendMail = useSendMail();\n\n\tif (!canAccessMailer) {\n\t\treturn <NotAuthorizedPage />;\n\t}\n\n\treturn <Mailer sendMail={sendMail} />;\n}\n"]}