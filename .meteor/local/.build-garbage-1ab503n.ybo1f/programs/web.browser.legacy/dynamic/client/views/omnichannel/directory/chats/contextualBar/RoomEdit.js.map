{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/directory/chats/contextualBar/RoomEdit.js"],"names":["_regeneratorRuntime","module","link","default","v","_objectSpread","_slicedToArray","Field","TextInput","ButtonGroup","Button","useMutableCallback","React","useState","useMemo","useSubscription","hasAtLeastOnePermission","CustomFieldsForm","Tags","VerticalBar","useMethod","useToastMessageDispatch","useTranslation","AsyncStatePhase","useEndpointData","useForm","formsSubscription","FormSkeleton","initialValuesRoom","topic","tags","livechatData","priorityId","getInitialValuesRoom","room","RoomEdit","visitor","reload","reloadInfo","close","t","valuesRoom","values","handlersRoom","handlers","hasUnsavedChangesRoom","hasUnsavedChanges","canViewCustomFields","handleTopic","handleTags","handlePriorityId","forms","usePrioritiesSelect","PrioritiesSelect","valueCustom","handleValueCustom","hasUnsavedChangesCustomFields","handleLivechatData","customFieldsError","setCustomFieldsError","allCustomFields","value","stateCustomFields","phase","prioritiesResult","statePriorities","jsonConverterToValidFormat","customFields","jsonObj","forEach","_id","label","visibility","options","scope","defaultValue","required","type","split","map","item","trim","jsonCustomField","dispatchToastMessage","saveRoom","handleSave","e","preventDefault","userData","roomData","sort","message","error","formIsValid","length","includes","LOADING","priorities","exportDefault"],"mappings":"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","file":"dynamic/client/views/omnichannel/directory/chats/contextualBar/RoomEdit.js","sourcesContent":["import { Field, TextInput, ButtonGroup, Button } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, useMemo } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { hasAtLeastOnePermission } from '../../../../../../app/authorization/client';\nimport CustomFieldsForm from '../../../../../components/CustomFieldsForm';\nimport Tags from '../../../../../components/Omnichannel/Tags';\nimport VerticalBar from '../../../../../components/VerticalBar';\nimport { useMethod } from '../../../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../../contexts/TranslationContext';\nimport { AsyncStatePhase } from '../../../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../../../hooks/useEndpointData';\nimport { useForm } from '../../../../../hooks/useForm';\nimport { formsSubscription } from '../../../additionalForms';\nimport { FormSkeleton } from '../../Skeleton';\n\nconst initialValuesRoom = {\n\ttopic: '',\n\ttags: [],\n\tlivechatData: {},\n\tpriorityId: '',\n};\n\nconst getInitialValuesRoom = (room) => {\n\tif (!room) {\n\t\treturn initialValuesRoom;\n\t}\n\n\tconst { topic, tags, livechatData, priorityId } = room;\n\n\treturn {\n\t\ttopic: topic ?? '',\n\t\ttags: tags ?? [],\n\t\tlivechatData: livechatData ?? {},\n\t\tpriorityId: priorityId ?? '',\n\t};\n};\n\nfunction RoomEdit({ room, visitor, reload, reloadInfo, close }) {\n\tconst t = useTranslation();\n\n\tconst { values: valuesRoom, handlers: handlersRoom, hasUnsavedChanges: hasUnsavedChangesRoom } = useForm(getInitialValuesRoom(room));\n\tconst canViewCustomFields = () => hasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n\n\tconst { handleTopic, handleTags, handlePriorityId } = handlersRoom;\n\tconst { topic, tags, priorityId } = valuesRoom;\n\n\tconst forms = useSubscription(formsSubscription);\n\n\tconst { usePrioritiesSelect = () => {} } = forms;\n\n\tconst PrioritiesSelect = usePrioritiesSelect();\n\n\tconst {\n\t\tvalues: valueCustom,\n\t\thandlers: handleValueCustom,\n\t\thasUnsavedChanges: hasUnsavedChangesCustomFields,\n\t} = useForm({\n\t\tlivechatData: valuesRoom.livechatData,\n\t});\n\n\tconst { handleLivechatData } = handleValueCustom;\n\tconst { livechatData } = valueCustom;\n\n\tconst [customFieldsError, setCustomFieldsError] = useState([]);\n\n\tconst { value: allCustomFields, phase: stateCustomFields } = useEndpointData('livechat/custom-fields');\n\tconst { value: prioritiesResult = {}, phase: statePriorities } = useEndpointData('livechat/priorities.list');\n\n\tconst jsonConverterToValidFormat = (customFields) => {\n\t\tconst jsonObj = {};\n\t\tcustomFields.forEach(({ _id, label, visibility, options, scope, defaultValue, required }) => {\n\t\t\t(visibility === 'visible') & (scope === 'room') &&\n\t\t\t\t(jsonObj[_id] = {\n\t\t\t\t\tlabel,\n\t\t\t\t\ttype: options ? 'select' : 'text',\n\t\t\t\t\trequired,\n\t\t\t\t\tdefaultValue,\n\t\t\t\t\toptions: options && options.split(',').map((item) => item.trim()),\n\t\t\t\t});\n\t\t});\n\t\treturn jsonObj;\n\t};\n\n\tconst jsonCustomField = useMemo(\n\t\t() => (allCustomFields && allCustomFields.customFields ? jsonConverterToValidFormat(allCustomFields.customFields) : {}),\n\t\t[allCustomFields],\n\t);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst saveRoom = useMethod('livechat:saveInfo');\n\n\tconst handleSave = useMutableCallback(async (e) => {\n\t\te.preventDefault();\n\t\tconst userData = {\n\t\t\t_id: visitor._id,\n\t\t};\n\n\t\tconst roomData = {\n\t\t\t_id: room._id,\n\t\t\ttopic,\n\t\t\ttags: tags.sort(),\n\t\t\tlivechatData,\n\t\t\t...(priorityId && { priorityId }),\n\t\t};\n\n\t\ttry {\n\t\t\tsaveRoom(userData, roomData);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload && reload();\n\t\t\treloadInfo && reloadInfo();\n\t\t\tclose();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst formIsValid = (hasUnsavedChangesRoom || hasUnsavedChangesCustomFields) && customFieldsError.length === 0;\n\n\tif ([stateCustomFields, statePriorities].includes(AsyncStatePhase.LOADING)) {\n\t\treturn <FormSkeleton />;\n\t}\n\n\tconst { priorities } = prioritiesResult;\n\n\treturn (\n\t\t<>\n\t\t\t<VerticalBar.ScrollableContent is='form'>\n\t\t\t\t{canViewCustomFields() && allCustomFields && (\n\t\t\t\t\t<CustomFieldsForm\n\t\t\t\t\t\tjsonCustomFields={jsonCustomField}\n\t\t\t\t\t\tcustomFieldsData={livechatData}\n\t\t\t\t\t\tsetCustomFieldsData={handleLivechatData}\n\t\t\t\t\t\tsetCustomFieldsError={setCustomFieldsError}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t<Field>\n\t\t\t\t\t<Field.Label>{t('Topic')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput flexGrow={1} value={topic} onChange={handleTopic} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t</Field>\n\t\t\t\t{Tags && (\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Tags tags={tags} handler={handleTags} />\n\t\t\t\t\t</Field>\n\t\t\t\t)}\n\t\t\t\t{PrioritiesSelect && priorities && priorities.length > 0 && (\n\t\t\t\t\t<PrioritiesSelect value={priorityId} label={t('Priority')} options={priorities} handler={handlePriorityId} />\n\t\t\t\t)}\n\t\t\t</VerticalBar.ScrollableContent>\n\t\t\t<VerticalBar.Footer>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button flexGrow={1} onClick={close}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button mie='none' flexGrow={1} onClick={handleSave} disabled={!formIsValid} primary>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</VerticalBar.Footer>\n\t\t</>\n\t);\n}\n\nexport default RoomEdit;\n"]}