{"version":3,"sources":["meteor://ðŸ’»app/client/views/setupWizard/steps/CloudAccountConfirmation.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/setupWizard/steps/CloudAccountConfirmation.tsx","sourcesContent":["import { AwaitingConfirmationPage } from '@rocket.chat/onboarding-ui';\nimport React, { ReactElement, useEffect, useCallback } from 'react';\n\nimport { useEndpoint } from '../../../contexts/ServerContext';\nimport { useSettingSetValue } from '../../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useSetupWizardContext } from '../contexts/SetupWizardContext';\n\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\n\nconst CloudAccountConfirmation = (): ReactElement => {\n\tconst {\n\t\tregisterServer,\n\t\tgoToStep,\n\t\tsetupWizardData: { registrationData },\n\t\tsaveWorkspaceData,\n\t} = useSetupWizardContext();\n\tconst setShowSetupWizard = useSettingSetValue('Show_Setup_Wizard');\n\tconst cloudConfirmationPoll = useEndpoint('GET', 'cloud.confirmationPoll');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst getConfirmation = useCallback(async () => {\n\t\ttry {\n\t\t\tconst { pollData } = await cloudConfirmationPoll({\n\t\t\t\tdeviceCode: registrationData.device_code,\n\t\t\t});\n\n\t\t\tif ('successful' in pollData && pollData.successful) {\n\t\t\t\tawait saveWorkspaceData();\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Your_workspace_is_ready') });\n\t\t\t\treturn setShowSetupWizard('completed');\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [cloudConfirmationPoll, registrationData.device_code, setShowSetupWizard, saveWorkspaceData, dispatchToastMessage, t]);\n\n\tuseEffect(() => {\n\t\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(registrationData.interval));\n\n\t\treturn (): void => clearInterval(pollInterval);\n\t}, [getConfirmation, registrationData.interval]);\n\n\treturn (\n\t\t<AwaitingConfirmationPage\n\t\t\temailAddress={registrationData.cloudEmail}\n\t\t\tsecurityCode={registrationData.user_code}\n\t\t\tonResendEmailRequest={(): Promise<void> => registerServer({ email: registrationData.cloudEmail, resend: true })}\n\t\t\tonChangeEmailRequest={(): void => goToStep(3)}\n\t\t/>\n\t);\n};\n\nexport default CloudAccountConfirmation;\n"]}