{"version":3,"sources":["meteor://ðŸ’»app/client/views/meet/MeetPage.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/meet/MeetPage.tsx","sourcesContent":["import { Button, Box, Icon, Flex } from '@rocket.chat/fuselage';\nimport { Meteor } from 'meteor/meteor';\nimport React, { useEffect, useState, useCallback, FC } from 'react';\n\nimport { APIClient } from '../../../app/utils/client';\nimport UserAvatar from '../../components/avatar/UserAvatar';\nimport { useRouteParameter, useQueryStringParameter } from '../../contexts/RouterContext';\nimport NotFoundPage from '../notFound/NotFoundPage';\nimport PageLoading from '../root/PageLoading';\nimport CallPage from './CallPage';\nimport './styles.css';\n\nconst MeetPage: FC = () => {\n\tconst [isRoomMember, setIsRoomMember] = useState(false);\n\tconst [status, setStatus] = useState(null);\n\tconst [visitorId, setVisitorId] = useState(null);\n\tconst roomId = useRouteParameter('rid');\n\tconst visitorToken = useQueryStringParameter('token');\n\tconst layout = useQueryStringParameter('layout');\n\tconst [visitorName, setVisitorName] = useState('');\n\tconst [agentName, setAgentName] = useState('');\n\tconst [callStartTime, setCallStartTime] = useState(undefined);\n\n\tconst isMobileDevice = (): boolean => window.innerWidth <= 450;\n\tconst closeCallTab = (): void => window.close();\n\n\tconst setupCallForVisitor = useCallback(async () => {\n\t\tconst room = await APIClient.v1.get(`livechat/room?token=${visitorToken}&rid=${roomId}`);\n\t\tif (room?.room?.v?.token === visitorToken) {\n\t\t\tsetVisitorId(room.room.v._id);\n\t\t\tsetVisitorName(room.room.fname);\n\t\t\troom?.room?.responseBy?.username ? setAgentName(room.room.responseBy.username) : setAgentName(room.room.servedBy.username);\n\t\t\tsetStatus(room?.room?.callStatus || 'ended');\n\t\t\tsetCallStartTime(room.room.webRtcCallStartTime);\n\t\t\treturn setIsRoomMember(true);\n\t\t}\n\t}, [visitorToken, roomId]);\n\n\tconst setupCallForAgent = useCallback(async () => {\n\t\tconst room = await APIClient.v1.get(`rooms.info?roomId=${roomId}`);\n\t\tif (room?.room?.servedBy?._id === Meteor.userId()) {\n\t\t\tsetVisitorName(room.room.fname);\n\t\t\troom?.room?.responseBy?.username ? setAgentName(room.room.responseBy.username) : setAgentName(room.room.servedBy.username);\n\t\t\tsetStatus(room?.room?.callStatus || 'ended');\n\t\t\tsetCallStartTime(room.room.webRtcCallStartTime);\n\t\t\treturn setIsRoomMember(true);\n\t\t}\n\t}, [roomId]);\n\n\tuseEffect(() => {\n\t\tif (visitorToken) {\n\t\t\tsetupCallForVisitor();\n\t\t\treturn;\n\t\t}\n\t\tsetupCallForAgent();\n\t}, [setupCallForAgent, setupCallForVisitor, visitorToken]);\n\tif (status === null) {\n\t\treturn <PageLoading></PageLoading>;\n\t}\n\tif (!isRoomMember) {\n\t\treturn <NotFoundPage></NotFoundPage>;\n\t}\n\tif (status === 'ended') {\n\t\treturn (\n\t\t\t<Flex.Container direction='column' justifyContent='center'>\n\t\t\t\t<Box width='full' minHeight='sh' alignItems='center' backgroundColor='neutral-900' overflow='hidden' position='relative'>\n\t\t\t\t\t<Box\n\t\t\t\t\t\tposition='absolute'\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\ttop: '5%',\n\t\t\t\t\t\t\tright: '2%',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName='Self_Video'\n\t\t\t\t\t\tbackgroundColor='#2F343D'\n\t\t\t\t\t\talignItems='center'\n\t\t\t\t\t>\n\t\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tusername={visitorToken ? visitorName : agentName}\n\t\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\t\tsize={isMobileDevice() ? 'x32' : 'x48'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box\n\t\t\t\t\t\tposition='absolute'\n\t\t\t\t\t\tzIndex={1}\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\ttop: isMobileDevice() ? '30%' : '20%',\n\t\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\t\tjustifyContent: 'center',\n\t\t\t\t\t\t\tflexDirection: 'column',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\talignItems='center'\n\t\t\t\t\t>\n\t\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tusername={visitorToken ? agentName : visitorName}\n\t\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\t\tsize='x124'\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<p style={{ color: 'white', fontSize: 16, margin: 15 }}>{'Call Ended!'}</p>\n\t\t\t\t\t\t<p\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tcolor: 'white',\n\t\t\t\t\t\t\t\tfontSize: isMobileDevice() ? 15 : 22,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{visitorToken ? agentName : visitorName}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box position='absolute' alignItems='center' style={{ bottom: '20%' }}>\n\t\t\t\t\t\t<Button square title='Close Window' onClick={closeCallTab} backgroundColor='#2F343D' borderColor='#2F343D'>\n\t\t\t\t\t\t\t<Icon name='cross' size='x16' color='white' />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t</Flex.Container>\n\t\t);\n\t}\n\n\treturn (\n\t\t<CallPage\n\t\t\troomId={roomId}\n\t\t\tstatus={status}\n\t\t\tvisitorToken={visitorToken}\n\t\t\tvisitorId={visitorId}\n\t\t\tsetStatus={setStatus}\n\t\t\tvisitorName={visitorName}\n\t\t\tagentName={agentName}\n\t\t\tlayout={layout}\n\t\t\tcallStartTime={callStartTime}\n\t\t/>\n\t);\n};\n\nexport default MeetPage;\n"]}