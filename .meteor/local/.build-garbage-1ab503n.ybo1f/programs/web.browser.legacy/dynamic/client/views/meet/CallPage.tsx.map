{"version":3,"sources":["meteor://ðŸ’»app/client/views/meet/CallPage.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/meet/CallPage.tsx","sourcesContent":["import { Box, Flex, ButtonGroup, Button, Icon } from '@rocket.chat/fuselage';\nimport moment from 'moment';\nimport React, { FC, useEffect, useState } from 'react';\n\nimport { Notifications } from '../../../app/notifications/client';\nimport { WebRTC } from '../../../app/webrtc/client';\nimport { WEB_RTC_EVENTS } from '../../../app/webrtc/index';\nimport UserAvatar from '../../components/avatar/UserAvatar';\nimport { useTranslation } from '../../contexts/TranslationContext';\nimport OngoingCallDuration from './OngoingCallDuration';\nimport './styles.css';\n\ntype CallPageProps = {\n\troomId: any;\n\tvisitorToken: any;\n\tvisitorId: any;\n\tstatus: any;\n\tsetStatus: any;\n\tlayout: any;\n\tvisitorName: any;\n\tagentName: any;\n\tcallStartTime: any;\n};\n\nconst CallPage: FC<CallPageProps> = ({\n\troomId,\n\tvisitorToken,\n\tvisitorId,\n\tstatus,\n\tsetStatus,\n\tlayout,\n\tvisitorName,\n\tagentName,\n\tcallStartTime,\n}) => {\n\tconst [isAgentActive, setIsAgentActive] = useState(false);\n\tconst [isMicOn, setIsMicOn] = useState(false);\n\tconst [isCameraOn, setIsCameraOn] = useState(false);\n\tconst [isRemoteMobileDevice, setIsRemoteMobileDevice] = useState(false);\n\tconst [callInIframe, setCallInIframe] = useState(false);\n\tconst [isRemoteCameraOn, setIsRemoteCameraOn] = useState(false);\n\tconst [isLocalMobileDevice, setIsLocalMobileDevice] = useState(false);\n\n\tlet iconSize = 'x21';\n\tlet buttonSize = 'x40';\n\tconst avatarSize = 'x48';\n\tif (layout === 'embedded') {\n\t\ticonSize = 'x19';\n\t\tbuttonSize = 'x35';\n\t}\n\n\tconst t = useTranslation();\n\tuseEffect(() => {\n\t\tif (visitorToken) {\n\t\t\tconst webrtcInstance = WebRTC.getInstanceByRoomId(roomId, visitorId);\n\t\t\tconst isMobileDevice = (): boolean => {\n\t\t\t\tif (layout === 'embedded') {\n\t\t\t\t\tsetCallInIframe(true);\n\t\t\t\t}\n\t\t\t\tif (window.innerWidth <= 450 && window.innerHeight >= 629 && window.innerHeight <= 900) {\n\t\t\t\t\tsetIsLocalMobileDevice(true);\n\t\t\t\t\twebrtcInstance.media = {\n\t\t\t\t\t\taudio: true,\n\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\twidth: { ideal: 440 },\n\t\t\t\t\t\t\theight: { ideal: 580 },\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tNotifications.onUser(\n\t\t\t\tWEB_RTC_EVENTS.WEB_RTC,\n\t\t\t\t(type: any, data: any) => {\n\t\t\t\t\tif (data.room == null) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\twebrtcInstance.onUserStream(type, data);\n\t\t\t\t},\n\t\t\t\tvisitorId,\n\t\t\t);\n\t\t\tNotifications.onRoom(roomId, 'webrtc', (type: any, data: any) => {\n\t\t\t\tif (type === 'callStatus' && data.callStatus === 'ended') {\n\t\t\t\t\twebrtcInstance.stop();\n\t\t\t\t\tsetStatus(data.callStatus);\n\t\t\t\t} else if (type === 'getDeviceType') {\n\t\t\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'deviceType', {\n\t\t\t\t\t\tisMobileDevice: isMobileDevice(),\n\t\t\t\t\t});\n\t\t\t\t} else if (type === 'cameraStatus') {\n\t\t\t\t\tsetIsRemoteCameraOn(data.isCameraOn);\n\t\t\t\t}\n\t\t\t});\n\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'deviceType', {\n\t\t\t\tisMobileDevice: isMobileDevice(),\n\t\t\t});\n\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'callStatus', { callStatus: 'inProgress' });\n\t\t} else if (!isAgentActive) {\n\t\t\tconst webrtcInstance = WebRTC.getInstanceByRoomId(roomId);\n\t\t\tif (status === 'inProgress') {\n\t\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'getDeviceType');\n\t\t\t\twebrtcInstance.startCall({\n\t\t\t\t\taudio: true,\n\t\t\t\t\tvideo: {\n\t\t\t\t\t\twidth: { ideal: 1920 },\n\t\t\t\t\t\theight: { ideal: 1080 },\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\tNotifications.onRoom(roomId, 'webrtc', (type: any, data: any) => {\n\t\t\t\tif (type === 'callStatus') {\n\t\t\t\t\tswitch (data.callStatus) {\n\t\t\t\t\t\tcase 'ended':\n\t\t\t\t\t\t\twebrtcInstance.stop();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'inProgress':\n\t\t\t\t\t\t\twebrtcInstance.startCall({\n\t\t\t\t\t\t\t\taudio: true,\n\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\twidth: { ideal: 1920 },\n\t\t\t\t\t\t\t\t\theight: { ideal: 1080 },\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tsetStatus(data.callStatus);\n\t\t\t\t} else if (type === 'deviceType' && data.isMobileDevice) {\n\t\t\t\t\tsetIsRemoteMobileDevice(true);\n\t\t\t\t} else if (type === 'cameraStatus') {\n\t\t\t\t\tsetIsRemoteCameraOn(data.isCameraOn);\n\t\t\t\t}\n\t\t\t});\n\t\t\tsetIsAgentActive(true);\n\t\t}\n\t}, [isAgentActive, status, setStatus, visitorId, roomId, visitorToken, layout]);\n\n\tconst toggleButton = (control: any): any => {\n\t\tif (control === 'mic') {\n\t\t\tWebRTC.getInstanceByRoomId(roomId, visitorToken).toggleAudio();\n\t\t\treturn setIsMicOn(!isMicOn);\n\t\t}\n\t\tWebRTC.getInstanceByRoomId(roomId, visitorToken).toggleVideo();\n\t\tsetIsCameraOn(!isCameraOn);\n\t\tNotifications.notifyRoom(roomId, 'webrtc', 'cameraStatus', { isCameraOn: !isCameraOn });\n\t};\n\n\tconst closeWindow = (): void => {\n\t\tif (layout === 'embedded') {\n\t\t\treturn (parent as any)?.handleIframeClose();\n\t\t}\n\t\treturn window.close();\n\t};\n\n\tconst getCallDuration = (callStartTime: any): any => moment.duration(moment(new Date()).diff(moment(callStartTime))).asSeconds();\n\n\tconst showCallPage = (localAvatar: any, remoteAvatar: any): any => (\n\t\t<Flex.Container direction='column' justifyContent='center'>\n\t\t\t<Box width='full' minHeight='sh' alignItems='center' backgroundColor='neutral-900' overflow='hidden' position='relative'>\n\t\t\t\t<Box\n\t\t\t\t\tposition='absolute'\n\t\t\t\t\tzIndex={1}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\ttop: '5%',\n\t\t\t\t\t\tright: '2%',\n\t\t\t\t\t}}\n\t\t\t\t\tclassName='Self_Video'\n\t\t\t\t\talignItems='center'\n\t\t\t\t\tbackgroundColor='#2F343D'\n\t\t\t\t>\n\t\t\t\t\t<video\n\t\t\t\t\t\tid='localVideo'\n\t\t\t\t\t\tautoPlay\n\t\t\t\t\t\tplaysInline\n\t\t\t\t\t\tmuted\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\ttransform: 'scaleX(-1)',\n\t\t\t\t\t\t\tdisplay: isCameraOn ? 'block' : 'none',\n\t\t\t\t\t\t}}\n\t\t\t\t\t></video>\n\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tdisplay: isCameraOn ? 'none' : 'block',\n\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tusername={localAvatar}\n\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\tsize={isLocalMobileDevice || callInIframe ? 'x32' : 'x48'}\n\t\t\t\t\t/>\n\t\t\t\t</Box>\n\t\t\t\t<ButtonGroup\n\t\t\t\t\tposition='absolute'\n\t\t\t\t\tzIndex={1}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tbottom: '5%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tid='mic'\n\t\t\t\t\t\tsquare\n\t\t\t\t\t\tdata-title={isMicOn ? t('Mute_microphone') : t('Unmute_microphone')}\n\t\t\t\t\t\tonClick={(): any => toggleButton('mic')}\n\t\t\t\t\t\tclassName={isMicOn ? 'On' : 'Off'}\n\t\t\t\t\t\tsize={Number(buttonSize)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{isMicOn ? <Icon name='mic' size={iconSize} /> : <Icon name='mic-off' size={iconSize} />}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tid='camera'\n\t\t\t\t\t\tsquare\n\t\t\t\t\t\tdata-title={isCameraOn ? t('Turn_off_video') : t('Turn_on_video')}\n\t\t\t\t\t\tonClick={(): void => toggleButton('camera')}\n\t\t\t\t\t\tclassName={isCameraOn ? 'On' : 'Off'}\n\t\t\t\t\t\tsize={parseInt(buttonSize)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{isCameraOn ? <Icon name='video' size={iconSize} /> : <Icon name='video-off' size={iconSize} />}\n\t\t\t\t\t</Button>\n\t\t\t\t\t{layout === 'embedded' && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tsquare\n\t\t\t\t\t\t\tbackgroundColor='#2F343D'\n\t\t\t\t\t\t\tborderColor='#2F343D'\n\t\t\t\t\t\t\tdata-title={t('Expand_view')}\n\t\t\t\t\t\t\tonClick={(): void => (parent as any)?.expandCall()}\n\t\t\t\t\t\t\tsize={parseInt(buttonSize)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon name='arrow-expand' size={iconSize} color='white' />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button square primary danger data-title={t('End_call')} onClick={closeWindow} size={parseInt(buttonSize)}>\n\t\t\t\t\t\t<Icon name='phone-off' size={iconSize} color='white' />\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t\t<video\n\t\t\t\t\tid='remoteVideo'\n\t\t\t\t\tautoPlay\n\t\t\t\t\tplaysInline\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\twidth: isRemoteMobileDevice ? '45%' : '100%',\n\t\t\t\t\t\ttransform: 'scaleX(-1)',\n\t\t\t\t\t\tdisplay: isRemoteCameraOn ? 'block' : 'none',\n\t\t\t\t\t}}\n\t\t\t\t></video>\n\t\t\t\t<Box\n\t\t\t\t\tposition='absolute'\n\t\t\t\t\tzIndex={1}\n\t\t\t\t\tdisplay={isRemoteCameraOn ? 'none' : 'flex'}\n\t\t\t\t\tjustifyContent='center'\n\t\t\t\t\tflexDirection='column'\n\t\t\t\t\talignItems='center'\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\ttop: isRemoteMobileDevice || isLocalMobileDevice ? '10%' : '30%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tusername={remoteAvatar}\n\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\tsize={!callInIframe ? 'x124' : avatarSize}\n\t\t\t\t\t/>\n\t\t\t\t\t<Box color='white' fontSize={callInIframe ? 12 : 18} textAlign='center' margin={3}>\n\t\t\t\t\t\t<OngoingCallDuration counter={getCallDuration(callStartTime)} />\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tcolor: 'white',\n\t\t\t\t\t\t\tfontSize: callInIframe ? 12 : 22,\n\t\t\t\t\t\t\tmargin: callInIframe ? 5 : 9,\n\t\t\t\t\t\t\t...(callInIframe && { marginTop: 0 }),\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{remoteAvatar}\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t</Box>\n\t\t</Flex.Container>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{status === 'ringing' && (\n\t\t\t\t<Flex.Container direction='column' justifyContent='center'>\n\t\t\t\t\t<Box width='full' minHeight='sh' alignItems='center' backgroundColor='neutral-900' overflow='hidden' position='relative'>\n\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\tposition='absolute'\n\t\t\t\t\t\t\tzIndex={1}\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\ttop: '5%',\n\t\t\t\t\t\t\t\tright: '2%',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclassName='Self_Video'\n\t\t\t\t\t\t\tbackgroundColor='#2F343D'\n\t\t\t\t\t\t\talignItems='center'\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tusername={agentName}\n\t\t\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\t\t\tsize={isLocalMobileDevice ? 'x32' : 'x48'}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\tposition='absolute'\n\t\t\t\t\t\t\tzIndex={1}\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\ttop: '20%',\n\t\t\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\t\t\tjustifyContent: 'center',\n\t\t\t\t\t\t\t\tflexDirection: 'column',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\talignItems='center'\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tusername={visitorName}\n\t\t\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\t\t\tsize='x124'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Box color='white' fontSize={16} margin={15}>\n\t\t\t\t\t\t\t\t{'Calling...'}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tcolor: 'white',\n\t\t\t\t\t\t\t\t\tfontSize: isLocalMobileDevice ? 15 : 22,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{visitorName}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</Box>\n\t\t\t\t</Flex.Container>\n\t\t\t)}\n\t\t\t{status === 'declined' && (\n\t\t\t\t<Box minHeight='90%' display='flex' justifyContent='center' alignItems='center' color='white' fontSize='s1'>\n\t\t\t\t\t{t('Call_declined')}\n\t\t\t\t</Box>\n\t\t\t)}\n\t\t\t{status === 'inProgress' && (\n\t\t\t\t<Flex.Container direction='column' justifyContent='center'>\n\t\t\t\t\t{visitorToken ? showCallPage(visitorName, agentName) : showCallPage(agentName, visitorName)}\n\t\t\t\t</Flex.Container>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default CallPage;\n"]}