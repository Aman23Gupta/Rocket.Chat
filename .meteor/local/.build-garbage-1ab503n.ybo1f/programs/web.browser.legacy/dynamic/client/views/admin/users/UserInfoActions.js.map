{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/users/UserInfoActions.js"],"names":["_toConsumableArray","module","link","default","v","_slicedToArray","_objectWithoutProperties","_objectSpread","_extends","_regeneratorRuntime","export","UserInfoActions","ButtonGroup","Menu","Option","React","useCallback","useMemo","ConfirmOwnerChangeWarningModal","GenericModal","usePermission","useSetModal","useRoute","useMethod","useEndpoint","useSetting","useToastMessageDispatch","useTranslation","useActionSpread","UserInfo","username","_id","isActive","isAdmin","onChange","onReload","t","setModal","directRoute","userRoute","dispatchToastMessage","canDirectMessage","canEditOtherUserInfo","canAssignAdminRole","canResetE2EEKey","canResetTOTP","canEditOtherUserActiveStatus","canDeleteUser","enforcePassword","handleClose","handleDeletedUser","push","confirmOwnerChanges","action","modalProps","xhr","responseJSON","errorType","details","shouldChangeOwner","shouldBeRemoved","type","message","deleteUserQuery","userId","deleteUserEndpoint","erasureType","deleteUser","confirm","confirmRelinquish","result","success","contentTitle","confirmLabel","confirmDeleteUser","setAdminStatus","changeAdminStatus","resetE2EEKeyRequest","resetTOTPRequest","resetE2EEKey","resetTOTP","confirmResetE2EEKey","confirmResetTOTP","activeStatusQuery","activeStatus","changeActiveStatusMessage","changeActiveStatusRequest","changeActiveStatus","directMessageClick","rid","editUserClick","context","id","options","directMessage","icon","label","editUser","makeAdmin","actionsDefinition","actions","menuOptions","menu","props","mapAction","key","map","filter","Boolean"],"mappings":"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","file":"dynamic/client/views/admin/users/UserInfoActions.js","sourcesContent":["import { ButtonGroup, Menu, Option } from '@rocket.chat/fuselage';\nimport React, { useCallback, useMemo } from 'react';\n\nimport ConfirmOwnerChangeWarningModal from '../../../components/ConfirmOwnerChangeWarningModal';\nimport GenericModal from '../../../components/GenericModal';\nimport { usePermission } from '../../../contexts/AuthorizationContext';\nimport { useSetModal } from '../../../contexts/ModalContext';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod, useEndpoint } from '../../../contexts/ServerContext';\nimport { useSetting } from '../../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useActionSpread } from '../../hooks/useActionSpread';\nimport UserInfo from '../../room/contextualBar/UserInfo';\n\nexport const UserInfoActions = ({ username, _id, isActive, isAdmin, onChange, onReload }) => {\n\tconst t = useTranslation();\n\tconst setModal = useSetModal();\n\n\tconst directRoute = useRoute('direct');\n\tconst userRoute = useRoute('admin-users');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst canDirectMessage = usePermission('create-d');\n\tconst canEditOtherUserInfo = usePermission('edit-other-user-info');\n\tconst canAssignAdminRole = usePermission('assign-admin-role');\n\tconst canResetE2EEKey = usePermission('edit-other-user-e2ee');\n\tconst canResetTOTP = usePermission('edit-other-user-totp');\n\tconst canEditOtherUserActiveStatus = usePermission('edit-other-user-active-status');\n\tconst canDeleteUser = usePermission('delete-user');\n\n\tconst enforcePassword = useSetting('Accounts_TwoFactorAuthentication_Enforce_Password_Fallback');\n\n\tconst handleClose = useCallback(() => {\n\t\tsetModal();\n\t\tonChange();\n\t}, [setModal, onChange]);\n\n\tconst handleDeletedUser = () => {\n\t\tsetModal();\n\t\tuserRoute.push({});\n\t\tonReload();\n\t};\n\n\tconst confirmOwnerChanges =\n\t\t(action, modalProps = {}) =>\n\t\tasync () => {\n\t\t\ttry {\n\t\t\t\treturn await action();\n\t\t\t} catch (error) {\n\t\t\t\tif (error.xhr?.responseJSON?.errorType === 'user-last-owner') {\n\t\t\t\t\tconst { shouldChangeOwner, shouldBeRemoved } = error.xhr.responseJSON.details;\n\t\t\t\t\tsetModal(\n\t\t\t\t\t\t<ConfirmOwnerChangeWarningModal\n\t\t\t\t\t\t\tshouldChangeOwner={shouldChangeOwner}\n\t\t\t\t\t\t\tshouldBeRemoved={shouldBeRemoved}\n\t\t\t\t\t\t\t{...modalProps}\n\t\t\t\t\t\t\tonConfirm={async () => {\n\t\t\t\t\t\t\t\tawait action(true);\n\t\t\t\t\t\t\t\tsetModal();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonCancel={() => {\n\t\t\t\t\t\t\t\tsetModal();\n\t\t\t\t\t\t\t\tonChange();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>,\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\tconst deleteUserQuery = useMemo(() => ({ userId: _id }), [_id]);\n\tconst deleteUserEndpoint = useEndpoint('POST', 'users.delete');\n\n\tconst erasureType = useSetting('Message_ErasureType');\n\n\tconst deleteUser = confirmOwnerChanges(\n\t\tasync (confirm = false) => {\n\t\t\tif (confirm) {\n\t\t\t\tdeleteUserQuery.confirmRelinquish = confirm;\n\t\t\t}\n\n\t\t\tconst result = await deleteUserEndpoint(deleteUserQuery);\n\t\t\tif (result.success) {\n\t\t\t\thandleDeletedUser();\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_deleted') });\n\t\t\t} else {\n\t\t\t\tsetModal();\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tcontentTitle: t(`Delete_User_Warning_${erasureType}`),\n\t\t\tconfirmLabel: t('Delete'),\n\t\t},\n\t);\n\n\tconst confirmDeleteUser = useCallback(() => {\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={deleteUser} onCancel={() => setModal()} confirmText={t('Delete')}>\n\t\t\t\t{t(`Delete_User_Warning_${erasureType}`)}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, [deleteUser, erasureType, setModal, t]);\n\n\tconst setAdminStatus = useMethod('setAdminStatus');\n\tconst changeAdminStatus = useCallback(async () => {\n\t\ttry {\n\t\t\tawait setAdminStatus(_id, !isAdmin);\n\t\t\tconst message = isAdmin ? 'User_is_no_longer_an_admin' : 'User_is_now_an_admin';\n\t\t\tdispatchToastMessage({ type: 'success', message: t(message) });\n\t\t\tonChange();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [_id, dispatchToastMessage, isAdmin, onChange, setAdminStatus, t]);\n\n\tconst resetE2EEKeyRequest = useEndpoint('POST', 'users.resetE2EKey');\n\tconst resetTOTPRequest = useEndpoint('POST', 'users.resetTOTP');\n\tconst resetE2EEKey = useCallback(async () => {\n\t\tsetModal();\n\t\tconst result = await resetE2EEKeyRequest({ userId: _id });\n\n\t\tif (result) {\n\t\t\tsetModal(\n\t\t\t\t<GenericModal variant='success' onClose={handleClose} onConfirm={handleClose}>\n\t\t\t\t\t{t('Users_key_has_been_reset')}\n\t\t\t\t</GenericModal>,\n\t\t\t);\n\t\t}\n\t}, [resetE2EEKeyRequest, setModal, t, _id, handleClose]);\n\n\tconst resetTOTP = useCallback(async () => {\n\t\tsetModal();\n\t\tconst result = await resetTOTPRequest({ userId: _id });\n\n\t\tif (result) {\n\t\t\tsetModal(\n\t\t\t\t<GenericModal variant='success' onClose={handleClose} onConfirm={handleClose}>\n\t\t\t\t\t{t('Users_TOTP_has_been_reset')}\n\t\t\t\t</GenericModal>,\n\t\t\t);\n\t\t}\n\t}, [resetTOTPRequest, setModal, t, _id, handleClose]);\n\n\tconst confirmResetE2EEKey = useCallback(() => {\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={resetE2EEKey} onCancel={() => setModal()} confirmText={t('Reset')}>\n\t\t\t\t{t('E2E_Reset_Other_Key_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, [resetE2EEKey, t, setModal]);\n\n\tconst confirmResetTOTP = useCallback(() => {\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={resetTOTP} onCancel={() => setModal()} confirmText={t('Reset')}>\n\t\t\t\t{t('TOTP_Reset_Other_Key_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, [resetTOTP, t, setModal]);\n\n\tconst activeStatusQuery = useMemo(\n\t\t() => ({\n\t\t\tuserId: _id,\n\t\t\tactiveStatus: !isActive,\n\t\t}),\n\t\t[_id, isActive],\n\t);\n\tconst changeActiveStatusMessage = isActive ? 'User_has_been_deactivated' : 'User_has_been_activated';\n\tconst changeActiveStatusRequest = useEndpoint('POST', 'users.setActiveStatus');\n\n\tconst changeActiveStatus = confirmOwnerChanges(\n\t\tasync (confirm = false) => {\n\t\t\tif (confirm) {\n\t\t\t\tactiveStatusQuery.confirmRelinquish = confirm;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst result = await changeActiveStatusRequest(activeStatusQuery);\n\t\t\t\tif (result.success) {\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t(changeActiveStatusMessage) });\n\t\t\t\t\tonChange();\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tconfirmLabel: t('Yes_deactivate_it'),\n\t\t},\n\t);\n\n\tconst directMessageClick = useCallback(\n\t\t() =>\n\t\t\tdirectRoute.push({\n\t\t\t\trid: username,\n\t\t\t}),\n\t\t[directRoute, username],\n\t);\n\n\tconst editUserClick = useCallback(\n\t\t() =>\n\t\t\tuserRoute.push({\n\t\t\t\tcontext: 'edit',\n\t\t\t\tid: _id,\n\t\t\t}),\n\t\t[_id, userRoute],\n\t);\n\n\tconst options = useMemo(\n\t\t() => ({\n\t\t\t...(canDirectMessage && {\n\t\t\t\tdirectMessage: {\n\t\t\t\t\ticon: 'balloon',\n\t\t\t\t\tlabel: t('Direct_Message'),\n\t\t\t\t\taction: directMessageClick,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(canEditOtherUserInfo && {\n\t\t\t\teditUser: {\n\t\t\t\t\ticon: 'edit',\n\t\t\t\t\tlabel: t('Edit'),\n\t\t\t\t\taction: editUserClick,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(canAssignAdminRole &&\n\t\t\t\tusername && {\n\t\t\t\t\tmakeAdmin: {\n\t\t\t\t\t\ticon: 'key',\n\t\t\t\t\t\tlabel: isAdmin ? t('Remove_Admin') : t('Make_Admin'),\n\t\t\t\t\t\taction: changeAdminStatus,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t...(canResetE2EEKey &&\n\t\t\t\tenforcePassword && {\n\t\t\t\t\tresetE2EEKey: {\n\t\t\t\t\t\ticon: 'key',\n\t\t\t\t\t\tlabel: t('Reset_E2E_Key'),\n\t\t\t\t\t\taction: confirmResetE2EEKey,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t...(canResetTOTP &&\n\t\t\t\tenforcePassword && {\n\t\t\t\t\tresetTOTP: {\n\t\t\t\t\t\ticon: 'key',\n\t\t\t\t\t\tlabel: t('Reset_TOTP'),\n\t\t\t\t\t\taction: confirmResetTOTP,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t...(canDeleteUser && {\n\t\t\t\tdelete: {\n\t\t\t\t\ticon: 'trash',\n\t\t\t\t\tlabel: t('Delete'),\n\t\t\t\t\taction: confirmDeleteUser,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(canEditOtherUserActiveStatus && {\n\t\t\t\tchangeActiveStatus: {\n\t\t\t\t\ticon: 'user',\n\t\t\t\t\tlabel: isActive ? t('Deactivate') : t('Activate'),\n\t\t\t\t\taction: changeActiveStatus,\n\t\t\t\t},\n\t\t\t}),\n\t\t}),\n\t\t[\n\t\t\tt,\n\t\t\tcanDirectMessage,\n\t\t\tdirectMessageClick,\n\t\t\tcanEditOtherUserInfo,\n\t\t\teditUserClick,\n\t\t\tcanAssignAdminRole,\n\t\t\tisAdmin,\n\t\t\tchangeAdminStatus,\n\t\t\tcanDeleteUser,\n\t\t\tconfirmDeleteUser,\n\t\t\tcanEditOtherUserActiveStatus,\n\t\t\tisActive,\n\t\t\tchangeActiveStatus,\n\t\t\tenforcePassword,\n\t\t\tcanResetE2EEKey,\n\t\t\tcanResetTOTP,\n\t\t\tconfirmResetE2EEKey,\n\t\t\tconfirmResetTOTP,\n\t\t\tusername,\n\t\t],\n\t);\n\n\tconst { actions: actionsDefinition, menu: menuOptions } = useActionSpread(options);\n\n\tconst menu = useMemo(() => {\n\t\tif (!menuOptions) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Menu\n\t\t\t\tmi='x4'\n\t\t\t\tplacement='bottom-start'\n\t\t\t\tsmall={false}\n\t\t\t\tghost={false}\n\t\t\t\tflexShrink={0}\n\t\t\t\tkey='menu'\n\t\t\t\trenderItem={({ label: { label, icon }, ...props }) => <Option label={label} title={label} icon={icon} {...props} />}\n\t\t\t\toptions={menuOptions}\n\t\t\t/>\n\t\t);\n\t}, [menuOptions]);\n\n\tconst actions = useMemo(() => {\n\t\tconst mapAction = ([key, { label, icon, action }]) => (\n\t\t\t<UserInfo.Action key={key} title={label} label={label} onClick={action} icon={icon} />\n\t\t);\n\t\treturn [...actionsDefinition.map(mapAction), menu].filter(Boolean);\n\t}, [actionsDefinition, menu]);\n\n\treturn (\n\t\t<ButtonGroup flexGrow={0} justifyContent='center'>\n\t\t\t{actions}\n\t\t</ButtonGroup>\n\t);\n};\n"]}