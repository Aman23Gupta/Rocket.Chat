{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/inputs/CodeMirror.js"],"names":["_regeneratorRuntime","module","link","default","v","_extends","_slicedToArray","_objectWithoutProperties","useMutableCallback","React","useEffect","useRef","useState","defaultGutters","CodeMirror","lineNumbers","lineWrapping","mode","gutters","foldGutter","matchBrackets","autoCloseBrackets","matchTags","showTrailingSpace","highlightSelectionMatches","readOnly","valueProp","value","defaultValue","onChange","props","setValue","textAreaRef","editorRef","handleChange","current","setupCodeMirror","fromTextArea","on","doc","getValue","toTextArea","display","exportDefault"],"mappings":";;;;;;;;;;AAAA,IAAIA,mBAAJ;;AAAwBC,MAAM,CAACC,IAAP,CAAY,4BAAZ,EAAyC;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,uBAAmB,GAACI,CAApB;AAAsB;AAA3C,CAAzC,EAAsF,CAAtF;;AAAyF,IAAIC,QAAJ;;AAAaJ,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACC,YAAQ,GAACD,CAAT;AAAW;AAAhC,CAA7C,EAA+E,CAA/E;;AAAkF,IAAIE,cAAJ;;AAAmBL,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACE,kBAAc,GAACF,CAAf;AAAiB;AAAtC,CAAnD,EAA2F,CAA3F;;AAA8F,IAAIG,wBAAJ;;AAA6BN,MAAM,CAACC,IAAP,CAAY,gDAAZ,EAA6D;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACG,4BAAwB,GAACH,CAAzB;AAA2B;AAAhD,CAA7D,EAA+G,CAA/G;AAA9V,IAAII,kBAAJ;AAAuBP,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACM,oBAAkB,EAAC,UAASJ,CAAT,EAAW;AAACI,sBAAkB,GAACJ,CAAnB;AAAqB;AAArD,CAA1C,EAAiG,CAAjG;AAAoG,IAAIK,KAAJ,EAAUC,SAAV,EAAoBC,MAApB,EAA2BC,QAA3B;AAAoCX,MAAM,CAACC,IAAP,CAAY,OAAZ,EAAoB;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACK,SAAK,GAACL,CAAN;AAAQ,GAA7B;AAA8BM,WAAS,EAAC,UAASN,CAAT,EAAW;AAACM,aAAS,GAACN,CAAV;AAAY,GAAhE;AAAiEO,QAAM,EAAC,UAASP,CAAT,EAAW;AAACO,UAAM,GAACP,CAAP;AAAS,GAA7F;AAA8FQ,UAAQ,EAAC,UAASR,CAAT,EAAW;AAACQ,YAAQ,GAACR,CAAT;AAAW;AAA9H,CAApB,EAAoJ,CAApJ;AAG/J,IAAMS,cAAc,GAAG,CAAC,wBAAD,EAA2B,uBAA3B,CAAvB;;AAEA,SAASC,UAAT,OAgBG;AAAA,8BAfFC,WAeE;AAAA,MAfFA,WAeE,iCAfY,IAeZ;AAAA,+BAdFC,YAcE;AAAA,MAdFA,YAcE,kCAda,IAcb;AAAA,uBAbFC,IAaE;AAAA,MAbFA,IAaE,0BAbK,YAaL;AAAA,0BAZFC,OAYE;AAAA,MAZFA,OAYE,6BAZQL,cAYR;AAAA,6BAXFM,UAWE;AAAA,MAXFA,UAWE,gCAXW,IAWX;AAAA,gCAVFC,aAUE;AAAA,MAVFA,aAUE,mCAVc,IAUd;AAAA,mCATFC,iBASE;AAAA,MATFA,iBASE,sCATkB,IASlB;AAAA,4BARFC,SAQE;AAAA,MARFA,SAQE,+BARU,IAQV;AAAA,mCAPFC,iBAOE;AAAA,MAPFA,iBAOE,sCAPkB,IAOlB;AAAA,mCANFC,yBAME;AAAA,MANFA,yBAME,sCAN0B,IAM1B;AAAA,MALFC,QAKE,QALFA,QAKE;AAAA,MAJKC,SAIL,QAJFC,KAIE;AAAA,MAHFC,YAGE,QAHFA,YAGE;AAAA,MAFFC,QAEE,QAFFA,QAEE;AAAA,MADCC,KACD;;AACF,kBAA0BlB,QAAQ,CAACc,SAAS,IAAIE,YAAd,CAAlC;AAAA;AAAA,MAAOD,KAAP;AAAA,MAAcI,QAAd;;AAEA,MAAMC,WAAW,GAAGrB,MAAM,EAA1B;AACA,MAAMsB,SAAS,GAAGtB,MAAM,EAAxB;AACA,MAAMuB,YAAY,GAAG1B,kBAAkB,CAACqB,QAAD,CAAvC;AAEAnB,WAAS,CAAC,YAAM;AACf,QAAIuB,SAAS,CAACE,OAAd,EAAuB;AACtB;AACA;;AAED,QAAMC,eAAe;AAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mDACE,qBAAO,8BAAP,CADF;;AAAA;AACjBtB,4BADiB;AAAA;AAAA,mDAEjB,qBAAO,wDAAP,CAFiB;;AAAA;AAAA;AAAA,mDAGjB,qBAAO,+BAAP,CAHiB;;AAAA;AAAA,sBAKlBkB,WAAW,CAACG,OALM;AAAA;AAAA;AAAA;;AAAA;;AAAA;AASvBF,2BAAS,CAACE,OAAV,GAAoBrB,UAAU,CAACuB,YAAX,CAAwBL,WAAW,CAACG,OAApC,EAA6C;AAChEpB,+BAAW,EAAXA,WADgE;AAEhEC,gCAAY,EAAZA,YAFgE;AAGhEC,wBAAI,EAAJA,IAHgE;AAIhEC,2BAAO,EAAPA,OAJgE;AAKhEC,8BAAU,EAAVA,UALgE;AAMhEC,iCAAa,EAAbA,aANgE;AAOhEC,qCAAiB,EAAjBA,iBAPgE;AAQhEC,6BAAS,EAATA,SARgE;AAShEC,qCAAiB,EAAjBA,iBATgE;AAUhEC,6CAAyB,EAAzBA,yBAVgE;AAWhEC,4BAAQ,EAARA;AAXgE,mBAA7C,CAApB;AAcAQ,2BAAS,CAACE,OAAV,CAAkBG,EAAlB,CAAqB,QAArB,EAA+B,UAACC,GAAD,EAAS;AACvC,wBAAMZ,KAAK,GAAGY,GAAG,CAACC,QAAJ,EAAd;AACAT,4BAAQ,CAACJ,KAAD,CAAR;AACAO,gCAAY,CAACP,KAAD,CAAZ;AACA,mBAJD;;AAvBuB;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAH;AAAA,OAArB;;AA8BAS,mBAAe;AAEf,WAAO,YAAM;AACZ,UAAI,CAACH,SAAS,CAACE,OAAf,EAAwB;AACvB;AACA;;AAEDF,eAAS,CAACE,OAAV,CAAkBM,UAAlB;AACA,KAND;AAOA,GA5CQ,EA4CN,CACFpB,iBADE,EAEFF,UAFE,EAGFD,OAHE,EAIFM,yBAJE,EAKFT,WALE,EAMFC,YANE,EAOFI,aAPE,EAQFE,SARE,EASFL,IATE,EAUFiB,YAVE,EAWFT,QAXE,EAYFO,WAZE,EAaFT,iBAbE,CA5CM,CAAT;AA4DAb,WAAS,CAAC,YAAM;AACfqB,YAAQ,CAACL,SAAD,CAAR;AACA,GAFQ,EAEN,CAACA,SAAD,CAFM,CAAT;AAIAhB,WAAS,CAAC,YAAM;AACf,QAAI,CAACuB,SAAS,CAACE,OAAf,EAAwB;AACvB;AACA;;AAED,QAAIR,KAAK,KAAKM,SAAS,CAACE,OAAV,CAAkBK,QAAlB,EAAd,EAA4C;AAC3CP,eAAS,CAACE,OAAV,CAAkBJ,QAAlB,CAA2BJ,KAA3B;AACA;AACD,GARQ,EAQN,CAACK,WAAD,EAAcL,KAAd,CARM,CAAT;AAUA,sBAAO;AAAU,YAAQ,MAAlB;AAAmB,OAAG,EAAEK,WAAxB;AAAqC,SAAK,EAAE;AAAEU,aAAO,EAAE;AAAX,KAA5C;AAAiE,SAAK,EAAEf;AAAxE,KAAmFG,KAAnF,EAAP;AACA;;AAvGD7B,MAAM,CAAC0C,aAAP,CAyGe7B,UAzGf,E","file":"dynamic/client/views/admin/settings/inputs/CodeMirror.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useEffect, useRef, useState } from 'react';\n\nconst defaultGutters = ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'];\n\nfunction CodeMirror({\n\tlineNumbers = true,\n\tlineWrapping = true,\n\tmode = 'javascript',\n\tgutters = defaultGutters,\n\tfoldGutter = true,\n\tmatchBrackets = true,\n\tautoCloseBrackets = true,\n\tmatchTags = true,\n\tshowTrailingSpace = true,\n\thighlightSelectionMatches = true,\n\treadOnly,\n\tvalue: valueProp,\n\tdefaultValue,\n\tonChange,\n\t...props\n}) {\n\tconst [value, setValue] = useState(valueProp || defaultValue);\n\n\tconst textAreaRef = useRef();\n\tconst editorRef = useRef();\n\tconst handleChange = useMutableCallback(onChange);\n\n\tuseEffect(() => {\n\t\tif (editorRef.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst setupCodeMirror = async () => {\n\t\t\tconst CodeMirror = await import('codemirror/lib/codemirror.js');\n\t\t\tawait import('../../../../../app/ui/client/lib/codeMirror/codeMirror');\n\t\t\tawait import('codemirror/lib/codemirror.css');\n\n\t\t\tif (!textAreaRef.current) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditorRef.current = CodeMirror.fromTextArea(textAreaRef.current, {\n\t\t\t\tlineNumbers,\n\t\t\t\tlineWrapping,\n\t\t\t\tmode,\n\t\t\t\tgutters,\n\t\t\t\tfoldGutter,\n\t\t\t\tmatchBrackets,\n\t\t\t\tautoCloseBrackets,\n\t\t\t\tmatchTags,\n\t\t\t\tshowTrailingSpace,\n\t\t\t\thighlightSelectionMatches,\n\t\t\t\treadOnly,\n\t\t\t});\n\n\t\t\teditorRef.current.on('change', (doc) => {\n\t\t\t\tconst value = doc.getValue();\n\t\t\t\tsetValue(value);\n\t\t\t\thandleChange(value);\n\t\t\t});\n\t\t};\n\n\t\tsetupCodeMirror();\n\n\t\treturn () => {\n\t\t\tif (!editorRef.current) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditorRef.current.toTextArea();\n\t\t};\n\t}, [\n\t\tautoCloseBrackets,\n\t\tfoldGutter,\n\t\tgutters,\n\t\thighlightSelectionMatches,\n\t\tlineNumbers,\n\t\tlineWrapping,\n\t\tmatchBrackets,\n\t\tmatchTags,\n\t\tmode,\n\t\thandleChange,\n\t\treadOnly,\n\t\ttextAreaRef,\n\t\tshowTrailingSpace,\n\t]);\n\n\tuseEffect(() => {\n\t\tsetValue(valueProp);\n\t}, [valueProp]);\n\n\tuseEffect(() => {\n\t\tif (!editorRef.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (value !== editorRef.current.getValue()) {\n\t\t\teditorRef.current.setValue(value);\n\t\t}\n\t}, [textAreaRef, value]);\n\n\treturn <textarea readOnly ref={textAreaRef} style={{ display: 'none' }} value={value} {...props} />;\n}\n\nexport default CodeMirror;\n"]}