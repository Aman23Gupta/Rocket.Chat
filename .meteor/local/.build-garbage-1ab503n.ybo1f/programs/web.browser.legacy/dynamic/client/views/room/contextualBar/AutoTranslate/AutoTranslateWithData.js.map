{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/AutoTranslate/AutoTranslateWithData.js"],"names":["_slicedToArray","module","link","default","v","useMutableCallback","React","useMemo","useEffect","useState","memo","useLanguage","useUserSubscription","useEndpointActionExperimental","useEndpointData","useTabBarClose","AutoTranslate","AutoTranslateWithData","rid","close","userLanguage","subscription","targetLanguage","data","value","autoTranslateLanguage","currentLanguage","setCurrentLanguage","saveSettings","handleChangeLanguage","roomId","field","handleSwitch","event","target","checked","autoTranslate","languages","map","language","name","exportDefault"],"mappings":"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","file":"dynamic/client/views/room/contextualBar/AutoTranslate/AutoTranslateWithData.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo, useEffect, useState, memo } from 'react';\n\nimport { useLanguage } from '../../../../contexts/TranslationContext';\nimport { useUserSubscription } from '../../../../contexts/UserContext';\nimport { useEndpointActionExperimental } from '../../../../hooks/useEndpointActionExperimental';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport { useTabBarClose } from '../../providers/ToolboxProvider';\nimport AutoTranslate from './AutoTranslate';\n\nconst AutoTranslateWithData = ({ rid }) => {\n\tconst close = useTabBarClose();\n\tconst userLanguage = useLanguage();\n\tconst subscription = useUserSubscription(rid);\n\n\tconst { value: data } = useEndpointData(\n\t\t'autotranslate.getSupportedLanguages',\n\t\tuseMemo(() => ({ targetLanguage: userLanguage }), [userLanguage]),\n\t);\n\n\tconst [currentLanguage, setCurrentLanguage] = useState(subscription.autoTranslateLanguage);\n\n\tconst saveSettings = useEndpointActionExperimental('POST', 'autotranslate.saveSettings');\n\n\tconst handleChangeLanguage = useMutableCallback((value) => {\n\t\tsetCurrentLanguage(value);\n\n\t\tsaveSettings({\n\t\t\troomId: rid,\n\t\t\tfield: 'autoTranslateLanguage',\n\t\t\tvalue,\n\t\t});\n\t});\n\n\tconst handleSwitch = useMutableCallback((event) => {\n\t\tsaveSettings({\n\t\t\troomId: rid,\n\t\t\tfield: 'autoTranslate',\n\t\t\tvalue: event.target.checked,\n\t\t});\n\t});\n\n\tuseEffect(() => {\n\t\tif (!subscription.autoTranslate) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!subscription.autoTranslateLanguage) {\n\t\t\thandleChangeLanguage(userLanguage);\n\t\t}\n\t}, [subscription.autoTranslate, subscription.autoTranslateLanguage, handleChangeLanguage, userLanguage]);\n\n\treturn (\n\t\t<AutoTranslate\n\t\t\tlanguage={currentLanguage}\n\t\t\tlanguages={data ? data.languages.map((value) => [value.language, value.name]) : []}\n\t\t\thandleSwitch={handleSwitch}\n\t\t\thandleChangeLanguage={handleChangeLanguage}\n\t\t\ttranslateEnable={!!subscription.autoTranslate}\n\t\t\thandleClose={close}\n\t\t/>\n\t);\n};\n\nexport default memo(AutoTranslateWithData);\n"]}