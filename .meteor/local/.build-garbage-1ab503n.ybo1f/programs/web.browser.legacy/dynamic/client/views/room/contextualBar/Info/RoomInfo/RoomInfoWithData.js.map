{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Info/RoomInfo/RoomInfoWithData.js"],"names":["_regeneratorRuntime","module","link","default","v","useMutableCallback","React","RoomManager","roomTypes","UiTextContext","GenericModal","usePermission","useSetModal","useRoute","useEndpoint","useMethod","useSetting","useToastMessageDispatch","useTranslation","useUserRoom","useEndpointActionExperimental","WarningModal","useTabBarClose","ChannelToTeamModal","RoomInfo","retentionPolicyMaxAge","c","p","d","retentionPolicyAppliesTo","RoomInfoWithData","rid","openEditing","onClickBack","onEnterRoom","resetState","onClickClose","t","room","type","fname","prid","joined","retentionPolicyEnabled","retentionPolicy","maxAgeDefault","retentionEnabledDefault","excludePinnedDefault","filesOnlyDefault","dispatchToastMessage","setModal","closeModal","deleteRoom","hideRoom","leaveRoom","router","moveChannelToTeam","convertRoomToTeam","canDelete","canEdit","canConvertRoomToTeam","canLeave","cl","handleDelete","onConfirm","roomId","message","push","handleLeave","leave","close","warnText","getConfig","getUiText","LEAVE_WARNING","handleHide","hide","HIDE_WARNING","onMoveToTeam","teamId","rooms","onConvertToTeam","data","channelId","onClickEnterRoom","allowConvertToTeam","exportDefault"],"mappings":"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","file":"dynamic/client/views/room/contextualBar/Info/RoomInfo/RoomInfoWithData.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React from 'react';\n\nimport { RoomManager } from '../../../../../../app/ui-utils/client/lib/RoomManager';\nimport { roomTypes, UiTextContext } from '../../../../../../app/utils/client';\nimport GenericModal from '../../../../../components/GenericModal';\nimport { usePermission } from '../../../../../contexts/AuthorizationContext';\nimport { useSetModal } from '../../../../../contexts/ModalContext';\nimport { useRoute } from '../../../../../contexts/RouterContext';\nimport { useEndpoint, useMethod } from '../../../../../contexts/ServerContext';\nimport { useSetting } from '../../../../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../../contexts/TranslationContext';\nimport { useUserRoom } from '../../../../../contexts/UserContext';\nimport { useEndpointActionExperimental } from '../../../../../hooks/useEndpointActionExperimental';\nimport WarningModal from '../../../../admin/apps/WarningModal';\nimport { useTabBarClose } from '../../../providers/ToolboxProvider';\nimport ChannelToTeamModal from '../ChannelToTeamModal/ChannelToTeamModal';\nimport RoomInfo from './RoomInfo';\n\nconst retentionPolicyMaxAge = {\n\tc: 'RetentionPolicy_MaxAge_Channels',\n\tp: 'RetentionPolicy_MaxAge_Groups',\n\td: 'RetentionPolicy_MaxAge_DMs',\n};\n\nconst retentionPolicyAppliesTo = {\n\tc: 'RetentionPolicy_AppliesToChannels',\n\tp: 'RetentionPolicy_AppliesToGroups',\n\td: 'RetentionPolicy_AppliesToDMs',\n};\n\nconst RoomInfoWithData = ({ rid, openEditing, onClickBack, onEnterRoom, resetState }) => {\n\tconst onClickClose = useTabBarClose();\n\tconst t = useTranslation();\n\n\tconst room = useUserRoom(rid);\n\troom.type = room.t;\n\troom.rid = rid;\n\n\tconst { type, fname, prid, joined = true } = room; // TODO implement joined\n\n\tconst retentionPolicyEnabled = useSetting('RetentionPolicy_Enabled');\n\tconst retentionPolicy = {\n\t\tretentionPolicyEnabled,\n\t\tmaxAgeDefault: useSetting(retentionPolicyMaxAge[room.t]) || 30,\n\t\tretentionEnabledDefault: useSetting(retentionPolicyAppliesTo[room.t]),\n\t\texcludePinnedDefault: useSetting('RetentionPolicy_DoNotPrunePinned'),\n\t\tfilesOnlyDefault: useSetting('RetentionPolicy_FilesOnly'),\n\t};\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst closeModal = useMutableCallback(() => setModal());\n\tconst deleteRoom = useEndpoint('POST', room.t === 'c' ? 'channels.delete' : 'groups.delete');\n\tconst hideRoom = useMethod('hideRoom');\n\tconst leaveRoom = useMethod('leaveRoom');\n\tconst router = useRoute('home');\n\n\tconst moveChannelToTeam = useEndpointActionExperimental('POST', 'teams.addRooms', t('Success'));\n\tconst convertRoomToTeam = useEndpointActionExperimental(\n\t\t'POST',\n\t\ttype === 'c' ? 'channels.convertToTeam' : 'groups.convertToTeam',\n\t\tt('Success'),\n\t);\n\n\tconst canDelete = usePermission(type === 'c' ? 'delete-c' : 'delete-p', rid);\n\tconst canEdit = usePermission('edit-room', rid);\n\tconst canConvertRoomToTeam = usePermission('create-team');\n\tconst canLeave = usePermission(type === 'c' ? 'leave-c' : 'leave-p') && room.cl !== false && joined;\n\n\tconst handleDelete = useMutableCallback(() => {\n\t\tconst onConfirm = async () => {\n\t\t\ttry {\n\t\t\t\tresetState && resetState({});\n\t\t\t\tawait deleteRoom({ roomId: rid });\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Room_has_been_deleted') });\n\t\t\t\t!resetState && router.push({});\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tcloseModal();\n\t\t};\n\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={onConfirm} onCancel={closeModal} confirmText={t('Yes_delete_it')}>\n\t\t\t\t{t('Delete_Room_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\tconst handleLeave = useMutableCallback(() => {\n\t\tconst leave = async () => {\n\t\t\ttry {\n\t\t\t\tawait leaveRoom(rid);\n\t\t\t\trouter.push({});\n\t\t\t\tRoomManager.close(rid);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tcloseModal();\n\t\t};\n\n\t\tconst warnText = roomTypes.getConfig(type).getUiText(UiTextContext.LEAVE_WARNING);\n\n\t\tsetModal(\n\t\t\t<WarningModal\n\t\t\t\ttext={t(warnText, fname)}\n\t\t\t\tconfirmText={t('Leave_room')}\n\t\t\t\tclose={closeModal}\n\t\t\t\tcancel={closeModal}\n\t\t\t\tcancelText={t('Cancel')}\n\t\t\t\tconfirm={leave}\n\t\t\t/>,\n\t\t);\n\t});\n\n\tconst handleHide = useMutableCallback(async () => {\n\t\tconst hide = async () => {\n\t\t\ttry {\n\t\t\t\tawait hideRoom(rid);\n\t\t\t\trouter.push({});\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tcloseModal();\n\t\t};\n\n\t\tconst warnText = roomTypes.getConfig(type).getUiText(UiTextContext.HIDE_WARNING);\n\n\t\tsetModal(\n\t\t\t<WarningModal\n\t\t\t\ttext={t(warnText, fname)}\n\t\t\t\tconfirmText={t('Yes_hide_it')}\n\t\t\t\tclose={closeModal}\n\t\t\t\tcancel={closeModal}\n\t\t\t\tcancelText={t('Cancel')}\n\t\t\t\tconfirm={hide}\n\t\t\t/>,\n\t\t);\n\t});\n\n\tconst onMoveToTeam = useMutableCallback(async () => {\n\t\tconst onConfirm = async (teamId) => {\n\t\t\ttry {\n\t\t\t\tawait moveChannelToTeam({ rooms: [rid], teamId });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<ChannelToTeamModal rid={rid} onClose={closeModal} onCancel={closeModal} onConfirm={onConfirm} />);\n\t});\n\n\tconst onConvertToTeam = useMutableCallback(async () => {\n\t\tconst data = type === 'c' ? { channelId: rid } : { roomId: rid };\n\t\tconst onConfirm = async () => {\n\t\t\ttry {\n\t\t\t\tawait convertRoomToTeam(data);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\tsetModal(\n\t\t\t<GenericModal\n\t\t\t\ttitle={t('Confirmation')}\n\t\t\t\tvariant='warning'\n\t\t\t\tonClose={closeModal}\n\t\t\t\tonCancel={closeModal}\n\t\t\t\tonConfirm={onConfirm}\n\t\t\t\tconfirmText={t('Convert')}\n\t\t\t>\n\t\t\t\t{t('Converting_channel_to_a_team')}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\tconst onClickEnterRoom = useMutableCallback(() => onEnterRoom(room));\n\tconst allowConvertToTeam = !room.teamId && !prid && canConvertRoomToTeam && canEdit;\n\n\treturn (\n\t\t<RoomInfo\n\t\t\troom={room}\n\t\t\ticon={room.t === 'p' ? 'lock' : 'hashtag'}\n\t\t\tretentionPolicy={retentionPolicyEnabled && retentionPolicy}\n\t\t\tonClickBack={onClickBack}\n\t\t\tonClickEdit={canEdit && openEditing}\n\t\t\tonClickClose={onClickClose}\n\t\t\tonClickDelete={canDelete && handleDelete}\n\t\t\tonClickLeave={canLeave && handleLeave}\n\t\t\tonClickHide={joined && handleHide}\n\t\t\tonClickMoveToTeam={!room.teamId && !prid && canEdit && onMoveToTeam}\n\t\t\tonClickConvertToTeam={allowConvertToTeam && onConvertToTeam}\n\t\t\tonClickEnterRoom={onEnterRoom && onClickEnterRoom}\n\t\t/>\n\t);\n};\n\nexport default RoomInfoWithData;\n"]}