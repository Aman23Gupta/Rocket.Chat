{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/RoomMembers/InviteUsers/WrappedInviteUsers.js"],"names":["_regeneratorRuntime","module","link","default","v","_slicedToArray","useMutableCallback","React","useState","useEffect","useEndpoint","useTranslation","useFormatDateAndTime","useTabBarClose","EditInvite","InviteUsers","WrappedInviteUsers","rid","tabBar","onClickBack","editing","setEditing","format","t","onClickClose","handleEdit","onClickBackEditing","findOrCreateInvite","days","maxUses","setDayAndMaxUses","setParams","args","state","setState","linkExpirationText","data","expires","expiration","Date","usesLeft","uses","date","url","caption","error","exportDefault"],"mappings":"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","file":"dynamic/client/views/room/contextualBar/RoomMembers/InviteUsers/WrappedInviteUsers.js","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, useEffect } from 'react';\n\nimport { useEndpoint } from '../../../../../contexts/ServerContext';\nimport { useTranslation } from '../../../../../contexts/TranslationContext';\nimport { useFormatDateAndTime } from '../../../../../hooks/useFormatDateAndTime';\nimport { useTabBarClose } from '../../../providers/ToolboxProvider';\nimport EditInvite from '../EditInvite';\nimport InviteUsers from './InviteUsers';\n\nconst WrappedInviteUsers = ({ rid, tabBar, onClickBack }) => {\n\tconst [editing, setEditing] = useState(false);\n\tconst format = useFormatDateAndTime();\n\tconst t = useTranslation();\n\n\tconst onClickClose = useTabBarClose();\n\n\tconst handleEdit = useMutableCallback(() => setEditing(true));\n\tconst onClickBackEditing = useMutableCallback(() => setEditing(false));\n\n\tconst findOrCreateInvite = useEndpoint('POST', 'findOrCreateInvite');\n\n\tconst [{ days = 1, maxUses = 0 }, setDayAndMaxUses] = useState({});\n\n\tconst setParams = useMutableCallback((args) => {\n\t\tsetDayAndMaxUses(args);\n\t\tsetEditing(false);\n\t});\n\n\tconst [state, setState] = useState();\n\n\tconst linkExpirationText = useMutableCallback((data) => {\n\t\tif (!data) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (data.expires) {\n\t\t\tconst expiration = new Date(data.expires);\n\t\t\tif (data.maxUses) {\n\t\t\t\tconst usesLeft = data.maxUses - data.uses;\n\t\t\t\treturn t('Your_invite_link_will_expire_on__date__or_after__usesLeft__uses', {\n\t\t\t\t\tdate: format(expiration),\n\t\t\t\t\tusesLeft,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn t('Your_invite_link_will_expire_on__date__', { date: format(expiration) });\n\t\t}\n\n\t\tif (data.maxUses) {\n\t\t\tconst usesLeft = data.maxUses - data.uses;\n\t\t\treturn t('Your_invite_link_will_expire_after__usesLeft__uses', { usesLeft });\n\t\t}\n\n\t\treturn t('Your_invite_link_will_never_expire');\n\t});\n\n\tuseEffect(() => {\n\t\tif (editing) {\n\t\t\treturn;\n\t\t}\n\t\t(async () => {\n\t\t\ttry {\n\t\t\t\tconst data = await findOrCreateInvite({ rid, days, maxUses });\n\t\t\t\tsetState({\n\t\t\t\t\turl: data.url,\n\t\t\t\t\tcaption: linkExpirationText(data),\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tsetState({ error });\n\t\t\t}\n\t\t})();\n\t}, [findOrCreateInvite, editing, linkExpirationText, rid, days, maxUses]);\n\n\tif (editing) {\n\t\treturn (\n\t\t\t<EditInvite\n\t\t\t\tonClickBack={onClickBackEditing}\n\t\t\t\tlinkText={state?.url}\n\t\t\t\tcaptionText={state?.caption}\n\t\t\t\t{...{ rid, tabBar, error: state?.error, setParams, days, maxUses }}\n\t\t\t/>\n\t\t);\n\t}\n\n\treturn (\n\t\t<InviteUsers\n\t\t\terror={state?.error}\n\t\t\tonClickClose={onClickClose}\n\t\t\tonClickBack={onClickBack}\n\t\t\tonClickEdit={handleEdit}\n\t\t\tlinkText={state?.url}\n\t\t\tcaptionText={state?.caption}\n\t\t/>\n\t);\n};\n\nexport default WrappedInviteUsers;\n"]}