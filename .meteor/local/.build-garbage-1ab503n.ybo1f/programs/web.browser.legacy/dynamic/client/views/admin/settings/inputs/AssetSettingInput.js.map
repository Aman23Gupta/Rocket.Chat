{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/inputs/AssetSettingInput.js"],"names":["_regeneratorRuntime","module","link","default","v","Button","Field","Icon","Random","React","useMethod","useToastMessageDispatch","useTranslation","AssetSettingInput","_id","label","value","asset","fileConstraints","t","dispatchToastMessage","setAsset","unsetAsset","handleUpload","event","originalEvent","files","target","length","dataTransfer","Object","values","forEach","blob","type","message","reader","FileReader","readAsBinaryString","onloadend","result","handleDeleteButtonClick","url","backgroundImage","id","extensions","join","exportDefault"],"mappings":"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","file":"dynamic/client/views/admin/settings/inputs/AssetSettingInput.js","sourcesContent":["import { Button, Field, Icon } from '@rocket.chat/fuselage';\nimport { Random } from 'meteor/random';\nimport React from 'react';\n\nimport { useMethod } from '../../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../contexts/TranslationContext';\nimport './AssetSettingInput.css';\n\nfunction AssetSettingInput({ _id, label, value = {}, asset, fileConstraints = {} }) {\n\tconst t = useTranslation();\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setAsset = useMethod('setAsset');\n\tconst unsetAsset = useMethod('unsetAsset');\n\n\tconst handleUpload = (event) => {\n\t\tevent = event.originalEvent || event;\n\n\t\tlet { files } = event.target;\n\t\tif (!files || files.length === 0) {\n\t\t\tif (event.dataTransfer && event.dataTransfer.files) {\n\t\t\t\tfiles = event.dataTransfer.files;\n\t\t\t} else {\n\t\t\t\tfiles = [];\n\t\t\t}\n\t\t}\n\n\t\tObject.values(files).forEach((blob) => {\n\t\t\tdispatchToastMessage({ type: 'info', message: t('Uploading_file') });\n\t\t\tconst reader = new FileReader();\n\t\t\treader.readAsBinaryString(blob);\n\t\t\treader.onloadend = async () => {\n\t\t\t\ttry {\n\t\t\t\t\tawait setAsset(reader.result, blob.type, asset);\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('File_uploaded') });\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t};\n\n\tconst handleDeleteButtonClick = async () => {\n\t\ttry {\n\t\t\tawait unsetAsset(asset);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<Field.Label htmlFor={_id} title={_id}>\n\t\t\t\t{label}\n\t\t\t</Field.Label>\n\t\t\t<Field.Row>\n\t\t\t\t<div className='settings-file-preview'>\n\t\t\t\t\t{value.url ? (\n\t\t\t\t\t\t<div className='preview' style={{ backgroundImage: `url(${value.url}?_dc=${Random.id()})` }} />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className='preview no-file background-transparent-light secondary-font-color'>\n\t\t\t\t\t\t\t<Icon name='upload' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t<div className='action'>\n\t\t\t\t\t\t{value.url ? (\n\t\t\t\t\t\t\t<Button onClick={handleDeleteButtonClick}>\n\t\t\t\t\t\t\t\t<Icon name='trash' />\n\t\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div className='rc-button rc-button--primary'>\n\t\t\t\t\t\t\t\t{t('Select_file')}\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclassName='AssetSettingInput__input'\n\t\t\t\t\t\t\t\t\ttype='file'\n\t\t\t\t\t\t\t\t\taccept={fileConstraints.extensions && fileConstraints.extensions.length && `.${fileConstraints.extensions.join(', .')}`}\n\t\t\t\t\t\t\t\t\tonChange={handleUpload}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Field.Row>\n\t\t</>\n\t);\n}\n\nexport default AssetSettingInput;\n"]}