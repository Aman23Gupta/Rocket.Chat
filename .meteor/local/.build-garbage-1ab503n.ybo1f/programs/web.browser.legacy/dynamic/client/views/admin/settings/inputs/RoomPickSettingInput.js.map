{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/inputs/RoomPickSettingInput.js"],"names":["_toConsumableArray","module","link","default","v","Box","Field","Flex","Icon","Blaze","Template","React","useRef","useEffect","useLayoutEffect","ResetSettingButton","RoomPickSettingInput","_id","label","value","placeholder","readonly","autocomplete","disabled","hasResetButton","onChangeValue","onResetButtonClick","wrapperRef","valueRef","handleRemoveRoomButtonClick","rid","filter","current","view","renderWithData","inputAutocomplete","id","name","undefined","readOnly","settings","limit","rules","collection","endpoint","field","template","roomSearch","noMatchTemplate","roomSearchEmpty","matchAll","selector","match","sort","$","on","event","doc","currentTarget","focus","remove","position","map","exportDefault"],"mappings":"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","file":"dynamic/client/views/admin/settings/inputs/RoomPickSettingInput.js","sourcesContent":["import { Box, Field, Flex, Icon } from '@rocket.chat/fuselage';\nimport { Blaze } from 'meteor/blaze';\nimport { Template } from 'meteor/templating';\nimport React, { useRef, useEffect, useLayoutEffect } from 'react';\n\nimport ResetSettingButton from '../ResetSettingButton';\n\nfunction RoomPickSettingInput({\n\t_id,\n\tlabel,\n\tvalue,\n\tplaceholder,\n\treadonly,\n\tautocomplete,\n\tdisabled,\n\thasResetButton,\n\tonChangeValue,\n\tonResetButtonClick,\n}) {\n\tvalue = value || [];\n\n\tconst wrapperRef = useRef();\n\tconst valueRef = useRef(value);\n\n\tconst handleRemoveRoomButtonClick = (rid) => () => {\n\t\tonChangeValue(value.filter(({ _id }) => _id !== rid));\n\t};\n\n\tuseLayoutEffect(() => {\n\t\tvalueRef.current = value;\n\t});\n\n\tuseEffect(() => {\n\t\tconst view = Blaze.renderWithData(\n\t\t\tTemplate.inputAutocomplete,\n\t\t\t{\n\t\t\t\tid: _id,\n\t\t\t\tname: _id,\n\t\t\t\tclass: 'search autocomplete rc-input__element',\n\t\t\t\tautocomplete: autocomplete === false ? 'off' : undefined,\n\t\t\t\treadOnly: readonly,\n\t\t\t\tplaceholder,\n\t\t\t\tdisabled,\n\t\t\t\tsettings: {\n\t\t\t\t\tlimit: 10,\n\t\t\t\t\t// inputDelay: 300\n\t\t\t\t\trules: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// @TODO maybe change this 'collection' and/or template\n\t\t\t\t\t\t\tcollection: 'CachedChannelList',\n\t\t\t\t\t\t\tendpoint: 'rooms.autocomplete.channelAndPrivate',\n\t\t\t\t\t\t\tfield: 'name',\n\t\t\t\t\t\t\ttemplate: Template.roomSearch,\n\t\t\t\t\t\t\tnoMatchTemplate: Template.roomSearchEmpty,\n\t\t\t\t\t\t\tmatchAll: true,\n\t\t\t\t\t\t\tselector: (match) => ({ name: match }),\n\t\t\t\t\t\t\tsort: 'name',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t},\n\t\t\twrapperRef.current,\n\t\t);\n\n\t\t$('.autocomplete', wrapperRef.current).on('autocompleteselect', (event, doc) => {\n\t\t\tconst { current: value } = valueRef;\n\t\t\tonChangeValue([...value.filter(({ _id }) => _id !== doc._id), doc]);\n\t\t\tevent.currentTarget.value = '';\n\t\t\tevent.currentTarget.focus();\n\t\t});\n\n\t\treturn () => {\n\t\t\tBlaze.remove(view);\n\t\t};\n\t}, [_id, autocomplete, disabled, onChangeValue, placeholder, readonly, valueRef]);\n\n\treturn (\n\t\t<>\n\t\t\t<Flex.Container>\n\t\t\t\t<Box>\n\t\t\t\t\t<Field.Label htmlFor={_id} title={_id}>\n\t\t\t\t\t\t{label}\n\t\t\t\t\t</Field.Label>\n\t\t\t\t\t{hasResetButton && <ResetSettingButton data-qa-reset-setting-id={_id} onClick={onResetButtonClick} />}\n\t\t\t\t</Box>\n\t\t\t</Flex.Container>\n\t\t\t<div style={{ position: 'relative' }} ref={wrapperRef} />\n\t\t\t<ul className='selected-rooms'>\n\t\t\t\t{value.map(({ _id, name }) => (\n\t\t\t\t\t<li key={_id} className='remove-room' onClick={handleRemoveRoomButtonClick(_id)}>\n\t\t\t\t\t\t{name} <Icon name='cross' />\n\t\t\t\t\t</li>\n\t\t\t\t))}\n\t\t\t</ul>\n\t\t</>\n\t);\n}\n\nexport default RoomPickSettingInput;\n"]}