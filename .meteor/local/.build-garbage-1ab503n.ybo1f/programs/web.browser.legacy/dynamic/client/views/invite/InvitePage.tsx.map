{"version":3,"sources":["meteor://ðŸ’»app/client/views/invite/InvitePage.tsx"],"names":[],"mappings":"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","file":"dynamic/client/views/invite/InvitePage.tsx","sourcesContent":["import React, { ReactElement } from 'react';\nimport { useQuery } from 'react-query';\n\nimport { APIClient } from '../../../app/utils/client';\nimport { OperationParams, OperationResult } from '../../../definition/rest';\nimport { useRoute, useRouteParameter } from '../../contexts/RouterContext';\nimport { useSessionDispatch } from '../../contexts/SessionContext';\nimport { useSetting } from '../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../contexts/TranslationContext';\nimport { useUserId } from '../../contexts/UserContext';\nimport PageLoading from '../root/PageLoading';\n\nconst InvitePage = (): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst token = useRouteParameter('hash');\n\tconst registrationForm = useSetting('Accounts_RegistrationForm');\n\tconst setLoginDefaultState = useSessionDispatch('loginDefaultState');\n\tconst userId = useUserId();\n\tconst homeRoute = useRoute('/');\n\tconst groupRoute = useRoute('/group/:name/:tab?/:context?');\n\tconst channelRoute = useRoute('/channel/:name/:tab?/:context?');\n\n\tconst { isLoading } = useQuery(\n\t\t['invite', token],\n\t\tasync () => {\n\t\t\tif (!token) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst { valid } = await APIClient.v1.post<\n\t\t\t\t\tOperationParams<'POST', '/v1/validateInviteToken'>,\n\t\t\t\t\tnever,\n\t\t\t\t\tOperationResult<'POST', '/v1/validateInviteToken'>\n\t\t\t\t>('validateInviteToken', { token });\n\n\t\t\t\treturn valid;\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: t('Failed_to_validate_invite_token') });\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tonSuccess: async (valid) => {\n\t\t\t\tif (!token) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (registrationForm !== 'Disabled') {\n\t\t\t\t\tsetLoginDefaultState('register');\n\t\t\t\t} else {\n\t\t\t\t\tsetLoginDefaultState('login');\n\t\t\t\t}\n\n\t\t\t\tif (!valid || !userId) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tconst result = await APIClient.v1.post<\n\t\t\t\t\t\tOperationParams<'POST', '/v1/useInviteToken'>,\n\t\t\t\t\t\tnever,\n\t\t\t\t\t\tOperationResult<'POST', '/v1/useInviteToken'>\n\t\t\t\t\t>('useInviteToken', { token });\n\t\t\t\t\tif (!result?.room.name) {\n\t\t\t\t\t\tdispatchToastMessage({ type: 'error', message: t('Failed_to_activate_invite_token') });\n\t\t\t\t\t\thomeRoute.push();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (result.room.t === 'p') {\n\t\t\t\t\t\tgroupRoute.push({ name: result.room.name });\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tchannelRoute.push({ name: result.room.name });\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: t('Failed_to_activate_invite_token') });\n\t\t\t\t\thomeRoute.push();\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t);\n\n\tif (isLoading) {\n\t\treturn <PageLoading />;\n\t}\n\n\treturn (\n\t\t<section className='rc-old full-page color-tertiary-font-color'>\n\t\t\t<div className='wrapper'>\n\t\t\t\t<header>\n\t\t\t\t\t<a className='logo' href='/'>\n\t\t\t\t\t\t<img src='images/logo/logo.svg?v=3' />\n\t\t\t\t\t</a>\n\t\t\t\t</header>\n\t\t\t\t<div className='content'>\n\t\t\t\t\t<div className='attention-message'>\n\t\t\t\t\t\t<i className='icon-attention'></i>\n\t\t\t\t\t\t{t('Invalid_or_expired_invite_token')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</section>\n\t);\n};\n\nexport default InvitePage;\n"]}