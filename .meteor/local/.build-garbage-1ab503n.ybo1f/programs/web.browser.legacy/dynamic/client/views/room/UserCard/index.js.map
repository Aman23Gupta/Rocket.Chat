{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/UserCard/index.js"],"names":["_toConsumableArray","module","link","default","v","_slicedToArray","_extends","_objectWithoutProperties","PositionAnimated","AnimatedVisibility","Menu","Option","useMutableCallback","React","useMemo","useRef","Backdrop","LocalTime","UserCard","ReactiveUserStatus","useRolesDescription","useSetting","useTranslation","AsyncStatePhase","useEndpointData","useActionSpread","useUserInfoActions","UserCardWithData","username","onClose","target","open","rid","ref","getRoles","t","showRealNames","query","data","value","state","phase","current","user","loading","LOADING","defaultValue","undefined","_id","name","roles","status","statusText","bio","utcOffset","nickname","avatarETag","map","role","index","etag","localTime","Number","isInteger","customStatus","handleOpen","e","actionsDefinition","actions","menuOptions","menu","label","icon","props","mapAction","key","action","filter","Boolean","UNHIDING","exportDefault"],"mappings":";;;;;;;;;;AAAA,IAAIA,kBAAJ;;AAAuBC,MAAM,CAACC,IAAP,CAAY,0CAAZ,EAAuD;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,sBAAkB,GAACI,CAAnB;AAAqB;AAA1C,CAAvD,EAAmG,CAAnG;;AAAsG,IAAIC,cAAJ;;AAAmBJ,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACC,kBAAc,GAACD,CAAf;AAAiB;AAAtC,CAAnD,EAA2F,CAA3F;;AAA8F,IAAIE,QAAJ;;AAAaL,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACE,YAAQ,GAACF,CAAT;AAAW;AAAhC,CAA7C,EAA+E,CAA/E;;AAAkF,IAAIG,wBAAJ;;AAA6BN,MAAM,CAACC,IAAP,CAAY,gDAAZ,EAA6D;AAACC,SAAO,EAAC,UAASC,CAAT,EAAW;AAACG,4BAAwB,GAACH,CAAzB;AAA2B;AAAhD,CAA7D,EAA+G,CAA/G;AAA1W,IAAII,gBAAJ,EAAqBC,kBAArB,EAAwCC,IAAxC,EAA6CC,MAA7C;AAAoDV,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACM,kBAAgB,EAAC,UAASJ,CAAT,EAAW;AAACI,oBAAgB,GAACJ,CAAjB;AAAmB,GAAjD;AAAkDK,oBAAkB,EAAC,UAASL,CAAT,EAAW;AAACK,sBAAkB,GAACL,CAAnB;AAAqB,GAAtG;AAAuGM,MAAI,EAAC,UAASN,CAAT,EAAW;AAACM,QAAI,GAACN,CAAL;AAAO,GAA/H;AAAgIO,QAAM,EAAC,UAASP,CAAT,EAAW;AAACO,UAAM,GAACP,CAAP;AAAS;AAA5J,CAApC,EAAkM,CAAlM;AAAqM,IAAIQ,kBAAJ;AAAuBX,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACU,oBAAkB,EAAC,UAASR,CAAT,EAAW;AAACQ,sBAAkB,GAACR,CAAnB;AAAqB;AAArD,CAA1C,EAAiG,CAAjG;AAAoG,IAAIS,KAAJ,EAAUC,OAAV,EAAkBC,MAAlB;AAAyBd,MAAM,CAACC,IAAP,CAAY,OAAZ,EAAoB;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACS,SAAK,GAACT,CAAN;AAAQ,GAA7B;AAA8BU,SAAO,EAAC,UAASV,CAAT,EAAW;AAACU,WAAO,GAACV,CAAR;AAAU,GAA5D;AAA6DW,QAAM,EAAC,UAASX,CAAT,EAAW;AAACW,UAAM,GAACX,CAAP;AAAS;AAAzF,CAApB,EAA+G,CAA/G;AAAkH,IAAIY,QAAJ;AAAaf,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAACc,UAAQ,EAAC,UAASZ,CAAT,EAAW;AAACY,YAAQ,GAACZ,CAAT;AAAW;AAAjC,CAA3C,EAA8E,CAA9E;AAAiF,IAAIa,SAAJ;AAAchB,MAAM,CAACC,IAAP,CAAY,+BAAZ,EAA4C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACa,aAAS,GAACb,CAAV;AAAY;AAAjC,CAA5C,EAA+E,CAA/E;AAAkF,IAAIc,QAAJ;AAAajB,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACc,YAAQ,GAACd,CAAT;AAAW;AAAhC,CAA3C,EAA6E,CAA7E;AAAgF,IAAIe,kBAAJ;AAAuBlB,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACiB,oBAAkB,EAAC,UAASf,CAAT,EAAW;AAACe,sBAAkB,GAACf,CAAnB;AAAqB;AAArD,CAA7C,EAAoG,CAApG;AAAuG,IAAIgB,mBAAJ;AAAwBnB,MAAM,CAACC,IAAP,CAAY,wCAAZ,EAAqD;AAACkB,qBAAmB,EAAC,UAAShB,CAAT,EAAW;AAACgB,uBAAmB,GAAChB,CAApB;AAAsB;AAAvD,CAArD,EAA8G,CAA9G;AAAiH,IAAIiB,UAAJ;AAAepB,MAAM,CAACC,IAAP,CAAY,mCAAZ,EAAgD;AAACmB,YAAU,EAAC,UAASjB,CAAT,EAAW;AAACiB,cAAU,GAACjB,CAAX;AAAa;AAArC,CAAhD,EAAuF,CAAvF;AAA0F,IAAIkB,cAAJ;AAAmBrB,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACoB,gBAAc,EAAC,UAASlB,CAAT,EAAW;AAACkB,kBAAc,GAAClB,CAAf;AAAiB;AAA7C,CAAnD,EAAkG,CAAlG;AAAqG,IAAImB,eAAJ;AAAoBtB,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAACqB,iBAAe,EAAC,UAASnB,CAAT,EAAW;AAACmB,mBAAe,GAACnB,CAAhB;AAAkB;AAA/C,CAA3C,EAA4F,EAA5F;AAAgG,IAAIoB,eAAJ;AAAoBvB,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACsB,iBAAe,EAAC,UAASpB,CAAT,EAAW;AAACoB,mBAAe,GAACpB,CAAhB;AAAkB;AAA/C,CAA7C,EAA8F,EAA9F;AAAkG,IAAIqB,eAAJ;AAAoBxB,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACuB,iBAAe,EAAC,UAASrB,CAAT,EAAW;AAACqB,mBAAe,GAACrB,CAAhB;AAAkB;AAA/C,CAA1C,EAA2F,EAA3F;AAA+F,IAAIsB,kBAAJ;AAAuBzB,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACwB,oBAAkB,EAAC,UAAStB,CAAT,EAAW;AAACsB,sBAAkB,GAACtB,CAAnB;AAAqB;AAArD,CAA1C,EAAiG,EAAjG;;AAgBtnD,IAAMuB,gBAAgB,GAAG,gBAA8C;AAAA,MAA3CC,QAA2C,QAA3CA,QAA2C;AAAA,MAAjCC,OAAiC,QAAjCA,OAAiC;AAAA,MAAxBC,MAAwB,QAAxBA,MAAwB;AAAA,MAAhBC,IAAgB,QAAhBA,IAAgB;AAAA,MAAVC,GAAU,QAAVA,GAAU;AACtE,MAAMC,GAAG,GAAGlB,MAAM,CAACe,MAAD,CAAlB;AAEA,MAAMI,QAAQ,GAAGd,mBAAmB,EAApC;AAEA,MAAMe,CAAC,GAAGb,cAAc,EAAxB;AAEA,MAAMc,aAAa,GAAGf,UAAU,CAAC,kBAAD,CAAhC;AAEA,MAAMgB,KAAK,GAAGvB,OAAO,CAAC;AAAA,WAAO;AAAEc,cAAQ,EAARA;AAAF,KAAP;AAAA,GAAD,EAAuB,CAACA,QAAD,CAAvB,CAArB;;AAEA,yBAAsCJ,eAAe,CAAC,YAAD,EAAea,KAAf,CAArD;AAAA,MAAeC,IAAf,oBAAQC,KAAR;AAAA,MAA4BC,KAA5B,oBAAqBC,KAArB;;AAEAR,KAAG,CAACS,OAAJ,GAAcZ,MAAd;AAEA,MAAMa,IAAI,GAAG7B,OAAO,CAAC,YAAM;AAC1B,QAAM8B,OAAO,GAAGJ,KAAK,KAAKjB,eAAe,CAACsB,OAA1C;AACA,QAAMC,YAAY,GAAGF,OAAO,GAAGG,SAAH,GAAe,IAA3C;;AAEA,gBAAiBT,IAAI,IAAI;AAAEK,UAAI,EAAE;AAAR,KAAzB;AAAA,QAAQA,IAAR,SAAQA,IAAR;;AAEA,QACCK,GADD,GAUIL,IAVJ,CACCK,GADD;AAAA,qBAUIL,IAVJ,CAECM,IAFD;AAAA,QAECA,IAFD,2BAEQrB,QAFR;AAAA,sBAUIe,IAVJ,CAGCO,KAHD;AAAA,QAGCA,KAHD,4BAGSJ,YAHT;AAAA,uBAUIH,IAVJ,CAICQ,MAJD;AAAA,QAICA,MAJD,6BAIU,IAJV;AAAA,2BAUIR,IAVJ,CAKCS,UALD;AAAA,QAKCA,UALD,iCAKcD,MALd;AAAA,oBAUIR,IAVJ,CAMCU,GAND;AAAA,QAMCA,GAND,0BAMOP,YANP;AAAA,0BAUIH,IAVJ,CAOCW,SAPD;AAAA,QAOCA,SAPD,gCAOaR,YAPb;AAAA,QAQCS,QARD,GAUIZ,IAVJ,CAQCY,QARD;AAAA,QASCC,UATD,GAUIb,IAVJ,CASCa,UATD;AAYA,WAAO;AACNR,SAAG,EAAHA,GADM;AAENC,UAAI,EAAEb,aAAa,GAAGa,IAAH,GAAUrB,QAFvB;AAGNA,cAAQ,EAARA,QAHM;AAINsB,WAAK,EAAEA,KAAK,IAAIhB,QAAQ,CAACgB,KAAD,CAAR,CAAgBO,GAAhB,CAAoB,UAACC,IAAD,EAAOC,KAAP;AAAA,4BAAiB,oBAAC,QAAD,CAAU,IAAV;AAAe,aAAG,EAAEA;AAApB,WAA4BD,IAA5B,CAAjB;AAAA,OAApB,CAJV;AAKNL,SAAG,EAAHA,GALM;AAMNO,UAAI,EAAEJ,UANA;AAONK,eAAS,EAAEC,MAAM,CAACC,SAAP,CAAiBT,SAAjB,kBAA+B,oBAAC,SAAD;AAAW,iBAAS,EAAEA;AAAtB,QAPpC;AAQNH,YAAM,eAAE,oBAAC,kBAAD;AAAoB,WAAG,EAAEH;AAAzB,QARF;AASNgB,kBAAY,EAAEZ,UATR;AAUNG,cAAQ,EAARA;AAVM,KAAP;AAYA,GA9BmB,EA8BjB,CAACjB,IAAD,EAAOV,QAAP,EAAiBQ,aAAjB,EAAgCI,KAAhC,EAAuCN,QAAvC,CA9BiB,CAApB;AAgCA,MAAM+B,UAAU,GAAGrD,kBAAkB,CAAC,UAACsD,CAAD,EAAO;AAC5CnC,QAAI,IAAIA,IAAI,CAACmC,CAAD,CAAZ;AACArC,WAAO,IAAIA,OAAO,EAAlB;AACA,GAHoC,CAArC;;AAKA,yBAA0DJ,eAAe,CAACC,kBAAkB,CAACiB,IAAD,EAAOX,GAAP,CAAnB,CAAzE;AAAA,MAAiBmC,iBAAjB,oBAAQC,OAAR;AAAA,MAA0CC,WAA1C,oBAAoCC,IAApC;;AAEA,MAAMA,IAAI,GAAGxD,OAAO,CAAC,YAAM;AAC1B,QAAI,CAACuD,WAAL,EAAkB;AACjB,aAAO,IAAP;AACA;;AAED,wBACC,oBAAC,IAAD;AACC,gBAAU,EAAE,CADb;AAEC,QAAE,EAAC,IAFJ;AAGC,SAAG,EAAC,MAHL;AAIC,WAAK,EAAE,KAJR;AAKC,gBAAU,EAAE;AAAA,gCAAGE,KAAH;AAAA,YAAYA,KAAZ,eAAYA,KAAZ;AAAA,YAAmBC,IAAnB,eAAmBA,IAAnB;AAAA,YAA8BC,KAA9B;;AAAA,4BAA0C,oBAAC,MAAD,eAAYA,KAAZ;AAAmB,eAAK,EAAEF,KAA1B;AAAiC,cAAI,EAAEC;AAAvC,WAA1C;AAAA,OALb;AAMC,aAAO,EAAEH;AANV,MADD;AAUA,GAfmB,EAejB,CAACA,WAAD,CAfiB,CAApB;AAiBA,MAAMD,OAAO,GAAGtD,OAAO,CAAC,YAAM;AAC7B,QAAM4D,SAAS,GAAG;AAAA;AAAA,UAAEC,GAAF;AAAA;AAAA,UAASJ,KAAT,UAASA,KAAT;AAAA,UAAgBC,IAAhB,UAAgBA,IAAhB;AAAA,UAAsBI,MAAtB,UAAsBA,MAAtB;;AAAA,0BACjB,oBAAC,QAAD,CAAU,MAAV;AAAiB,WAAG,EAAED,GAAtB;AAA2B,aAAK,EAAEJ,KAAlC;AAAyC,sBAAYA,KAArD;AAA4D,eAAO,EAAEK,MAArE;AAA6E,YAAI,EAAEJ;AAAnF,QADiB;AAAA,KAAlB;;AAIA,WAAO,6BAAIL,iBAAiB,CAACV,GAAlB,CAAsBiB,SAAtB,CAAJ,IAAsCJ,IAAtC,GAA4CO,MAA5C,CAAmDC,OAAnD,CAAP;AACA,GANsB,EAMpB,CAACX,iBAAD,EAAoBG,IAApB,CANoB,CAAvB;AAQA,sBACC,uDACC,oBAAC,QAAD;AAAU,MAAE,EAAC,aAAb;AAA2B,WAAO,EAAEzC;AAApC,IADD,eAEC,oBAAC,gBAAD;AAAkB,UAAM,EAAEI,GAA1B;AAA+B,aAAS,EAAC,WAAzC;AAAqD,UAAM,EAAE,CAA7D;AAAgE,WAAO,EAAExB,kBAAkB,CAACsE;AAA5F,kBACC,oBAAC,QAAD,eAAcpC,IAAd;AAAoB,WAAO,EAAEd,OAA7B;AAAsC,QAAI,EAAEoC,UAA5C;AAAwD,WAAO,EAAEG,OAAjE;AAA0E,KAAC,EAAEjC;AAA7E,KADD,CAFD,CADD;AAQA,CAvFD;;AAhBAlC,MAAM,CAAC+E,aAAP,CAyGerD,gBAzGf,E","file":"dynamic/client/views/room/UserCard/index.js","sourcesContent":["import { PositionAnimated, AnimatedVisibility, Menu, Option } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo, useRef } from 'react';\n\nimport { Backdrop } from '../../../components/Backdrop';\nimport LocalTime from '../../../components/LocalTime';\nimport UserCard from '../../../components/UserCard';\nimport { ReactiveUserStatus } from '../../../components/UserStatus';\nimport { useRolesDescription } from '../../../contexts/AuthorizationContext';\nimport { useSetting } from '../../../contexts/SettingsContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { AsyncStatePhase } from '../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../hooks/useEndpointData';\nimport { useActionSpread } from '../../hooks/useActionSpread';\nimport { useUserInfoActions } from '../hooks/useUserInfoActions';\n\nconst UserCardWithData = ({ username, onClose, target, open, rid }) => {\n\tconst ref = useRef(target);\n\n\tconst getRoles = useRolesDescription();\n\n\tconst t = useTranslation();\n\n\tconst showRealNames = useSetting('UI_Use_Real_Name');\n\n\tconst query = useMemo(() => ({ username }), [username]);\n\n\tconst { value: data, phase: state } = useEndpointData('users.info', query);\n\n\tref.current = target;\n\n\tconst user = useMemo(() => {\n\t\tconst loading = state === AsyncStatePhase.LOADING;\n\t\tconst defaultValue = loading ? undefined : null;\n\n\t\tconst { user } = data || { user: {} };\n\n\t\tconst {\n\t\t\t_id,\n\t\t\tname = username,\n\t\t\troles = defaultValue,\n\t\t\tstatus = null,\n\t\t\tstatusText = status,\n\t\t\tbio = defaultValue,\n\t\t\tutcOffset = defaultValue,\n\t\t\tnickname,\n\t\t\tavatarETag,\n\t\t} = user;\n\n\t\treturn {\n\t\t\t_id,\n\t\t\tname: showRealNames ? name : username,\n\t\t\tusername,\n\t\t\troles: roles && getRoles(roles).map((role, index) => <UserCard.Role key={index}>{role}</UserCard.Role>),\n\t\t\tbio,\n\t\t\tetag: avatarETag,\n\t\t\tlocalTime: Number.isInteger(utcOffset) && <LocalTime utcOffset={utcOffset} />,\n\t\t\tstatus: <ReactiveUserStatus uid={_id} />,\n\t\t\tcustomStatus: statusText,\n\t\t\tnickname,\n\t\t};\n\t}, [data, username, showRealNames, state, getRoles]);\n\n\tconst handleOpen = useMutableCallback((e) => {\n\t\topen && open(e);\n\t\tonClose && onClose();\n\t});\n\n\tconst { actions: actionsDefinition, menu: menuOptions } = useActionSpread(useUserInfoActions(user, rid));\n\n\tconst menu = useMemo(() => {\n\t\tif (!menuOptions) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Menu\n\t\t\t\tflexShrink={0}\n\t\t\t\tmi='x2'\n\t\t\t\tkey='menu'\n\t\t\t\tghost={false}\n\t\t\t\trenderItem={({ label: { label, icon }, ...props }) => <Option {...props} label={label} icon={icon} />}\n\t\t\t\toptions={menuOptions}\n\t\t\t/>\n\t\t);\n\t}, [menuOptions]);\n\n\tconst actions = useMemo(() => {\n\t\tconst mapAction = ([key, { label, icon, action }]) => (\n\t\t\t<UserCard.Action key={key} title={label} aria-label={label} onClick={action} icon={icon} />\n\t\t);\n\n\t\treturn [...actionsDefinition.map(mapAction), menu].filter(Boolean);\n\t}, [actionsDefinition, menu]);\n\n\treturn (\n\t\t<>\n\t\t\t<Backdrop bg='transparent' onClick={onClose} />\n\t\t\t<PositionAnimated anchor={ref} placement='top-start' margin={8} visible={AnimatedVisibility.UNHIDING}>\n\t\t\t\t<UserCard {...user} onClose={onClose} open={handleOpen} actions={actions} t={t} />\n\t\t\t</PositionAnimated>\n\t\t</>\n\t);\n};\n\nexport default UserCardWithData;\n"]}