{"version":3,"sources":["meteor://ðŸ’»app/client/components/avatar/UserAvatarEditor/UserAvatarEditor.js"],"names":["_regeneratorRuntime","module","link","default","v","_slicedToArray","Box","Button","Icon","TextInput","Margins","Avatar","React","useState","useCallback","useTranslation","useFileInput","UserAvatar","UserAvatarSuggestions","UserAvatarEditor","currentUsername","username","setAvatarObj","suggestions","disabled","etag","t","avatarFromUrl","setAvatarFromUrl","newAvatarSource","setNewAvatarSource","urlEmpty","setUrlEmpty","toDataURL","file","callback","reader","FileReader","onload","e","target","result","readAsDataURL","setUploadedPreview","avatarObj","dataurl","clickUpload","clickUrl","avatarUrl","clickReset","url","handleAvatarFromUrlChange","event","currentTarget","value","objectFit","exportDefault"],"mappings":"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","file":"dynamic/client/components/avatar/UserAvatarEditor/UserAvatarEditor.js","sourcesContent":["import { Box, Button, Icon, TextInput, Margins, Avatar } from '@rocket.chat/fuselage';\nimport React, { useState, useCallback } from 'react';\n\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useFileInput } from '../../../hooks/useFileInput';\nimport UserAvatar from '../UserAvatar';\nimport UserAvatarSuggestions from './UserAvatarSuggestions';\n\nfunction UserAvatarEditor({ currentUsername, username, setAvatarObj, suggestions, disabled, etag }) {\n\tconst t = useTranslation();\n\tconst [avatarFromUrl, setAvatarFromUrl] = useState('');\n\tconst [newAvatarSource, setNewAvatarSource] = useState();\n\tconst [urlEmpty, setUrlEmpty] = useState(true);\n\n\tconst toDataURL = (file, callback) => {\n\t\tconst reader = new FileReader();\n\t\treader.onload = function (e) {\n\t\t\tcallback(e.target.result);\n\t\t};\n\t\treader.readAsDataURL(file);\n\t};\n\n\tconst setUploadedPreview = useCallback(\n\t\tasync (file, avatarObj) => {\n\t\t\tsetAvatarObj(avatarObj);\n\t\t\ttoDataURL(file, (dataurl) => {\n\t\t\t\tsetNewAvatarSource(dataurl);\n\t\t\t});\n\t\t},\n\t\t[setAvatarObj],\n\t);\n\n\tconst [clickUpload] = useFileInput(setUploadedPreview);\n\n\tconst clickUrl = () => {\n\t\tif (avatarFromUrl === '') {\n\t\t\treturn;\n\t\t}\n\t\tsetNewAvatarSource(avatarFromUrl);\n\t\tsetAvatarObj({ avatarUrl: avatarFromUrl });\n\t};\n\tconst clickReset = () => {\n\t\tsetNewAvatarSource(`/avatar/%40${username}`);\n\t\tsetAvatarObj('reset');\n\t};\n\n\tconst url = newAvatarSource;\n\n\tconst handleAvatarFromUrlChange = (event) => {\n\t\tevent.currentTarget.value !== '' ? setUrlEmpty(false) : setUrlEmpty(true);\n\t\tsetAvatarFromUrl(event.currentTarget.value);\n\t};\n\n\treturn (\n\t\t<Box display='flex' flexDirection='column' fontScale='p2m'>\n\t\t\t{t('Profile_picture')}\n\t\t\t<Box display='flex' flexDirection='row' mbs='x4'>\n\t\t\t\t<UserAvatar size='x124' url={url} username={currentUsername} etag={etag} style={{ objectFit: 'contain' }} mie='x4' />\n\t\t\t\t<Box display='flex' flexDirection='column' flexGrow='1' justifyContent='space-between' mis='x4'>\n\t\t\t\t\t<Box display='flex' flexDirection='row' mbs='none'>\n\t\t\t\t\t\t<Margins inline='x4'>\n\t\t\t\t\t\t\t<Button square mis='none' onClick={clickReset} disabled={disabled} mie='x4' title={t('Accounts_SetDefaultAvatar')}>\n\t\t\t\t\t\t\t\t<Avatar url={`/avatar/%40${username}`} />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button square onClick={clickUpload} disabled={disabled} title={t('Upload')}>\n\t\t\t\t\t\t\t\t<Icon name='upload' size='x20' />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button square mie='none' onClick={clickUrl} disabled={disabled || urlEmpty} title={t('Add URL')}>\n\t\t\t\t\t\t\t\t<Icon name='permalink' size='x20' />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t{suggestions && (\n\t\t\t\t\t\t\t\t<UserAvatarSuggestions\n\t\t\t\t\t\t\t\t\tsuggestions={suggestions}\n\t\t\t\t\t\t\t\t\tsetAvatarObj={setAvatarObj}\n\t\t\t\t\t\t\t\t\tsetNewAvatarSource={setNewAvatarSource}\n\t\t\t\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Margins inlineStart='x4'>\n\t\t\t\t\t\t<Box>{t('Use_url_for_avatar')}</Box>\n\t\t\t\t\t\t<TextInput flexGrow={0} placeholder={t('Use_url_for_avatar')} value={avatarFromUrl} onChange={handleAvatarFromUrlChange} />\n\t\t\t\t\t</Margins>\n\t\t\t\t</Box>\n\t\t\t</Box>\n\t\t</Box>\n\t);\n}\n\nexport default UserAvatarEditor;\n"]}