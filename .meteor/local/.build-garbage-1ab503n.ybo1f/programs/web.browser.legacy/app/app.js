var require = meteorInstall({"app":{"ui":{"client":{"lib":{"codeMirror":{"codeMirrorComponent.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/codeMirror/codeMirrorComponent.html                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.codeMirrorComponent.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.codeMirrorComponent.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/codeMirror/template.codeMirrorComponent.js                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("CodeMirror");
Template["CodeMirror"] = new Template("Template.CodeMirror", (function() {
  var view = this;
  return HTML.TEXTAREA({
    id: function() {
      return Spacebars.mustache(view.lookup("editorId"));
    },
    name: function() {
      return Spacebars.mustache(view.lookup("editorName"));
    },
    style: "display: none",
    value: function() {
      return Spacebars.mustache(view.lookup("code"));
    }
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"codeMirror.js":[
  "codemirror/addon/fold/brace-fold.js",
  "codemirror/addon/fold/comment-fold.js",
  "codemirror/addon/fold/foldcode.js",
  "codemirror/addon/fold/foldgutter.css",
  "codemirror/addon/fold/foldgutter.js",
  "codemirror/addon/fold/indent-fold.js",
  "codemirror/addon/fold/markdown-fold.js",
  "codemirror/addon/fold/xml-fold.js",
  "codemirror/addon/selection/active-line.js",
  "codemirror/addon/search/search.js",
  "codemirror/addon/search/searchcursor.js",
  "codemirror/addon/dialog/dialog.js",
  "codemirror/addon/dialog/dialog.css",
  "codemirror/addon/mode/overlay.js",
  "codemirror/addon/edit/continuelist.js",
  "codemirror/mode/apl/apl.js",
  "codemirror/mode/asterisk/asterisk.js",
  "codemirror/mode/clike/clike.js",
  "codemirror/mode/clojure/clojure.js",
  "codemirror/mode/cobol/cobol.js",
  "codemirror/mode/commonlisp/commonlisp.js",
  "codemirror/mode/coffeescript/coffeescript.js",
  "codemirror/mode/css/css.js",
  "codemirror/mode/cypher/cypher.js",
  "codemirror/mode/d/d.js",
  "codemirror/mode/diff/diff.js",
  "codemirror/mode/django/django.js",
  "codemirror/mode/dockerfile/dockerfile.js",
  "codemirror/mode/dtd/dtd.js",
  "codemirror/mode/dylan/dylan.js",
  "codemirror/mode/ecl/ecl.js",
  "codemirror/mode/eiffel/eiffel.js",
  "codemirror/mode/erlang/erlang.js",
  "codemirror/mode/fortran/fortran.js",
  "codemirror/mode/gas/gas.js",
  "codemirror/mode/gfm/gfm.js",
  "codemirror/mode/gherkin/gherkin.js",
  "codemirror/mode/go/go.js",
  "codemirror/mode/groovy/groovy.js",
  "codemirror/mode/haml/haml.js",
  "codemirror/mode/haskell/haskell.js",
  "codemirror/mode/haxe/haxe.js",
  "codemirror/mode/htmlembedded/htmlembedded.js",
  "codemirror/mode/htmlmixed/htmlmixed.js",
  "codemirror/mode/http/http.js",
  "codemirror/mode/idl/idl.js",
  "codemirror/mode/javascript/javascript.js",
  "codemirror/mode/jinja2/jinja2.js",
  "codemirror/mode/julia/julia.js",
  "codemirror/mode/livescript/livescript.js",
  "codemirror/mode/lua/lua.js",
  "codemirror/mode/markdown/markdown.js",
  "codemirror/mode/mirc/mirc.js",
  "codemirror/mode/mllike/mllike.js",
  "codemirror/mode/modelica/modelica.js",
  "codemirror/mode/nginx/nginx.js",
  "codemirror/mode/ntriples/ntriples.js",
  "codemirror/mode/octave/octave.js",
  "codemirror/mode/pascal/pascal.js",
  "codemirror/mode/pegjs/pegjs.js",
  "codemirror/mode/perl/perl.js",
  "codemirror/mode/php/php.js",
  "codemirror/mode/pig/pig.js",
  "codemirror/mode/properties/properties.js",
  "codemirror/mode/puppet/puppet.js",
  "codemirror/mode/python/python.js",
  "codemirror/mode/q/q.js",
  "codemirror/mode/r/r.js",
  "codemirror/mode/rpm/rpm.js",
  "codemirror/mode/rst/rst.js",
  "codemirror/mode/ruby/ruby.js",
  "codemirror/mode/rust/rust.js",
  "codemirror/mode/sass/sass.js",
  "codemirror/mode/scheme/scheme.js",
  "codemirror/mode/shell/shell.js",
  "codemirror/mode/sieve/sieve.js",
  "codemirror/mode/slim/slim.js",
  "codemirror/mode/smalltalk/smalltalk.js",
  "codemirror/mode/smarty/smarty.js",
  "codemirror/mode/solr/solr.js",
  "codemirror/mode/sparql/sparql.js",
  "codemirror/mode/sql/sql.js",
  "codemirror/mode/stex/stex.js",
  "codemirror/mode/tcl/tcl.js",
  "codemirror/mode/textile/textile.js",
  "codemirror/mode/tiddlywiki/tiddlywiki.js",
  "codemirror/mode/tiki/tiki.js",
  "codemirror/mode/toml/toml.js",
  "codemirror/mode/tornado/tornado.js",
  "codemirror/mode/turtle/turtle.js",
  "codemirror/mode/vb/vb.js",
  "codemirror/mode/vbscript/vbscript.js",
  "codemirror/mode/velocity/velocity.js",
  "codemirror/mode/verilog/verilog.js",
  "codemirror/mode/xml/xml.js",
  "codemirror/mode/xquery/xquery.js",
  "codemirror/mode/yaml/yaml.js",
  "codemirror/mode/z80/z80.js",
  "codemirror/keymap/sublime.js"
],"codeMirrorComponent.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/codeMirror/codeMirrorComponent.js                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
module.link("./codeMirrorComponent.html");
var CodeMirrors = {};
Template.CodeMirror.onRendered(function () {
  function _callee() {
    var CodeMirror, options, textarea, editor, self;
    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return _regeneratorRuntime.awrap(module.dynamicImport('codemirror/lib/codemirror.js'));

            case 2:
              CodeMirror = _context.sent;
              _context.next = 5;
              return _regeneratorRuntime.awrap(module.dynamicImport('./codeMirror'));

            case 5:
              _context.next = 7;
              return _regeneratorRuntime.awrap(module.dynamicImport('codemirror/lib/codemirror.css'));

            case 7:
              options = this.data.options || {
                lineNumbers: true
              };
              textarea = this.find('textarea');
              editor = CodeMirror.fromTextArea(textarea, options);
              this.autorun(function (c) {
                var _Template$currentData = Template.currentData(),
                    code = _Template$currentData.code;

                if (code === undefined) {
                  return;
                }

                c.stop();
                editor.setValue(code);
              });
              CodeMirrors[this.data.id || 'code-mirror-textarea'] = editor;

              if (this.data && this.data.editorOnBlur) {
                this.data.editorOnBlur(this.data.name);
              }

              self = this;
              editor.on('change', function (doc) {
                var val = doc.getValue();
                textarea.value = val;

                if (self.data.reactiveVar) {
                  Session.set(self.data.reactiveVar, val);
                }
              });

              if (this.data.reactiveVar) {
                this.autorun(function () {
                  var val = Session.get(self.data.reactiveVar) || '';

                  if (val !== editor.getValue()) {
                    editor.setValue(val);
                  }
                });
              }

              Meteor.defer(function () {
                editor.refresh();
              });

            case 17:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, this, null, Promise);
  }

  return _callee;
}());

Template.CodeMirror.destroyed = function () {
  delete CodeMirrors[this.data.id || 'code-mirror-textarea'];
  this.$("#" + (this.data.id || 'code-mirror-textarea')).next('.CodeMirror').remove();
};

Template.CodeMirror.helpers({
  editorId: function () {
    return this.id || 'code-mirror-textarea';
  },
  editorName: function () {
    return this.name || 'code-mirror-textarea';
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/codeMirror/index.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./codeMirrorComponent");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"recorderjs":{"audioEncoder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/recorderjs/audioEncoder.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  AudioEncoder: function () {
    return AudioEncoder;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 1);
var settings;
module.link("../../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);

var AudioEncoder = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(AudioEncoder, _Emitter);

  function AudioEncoder(source) {
    var _this;

    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
        _ref$bufferLen = _ref.bufferLen,
        bufferLen = _ref$bufferLen === void 0 ? 4096 : _ref$bufferLen,
        _ref$numChannels = _ref.numChannels,
        numChannels = _ref$numChannels === void 0 ? 1 : _ref$numChannels,
        _ref$bitRate = _ref.bitRate,
        bitRate = _ref$bitRate === void 0 ? settings.get('Message_Audio_bitRate') || 32 : _ref$bitRate;

    _this = _Emitter.call(this) || this;

    _this.handleWorkerMessage = function (event) {
      switch (event.data.command) {
        case 'end':
          {
            var blob = new Blob(event.data.buffer, {
              type: 'audio/mpeg'
            });

            _this.emit('encoded', blob);

            _this.worker.terminate();

            break;
          }
      }
    };

    _this.handleAudioProcess = function (event) {
      for (var channel = 0; channel < event.inputBuffer.numberOfChannels; channel++) {
        var buffer = event.inputBuffer.getChannelData(channel);

        _this.worker.postMessage({
          command: 'encode',
          buffer: buffer
        });
      }
    };

    var workerPath = Meteor.absoluteUrl('workers/mp3-encoder/index.js');
    _this.worker = new Worker(workerPath);
    _this.worker.onmessage = _this.handleWorkerMessage;

    _this.worker.postMessage({
      command: 'init',
      config: {
        sampleRate: source.context.sampleRate,
        numChannels: numChannels,
        bitRate: bitRate
      }
    });

    _this.scriptNode = (source.context.createScriptProcessor || source.context.createJavaScriptNode).call(source.context, bufferLen, numChannels, numChannels);
    _this.scriptNode.onaudioprocess = _this.handleAudioProcess;
    source.connect(_this.scriptNode);

    _this.scriptNode.connect(source.context.destination);

    return _this;
  }

  var _proto = AudioEncoder.prototype;

  _proto.close = function () {
    function close() {
      this.worker.postMessage({
        command: 'finish'
      });
    }

    return close;
  }();

  return AudioEncoder;
}(Emitter);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"audioRecorder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/recorderjs/audioRecorder.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  AudioRecorder: function () {
    return instance;
  }
});
var AudioEncoder;
module.link("./audioEncoder", {
  AudioEncoder: function (v) {
    AudioEncoder = v;
  }
}, 0);

var getUserMedia = function (navigator) {
  if (navigator.mediaDevices) {
    return navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
  }

  var legacyGetUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;

  if (legacyGetUserMedia) {
    return function (options) {
      return new Promise(function (resolve, reject) {
        legacyGetUserMedia.call(navigator, options, resolve, reject);
      });
    };
  }
}(window.navigator);

var AudioContext = window.AudioContext || window.webkitAudioContext;

var AudioRecorder = /*#__PURE__*/function () {
  function AudioRecorder() {}

  var _proto = AudioRecorder.prototype;

  _proto.isSupported = function () {
    function isSupported() {
      return Boolean(getUserMedia) && Boolean(AudioContext);
    }

    return isSupported;
  }();

  _proto.createAudioContext = function () {
    function createAudioContext() {
      if (this.audioContext) {
        return;
      }

      this.audioContext = new AudioContext();
    }

    return createAudioContext;
  }();

  _proto.destroyAudioContext = function () {
    function destroyAudioContext() {
      if (!this.audioContext) {
        return;
      }

      this.audioContext.close();
      delete this.audioContext;
    }

    return destroyAudioContext;
  }();

  _proto.createStream = function () {
    function createStream() {
      return _regeneratorRuntime.async(function () {
        function createStream$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (!this.stream) {
                  _context.next = 2;
                  break;
                }

                return _context.abrupt("return");

              case 2:
                _context.next = 4;
                return _regeneratorRuntime.awrap(getUserMedia({
                  audio: true
                }));

              case 4:
                this.stream = _context.sent;

              case 5:
              case "end":
                return _context.stop();
            }
          }
        }

        return createStream$;
      }(), null, this, null, Promise);
    }

    return createStream;
  }();

  _proto.destroyStream = function () {
    function destroyStream() {
      if (!this.stream) {
        return;
      }

      this.stream.getAudioTracks().forEach(function (track) {
        return track.stop();
      });
      delete this.stream;
    }

    return destroyStream;
  }();

  _proto.createEncoder = function () {
    function createEncoder() {
      var input;
      return _regeneratorRuntime.async(function () {
        function createEncoder$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                if (!this.encoder) {
                  _context2.next = 2;
                  break;
                }

                return _context2.abrupt("return");

              case 2:
                input = this.audioContext.createMediaStreamSource(this.stream);
                this.encoder = new AudioEncoder(input);

              case 4:
              case "end":
                return _context2.stop();
            }
          }
        }

        return createEncoder$;
      }(), null, this, null, Promise);
    }

    return createEncoder;
  }();

  _proto.destroyEncoder = function () {
    function destroyEncoder() {
      if (!this.encoder) {
        return;
      }

      this.encoder.close();
      delete this.encoder;
    }

    return destroyEncoder;
  }();

  _proto.start = function () {
    function start(cb) {
      return _regeneratorRuntime.async(function () {
        function start$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                _context3.prev = 0;
                _context3.next = 3;
                return _regeneratorRuntime.awrap(this.createAudioContext());

              case 3:
                _context3.next = 5;
                return _regeneratorRuntime.awrap(this.createStream());

              case 5:
                _context3.next = 7;
                return _regeneratorRuntime.awrap(this.createEncoder());

              case 7:
                cb && cb.call(this, true);
                _context3.next = 17;
                break;

              case 10:
                _context3.prev = 10;
                _context3.t0 = _context3["catch"](0);
                console.error(_context3.t0);
                this.destroyEncoder();
                this.destroyStream();
                this.destroyAudioContext();
                cb && cb.call(this, false);

              case 17:
              case "end":
                return _context3.stop();
            }
          }
        }

        return start$;
      }(), null, this, [[0, 10]], Promise);
    }

    return start;
  }();

  _proto.stop = function () {
    function stop(cb) {
      this.encoder.on('encoded', cb);
      this.encoder.close();
      this.destroyEncoder();
      this.destroyStream();
      this.destroyAudioContext();
    }

    return stop;
  }();

  return AudioRecorder;
}();

var instance = new AudioRecorder();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"videoRecorder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/recorderjs/videoRecorder.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  VideoRecorder: function () {
    return VideoRecorder;
  }
});
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var VideoRecorder = new ( /*#__PURE__*/function () {
  function VideoRecorder() {
    this.started = false;
    this.cameraStarted = new ReactiveVar(false);
    this.recording = new ReactiveVar(false);
    this.recordingAvailable = new ReactiveVar(false);
  }

  var _proto = VideoRecorder.prototype;

  _proto.start = function () {
    function start(videoel, cb) {
      var _this = this;

      this.videoel = videoel;

      var handleSuccess = function (stream) {
        _this.startUserMedia(stream);

        cb && cb.call(_this, true);
      };

      var handleError = function (error) {
        console.error(error);
        cb && cb.call(_this, false);
      };

      var oldGetUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;

      if (navigator.mediaDevices) {
        navigator.mediaDevices.getUserMedia({
          audio: true,
          video: true
        }).then(handleSuccess, handleError);
        return;
      }

      if (oldGetUserMedia) {
        oldGetUserMedia.call(navigator, {
          audio: true,
          video: true
        }, handleSuccess, handleError);
        return;
      }

      cb && cb.call(this, false);
    }

    return start;
  }();

  _proto.record = function () {
    function record() {
      var _this2 = this;

      this.chunks = [];

      if (this.stream == null) {
        return;
      }

      this.mediaRecorder = new MediaRecorder(this.stream, {
        type: 'video/webm'
      });

      this.mediaRecorder.ondataavailable = function (blobev) {
        _this2.chunks.push(blobev.data);

        if (!_this2.recordingAvailable.get()) {
          return _this2.recordingAvailable.set(true);
        }
      };

      this.mediaRecorder.start();
      return this.recording.set(true);
    }

    return record;
  }();

  _proto.startUserMedia = function () {
    function startUserMedia(stream) {
      var _this3 = this;

      this.stream = stream;

      try {
        this.videoel.srcObject = stream;
      } catch (error) {
        var URL = window.URL || window.webkitURL;
        this.videoel.src = URL.createObjectURL(stream);
      }

      this.videoel.muted = true;

      this.videoel.onloadedmetadata = function () {
        _this3.videoel && _this3.videoel.play();
      };

      this.started = true;
      return this.cameraStarted.set(true);
    }

    return startUserMedia;
  }();

  _proto.stop = function () {
    function stop(cb) {
      if (!this.started) {
        return;
      }

      this.stopRecording();

      if (this.stream) {
        var vtracks = this.stream.getVideoTracks();

        for (var _i = 0, _Array$from = Array.from(vtracks); _i < _Array$from.length; _i++) {
          var vtrack = _Array$from[_i];
          vtrack.stop();
        }

        var atracks = this.stream.getAudioTracks();

        for (var _i2 = 0, _Array$from2 = Array.from(atracks); _i2 < _Array$from2.length; _i2++) {
          var atrack = _Array$from2[_i2];
          atrack.stop();
        }
      }

      if (this.videoel) {
        this.videoel.pause;
        this.videoel.src = '';
      }

      this.started = false;
      this.cameraStarted.set(false);
      this.recordingAvailable.set(false);

      if (cb && this.chunks) {
        var blob = new Blob(this.chunks, {
          type: 'video/webm'
        });
        cb(blob);
      }

      delete this.recorder;
      delete this.stream;
      delete this.videoel;
    }

    return stop;
  }();

  _proto.stopRecording = function () {
    function stopRecording() {
      if (!this.started || !this.recording || !this.mediaRecorder) {
        return;
      }

      this.mediaRecorder.stop();
      this.recording.set(false);
      delete this.mediaRecorder;
    }

    return stopRecording;
  }();

  return VideoRecorder;
}())();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"Tooltip.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/Tooltip.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  closeTooltip: function () {
    return closeTooltip;
  },
  openToolTip: function () {
    return openToolTip;
  }
});
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 0);
var createEphemeralPortal;
module.link("../../../../client/lib/portals/createEphemeralPortal", {
  createEphemeralPortal: function (v) {
    createEphemeralPortal = v;
  }
}, 1);
var createAnchor;
module.link("../../../../client/lib/utils/createAnchor", {
  createAnchor: function (v) {
    createAnchor = v;
  }
}, 2);
var Dep = new Tracker.Dependency();
var state;
var dom;
var unregister;

var props = function () {
  Dep.depend();
  return state;
};

var closeTooltip = function () {
  if (!dom) {
    return;
  }

  unregister = unregister && unregister();
};

var openToolTip = function (title, anchor) {
  dom = dom || createAnchor('react-tooltip');
  state = {
    title: title,
    anchor: anchor
  };
  Dep.changed();
  unregister = unregister || createEphemeralPortal(function () {
    return module.dynamicImport('../../../../client/components/TooltipComponent');
  }, props, dom);
};

window.matchMedia('(hover: none)').matches || document.body.addEventListener('mouseover', function () {
  var timeout;
  return function (e) {
    timeout = timeout && clearTimeout(timeout);
    timeout = setTimeout(function () {
      var _e$dataset;

      var element = e.target.title || (_e$dataset = e.dataset) !== null && _e$dataset !== void 0 && _e$dataset.title ? e.target : e.target.closest('[title], [data-title]');

      if (element) {
        element.dataset.title = element.title || element.dataset.title;
        element.removeAttribute('title');
        openToolTip(element.dataset.title, element);
      }
    }, 300);
    closeTooltip();
  };
}());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserAction.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/UserAction.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);
module.export({
  USER_ACTIVITY: function () {
    return USER_ACTIVITY;
  },
  USER_ACTIVITIES: function () {
    return USER_ACTIVITIES;
  },
  UserAction: function () {
    return UserAction;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveDict;
module.link("meteor/reactive-dict", {
  ReactiveDict: function (v) {
    ReactiveDict = v;
  }
}, 1);
var debounce;
module.link("lodash", {
  debounce: function (v) {
    debounce = v;
  }
}, 2);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var Notifications;
module.link("../../../notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 4);
var TIMEOUT = 15000;
var RENEW = TIMEOUT / 3;
var USER_ACTIVITY = 'user-activity';
var USER_ACTIVITIES = {
  USER_RECORDING: 'user-recording',
  USER_TYPING: 'user-typing',
  USER_UPLOADING: 'user-uploading'
};
var activityTimeouts = new Map();
var activityRenews = new Map();
var continuingIntervals = new Map();
var roomActivities = new Map();
var rooms = new Map();
var performingUsers = new ReactiveDict();

var shownName = function (user) {
  if (!user) {
    return;
  }

  if (settings.get('UI_Use_Real_Name')) {
    return user.name;
  }

  return user.username;
};

var emitActivities = debounce(function (rid, extras) {
  var activities = roomActivities.get((extras === null || extras === void 0 ? void 0 : extras.tmid) || rid) || new Set();
  Notifications.notifyRoom(rid, USER_ACTIVITY, shownName(Meteor.user()), _toConsumableArray(activities), extras);
}, 500);

function handleStreamAction(rid, username, activityTypes, extras) {
  rid = (extras === null || extras === void 0 ? void 0 : extras.tmid) || rid;
  var roomActivities = performingUsers.get(rid) || {};

  for (var _i = 0, _Object$entries = Object.entries(USER_ACTIVITIES); _i < _Object$entries.length; _i++) {
    var _ref = _Object$entries[_i];

    var _ref2 = _slicedToArray(_ref, 2);

    var activity = _ref2[1];
    roomActivities[activity] = roomActivities[activity] || new Map();
    var users = roomActivities[activity];
    var timeout = users[username];

    if (timeout) {
      clearTimeout(timeout);
    }

    if (activityTypes.includes(activity)) {
      activityTypes.splice(activityTypes.indexOf(activity), 1);
      users[username] = setTimeout(function () {
        return handleStreamAction(rid, username, activityTypes, extras);
      }, TIMEOUT);
    } else {
      delete users[username];
    }
  }

  performingUsers.set(rid, roomActivities);
}

var UserAction = new ( /*#__PURE__*/function () {
  function _class() {}

  var _proto = _class.prototype;

  _proto.addStream = function () {
    function addStream(rid) {
      if (rooms.get(rid)) {
        return;
      }

      var handler = function (username, activityType, extras) {
        var user = Meteor.users.findOne(Meteor.userId() || undefined, {
          fields: {
            name: 1,
            username: 1
          }
        });

        if (username === shownName(user)) {
          return;
        }

        handleStreamAction(rid, username, activityType, extras);
      };

      rooms.set(rid, handler);
      Notifications.onRoom(rid, USER_ACTIVITY, handler);
    }

    return addStream;
  }();

  _proto.performContinuously = function () {
    function performContinuously(rid, activityType) {
      var _this = this;

      var extras = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      var trid = (extras === null || extras === void 0 ? void 0 : extras.tmid) || rid;
      var key = activityType + "-" + trid;

      if (continuingIntervals.get(key)) {
        return;
      }

      this.start(rid, activityType, extras);
      continuingIntervals.set(key, setInterval(function () {
        _this.start(rid, activityType, extras);
      }, RENEW));
    }

    return performContinuously;
  }();

  _proto.start = function () {
    function start(rid, activityType) {
      var _this2 = this;

      var extras = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      var trid = (extras === null || extras === void 0 ? void 0 : extras.tmid) || rid;
      var key = activityType + "-" + trid;

      if (activityRenews.get(key)) {
        return;
      }

      activityRenews.set(key, setTimeout(function () {
        clearTimeout(activityRenews.get(key));
        activityRenews.delete(key);
      }, RENEW));
      var activities = roomActivities.get(trid) || new Set();
      activities.add(activityType);
      roomActivities.set(trid, activities);
      emitActivities(rid, extras);

      if (activityTimeouts.get(key)) {
        clearTimeout(activityTimeouts.get(key));
        activityTimeouts.delete(key);
      }

      activityTimeouts.set(key, setTimeout(function () {
        return _this2.stop(trid, activityType, extras);
      }, TIMEOUT));
      activityTimeouts.get(key);
    }

    return start;
  }();

  _proto.stop = function () {
    function stop(rid, activityType, extras) {
      var trid = (extras === null || extras === void 0 ? void 0 : extras.tmid) || rid;
      var key = activityType + "-" + trid;

      if (activityTimeouts.get(key)) {
        clearTimeout(activityTimeouts.get(key));
        activityTimeouts.delete(key);
      }

      if (activityRenews.get(key)) {
        clearTimeout(activityRenews.get(key));
        activityRenews.delete(key);
      }

      if (continuingIntervals.get(key)) {
        clearInterval(continuingIntervals.get(key));
        continuingIntervals.delete(key);
      }

      var activities = roomActivities.get(trid) || new Set();
      activities.delete(activityType);
      roomActivities.set(trid, activities);
      emitActivities(rid, extras);
    }

    return stop;
  }();

  _proto.cancel = function () {
    function cancel(rid) {
      if (!rooms.get(rid)) {
        return;
      }

      Notifications.unRoom(rid, USER_ACTIVITY, rooms.get(rid));
      rooms.delete(rid);
    }

    return cancel;
  }();

  _proto.get = function () {
    function get(roomId) {
      return performingUsers.get(roomId);
    }

    return get;
  }();

  return _class;
}())();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserCard.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/UserCard.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
module.export({
  closeUserCard: function () {
    return closeUserCard;
  },
  openUserCard: function () {
    return openUserCard;
  }
});
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var createEphemeralPortal;
module.link("../../../../client/lib/portals/createEphemeralPortal", {
  createEphemeralPortal: function (v) {
    createEphemeralPortal = v;
  }
}, 2);
var Dep = new Tracker.Dependency();
var container;
var routeComputation;
var props;
var unregister;

var createContainer = function () {
  var div = document.createElement('div');
  div.id = 'react-user-card';
  document.body.appendChild(div);
  return div;
};

var closeUserCard = function () {
  if (!container) {
    return;
  }

  if (routeComputation) {
    routeComputation.stop();
    routeComputation = undefined;
  }

  Tracker.afterFlush(function () {
    if (unregister) {
      unregister();
      unregister = undefined;
    }
  });
};

var openUserCard = function (args) {
  props = _objectSpread(_objectSpread({}, args), {}, {
    onClose: closeUserCard
  });
  Dep.changed();
  container = container || createContainer();
  unregister = unregister || createEphemeralPortal(function () {
    return module.dynamicImport('../../../../client/views/room/UserCard');
  }, function () {
    Dep.depend();
    return props;
  }, container);
  routeComputation = routeComputation || Tracker.autorun(function (c) {
    FlowRouter.watchPathChange();

    if (!c.firstRun) {
      closeUserCard();
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"accounts.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/accounts.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
var t;
module.link("../../../utils", {
  t: function (v) {
    t = v;
  }
}, 2);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 3);
Accounts.onEmailVerificationLink(function (token, done) {
  Accounts.verifyEmail(token, function (error) {
    if (error == null) {
      dispatchToastMessage({
        type: 'success',
        message: t('Email_verified')
      });
      Meteor.call('afterVerifyEmail');
    } else {
      dispatchToastMessage({
        type: 'error',
        message: error.message
      });
    }

    return done();
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"chatMessages.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/chatMessages.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 1);
module.export({
  ChatMessages: function () {
    return ChatMessages;
  }
});
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 2);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 3);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 4);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 5);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 6);
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 7);
var KonchatNotification;
module.link("./notification", {
  KonchatNotification: function (v) {
    KonchatNotification = v;
  }
}, 8);
var UserAction, USER_ACTIVITIES;
module.link("../index", {
  UserAction: function (v) {
    UserAction = v;
  },
  USER_ACTIVITIES: function (v) {
    USER_ACTIVITIES = v;
  }
}, 9);
var fileUpload;
module.link("./fileUpload", {
  fileUpload: function (v) {
    fileUpload = v;
  }
}, 10);
var t, slashCommands;
module.link("../../../utils/client", {
  t: function (v) {
    t = v;
  },
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 11);
var messageProperties, MessageTypes, readMessage;
module.link("../../../ui-utils/client", {
  messageProperties: function (v) {
    messageProperties = v;
  },
  MessageTypes: function (v) {
    MessageTypes = v;
  },
  readMessage: function (v) {
    readMessage = v;
  }
}, 12);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 13);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 14);
var hasAtLeastOnePermission;
module.link("../../../authorization/client", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 15);
var Messages, Rooms, ChatMessage, ChatSubscription;
module.link("../../../models/client", {
  Messages: function (v) {
    Messages = v;
  },
  Rooms: function (v) {
    Rooms = v;
  },
  ChatMessage: function (v) {
    ChatMessage = v;
  },
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 16);
var emoji;
module.link("../../../emoji/client", {
  emoji: function (v) {
    emoji = v;
  }
}, 17);
var generateTriggerId;
module.link("../../../ui-message/client/ActionManager", {
  generateTriggerId: function (v) {
    generateTriggerId = v;
  }
}, 18);
var imperativeModal;
module.link("../../../../client/lib/imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 19);
var GenericModal;
module.link("../../../../client/components/GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 20);
var keyCodes;
module.link("../../../../client/lib/utils/keyCodes", {
  keyCodes: function (v) {
    keyCodes = v;
  }
}, 21);
var prependReplies;
module.link("../../../../client/lib/utils/prependReplies", {
  prependReplies: function (v) {
    prependReplies = v;
  }
}, 22);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 23);
var handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 24);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 25);
var onClientBeforeSendMessage;
module.link("../../../../client/lib/onClientBeforeSendMessage", {
  onClientBeforeSendMessage: function (v) {
    onClientBeforeSendMessage = v;
  }
}, 26);
var messageBoxState = {
  saveValue: _.debounce(function (_ref, value) {
    var rid = _ref.rid,
        tmid = _ref.tmid;
    var key = ['messagebox', rid, tmid].filter(Boolean).join('_');
    value ? Meteor._localStorage.setItem(key, value) : Meteor._localStorage.removeItem(key);
  }, 1000),
  restoreValue: function (_ref2) {
    var rid = _ref2.rid,
        tmid = _ref2.tmid;
    var key = ['messagebox', rid, tmid].filter(Boolean).join('_');
    return Meteor._localStorage.getItem(key);
  },
  restore: function (_ref3, input) {
    var rid = _ref3.rid,
        tmid = _ref3.tmid;
    var value = messageBoxState.restoreValue({
      rid: rid,
      tmid: tmid
    });

    if (typeof value === 'string') {
      messageBoxState.set(input, value);
    }
  },
  save: function (_ref4, input) {
    var rid = _ref4.rid,
        tmid = _ref4.tmid;
    messageBoxState.saveValue({
      rid: rid,
      tmid: tmid
    }, input.value);
  },
  set: function (input, value) {
    input.value = value;
    $(input).trigger('change').trigger('input');
  },
  purgeAll: function () {
    Object.keys(Meteor._localStorage).filter(function (key) {
      return key.indexOf('messagebox_') === 0;
    }).forEach(function (key) {
      return Meteor._localStorage.removeItem(key);
    });
  }
};
callbacks.add('afterLogoutCleanUp', messageBoxState.purgeAll, callbacks.priority.MEDIUM, 'chatMessages-after-logout-cleanup');

var ChatMessages = /*#__PURE__*/function () {
  function ChatMessages() {
    var collection = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ChatMessage;
    this.editing = {};
    this.records = {};
    this.collection = collection;
  }

  var _proto = ChatMessages.prototype;

  _proto.initializeWrapper = function () {
    function initializeWrapper(wrapper) {
      this.wrapper = wrapper;
    }

    return initializeWrapper;
  }();

  _proto.initializeInput = function () {
    function initializeInput(input, _ref5) {
      var rid = _ref5.rid,
          tmid = _ref5.tmid;
      this.input = input;
      this.$input = $(this.input);

      if (!input || !rid) {
        return;
      }

      messageBoxState.restore({
        rid: rid,
        tmid: tmid
      }, input);
      this.restoreReplies();
      this.requestInputFocus();
    }

    return initializeInput;
  }();

  _proto.restoreReplies = function () {
    function restoreReplies() {
      var mid, message;
      return _regeneratorRuntime.async(function () {
        function restoreReplies$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                mid = FlowRouter.getQueryParam('reply');

                if (mid) {
                  _context.next = 3;
                  break;
                }

                return _context.abrupt("return");

              case 3:
                _context.t0 = Messages.findOne(mid);

                if (_context.t0) {
                  _context.next = 8;
                  break;
                }

                _context.next = 7;
                return _regeneratorRuntime.awrap(callWithErrorHandling('getSingleMessage', mid));

              case 7:
                _context.t0 = _context.sent;

              case 8:
                message = _context.t0;

                if (message) {
                  _context.next = 11;
                  break;
                }

                return _context.abrupt("return");

              case 11:
                this.$input.data('reply', [message]).trigger('dataChange');

              case 12:
              case "end":
                return _context.stop();
            }
          }
        }

        return restoreReplies$;
      }(), null, this, null, Promise);
    }

    return restoreReplies;
  }();

  _proto.requestInputFocus = function () {
    function requestInputFocus() {
      var _this = this;

      setTimeout(function () {
        if (_this.input && window.matchMedia('screen and (min-device-width: 500px)').matches) {
          _this.input.focus();
        }
      }, 200);
    }

    return requestInputFocus;
  }();

  _proto.recordInputAsDraft = function () {
    function recordInputAsDraft() {
      var message = this.collection.findOne(this.editing.id);
      var record = this.records[this.editing.id] || {};
      var draft = this.input.value;

      if (draft === message.msg) {
        this.clearCurrentDraft();
        return;
      }

      record.draft = draft;
      this.records[this.editing.id] = record;
    }

    return recordInputAsDraft;
  }();

  _proto.clearCurrentDraft = function () {
    function clearCurrentDraft() {
      var hasValue = this.records[this.editing.id];
      delete this.records[this.editing.id];
      return !!hasValue;
    }

    return clearCurrentDraft;
  }();

  _proto.resetToDraft = function () {
    function resetToDraft(id) {
      var message = this.collection.findOne(id);
      var oldValue = this.input.value;
      messageBoxState.set(this.input, message.msg);
      return oldValue !== message.msg;
    }

    return resetToDraft;
  }();

  _proto.toPrevMessage = function () {
    function toPrevMessage() {
      var element = this.editing.element;

      if (!element) {
        var messages = Array.from(this.wrapper.querySelectorAll('.own:not(.system)'));
        var message = messages.pop();
        return message && this.edit(message, false);
      }

      for (var previous = element.previousElementSibling; previous; previous = previous.previousElementSibling) {
        if (previous.matches('.own:not(.system)')) {
          return this.edit(previous, false);
        }
      }

      this.clearEditing();
    }

    return toPrevMessage;
  }();

  _proto.toNextMessage = function () {
    function toNextMessage() {
      var element = this.editing.element;

      if (element) {
        var next;

        for (next = element.nextElementSibling; next; next = next.nextElementSibling) {
          if (next.matches('.own:not(.system)')) {
            break;
          }
        }

        next ? this.edit(next, true) : this.clearEditing();
      } else {
        this.clearEditing();
      }
    }

    return toNextMessage;
  }();

  _proto.edit = function () {
    function edit(element, isEditingTheNextOne) {
      var message = this.collection.findOne(element.dataset.id);
      var hasPermission = hasAtLeastOnePermission('edit-message', message.rid);
      var editAllowed = settings.get('Message_AllowEditing');
      var editOwn = message && message.u && message.u._id === Meteor.userId();

      if (!hasPermission && (!editAllowed || !editOwn)) {
        return;
      }

      if (element.classList.contains('system')) {
        return;
      }

      var blockEditInMinutes = settings.get('Message_AllowEditing_BlockEditInMinutes');

      if (blockEditInMinutes && blockEditInMinutes !== 0) {
        var currentTsDiff;
        var msgTs;

        if (message.ts) {
          msgTs = moment(message.ts);
        }

        if (msgTs) {
          currentTsDiff = moment().diff(msgTs, 'minutes');
        }

        if (currentTsDiff > blockEditInMinutes) {
          return;
        }
      }

      var draft = this.records[message._id];
      var msg = draft && draft.draft;
      msg = msg || message.msg;
      this.clearEditing();
      this.editing.element = element;
      this.editing.id = message._id;
      this.input.parentElement.classList.add('editing');
      element.classList.add('editing');

      if (message.attachments && message.attachments[0].description) {
        messageBoxState.set(this.input, message.attachments[0].description);
      } else {
        messageBoxState.set(this.input, msg);
      }

      var cursorPosition = isEditingTheNextOne ? 0 : -1;
      this.input.focus();
      this.$input.setCursorPosition(cursorPosition);
    }

    return edit;
  }();

  _proto.clearEditing = function () {
    function clearEditing() {
      if (!this.editing.element) {
        this.editing.saved = this.input.value;
        this.editing.savedCursor = this.input.selectionEnd;
        return;
      }

      this.recordInputAsDraft();
      this.input.parentElement.classList.remove('editing');
      this.editing.element.classList.remove('editing');
      delete this.editing.id;
      delete this.editing.element;
      messageBoxState.set(this.input, this.editing.saved || '');
      var cursorPosition = this.editing.savedCursor ? this.editing.savedCursor : -1;
      this.$input.setCursorPosition(cursorPosition);
    }

    return clearEditing;
  }();

  _proto.send = function () {
    function send(event, _ref6) {
      var rid,
          tmid,
          value,
          tshow,
          done,
          threadsEnabled,
          msg,
          mention,
          replies,
          originalMessage,
          message,
          _message,
          isDescription,
          _args2 = arguments;

      return _regeneratorRuntime.async(function () {
        function send$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                rid = _ref6.rid, tmid = _ref6.tmid, value = _ref6.value, tshow = _ref6.tshow;
                done = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : function () {};
                threadsEnabled = settings.get('Threads_enabled');
                UserAction.stop(rid, USER_ACTIVITIES.USER_TYPING, {
                  tmid: tmid
                });

                if (ChatSubscription.findOne({
                  rid: rid
                })) {
                  _context2.next = 7;
                  break;
                }

                _context2.next = 7;
                return _regeneratorRuntime.awrap(callWithErrorHandling('joinRoom', rid));

              case 7:
                messageBoxState.save({
                  rid: rid,
                  tmid: tmid
                }, this.input);
                msg = value.trim();

                if (!msg) {
                  _context2.next = 17;
                  break;
                }

                mention = this.$input.data('mention-user') || false;
                replies = this.$input.data('reply') || [];

                if (!(!mention || !threadsEnabled)) {
                  _context2.next = 16;
                  break;
                }

                _context2.next = 15;
                return _regeneratorRuntime.awrap(prependReplies(msg, replies, mention));

              case 15:
                msg = _context2.sent;

              case 16:
                if (mention && threadsEnabled && replies.length) {
                  tmid = replies[0]._id;
                }

              case 17:
                // don't add tmid or tshow if the message isn't part of a thread (it can happen if editing the main message of a thread)
                originalMessage = this.collection.findOne({
                  _id: this.editing.id
                }, {
                  fields: {
                    tmid: 1
                  },
                  reactive: false
                });

                if (originalMessage && tmid && !originalMessage.tmid) {
                  tmid = undefined;
                  tshow = undefined;
                }

                if (!msg) {
                  _context2.next = 35;
                  break;
                }

                readMessage.readNow(rid);
                readMessage.refreshUnreadMark(rid);
                _context2.next = 24;
                return _regeneratorRuntime.awrap(onClientBeforeSendMessage({
                  _id: Random.id(),
                  rid: rid,
                  tshow: tshow,
                  tmid: tmid,
                  msg: msg
                }));

              case 24:
                message = _context2.sent;
                _context2.prev = 25;
                _context2.next = 28;
                return _regeneratorRuntime.awrap(this.processMessageSend(message));

              case 28:
                this.$input.removeData('reply').trigger('dataChange');
                _context2.next = 34;
                break;

              case 31:
                _context2.prev = 31;
                _context2.t0 = _context2["catch"](25);
                handleError(_context2.t0);

              case 34:
                return _context2.abrupt("return", done());

              case 35:
                if (!this.editing.id) {
                  _context2.next = 51;
                  break;
                }

                _message = this.collection.findOne(this.editing.id);
                isDescription = _message.attachments && _message.attachments[0] && _message.attachments[0].description;
                _context2.prev = 38;

                if (!isDescription) {
                  _context2.next = 43;
                  break;
                }

                _context2.next = 42;
                return _regeneratorRuntime.awrap(this.processMessageEditing({
                  _id: this.editing.id,
                  rid: rid,
                  msg: ''
                }));

              case 42:
                return _context2.abrupt("return", done());

              case 43:
                this.resetToDraft(this.editing.id);
                this.confirmDeleteMsg(_message, done);
                return _context2.abrupt("return");

              case 48:
                _context2.prev = 48;
                _context2.t1 = _context2["catch"](38);
                handleError(_context2.t1);

              case 51:
                return _context2.abrupt("return", done());

              case 52:
              case "end":
                return _context2.stop();
            }
          }
        }

        return send$;
      }(), null, this, [[25, 31], [38, 48]], Promise);
    }

    return send;
  }();

  _proto.processMessageSend = function () {
    function processMessageSend(message) {
      return _regeneratorRuntime.async(function () {
        function processMessageSend$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                _context3.next = 2;
                return _regeneratorRuntime.awrap(this.processSetReaction(message));

              case 2:
                if (!_context3.sent) {
                  _context3.next = 4;
                  break;
                }

                return _context3.abrupt("return");

              case 4:
                this.clearCurrentDraft();
                _context3.next = 7;
                return _regeneratorRuntime.awrap(this.processTooLongMessage(message));

              case 7:
                if (!_context3.sent) {
                  _context3.next = 9;
                  break;
                }

                return _context3.abrupt("return");

              case 9:
                _context3.next = 11;
                return _regeneratorRuntime.awrap(this.processMessageEditing(_objectSpread(_objectSpread({}, message), {}, {
                  _id: this.editing.id
                })));

              case 11:
                if (!_context3.sent) {
                  _context3.next = 13;
                  break;
                }

                return _context3.abrupt("return");

              case 13:
                KonchatNotification.removeRoomNotification(message.rid);
                _context3.next = 16;
                return _regeneratorRuntime.awrap(this.processSlashCommand(message));

              case 16:
                if (!_context3.sent) {
                  _context3.next = 18;
                  break;
                }

                return _context3.abrupt("return");

              case 18:
                _context3.next = 20;
                return _regeneratorRuntime.awrap(callWithErrorHandling('sendMessage', message));

              case 20:
              case "end":
                return _context3.stop();
            }
          }
        }

        return processMessageSend$;
      }(), null, this, null, Promise);
    }

    return processMessageSend;
  }();

  _proto.processSetReaction = function () {
    function processSetReaction(_ref7) {
      var rid, tmid, msg, reaction, lastMessage;
      return _regeneratorRuntime.async(function () {
        function processSetReaction$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                rid = _ref7.rid, tmid = _ref7.tmid, msg = _ref7.msg;

                if (!(msg.slice(0, 2) !== '+:')) {
                  _context4.next = 3;
                  break;
                }

                return _context4.abrupt("return", false);

              case 3:
                reaction = msg.slice(1).trim();

                if (emoji.list[reaction]) {
                  _context4.next = 6;
                  break;
                }

                return _context4.abrupt("return", false);

              case 6:
                lastMessage = this.collection.findOne({
                  rid: rid,
                  tmid: tmid
                }, {
                  fields: {
                    ts: 1
                  },
                  sort: {
                    ts: -1
                  }
                });
                _context4.next = 9;
                return _regeneratorRuntime.awrap(callWithErrorHandling('setReaction', reaction, lastMessage._id));

              case 9:
                return _context4.abrupt("return", true);

              case 10:
              case "end":
                return _context4.stop();
            }
          }
        }

        return processSetReaction$;
      }(), null, this, null, Promise);
    }

    return processSetReaction;
  }();

  _proto.processTooLongMessage = function () {
    function processTooLongMessage(_ref8) {
      var _this2 = this;

      var msg, rid, tmid, adjustedMessage, onConfirm, onClose;
      return _regeneratorRuntime.async(function () {
        function processTooLongMessage$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                msg = _ref8.msg, rid = _ref8.rid, tmid = _ref8.tmid;
                adjustedMessage = messageProperties.messageWithoutEmojiShortnames(msg);

                if (!(messageProperties.length(adjustedMessage) <= settings.get('Message_MaxAllowedSize') && msg)) {
                  _context5.next = 4;
                  break;
                }

                return _context5.abrupt("return", false);

              case 4:
                if (!(!settings.get('FileUpload_Enabled') || !settings.get('Message_AllowConvertLongMessagesToAttachment') || this.editing.id)) {
                  _context5.next = 6;
                  break;
                }

                throw new Error({
                  error: 'Message_too_long'
                });

              case 6:
                onConfirm = function () {
                  var contentType = 'text/plain';
                  var messageBlob = new Blob([msg], {
                    type: contentType
                  });
                  var fileName = Meteor.user().username + " - " + new Date() + ".txt";
                  var file = new File([messageBlob], fileName, {
                    type: contentType,
                    lastModified: Date.now()
                  });
                  fileUpload([{
                    file: file,
                    name: fileName
                  }], _this2.input, {
                    rid: rid,
                    tmid: tmid
                  });
                  imperativeModal.close();
                };

                onClose = function () {
                  messageBoxState.set(_this2.input, msg);
                  imperativeModal.close();
                };

                imperativeModal.open({
                  component: GenericModal,
                  props: {
                    title: t('Message_too_long'),
                    children: t('Send_it_as_attachment_instead_question'),
                    onConfirm: onConfirm,
                    onClose: onClose,
                    onCancel: onClose,
                    variant: 'warning'
                  }
                });
                return _context5.abrupt("return", true);

              case 10:
              case "end":
                return _context5.stop();
            }
          }
        }

        return processTooLongMessage$;
      }(), null, this, null, Promise);
    }

    return processTooLongMessage;
  }();

  _proto.processMessageEditing = function () {
    function processMessageEditing(message) {
      return _regeneratorRuntime.async(function () {
        function processMessageEditing$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                if (message._id) {
                  _context6.next = 2;
                  break;
                }

                return _context6.abrupt("return", false);

              case 2:
                if (!MessageTypes.isSystemMessage(message)) {
                  _context6.next = 4;
                  break;
                }

                return _context6.abrupt("return", false);

              case 4:
                this.clearEditing();
                _context6.next = 7;
                return _regeneratorRuntime.awrap(callWithErrorHandling('updateMessage', message));

              case 7:
                return _context6.abrupt("return", true);

              case 8:
              case "end":
                return _context6.stop();
            }
          }
        }

        return processMessageEditing$;
      }(), null, this, null, Promise);
    }

    return processMessageEditing;
  }();

  _proto.processSlashCommand = function () {
    function processSlashCommand(msgObject) {
      var match, command, commandOptions, param, triggerId, invalidCommandMsg;
      return _regeneratorRuntime.async(function () {
        function processSlashCommand$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                if (!(msgObject.msg[0] === '/')) {
                  _context7.next = 14;
                  break;
                }

                match = msgObject.msg.match(/^\/([^\s]+)(?:\s+(.*))?$/m);

                if (!match) {
                  _context7.next = 14;
                  break;
                }

                if (!slashCommands.commands[match[1]]) {
                  _context7.next = 10;
                  break;
                }

                commandOptions = slashCommands.commands[match[1]];
                command = match[1];
                param = match[2] || '';

                if (!(!commandOptions.permission || hasAtLeastOnePermission(commandOptions.permission, Session.get('openedRoom')))) {
                  _context7.next = 10;
                  break;
                }

                if (commandOptions.clientOnly) {
                  commandOptions.callback(command, param, msgObject);
                } else {
                  triggerId = generateTriggerId(slashCommands.commands[command].appId);
                  Meteor.call('slashCommand', {
                    cmd: command,
                    params: param,
                    msg: msgObject,
                    triggerId: triggerId
                  }, function (err, result) {
                    typeof commandOptions.result === 'function' && commandOptions.result(err, result, {
                      cmd: command,
                      params: param,
                      msg: msgObject
                    });
                  });
                }

                return _context7.abrupt("return", true);

              case 10:
                if (settings.get('Message_AllowUnrecognizedSlashCommand')) {
                  _context7.next = 14;
                  break;
                }

                invalidCommandMsg = {
                  _id: Random.id(),
                  rid: msgObject.rid,
                  ts: new Date(),
                  msg: TAPi18n.__('No_such_command', {
                    command: escapeHTML(match[1])
                  }),
                  u: {
                    username: settings.get('InternalHubot_Username') || 'rocket.cat'
                  },
                  "private": true
                };
                this.collection.upsert({
                  _id: invalidCommandMsg._id
                }, invalidCommandMsg);
                return _context7.abrupt("return", true);

              case 14:
                return _context7.abrupt("return", false);

              case 15:
              case "end":
                return _context7.stop();
            }
          }
        }

        return processSlashCommand$;
      }(), null, this, null, Promise);
    }

    return processSlashCommand;
  }();

  _proto.confirmDeleteMsg = function () {
    function confirmDeleteMsg(message) {
      var _this3 = this;

      var done = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};

      if (MessageTypes.isSystemMessage(message)) {
        return done();
      }

      var room = message.drid && Rooms.findOne({
        _id: message.drid,
        prid: {
          $exists: true
        }
      });

      var onConfirm = function () {
        if (_this3.editing.id === message._id) {
          _this3.clearEditing();
        }

        _this3.deleteMsg(message);

        _this3.$input.focus();

        done();
        imperativeModal.close();
        dispatchToastMessage({
          type: 'success',
          message: t('Your_entry_has_been_deleted')
        });
      };

      var onCloseModal = function () {
        imperativeModal.close();

        if (_this3.editing.id === message._id) {
          _this3.clearEditing();
        }

        _this3.$input.focus();

        done();
      };

      imperativeModal.open({
        component: GenericModal,
        props: {
          title: t('Are_you_sure'),
          children: room ? t('The_message_is_a_discussion_you_will_not_be_able_to_recover') : t('You_will_not_be_able_to_recover'),
          variant: 'danger',
          confirmText: t('Yes_delete_it'),
          onConfirm: onConfirm,
          onClose: onCloseModal,
          onCancel: onCloseModal
        }
      });
    }

    return confirmDeleteMsg;
  }();

  _proto.deleteMsg = function () {
    function deleteMsg(_ref9) {
      var _id, rid, ts, forceDelete, blockDeleteInMinutes, msgTs, currentTsDiff;

      return _regeneratorRuntime.async(function () {
        function deleteMsg$(_context8) {
          while (1) {
            switch (_context8.prev = _context8.next) {
              case 0:
                _id = _ref9._id, rid = _ref9.rid, ts = _ref9.ts;
                forceDelete = hasAtLeastOnePermission('force-delete-message', rid);
                blockDeleteInMinutes = settings.get('Message_AllowDeleting_BlockDeleteInMinutes');

                if (!(blockDeleteInMinutes && forceDelete === false)) {
                  _context8.next = 9;
                  break;
                }

                if (ts) {
                  msgTs = moment(ts);
                }

                if (msgTs) {
                  currentTsDiff = moment().diff(msgTs, 'minutes');
                }

                if (!(currentTsDiff > blockDeleteInMinutes)) {
                  _context8.next = 9;
                  break;
                }

                dispatchToastMessage({
                  type: 'error',
                  message: t('Message_deleting_blocked')
                });
                return _context8.abrupt("return");

              case 9:
                _context8.next = 11;
                return _regeneratorRuntime.awrap(callWithErrorHandling('deleteMessage', {
                  _id: _id
                }));

              case 11:
              case "end":
                return _context8.stop();
            }
          }
        }

        return deleteMsg$;
      }(), null, null, null, Promise);
    }

    return deleteMsg;
  }();

  _proto.keydown = function () {
    function keydown(event) {
      var input = event.currentTarget,
          keyCode = event.which;

      if (keyCode === keyCodes.ESCAPE && this.editing.element) {
        event.preventDefault();
        event.stopPropagation();

        if (!this.resetToDraft(this.editing.id)) {
          this.clearCurrentDraft();
          this.clearEditing();
          return true;
        }

        return;
      }

      if (keyCode === keyCodes.ARROW_UP || keyCode === keyCodes.ARROW_DOWN) {
        if (event.shiftKey) {
          return;
        }

        var cursorPosition = input.selectionEnd;

        if (keyCode === keyCodes.ARROW_UP) {
          if (cursorPosition === 0) {
            this.toPrevMessage();
          } else if (!event.altKey) {
            return;
          }

          if (event.altKey) {
            this.$input.setCursorPosition(0);
          }
        } else {
          if (cursorPosition === input.value.length) {
            this.toNextMessage();
          } else if (!event.altKey) {
            return;
          }

          if (event.altKey) {
            this.$input.setCursorPosition(-1);
          }
        }

        event.preventDefault();
        event.stopPropagation();
      }
    }

    return keydown;
  }();

  _proto.keyup = function () {
    function keyup(event, _ref10) {
      var rid = _ref10.rid,
          tmid = _ref10.tmid;
      var input = event.currentTarget,
          keyCode = event.which;

      if (!Object.values(keyCodes).includes(keyCode)) {
        if (input.value.trim()) {
          UserAction.start(rid, USER_ACTIVITIES.USER_TYPING, {
            tmid: tmid
          });
        } else {
          UserAction.stop(rid, USER_ACTIVITIES.USER_TYPING, {
            tmid: tmid
          });
        }
      }

      messageBoxState.save({
        rid: rid,
        tmid: tmid
      }, input);
    }

    return keyup;
  }();

  _proto.onDestroyed = function () {
    function onDestroyed(rid, tmid) {
      var _this$input, _this$input$parentEle;

      UserAction.cancel(rid); // TODO: check why we need too many ?. here :(

      if (((_this$input = this.input) === null || _this$input === void 0 ? void 0 : (_this$input$parentEle = _this$input.parentElement) === null || _this$input$parentEle === void 0 ? void 0 : _this$input$parentEle.classList.contains('editing')) === true) {
        if (!tmid) {
          this.clearCurrentDraft();
          this.clearEditing();
        }

        messageBoxState.set(this.input, '');
        messageBoxState.save({
          rid: rid,
          tmid: tmid
        }, this.$input);
      }
    }

    return onDestroyed;
  }();

  return ChatMessages;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"collections.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/collections.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var CachedChatRoom, CachedChatSubscription;
module.link("../../../models", {
  CachedChatRoom: function (v) {
    CachedChatRoom = v;
  },
  CachedChatSubscription: function (v) {
    CachedChatSubscription = v;
  }
}, 3);
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (!Meteor.userId() && settings.get('Accounts_AllowAnonymousRead') === true) {
      CachedChatRoom.init();
      CachedChatSubscription.ready.set(true);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"fileUpload.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/fileUpload.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  uploadFileWithMessage: function () {
    return uploadFileWithMessage;
  },
  fileUpload: function () {
    return fileUpload;
  }
});
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 2);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var UserAction, USER_ACTIVITIES;
module.link("../index", {
  UserAction: function (v) {
    UserAction = v;
  },
  USER_ACTIVITIES: function (v) {
    USER_ACTIVITIES = v;
  }
}, 4);
var fileUploadIsValidContentType, APIClient;
module.link("../../../utils", {
  fileUploadIsValidContentType: function (v) {
    fileUploadIsValidContentType = v;
  },
  APIClient: function (v) {
    APIClient = v;
  }
}, 5);
var imperativeModal;
module.link("../../../../client/lib/imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 6);
var FileUploadModal;
module.link("../../../../client/views/room/modals/FileUploadModal", {
  "default": function (v) {
    FileUploadModal = v;
  }
}, 7);
var prependReplies;
module.link("../../../../client/lib/utils/prependReplies", {
  prependReplies: function (v) {
    prependReplies = v;
  }
}, 8);

var uploadFileWithMessage = function () {
  function _callee(rid, tmid, _ref) {
    var description, fileName, msg, file, data, uploads, upload, _APIClient$upload, xhr, promise, _uploads, remainingUploads, _uploads2;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              description = _ref.description, fileName = _ref.fileName, msg = _ref.msg, file = _ref.file;
              data = new FormData();
              description && data.append('description', description);
              msg && data.append('msg', msg);
              tmid && data.append('tmid', tmid);
              data.append('file', file.file, fileName);
              uploads = Session.get('uploading') || [];
              upload = {
                id: Random.id(),
                name: fileName,
                percentage: 0
              };
              uploads.push(upload);
              Session.set('uploading', uploads);
              _APIClient$upload = APIClient.upload("v1/rooms.upload/" + rid, {}, data, {
                progress: function (progress) {
                  var uploads = Session.get('uploading') || [];

                  if (progress === 100) {
                    return;
                  }

                  uploads.filter(function (u) {
                    return u.id === upload.id;
                  }).forEach(function (u) {
                    u.percentage = Math.round(progress) || 0;
                  });
                  Session.set('uploading', uploads);
                },
                error: function (error) {
                  var uploads = Session.get('uploading') || [];
                  uploads.filter(function (u) {
                    return u.id === upload.id;
                  }).forEach(function (u) {
                    u.error = error.message;
                    u.percentage = 0;
                  });
                  Session.set('uploading', uploads);
                }
              }), xhr = _APIClient$upload.xhr, promise = _APIClient$upload.promise;

              if (Session.get('uploading').length) {
                UserAction.performContinuously(rid, USER_ACTIVITIES.USER_UPLOADING, {
                  tmid: tmid
                });
              }

              Tracker.autorun(function (computation) {
                var isCanceling = Session.get("uploading-cancel-" + upload.id);

                if (!isCanceling) {
                  return;
                }

                computation.stop();
                Session.delete("uploading-cancel-" + upload.id);
                xhr.abort();
                var uploads = Session.get('uploading') || {};
                Session.set('uploading', uploads.filter(function (u) {
                  return u.id !== upload.id;
                }));
              });
              _context.prev = 13;
              _context.next = 16;
              return _regeneratorRuntime.awrap(promise);

            case 16:
              _uploads = Session.get('uploading') || [];
              remainingUploads = Session.set('uploading', _uploads.filter(function (u) {
                return u.id !== upload.id;
              }));

              if (!Session.get('uploading').length) {
                UserAction.stop(rid, USER_ACTIVITIES.USER_UPLOADING, {
                  tmid: tmid
                });
              }

              return _context.abrupt("return", remainingUploads);

            case 22:
              _context.prev = 22;
              _context.t0 = _context["catch"](13);
              _uploads2 = Session.get('uploading') || [];

              _uploads2.filter(function (u) {
                return u.id === upload.id;
              }).forEach(function (u) {
                u.error = _context.t0.xhr && _context.t0.xhr.responseJSON && _context.t0.xhr.responseJSON.error || _context.t0.message;
                u.percentage = 0;
              });

              if (!_uploads2.length) {
                UserAction.stop(rid, USER_ACTIVITIES.USER_UPLOADING, {
                  tmid: tmid
                });
              }

              Session.set('uploading', _uploads2);

            case 28:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, [[13, 22]], Promise);
  }

  return _callee;
}();

var fileUpload = function () {
  function _callee2(files, input, _ref2) {
    var rid, tmid, threadsEnabled, replies, mention, msg, uploadNextFile;
    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              rid = _ref2.rid, tmid = _ref2.tmid;
              threadsEnabled = settings.get('Threads_enabled');
              files = [].concat(files);
              replies = $(input).data('reply') || [];
              mention = $(input).data('mention-user') || false;
              msg = '';

              if (!(!mention || !threadsEnabled)) {
                _context2.next = 10;
                break;
              }

              _context2.next = 9;
              return _regeneratorRuntime.awrap(prependReplies('', replies, mention));

            case 9:
              msg = _context2.sent;

            case 10:
              if (mention && threadsEnabled && replies.length) {
                tmid = replies[0]._id;
              }

              uploadNextFile = function () {
                var file = files.pop();

                if (!file) {
                  return;
                }

                imperativeModal.open({
                  component: FileUploadModal,
                  props: {
                    file: file.file,
                    fileName: file.name,
                    onClose: function () {
                      imperativeModal.close();
                      uploadNextFile();
                    },
                    onSubmit: function (fileName, description) {
                      uploadFileWithMessage(rid, tmid, {
                        description: description,
                        fileName: fileName,
                        msg: msg || undefined,
                        file: file
                      });
                      imperativeModal.close();
                      uploadNextFile();
                    },
                    invalidContentType: file.file.type && !fileUploadIsValidContentType(file.file.type)
                  }
                });
              };

              uploadNextFile();

            case 13:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"iframeCommands.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/iframeCommands.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _typeof;

module.link("@babel/runtime/helpers/typeof", {
  default: function (v) {
    _typeof = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 2);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 1);
var ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration: function (v) {
    ServiceConfiguration = v;
  }
}, 2);
var s;
module.link("underscore.string", {
  "default": function (v) {
    s = v;
  }
}, 3);
var escapeRegExp;
module.link("@rocket.chat/string-helpers", {
  escapeRegExp: function (v) {
    escapeRegExp = v;
  }
}, 4);
var AccountBox;
module.link("../../../ui-utils", {
  AccountBox: function (v) {
    AccountBox = v;
  }
}, 5);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 6);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 7);
var add, remove;
module.link("../../../../client/views/room/lib/Toolbox/IframeButtons", {
  add: function (v) {
    add = v;
  },
  remove: function (v) {
    remove = v;
  }
}, 8);
var baseURI;
module.link("../../../../client/lib/baseURI", {
  baseURI: function (v) {
    baseURI = v;
  }
}, 9);
var commands = {
  'go': function (data) {
    if (typeof data.path !== 'string' || data.path.trim().length === 0) {
      return console.error('`path` not defined');
    }

    var newUrl = new URL(s.rtrim(baseURI, '/') + "/" + s.ltrim(data.path, '/'));
    var newParams = Array.from(newUrl.searchParams.entries()).reduce(function (ret, _ref) {
      var _ref2 = _slicedToArray(_ref, 2),
          key = _ref2[0],
          value = _ref2[1];

      ret[key] = value;
      return ret;
    }, {});
    var newPath = newUrl.pathname.replace(new RegExp("^" + escapeRegExp(__meteor_runtime_config__.ROOT_URL_PATH_PREFIX)), '');
    FlowRouter.go(newPath, null, _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), newParams));
  },
  'set-user-status': function (data) {
    AccountBox.setStatus(data.status);
  },
  'call-custom-oauth-login': function (data, event) {
    var customOAuthCallback = function (response) {
      event.source.postMessage({
        event: 'custom-oauth-callback',
        response: response
      }, event.origin);
    };

    var siteUrl = Meteor.settings.Site_Url + "/";

    if (typeof data.redirectUrl !== 'string' || !data.redirectUrl.startsWith(siteUrl)) {
      data.redirectUrl = null;
    }

    if (typeof data.service === 'string' && window.ServiceConfiguration) {
      var customOauth = ServiceConfiguration.configurations.findOne({
        service: data.service
      });

      if (customOauth) {
        var customLoginWith = Meteor["loginWith" + s.capitalize(customOauth.service, true)];
        var customRedirectUri = data.redirectUrl || siteUrl;
        customLoginWith.call(Meteor, {
          redirectUrl: customRedirectUri
        }, customOAuthCallback);
      }
    }
  },
  'login-with-token': function (data) {
    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    if (typeof data.token === 'string') {
      Meteor.loginWithToken(data.token, function () {
        console.log('Iframe command [login-with-token]: result', [data].concat(args));
      });
    }
  },
  'logout': function () {
    var user = Meteor.user();
    Meteor.logout(function () {
      callbacks.run('afterLogoutCleanUp', user);
      Meteor.call('logoutCleanUp', user);
      return FlowRouter.go('home');
    });
  },
  'set-toolbar-button': function (_ref3) {
    var id = _ref3.id,
        icon = _ref3.icon,
        label = _ref3.label;
    add(id, {
      id: id,
      icon: icon,
      label: label
    });
  },
  'remove-toolbar-button': function (_ref4) {
    var id = _ref4.id;
    remove(id);
  }
};
window.addEventListener('message', function (e) {
  if (settings.get('Iframe_Integration_receive_enable') !== true) {
    return;
  }

  if (_typeof(e.data) !== 'object' || typeof e.data.externalCommand !== 'string') {
    return;
  }

  var origins = settings.get('Iframe_Integration_receive_origin');

  if (origins !== '*' && origins.split(',').indexOf(e.origin) === -1) {
    return console.error('Origin not allowed', e.origin);
  }

  var command = commands[e.data.externalCommand];

  if (command) {
    command(e.data, e);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"menu.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/menu.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var menu;
module.link("../../../ui-utils", {
  menu: function (v) {
    menu = v;
  }
}, 1);
window.addEventListener('resize', _.debounce(function () {
  var lastState = window.matchMedia('(min-width: 780px)').matches ? 'mini' : 'large';
  menu.close();
  return function () {
    var futureState = window.matchMedia('(min-width: 780px)').matches ? 'mini' : 'large';

    if (lastState !== futureState) {
      lastState = futureState;
      menu.close();
    }
  };
}(), 100));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"notification.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/notification.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);
module.export({
  KonchatNotification: function () {
    return KonchatNotification;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 4);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 5);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 6);
var s;
module.link("underscore.string", {
  "default": function (v) {
    s = v;
  }
}, 7);
var e2e;
module.link("../../../e2e/client", {
  e2e: function (v) {
    e2e = v;
  }
}, 8);
var Users, ChatSubscription;
module.link("../../../models", {
  Users: function (v) {
    Users = v;
  },
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 9);
var getUserPreference;
module.link("../../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 10);
var getUserAvatarURL;
module.link("../../../utils/lib/getUserAvatarURL", {
  getUserAvatarURL: function (v) {
    getUserAvatarURL = v;
  }
}, 11);
var CustomSounds;
module.link("../../../custom-sounds/client/lib/CustomSounds", {
  CustomSounds: function (v) {
    CustomSounds = v;
  }
}, 12);
var getAvatarAsPng;
module.link("../../../../client/lib/utils/getAvatarAsPng", {
  getAvatarAsPng: function (v) {
    getAvatarAsPng = v;
  }
}, 13);
var onClientMessageReceived;
module.link("../../../../client/lib/onClientMessageReceived", {
  onClientMessageReceived: function (v) {
    onClientMessageReceived = v;
  }
}, 14);
var KonchatNotification = {
  notificationStatus: new ReactiveVar(),
  // notificacoes HTML5
  getDesktopPermission: function () {
    if (window.Notification && Notification.permission !== 'granted') {
      return Notification.requestPermission(function (status) {
        KonchatNotification.notificationStatus.set(status);

        if (Notification.permission !== status) {
          Notification.permission = status;
        }
      });
    }
  },
  notify: function (notification) {
    if (window.Notification && Notification.permission === 'granted') {
      var message = {
        rid: notification.payload != null ? notification.payload.rid : undefined,
        msg: notification.text,
        notification: true
      };
      return onClientMessageReceived(message).then(function (message) {
        var requireInteraction = getUserPreference(Meteor.userId(), 'desktopNotificationRequireInteraction');
        var n = new Notification(notification.title, {
          icon: notification.icon || getUserAvatarURL(notification.payload.sender.username),
          body: s.stripTags(message.msg),
          tag: notification.payload._id,
          canReply: true,
          silent: true,
          requireInteraction: requireInteraction
        });
        var notificationDuration = !requireInteraction && (notification.duration - 0 || 10);

        if (notificationDuration > 0) {
          setTimeout(function () {
            return n.close();
          }, notificationDuration * 1000);
        }

        if (notification.payload && notification.payload.rid) {
          if (n.addEventListener) {
            n.addEventListener('reply', function (_ref) {
              var response = _ref.response;
              return Meteor.call('sendMessage', {
                _id: Random.id(),
                rid: notification.payload.rid,
                msg: response
              });
            });
          }

          n.onclick = function () {
            this.close();
            window.focus();

            switch (notification.payload.type) {
              case 'd':
                return FlowRouter.go('direct', _objectSpread({
                  rid: notification.payload.rid
                }, notification.payload.tmid && {
                  tab: 'thread',
                  context: notification.payload.tmid
                }), _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), {}, {
                  jump: notification.payload._id
                }));

              case 'c':
                return FlowRouter.go('channel', _objectSpread({
                  name: notification.payload.name
                }, notification.payload.tmid && {
                  tab: 'thread',
                  context: notification.payload.tmid
                }), _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), {}, {
                  jump: notification.payload._id
                }));

              case 'p':
                return FlowRouter.go('group', _objectSpread({
                  name: notification.payload.name
                }, notification.payload.tmid && {
                  tab: 'thread',
                  context: notification.payload.tmid
                }), _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), {}, {
                  jump: notification.payload._id
                }));
            }
          };
        }
      });
    }
  },
  showDesktop: function () {
    function _callee(notification) {
      var e2eRoom;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (!(notification.payload.rid === Session.get('openedRoom') && (typeof window.document.hasFocus === 'function' ? window.document.hasFocus() : undefined))) {
                  _context.next = 2;
                  break;
                }

                return _context.abrupt("return");

              case 2:
                if (!(Meteor.user().status === 'busy')) {
                  _context.next = 4;
                  break;
                }

                return _context.abrupt("return");

              case 4:
                if (!(notification.payload.message && notification.payload.message.t === 'e2e')) {
                  _context.next = 12;
                  break;
                }

                _context.next = 7;
                return _regeneratorRuntime.awrap(e2e.getInstanceByRoomId(notification.payload.rid));

              case 7:
                e2eRoom = _context.sent;

                if (!e2eRoom) {
                  _context.next = 12;
                  break;
                }

                _context.next = 11;
                return _regeneratorRuntime.awrap(e2eRoom.decrypt(notification.payload.message.msg));

              case 11:
                notification.text = _context.sent.text;

              case 12:
                return _context.abrupt("return", getAvatarAsPng(notification.payload.sender.username, function (avatarAsPng) {
                  notification.icon = avatarAsPng;
                  return KonchatNotification.notify(notification);
                }));

              case 13:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }(),
  newMessage: function (rid) {
    if (Session.equals("user_" + Meteor.user().username + "_status", 'busy')) {
      return;
    }

    var userId = Meteor.userId();
    var newMessageNotification = getUserPreference(userId, 'newMessageNotification');
    var audioVolume = getUserPreference(userId, 'notificationsSoundVolume');
    var sub = ChatSubscription.findOne({
      rid: rid
    }, {
      fields: {
        audioNotificationValue: 1
      }
    });

    if (!sub || sub.audioNotificationValue === 'none') {
      return;
    }

    try {
      if (sub.audioNotificationValue && sub.audioNotificationValue !== '0') {
        CustomSounds.play(sub.audioNotificationValue, {
          volume: Number((audioVolume / 100).toPrecision(2))
        });
        return;
      }

      if (newMessageNotification !== 'none') {
        CustomSounds.play(newMessageNotification, {
          volume: Number((audioVolume / 100).toPrecision(2))
        });
      }
    } catch (e) {// do nothing
    }
  },
  newRoom: function (rid
  /* , withSound = true*/
  ) {
    Tracker.nonreactive(function () {
      var newRoomSound = Session.get('newRoomSound');

      if (newRoomSound != null) {
        newRoomSound = _.union(newRoomSound, [rid]);
      } else {
        newRoomSound = [rid];
      }

      return Session.set('newRoomSound', newRoomSound);
    });
  },
  // $('.link-room-' + rid).addClass('new-room-highlight')
  removeRoomNotification: function (rid) {
    var newRoomSound = Session.get('newRoomSound');
    newRoomSound = _.without(newRoomSound, rid);
    Tracker.nonreactive(function () {
      return Session.set('newRoomSound', newRoomSound);
    });
    return $(".link-room-" + rid).removeClass('new-room-highlight');
  }
};
Meteor.startup(function () {
  Tracker.autorun(function () {
    var user = Users.findOne(Meteor.userId(), {
      fields: {
        'settings.preferences.newRoomNotification': 1,
        'settings.preferences.notificationsSoundVolume': 1
      }
    });
    var newRoomNotification = getUserPreference(user, 'newRoomNotification');
    var audioVolume = getUserPreference(user, 'notificationsSoundVolume');

    if ((Session.get('newRoomSound') || []).length > 0) {
      Meteor.defer(function () {
        if (newRoomNotification !== 'none') {
          CustomSounds.play(newRoomNotification, {
            volume: Number((audioVolume / 100).toPrecision(2))
          });
        }
      });
    } else {
      CustomSounds.pause(newRoomNotification);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"parentTemplate.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/parentTemplate.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 0);

/**
 * Get the parent template instance
 * @param {Number} [levels] How many levels to go up. Default is 1
 * @returns {Blaze.TemplateInstance}
 */
Blaze.TemplateInstance.prototype.parentTemplate = function (levels) {
  var view = Blaze.currentView;

  if (typeof levels === 'undefined') {
    levels = 1;
  }

  while (view) {
    if (view.name.substring(0, 9) === 'Template.' && !levels--) {
      return view.templateInstance();
    }

    view = view.parentView;
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocket.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/rocket.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Login: function () {
    return Login;
  },
  Button: function () {
    return Button;
  }
});

var Login = function () {
  function onClick(el) {
    var $el = $(el);

    if ($el.length) {
      $el.addClass('active');
      return $el.find('input').focus();
    }
  }

  function onBlur(input) {
    var $input = $(input);

    if ($input.length) {
      if (input.value === '') {
        return $input.parents('.input-text').removeClass('active');
      }
    }
  }

  function check(form) {
    var $form = $(form);

    if ($form.length) {
      var inputs = $form.find('input');
      return inputs.each(function () {
        if (this.value !== '') {
          console.log(this.value);
          return $(this).parents('.input-text').addClass('active');
        }
      });
    }
  }

  return {
    check: check,
    onClick: onClick,
    onBlur: onBlur
  };
}();

var Button = function () {
  var time = undefined;

  var loading = function (el) {
    var next = el.attr('data-loading-text');
    var html = el.find('span').html();
    el.addClass('-progress').attr('data-def-text', html).find('span').html(next);
    time = setTimeout(function () {
      return el.addClass('going');
    }, 1);
    return time;
  };

  var done = function (el) {
    return el.addClass('done');
  };

  var reset = function (el) {
    if (time) {
      clearTimeout(time);
    }

    var $el = $(el);
    var html = $el.attr('data-def-text');

    if (html) {
      $el.find('span').html(html);
    }

    return $el.removeClass('-progress going done');
  };

  return {
    done: done,
    loading: loading,
    reset: reset
  };
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"textarea-cursor.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/textarea-cursor.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// http://stackoverflow.com/a/499158
$.fn.setCursorPosition = function (pos) {
  this.each(function (index, element) {
    var p = pos < 0 ? element.value.length - pos : pos;

    if (element.setSelectionRange) {
      element.setSelectionRange(p, p);
    } else if (element.createTextRange) {
      var range = element.createTextRange();
      range.collapse(true);
      range.moveEnd('character', p);
      range.moveStart('character', p);
      range.select();
    }
  });
  return this;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userPopoverStatus.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/lib/userPopoverStatus.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getPopoverStatusConfig: function () {
    return getPopoverStatusConfig;
  }
});
var t;
module.link("../../../utils", {
  t: function (v) {
    t = v;
  }
}, 0);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 1);

var getPopoverStatusConfig = function (currentTarget, actionCallback) {
  var items = [{
    icon: 'circle',
    name: t('Online'),
    modifier: 'online',
    action: function () {
      typeof actionCallback === 'function' && actionCallback('online');
      $('input[name=statusType]').val('online');
      $(currentTarget).prop('class', 'rc-input__icon js-status-type edit-status-type-icon--online');
    }
  }, {
    icon: 'circle',
    name: t('Away'),
    modifier: 'away',
    action: function () {
      typeof actionCallback === 'function' && actionCallback('away');
      $('input[name=statusType]').val('away');
      $(currentTarget).prop('class', 'rc-input__icon js-status-type edit-status-type-icon--away');
    }
  }, {
    icon: 'circle',
    name: t('Busy'),
    modifier: 'busy',
    action: function () {
      typeof actionCallback === 'function' && actionCallback('busy');
      $('input[name=statusType]').val('busy');
      $(currentTarget).prop('class', 'rc-input__icon js-status-type edit-status-type-icon--busy');
    }
  }];

  if (settings.get('Accounts_AllowInvisibleStatusOption')) {
    items.push({
      icon: 'circle',
      name: t('Invisible'),
      modifier: 'offline',
      action: function () {
        typeof actionCallback === 'function' && actionCallback('offline');
        $('input[name=statusType]').val('offline');
        $(currentTarget).prop('class', 'rc-input__icon js-status-type edit-status-type-icon--offline');
      }
    });
  }

  return {
    popoverClass: 'edit-status-type',
    columns: [{
      groups: [{
        items: items
      }]
    }],
    currentTarget: currentTarget,
    offsetVertical: currentTarget.clientHeight
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"components":{"header":{"header.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/header/header.html                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.header.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.header.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/header/template.header.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("header");
Template["header"] = new Template("Template.header", (function() {
  var view = this;
  return HTML.HEADER({
    class: "rc-header"
  }, "\n\t\t", HTML.DIV({
    class: "rc-header__wrap"
  }, "\n\t\t\t", HTML.DIV({
    class: "rc-header__block rc-header--burger"
  }, "\n\t\t\t\t", Spacebars.include(view.lookupTemplate("burger")), "\n\t\t\t"), "\n\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("rawSectionName"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.SPAN({
      class: "rc-header__block"
    }, Blaze.View("lookup:rawSectionName", function() {
      return Spacebars.mustache(view.lookup("rawSectionName"));
    })), "\n\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t", HTML.SPAN({
      class: "rc-header__block"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), view.lookup("sectionName"));
    })), "\n\t\t\t" ];
  }), "\n\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.templateContentBlock);
  }, function() {
    return [ "\n\t\t\t\t", Blaze._InOuterTemplateScope(view, function() {
      return Spacebars.include(function() {
        return Spacebars.call(view.templateContentBlock);
      });
    }), "\n\t\t\t" ];
  }), "\n\n\t\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("hideHelp"));
  }, function() {
    return HTML.Raw('\n\t\t\t\t<div class="rc-header__section-help"></div>\n\t\t\t');
  }), "\n\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("toolbarButtons"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "iframe-toolbar"
    }, "\n\t\t\t\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("buttons"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.BUTTON({
        class: function() {
          return Spacebars.mustache(view.lookup("id"));
        }
      }, "\n\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("icon"));
      }, function() {
        return HTML.I({
          class: function() {
            return Spacebars.mustache(view.lookup("icon"));
          }
        });
      }), "\n\t\t\t\t\t\t", Blaze.View("lookup:label", function() {
        return Spacebars.mustache(view.lookup("label"));
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"header.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/header/header.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var fireGlobalEvent;
module.link("../../../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 1);
module.link("./header.html");
Template.header.helpers({
  back: function () {
    return Template.instance().data.back;
  },
  buttons: function () {
    console.log('asdasd');
  }
});
Template.header.events({
  'click .iframe-toolbar .js-iframe-action': function (e) {
    fireGlobalEvent('click-toolbar-button', {
      id: this.id
    });
    e.currentTarget.querySelector('button').blur();
    return false;
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"icon.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/icon.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.icon.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.icon.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.icon.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("icon");
Template["icon"] = new Template("Template.icon", (function() {
  var view = this;
  return HTML.SVG({
    class: function() {
      return [ "rc-icon ", Spacebars.mustache(view.lookup("block")), " ", Spacebars.mustache(view.lookup("block")), "--", Spacebars.mustache(view.lookup("icon")), " ", Spacebars.mustache(view.lookup("classes")) ];
    },
    "aria-hidden": "true"
  }, "\n\t\t", HTML.USE({
    "xlink:href": function() {
      return [ Spacebars.mustache(view.lookup("baseUrl")), "#icon-", Spacebars.mustache(view.lookup("icon")) ];
    }
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popupList.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/popupList.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.popupList.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.popupList.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.popupList.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("popupList");
Template["popupList"] = new Template("Template.popupList", (function() {
  var view = this;
  return HTML.DIV({
    class: "rc-popup-list"
  }, "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("config"));
  }, function() {
    return Spacebars.include(function() {
      return Spacebars.call(Template.__dynamic);
    });
  }), "\n\t");
}));

Template.__checkName("popupList_default");
Template["popupList_default"] = new Template("Template.popupList_default", (function() {
  var view = this;
  return HTML.UL({
    class: "rc-popup-list__list"
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("loading"));
  }, function() {
    return [ "\n\t\t\t", Spacebars.include(view.lookupTemplate("popupList_loading")), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("items")),
        _variable: "item"
      };
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return Spacebars.dataMustache(view.lookup("config"), view.lookup("item"), Spacebars.kw({
          data: view.lookup("data")
        }));
      }, function() {
        return Spacebars.include(function() {
          return Spacebars.call(Template.__dynamic);
        });
      }), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          template: Spacebars.call(view.lookup("noMatchTemplate"))
        };
      }, function() {
        return Spacebars.include(function() {
          return Spacebars.call(Template.__dynamic);
        });
      }), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t");
}));

Template.__checkName("popupList_item_default");
Template["popupList_item_default"] = new Template("Template.popupList_item_default", (function() {
  var view = this;
  return HTML.LI({
    class: "rc-popup-list__item"
  }, "\n\t\t ", HTML.SPAN({
    class: "rc-popup-list__item-image"
  }, "\n\t\t\t ", Blaze._TemplateWith(function() {
    return {
      username: Spacebars.call(Spacebars.dot(view.lookup("item"), "username"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("avatar"));
  }), "\n\t\t "), "\n\t\t ", Blaze.If(function() {
    return Spacebars.call(view.lookup("showRealNames"));
  }, function() {
    return [ "\n\t\t \t", HTML.SPAN({
      class: "rc-popup-list__item-name"
    }, Blaze.View("lookup:modifier", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "name")));
    }), Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("item"), "nickname"));
    }, function() {
      return [ " (", Blaze.View("lookup:modifier", function() {
        return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "nickname")));
      }), ")" ];
    }), " (", Blaze.View("lookup:modifier", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "username")));
    }), ")"), "\n\t\t " ];
  }, function() {
    return [ "\n\t\t \t", HTML.SPAN({
      class: "rc-popup-list__item-name"
    }, Blaze.View("lookup:modifier", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "username")));
    }), Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("item"), "nickname"));
    }, function() {
      return [ " (", Blaze.View("lookup:item.nickname", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "nickname"));
      }), ")" ];
    })), "\n\t\t " ];
  }), "\n\t");
}));

Template.__checkName("popupList_loading");
Template["popupList_loading"] = new Template("Template.popupList_loading", (function() {
  var view = this;
  return HTML.P(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Loading");
  }), ".");
}));

Template.__checkName("popupList_item_channel");
Template["popupList_item_channel"] = new Template("Template.popupList_item_channel", (function() {
  var view = this;
  return HTML.LI({
    class: "rc-popup-list__item"
  }, "\n\t\t ", HTML.SPAN({
    class: "rc-popup-list__item-image"
  }, "\n\t\t\t ", Blaze._TemplateWith(function() {
    return {
      username: Spacebars.call(Spacebars.dot(view.lookup("item"), "name")),
      roomIcon: Spacebars.call(true)
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("avatar"));
  }), "\n\t\t "), "\n\t\t ", HTML.SPAN({
    class: "rc-popup-list__item-name"
  }, Blaze.View("lookup:modifier", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "name")));
  })), "\n\t");
}));

Template.__checkName("popupList_item_custom");
Template["popupList_item_custom"] = new Template("Template.popupList_item_custom", (function() {
  var view = this;
  return HTML.LI({
    class: "rc-popup-list__item"
  }, "\n\t\t", HTML.SPAN({
    class: "rc-popup-list__item-image"
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      username: Spacebars.call(Spacebars.dot(view.lookup("item"), "custom_name")),
      roomIcon: Spacebars.call(true)
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("avatar"));
  }), "\n\t\t"), "\n\t\t", HTML.SPAN({
    class: "rc-popup-list__item-name"
  }, Blaze.View("lookup:modifier", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("modifier"), Spacebars.dot(view.lookup("item"), "custom_name")));
  })), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"selectDropdown.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/selectDropdown.html                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.selectDropdown.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.selectDropdown.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.selectDropdown.js                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("selectDropdown");
Template["selectDropdown"] = new Template("Template.selectDropdown", (function() {
  var view = this;
  return HTML.DIV({
    class: "rc-input rc-input--small"
  }, "\n\t\t", HTML.LABEL({
    class: "rc-input__label"
  }, "\n\t\t\t", HTML.DIV({
    class: "rc-input__title"
  }, Blaze.View("lookup:title", function() {
    return Spacebars.mustache(view.lookup("title"));
  })), "\n\t\t\t", HTML.DIV({
    class: "rc-input__wrapper"
  }, "\n\t\t\t\t", HTML.SELECT({
    type: "text",
    class: "rc-input__element",
    placeholder: function() {
      return Spacebars.mustache(view.lookup("placeholder"));
    },
    name: function() {
      return Spacebars.mustache(view.lookup("name"));
    }
  }, "\n\t\t\t\t\t", Blaze.Each(function() {
    return {
      _sequence: Spacebars.call(view.lookup("options")),
      _variable: "option"
    };
  }, function() {
    return [ "\n\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("option"), "selected"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.OPTION({
        value: function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("option"), "value"));
        },
        selected: ""
      }, Blaze.View("lookup:option.title", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("option"), "title"));
      })), "\n\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.OPTION({
        value: function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("option"), "value"));
        }
      }, Blaze.View("lookup:option.title", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("option"), "title"));
      })), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t" ];
  }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"table.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/table.html                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.table.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.table.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.table.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("table");
Template["table"] = new Template("Template.table", (function() {
  var view = this;
  return HTML.DIV({
    class: "table-wrapper"
  }, "\n\t\t", HTML.DIV({
    class: "table-content-wrapper"
  }, "\n\t\t\t", HTML.DIV({
    class: "table-content"
  }, "\n\t\t\t\t", HTML.DIV({
    class: "table-scroll"
  }, "\n\t\t\t\t\t", HTML.TABLE({
    class: function() {
      return [ "rc-table ", Blaze.If(function() {
        return Spacebars.call(view.lookup("fixed"));
      }, function() {
        return "rc-table--fixed";
      }) ];
    }
  }, "\n\t\t\t\t\t\t\t", Blaze._InOuterTemplateScope(view, function() {
    return Spacebars.include(function() {
      return Spacebars.call(view.templateContentBlock);
    });
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabs.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/tabs.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.tabs.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.tabs.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.tabs.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("tabs");
Template["tabs"] = new Template("Template.tabs", (function() {
  var view = this;
  return HTML.DIV({
    class: "tabs"
  }, "\n\t\t", HTML.DIV({
    class: "tabs-wrapper",
    role: "tablist"
  }, "\n\t\t\t", Blaze.Each(function() {
    return {
      _sequence: Spacebars.call(view.lookup("tabs")),
      _variable: "tab"
    };
  }, function() {
    return [ "\n\t\t\t\t", HTML.BUTTON(HTML.Attrs({
      class: function() {
        return [ "tab ", Blaze.If(function() {
          return Spacebars.dataMustache(view.lookup("isActive"), Spacebars.dot(view.lookup("tab"), "value"));
        }, function() {
          return "active";
        }) ];
      },
      "data-value": function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("tab"), "value"));
      },
      role: "tab"
    }, function() {
      return Spacebars.attrMustache(view.lookup("ariaSelected"), Spacebars.dot(view.lookup("tab"), "value"));
    }), "\n\t\t\t\t\t", HTML.SPAN({
      tabindex: "-1"
    }, Blaze.View("lookup:tab.label", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("tab"), "label"));
    })), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tooltip.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/tooltip.html                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.tooltip.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.tooltip.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/template.tooltip.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("tooltip");
Template["tooltip"] = new Template("Template.tooltip", (function() {
  var view = this;
  return HTML.Raw('<div class="tooltip">\n\t\t<div class="content">\n\t\t</div>\n\t\t<div class="tooltip-arrow"></div>\n\t</div>');
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"icon.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/icon.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var baseURI;
module.link("../../../../client/lib/baseURI", {
  baseURI: function (v) {
    baseURI = v;
  }
}, 2);
module.link("./icon.html");

var baseUrlFix = function () {
  return "" + baseURI + FlowRouter.current().path.substring(1);
};

var isMozillaFirefoxBelowVersion = function (upperVersion) {
  var _ref = navigator.userAgent.match(/Firefox\/(\d+)\.\d/) || [],
      _ref2 = _slicedToArray(_ref, 2),
      version = _ref2[1];

  return parseInt(version, 10) < upperVersion;
};

var isGoogleChromeBelowVersion = function (upperVersion) {
  var _ref3 = navigator.userAgent.match(/Chrome\/(\d+)\.\d/) || [],
      _ref4 = _slicedToArray(_ref3, 2),
      version = _ref4[1];

  return parseInt(version, 10) < upperVersion;
};

var isBaseUrlFixNeeded = function () {
  return isMozillaFirefoxBelowVersion(55) || isGoogleChromeBelowVersion(55);
};

Template.icon.helpers({
  baseUrl: isBaseUrlFixNeeded() ? baseUrlFix : undefined
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popupList.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/popupList.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);
Template.popupList.helpers({
  config: function () {
    return {
      template: this.data.template_list || 'popupList_default',
      data: {
        ready: this.ready,
        loading: this.ready !== undefined && !this.ready,
        noMatchTemplate: this.data.noMatchTemplate,
        template_item: this.data.template_item || 'popupList_item_default',
        items: this.items,
        onClick: this.data.onClick || function () {},
        modifier: this.data.modifier || function (text) {
          return text;
        }
      }
    };
  },
  open: function () {
    var instance = Template.instance();
    return instance.data.items.length > 0;
  }
});
Template.popupList_default.helpers({
  config: function (item) {
    return {
      template: this.template_item || 'popupList_item_default',
      data: {
        item: item,
        onClick: this.onClick,
        modifier: this.modifier
      }
    };
  }
});
Template.popupList_item_default.helpers({
  showRealNames: function () {
    return settings.get('UI_Use_Real_Name');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"table.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/table.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 1);
Template.table.onRendered(function () {
  var dummyTr = '<tr class="table-tr-dummy"></tr>';
  this.$('tbody').prepend(dummyTr).append(dummyTr);
  this.onResize = this.data.onResize;

  if (this.onResize) {
    this.onResize();
    $(window).on('resize', this.onResize);
  }
});
Template.table.onDestroyed(function () {
  $(window).on('off', this.onResize);
});
Template.table.events({
  'click tbody tr:not(.table-no-click)': function (e, t) {
    t.data.onItemClick && t.data.onItemClick(this);
  },
  'scroll .table-scroll': _.debounce(function (e, t) {
    return t.data.onScroll && t.data.onScroll(e.currentTarget);
  }, 300),
  'click .js-sort': function (e, t) {
    t.data.onSort(e.currentTarget.dataset.sort);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabs.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/tabs.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
module.link("./tabs.html");
Template.tabs.onCreated(function () {
  this.activeTab = new ReactiveVar(this.data.tabs.tabs.find(function (tab) {
    return tab.active;
  }).value);
});
Template.tabs.events({
  'click .tab': function (event, instance) {
    var value = event.currentTarget.dataset.value;

    if (value === instance.activeTab.get()) {
      return;
    }

    instance.activeTab.set(value);
    instance.data.tabs.onChange(value);
  }
});
Template.tabs.helpers({
  tabs: function () {
    return Template.instance().data.tabs.tabs.filter(function (tab) {
      return tab.condition ? tab.condition() : tab;
    });
  },
  isActive: function (value) {
    return Template.instance().activeTab.get() === value;
  },
  ariaSelected: function (value) {
    return Template.instance().activeTab.get() === value ? {
      'aria-selected': 'true'
    } : {};
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tooltip.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/tooltip.css                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tooltip.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/components/tooltip.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  tooltip: function () {
    return tooltip;
  }
});
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 1);
module.link("./tooltip.html");
module.link("./tooltip.css");
var initiated = false;

var init = function () {
  if (initiated) {
    return;
  }

  initiated = true;
  Blaze.render(Template.tooltip, document.body);
};

var source = null;
var opened = false;
var timeout = null;

var placeTip = function () {
  var arrowSize = 6;
  var sourceWidth = $(source).outerWidth();
  var sourceHeight = $(source).outerHeight();

  var _$$offset = $(source).offset(),
      left = _$$offset.left,
      top = _$$offset.top;

  var tip = $('.tooltip');
  var tipWidth = tip.outerWidth();
  var tipHeight = tip.outerHeight();
  left = left + sourceWidth / 2 - tipWidth / 2;
  $('.tooltip-arrow', tip).css({
    'margin-left': left < 0 ? left - arrowSize + "px" : ''
  });

  if (left < 0) {
    left = 0;
  }

  top = top - tipHeight - arrowSize;
  tip.toggleClass('below', top < 0);

  if (top < 0) {
    top = top + sourceHeight + arrowSize;
  }

  return tip.css({
    left: left + "px",
    top: top + "px"
  });
};

var showElement = function (element, sourceElement) {
  if (opened) {
    return;
  }

  if (timeout) {
    clearTimeout(timeout);
  }

  var elementClone = $(element).clone();
  timeout = setTimeout(function () {
    timeout = null;
    source = sourceElement;
    $('.tooltip .content').empty().append(elementClone.show());
    placeTip().addClass('show');
    opened = true;
  }, 300);
};

var hide = function () {
  if (timeout) {
    clearTimeout(timeout);
  }

  if (opened) {
    $('.tooltip').removeClass('show');
    $('.tooltip .content').empty();
    opened = false;
  }
};

var tooltip = {
  init: init,
  showElement: showElement,
  hide: hide
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"views":{"app":{"burger.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/burger.html                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.burger.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.burger.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.burger.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("burger");
Template["burger"] = new Template("Template.burger", (function() {
  var view = this;
  return HTML.DIV({
    class: function() {
      return [ "rc-old burger ", Spacebars.mustache(view.lookup("isMenuOpen")) ];
    }
  }, HTML.Raw("\n\t\t<i></i>\n\t\t<i></i>\n\t\t<i></i>\n\t\t"), Blaze.Unless(function() {
    return Spacebars.call(view.lookup("embeddedVersion"));
  }, function() {
    return [ "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("unread"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: "unread-burger-alert color-error-contrast background-error-color"
      }, "\n\t\t\t\t\t", Blaze.View("lookup:unread", function() {
        return Spacebars.mustache(view.lookup("unread"));
      }), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"home.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/home.html                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.home.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.home.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.home.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("home");
Template["home"] = new Template("Template.home", (function() {
  var view = this;
  return HTML.SECTION({
    class: "page-container page-home page-static content-background-color"
  }, "\n\t\t", Blaze._TemplateWith(function() {
    return {
      sectionName: Spacebars.call(view.lookup("title"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("header"));
  }), "\n\t\t", HTML.DIV({
    class: "content"
  }, "\n\t\t\t", Blaze.View("lookup:body", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("body")));
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"notAuthorized.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/notAuthorized.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.notAuthorized.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.notAuthorized.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.notAuthorized.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("notAuthorized");
Template["notAuthorized"] = new Template("Template.notAuthorized", (function() {
  var view = this;
  return HTML.H2(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Access_not_authorized");
  }));
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"pageContainer.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/pageContainer.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.pageContainer.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.pageContainer.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.pageContainer.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("pageContainer");
Template["pageContainer"] = new Template("Template.pageContainer", (function() {
  var view = this;
  return HTML.SECTION({
    class: "page-container page-home page-static page-list content-background-color"
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("i18nPageTitle"));
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        sectionName: Spacebars.call(view.lookup("i18nPageTitle"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("header"));
    }), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        sectionName: Spacebars.call(view.lookup("pageTitle"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("header"));
    }), "\n\t\t" ];
  }), "\n\t\t", HTML.DIV({
    class: "content"
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      template: Spacebars.call(view.lookup("pageTemplate"))
    };
  }, function() {
    return Spacebars.include(function() {
      return Spacebars.call(Template.__dynamic);
    });
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"pageCustomContainer.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/pageCustomContainer.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.pageCustomContainer.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.pageCustomContainer.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.pageCustomContainer.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("pageCustomContainer");
Template["pageCustomContainer"] = new Template("Template.pageCustomContainer", (function() {
  var view = this;
  return Blaze._TemplateWith(function() {
    return {
      template: Spacebars.call(view.lookup("pageTemplate"))
    };
  }, function() {
    return Spacebars.include(function() {
      return Spacebars.call(Template.__dynamic);
    });
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"photoswipeContent.html":[
  "./template.photoswipeContent.js"
],"template.photoswipeContent.js":[],"room.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/room.html                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.room.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.room.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.room.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("roomOld");
Template["roomOld"] = new Template("Template.roomOld", (function() {
  var view = this;
  return HTML.DIV({
    class: "main-content-flex"
  }, "\n\t\t", HTML.SECTION({
    class: function() {
      return [ "messages-container flex-tab-main-content ", Spacebars.mustache(view.lookup("adminClass")) ];
    },
    id: function() {
      return Spacebars.mustache(view.lookup("windowId"));
    },
    "aria-label": function() {
      return Spacebars.mustache(view.lookup("_"), "Channel");
    }
  }, "\n\t\t\t", HTML.DIV({
    class: "messages-container-wrapper"
  }, "\n\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "messages-container-main dropzone ", Spacebars.mustache(view.lookup("dragAndDrop")) ];
    }
  }, "\n\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "dropzone-overlay ", Spacebars.mustache(view.lookup("isDropzoneDisabled")), " background-transparent-darkest color-content-background-color" ];
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), view.lookup("dragAndDropLabel"));
  })), "\n\t\t\t\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("embeddedVersion"));
  }, function() {
    return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        announcement: Spacebars.call(view.lookup("announcement")),
        announcementDetails: Spacebars.call(view.lookup("announcementDetails"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("RoomAnnouncement"));
    }), "\n\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "container-bars ", Spacebars.mustache(view.lookup("containerBarsShow"), view.lookup("unreadData"), view.lookup("uploading")) ];
    }
  }, "\n\t\t\t\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("unreadData"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("since"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("count"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
          class: "unread-bar color-primary-action-color background-component-color"
        }, "\n\t\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
          class: "jump-to"
        }, "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
          class: "jump-to-large"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Jump_to_first_unread");
        })), "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
          class: "jump-to-small"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Jump");
        })), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
          class: "unread-count-since"
        }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "S_new_messages_since_s", view.lookup("count"), view.lookup("formatUnreadSince"));
        }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
          class: "unread-count"
        }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "N_new_messages", view.lookup("count"));
        }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
          class: "mark-read"
        }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Mark_as_read");
        }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t", Blaze.Each(function() {
    return Spacebars.call(view.lookup("uploading"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: function() {
        return [ "upload-progress color-primary-action-color background-component-color ", Blaze.If(function() {
          return Spacebars.call(view.lookup("error"));
        }, function() {
          return "error-background error-border";
        }) ];
      }
    }, "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("error"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
        class: "upload-progress-text"
      }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:error", function() {
        return Spacebars.mustache(view.lookup("error"));
      }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "upload-progress-close"
      }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "close");
      }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
        class: "upload-progress-progress",
        style: function() {
          return [ "width: ", Spacebars.mustache(view.lookup("percentage")), "%;" ];
        }
      }), "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
        class: "upload-progress-text"
      }, "\n\t\t\t\t\t\t\t\t\t\t[", Blaze.View("lookup:percentage", function() {
        return Spacebars.mustache(view.lookup("percentage"));
      }), "%] ", Blaze.View("lookup:name", function() {
        return Spacebars.mustache(view.lookup("name"));
      }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "upload-progress-close"
      }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Cancel");
      }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "messages-box ", Blaze.If(function() {
        return Spacebars.call(view.lookup("selectable"));
      }, function() {
        return "selectable";
      }), " ", Spacebars.mustache(view.lookup("messageViewMode")), " ", Spacebars.mustache(view.lookup("hasLeader")) ];
    }
  }, HTML.Raw('\n\t\t\t\t\t\t<div class="ticks-bar"></div>\n\t\t\t\t\t\t'), HTML.BUTTON({
    class: "new-message background-primary-action-color color-content-background-color not"
  }, HTML.Raw('\n\t\t\t\t\t\t\t<i class="icon-down-big"></i>\n\t\t\t\t\t\t\t'), Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "New_messages");
  }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "jump-recent background-component-color ", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("hasMoreNext"));
      }, function() {
        return "not";
      }) ];
    }
  }, "\n\t\t\t\t\t\t\t", HTML.BUTTON(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Jump_to_recent_messages");
  }), HTML.Raw(' <i class="icon-level-down"></i>')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("canPreview"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "content room-not-found error-color"
    }, "\n\t\t\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "You_must_join_to_view_messages_in_this_channel");
    }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("roomLeader"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: function() {
        return [ "room-leader message color-primary-font-color content-background-color border-component-color ", Spacebars.mustache(view.lookup("hideLeaderHeader")) ];
      }
    }, "\n\t\t\t\t\t\t\t\t", HTML.BUTTON({
      class: "thumb user-card-message"
    }, "\n\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        username: Spacebars.call(view.lookup("username"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("avatar"));
    }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
      class: "leader-name"
    }, Blaze.View("lookup:name", function() {
      return Spacebars.mustache(view.lookup("name"));
    })), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
      class: "leader-status userStatus"
    }, "\n\t\t\t\t\t\t\t\t\t", HTML.SPAN({
      class: function() {
        return [ "color-ball status-bg-", Spacebars.mustache(view.lookup("status")) ];
      }
    }), "\n\t\t\t\t\t\t\t\t\t", HTML.SPAN({
      class: "status-text leader-status-text"
    }, Blaze.View("lookup:statusDisplay", function() {
      return Spacebars.mustache(view.lookup("statusDisplay"));
    })), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t", HTML.A({
      class: "chat-now",
      href: function() {
        return Spacebars.mustache(view.lookup("chatNowLink"));
      }
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Chat_Now");
    })), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "wrapper ", Blaze.If(function() {
        return Spacebars.call(view.lookup("hasMoreNext"));
      }, function() {
        return "has-more-next";
      }), " ", Spacebars.mustache(view.lookup("hideUsername")), " ", Spacebars.mustache(view.lookup("hideAvatar")) ];
    }
  }, "\n\t\t\t\t\t\t\t", HTML.UL({
    "aria-live": "polite"
  }, "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("canPreview"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("hasMore"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.LI({
        class: "load-more"
      }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isLoading"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t\t\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.LI({
        class: "start color-info-font-color"
      }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("hasPurge"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
          class: "start__purge-warning error-background error-border error-color"
        }, "\n\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call("start__purge-warning-icon"),
            icon: Spacebars.call("warning")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.Unless(function() {
          return Spacebars.call(view.lookup("filesOnly"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.Unless(function() {
            return Spacebars.call(view.lookup("excludePinned"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "RetentionPolicy_RoomWarning", Spacebars.kw({
                time: view.lookup("purgeTimeout")
              }));
            }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "RetentionPolicy_RoomWarning_Unpinned", Spacebars.kw({
                time: view.lookup("purgeTimeout")
              }));
            }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.Unless(function() {
            return Spacebars.call(view.lookup("excludePinned"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "RetentionPolicy_RoomWarning_FilesOnly", Spacebars.kw({
                time: view.lookup("purgeTimeout")
              }));
            }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "RetentionPolicy_RoomWarning_UnpinnedFilesOnly", Spacebars.kw({
                time: view.lookup("purgeTimeout")
              }));
            }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t\t" ];
      }), "\n\n\t\t\t\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("RoomForeword")), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t\t\t" ];
  }), "\n\n\t\t\t\t\t\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("messagesHistory")),
        _variable: "msg"
      };
    }, function() {
      return Blaze._TemplateWith(function() {
        return {
          showRoles: Spacebars.call(true),
          index: Spacebars.call(view.lookup("@index")),
          shouldCollapseReplies: Spacebars.call(false),
          msg: Spacebars.call(view.lookup("msg")),
          room: Spacebars.call(view.lookup("room")),
          actions: Spacebars.call(view.lookup("actions")),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          u: Spacebars.call(view.lookup("u"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      });
    }), "\n\t\t\t\t\t\t\t\t" ];
  }), "\n\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasMoreNext"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t\t\t", HTML.LI({
      class: "load-more"
    }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isLoading"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.FOOTER({
    class: "footer border-component-color"
  }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("messageboxData"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messageBox"));
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomSearch.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/roomSearch.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.roomSearch.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.roomSearch.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.roomSearch.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("roomSearch");
Template["roomSearch"] = new Template("Template.roomSearch", (function() {
  var view = this;
  return [ HTML.I({
    class: function() {
      return [ Spacebars.mustache(view.lookup("roomIcon")), " ", Spacebars.mustache(view.lookup("userStatus")) ];
    }
  }), " ", Blaze.View("lookup:name", function() {
    return Spacebars.mustache(view.lookup("name"));
  }) ];
}));

Template.__checkName("roomSearchEmpty");
Template["roomSearchEmpty"] = new Template("Template.roomSearchEmpty", (function() {
  var view = this;
  return HTML.P({
    class: function() {
      return Spacebars.mustache(view.lookup("class"));
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Nothing_found");
  }), ".");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userSearch.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/userSearch.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.userSearch.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.userSearch.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/template.userSearch.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("userSearch");
Template["userSearch"] = new Template("Template.userSearch", (function() {
  var view = this;
  return [ HTML.I({
    class: function() {
      return [ "icon-at status-", Spacebars.mustache(view.lookup("status")) ];
    }
  }), " ", Blaze.View("lookup:username", function() {
    return Spacebars.mustache(view.lookup("username"));
  }), Blaze.If(function() {
    return Spacebars.call(view.lookup("name"));
  }, function() {
    return [ " - ", HTML.STRONG(Blaze.View("lookup:name", function() {
      return Spacebars.mustache(view.lookup("name"));
    })) ];
  }) ];
}));

Template.__checkName("userSearchEmpty");
Template["userSearchEmpty"] = new Template("Template.userSearchEmpty", (function() {
  var view = this;
  return HTML.P(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Nothing_found");
  }), ".");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"lib":{"getCommonRoomEvents.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/lib/getCommonRoomEvents.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 2);
module.export({
  getCommonRoomEvents: function () {
    return getCommonRoomEvents;
  }
});
var Clipboard;
module.link("clipboard", {
  "default": function (v) {
    Clipboard = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 2);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 3);
var popover, MessageAction;
module.link("../../../../../ui-utils/client", {
  popover: function (v) {
    popover = v;
  },
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 4);
var addMessageToList;
module.link("../../../../../ui-utils/client/lib/MessageAction", {
  addMessageToList: function (v) {
    addMessageToList = v;
  }
}, 5);
var callWithErrorHandling;
module.link("../../../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 6);
var isURL;
module.link("../../../../../utils/lib/isURL", {
  isURL: function (v) {
    isURL = v;
  }
}, 7);
var openUserCard;
module.link("../../../lib/UserCard", {
  openUserCard: function (v) {
    openUserCard = v;
  }
}, 8);
var messageArgs;
module.link("../../../../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 9);
var ChatMessage, Rooms, Messages;
module.link("../../../../../models", {
  ChatMessage: function (v) {
    ChatMessage = v;
  },
  Rooms: function (v) {
    Rooms = v;
  },
  Messages: function (v) {
    Messages = v;
  }
}, 10);
var t;
module.link("../../../../../utils/client", {
  t: function (v) {
    t = v;
  }
}, 11);
var chatMessages;
module.link("../room", {
  chatMessages: function (v) {
    chatMessages = v;
  }
}, 12);
var EmojiEvents;
module.link("../../../../../reactions/client/init", {
  EmojiEvents: function (v) {
    EmojiEvents = v;
  }
}, 13);
var goToRoomById;
module.link("../../../../../../client/lib/utils/goToRoomById", {
  goToRoomById: function (v) {
    goToRoomById = v;
  }
}, 14);
var fireGlobalEvent;
module.link("../../../../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 15);
var isLayoutEmbedded;
module.link("../../../../../../client/lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded: function (v) {
    isLayoutEmbedded = v;
  }
}, 16);
var onClientBeforeSendMessage;
module.link("../../../../../../client/lib/onClientBeforeSendMessage", {
  onClientBeforeSendMessage: function (v) {
    onClientBeforeSendMessage = v;
  }
}, 17);

var mountPopover = function (e, i, outerContext) {
  var context = $(e.target).parents('.message').data('context');

  if (!context) {
    context = 'message';
  }

  var messageContext = messageArgs(outerContext);
  var menuItems = MessageAction.getButtons(messageContext, context, 'menu').map(function (item) {
    return {
      icon: item.icon,
      name: t(item.label),
      type: 'message-action',
      id: item.id,
      modifier: item.color
    };
  });

  if (window.matchMedia('(max-width: 500px)').matches) {
    var messageItems = MessageAction.getButtons(messageContext, context, 'message').map(function (item) {
      return {
        icon: item.icon,
        name: t(item.label),
        type: 'message-action',
        id: item.id,
        modifier: item.color
      };
    });
    menuItems = menuItems.concat(messageItems);
  }

  var _menuItems$reduce = menuItems.reduce(function (result, value) {
    result[value.id === 'delete-message' ? 1 : 0].push(value);
    return result;
  }, [[], []]),
      _menuItems$reduce2 = _slicedToArray(_menuItems$reduce, 2),
      items = _menuItems$reduce2[0],
      deleteItem = _menuItems$reduce2[1];

  var groups = [{
    items: items
  }];

  if (deleteItem.length) {
    groups.push({
      items: deleteItem
    });
  }

  var config = {
    columns: [{
      groups: groups
    }],
    instance: i,
    currentTarget: e.currentTarget,
    data: outerContext,
    activeElement: $(e.currentTarget).parents('.message')[0],
    onRendered: function () {
      return new Clipboard('.rc-popover__item');
    }
  };
  popover.open(config);
};

var getCommonRoomEvents = function () {
  return _objectSpread(_objectSpread({}, function () {
    var touchMoved = false;
    var lastTouchX = null;
    var lastTouchY = null;
    var touchtime = null;
    return _objectSpread(_objectSpread({}, EmojiEvents), {}, {
      'click .message img': function (e) {
        clearTimeout(touchtime);

        if (touchMoved === true) {
          e.preventDefault();
          e.stopPropagation();
        }
      },
      'touchstart .message': function (e) {
        var _this = this;

        var touches = e.originalEvent.touches;

        if (touches && touches.length) {
          lastTouchX = touches[0].pageX;
          lastTouchY = touches[0].pagey;
        }

        touchMoved = false;

        if (e.originalEvent.touches.length !== 1) {
          return;
        }

        if ($(e.currentTarget).hasClass('system')) {
          return;
        }

        if (e.target && e.target.nodeName === 'AUDIO') {
          return;
        }

        if (e.target && e.target.nodeName === 'A' && isURL(e.target.getAttribute('href'))) {
          e.preventDefault();
          e.stopPropagation();
        }

        var doLongTouch = function () {
          mountPopover(e, t, _this);
        };

        clearTimeout(touchtime);
        touchtime = setTimeout(doLongTouch, 500);
      },
      'touchend .message': function (e) {
        clearTimeout(touchtime);

        if (e.target && e.target.nodeName === 'A' && isURL(e.target.getAttribute('href'))) {
          if (touchMoved === true) {
            e.preventDefault();
            e.stopPropagation();
            return;
          }

          window.open(e.target.href);
        }
      },
      'touchmove .message': function (e) {
        var touches = e.originalEvent.touches;

        if (touches && touches.length) {
          var deltaX = Math.abs(lastTouchX - touches[0].pageX);
          var deltaY = Math.abs(lastTouchY - touches[0].pageY);

          if (deltaX > 5 || deltaY > 5) {
            touchMoved = true;
          }
        }

        clearTimeout(touchtime);
      },
      'touchcancel .message': function () {
        clearTimeout(touchtime);
      }
    });
  }()), {}, {
    'click [data-message-action]': function (event, template) {
      var button = MessageAction.getButtonById(event.currentTarget.dataset.messageAction);

      if ((button != null ? button.action : undefined) != null) {
        button.action.call(this, event, {
          tabBar: template.tabBar,
          rid: template.data.rid
        });
      }
    },
    'click .js-follow-thread': function (e) {
      e.preventDefault();
      e.stopPropagation();

      var _messageArgs = messageArgs(this),
          msg = _messageArgs.msg;

      callWithErrorHandling('followMessage', {
        mid: msg._id
      });
    },
    'click .js-unfollow-thread': function (e) {
      e.preventDefault();
      e.stopPropagation();

      var _messageArgs2 = messageArgs(this),
          msg = _messageArgs2.msg;

      callWithErrorHandling('unfollowMessage', {
        mid: msg._id
      });
    },
    'click .js-open-thread': function (event) {
      event.preventDefault();
      event.stopPropagation();

      var _messageArgs3 = messageArgs(this),
          _messageArgs3$msg = _messageArgs3.msg,
          rid = _messageArgs3$msg.rid,
          _id = _messageArgs3$msg._id,
          tmid = _messageArgs3$msg.tmid;

      var room = Rooms.findOne({
        _id: rid
      });
      FlowRouter.go(FlowRouter.getRouteName(), {
        rid: rid,
        name: room.name,
        tab: 'thread',
        context: tmid || _id
      }, {
        jump: tmid && tmid !== _id && _id && _id
      });
    },
    'click .image-to-download': function (event) {
      var _messageArgs4 = messageArgs(this),
          msg = _messageArgs4.msg;

      ChatMessage.update({
        '_id': msg._id,
        'urls.url': $(event.currentTarget).data('url')
      }, {
        $set: {
          'urls.$.downloadImages': true
        }
      });
      ChatMessage.update({
        '_id': msg._id,
        'attachments.image_url': $(event.currentTarget).data('url')
      }, {
        $set: {
          'attachments.$.downloadImages': true
        }
      });
    },
    'click .user-card-message': function (e, instance) {
      var _messageArgs5 = messageArgs(this),
          msg = _messageArgs5.msg;

      if (!Meteor.userId()) {
        return;
      }

      var username = msg.u.username;

      if (username) {
        openUserCard({
          username: username,
          rid: instance.data.rid,
          target: e.currentTarget,
          open: function (e) {
            e.preventDefault();
            instance.data.tabBar.openUserInfo(username);
          }
        });
      }
    },
    'click .js-actionButton-respondWithMessage': function (event, instance) {
      var rid = instance.data.rid;
      var msg = event.currentTarget.value;

      if (!msg) {
        return;
      }

      var input = chatMessages[rid].input;
      input.value = msg;
      input.focus();
    },
    'click .js-actionButton-respondWithQuotedMessage': function () {
      function _callee(event, instance) {
        var rid, msgId, $input, message, messages;
        return _regeneratorRuntime.async(function () {
          function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  rid = instance.data.rid;
                  msgId = event.currentTarget.id;
                  $input = chatMessages[rid].$input;

                  if (msgId) {
                    _context.next = 5;
                    break;
                  }

                  return _context.abrupt("return");

                case 5:
                  message = Messages.findOne({
                    _id: msgId
                  });
                  messages = $input.data('reply') || [];
                  messages = addMessageToList(messages, message);
                  $input.focus().data('mention-user', false).data('reply', messages).trigger('dataChange');

                case 9:
                case "end":
                  return _context.stop();
              }
            }
          }

          return _callee$;
        }(), null, null, null, Promise);
      }

      return _callee;
    }(),
    'click .js-actionButton-sendMessage': function () {
      function _callee2(event, instance) {
        var rid, msg, msgObject, _chatMessages;

        return _regeneratorRuntime.async(function () {
          function _callee2$(_context2) {
            while (1) {
              switch (_context2.prev = _context2.next) {
                case 0:
                  rid = instance.data.rid;
                  msg = event.currentTarget.value;
                  msgObject = {
                    _id: Random.id(),
                    rid: rid,
                    msg: msg
                  };

                  if (msg) {
                    _context2.next = 5;
                    break;
                  }

                  return _context2.abrupt("return");

                case 5:
                  _context2.next = 7;
                  return _regeneratorRuntime.awrap(onClientBeforeSendMessage(msgObject));

                case 7:
                  msgObject = _context2.sent;
                  _chatMessages = chatMessages[rid];
                  _context2.t0 = _chatMessages;

                  if (!_context2.t0) {
                    _context2.next = 14;
                    break;
                  }

                  _context2.next = 13;
                  return _regeneratorRuntime.awrap(_chatMessages.processSlashCommand(msgObject));

                case 13:
                  _context2.t0 = _context2.sent;

                case 14:
                  if (!_context2.t0) {
                    _context2.next = 16;
                    break;
                  }

                  return _context2.abrupt("return");

                case 16:
                  _context2.next = 18;
                  return _regeneratorRuntime.awrap(callWithErrorHandling('sendMessage', msgObject));

                case 18:
                case "end":
                  return _context2.stop();
              }
            }
          }

          return _callee2$;
        }(), null, null, null, Promise);
      }

      return _callee2;
    }(),
    'click .message-actions__menu': function (e, template) {
      var messageContext = messageArgs(this);
      var message = messageContext.msg,
          ctx = messageContext.context;
      var context = ctx || message.context || message.actionContext || 'message';
      var allItems = MessageAction.getButtons(messageContext, context, 'menu').map(function (item) {
        return {
          icon: item.icon,
          name: t(item.label),
          type: 'message-action',
          id: item.id,
          modifier: item.color
        };
      });
      var itemsBelowDivider = ['delete-message', 'report-message'];

      var _allItems$reduce = allItems.reduce(function (result, value) {
        result[itemsBelowDivider.includes(value.id) ? 1 : 0].push(value);
        return result;
      }, [[], []]),
          _allItems$reduce2 = _slicedToArray(_allItems$reduce, 2),
          items = _allItems$reduce2[0],
          alertsItem = _allItems$reduce2[1];

      var groups = [{
        items: items
      }];

      if (alertsItem.length) {
        groups.push({
          items: alertsItem
        });
      }

      var config = {
        columns: [{
          groups: groups
        }],
        instance: template,
        rid: template.data.rid,
        data: this,
        currentTarget: e.currentTarget,
        activeElement: $(e.currentTarget).parents('.message')[0],
        onRendered: function () {
          return new Clipboard('.rc-popover__item');
        }
      };
      popover.open(config);
    },
    'click .mention-link': function (e, instance) {
      e.stopPropagation();
      e.preventDefault();

      if (!Meteor.userId()) {
        return;
      }

      var _e$currentTarget$data = e.currentTarget.dataset,
          channel = _e$currentTarget$data.channel,
          group = _e$currentTarget$data.group,
          username = _e$currentTarget$data.username;

      if (channel) {
        if (isLayoutEmbedded()) {
          fireGlobalEvent('click-mention-link', {
            path: FlowRouter.path('channel', {
              name: channel
            }),
            channel: channel
          });
        }

        goToRoomById(channel);
        return;
      }

      if (group) {
        return;
      }

      if (username) {
        openUserCard({
          username: username,
          rid: instance.data.rid,
          target: e.currentTarget,
          open: function (e) {
            e.preventDefault();
            instance.data.tabBar.openUserInfo(username);
          }
        });
      }
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"burger.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/burger.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var ChatSubscription;
module.link("../../../../models/client", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 3);
var menu;
module.link("../../../../ui-utils/client", {
  menu: function (v) {
    menu = v;
  }
}, 4);
var isLayoutEmbedded;
module.link("../../../../../client/lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded: function (v) {
    isLayoutEmbedded = v;
  }
}, 5);
var getUserPreference;
module.link("../../../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 6);
Template.burger.helpers({
  unread: function () {
    var userUnreadAlert = getUserPreference(Meteor.userId(), 'unreadAlert');

    var _ChatSubscription$fin = ChatSubscription.find({
      open: true,
      hideUnreadStatus: {
        $ne: true
      },
      rid: {
        $ne: Session.get('openedRoom')
      },
      archived: {
        $ne: true
      }
    }, {
      fields: {
        unread: 1,
        alert: 1,
        unreadAlert: 1
      }
    }).fetch().reduce(function (_ref, _ref2) {
      var _ref3 = _slicedToArray(_ref, 2),
          unreadCount = _ref3[0],
          unreadAlert = _ref3[1];

      var alert = _ref2.alert,
          unread = _ref2.unread,
          alertType = _ref2.unreadAlert;

      if (alert || unread > 0) {
        unreadCount += unread;

        if (alert === true && alertType !== 'nothing') {
          if (alertType === 'all' || userUnreadAlert !== false) {
            unreadAlert = '•';
          }
        }
      }

      return [unreadCount, unreadAlert];
    }, [0, false]),
        _ChatSubscription$fin2 = _slicedToArray(_ChatSubscription$fin, 2),
        unreadCount = _ChatSubscription$fin2[0],
        unreadAlert = _ChatSubscription$fin2[1];

    if (unreadCount > 0) {
      return unreadCount > 99 ? '99+' : unreadCount;
    }

    return unreadAlert || '';
  },
  isMenuOpen: function () {
    if (Session.equals('isMenuOpen', true)) {
      return 'menu-opened';
    }
  },
  embeddedVersion: function () {
    return isLayoutEmbedded();
  }
});
Template.burger.events({
  'click div.burger': function () {
    return menu.toggle();
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"helpers.js":[
  "moment"
],"home.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/home.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var settings;
module.link("../../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);
Template.home.helpers({
  title: function () {
    return settings.get('Layout_Home_Title');
  },
  body: function () {
    return settings.get('Layout_Home_Body');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"photoswipeContent.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/photoswipeContent.ts                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 3);

var parseLength = function (x) {
  var length = typeof x === 'string' ? parseInt(x, 10) : undefined;
  return Number.isFinite(length) ? length : undefined;
};

var getImageSize = function (src) {
  return new Promise(function (resolve, reject) {
    var img = new Image();
    img.addEventListener('load', function () {
      resolve([img.naturalWidth, img.naturalHeight]);
    });
    img.addEventListener('error', function (error) {
      reject(error.error);
    });
    img.src = src;
  });
};

var fromElementToSlide = function () {
  function _callee(element) {
    var title, description, src, w, h, _await$getImageSize, _await$getImageSize2, msrc, _src, _w, _h, _await$getImageSize3, _await$getImageSize4;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              if (element instanceof HTMLElement) {
                _context.next = 2;
                break;
              }

              return _context.abrupt("return", null);

            case 2:
              title = element.dataset.title || element.title;
              description = element.dataset.description;

              if (!(element instanceof HTMLAnchorElement)) {
                _context.next = 16;
                break;
              }

              src = element.dataset.src || element.href;
              w = parseLength(element.dataset.width);
              h = parseLength(element.dataset.height);

              if (!(w === undefined || h === undefined)) {
                _context.next = 15;
                break;
              }

              _context.next = 11;
              return _regeneratorRuntime.awrap(getImageSize(src));

            case 11:
              _await$getImageSize = _context.sent;
              _await$getImageSize2 = _slicedToArray(_await$getImageSize, 2);
              w = _await$getImageSize2[0];
              h = _await$getImageSize2[1];

            case 15:
              return _context.abrupt("return", {
                src: src,
                w: w,
                h: h,
                title: title,
                description: description
              });

            case 16:
              if (!(element instanceof HTMLImageElement)) {
                _context.next = 33;
                break;
              }

              _src = element.src;
              _w = element.naturalWidth;
              _h = element.naturalHeight;

              if (!element.dataset.src) {
                _context.next = 32;
                break;
              }

              msrc = element.src;
              _src = element.dataset.src;
              _w = parseLength(element.dataset.width);
              _h = parseLength(element.dataset.height);

              if (!(_w === undefined || _h === undefined)) {
                _context.next = 32;
                break;
              }

              _context.next = 28;
              return _regeneratorRuntime.awrap(getImageSize(_src));

            case 28:
              _await$getImageSize3 = _context.sent;
              _await$getImageSize4 = _slicedToArray(_await$getImageSize3, 2);
              _w = _await$getImageSize4[0];
              _h = _await$getImageSize4[1];

            case 32:
              return _context.abrupt("return", {
                msrc: msrc,
                src: _src,
                w: _w,
                h: _h,
                title: title,
                description: description
              });

            case 33:
              return _context.abrupt("return", null);

            case 34:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}();

var currentGallery = null;

var initGallery = function () {
  function _callee2(items, options) {
    var _await$Promise$all, _await$Promise$all2, PhotoSwipe, PhotoSwipeUiDefault, container;

    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              _context2.next = 2;
              return _regeneratorRuntime.awrap(Promise.all([module.dynamicImport('photoswipe'), module.dynamicImport('photoswipe/dist/photoswipe-ui-default'), // @ts-ignore
              module.dynamicImport('photoswipe/dist/photoswipe.css'), // @ts-ignore
              module.dynamicImport('./photoswipeContent.html')]));

            case 2:
              _await$Promise$all = _context2.sent;
              _await$Promise$all2 = _slicedToArray(_await$Promise$all, 2);
              PhotoSwipe = _await$Promise$all2[0].default;
              PhotoSwipeUiDefault = _await$Promise$all2[1].default;
              Blaze.render(Template.photoswipeContent, document.body);

              if (currentGallery) {
                _context2.next = 14;
                break;
              }

              container = document.getElementById('pswp');

              if (container) {
                _context2.next = 11;
                break;
              }

              throw new Error('Photoswipe container element not found');

            case 11:
              currentGallery = new PhotoSwipe(container, PhotoSwipeUiDefault, items, options);
              currentGallery.listen('destroy', function () {
                currentGallery = null;
              });
              currentGallery.init();

            case 14:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();

var defaultGalleryOptions = {
  bgOpacity: 0.7,
  showHideOpacity: true,
  counterEl: false,
  shareEl: false,
  clickToCloseNonZoomable: false,
  index: 0,
  addCaptionHTMLFn: function (item, captionEl) {
    var _item$title, _item$description;

    captionEl.children[0].innerHTML = "\n\t\t\t" + escapeHTML((_item$title = item.title) !== null && _item$title !== void 0 ? _item$title : '') + "<br/>\n\t\t\t<small>" + escapeHTML((_item$description = item.description) !== null && _item$description !== void 0 ? _item$description : '') + "</small>\n\t\t";
    return true;
  }
};

var createEventListenerFor = function (className) {
  return function (event) {
    event.preventDefault();
    event.stopPropagation();
    var currentTarget = event.currentTarget;
    Array.from(document.querySelectorAll(className)).sort(function (a, b) {
      if (a === currentTarget) {
        return -1;
      }

      if (b === currentTarget) {
        return 1;
      }

      return 0;
    }).map(function (element) {
      return fromElementToSlide(element);
    }).reduce(function (p, curr) {
      return p.then(function () {
        return curr;
      }).then(function () {
        function _callee3(slide) {
          return _regeneratorRuntime.async(function () {
            function _callee3$(_context3) {
              while (1) {
                switch (_context3.prev = _context3.next) {
                  case 0:
                    if (slide) {
                      _context3.next = 2;
                      break;
                    }

                    return _context3.abrupt("return");

                  case 2:
                    if (currentGallery) {
                      _context3.next = 4;
                      break;
                    }

                    return _context3.abrupt("return", initGallery([slide], defaultGalleryOptions));

                  case 4:
                    currentGallery.items.push(slide);
                    currentGallery.invalidateCurrItems();
                    currentGallery.updateSize(true);

                  case 7:
                  case "end":
                    return _context3.stop();
                }
              }
            }

            return _callee3$;
          }(), null, null, null, Promise);
        }

        return _callee3;
      }());
    }, Promise.resolve());
  };
};

Meteor.startup(function () {
  $(document).on('click', '.gallery-item', createEventListenerFor('.gallery-item'));
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"room.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/room.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 2);
module.export({
  chatMessages: function () {
    return chatMessages;
  },
  dropzoneHelpers: function () {
    return dropzoneHelpers;
  },
  dropzoneEvents: function () {
    return dropzoneEvents;
  }
});

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var ReactiveDict;
module.link("meteor/reactive-dict", {
  ReactiveDict: function (v) {
    ReactiveDict = v;
  }
}, 4);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 5);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 6);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 7);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 8);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 9);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 10);
var t, roomTypes, getUserPreference;
module.link("../../../../utils/client", {
  t: function (v) {
    t = v;
  },
  roomTypes: function (v) {
    roomTypes = v;
  },
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 11);
var WebRTC;
module.link("../../../../webrtc/client", {
  WebRTC: function (v) {
    WebRTC = v;
  }
}, 12);
var ChatMessage, RoomRoles, Users, Subscriptions, Rooms;
module.link("../../../../models", {
  ChatMessage: function (v) {
    ChatMessage = v;
  },
  RoomRoles: function (v) {
    RoomRoles = v;
  },
  Users: function (v) {
    Users = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  },
  Rooms: function (v) {
    Rooms = v;
  }
}, 13);
var RoomHistoryManager, RoomManager, readMessage;
module.link("../../../../ui-utils/client", {
  RoomHistoryManager: function (v) {
    RoomHistoryManager = v;
  },
  RoomManager: function (v) {
    RoomManager = v;
  },
  readMessage: function (v) {
    readMessage = v;
  }
}, 14);
var messageContext;
module.link("../../../../ui-utils/client/lib/messageContext", {
  messageContext: function (v) {
    messageContext = v;
  }
}, 15);
var messageArgs;
module.link("../../../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 16);
var settings;
module.link("../../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 17);
var callbacks;
module.link("../../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 18);
var hasAllPermission, hasRole;
module.link("../../../../authorization/client", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  },
  hasRole: function (v) {
    hasRole = v;
  }
}, 19);
var ChatMessages;
module.link("../../lib/chatMessages", {
  ChatMessages: function (v) {
    ChatMessages = v;
  }
}, 20);
var fileUpload;
module.link("../../lib/fileUpload", {
  fileUpload: function (v) {
    fileUpload = v;
  }
}, 21);
module.link("./room.html");
var getCommonRoomEvents;
module.link("./lib/getCommonRoomEvents", {
  getCommonRoomEvents: function (v) {
    getCommonRoomEvents = v;
  }
}, 22);
var NewRoomManager;
module.link("../../../../../client/lib/RoomManager", {
  RoomManager: function (v) {
    NewRoomManager = v;
  }
}, 23);
var isLayoutEmbedded;
module.link("../../../../../client/lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded: function (v) {
    isLayoutEmbedded = v;
  }
}, 24);
var handleError;
module.link("../../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 25);
var chatMessages = {};

var userCanDrop = function (_id) {
  return !roomTypes.readOnly(_id, Users.findOne({
    _id: Meteor.userId()
  }, {
    fields: {
      username: 1
    }
  }));
};

var wipeFailedUploads = function () {
  var uploads = Session.get('uploading');

  if (uploads) {
    Session.set('uploading', uploads.filter(function (upload) {
      return !upload.error;
    }));
  }
};

function roomHasGlobalPurge(room) {
  if (!settings.get('RetentionPolicy_Enabled')) {
    return false;
  }

  switch (room.t) {
    case 'c':
      return settings.get('RetentionPolicy_AppliesToChannels');

    case 'p':
      return settings.get('RetentionPolicy_AppliesToGroups');

    case 'd':
      return settings.get('RetentionPolicy_AppliesToDMs');
  }

  return false;
}

function roomHasPurge(room) {
  if (!room || !settings.get('RetentionPolicy_Enabled')) {
    return false;
  }

  if (room.retention && room.retention.enabled !== undefined) {
    return room.retention.enabled;
  }

  return roomHasGlobalPurge(room);
}

function roomFilesOnly(room) {
  if (!room) {
    return false;
  }

  if (room.retention && room.retention.overrideGlobal) {
    return room.retention.filesOnly;
  }

  return settings.get('RetentionPolicy_FilesOnly');
}

function roomExcludePinned(room) {
  if (!room) {
    return false;
  }

  if (room.retention && room.retention.overrideGlobal) {
    return room.retention.excludePinned;
  }

  return settings.get('RetentionPolicy_DoNotPrunePinned');
}

function roomMaxAge(room) {
  if (!room) {
    return;
  }

  if (!roomHasPurge(room)) {
    return;
  }

  if (room.retention && room.retention.overrideGlobal) {
    return room.retention.maxAge;
  }

  if (room.t === 'c') {
    return settings.get('RetentionPolicy_MaxAge_Channels');
  }

  if (room.t === 'p') {
    return settings.get('RetentionPolicy_MaxAge_Groups');
  }

  if (room.t === 'd') {
    return settings.get('RetentionPolicy_MaxAge_DMs');
  }
}

function createFileFromUrl(url) {
  var response, data, metadata, _await$module$dynamic, mime, file;

  return _regeneratorRuntime.async(function () {
    function createFileFromUrl$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.prev = 0;
            _context.next = 3;
            return _regeneratorRuntime.awrap(fetch(url));

          case 3:
            response = _context.sent;
            _context.next = 9;
            break;

          case 6:
            _context.prev = 6;
            _context.t0 = _context["catch"](0);
            throw _context.t0;

          case 9:
            _context.next = 11;
            return _regeneratorRuntime.awrap(response.blob());

          case 11:
            data = _context.sent;
            metadata = {
              type: data.type
            };
            _context.next = 15;
            return _regeneratorRuntime.awrap(module.dynamicImport('../../../../utils/lib/mimeTypes'));

          case 15:
            _await$module$dynamic = _context.sent;
            mime = _await$module$dynamic.mime;
            file = new File([data], "File - " + moment().format(settings.get('Message_TimeAndDateFormat')) + "." + mime.extension(data.type), metadata);
            return _context.abrupt("return", file);

          case 19:
          case "end":
            return _context.stop();
        }
      }
    }

    return createFileFromUrl$;
  }(), null, null, [[0, 6]], Promise);
}

function addToInput(text) {
  var input = chatMessages[RoomManager.openedRoom].input;
  var initText = input.value.slice(0, input.selectionStart);
  var finalText = input.value.slice(input.selectionEnd, input.value.length);
  input.value = initText + text + finalText;
  $(input).change().trigger('input');
}

callbacks.add('enter-room', wipeFailedUploads);
var dropzoneHelpers = {
  dragAndDrop: function () {
    return settings.get('FileUpload_Enabled') && 'dropzone--disabled';
  },
  isDropzoneDisabled: function () {
    return settings.get('FileUpload_Enabled') ? 'dropzone-overlay--enabled' : 'dropzone-overlay--disabled';
  },
  dragAndDropLabel: function () {
    if (!userCanDrop(this._id)) {
      return 'error-not-allowed';
    }

    if (!settings.get('FileUpload_Enabled')) {
      return 'FileUpload_Disabled';
    }

    return 'Drop_to_upload_file';
  }
};
Template.roomOld.helpers(_objectSpread(_objectSpread({}, dropzoneHelpers), {}, {
  tabBar: function () {
    return Template.instance().tabBar;
  },
  subscribed: function () {
    var _Template$instance = Template.instance(),
        state = _Template$instance.state;

    return state.get('subscribed');
  },
  messagesHistory: function () {
    var showInMainThread = getUserPreference(Meteor.userId(), 'showMessageInMainThread', false);

    var _Template$instance2 = Template.instance(),
        rid = _Template$instance2.rid;

    var room = Rooms.findOne(rid, {
      fields: {
        sysMes: 1
      }
    });
    var hideSettings = settings.collection.findOne('Hide_System_Messages') || {};
    var settingValues = Array.isArray(room === null || room === void 0 ? void 0 : room.sysMes) ? room.sysMes : hideSettings.value || [];
    var hideMessagesOfType = new Set(settingValues.reduce(function (array, value) {
      return [].concat(_toConsumableArray(array), _toConsumableArray(value === 'mute_unmute' ? ['user-muted', 'user-unmuted'] : [value]));
    }, []));

    var query = _objectSpread({
      rid: rid,
      _hidden: {
        $ne: true
      }
    }, !showInMainThread && {
      $or: [{
        tmid: {
          $exists: 0
        }
      }, {
        tshow: {
          $eq: true
        }
      }]
    });

    if (hideMessagesOfType.size) {
      query.t = {
        $nin: Array.from(hideMessagesOfType.values())
      };
    }

    var options = {
      sort: {
        ts: 1
      }
    };
    return ChatMessage.find(query, options);
  },
  hasMore: function () {
    return RoomHistoryManager.hasMore(this._id);
  },
  hasMoreNext: function () {
    return RoomHistoryManager.hasMoreNext(this._id);
  },
  isLoading: function () {
    return RoomHistoryManager.isLoading(this._id);
  },
  windowId: function () {
    return "chat-window-" + this._id;
  },
  uploading: function () {
    return Session.get('uploading');
  },
  roomLeader: function () {
    var roles = RoomRoles.findOne({
      'rid': this._id,
      'roles': 'leader',
      'u._id': {
        $ne: Meteor.userId()
      }
    });

    if (roles) {
      var leader = Users.findOne({
        _id: roles.u._id
      }, {
        fields: {
          status: 1,
          statusText: 1
        }
      }) || {};
      return _objectSpread(_objectSpread({}, roles.u), {}, {
        name: settings.get('UI_Use_Real_Name') ? roles.u.name || roles.u.username : roles.u.username,
        status: leader.status || 'offline',
        statusDisplay: leader.statusText || t(leader.status || 'offline')
      });
    }
  },
  chatNowLink: function () {
    return roomTypes.getRouteLink('d', {
      name: this.username
    });
  },
  announcement: function () {
    return Template.instance().state.get('announcement');
  },
  announcementDetails: function () {
    var _this = this;

    var roomData = Session.get("roomData" + this._id);

    if (!roomData) {
      return false;
    }

    if (roomData.announcementDetails != null && roomData.announcementDetails.callback != null) {
      return function () {
        return callbacks.run(roomData.announcementDetails.callback, _this._id);
      };
    }
  },
  messageboxData: function () {
    var _Template$instance3 = Template.instance(),
        sendToBottomIfNecessary = _Template$instance3.sendToBottomIfNecessary,
        subscription = _Template$instance3.subscription;

    var rid = this._id;
    var isEmbedded = isLayoutEmbedded();
    var showFormattingTips = settings.get('Message_ShowFormattingTips');
    return {
      rid: rid,
      subscription: subscription.get(),
      isEmbedded: isEmbedded,
      showFormattingTips: showFormattingTips && !isEmbedded,
      onInputChanged: function (input) {
        if (!chatMessages[rid]) {
          return;
        }

        chatMessages[rid].initializeInput(input, {
          rid: rid
        });
      },
      onResize: function () {
        return sendToBottomIfNecessary && sendToBottomIfNecessary();
      },
      onKeyUp: function () {
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        return chatMessages[rid] && chatMessages[rid].keyup.apply(chatMessages[rid], args);
      },
      onKeyDown: function () {
        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
          args[_key2] = arguments[_key2];
        }

        return chatMessages[rid] && chatMessages[rid].keydown.apply(chatMessages[rid], args);
      },
      onSend: function () {
        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
          args[_key3] = arguments[_key3];
        }

        return chatMessages[rid] && chatMessages[rid].send.apply(chatMessages[rid], args);
      }
    };
  },
  getAnnouncementStyle: function () {
    var _Template$instance4 = Template.instance(),
        room = _Template$instance4.room;

    if (!room) {
      return '';
    }

    return room.announcementDetails && room.announcementDetails.style !== undefined ? room.announcementDetails.style : '';
  },
  maxMessageLength: function () {
    return settings.get('Message_MaxAllowedSize');
  },
  unreadData: function () {
    var data = {
      count: Template.instance().state.get('count')
    };
    var room = RoomManager.getOpenedRoomByRid(this._id);

    if (room) {
      data.since = room.unreadSince.get();
    }

    return data;
  },
  containerBarsShow: function (unreadData, uploading) {
    var hasUnreadData = unreadData && unreadData.count && unreadData.since;
    var isUploading = uploading && uploading.length;

    if (hasUnreadData || isUploading) {
      return 'show';
    }
  },
  formatUnreadSince: function () {
    if (!this.since) {
      return;
    }

    return moment(this.since).calendar(null, {
      sameDay: 'LT'
    });
  },
  adminClass: function () {
    if (hasRole(Meteor.userId(), 'admin')) {
      return 'admin';
    }
  },
  messageViewMode: function () {
    var viewMode = getUserPreference(Meteor.userId(), 'messageViewMode');
    var modes = ['', 'cozy', 'compact'];
    return modes[viewMode] || modes[0];
  },
  selectable: function () {
    return Template.instance().selectable.get();
  },
  hideUsername: function () {
    return getUserPreference(Meteor.userId(), 'hideUsernames') ? 'hide-usernames' : undefined;
  },
  hideAvatar: function () {
    return getUserPreference(Meteor.userId(), 'displayAvatars') ? undefined : 'hide-avatars';
  },
  canPreview: function () {
    var _Template$instance5 = Template.instance(),
        room = _Template$instance5.room,
        state = _Template$instance5.state;

    if (room && room.t !== 'c') {
      return true;
    }

    if (settings.get('Accounts_AllowAnonymousRead') === true) {
      return true;
    }

    if (hasAllPermission('preview-c-room')) {
      return true;
    }

    return state.get('subscribed');
  },
  hideLeaderHeader: function () {
    return Template.instance().hideLeaderHeader.get() ? 'animated-hidden' : '';
  },
  hasLeader: function () {
    if (RoomRoles.findOne({
      'rid': this._id,
      'roles': 'leader',
      'u._id': {
        $ne: Meteor.userId()
      }
    }, {
      fields: {
        _id: 1
      }
    })) {
      return 'has-leader';
    }
  },
  hasPurge: function () {
    var _Template$instance6 = Template.instance(),
        room = _Template$instance6.room;

    return roomHasPurge(room);
  },
  filesOnly: function () {
    var _Template$instance7 = Template.instance(),
        room = _Template$instance7.room;

    return roomFilesOnly(room);
  },
  excludePinned: function () {
    var _Template$instance8 = Template.instance(),
        room = _Template$instance8.room;

    return roomExcludePinned(room);
  },
  purgeTimeout: function () {
    var _Template$instance9 = Template.instance(),
        room = _Template$instance9.room;

    moment.relativeTimeThreshold('s', 60);
    moment.relativeTimeThreshold('ss', 0);
    moment.relativeTimeThreshold('m', 60);
    moment.relativeTimeThreshold('h', 24);
    moment.relativeTimeThreshold('d', 31);
    moment.relativeTimeThreshold('M', 12);
    return moment.duration(roomMaxAge(room) * 1000 * 60 * 60 * 24).humanize();
  },
  messageContext: messageContext,
  openedThread: function () {
    FlowRouter.watchPathChange();
    var tab = FlowRouter.getParam('tab');
    var mid = FlowRouter.getParam('context');

    var rid = Template.currentData()._id;

    var jump = FlowRouter.getQueryParam('jump');
    var subscription = Template.instance().subscription.get();

    if (tab !== 'thread' || !mid || rid !== Session.get('openedRoom')) {
      return;
    }

    var room = Rooms.findOne({
      _id: rid
    }, {
      fields: {
        t: 1,
        usernames: 1,
        uids: 1,
        name: 1
      }
    });
    return {
      rid: rid,
      mid: mid,
      room: room,
      jump: jump,
      subscription: subscription
    };
  }
}));
var dropzoneEvents = {
  'dragenter .dropzone': function (e) {
    var types = e.originalEvent && e.originalEvent.dataTransfer && e.originalEvent.dataTransfer.types;

    if (types != null && types.length > 0 && _.some(types, function (type) {
      return type.indexOf('text/') === -1 || type.indexOf('text/uri-list') !== -1 || type.indexOf('text/plain') !== -1;
    }) && userCanDrop(this._id)) {
      e.currentTarget.classList.add('over');
    }

    e.stopPropagation();
  },
  'dragleave .dropzone-overlay': function (e) {
    e.currentTarget.parentNode.classList.remove('over');
    e.stopPropagation();
  },
  'dragover .dropzone-overlay': function (e) {
    document.querySelectorAll('.over.dropzone').forEach(function (dropzone) {
      if (dropzone !== e.currentTarget.parentNode) {
        dropzone.classList.remove('over');
      }
    });
    e = e.originalEvent || e;

    if (['move', 'linkMove'].includes(e.dataTransfer.effectAllowed)) {
      e.dataTransfer.dropEffect = 'move';
    } else {
      e.dataTransfer.dropEffect = 'copy';
    }

    e.stopPropagation();
  },
  'dropped .dropzone-overlay': function () {
    function _callee(event, instance) {
      var e, files, transferData, url, imgURL, file, _await$module$dynamic2, mime, filesToUpload;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                event.currentTarget.parentNode.classList.remove('over');
                e = event.originalEvent || event;
                e.stopPropagation();
                e.preventDefault();

                if (!(!userCanDrop(this._id) || !settings.get('FileUpload_Enabled'))) {
                  _context2.next = 6;
                  break;
                }

                return _context2.abrupt("return", false);

              case 6:
                files = e.dataTransfer && e.dataTransfer.files || [];

                if (!(files.length < 1)) {
                  _context2.next = 22;
                  break;
                }

                transferData = e.dataTransfer.getData('text') || e.dataTransfer.getData('url');

                if (!e.dataTransfer.types.includes('text/uri-list')) {
                  _context2.next = 20;
                  break;
                }

                url = e.dataTransfer.getData('text/html').match('<img.+src=(?:"|\')(.+?)(?:"|\')(?:.+?)>');
                imgURL = url && url[1];

                if (imgURL) {
                  _context2.next = 14;
                  break;
                }

                return _context2.abrupt("return");

              case 14:
                _context2.next = 16;
                return _regeneratorRuntime.awrap(createFileFromUrl(imgURL));

              case 16:
                file = _context2.sent;

                if (!(typeof file === 'string')) {
                  _context2.next = 19;
                  break;
                }

                return _context2.abrupt("return", addToInput(file));

              case 19:
                files = [file];

              case 20:
                if (!(e.dataTransfer.types.includes('text/plain') && !e.dataTransfer.types.includes('text/x-moz-url'))) {
                  _context2.next = 22;
                  break;
                }

                return _context2.abrupt("return", addToInput(transferData.trim()));

              case 22:
                _context2.next = 24;
                return _regeneratorRuntime.awrap(module.dynamicImport('../../../../utils/lib/mimeTypes'));

              case 24:
                _await$module$dynamic2 = _context2.sent;
                mime = _await$module$dynamic2.mime;
                filesToUpload = Array.from(files).map(function (file) {
                  Object.defineProperty(file, 'type', {
                    value: mime.lookup(file.name)
                  });
                  return {
                    file: file,
                    name: file.name
                  };
                });
                return _context2.abrupt("return", instance.onFile && instance.onFile(filesToUpload));

              case 28:
              case "end":
                return _context2.stop();
            }
          }
        }

        return _callee$;
      }(), null, this, null, Promise);
    }

    return _callee;
  }()
};
Meteor.startup(function () {
  Template.roomOld.events(_objectSpread(_objectSpread(_objectSpread({}, getCommonRoomEvents()), dropzoneEvents), {}, {
    'click .toggle-hidden': function (e) {
      var id = e.currentTarget.dataset.message;
      document.querySelector("#" + id).classList.toggle('message--ignored');
    },
    'click .message': function (e, template) {
      if (template.selectable.get()) {
        (document.selection != null ? document.selection.empty() : undefined) || (typeof window.getSelection === 'function' ? window.getSelection().removeAllRanges() : undefined);
        var data = Blaze.getData(e.currentTarget);

        var _messageArgs = messageArgs(data),
            _id = _messageArgs.msg._id;

        if (!template.selectablePointer) {
          template.selectablePointer = _id;
        }

        if (!e.shiftKey) {
          template.selectedMessages = template.getSelectedMessages();
          template.selectedRange = [];
          template.selectablePointer = _id;
        }

        template.selectMessages(_id);
        var selectedMessages = $('.messages-box .message.selected').map(function (i, message) {
          return message.id;
        });

        var removeClass = _.difference(selectedMessages, template.getSelectedMessages());

        var addClass = _.difference(template.getSelectedMessages(), selectedMessages);

        removeClass.forEach(function (message) {
          return $(".messages-box #" + message).removeClass('selected');
        });
        addClass.forEach(function (message) {
          return $(".messages-box #" + message).addClass('selected');
        });
      }
    },
    'click .jump-recent button': function (e, template) {
      e.preventDefault();
      template.atBottom = true;
      RoomHistoryManager.clear(template && template.data && template.data._id);
    },
    'load .gallery-item': function (e, template) {
      template.sendToBottomIfNecessary();
    },
    'rendered .js-block-wrapper': function (e, template) {
      template.sendToBottomIfNecessary();
    },
    'click .new-message': function (event, instance) {
      instance.atBottom = true;
      instance.sendToBottomIfNecessary();
      chatMessages[RoomManager.openedRoom].input.focus();
    },
    'click .upload-progress-close': function (e) {
      e.preventDefault();
      Session.set("uploading-cancel-" + this.id, true);
    },
    'click .unread-bar > button.mark-read': function (e, t) {
      readMessage.readNow(t.data._id);
    },
    'click .unread-bar > button.jump-to': function (e, t) {
      var _id = t.data._id;
      var room = RoomHistoryManager.getRoom(_id);
      var message = room && room.firstUnread.get();

      if (!message) {
        var subscription = Subscriptions.findOne({
          rid: _id
        });
        message = ChatMessage.find({
          rid: _id,
          ts: {
            $gt: subscription != null ? subscription.ls : undefined
          }
        }, {
          sort: {
            ts: 1
          },
          limit: 1
        }).fetch()[0];
      }

      RoomHistoryManager.getSurroundingMessages(message, 50);
    },
    'scroll .wrapper': _.throttle(function (e, t) {
      var $roomLeader = $('.room-leader');

      if ($roomLeader.length) {
        if (e.target.scrollTop < t.lastScrollTop) {
          t.hideLeaderHeader.set(false);
        } else if (t.isAtBottom(100) === false && e.target.scrollTop > $roomLeader.height()) {
          t.hideLeaderHeader.set(true);
        }
      }

      t.lastScrollTop = e.target.scrollTop;
      var height = e.target.clientHeight;
      var isLoading = RoomHistoryManager.isLoading(this._id);
      var hasMore = RoomHistoryManager.hasMore(this._id);
      var hasMoreNext = RoomHistoryManager.hasMoreNext(this._id);

      if (isLoading === false && hasMore === true || hasMoreNext === true) {
        if (hasMore === true && t.lastScrollTop <= height / 3) {
          RoomHistoryManager.getMore(this._id);
        } else if (hasMoreNext === true && Math.ceil(t.lastScrollTop) >= e.target.scrollHeight - height) {
          RoomHistoryManager.getMoreNext(this._id);
        }
      }
    }, 100),
    'click .time a': function (e) {
      e.preventDefault();

      var _messageArgs2 = messageArgs(this),
          msg = _messageArgs2.msg;

      var repliedMessageId = msg.attachments[0].message_link.split('?msg=')[1];
      FlowRouter.go(FlowRouter.current().context.pathname, null, {
        msg: repliedMessageId,
        hash: Random.id()
      });
    }
  }));
  Template.roomOld.onCreated(function () {
    var _this2 = this;

    // this.scrollOnBottom = true
    // this.typing = new msgTyping this.data._id
    var rid = this.data._id;
    this.tabBar = this.data.tabBar;

    this.onFile = function (filesToUpload) {
      fileUpload(filesToUpload, chatMessages[rid].input, {
        rid: rid
      });
    };

    this.rid = rid;
    this.subscription = new ReactiveVar();
    this.state = new ReactiveDict();
    this.userDetail = new ReactiveVar('');
    var user = Meteor.user();
    this.autorun(function (c) {
      var room = Rooms.findOne({
        _id: rid
      }, {
        fields: {
          t: 1,
          usernames: 1,
          uids: 1
        }
      });

      if (room.t !== 'd') {
        return c.stop();
      }

      if (roomTypes.getConfig(room.t).isGroupChat(room)) {
        return;
      }

      var usernames = Array.from(new Set(room.usernames));

      _this2.userDetail.set(_this2.userDetail.get() || (usernames.length === 1 ? usernames[0] : usernames.filter(function (username) {
        return username !== user.username;
      })[0]));
    });
    this.autorun(function () {
      var rid = Template.currentData()._id;

      var room = Rooms.findOne({
        _id: rid
      }, {
        fields: {
          announcement: 1
        }
      });

      _this2.state.set('announcement', room.announcement);
    });
    this.autorun(function () {
      var subscription = Subscriptions.findOne({
        rid: rid
      });

      _this2.subscription.set(subscription);

      _this2.state.set({
        subscribed: !!subscription,
        autoTranslate: subscription && subscription.autoTranslate,
        autoTranslateLanguage: subscription && subscription.autoTranslateLanguage
      });
    });
    this.showUsersOffline = new ReactiveVar(false);
    this.atBottom = !FlowRouter.getQueryParam('msg');
    this.unreadCount = new ReactiveVar(0);
    this.selectable = new ReactiveVar(false);
    this.selectedMessages = [];
    this.selectedRange = [];
    this.selectablePointer = null;
    this.flexTemplate = new ReactiveVar();
    this.groupDetail = new ReactiveVar();
    this.hideLeaderHeader = new ReactiveVar(false);

    this.resetSelection = function (enabled) {
      _this2.selectable.set(enabled);

      $('.messages-box .message.selected').removeClass('selected');
      _this2.selectedMessages = [];
      _this2.selectedRange = [];
      _this2.selectablePointer = null;
    };

    this.selectMessages = function (to) {
      if (_this2.selectablePointer === to && _this2.selectedRange.length > 0) {
        _this2.selectedRange = [];
      } else {
        var message1 = ChatMessage.findOne(_this2.selectablePointer);
        var message2 = ChatMessage.findOne(to);

        var minTs = _.min([message1.ts, message2.ts]);

        var maxTs = _.max([message1.ts, message2.ts]);

        _this2.selectedRange = _.pluck(ChatMessage.find({
          rid: message1.rid,
          ts: {
            $gte: minTs,
            $lte: maxTs
          }
        }).fetch(), '_id');
      }
    };

    this.getSelectedMessages = function () {
      var previewMessages;
      var messages = _this2.selectedMessages;
      var addMessages = false;

      for (var _i = 0, _Array$from = Array.from(_this2.selectedRange); _i < _Array$from.length; _i++) {
        var message = _Array$from[_i];

        if (messages.indexOf(message) === -1) {
          addMessages = true;
          break;
        }
      }

      if (addMessages) {
        previewMessages = _.compact(_.uniq(_this2.selectedMessages.concat(_this2.selectedRange)));
      } else {
        previewMessages = _.compact(_.difference(_this2.selectedMessages, _this2.selectedRange));
      }

      return previewMessages;
    };

    this.clearUserDetail = function () {
      _this2.userDetail.set(null);

      _this2.tabBar.setData({});

      _this2.tabBar.close();
    };

    Meteor.call('getRoomRoles', this.data._id, function (error, results) {
      if (error) {
        handleError(error);
      }

      return Array.from(results).forEach(function (record) {
        delete record._id;
        RoomRoles.upsert({
          'rid': record.rid,
          'u._id': record.u._id
        }, record);
      });
    });
    this.rolesObserve = RoomRoles.find({
      rid: this.data._id
    }).observe({
      added: function (role) {
        if (!role.u || !role.u._id) {
          return;
        }

        ChatMessage.update({
          'rid': _this2.data._id,
          'u._id': role.u._id
        }, {
          $addToSet: {
            roles: role._id
          }
        }, {
          multi: true
        });
      },
      // Update message to re-render DOM
      changed: function (role) {
        if (!role.u || !role.u._id) {
          return;
        }

        ChatMessage.update({
          'rid': _this2.data._id,
          'u._id': role.u._id
        }, {
          $inc: {
            rerender: 1
          }
        }, {
          multi: true
        });
      },
      // Update message to re-render DOM
      removed: function (role) {
        if (!role.u || !role.u._id) {
          return;
        }

        ChatMessage.update({
          'rid': _this2.data._id,
          'u._id': role.u._id
        }, {
          $pull: {
            roles: role._id
          }
        }, {
          multi: true
        });
      }
    });

    this.sendToBottomIfNecessary = function () {
      if (_this2.atBottom === true) {
        _this2.sendToBottom();
      }
    };
  }); // Update message to re-render DOM

  Template.roomOld.onDestroyed(function () {
    if (this.rolesObserve) {
      this.rolesObserve.stop();
    }

    readMessage.off(this.data._id);
    window.removeEventListener('resize', this.onWindowResize);
    this.observer && this.observer.disconnect();
    var chatMessage = chatMessages[this.data._id];
    chatMessage.onDestroyed && chatMessage.onDestroyed(this.data._id);
    callbacks.remove('streamNewMessage', this.data._id);
  });

  var isAtBottom = function (element) {
    var scrollThreshold = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    return element.scrollTop + scrollThreshold >= element.scrollHeight - element.clientHeight;
  };

  Template.roomOld.onRendered(function () {
    var _this3 = this;

    var rid = this.data._id;

    if (!chatMessages[rid]) {
      chatMessages[rid] = new ChatMessages();
    }

    var wrapper = this.find('.wrapper');
    var store = NewRoomManager.getStore(rid);

    var afterMessageGroup = function () {
      if (store.scroll && !store.atBottom) {
        wrapper.scrollTop = store.scroll;
      } else {
        _this3.sendToBottom();
      }

      wrapper.removeEventListener('MessageGroup', afterMessageGroup);
      wrapper.addEventListener('scroll', _.throttle(function () {
        store.update({
          scroll: wrapper.scrollTop,
          atBottom: isAtBottom(wrapper, 50)
        });
      }, 30));
    };

    wrapper.addEventListener('MessageGroup', afterMessageGroup);
    chatMessages[rid].initializeWrapper(this.find('.wrapper'));
    chatMessages[rid].initializeInput(this.find('.js-input-message'), {
      rid: rid
    });
    var wrapperUl = this.find('.wrapper > ul');
    var newMessage = this.find('.new-message');
    var template = this;
    var messageBox = $('.messages-box');

    template.isAtBottom = function () {
      var scrollThreshold = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

      if (isAtBottom(wrapper, scrollThreshold)) {
        newMessage.className = 'new-message background-primary-action-color color-content-background-color not';
        return true;
      }

      return false;
    };

    template.sendToBottom = function () {
      wrapper.scrollTo(30, wrapper.scrollHeight);
      newMessage.className = 'new-message background-primary-action-color color-content-background-color not';
    };

    template.checkIfScrollIsAtBottom = function () {
      template.atBottom = template.isAtBottom(100);
    };

    template.observer = new ResizeObserver(function () {
      return template.sendToBottomIfNecessary();
    });
    template.observer.observe(wrapperUl);

    var wheelHandler = _.throttle(function () {
      template.checkIfScrollIsAtBottom();
    }, 100);

    wrapper.addEventListener('mousewheel', wheelHandler);
    wrapper.addEventListener('wheel', wheelHandler);
    wrapper.addEventListener('touchstart', function () {
      template.atBottom = false;
    });
    wrapper.addEventListener('touchend', function () {
      template.checkIfScrollIsAtBottom();
      setTimeout(function () {
        return template.checkIfScrollIsAtBottom();
      }, 1000);
      setTimeout(function () {
        return template.checkIfScrollIsAtBottom();
      }, 2000);
    });
    Tracker.afterFlush(function () {
      wrapper.addEventListener('scroll', wheelHandler);
    });
    this.lastScrollTop = $('.messages-box .wrapper').scrollTop();
    var rtl = $('html').hasClass('rtl');

    var getElementFromPoint = function () {
      var topOffset = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var messageBoxOffset = messageBox.offset();
      var element;

      if (rtl) {
        element = document.elementFromPoint(messageBoxOffset.left + messageBox.width() - 1, messageBoxOffset.top + topOffset + 1);
      } else {
        element = document.elementFromPoint(messageBoxOffset.left + 1, messageBoxOffset.top + topOffset + 1);
      }

      if (element && element.classList.contains('message')) {
        return element;
      }
    };

    var updateUnreadCount = _.throttle(function () {
      Tracker.afterFlush(function () {
        var lastInvisibleMessageOnScreen = getElementFromPoint(0) || getElementFromPoint(20) || getElementFromPoint(40);

        if (!lastInvisibleMessageOnScreen || !lastInvisibleMessageOnScreen.id) {
          return _this3.unreadCount.set(0);
        }

        var lastMessage = ChatMessage.findOne(lastInvisibleMessageOnScreen.id);

        if (!lastMessage) {
          return _this3.unreadCount.set(0);
        }

        _this3.state.set('lastMessage', lastMessage.ts);
      });
    }, 300);

    var read = _.debounce(function () {
      if (rid !== Session.get('openedRoom')) {
        return;
      }

      readMessage.read(rid);
    }, 500);

    this.autorun(function () {
      var _room;

      if (rid !== Session.get('openedRoom')) {
        return;
      }

      var room = Rooms.findOne({
        _id: rid
      }, {
        fields: {
          t: 1
        }
      });

      if (((_room = room) === null || _room === void 0 ? void 0 : _room.t) === 'l') {
        room = Tracker.nonreactive(function () {
          return Rooms.findOne({
            _id: rid
          });
        });
        roomTypes.getConfig(room.t).openCustomProfileTab(_this3, room, room.v.username);
      }
    });
    this.autorun(function () {
      if (!Object.values(roomTypes.roomTypes).map(function (_ref) {
        var route = _ref.route;
        return route && route.name;
      }).filter(Boolean).includes(FlowRouter.getRouteName())) {
        return;
      }

      if (rid !== Session.get('openedRoom')) {
        return;
      }

      var subscription = Subscriptions.findOne({
        rid: rid
      }, {
        fields: {
          alert: 1,
          unread: 1
        }
      });
      read();
      return subscription && (subscription.alert || subscription.unread) && readMessage.refreshUnreadMark(rid);
    });
    this.autorun(function () {
      var lastMessage = _this3.state.get('lastMessage');

      var subscription = Subscriptions.findOne({
        rid: rid
      }, {
        fields: {
          ls: 1
        }
      });

      if (!subscription) {
        _this3.unreadCount.set(0);

        return;
      }

      var count = ChatMessage.find({
        rid: rid,
        ts: {
          $lte: lastMessage,
          $gt: subscription && subscription.ls
        }
      }).count();

      _this3.unreadCount.set(count);
    });
    this.autorun(function () {
      var count = RoomHistoryManager.getRoom(rid).unreadNotLoaded.get() + _this3.unreadCount.get();

      _this3.state.set('count', count);
    });
    this.autorun(function () {
      Rooms.findOne(rid);

      var count = _this3.state.get('count');

      if (count === 0) {
        return read();
      }

      readMessage.refreshUnreadMark(rid);
    });
    readMessage.on(template.data._id, function () {
      return _this3.unreadCount.set(0);
    });
    wrapper.addEventListener('scroll', updateUnreadCount); // salva a data da renderização para exibir alertas de novas mensagens

    $.data(this.firstNode, 'renderedAt', new Date());
    var webrtc = WebRTC.getInstanceByRoomId(template.data._id);

    if (webrtc) {
      this.autorun(function () {
        var remoteItems = webrtc.remoteItems.get();

        if (remoteItems && remoteItems.length > 0 || webrtc.localUrl.get()) {
          return _this3.tabBar.openUserInfo();
        }
      });
    }

    callbacks.add('streamNewMessage', function (msg) {
      if (rid !== msg.rid || msg.editedAt || msg.tmid) {
        return;
      }

      if (msg.u._id === Meteor.userId()) {
        return template.sendToBottom();
      }

      if (!template.isAtBottom()) {
        newMessage.classList.remove('not');
      }
    }, callbacks.priority.MEDIUM, rid);
    this.autorun(function () {
      if (template.data._id !== RoomManager.openedRoom) {
        return;
      }

      var room = Rooms.findOne({
        _id: template.data._id
      });

      if (!room) {
        return FlowRouter.go('home');
      }
    });
  });
});
callbacks.add('enter-room', function (sub) {
  if (!sub) {
    return;
  }

  var isAReplyInDMFromChannel = FlowRouter.getQueryParam('reply') && sub.t === 'd';

  if (isAReplyInDMFromChannel && chatMessages[sub.rid]) {
    chatMessages[sub.rid].restoreReplies();
  }

  setTimeout(function () {
    return readMessage.read(sub.rid);
  }, 1000);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomSearch.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/views/app/roomSearch.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var roomTypes;
module.link("../../../../utils", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 1);
Template.roomSearch.helpers({
  roomIcon: function () {
    if (this.type === 'u') {
      return 'icon-at';
    }

    if (this.type === 'r') {
      return roomTypes.getIcon(this);
    }
  },
  userStatus: function () {
    if (this.type === 'u') {
      return "status-" + this.status;
    }
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/client/index.ts                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/accounts");
module.link("./lib/collections");
module.link("./lib/iframeCommands");
module.link("./lib/menu");
module.link("./lib/parentTemplate");
module.link("./lib/codeMirror");
module.link("./lib/textarea-cursor");
module.link("./views/app/burger.html");
module.link("./views/app/home.html");
module.link("./views/app/notAuthorized.html");
module.link("./views/app/pageContainer.html");
module.link("./views/app/pageCustomContainer.html");
module.link("./views/app/roomSearch.html");
module.link("./views/app/userSearch.html");
module.link("./views/app/burger");
module.link("./views/app/home");
module.link("./views/app/roomSearch");
module.link("./views/app/photoswipeContent.ts");
module.link("./components/icon");
module.link("./components/table.html");
module.link("./components/table");
module.link("./components/tabs");
module.link("./components/popupList.html");
module.link("./components/popupList");
module.link("./components/selectDropdown.html");
module.link("./components/header/header");
module.link("./components/tooltip");
module.link("./lib/Tooltip");
module.link("./lib/chatMessages", {
  ChatMessages: "ChatMessages"
}, 0);
module.link("./lib/fileUpload", {
  fileUpload: "fileUpload"
}, 1);
module.link("./lib/UserAction", {
  UserAction: "UserAction",
  USER_ACTIVITIES: "USER_ACTIVITIES"
}, 2);
module.link("./lib/notification", {
  KonchatNotification: "KonchatNotification"
}, 3);
module.link("./lib/rocket", {
  Login: "Login",
  Button: "Button"
}, 4);
module.link("./lib/recorderjs/audioRecorder", {
  AudioRecorder: "AudioRecorder"
}, 5);
module.link("./lib/recorderjs/videoRecorder", {
  VideoRecorder: "VideoRecorder"
}, 6);
module.link("./views/app/room", {
  chatMessages: "chatMessages"
}, 7);
module.link("./lib/userPopoverStatus", {
  "*": "*"
}, 8);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui/index.ts                                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client/index", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"client":{"views":{"customFieldsForm.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/views/customFieldsForm.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.customFieldsForm.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.customFieldsForm.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/views/template.customFieldsForm.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("customFieldsForm");
Template["customFieldsForm"] = new Template("Template.customFieldsForm", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("customFields"));
  }, function() {
    return [ "\n\t", HTML.DIV({
      class: "rc-form-group rc-grid"
    }, "\n\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("customFields"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "rc-input rc-w50 padded"
      }, "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("$eq"), Spacebars.dot(view.lookup("field"), "type"), "select");
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.Unless(function() {
          return Spacebars.call(Spacebars.dot(view.lookup(".."), "new"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.DIV({
            class: "input-line"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            for: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            }
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), view.lookup("fieldName"));
          })), "\n\t\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t\t", HTML.SELECT({
            name: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            "data-customfield": "true"
          }, "\n\t\t\t\t\t\t\t\t\t", Blaze.Each(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("field"), "options"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.OPTION({
              value: function() {
                return Spacebars.mustache(view.lookup("."));
              },
              selected: function() {
                return Spacebars.mustache(view.lookup("selectedField"), view.lookup("."), view.lookup(".."));
              }
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), view.lookup("."));
            })), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t"), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label"
          }, "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__title"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), view.lookup("fieldName"));
          })), "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t", HTML.SELECT({
            name: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            "data-customfield": "true",
            class: "rc-input__element"
          }, HTML.Raw("\n\t\t\t\t\t\t\t\t\t<option></option>\n\t\t\t\t\t\t\t\t\t"), Blaze.Each(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("field"), "options"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.OPTION({
              value: function() {
                return Spacebars.mustache(view.lookup("."));
              },
              selected: function() {
                return Spacebars.mustache(view.lookup("selectedField"), view.lookup("."), view.lookup(".."));
              }
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), view.lookup("."));
            })), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("$eq"), Spacebars.dot(view.lookup("field"), "type"), "text");
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.Unless(function() {
          return Spacebars.call(Spacebars.dot(view.lookup(".."), "new"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.DIV({
            class: "input-line"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            for: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            }
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), view.lookup("fieldName"));
          })), "\n\t\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t\t", HTML.INPUT({
            type: "text",
            name: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            id: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            "data-customfield": "true",
            value: function() {
              return Spacebars.mustache(view.lookup("fieldValue"));
            },
            maxlength: function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("field"), "maxLength"));
            }
          }), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label"
          }, "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__title"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), view.lookup("fieldName"));
          })), "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
            type: "text",
            class: "rc-input__element",
            name: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            id: function() {
              return Spacebars.mustache(view.lookup("fieldName"));
            },
            "data-customfield": "true",
            value: function() {
              return Spacebars.mustache(view.lookup("fieldValue"));
            },
            maxlength: function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("field"), "maxLength"));
            }
          }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t"), "\n" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"customFieldsForm.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/views/customFieldsForm.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);
Template.customFieldsForm.helpers({
  "new": function () {
    return this.new;
  },
  customFields: function () {
    var customFields = Template.instance().customFields.get();

    if (!customFields) {
      return [];
    }

    var customFieldsArray = [];
    Object.keys(customFields).forEach(function (key) {
      var value = customFields[key];

      if (value.hideFromForm === true && Template.instance().hideFromForm === true) {
        return;
      }

      customFieldsArray.push({
        fieldName: key,
        field: value
      });
    });
    return customFieldsArray;
  },
  selectedField: function (current, field) {
    var _Template$instance = Template.instance(),
        formData = _Template$instance.formData;

    if (typeof formData[field.fieldName] !== 'undefined') {
      return formData[field.fieldName] === current;
    }

    if (typeof field.defaultValue !== 'undefined') {
      return field.defaultValue === current;
    }
  },
  fieldValue: function () {
    var _Template$instance2 = Template.instance(),
        formData = _Template$instance2.formData;

    return formData[this.fieldName];
  }
});
Template.customFieldsForm.onCreated(function () {
  var _this = this;

  this.customFields = new ReactiveVar();
  var currentData = Template.currentData();
  this.hideFromForm = currentData && currentData.hideFromForm;
  this.formData = currentData && currentData.formData || {};
  Tracker.autorun(function () {
    var Accounts_CustomFields = settings.get('Accounts_CustomFields');

    if (typeof Accounts_CustomFields === 'string' && Accounts_CustomFields.trim() !== '') {
      try {
        _this.customFields.set(JSON.parse(settings.get('Accounts_CustomFields')));
      } catch (e) {
        console.error('Invalid JSON for Accounts_CustomFields');
      }
    } else {
      _this.customFields.set(undefined);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"LoginPresence.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/lib/LoginPresence.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  LoginPresence: function () {
    return LoginPresence;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);
var LoginPresence = {
  awayTime: 600000,
  // 10 minutes
  started: false,
  startTimer: function () {
    LoginPresence.stopTimer();

    if (!LoginPresence.awayTime) {
      return;
    }

    this.timer = setTimeout(LoginPresence.disconnect, LoginPresence.awayTime);
  },
  stopTimer: function () {
    clearTimeout(this.timer);
  },
  disconnect: function () {
    var status = Meteor.status();

    if (status && status.status !== 'offline') {
      if (!Meteor.userId() && settings.get('Accounts_AllowAnonymousRead') !== true) {
        Meteor.disconnect();
      }
    }

    LoginPresence.stopTimer();
  },
  connect: function () {
    var status = Meteor.status();

    if (status && status.status === 'offline') {
      Meteor.reconnect();
    }
  },
  start: function () {
    if (LoginPresence.started) {
      return;
    }

    window.addEventListener('focus', function () {
      LoginPresence.stopTimer();
      LoginPresence.connect();
    });
    window.addEventListener('blur', function () {
      LoginPresence.startTimer();
    });

    if (!window.document.hasFocus()) {
      LoginPresence.startTimer();
    }

    LoginPresence.started = true;
  }
};
LoginPresence.start();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RocketChatAnnouncement.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/lib/RocketChatAnnouncement.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RocketChatAnnouncement: function () {
    return RocketChatAnnouncement;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 2);

var RocketChatAnnouncement = /*#__PURE__*/function () {
  function RocketChatAnnouncement() {
    var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    this.room = new ReactiveVar(args.room);
    this.message = new ReactiveVar(args.message);
    this.callback = new ReactiveVar(args.callback);
    this.style = new ReactiveVar(args.style);
  }

  var _proto = RocketChatAnnouncement.prototype;

  _proto.save = function () {
    function save() {
      var announcementObject = {
        message: this.message.get(),
        callback: this.callback.get(),
        style: this.style.get()
      };
      Meteor.call('saveRoomSettings', this.room.get(), 'roomAnnouncement', announcementObject);
    }

    return save;
  }();

  _proto.getMessage = function () {
    function getMessage() {
      return this.message.get();
    }

    return getMessage;
  }();

  _proto.getCallback = function () {
    function getCallback() {
      return this.callback.get();
    }

    return getCallback;
  }();

  _proto.getStyle = function () {
    function getStyle() {
      return this.callback.get();
    }

    return getStyle;
  }();

  _proto.getByRoom = function () {
    function getByRoom(rid) {
      var roomData = Session.get("roomData" + rid);

      if (!roomData) {
        return null;
      }

      this.room.set(rid);
      this.message.set(roomData.announcement);
      this.callback.set(roomData.announcementDetails ? roomData.announcementDetails.callback : null);
      this.style.set(roomData.announcementDetails ? roomData.announcementDetails.style : null);
      return this;
    }

    return getByRoom;
  }();

  _proto.clear = function () {
    function clear() {
      this.message.set(null);
      this.callback.set(null);
      this.style.set(null);
      Meteor.call('saveRoomSettings', this.room.get(), 'roomAnnouncement', {});
    }

    return clear;
  }();

  return RocketChatAnnouncement;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/lib/index.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./RocketChatAnnouncement", {
  RocketChatAnnouncement: "RocketChatAnnouncement"
}, 0);
module.link("./LoginPresence", {
  LoginPresence: "LoginPresence"
}, 1);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"methods":{"sendMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/methods/sendMessage.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var TimeSync;
module.link("meteor/mizzao:timesync", {
  TimeSync: function (v) {
    TimeSync = v;
  }
}, 1);
var s;
module.link("underscore.string", {
  "default": function (v) {
    s = v;
  }
}, 2);
var ChatMessage;
module.link("../../../models", {
  ChatMessage: function (v) {
    ChatMessage = v;
  }
}, 3);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 5);
var t;
module.link("../../../utils/client", {
  t: function (v) {
    t = v;
  }
}, 6);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 7);
var onClientMessageReceived;
module.link("../../../../client/lib/onClientMessageReceived", {
  onClientMessageReceived: function (v) {
    onClientMessageReceived = v;
  }
}, 8);
Meteor.methods({
  sendMessage: function (message) {
    if (!Meteor.userId() || s.trim(message.msg) === '') {
      return false;
    }

    var messageAlreadyExists = message._id && ChatMessage.findOne({
      _id: message._id
    });

    if (messageAlreadyExists) {
      return dispatchToastMessage({
        type: 'error',
        message: t('Message_Already_Sent')
      });
    }

    var user = Meteor.user();
    message.ts = isNaN(TimeSync.serverOffset()) ? new Date() : new Date(Date.now() + TimeSync.serverOffset());
    message.u = {
      _id: Meteor.userId(),
      username: user.username
    };

    if (settings.get('UI_Use_Real_Name')) {
      message.u.name = user.name;
    }

    message.temp = true;

    if (settings.get('Message_Read_Receipt_Enabled')) {
      message.unread = true;
    }

    message = callbacks.run('beforeSaveMessage', message);
    onClientMessageReceived(message).then(function (message) {
      ChatMessage.insert(message);
      return callbacks.run('afterSaveMessage', message);
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"startup":{"settingsOnLoadSiteUrl.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/startup/settingsOnLoadSiteUrl.ts                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 2);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var value = settings.get('Site_Url');

    if (value == null || value.trim() === '') {
      return;
    }

    window.__meteor_runtime_config__.ROOT_URL = value;
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"OAuthProxy.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/OAuthProxy.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var OAuth;
module.link("meteor/oauth", {
  OAuth: function (v) {
    OAuth = v;
  }
}, 1);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);
OAuth.launchLogin = _.wrap(OAuth.launchLogin, function (func, options) {
  var proxy = settings.get('Accounts_OAuth_Proxy_services').replace(/\s/g, '').split(',');

  if (proxy.includes(options.loginService)) {
    var redirect_uri = options.loginUrl.match(/(&redirect_uri=)([^&]+|$)/)[2];
    options.loginUrl = options.loginUrl.replace(/(&redirect_uri=)([^&]+|$)/, "$1" + encodeURIComponent(settings.get('Accounts_OAuth_Proxy_host')) + "/oauth_redirect");
    options.loginUrl = options.loginUrl.replace(/(&state=)([^&]+|$)/, "$1" + redirect_uri + "!$2");
    options.loginUrl = settings.get('Accounts_OAuth_Proxy_host') + "/redirect/" + encodeURIComponent(options.loginUrl);
  }

  return func(options);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/client/index.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./startup/settingsOnLoadSiteUrl");
module.link("../lib/MessageTypes");
module.link("./OAuthProxy");
module.link("./methods/sendMessage");
module.link("./views/customFieldsForm.html");
module.link("./views/customFieldsForm");
module.link("../startup/defaultRoomTypes");
module.link("./lib", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"roomTypes":{"conversation.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/conversation.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  ConversationRoomType: function () {
    return ConversationRoomType;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var getUserPreference, RoomTypeConfig;
module.link("../../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  },
  RoomTypeConfig: function (v) {
    RoomTypeConfig = v;
  }
}, 1);

var ConversationRoomType = /*#__PURE__*/function (_RoomTypeConfig) {
  _inheritsLoose(ConversationRoomType, _RoomTypeConfig);

  function ConversationRoomType() {
    return _RoomTypeConfig.call(this, {
      identifier: 'merged',
      order: 30,
      label: 'Conversations'
    }) || this;
  }

  var _proto = ConversationRoomType.prototype;

  _proto.condition = function () {
    function condition() {
      // returns true only if sidebarGroupByType is not set
      return !getUserPreference(Meteor.userId(), 'sidebarGroupByType');
    }

    return condition;
  }();

  return ConversationRoomType;
}(RoomTypeConfig);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"direct.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/direct.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  DirectMessageRoomRoute: function () {
    return DirectMessageRoomRoute;
  },
  DirectMessageRoomType: function () {
    return DirectMessageRoomType;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var ChatRoom, Subscriptions;
module.link("../../../models", {
  ChatRoom: function (v) {
    ChatRoom = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 2);
var openRoom;
module.link("../../../ui-utils", {
  openRoom: function (v) {
    openRoom = v;
  }
}, 3);
var getUserPreference, RoomTypeConfig, RoomTypeRouteConfig, RoomSettingsEnum, RoomMemberActions, UiTextContext;
module.link("../../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  },
  RoomTypeConfig: function (v) {
    RoomTypeConfig = v;
  },
  RoomTypeRouteConfig: function (v) {
    RoomTypeRouteConfig = v;
  },
  RoomSettingsEnum: function (v) {
    RoomSettingsEnum = v;
  },
  RoomMemberActions: function (v) {
    RoomMemberActions = v;
  },
  UiTextContext: function (v) {
    UiTextContext = v;
  }
}, 4);
var hasPermission, hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasPermission: function (v) {
    hasPermission = v;
  },
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 5);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 6);
var getUserAvatarURL;
module.link("../../../utils/lib/getUserAvatarURL", {
  getUserAvatarURL: function (v) {
    getUserAvatarURL = v;
  }
}, 7);
var getAvatarURL;
module.link("../../../utils/lib/getAvatarURL", {
  getAvatarURL: function (v) {
    getAvatarURL = v;
  }
}, 8);

var DirectMessageRoomRoute = /*#__PURE__*/function (_RoomTypeRouteConfig) {
  _inheritsLoose(DirectMessageRoomRoute, _RoomTypeRouteConfig);

  function DirectMessageRoomRoute() {
    return _RoomTypeRouteConfig.call(this, {
      name: 'direct',
      path: '/direct/:rid/:tab?/:context?'
    }) || this;
  }

  var _proto = DirectMessageRoomRoute.prototype;

  _proto.action = function () {
    function action(params) {
      return openRoom('d', params.rid);
    }

    return action;
  }();

  _proto.link = function () {
    function link(sub) {
      return {
        rid: sub.rid || sub.name
      };
    }

    return link;
  }();

  return DirectMessageRoomRoute;
}(RoomTypeRouteConfig);

var DirectMessageRoomType = /*#__PURE__*/function (_RoomTypeConfig) {
  _inheritsLoose(DirectMessageRoomType, _RoomTypeConfig);

  function DirectMessageRoomType() {
    return _RoomTypeConfig.call(this, {
      identifier: 'd',
      order: 50,
      icon: 'at',
      label: 'Direct_Messages',
      route: new DirectMessageRoomRoute()
    }) || this;
  }

  var _proto2 = DirectMessageRoomType.prototype;

  _proto2.getIcon = function () {
    function getIcon(roomData) {
      if (this.isGroupChat(roomData)) {
        return 'balloon';
      }

      return this.icon;
    }

    return getIcon;
  }();

  _proto2.findRoom = function () {
    function findRoom(identifier) {
      if (!hasPermission('view-d-room')) {
        return null;
      }

      var query = {
        t: 'd',
        $or: [{
          name: identifier
        }, {
          rid: identifier
        }]
      };
      var subscription = Subscriptions.findOne(query);

      if (subscription && subscription.rid) {
        return ChatRoom.findOne(subscription.rid);
      }
    }

    return findRoom;
  }();

  _proto2.roomName = function () {
    function roomName(roomData) {
      // this function can receive different types of data
      // if it doesn't have fname and name properties, should be a Room object
      // so, need to find the related subscription
      var subscription = roomData && (roomData.fname || roomData.name) ? roomData : Subscriptions.findOne({
        rid: roomData._id
      });

      if (subscription === undefined) {
        return;
      }

      if (settings.get('UI_Use_Real_Name') && subscription.fname) {
        return subscription.fname;
      }

      return subscription.name;
    }

    return roomName;
  }();

  _proto2.secondaryRoomName = function () {
    function secondaryRoomName(roomData) {
      if (settings.get('UI_Use_Real_Name')) {
        var subscription = Subscriptions.findOne({
          rid: roomData._id
        }, {
          fields: {
            name: 1
          }
        });
        return subscription && subscription.name;
      }
    }

    return secondaryRoomName;
  }();

  _proto2.condition = function () {
    function condition() {
      var groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');
      return groupByType && hasAtLeastOnePermission(['view-d-room', 'view-joined-room']);
    }

    return condition;
  }();

  _proto2.getUserStatus = function () {
    function getUserStatus(roomId) {
      var subscription = Subscriptions.findOne({
        rid: roomId
      });

      if (subscription == null) {
        return;
      }

      return Session.get("user_" + subscription.name + "_status");
    }

    return getUserStatus;
  }();

  _proto2.getUserStatusText = function () {
    function getUserStatusText(roomId) {
      var subscription = Subscriptions.findOne({
        rid: roomId
      });

      if (subscription == null) {
        return;
      }

      return Session.get("user_" + subscription.name + "_status_text");
    }

    return getUserStatusText;
  }();

  _proto2.allowRoomSettingChange = function () {
    function allowRoomSettingChange(room, setting) {
      switch (setting) {
        case RoomSettingsEnum.TYPE:
        case RoomSettingsEnum.NAME:
        case RoomSettingsEnum.SYSTEM_MESSAGES:
        case RoomSettingsEnum.DESCRIPTION:
        case RoomSettingsEnum.READ_ONLY:
        case RoomSettingsEnum.REACT_WHEN_READ_ONLY:
        case RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE:
        case RoomSettingsEnum.JOIN_CODE:
          return false;

        case RoomSettingsEnum.E2E:
          return settings.get('E2E_Enable') === true;

        default:
          return true;
      }
    }

    return allowRoomSettingChange;
  }();

  _proto2.allowMemberAction = function () {
    function allowMemberAction(room, action) {
      switch (action) {
        case RoomMemberActions.BLOCK:
          return !this.isGroupChat(room);

        default:
          return false;
      }
    }

    return allowMemberAction;
  }();

  _proto2.enableMembersListProfile = function () {
    function enableMembersListProfile() {
      return true;
    }

    return enableMembersListProfile;
  }();

  _proto2.userDetailShowAll = function () {
    function userDetailShowAll() {
      return true;
    }

    return userDetailShowAll;
  }();

  _proto2.getUiText = function () {
    function getUiText(context) {
      switch (context) {
        case UiTextContext.HIDE_WARNING:
          return 'Hide_Private_Warning';

        case UiTextContext.LEAVE_WARNING:
          return 'Leave_Private_Warning';

        default:
          return '';
      }
    }

    return getUiText;
  }()
  /**
   * Returns details to use on notifications
   *
   * @param {object} room
   * @param {object} user
   * @param {string} notificationMessage
   * @return {object} Notification details
   */
  ;

  _proto2.getNotificationDetails = function () {
    function getNotificationDetails(room, user, notificationMessage) {
      if (!Meteor.isServer) {
        return {};
      }

      if (this.isGroupChat(room)) {
        return {
          title: this.roomName(room),
          text: (settings.get('UI_Use_Real_Name') && user.name || user.username) + ": " + notificationMessage
        };
      }

      return {
        title: settings.get('UI_Use_Real_Name') && user.name || user.username,
        text: notificationMessage
      };
    }

    return getNotificationDetails;
  }();

  _proto2.getAvatarPath = function () {
    function getAvatarPath(roomData, subData) {
      if (!roomData && !subData) {
        return '';
      } // if coming from sidenav search


      if (roomData.name && roomData.avatarETag) {
        return getUserAvatarURL(roomData.name, roomData.avatarETag);
      }

      if (this.isGroupChat(roomData)) {
        return getAvatarURL({
          username: roomData.uids.length + roomData.usernames.join()
        });
      }

      var sub = subData || Subscriptions.findOne({
        rid: roomData._id
      }, {
        fields: {
          name: 1
        }
      });

      if (sub && sub.name) {
        var user = Meteor.users.findOne({
          username: sub.name
        }, {
          fields: {
            username: 1,
            avatarETag: 1
          }
        });
        return getUserAvatarURL((user === null || user === void 0 ? void 0 : user.username) || sub.name, user === null || user === void 0 ? void 0 : user.avatarETag);
      }

      if (roomData) {
        return getUserAvatarURL(roomData.name || this.roomName(roomData)); // rooms should have no name for direct messages...
      }
    }

    return getAvatarPath;
  }();

  _proto2.includeInDashboard = function () {
    function includeInDashboard() {
      return true;
    }

    return includeInDashboard;
  }();

  _proto2.isGroupChat = function () {
    function isGroupChat(room) {
      return room && room.uids && room.uids.length > 2;
    }

    return isGroupChat;
  }();

  return DirectMessageRoomType;
}(RoomTypeConfig);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"favorite.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/favorite.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  FavoriteRoomType: function () {
    return FavoriteRoomType;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);
var getUserPreference, RoomTypeConfig;
module.link("../../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  },
  RoomTypeConfig: function (v) {
    RoomTypeConfig = v;
  }
}, 2);

var FavoriteRoomType = /*#__PURE__*/function (_RoomTypeConfig) {
  _inheritsLoose(FavoriteRoomType, _RoomTypeConfig);

  function FavoriteRoomType() {
    return _RoomTypeConfig.call(this, {
      identifier: 'f',
      order: 20,
      header: 'favorite',
      icon: 'star',
      label: 'Favorites'
    }) || this;
  }

  var _proto = FavoriteRoomType.prototype;

  _proto.condition = function () {
    function condition() {
      return settings.get('Favorite_Rooms') && getUserPreference(Meteor.userId(), 'sidebarShowFavorites');
    }

    return condition;
  }();

  return FavoriteRoomType;
}(RoomTypeConfig);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ConversationRoomType: function () {
    return ConversationRoomType;
  },
  DirectMessageRoomType: function () {
    return DirectMessageRoomType;
  },
  FavoriteRoomType: function () {
    return FavoriteRoomType;
  },
  PrivateRoomType: function () {
    return PrivateRoomType;
  },
  PublicRoomType: function () {
    return PublicRoomType;
  },
  UnreadRoomType: function () {
    return UnreadRoomType;
  }
});
var ConversationRoomType;
module.link("./conversation", {
  ConversationRoomType: function (v) {
    ConversationRoomType = v;
  }
}, 0);
var DirectMessageRoomType;
module.link("./direct", {
  DirectMessageRoomType: function (v) {
    DirectMessageRoomType = v;
  }
}, 1);
var FavoriteRoomType;
module.link("./favorite", {
  FavoriteRoomType: function (v) {
    FavoriteRoomType = v;
  }
}, 2);
var PrivateRoomType;
module.link("./private", {
  PrivateRoomType: function (v) {
    PrivateRoomType = v;
  }
}, 3);
var PublicRoomType;
module.link("./public", {
  PublicRoomType: function (v) {
    PublicRoomType = v;
  }
}, 4);
var UnreadRoomType;
module.link("./unread", {
  UnreadRoomType: function (v) {
    UnreadRoomType = v;
  }
}, 5);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"private.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/private.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  PrivateRoomRoute: function () {
    return PrivateRoomRoute;
  },
  PrivateRoomType: function () {
    return PrivateRoomType;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ChatRoom, ChatSubscription;
module.link("../../../models", {
  ChatRoom: function (v) {
    ChatRoom = v;
  },
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 1);
var openRoom;
module.link("../../../ui-utils", {
  openRoom: function (v) {
    openRoom = v;
  }
}, 2);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var hasAtLeastOnePermission, hasPermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  },
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 4);
var getUserPreference, RoomSettingsEnum, RoomTypeConfig, RoomTypeRouteConfig, UiTextContext, RoomMemberActions;
module.link("../../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  },
  RoomSettingsEnum: function (v) {
    RoomSettingsEnum = v;
  },
  RoomTypeConfig: function (v) {
    RoomTypeConfig = v;
  },
  RoomTypeRouteConfig: function (v) {
    RoomTypeRouteConfig = v;
  },
  UiTextContext: function (v) {
    UiTextContext = v;
  },
  RoomMemberActions: function (v) {
    RoomMemberActions = v;
  }
}, 5);
var getAvatarURL;
module.link("../../../utils/lib/getAvatarURL", {
  getAvatarURL: function (v) {
    getAvatarURL = v;
  }
}, 6);

var PrivateRoomRoute = /*#__PURE__*/function (_RoomTypeRouteConfig) {
  _inheritsLoose(PrivateRoomRoute, _RoomTypeRouteConfig);

  function PrivateRoomRoute() {
    return _RoomTypeRouteConfig.call(this, {
      name: 'group',
      path: '/group/:name/:tab?/:context?'
    }) || this;
  }

  var _proto = PrivateRoomRoute.prototype;

  _proto.action = function () {
    function action(params) {
      return openRoom('p', params.name);
    }

    return action;
  }();

  return PrivateRoomRoute;
}(RoomTypeRouteConfig);

var PrivateRoomType = /*#__PURE__*/function (_RoomTypeConfig) {
  _inheritsLoose(PrivateRoomType, _RoomTypeConfig);

  function PrivateRoomType() {
    return _RoomTypeConfig.call(this, {
      identifier: 'p',
      order: 40,
      icon: 'hashtag-lock',
      label: 'Private_Groups',
      route: new PrivateRoomRoute()
    }) || this;
  }

  var _proto2 = PrivateRoomType.prototype;

  _proto2.getIcon = function () {
    function getIcon(roomData) {
      if (roomData.prid) {
        return 'discussion';
      }

      if (roomData.teamMain) {
        return 'team-lock';
      }

      return this.icon;
    }

    return getIcon;
  }();

  _proto2.findRoom = function () {
    function findRoom(identifier) {
      var query = {
        t: 'p',
        name: identifier
      };
      return ChatRoom.findOne(query);
    }

    return findRoom;
  }();

  _proto2.roomName = function () {
    function roomName(roomData) {
      if (roomData.prid) {
        return roomData.fname;
      }

      if (settings.get('UI_Allow_room_names_with_special_chars')) {
        return roomData.fname || roomData.name;
      }

      return roomData.name;
    }

    return roomName;
  }();

  _proto2.condition = function () {
    function condition() {
      var groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');
      return groupByType && hasPermission('view-p-room');
    }

    return condition;
  }();

  _proto2.isGroupChat = function () {
    function isGroupChat() {
      return true;
    }

    return isGroupChat;
  }();

  _proto2.canAddUser = function () {
    function canAddUser(room) {
      return hasAtLeastOnePermission(['add-user-to-any-p-room', 'add-user-to-joined-room'], room._id);
    }

    return canAddUser;
  }();

  _proto2.canSendMessage = function () {
    function canSendMessage(roomId) {
      // TODO: remove duplicated code
      return ChatSubscription.find({
        rid: roomId
      }).count() > 0;
    }

    return canSendMessage;
  }();

  _proto2.allowRoomSettingChange = function () {
    function allowRoomSettingChange(room, setting) {
      switch (setting) {
        case RoomSettingsEnum.JOIN_CODE:
          return false;

        case RoomSettingsEnum.BROADCAST:
          return room.broadcast;

        case RoomSettingsEnum.READ_ONLY:
          return !room.broadcast;

        case RoomSettingsEnum.REACT_WHEN_READ_ONLY:
          return !room.broadcast && room.ro;

        case RoomSettingsEnum.E2E:
          return settings.get('E2E_Enable') === true;

        case RoomSettingsEnum.SYSTEM_MESSAGES:
        default:
          return true;
      }
    }

    return allowRoomSettingChange;
  }();

  _proto2.allowMemberAction = function () {
    function allowMemberAction(room, action) {
      switch (action) {
        case RoomMemberActions.BLOCK:
          return false;

        default:
          return true;
      }
    }

    return allowMemberAction;
  }();

  _proto2.enableMembersListProfile = function () {
    function enableMembersListProfile() {
      return true;
    }

    return enableMembersListProfile;
  }();

  _proto2.getUiText = function () {
    function getUiText(context) {
      switch (context) {
        case UiTextContext.HIDE_WARNING:
          return 'Hide_Group_Warning';

        case UiTextContext.LEAVE_WARNING:
          return 'Leave_Group_Warning';

        default:
          return '';
      }
    }

    return getUiText;
  }();

  _proto2.getAvatarPath = function () {
    function getAvatarPath(roomData) {
      return getAvatarURL({
        roomId: roomData._id,
        cache: roomData.avatarETag
      });
    }

    return getAvatarPath;
  }();

  _proto2.includeInDashboard = function () {
    function includeInDashboard() {
      return true;
    }

    return includeInDashboard;
  }();

  return PrivateRoomType;
}(RoomTypeConfig);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"public.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/public.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  PublicRoomRoute: function () {
    return PublicRoomRoute;
  },
  PublicRoomType: function () {
    return PublicRoomType;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var openRoom;
module.link("../../../ui-utils", {
  openRoom: function (v) {
    openRoom = v;
  }
}, 1);
var ChatRoom, ChatSubscription;
module.link("../../../models", {
  ChatRoom: function (v) {
    ChatRoom = v;
  },
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 2);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 4);
var getUserPreference, RoomTypeConfig, RoomTypeRouteConfig, RoomSettingsEnum, UiTextContext, RoomMemberActions;
module.link("../../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  },
  RoomTypeConfig: function (v) {
    RoomTypeConfig = v;
  },
  RoomTypeRouteConfig: function (v) {
    RoomTypeRouteConfig = v;
  },
  RoomSettingsEnum: function (v) {
    RoomSettingsEnum = v;
  },
  UiTextContext: function (v) {
    UiTextContext = v;
  },
  RoomMemberActions: function (v) {
    RoomMemberActions = v;
  }
}, 5);
var getAvatarURL;
module.link("../../../utils/lib/getAvatarURL", {
  getAvatarURL: function (v) {
    getAvatarURL = v;
  }
}, 6);

var PublicRoomRoute = /*#__PURE__*/function (_RoomTypeRouteConfig) {
  _inheritsLoose(PublicRoomRoute, _RoomTypeRouteConfig);

  function PublicRoomRoute() {
    return _RoomTypeRouteConfig.call(this, {
      name: 'channel',
      path: '/channel/:name/:tab?/:context?'
    }) || this;
  }

  var _proto = PublicRoomRoute.prototype;

  _proto.action = function () {
    function action(params) {
      return openRoom('c', params.name);
    }

    return action;
  }();

  return PublicRoomRoute;
}(RoomTypeRouteConfig);

var PublicRoomType = /*#__PURE__*/function (_RoomTypeConfig) {
  _inheritsLoose(PublicRoomType, _RoomTypeConfig);

  function PublicRoomType() {
    return _RoomTypeConfig.call(this, {
      identifier: 'c',
      order: 30,
      icon: 'hashtag',
      label: 'Channels',
      route: new PublicRoomRoute()
    }) || this;
  }

  var _proto2 = PublicRoomType.prototype;

  _proto2.getIcon = function () {
    function getIcon(roomData) {
      if (roomData.prid) {
        return 'discussion';
      }

      if (roomData.teamMain) {
        return 'team';
      }

      return this.icon;
    }

    return getIcon;
  }();

  _proto2.findRoom = function () {
    function findRoom(identifier) {
      var query = {
        t: 'c',
        name: identifier
      };
      return ChatRoom.findOne(query);
    }

    return findRoom;
  }();

  _proto2.roomName = function () {
    function roomName(roomData) {
      if (roomData.prid) {
        return roomData.fname;
      }

      if (settings.get('UI_Allow_room_names_with_special_chars')) {
        return roomData.fname || roomData.name;
      }

      return roomData.name;
    }

    return roomName;
  }();

  _proto2.condition = function () {
    function condition() {
      var groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');
      return groupByType && (hasAtLeastOnePermission(['view-c-room', 'view-joined-room']) || settings.get('Accounts_AllowAnonymousRead') === true);
    }

    return condition;
  }();

  _proto2.showJoinLink = function () {
    function showJoinLink(roomId) {
      return !!ChatRoom.findOne({
        _id: roomId,
        t: 'c'
      });
    }

    return showJoinLink;
  }();

  _proto2.includeInRoomSearch = function () {
    function includeInRoomSearch() {
      return true;
    }

    return includeInRoomSearch;
  }();

  _proto2.isGroupChat = function () {
    function isGroupChat() {
      return true;
    }

    return isGroupChat;
  }();

  _proto2.includeInDashboard = function () {
    function includeInDashboard() {
      return true;
    }

    return includeInDashboard;
  }();

  _proto2.canAddUser = function () {
    function canAddUser(room) {
      return hasAtLeastOnePermission(['add-user-to-any-c-room', 'add-user-to-joined-room'], room._id);
    }

    return canAddUser;
  }();

  _proto2.canSendMessage = function () {
    function canSendMessage(roomId) {
      var room = ChatRoom.findOne({
        _id: roomId,
        t: 'c'
      }, {
        fields: {
          prid: 1
        }
      });

      if (room.prid) {
        return true;
      } // TODO: remove duplicated code


      return ChatSubscription.find({
        rid: roomId
      }).count() > 0;
    }

    return canSendMessage;
  }();

  _proto2.enableMembersListProfile = function () {
    function enableMembersListProfile() {
      return true;
    }

    return enableMembersListProfile;
  }();

  _proto2.allowRoomSettingChange = function () {
    function allowRoomSettingChange(room, setting) {
      switch (setting) {
        case RoomSettingsEnum.BROADCAST:
          return room.broadcast;

        case RoomSettingsEnum.READ_ONLY:
          return !room.broadcast;

        case RoomSettingsEnum.REACT_WHEN_READ_ONLY:
          return !room.broadcast && room.ro;

        case RoomSettingsEnum.E2E:
          return false;

        case RoomSettingsEnum.SYSTEM_MESSAGES:
        default:
          return true;
      }
    }

    return allowRoomSettingChange;
  }();

  _proto2.allowMemberAction = function () {
    function allowMemberAction(room, action) {
      switch (action) {
        case RoomMemberActions.BLOCK:
          return false;

        default:
          return true;
      }
    }

    return allowMemberAction;
  }();

  _proto2.getUiText = function () {
    function getUiText(context) {
      switch (context) {
        case UiTextContext.HIDE_WARNING:
          return 'Hide_Room_Warning';

        case UiTextContext.LEAVE_WARNING:
          return 'Leave_Room_Warning';

        default:
          return '';
      }
    }

    return getUiText;
  }();

  _proto2.getAvatarPath = function () {
    function getAvatarPath(roomData) {
      return getAvatarURL({
        roomId: roomData._id,
        cache: roomData.avatarETag
      });
    }

    return getAvatarPath;
  }();

  _proto2.getDiscussionType = function () {
    function getDiscussionType() {
      return 'c';
    }

    return getDiscussionType;
  }();

  return PublicRoomType;
}(RoomTypeConfig);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"unread.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/roomTypes/unread.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  UnreadRoomType: function () {
    return UnreadRoomType;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var getUserPreference, RoomTypeConfig;
module.link("../../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  },
  RoomTypeConfig: function (v) {
    RoomTypeConfig = v;
  }
}, 1);

var UnreadRoomType = /*#__PURE__*/function (_RoomTypeConfig) {
  _inheritsLoose(UnreadRoomType, _RoomTypeConfig);

  function UnreadRoomType() {
    var _this;

    _this = _RoomTypeConfig.call(this, {
      identifier: 'unread',
      order: 10,
      label: 'Unread'
    }) || this;
    _this.unread = true;
    return _this;
  }

  var _proto = UnreadRoomType.prototype;

  _proto.condition = function () {
    function condition() {
      return getUserPreference(Meteor.userId(), 'sidebarShowUnread');
    }

    return condition;
  }();

  return UnreadRoomType;
}(RoomTypeConfig);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"MessageTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/lib/MessageTypes.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  MessageTypesValues: function () {
    return MessageTypesValues;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var MessageTypes;
module.link("../../ui-utils", {
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 1);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 2);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'r',
    system: true,
    message: 'Room_name_changed',
    data: function (message) {
      return {
        room_name: message.msg,
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'au',
    system: true,
    message: 'User_added_by',
    data: function (message) {
      return {
        user_added: message.msg,
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'ru',
    system: true,
    message: 'User_removed_by',
    data: function (message) {
      return {
        user_removed: message.msg,
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'ul',
    system: true,
    message: 'User_left',
    data: function (message) {
      return {
        user_left: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'ult',
    system: true,
    message: 'User_left_team',
    data: function (message) {
      return {
        user_left: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'uj',
    system: true,
    message: 'User_joined_channel',
    data: function (message) {
      return {
        user: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'ujt',
    system: true,
    message: 'User_joined_team',
    data: function (message) {
      return {
        user: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'ut',
    system: true,
    message: 'User_joined_conversation',
    data: function (message) {
      return {
        user: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'wm',
    system: true,
    message: 'Welcome',
    data: function (message) {
      return {
        user: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'rm',
    system: true,
    message: 'Message_removed',
    data: function (message) {
      return {
        user: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'rtc',
    render: function (message) {
      return callbacks.run('renderRtcMessage', message);
    }
  });
  MessageTypes.registerType({
    id: 'user-muted',
    system: true,
    message: 'User_muted_by',
    data: function (message) {
      return {
        user_muted: message.msg,
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'user-unmuted',
    system: true,
    message: 'User_unmuted_by',
    data: function (message) {
      return {
        user_unmuted: message.msg,
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'subscription-role-added',
    system: true,
    message: '__username__was_set__role__by__user_by_',
    data: function (message) {
      return {
        username: message.msg,
        role: message.role,
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'subscription-role-removed',
    system: true,
    message: '__username__is_no_longer__role__defined_by__user_by_',
    data: function (message) {
      return {
        username: message.msg,
        role: message.role,
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'room-archived',
    system: true,
    message: 'This_room_has_been_archived_by__username_',
    data: function (message) {
      return {
        username: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'room-unarchived',
    system: true,
    message: 'This_room_has_been_unarchived_by__username_',
    data: function (message) {
      return {
        username: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'room-removed-read-only',
    system: true,
    message: 'room_removed_read_only',
    data: function (message) {
      return {
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'room-set-read-only',
    system: true,
    message: 'room_set_read_only',
    data: function (message) {
      return {
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'room-allowed-reacting',
    system: true,
    message: 'room_allowed_reacting',
    data: function (message) {
      return {
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'room-disallowed-reacting',
    system: true,
    message: 'room_disallowed_reacting',
    data: function (message) {
      return {
        user_by: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'room_e2e_enabled',
    system: true,
    message: 'This_room_encryption_has_been_enabled_by__username_',
    data: function (message) {
      return {
        username: message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'room_e2e_disabled',
    system: true,
    message: 'This_room_encryption_has_been_disabled_by__username_',
    data: function (message) {
      return {
        username: message.u.username
      };
    }
  });
});
var MessageTypesValues = [{
  key: 'uj',
  i18nLabel: 'Message_HideType_uj'
}, {
  key: 'ul',
  i18nLabel: 'Message_HideType_ul'
}, {
  key: 'ru',
  i18nLabel: 'Message_HideType_ru'
}, {
  key: 'au',
  i18nLabel: 'Message_HideType_au'
}, {
  key: 'mute_unmute',
  i18nLabel: 'Message_HideType_mute_unmute'
}, {
  key: 'r',
  i18nLabel: 'Message_HideType_r'
}, {
  key: 'ut',
  i18nLabel: 'Message_HideType_ut'
}, {
  key: 'wm',
  i18nLabel: 'Message_HideType_wm'
}, {
  key: 'rm',
  i18nLabel: 'Message_HideType_rm'
}, {
  key: 'subscription-role-added',
  i18nLabel: 'Message_HideType_subscription_role_added'
}, {
  key: 'subscription-role-removed',
  i18nLabel: 'Message_HideType_subscription_role_removed'
}, {
  key: 'room_archived',
  i18nLabel: 'Message_HideType_room_archived'
}, {
  key: 'room_unarchived',
  i18nLabel: 'Message_HideType_room_unarchived'
}, {
  key: 'room_changed_privacy',
  i18nLabel: 'Message_HideType_room_changed_privacy'
}, {
  key: 'room_changed_avatar',
  i18nLabel: 'Message_HideType_room_changed_avatar'
}, {
  key: 'room_changed_topic',
  i18nLabel: 'Message_HideType_room_changed_topic'
}, {
  key: 'room_e2e_enabled',
  i18nLabel: 'Message_HideType_room_enabled_encryption'
}, {
  key: 'room_e2e_disabled',
  i18nLabel: 'Message_HideType_room_disabled_encryption'
}, {
  key: 'room-removed-read-only',
  i18nLabel: 'Message_HideType_room_removed_read_only'
}, {
  key: 'room-set-read-only',
  i18nLabel: 'Message_HideType_room_set_read_only'
}, {
  key: 'room-disallowed-reacting',
  i18nLabel: 'Message_HideType_room_disallowed_reacting'
}, {
  key: 'room-allowed-reacting',
  i18nLabel: 'Message_HideType_room_allowed_reacting'
}];
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"startup":{"defaultRoomTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/startup/defaultRoomTypes.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var roomTypes;
module.link("../../utils", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 0);
var ConversationRoomType, DirectMessageRoomType, FavoriteRoomType, PrivateRoomType, PublicRoomType, UnreadRoomType;
module.link("../lib/roomTypes", {
  ConversationRoomType: function (v) {
    ConversationRoomType = v;
  },
  DirectMessageRoomType: function (v) {
    DirectMessageRoomType = v;
  },
  FavoriteRoomType: function (v) {
    FavoriteRoomType = v;
  },
  PrivateRoomType: function (v) {
    PrivateRoomType = v;
  },
  PublicRoomType: function (v) {
    PublicRoomType = v;
  },
  UnreadRoomType: function (v) {
    UnreadRoomType = v;
  }
}, 1);
roomTypes.add(new UnreadRoomType());
roomTypes.add(new FavoriteRoomType());
roomTypes.add(new ConversationRoomType());
roomTypes.add(new PublicRoomType());
roomTypes.add(new PrivateRoomType());
roomTypes.add(new DirectMessageRoomType());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lib/index.js                                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ui-utils":{"client":{"lib":{"collapseArrow.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/collapseArrow.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.collapseArrow.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.collapseArrow.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/template.collapseArrow.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("collapseArrow");
Template["collapseArrow"] = new Template("Template.collapseArrow", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("collapsed"));
  }, function() {
    return [ "\n        ", HTML.SPAN({
      class: "collapse-switch icon-right-dir",
      "data-index": function() {
        return Spacebars.mustache(view.lookup("index"));
      },
      "data-collapsed": function() {
        return Spacebars.mustache(view.lookup("collapsed"));
      }
    }), "\n    " ];
  }, function() {
    return [ "\n        ", HTML.SPAN({
      class: "collapse-switch icon-down-dir",
      "data-index": function() {
        return Spacebars.mustache(view.lookup("index"));
      },
      "data-collapsed": function() {
        return Spacebars.mustache(view.lookup("collapsed"));
      }
    }), "\n    " ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"modal.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/modal.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.modal.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.modal.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/template.modal.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("rc_modal");
Template["rc_modal"] = new Template("Template.rc_modal", (function() {
  var view = this;
  return HTML.DIV({
    class: "rc-modal-wrapper"
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.dataMustache(view.lookup("$eq"), view.lookup("template"), "ModalBlock");
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("data"));
    }, function() {
      return Spacebars.include(view.lookupTemplate("ModalBlock"));
    }), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t", HTML.getTag("dialog")({
      class: function() {
        return [ "rc-modal rc-modal--", Spacebars.mustache(view.lookup("modifier")) ];
      },
      "data-modal": "modal"
    }, "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("template"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          template: Spacebars.call(view.lookup("template")),
          data: Spacebars.call(view.lookup("data"))
        };
      }, function() {
        return Spacebars.include(function() {
          return Spacebars.call(Template.__dynamic);
        });
      }), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", HTML.HEADER({
        class: "rc-modal__header"
      }, "\n\t\t\t\t\t", HTML.H1({
        class: "rc-modal__title"
      }, "\n\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("html"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:title", function() {
          return Spacebars.makeRaw(Spacebars.mustache(view.lookup("title")));
        }), "\n\t\t\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:title", function() {
          return Spacebars.mustache(view.lookup("title"));
        }), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.BUTTON({
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Close");
        },
        class: "contextual-bar__close js-close"
      }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          classes: Spacebars.call("rc-modal__close"),
          icon: Spacebars.call("plus")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\n\t\t\t\t", HTML.SECTION({
        class: "rc-modal__content"
      }, "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("content"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            template: Spacebars.call(view.lookup("content")),
            data: Spacebars.call(view.lookup("data"))
          };
        }, function() {
          return Spacebars.include(function() {
            return Spacebars.call(Template.__dynamic);
          });
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("type"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call(view.lookup("type")),
            icon: Spacebars.call(view.lookup("modalIcon"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("text"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "rc-modal__content-text"
        }, "\n\t\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("html"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:text", function() {
            return Spacebars.makeRaw(Spacebars.mustache(view.lookup("text")));
          }), "\n\t\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:text", function() {
            return Spacebars.mustache(view.lookup("text"));
          }), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("input"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input"
        }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-input__label"
        }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input__wrapper"
        }, "\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
          name: "name",
          type: function() {
            return Spacebars.mustache(view.lookup("inputType"));
          },
          class: "rc-input__element js-modal-input",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("inputPlaceholder"));
          }
        }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
          class: "rc-modal__content-error"
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("inputActionText"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.INPUT({
          class: "rc-button rc-button--nude js-input-action",
          type: "submit",
          "data-button": "input-action",
          value: function() {
            return Spacebars.mustache(view.lookup("inputActionText"));
          }
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("dontAskAgain"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-checkbox"
        }, "\n\t\t\t\t\t\t\t", HTML.INPUT({
          type: "checkbox",
          id: "dont-ask-me-again",
          class: "rc-checkbox__input js-modal-dont-ask"
        }), "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            icon: Spacebars.call("check"),
            block: Spacebars.call("rc-checkbox__icon")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t\t", HTML.SPAN({
          class: "rc-checkbox__text rc-text__small"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Dont_ask_me_again");
        })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("showFooter"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.FOOTER({
          class: function() {
            return [ "rc-modal__footer ", Blaze.Unless(function() {
              return Spacebars.call(view.lookup("showFooter"));
            }, function() {
              return "rc-modal__footer--empty";
            }) ];
          }
        }, "\n\t\t\t\t\t\t\t", HTML.INPUT({
          class: function() {
            return [ "rc-button rc-button--secondary js-close ", Blaze.Unless(function() {
              return Spacebars.call(view.lookup("showCancelButton"));
            }, function() {
              return "rc-button--invisible";
            }) ];
          },
          style: function() {
            return Blaze.If(function() {
              return Spacebars.call(view.lookup("cancelButtonColor"));
            }, function() {
              return [ "color: ", Blaze.View("lookup:cancelButtonColor", function() {
                return Spacebars.mustache(view.lookup("cancelButtonColor"));
              }) ];
            });
          },
          type: "submit",
          "data-button": "cancel",
          value: function() {
            return Spacebars.mustache(view.lookup("cancelButtonText"));
          }
        }), "\n\t\t\t\t\t\t\t", HTML.INPUT({
          style: function() {
            return [ "background-color:", Spacebars.mustache(view.lookup("confirmButtonColor")) ];
          },
          class: function() {
            return [ "rc-button rc-button--primary js-confirm ", Blaze.Unless(function() {
              return Spacebars.call(view.lookup("showConfirmButton"));
            }, function() {
              return "rc-button--invisible";
            }) ];
          },
          type: "submit",
          "data-button": "create",
          value: function() {
            return Spacebars.mustache(view.lookup("confirmButtonText"));
          }
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }), "\n\t\t\t"), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popout.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/popout.html                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.popout.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.popout.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/template.popout.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("popout");
Template["popout"] = new Template("Template.popout", (function() {
  var view = this;
  return HTML.DIV({
    class: function() {
      return [ "rc-popout-wrapper rc-popout--", Spacebars.mustache(view.lookup("type")) ];
    },
    draggable: "true"
  }, "\n\t\t", HTML.DIV({
    class: function() {
      return [ "rc-popout rc-popout--", Spacebars.mustache(view.lookup("state")) ];
    },
    "data-modal": "modal"
  }, "\n\t\t\t", HTML.HEADER({
    class: "rc-popout__header"
  }, "\n\t\t\t\t", HTML.H1({
    class: "rc-popout__title"
  }, Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call("podcast")
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  })), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("showVideoControls"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "rc-popout__controls"
    }, "\n\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isPlaying"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--pause"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("pause")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--play"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("play")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isMuted"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--unmute"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("volume-mute")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--mute"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("volume")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("showStreamControls"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "rc-popout__controls"
    }, "\n\t\t\t\t\t\t\t", HTML.BUTTON({
      class: function() {
        return [ "rc-popout__controls--record ", Spacebars.mustache(view.lookup("getStreamStatus")) ];
      }
    }, " ", Blaze._TemplateWith(function() {
      return {
        icon: Spacebars.call("circle")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), " "), "\n\t\t\t\t\t\t\t", HTML.SPAN(" ", Blaze.View("lookup:getStreamStatus", function() {
      return Spacebars.mustache(view.lookup("getStreamStatus"));
    }), " "), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("isAudioOnly"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.BUTTON({
      class: "contextual-bar__minimize js-minimize"
    }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        classes: Spacebars.call("rc-popout__minimize"),
        icon: Spacebars.call("arrow-down")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", HTML.BUTTON({
    class: "contextual-bar__close js-close",
    "aria-label": function() {
      return Spacebars.mustache(view.lookup("_"), "Close");
    }
  }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
    return {
      classes: Spacebars.call("rc-popout__close"),
      icon: Spacebars.call("plus")
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\n\t\t\t", HTML.SECTION({
    class: function() {
      return [ "rc-popout__content rc-popout--", Spacebars.mustache(view.lookup("state")), " " ];
    }
  }, "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("content"));
  }, function() {
    return [ "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        template: Spacebars.call(view.lookup("content")),
        data: Spacebars.call(view.lookup("data"))
      };
    }, function() {
      return Spacebars.include(function() {
        return Spacebars.call(Template.__dynamic);
      });
    }), "\n\t\t\t\t" ];
  }), "\n\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("showVideoControls"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "rc-popout__controls"
    }, "\n\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isPlaying"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--pause"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("pause")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--play"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("play")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isMuted"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--unmute"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("volume-mute")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
        class: "rc-popout__controls--mute"
      }, " ", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("volume")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), " "), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("showStreamControls"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "rc-popout__controls"
    }, "\n\t\t\t\t\t\t", HTML.BUTTON({
      class: function() {
        return [ "rc-popout__controls--record ", Spacebars.mustache(view.lookup("getStreamStatus")) ];
      }
    }, " ", Blaze._TemplateWith(function() {
      return {
        icon: Spacebars.call("circle")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), " "), "\n\t\t\t\t\t\t", HTML.SPAN(" ", Blaze.View("lookup:getStreamStatus", function() {
      return Spacebars.mustache(view.lookup("getStreamStatus"));
    }), " "), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t"), "\n\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popover.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/popover.html                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.popover.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.popover.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/template.popover.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("popover");
Template["popover"] = new Template("Template.popover", (function() {
  var view = this;
  return HTML.DIV({
    class: function() {
      return [ "rc-popover rc-popover--", Spacebars.mustache(view.lookup("popoverClass")) ];
    },
    "data-popover": "popover",
    style: "display: block; visibility: hidden;"
  }, "\n\t\t", HTML.DIV({
    class: function() {
      return [ "rc-popover__content ", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("template"));
      }, function() {
        return "rc-popover__content--templateless";
      }), " ", Blaze.If(function() {
        return Spacebars.call(view.lookup("isSafariIos"));
      }, function() {
        return "rc-popover__content--safariIos";
      }) ];
    }
  }, "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("template"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        template: Spacebars.call(view.lookup("template")),
        data: Spacebars.call(view.lookup("data"))
      };
    }, function() {
      return Spacebars.include(function() {
        return Spacebars.call(Template.__dynamic);
      });
    }), "\n\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("columns")),
        _variable: "column"
      };
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV({
        class: "rc-popover__column"
      }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.call(Spacebars.dot(view.lookup("column"), "groups")),
          _variable: "group"
        };
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("group"), "title"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", HTML.H3({
            class: "rc-popover__title"
          }, Blaze.View("lookup:group.title", function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("group"), "title"));
          })), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t\t", HTML.UL({
          class: "rc-popover__list"
        }, "\n\t\t\t\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(Spacebars.dot(view.lookup("group"), "items")),
            _variable: "item"
          };
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t\t", Spacebars.With(function() {
            return Spacebars.call(view.lookup("item"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t", HTML.LI({
              "data-qa": function() {
                return Spacebars.mustache(view.lookup("qa"));
              },
              class: function() {
                return [ "rc-popover__item ", Blaze.If(function() {
                  return Spacebars.call(Spacebars.dot(view.lookup("item"), "modifier"));
                }, function() {
                  return [ "rc-popover__item--", Blaze.View("lookup:item.modifier", function() {
                    return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "modifier"));
                  }) ];
                }), Blaze.If(function() {
                  return Spacebars.call(view.lookup("hasAction"));
                }, function() {
                  return " js-action";
                }) ];
              },
              "data-type": function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "type"));
              },
              "data-id": function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "id", "toLowerCase"));
              },
              "data-href": function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "href"));
              },
              "data-sidenav": function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "sideNav"));
              }
            }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(Spacebars.dot(view.lookup("item"), "icon"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
                class: "rc-popover__icon"
              }, "\n\t\t\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
                return {
                  block: Spacebars.call("rc-popover__icon-element"),
                  icon: Spacebars.call(Spacebars.dot(view.lookup("item"), "icon"))
                };
              }, function() {
                return Spacebars.include(view.lookupTemplate("icon"));
              }), "\n\t\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(Spacebars.dot(view.lookup("item"), "name"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
                class: "rc-popover__item-text"
              }, Blaze.View("lookup:item.name", function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("item"), "name"));
              })), "\n\t\t\t\t\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(Spacebars.dot(view.lookup("item"), "select"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
                class: "rc-popover__input"
              }, "\n\t\t\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
                return {
                  title: Spacebars.call(Spacebars.dot(view.lookup("item"), "selectTitle")),
                  name: Spacebars.call(Spacebars.dot(view.lookup("item"), "selectName")),
                  options: Spacebars.call(Spacebars.dot(view.lookup("item"), "selectOptions"))
                };
              }, function() {
                return Spacebars.include(view.lookupTemplate("selectDropdown"));
              }), "\n\t\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t\t"), HTML.Raw('\n\t\t\t\t\t\t\t<span class="rc-popover__divider"></span>\n\t\t\t\t\t\t') ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"AccountBox.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/AccountBox.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  AccountBox: function () {
    return AccountBox;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 3);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 4);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 5);
var appLayout;
module.link("../../../../client/lib/appLayout", {
  appLayout: function (v) {
    appLayout = v;
  }
}, 6);
var SideNav;
module.link("./SideNav", {
  SideNav: function (v) {
    SideNav = v;
  }
}, 7);

var AccountBox = function () {
  var status = 0;
  var items = new ReactiveVar([]);

  function setStatus(status, statusText) {
    return Meteor.call('setUserStatus', status, statusText);
  }

  function open() {
    if (SideNav.flexStatus()) {
      SideNav.closeFlex();
      return;
    }

    status = 1;
  }

  function close() {
    status = 0;
  }

  function toggle() {
    if (status) {
      return close();
    }

    return open();
  }

  function openFlex() {
    status = 0;
  }
  /*
   * @param newOption:
   *   name: Button label
   *   icon: Button icon
   *   class: Class of the item
   *   permissions: Which permissions a user should have (all of them) to see this item
   */


  function addItem(newItem) {
    return Tracker.nonreactive(function () {
      var actual = items.get();
      actual.push(newItem);
      return items.set(actual);
    });
  }

  function checkCondition(item) {
    return item.condition == null || item.condition();
  }

  function getItems() {
    return _.filter(items.get(), function (item) {
      if (checkCondition(item)) {
        return true;
      }
    });
  }

  function addRoute(newRoute, router) {
    var wait = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};

    if (router == null) {
      router = FlowRouter;
    }

    var container = newRoute.customContainer ? 'pageCustomContainer' : 'pageContainer';
    var routeConfig = {
      center: container,
      pageTemplate: newRoute.pageTemplate
    };

    if (newRoute.i18nPageTitle != null) {
      routeConfig.i18nPageTitle = newRoute.i18nPageTitle;
    }

    if (newRoute.pageTitle != null) {
      routeConfig.pageTitle = newRoute.pageTitle;
    }

    return router.route(newRoute.path, {
      name: newRoute.name,
      action: function () {
        function _callee() {
          return _regeneratorRuntime.async(function () {
            function _callee$(_context) {
              while (1) {
                switch (_context.prev = _context.next) {
                  case 0:
                    _context.next = 2;
                    return _regeneratorRuntime.awrap(wait());

                  case 2:
                    Session.set('openedRoom');
                    appLayout.renderMainLayout(routeConfig);

                  case 4:
                  case "end":
                    return _context.stop();
                }
              }
            }

            return _callee$;
          }(), null, null, null, Promise);
        }

        return _callee;
      }(),
      triggersEnter: [function () {
        if (newRoute.sideNav != null) {
          SideNav.setFlex(newRoute.sideNav);
          SideNav.openFlex();
        }
      }]
    });
  }

  return {
    setStatus: setStatus,
    toggle: toggle,
    open: open,
    close: close,
    openFlex: openFlex,
    addRoute: addRoute,
    addItem: addItem,
    getItems: getItems
  };
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"IframeLogin.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/IframeLogin.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  IframeLogin: function () {
    return IframeLogin;
  },
  iframeLogin: function () {
    return iframeLogin;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Match;
module.link("meteor/check", {
  Match: function (v) {
    Match = v;
  }
}, 1);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 2);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 3);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 4);
var HTTP;
module.link("meteor/http", {
  HTTP: function (v) {
    HTTP = v;
  }
}, 5);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 6);

var IframeLogin = /*#__PURE__*/function () {
  function IframeLogin() {
    var _this = this;

    this.enabled = false;
    this.reactiveIframeUrl = new ReactiveVar();
    this.reactiveEnabled = new ReactiveVar();
    this.iframeUrl = undefined;
    this.apiUrl = undefined;
    this.apiMethod = undefined;
    Tracker.autorun(function (c) {
      _this.enabled = settings.get('Accounts_iframe_enabled');

      _this.reactiveEnabled.set(_this.enabled);

      _this.iframeUrl = settings.get('Accounts_iframe_url');
      _this.apiUrl = settings.get('Accounts_Iframe_api_url');
      _this.apiMethod = settings.get('Accounts_Iframe_api_method');

      if (_this.enabled === false) {
        return c.stop();
      }

      if (_this.enabled === true && _this.iframeUrl && _this.apiUrl && _this.apiMethod) {
        c.stop();

        if (!Accounts._storedLoginToken()) {
          _this.tryLogin(function () {});
        }
      }
    });
  }

  var _proto = IframeLogin.prototype;

  _proto.tryLogin = function () {
    function tryLogin(callback) {
      var _this2 = this;

      if (!this.enabled) {
        return;
      }

      if (!this.iframeUrl || !this.apiUrl || !this.apiMethod) {
        return;
      }

      console.log('tryLogin');
      var options = {
        beforeSend: function (xhr) {
          xhr.withCredentials = true;
        }
      };
      var iframeUrl = this.iframeUrl;
      var separator = '?';

      if (iframeUrl.indexOf('?') > -1) {
        separator = '&';
      }

      if (navigator.userAgent.indexOf('Electron') > -1) {
        iframeUrl += separator + "client=electron";
      }

      HTTP.call(this.apiMethod, this.apiUrl, options, function (error, result) {
        console.log(error, result);

        if (result && result.data && (result.data.token || result.data.loginToken)) {
          _this2.loginWithToken(result.data, function (error, result) {
            if (error) {
              _this2.reactiveIframeUrl.set(iframeUrl);
            } else {
              _this2.reactiveIframeUrl.set();
            }

            callback(error, result);
          });
        } else {
          _this2.reactiveIframeUrl.set(iframeUrl);

          callback(error, result);
        }
      });
    }

    return tryLogin;
  }();

  _proto.loginWithToken = function () {
    function loginWithToken(tokenData, callback) {
      if (!this.enabled) {
        return;
      }

      if (Match.test(tokenData, String)) {
        tokenData = {
          token: tokenData
        };
      }

      console.log('loginWithToken');

      if (tokenData.loginToken) {
        return Meteor.loginWithToken(tokenData.loginToken, callback);
      }

      Accounts.callLoginMethod({
        methodArguments: [{
          iframe: true,
          token: tokenData.token
        }],
        userCallback: callback
      });
    }

    return loginWithToken;
  }();

  return IframeLogin;
}();

var iframeLogin = new IframeLogin();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"MessageAction.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/MessageAction.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 1);
module.export({
  addMessageToList: function () {
    return addMessageToList;
  },
  MessageAction: function () {
    return MessageAction;
  }
});

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 1);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 2);
var mem;
module.link("mem", {
  "default": function (v) {
    mem = v;
  }
}, 3);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 4);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 5);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 6);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 7);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 8);
var messageArgs;
module.link("./messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 9);
var roomTypes;
module.link("../../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 10);
var Messages, Rooms, Subscriptions;
module.link("../../../models/client", {
  Messages: function (v) {
    Messages = v;
  },
  Rooms: function (v) {
    Rooms = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 11);
var hasAtLeastOnePermission, hasPermission;
module.link("../../../authorization/client", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  },
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 12);
var modal;
module.link("./modal", {
  modal: function (v) {
    modal = v;
  }
}, 13);
var imperativeModal;
module.link("../../../../client/lib/imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 14);
var ReactionList;
module.link("../../../../client/views/room/modals/ReactionListModal", {
  "default": function (v) {
    ReactionList = v;
  }
}, 15);
var call;
module.link("../../../../client/lib/utils/call", {
  call: function (v) {
    call = v;
  }
}, 16);
var canDeleteMessage;
module.link("../../../../client/lib/utils/canDeleteMessage", {
  canDeleteMessage: function (v) {
    canDeleteMessage = v;
  }
}, 17);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 18);

var addMessageToList = function (messagesList, message) {
  // checks if the message is not already on the list
  if (!messagesList.find(function (_ref) {
    var _id = _ref._id;
    return _id === message._id;
  })) {
    messagesList.push(message);
  }

  return messagesList;
};

var MessageAction = new ( /*#__PURE__*/function () {
  /*
   	config expects the following keys (only id is mandatory):
   		id (mandatory)
   		icon: string
   		label: string
   		action: function(event, instance)
   		condition: function(message)
  		order: integer
  		group: string (message or menu)
    */
  function _class2() {
    this._getButtons = mem(function () {
      return _.sortBy(_.toArray(this.buttons.get()), 'order');
    });
    this._getButtonsByGroup = mem(function (group) {
      return this._getButtons().filter(function (button) {
        return Array.isArray(button.group) ? button.group.includes(group) : button.group === group;
      });
    });
    this.buttons = new ReactiveVar({});
  }

  var _proto = _class2.prototype;

  _proto.addButton = function () {
    function addButton(config) {
      var _this = this;

      if (!config || !config.id) {
        return false;
      }

      if (!config.group) {
        config.group = 'menu';
      }

      if (config.condition) {
        config.condition = mem(config.condition, {
          maxAge: 1000,
          cacheKey: JSON.stringify
        });
      }

      return Tracker.nonreactive(function () {
        var btns = _this.buttons.get();

        btns[config.id] = config;
        mem.clear(_this._getButtons);
        mem.clear(_this._getButtonsByGroup);
        return _this.buttons.set(btns);
      });
    }

    return addButton;
  }();

  _proto.removeButton = function () {
    function removeButton(id) {
      var _this2 = this;

      return Tracker.nonreactive(function () {
        var btns = _this2.buttons.get();

        delete btns[id];
        mem.clear(_this2._getButtons);
        mem.clear(_this2._getButtonsByGroup);
        return _this2.buttons.set(btns);
      });
    }

    return removeButton;
  }();

  _proto.updateButton = function () {
    function updateButton(id, config) {
      var _this3 = this;

      return Tracker.nonreactive(function () {
        var btns = _this3.buttons.get();

        if (btns[id]) {
          btns[id] = _.extend(btns[id], config);
          mem.clear(_this3._getButtons);
          mem.clear(_this3._getButtonsByGroup);
          return _this3.buttons.set(btns);
        }
      });
    }

    return updateButton;
  }();

  _proto.getButtonById = function () {
    function getButtonById(id) {
      var allButtons = this.buttons.get();
      return allButtons[id];
    }

    return getButtonById;
  }();

  _proto.getButtons = function () {
    function getButtons(message, context, group) {
      var allButtons = group ? this._getButtonsByGroup(group) : this._getButtons();

      if (message) {
        return allButtons.filter(function (button) {
          if (button.context == null || button.context.includes(context)) {
            return button.condition == null || button.condition(message, context);
          }

          return false;
        });
      }

      return allButtons;
    }

    return getButtons;
  }();

  _proto.resetButtons = function () {
    function resetButtons() {
      mem.clear(this._getButtons);
      mem.clear(this._getButtonsByGroup);
      return this.buttons.set({});
    }

    return resetButtons;
  }();

  _proto.getPermaLink = function () {
    function getPermaLink(msgId) {
      var msg, roomData, subData, roomURL;
      return _regeneratorRuntime.async(function () {
        function getPermaLink$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (msgId) {
                  _context.next = 2;
                  break;
                }

                throw new Error('invalid-parameter');

              case 2:
                _context.t0 = Messages.findOne(msgId);

                if (_context.t0) {
                  _context.next = 7;
                  break;
                }

                _context.next = 6;
                return _regeneratorRuntime.awrap(call('getSingleMessage', msgId));

              case 6:
                _context.t0 = _context.sent;

              case 7:
                msg = _context.t0;

                if (msg) {
                  _context.next = 10;
                  break;
                }

                throw new Error('message-not-found');

              case 10:
                roomData = Rooms.findOne({
                  _id: msg.rid
                });

                if (roomData) {
                  _context.next = 13;
                  break;
                }

                throw new Error('room-not-found');

              case 13:
                subData = Subscriptions.findOne({
                  'rid': roomData._id,
                  'u._id': Meteor.userId()
                });
                roomURL = roomTypes.getURL(roomData.t, subData || roomData);
                return _context.abrupt("return", roomURL + "?msg=" + msgId);

              case 16:
              case "end":
                return _context.stop();
            }
          }
        }

        return getPermaLink$;
      }(), null, null, null, Promise);
    }

    return getPermaLink;
  }();

  return _class2;
}())();
Meteor.startup(function () {
  function _callee2() {
    var _await$module$dynamic, chatMessages, getChatMessagesFrom;

    return _regeneratorRuntime.async(function () {
      function _callee2$(_context3) {
        while (1) {
          switch (_context3.prev = _context3.next) {
            case 0:
              _context3.next = 2;
              return _regeneratorRuntime.awrap(module.dynamicImport('../../../ui'));

            case 2:
              _await$module$dynamic = _context3.sent;
              chatMessages = _await$module$dynamic.chatMessages;

              getChatMessagesFrom = function (msg) {
                var _msg$rid = msg.rid,
                    rid = _msg$rid === void 0 ? Session.get('openedRoom') : _msg$rid,
                    _msg$tmid = msg.tmid,
                    tmid = _msg$tmid === void 0 ? msg._id : _msg$tmid;
                return chatMessages[rid + "-" + tmid] || chatMessages[rid];
              };

              MessageAction.addButton({
                id: 'reply-directly',
                icon: 'reply-directly',
                label: 'Reply_in_direct_message',
                context: ['message', 'message-mobile', 'threads'],
                action: function () {
                  var _messageArgs = messageArgs(this),
                      msg = _messageArgs.msg;

                  roomTypes.openRouteLink('d', {
                    name: msg.u.username
                  }, _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), {}, {
                    reply: msg._id
                  }));
                },
                condition: function (_ref2) {
                  var subscription = _ref2.subscription,
                      room = _ref2.room,
                      msg = _ref2.msg,
                      u = _ref2.u;

                  if (subscription == null) {
                    return false;
                  }

                  if (room.t === 'd' || room.t === 'l') {
                    return false;
                  } // Check if we already have a DM started with the message user (not ourselves) or we can start one


                  if (u._id !== msg.u._id && !hasPermission('create-d')) {
                    var dmRoom = Rooms.findOne({
                      _id: [u._id, msg.u._id].sort().join('')
                    });

                    if (!dmRoom || !Subscriptions.findOne({
                      'rid': dmRoom._id,
                      'u._id': u._id
                    })) {
                      return false;
                    }
                  }

                  return true;
                },
                order: 0,
                group: 'menu'
              });
              MessageAction.addButton({
                id: 'quote-message',
                icon: 'quote',
                label: 'Quote',
                context: ['message', 'message-mobile', 'threads'],
                action: function () {
                  var _messageArgs2 = messageArgs(this),
                      message = _messageArgs2.msg;

                  var _getChatMessagesFrom = getChatMessagesFrom(message),
                      input = _getChatMessagesFrom.input;

                  var $input = $(input);
                  var messages = $input.data('reply') || [];
                  messages = addMessageToList(messages, message, input);
                  $input.focus().data('mention-user', false).data('reply', messages).trigger('dataChange');
                },
                condition: function (_ref3) {
                  var subscription = _ref3.subscription,
                      room = _ref3.room;

                  if (subscription == null) {
                    return false;
                  }

                  var isLivechatRoom = roomTypes.isLivechatRoom(room.t);

                  if (isLivechatRoom) {
                    return false;
                  }

                  return true;
                },
                order: -3,
                group: ['message', 'menu']
              });
              MessageAction.addButton({
                id: 'permalink',
                icon: 'permalink',
                label: 'Get_link',
                classes: 'clipboard',
                context: ['message', 'message-mobile', 'threads'],
                action: function () {
                  function _callee() {
                    var _messageArgs3, message, permalink;

                    return _regeneratorRuntime.async(function () {
                      function _callee$(_context2) {
                        while (1) {
                          switch (_context2.prev = _context2.next) {
                            case 0:
                              _messageArgs3 = messageArgs(this), message = _messageArgs3.msg;
                              _context2.next = 3;
                              return _regeneratorRuntime.awrap(MessageAction.getPermaLink(message._id));

                            case 3:
                              permalink = _context2.sent;
                              navigator.clipboard.writeText(permalink);
                              dispatchToastMessage({
                                type: 'success',
                                message: TAPi18n.__('Copied')
                              });

                            case 6:
                            case "end":
                              return _context2.stop();
                          }
                        }
                      }

                      return _callee$;
                    }(), null, this, null, Promise);
                  }

                  return _callee;
                }(),
                condition: function (_ref4) {
                  var subscription = _ref4.subscription;
                  return !!subscription;
                },
                order: 4,
                group: 'menu'
              });
              MessageAction.addButton({
                id: 'copy',
                icon: 'copy',
                label: 'Copy',
                classes: 'clipboard',
                context: ['message', 'message-mobile', 'threads'],
                action: function () {
                  var _messageArgs4 = messageArgs(this),
                      msg = _messageArgs4.msg.msg;

                  navigator.clipboard.writeText(msg);
                  dispatchToastMessage({
                    type: 'success',
                    message: TAPi18n.__('Copied')
                  });
                },
                condition: function (_ref5) {
                  var subscription = _ref5.subscription;
                  return !!subscription;
                },
                order: 5,
                group: 'menu'
              });
              MessageAction.addButton({
                id: 'edit-message',
                icon: 'edit',
                label: 'Edit',
                context: ['message', 'message-mobile', 'threads'],
                action: function () {
                  var _messageArgs5 = messageArgs(this),
                      msg = _messageArgs5.msg;

                  getChatMessagesFrom(msg).edit(document.getElementById(msg.tmid ? "thread-" + msg._id : msg._id));
                },
                condition: function (_ref6) {
                  var message = _ref6.msg,
                      subscription = _ref6.subscription,
                      settings = _ref6.settings;

                  if (subscription == null) {
                    return false;
                  }

                  var hasPermission = hasAtLeastOnePermission('edit-message', message.rid);
                  var isEditAllowed = settings.Message_AllowEditing;
                  var editOwn = message.u && message.u._id === Meteor.userId();

                  if (!(hasPermission || isEditAllowed && editOwn)) {
                    return;
                  }

                  var blockEditInMinutes = settings.Message_AllowEditing_BlockEditInMinutes;

                  if (blockEditInMinutes) {
                    var msgTs;

                    if (message.ts != null) {
                      msgTs = moment(message.ts);
                    }

                    var currentTsDiff;

                    if (msgTs != null) {
                      currentTsDiff = moment().diff(msgTs, 'minutes');
                    }

                    return currentTsDiff < blockEditInMinutes;
                  }

                  return true;
                },
                order: 6,
                group: 'menu'
              });
              MessageAction.addButton({
                id: 'delete-message',
                icon: 'trash',
                label: 'Delete',
                context: ['message', 'message-mobile', 'threads'],
                color: 'alert',
                action: function () {
                  var _messageArgs6 = messageArgs(this),
                      msg = _messageArgs6.msg;

                  getChatMessagesFrom(msg).confirmDeleteMsg(msg);
                },
                condition: function (_ref7) {
                  var message = _ref7.msg,
                      subscription = _ref7.subscription,
                      room = _ref7.room;

                  if (!subscription) {
                    return false;
                  }

                  var isLivechatRoom = roomTypes.isLivechatRoom(room.t);

                  if (isLivechatRoom) {
                    return false;
                  }

                  return canDeleteMessage({
                    rid: message.rid,
                    ts: message.ts,
                    uid: message.u._id
                  });
                },
                order: 18,
                group: 'menu'
              });
              MessageAction.addButton({
                id: 'report-message',
                icon: 'report',
                label: 'Report',
                context: ['message', 'message-mobile', 'threads'],
                color: 'alert',
                action: function () {
                  var _messageArgs7 = messageArgs(this),
                      message = _messageArgs7.msg;

                  modal.open({
                    title: TAPi18n.__('Report_this_message_question_mark'),
                    text: message.msg,
                    inputPlaceholder: TAPi18n.__('Why_do_you_want_to_report_question_mark'),
                    type: 'input',
                    showCancelButton: true,
                    confirmButtonColor: '#DD6B55',
                    confirmButtonText: TAPi18n.__('Report_exclamation_mark'),
                    cancelButtonText: TAPi18n.__('Cancel'),
                    closeOnConfirm: false,
                    html: false
                  }, function (inputValue) {
                    if (inputValue === false) {
                      return false;
                    }

                    if (!inputValue.trim()) {
                      modal.showInputError(TAPi18n.__('You_need_to_write_something'));
                      return false;
                    }

                    Meteor.call('reportMessage', message._id, inputValue);
                    modal.open({
                      title: TAPi18n.__('Report_sent'),
                      text: TAPi18n.__('Thank_you_exclamation_mark'),
                      type: 'success',
                      timer: 1000,
                      showConfirmButton: false
                    });
                  });
                },
                condition: function (_ref8) {
                  var subscription = _ref8.subscription,
                      room = _ref8.room;
                  var isLivechatRoom = roomTypes.isLivechatRoom(room.t);

                  if (isLivechatRoom) {
                    return false;
                  }

                  return Boolean(subscription);
                },
                order: 17,
                group: 'menu'
              });
              MessageAction.addButton({
                id: 'reaction-list',
                icon: 'emoji',
                label: 'Reactions',
                context: ['message', 'message-mobile', 'threads'],
                action: function (_, _ref9) {
                  var tabBar = _ref9.tabBar,
                      rid = _ref9.rid;

                  var _messageArgs8 = messageArgs(this),
                      reactions = _messageArgs8.msg.reactions;

                  imperativeModal.open({
                    component: ReactionList,
                    props: {
                      reactions: reactions,
                      rid: rid,
                      tabBar: tabBar,
                      onClose: imperativeModal.close
                    }
                  });
                },
                condition: function (_ref10) {
                  var reactions = _ref10.msg.reactions;
                  return !!reactions;
                },
                order: 18,
                group: 'menu'
              });

            case 13:
            case "end":
              return _context3.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomHistoryManager.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/RoomHistoryManager.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["_id"];

var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 2);

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 3);
module.export({
  normalizeThreadMessage: function () {
    return normalizeThreadMessage;
  },
  waitUntilWrapperExists: function () {
    return waitUntilWrapperExists;
  },
  upsertMessage: function () {
    return upsertMessage;
  },
  upsertMessageBulk: function () {
    return upsertMessageBulk;
  },
  RoomHistoryManager: function () {
    return RoomHistoryManager;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 3);
var uuidv4;
module.link("uuid", {
  v4: function (v) {
    uuidv4 = v;
  }
}, 4);
var differenceInMilliseconds;
module.link("date-fns/differenceInMilliseconds", {
  "default": function (v) {
    differenceInMilliseconds = v;
  }
}, 5);
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 6);
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 7);
var RoomManager;
module.link("./RoomManager", {
  RoomManager: function (v) {
    RoomManager = v;
  }
}, 8);
var readMessage;
module.link("./readMessages", {
  readMessage: function (v) {
    readMessage = v;
  }
}, 9);
var renderMessageBody;
module.link("../../../../client/lib/utils/renderMessageBody", {
  renderMessageBody: function (v) {
    renderMessageBody = v;
  }
}, 10);
var getConfig;
module.link("../../../../client/lib/utils/getConfig", {
  getConfig: function (v) {
    getConfig = v;
  }
}, 11);
var ChatMessage, ChatSubscription, ChatRoom;
module.link("../../../models", {
  ChatMessage: function (v) {
    ChatMessage = v;
  },
  ChatSubscription: function (v) {
    ChatSubscription = v;
  },
  ChatRoom: function (v) {
    ChatRoom = v;
  }
}, 12);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 13);
var filterMarkdown;
module.link("../../../markdown/lib/markdown", {
  filterMarkdown: function (v) {
    filterMarkdown = v;
  }
}, 14);
var getUserPreference;
module.link("../../../utils/client", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 15);
var onClientMessageReceived;
module.link("../../../../client/lib/onClientMessageReceived", {
  onClientMessageReceived: function (v) {
    onClientMessageReceived = v;
  }
}, 16);

var normalizeThreadMessage = function (_ref) {
  var message = _extends({}, _ref);

  if (message.msg) {
    message.msg = filterMarkdown(message.msg);
    delete message.mentions;
    return renderMessageBody(message).replace(/<br\s?\\?>/g, ' ');
  }

  if (message.attachments) {
    var attachment = message.attachments.find(function (attachment) {
      return attachment.title || attachment.description;
    });

    if (attachment && attachment.description) {
      return escapeHTML(attachment.description);
    }

    if (attachment && attachment.title) {
      return escapeHTML(attachment.title);
    }
  }
};

var waitUntilWrapperExists = function () {
  function _callee() {
    var selector,
        _args = arguments;
    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              selector = _args.length > 0 && _args[0] !== undefined ? _args[0] : '.messages-box .wrapper';
              return _context.abrupt("return", document.querySelector(selector) || new Promise(function (resolve) {
                var observer = new MutationObserver(function (mutations, obs) {
                  var element = document.querySelector(selector);

                  if (element) {
                    obs.disconnect(); // stop observing

                    // stop observing
                    return resolve(element);
                  }
                });
                observer.observe(document, {
                  childList: true,
                  subtree: true
                });
              }));

            case 2:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}();

var upsertMessage = function () {
  function _callee2(_ref2) {
    var msg,
        subscription,
        _ref2$uid,
        uid,
        collection,
        userId,
        _msg,
        _id,
        messageToUpsert,
        _args2 = arguments;

    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              msg = _ref2.msg, subscription = _ref2.subscription, _ref2$uid = _ref2.uid, uid = _ref2$uid === void 0 ? Tracker.nonreactive(function () {
                return Meteor.userId();
              }) : _ref2$uid;
              collection = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : ChatMessage;
              userId = msg.u && msg.u._id;

              if (subscription && subscription.ignored && subscription.ignored.indexOf(userId) > -1) {
                msg.ignored = true;
              } // const roles = [
              // 	(userId && UserRoles.findOne(userId, { fields: { roles: 1 } })) || {},
              // 	(userId && RoomRoles.findOne({ rid: msg.rid, 'u._id': userId })) || {},
              // ].map((e) => e.roles);
              // msg.roles = _.union.apply(_.union, roles);


              if (msg.t === 'e2e' && !msg.file) {
                msg.e2e = 'pending';
              }

              _context2.next = 7;
              return _regeneratorRuntime.awrap(onClientMessageReceived(msg));

            case 7:
              _context2.t0 = _context2.sent;

              if (_context2.t0) {
                _context2.next = 10;
                break;
              }

              _context2.t0 = msg;

            case 10:
              msg = _context2.t0;
              _msg = msg, _id = _msg._id, messageToUpsert = _objectWithoutProperties(_msg, _excluded);

              if (msg.tcount) {
                collection.direct.update({
                  tmid: _id
                }, {
                  $set: {
                    following: msg.replies && msg.replies.indexOf(uid) > -1,
                    threadMsg: normalizeThreadMessage(messageToUpsert),
                    repliesCount: msg.tcount
                  }
                }, {
                  multi: true
                });
              }

              return _context2.abrupt("return", collection.direct.upsert({
                _id: _id
              }, messageToUpsert));

            case 14:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();

function upsertMessageBulk(_ref3) {
  var msgs = _ref3.msgs,
      subscription = _ref3.subscription;
  var collection = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ChatMessage;
  var uid = Tracker.nonreactive(function () {
    return Meteor.userId();
  });
  var _ChatMessage = ChatMessage,
      queries = _ChatMessage.queries;
  collection.queries = [];
  msgs.forEach(function (msg, index) {
    if (index === msgs.length - 1) {
      ChatMessage.queries = queries;
    }

    upsertMessage({
      msg: msg,
      subscription: subscription,
      uid: uid
    }, collection);
  });
}

var defaultLimit = parseInt(getConfig('roomListLimit')) || 50;

var waitAfterFlush = function (fn) {
  return setTimeout(function () {
    return Tracker.afterFlush(fn);
  }, 10);
};

var RoomHistoryManager = new ( /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(_class, _Emitter);

  function _class() {
    var _this;

    _this = _Emitter.call(this) || this;
    _this.histories = {};
    _this.requestsList = [];
    return _this;
  }

  var _proto = _class.prototype;

  _proto.getRoom = function () {
    function getRoom(rid) {
      if (!this.histories[rid]) {
        this.histories[rid] = {
          hasMore: new ReactiveVar(true),
          hasMoreNext: new ReactiveVar(false),
          isLoading: new ReactiveVar(false),
          unreadNotLoaded: new ReactiveVar(0),
          firstUnread: new ReactiveVar(),
          loaded: undefined
        };
      }

      return this.histories[rid];
    }

    return getRoom;
  }();

  _proto.queue = function () {
    function queue() {
      var _this2 = this;

      return _regeneratorRuntime.async(function () {
        function queue$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                return _context3.abrupt("return", new Promise(function (resolve) {
                  var requestId = uuidv4();

                  var done = function () {
                    _this2.lastRequest = new Date();
                    resolve();
                  };

                  if (_this2.requestsList.length === 0) {
                    return _this2.run(done);
                  }

                  _this2.requestsList.push(requestId);

                  _this2.once(requestId, done);
                }));

              case 1:
              case "end":
                return _context3.stop();
            }
          }
        }

        return queue$;
      }(), null, null, null, Promise);
    }

    return queue;
  }();

  _proto.run = function () {
    function run(fn) {
      var difference = differenceInMilliseconds(new Date(), this.lastRequest);

      if (!this.lastRequest || difference > 500) {
        return fn();
      }

      return setTimeout(fn, 500 - difference);
    }

    return run;
  }();

  _proto.unqueue = function () {
    function unqueue() {
      var _this3 = this;

      var requestId = this.requestsList.pop();

      if (!requestId) {
        return;
      }

      this.run(function () {
        return _this3.emit(requestId);
      });
    }

    return unqueue;
  }();

  _proto.getMore = function () {
    function getMore(rid) {
      var limit,
          ts,
          room,
          lastMessage,
          ls,
          typeName,
          subscription,
          curRoomDoc,
          showMessageInMainThread,
          result,
          previousHeight,
          scroll,
          _result$messages,
          messages,
          wrapper,
          visibleMessages,
          _args4 = arguments;

      return _regeneratorRuntime.async(function () {
        function getMore$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                limit = _args4.length > 1 && _args4[1] !== undefined ? _args4[1] : defaultLimit;
                room = this.getRoom(rid);

                if (!(room.hasMore.curValue !== true)) {
                  _context4.next = 4;
                  break;
                }

                return _context4.abrupt("return");

              case 4:
                room.isLoading.set(true);
                _context4.next = 7;
                return _regeneratorRuntime.awrap(this.queue());

              case 7:
                // ScrollListener.setLoader true
                lastMessage = ChatMessage.findOne({
                  rid: rid,
                  _hidden: {
                    $ne: true
                  }
                }, {
                  sort: {
                    ts: 1
                  }
                }); // lastMessage ?= ChatMessage.findOne({rid: rid}, {sort: {ts: 1}})

                if (lastMessage) {
                  ts = lastMessage.ts;
                } else {
                  ts = undefined;
                }

                ls = undefined;
                typeName = undefined;
                subscription = ChatSubscription.findOne({
                  rid: rid
                });

                if (subscription) {
                  ls = subscription.ls;
                  typeName = subscription.t + subscription.name;
                } else {
                  curRoomDoc = ChatRoom.findOne({
                    _id: rid
                  });
                  typeName = (curRoomDoc ? curRoomDoc.t : undefined) + (curRoomDoc ? curRoomDoc.name : undefined);
                }

                showMessageInMainThread = getUserPreference(Meteor.userId(), 'showMessageInMainThread', false);
                _context4.next = 16;
                return _regeneratorRuntime.awrap(callWithErrorHandling('loadHistory', rid, ts, limit, ls, showMessageInMainThread));

              case 16:
                result = _context4.sent;
                this.unqueue();
                _result$messages = result.messages, messages = _result$messages === void 0 ? [] : _result$messages;
                room.unreadNotLoaded.set(result.unreadNotLoaded);
                room.firstUnread.set(result.firstUnread);
                _context4.next = 23;
                return _regeneratorRuntime.awrap(waitUntilWrapperExists());

              case 23:
                wrapper = _context4.sent;

                if (wrapper) {
                  previousHeight = wrapper.scrollHeight;
                  scroll = wrapper.scrollTop;
                }

                upsertMessageBulk({
                  msgs: messages.filter(function (msg) {
                    return msg.t !== 'command';
                  }),
                  subscription: subscription
                });

                if (!room.loaded) {
                  room.loaded = 0;
                }

                visibleMessages = messages.filter(function (msg) {
                  return !msg.tmid || showMessageInMainThread || msg.tshow;
                });
                room.loaded += visibleMessages.length;

                if (messages.length < limit) {
                  room.hasMore.set(false);
                }

                if (!(room.hasMore.get() && (visibleMessages.length === 0 || room.loaded < limit))) {
                  _context4.next = 32;
                  break;
                }

                return _context4.abrupt("return", this.getMore(rid));

              case 32:
                waitAfterFlush(function () {
                  var heightDiff = wrapper.scrollHeight - previousHeight;
                  wrapper.scrollTop = scroll + heightDiff;
                });
                room.isLoading.set(false);
                waitAfterFlush(function () {
                  readMessage.refreshUnreadMark(rid);
                  return RoomManager.updateMentionsMarksOfRoom(typeName);
                });

              case 35:
              case "end":
                return _context4.stop();
            }
          }
        }

        return getMore$;
      }(), null, this, null, Promise);
    }

    return getMore;
  }();

  _proto.getMoreNext = function () {
    function getMoreNext(rid) {
      var limit,
          room,
          instance,
          lastMessage,
          typeName,
          subscription,
          curRoomDoc,
          ts,
          result,
          _args5 = arguments;
      return _regeneratorRuntime.async(function () {
        function getMoreNext$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                limit = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : defaultLimit;
                room = this.getRoom(rid);

                if (!(room.hasMoreNext.curValue !== true)) {
                  _context5.next = 4;
                  break;
                }

                return _context5.abrupt("return");

              case 4:
                _context5.next = 6;
                return _regeneratorRuntime.awrap(this.queue());

              case 6:
                instance = Blaze.getView($('.messages-box .wrapper')[0]).templateInstance();
                instance.atBottom = false;
                room.isLoading.set(true);
                lastMessage = ChatMessage.findOne({
                  rid: rid,
                  _hidden: {
                    $ne: true
                  }
                }, {
                  sort: {
                    ts: -1
                  }
                });
                typeName = undefined;
                subscription = ChatSubscription.findOne({
                  rid: rid
                });

                if (subscription) {
                  // const { ls } = subscription;
                  typeName = subscription.t + subscription.name;
                } else {
                  curRoomDoc = ChatRoom.findOne({
                    _id: rid
                  });
                  typeName = (curRoomDoc ? curRoomDoc.t : undefined) + (curRoomDoc ? curRoomDoc.name : undefined);
                }

                ts = lastMessage.ts;

                if (!ts) {
                  _context5.next = 24;
                  break;
                }

                _context5.next = 17;
                return _regeneratorRuntime.awrap(callWithErrorHandling('loadNextMessages', rid, ts, limit));

              case 17:
                result = _context5.sent;
                upsertMessageBulk({
                  msgs: Array.from(result.messages).filter(function (msg) {
                    return msg.t !== 'command';
                  }),
                  subscription: subscription
                });
                Meteor.defer(function () {
                  return RoomManager.updateMentionsMarksOfRoom(typeName);
                });
                room.isLoading.set(false);

                if (!room.loaded) {
                  room.loaded = 0;
                }

                room.loaded += result.messages.length;

                if (result.messages.length < limit) {
                  room.hasMoreNext.set(false);
                }

              case 24:
                _context5.next = 26;
                return _regeneratorRuntime.awrap(this.unqueue());

              case 26:
              case "end":
                return _context5.stop();
            }
          }
        }

        return getMoreNext$;
      }(), null, this, null, Promise);
    }

    return getMoreNext;
  }();

  _proto.getSurroundingMessages = function () {
    function getSurroundingMessages(message) {
      var limit,
          w,
          instance,
          msgElement,
          wrapper,
          pos,
          room,
          typeName,
          subscription,
          curRoomDoc,
          _args6 = arguments;
      return _regeneratorRuntime.async(function () {
        function getSurroundingMessages$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                limit = _args6.length > 1 && _args6[1] !== undefined ? _args6[1] : defaultLimit;

                if (!(!message || !message.rid)) {
                  _context6.next = 3;
                  break;
                }

                return _context6.abrupt("return");

              case 3:
                _context6.next = 5;
                return _regeneratorRuntime.awrap(waitUntilWrapperExists());

              case 5:
                w = _context6.sent;
                instance = Blaze.getView(w).templateInstance();

                if (!ChatMessage.findOne({
                  _id: message._id,
                  _hidden: {
                    $ne: true
                  }
                })) {
                  _context6.next = 15;
                  break;
                }

                msgElement = $("#" + message._id, w);

                if (!(msgElement.length === 0)) {
                  _context6.next = 11;
                  break;
                }

                return _context6.abrupt("return");

              case 11:
                wrapper = $('.messages-box .wrapper');
                pos = wrapper.scrollTop() + msgElement.offset().top - wrapper.height() / 2;
                wrapper.animate({
                  scrollTop: pos
                }, 500);
                return _context6.abrupt("return", setTimeout(function () {
                  return msgElement.removeClass('highlight');
                }, 500));

              case 15:
                room = this.getRoom(message.rid);
                room.isLoading.set(true);
                typeName = undefined;
                subscription = ChatSubscription.findOne({
                  rid: message.rid
                });

                if (subscription) {
                  // const { ls } = subscription;
                  typeName = subscription.t + subscription.name;
                } else {
                  curRoomDoc = ChatRoom.findOne({
                    _id: message.rid
                  });
                  typeName = (curRoomDoc ? curRoomDoc.t : undefined) + (curRoomDoc ? curRoomDoc.name : undefined);
                }

                return _context6.abrupt("return", Meteor.call('loadSurroundingMessages', message, limit, function (err, result) {
                  if (!result || !result.messages) {
                    return;
                  }

                  ChatMessage.remove({
                    rid: message.rid
                  });

                  for (var _i = 0, _Array$from = Array.from(result.messages); _i < _Array$from.length; _i++) {
                    var msg = _Array$from[_i];

                    if (msg.t !== 'command') {
                      upsertMessage({
                        msg: msg,
                        subscription: subscription
                      });
                    }
                  }

                  readMessage.refreshUnreadMark(message.rid);
                  RoomManager.updateMentionsMarksOfRoom(typeName);
                  Tracker.afterFlush(function () {
                    var wrapper = $('.messages-box .wrapper');
                    var msgElement = $("#" + message._id, wrapper);
                    var pos = wrapper.scrollTop() + msgElement.offset().top - wrapper.height() / 2;
                    wrapper.animate({
                      scrollTop: pos
                    }, 500);
                    msgElement.addClass('highlight');
                    room.isLoading.set(false);
                    var messages = wrapper[0];
                    instance.atBottom = !result.moreAfter && messages.scrollTop >= messages.scrollHeight - messages.clientHeight;
                    setTimeout(function () {
                      return msgElement.removeClass('highlight');
                    }, 500);
                  });

                  if (!room.loaded) {
                    room.loaded = 0;
                  }

                  room.loaded += result.messages.length;
                  room.hasMore.set(result.moreBefore);
                  return room.hasMoreNext.set(result.moreAfter);
                }));

              case 21:
              case "end":
                return _context6.stop();
            }
          }
        }

        return getSurroundingMessages$;
      }(), null, this, null, Promise);
    }

    return getSurroundingMessages;
  }();

  _proto.hasMore = function () {
    function hasMore(rid) {
      var room = this.getRoom(rid);
      return room.hasMore.get();
    }

    return hasMore;
  }();

  _proto.hasMoreNext = function () {
    function hasMoreNext(rid) {
      var room = this.getRoom(rid);
      return room.hasMoreNext.get();
    }

    return hasMoreNext;
  }();

  _proto.getMoreIfIsEmpty = function () {
    function getMoreIfIsEmpty(rid) {
      var room = this.getRoom(rid);

      if (room.loaded === undefined) {
        return this.getMore(rid);
      }
    }

    return getMoreIfIsEmpty;
  }();

  _proto.isLoading = function () {
    function isLoading(rid) {
      var room = this.getRoom(rid);
      return room.isLoading.get();
    }

    return isLoading;
  }();

  _proto.clear = function () {
    function clear(rid) {
      ChatMessage.remove({
        rid: rid
      });

      if (this.histories[rid]) {
        this.histories[rid].hasMore.set(true);
        this.histories[rid].isLoading.set(false);
        this.histories[rid].loaded = undefined;
      }
    }

    return clear;
  }();

  return _class;
}(Emitter))();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomManager.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/RoomManager.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);
module.export({
  RoomManager: function () {
    return RoomManager;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 4);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 5);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 6);
var fireGlobalEvent;
module.link("../../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 7);
var upsertMessage, RoomHistoryManager;
module.link("./RoomHistoryManager", {
  upsertMessage: function (v) {
    upsertMessage = v;
  },
  RoomHistoryManager: function (v) {
    RoomHistoryManager = v;
  }
}, 8);
var mainReady;
module.link("./mainReady", {
  mainReady: function (v) {
    mainReady = v;
  }
}, 9);
var menu;
module.link("./menu", {
  menu: function (v) {
    menu = v;
  }
}, 10);
var roomTypes;
module.link("../../../utils", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 11);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 12);
var Notifications;
module.link("../../../notifications", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 13);
var CachedChatRoom, ChatMessage, ChatSubscription, CachedChatSubscription, ChatRoom;
module.link("../../../models", {
  CachedChatRoom: function (v) {
    CachedChatRoom = v;
  },
  ChatMessage: function (v) {
    ChatMessage = v;
  },
  ChatSubscription: function (v) {
    ChatSubscription = v;
  },
  CachedChatSubscription: function (v) {
    CachedChatSubscription = v;
  },
  ChatRoom: function (v) {
    ChatRoom = v;
  }
}, 14);
var CachedCollectionManager;
module.link("../../../ui-cached-collection", {
  CachedCollectionManager: function (v) {
    CachedCollectionManager = v;
  }
}, 15);
var getConfig;
module.link("../../../../client/lib/utils/getConfig", {
  getConfig: function (v) {
    getConfig = v;
  }
}, 16);
var ROOM_DATA_STREAM;
module.link("../../../utils/stream/constants", {
  ROOM_DATA_STREAM: function (v) {
    ROOM_DATA_STREAM = v;
  }
}, 17);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 18);
var NewRoomManager;
module.link("../../../../client/lib/RoomManager", {
  RoomManager: function (v) {
    NewRoomManager = v;
  }
}, 19);
var maxRoomsOpen = parseInt(getConfig('maxRoomsOpen')) || 5;

var onDeleteMessageStream = function (msg) {
  ChatMessage.remove({
    _id: msg._id
  }); // remove thread refenrece from deleted message

  ChatMessage.update({
    tmid: msg._id
  }, {
    $unset: {
      tmid: 1
    }
  }, {
    multi: true
  });
};

var onDeleteMessageBulkStream = function (_ref) {
  var rid = _ref.rid,
      ts = _ref.ts,
      excludePinned = _ref.excludePinned,
      ignoreDiscussion = _ref.ignoreDiscussion,
      users = _ref.users;
  var query = {
    rid: rid,
    ts: ts
  };

  if (excludePinned) {
    query.pinned = {
      $ne: true
    };
  }

  if (ignoreDiscussion) {
    query.drid = {
      $exists: false
    };
  }

  if (users && users.length) {
    query['u.username'] = {
      $in: users
    };
  }

  ChatMessage.remove(query);
};

var RoomManager = new function () {
  var openedRooms = {};
  var msgStream = new Meteor.Streamer('room-messages');
  var roomStream = new Meteor.Streamer(ROOM_DATA_STREAM);
  var onlineUsers = new ReactiveVar({});
  var Dep = new Tracker.Dependency();

  var handleTrackSettingsChange = function (msg) {
    var openedRoom = Tracker.nonreactive(function () {
      return Session.get('openedRoom');
    });

    if (openedRoom !== msg.rid) {
      return;
    }

    Tracker.nonreactive(function () {
      if (msg.t === 'room_changed_privacy') {
        var type = FlowRouter.current().route.name === 'channel' ? 'c' : 'p';
        RoomManager.close(type + FlowRouter.getParam('name'));
        var subscription = ChatSubscription.findOne({
          rid: msg.rid
        });
        var route = subscription.t === 'c' ? 'channel' : 'group';
        FlowRouter.go(route, {
          name: subscription.name
        }, FlowRouter.current().queryParams);
      }

      if (msg.t === 'r') {
        var room = ChatRoom.findOne(msg.rid);

        if (room.name !== FlowRouter.getParam('name')) {
          RoomManager.close(room.t + FlowRouter.getParam('name'));
          roomTypes.openRouteLink(room.t, room, FlowRouter.current().queryParams);
        }
      }
    });
  };

  var Cls = /*#__PURE__*/function () {
    function Cls() {}

    Cls.initClass = function () {
      function initClass() {
        this.prototype.openedRooms = openedRooms;
        this.prototype.onlineUsers = onlineUsers;
        this.prototype.roomStream = roomStream;
        this.prototype.computation = Tracker.autorun(function () {
          var ready = CachedChatRoom.ready.get() && mainReady.get();

          if (ready !== true) {
            return;
          }

          var user = Meteor.user();
          Tracker.nonreactive(function () {
            return Object.entries(openedRooms).forEach(function (_ref2) {
              var _ref3 = _slicedToArray(_ref2, 2),
                  typeName = _ref3[0],
                  record = _ref3[1];

              if (record.active !== true || record.ready === true) {
                return;
              }

              var type = typeName.substr(0, 1);
              var name = typeName.substr(1);
              var room = roomTypes.findRoom(type, name, user);

              if (room != null) {
                record.rid = room._id;
                RoomHistoryManager.getMoreIfIsEmpty(room._id);

                if (record.streamActive !== true) {
                  record.streamActive = true;
                  msgStream.on(record.rid, function () {
                    function _callee(msg) {
                      var subscription, isNew;
                      return _regeneratorRuntime.async(function () {
                        function _callee$(_context) {
                          while (1) {
                            switch (_context.prev = _context.next) {
                              case 0:
                                if (!(RoomHistoryManager.hasMoreNext(record.rid) !== false)) {
                                  _context.next = 2;
                                  break;
                                }

                                return _context.abrupt("return");

                              case 2:
                                // Do not load command messages into channel
                                if (msg.t !== 'command') {
                                  subscription = ChatSubscription.findOne({
                                    rid: record.rid
                                  }, {
                                    reactive: false
                                  });
                                  isNew = !ChatMessage.findOne({
                                    _id: msg._id,
                                    temp: {
                                      $ne: true
                                    }
                                  });
                                  upsertMessage({
                                    msg: msg,
                                    subscription: subscription
                                  });
                                  msg.room = {
                                    type: type,
                                    name: name
                                  };

                                  if (isNew) {
                                    menu.updateUnreadBars();
                                    callbacks.run('streamNewMessage', msg);
                                  }
                                }

                                msg.name = room.name;
                                Tracker.afterFlush(function () {
                                  return RoomManager.updateMentionsMarksOfRoom(typeName);
                                });
                                handleTrackSettingsChange(msg);
                                callbacks.run('streamMessage', msg);
                                return _context.abrupt("return", fireGlobalEvent('new-message', msg));

                              case 8:
                              case "end":
                                return _context.stop();
                            }
                          }
                        }

                        return _callee$;
                      }(), null, null, null, Promise);
                    }

                    return _callee;
                  }());
                  Notifications.onRoom(record.rid, 'deleteMessage', onDeleteMessageStream); // eslint-disable-line no-use-before-define

                  Notifications.onRoom(record.rid, 'deleteMessageBulk', onDeleteMessageBulkStream); // eslint-disable-line no-use-before-define
                }
              }

              record.ready = true;
            });
          });
          Dep.changed();
        });
      }

      return initClass;
    }();

    var _proto = Cls.prototype;

    _proto.getOpenedRoomByRid = function () {
      function getOpenedRoomByRid(rid) {
        return Object.keys(openedRooms).map(function (typeName) {
          return openedRooms[typeName];
        }).find(function (openedRoom) {
          return openedRoom.rid === rid;
        });
      }

      return getOpenedRoomByRid;
    }();

    _proto.close = function () {
      function close(typeName) {
        if (openedRooms[typeName]) {
          if (openedRooms[typeName].rid != null) {
            msgStream.removeAllListeners(openedRooms[typeName].rid);
            Notifications.unRoom(openedRooms[typeName].rid, 'deleteMessage', onDeleteMessageStream); // eslint-disable-line no-use-before-define

            Notifications.unRoom(openedRooms[typeName].rid, 'deleteMessageBulk', onDeleteMessageBulkStream); // eslint-disable-line no-use-before-define
          }

          openedRooms[typeName].ready = false;
          openedRooms[typeName].active = false;

          if (openedRooms[typeName].template != null) {
            try {
              Blaze.remove(openedRooms[typeName].template);
            } catch (e) {
              console.error('Error removing template from DOM', e);
            }
          }

          delete openedRooms[typeName].dom;
          delete openedRooms[typeName].template;
          var rid = openedRooms[typeName].rid;
          delete openedRooms[typeName];

          if (rid != null) {
            NewRoomManager.close(rid);
            return RoomHistoryManager.clear(rid);
          }
        }
      }

      return close;
    }();

    _proto.closeOlderRooms = function () {
      function closeOlderRooms() {
        var _this = this;

        if (Object.keys(openedRooms).length <= maxRoomsOpen) {
          return;
        }

        var roomsToClose = _.sortBy(_.values(openedRooms), 'lastSeen').reverse().slice(maxRoomsOpen);

        return Array.from(roomsToClose).map(function (roomToClose) {
          return _this.close(roomToClose.typeName);
        });
      }

      return closeOlderRooms;
    }();

    _proto.closeAllRooms = function () {
      function closeAllRooms() {
        var _this2 = this;

        Object.keys(openedRooms).forEach(function (key) {
          var openedRoom = openedRooms[key];

          _this2.close(openedRoom.typeName);
        });
        Session.set('openedRoom');
      }

      return closeAllRooms;
    }();

    _proto.open = function () {
      function open(typeName) {
        if (openedRooms[typeName] == null) {
          openedRooms[typeName] = {
            typeName: typeName,
            active: false,
            ready: false,
            unreadSince: new ReactiveVar(undefined)
          };
        }

        openedRooms[typeName].lastSeen = new Date();

        if (openedRooms[typeName].ready) {
          this.closeOlderRooms();
        }

        if (CachedChatSubscription.ready.get() === true) {
          if (openedRooms[typeName].active !== true) {
            openedRooms[typeName].active = true;

            if (this.computation) {
              this.computation.invalidate();
            }
          }
        }

        return {
          ready: function () {
            Dep.depend();
            return openedRooms[typeName].ready;
          }
        };
      }

      return open;
    }();

    _proto.existsDomOfRoom = function () {
      function existsDomOfRoom(typeName) {
        var room = openedRooms[typeName];
        return (room != null ? room.dom : undefined) != null;
      }

      return existsDomOfRoom;
    }();

    _proto.updateUserStatus = function () {
      function updateUserStatus(user, status, utcOffset) {
        var onlineUsersValue = onlineUsers.curValue;

        if (status === 'offline') {
          delete onlineUsersValue[user.username];
        } else {
          onlineUsersValue[user.username] = {
            _id: user._id,
            status: status,
            utcOffset: utcOffset
          };
        }

        return onlineUsers.set(onlineUsersValue);
      }

      return updateUserStatus;
    }();

    _proto.updateMentionsMarksOfRoom = function () {
      function updateMentionsMarksOfRoom() {// const [ticksBar] = dom.getElementsByClassName('ticks-bar');
        // const [messagesBox] = dom.getElementsByClassName('messages-box');
        // const scrollTop = $('> .wrapper', messagesBox).scrollTop() - 50;
        // const totalHeight = $(' > .wrapper > ul', messagesBox).height() + 40;
        // if (!ticksBar) {
        // 	return;
        // }
        // // TODO: thread quotes should NOT have mention links at all
        // const mentionsSelector = '.message .body .mention-link--me, .message .body .mention-link--group';
        // ticksBar.innerHTML = Array.from(messagesBox?.querySelectorAll(mentionsSelector) || [])
        // 	.map((mentionLink) => {
        // 		const topOffset = $(mentionLink).offset().top + scrollTop;
        // 		const percent = (100 / totalHeight) * topOffset;
        // 		const className = [
        // 			'tick',
        // 			mentionLink.classList.contains('mention-link--me') && 'tick--me',
        // 			mentionLink.classList.contains('mention-link--group') && 'tick--group',
        // 		].filter(Boolean).join(' ');
        // 		return `<div class="${ className }" style="top: ${ percent }%;"></div>`;
        // 	})
        // 	.join('');
      }

      return updateMentionsMarksOfRoom;
    }();

    return Cls;
  }();

  Cls.initClass();
  return new Cls();
}();

var loadMissedMessages = function () {
  function _callee2(rid) {
    var lastMessage, result, subscription;
    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              lastMessage = ChatMessage.findOne({
                rid: rid,
                _hidden: {
                  $ne: true
                },
                temp: {
                  $exists: false
                }
              }, {
                sort: {
                  ts: -1
                },
                limit: 1
              });

              if (!(lastMessage == null)) {
                _context2.next = 3;
                break;
              }

              return _context2.abrupt("return");

            case 3:
              _context2.prev = 3;
              _context2.next = 6;
              return _regeneratorRuntime.awrap(callWithErrorHandling('loadMissedMessages', rid, lastMessage.ts));

            case 6:
              result = _context2.sent;

              if (!result) {
                _context2.next = 10;
                break;
              }

              subscription = ChatSubscription.findOne({
                rid: rid
              });
              return _context2.abrupt("return", Promise.all(Array.from(result).map(function (msg) {
                return upsertMessage({
                  msg: msg,
                  subscription: subscription
                });
              })));

            case 10:
              return _context2.abrupt("return", []);

            case 13:
              _context2.prev = 13;
              _context2.t0 = _context2["catch"](3);
              return _context2.abrupt("return", []);

            case 16:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, [[3, 13]], Promise);
  }

  return _callee2;
}();

var connectionWasOnline = true;
Tracker.autorun(function () {
  var _Meteor$connection$st = Meteor.connection.status(),
      connected = _Meteor$connection$st.connected;

  if (connected === true && connectionWasOnline === false && RoomManager.openedRooms != null) {
    Object.keys(RoomManager.openedRooms).forEach(function (key) {
      var value = RoomManager.openedRooms[key];

      if (value.rid != null) {
        loadMissedMessages(value.rid);
      }
    });
  }

  connectionWasOnline = connected;
});
Meteor.startup(function () {
  // Reload rooms after login
  var currentUsername = undefined;
  Tracker.autorun(function () {
    var user = Meteor.user();

    if (currentUsername === undefined && (user != null ? user.username : undefined) != null) {
      currentUsername = user.username;
      RoomManager.closeAllRooms();
      var _roomTypes = roomTypes,
          types = _roomTypes.roomTypes; // Reload only if the current route is a channel route

      var roomType = Object.keys(types).find(function (key) {
        return types[key].route && types[key].route.name === FlowRouter.current().route.name;
      });

      if (roomType) {
        FlowRouter.reload();
      }
    }
  });
  ChatMessage.find().observe({
    removed: function (record) {
      if (RoomManager.getOpenedRoomByRid(record.rid) != null) {
        var recordBefore = ChatMessage.findOne({
          ts: {
            $lt: record.ts
          }
        }, {
          sort: {
            ts: -1
          }
        });

        if (recordBefore != null) {
          ChatMessage.update({
            _id: recordBefore._id
          }, {
            $set: {
              tick: new Date()
            }
          });
        }

        var recordAfter = ChatMessage.findOne({
          ts: {
            $gt: record.ts
          }
        }, {
          sort: {
            ts: 1
          }
        });

        if (recordAfter != null) {
          return ChatMessage.update({
            _id: recordAfter._id
          }, {
            $set: {
              tick: new Date()
            }
          });
        }
      }
    }
  });
});
Tracker.autorun(function () {
  if (Meteor.userId()) {
    return Notifications.onUser('message', function (msg) {
      msg.u = msg.u || {
        username: 'rocket.cat'
      };
      msg.private = true;
      return ChatMessage.upsert({
        _id: msg._id
      }, msg);
    });
  }
});
callbacks.add('afterLogoutCleanUp', function () {
  return RoomManager.closeAllRooms();
}, callbacks.priority.MEDIUM, 'roommanager-after-logout-cleanup');
CachedCollectionManager.onLogin(function () {
  Notifications.onUser('subscriptions-changed', function (action, sub) {
    var ignored = sub && sub.ignored ? {
      $nin: sub.ignored
    } : {
      $exists: true
    };
    ChatMessage.update({
      rid: sub.rid,
      ignored: ignored
    }, {
      $unset: {
        ignored: true
      }
    }, {
      multi: true
    });

    if (sub && sub.ignored) {
      ChatMessage.update({
        'rid': sub.rid,
        't': {
          $ne: 'command'
        },
        'u._id': {
          $in: sub.ignored
        }
      }, {
        $set: {
          ignored: true
        }
      }, {
        multi: true
      });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"SideNav.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/SideNav.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  SideNav: function () {
    return SideNav;
  }
});
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var AccountBox;
module.link("./AccountBox", {
  AccountBox: function (v) {
    AccountBox = v;
  }
}, 2);
var roomTypes;
module.link("../../../utils/client/lib/roomTypes", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 3);
var Subscriptions;
module.link("../../../models", {
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 4);
var RoomManager;
module.link("../../../../client/lib/RoomManager", {
  RoomManager: function (v) {
    RoomManager = v;
  }
}, 5);
var SideNav = new ( /*#__PURE__*/function () {
  function _class() {
    this.initiated = false;
    this.sideNav = {};
    this.flexNav = {};
    this.animating = false;
    this.openQueue = [];
  }

  var _proto = _class.prototype;

  _proto.toggleFlex = function () {
    function toggleFlex(status, callback) {
      var _this = this;

      if (this.animating === true) {
        return;
      }

      this.animating = true;

      if (status === -1 || status !== 1 && this.flexNav.opened) {
        this.flexNav.opened = false;
        this.flexNav.addClass('animated-hidden');
      } else {
        this.flexNav.opened = true;

        if (window.DISABLE_ANIMATION === true) {
          this.flexNav.removeClass('animated-hidden');
        } else {
          setTimeout(function () {
            return _this.flexNav.removeClass('animated-hidden');
          }, 50);
        }
      }

      if (window.DISABLE_ANIMATION === true) {
        !this.flexNav.opened && this.setFlex();
        this.animating = false;
        return typeof callback === 'function' && callback();
      }

      return setTimeout(function () {
        !_this.flexNav.opened && _this.setFlex();
        _this.animating = false;
        return typeof callback === 'function' && callback();
      }, 500);
    }

    return toggleFlex;
  }();

  _proto.closeFlex = function () {
    function closeFlex() {
      var callback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
      var routesNamesForRooms = roomTypes.getTypes().filter(function (i) {
        return i.route;
      }).map(function (i) {
        return i.route.name;
      });

      if (!routesNamesForRooms.includes(FlowRouter.current().route.name)) {
        var subscription = Subscriptions.findOne({
          rid: RoomManager.lastRid
        });

        if (subscription) {
          roomTypes.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);
        } else {
          FlowRouter.go('home');
        }
      }

      if (this.animating === true) {
        return;
      }

      this.toggleFlex(-1, callback);
    }

    return closeFlex;
  }();

  _proto.flexStatus = function () {
    function flexStatus() {
      return this.flexNav.opened;
    }

    return flexStatus;
  }();

  _proto.setFlex = function () {
    function setFlex(template) {
      var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      Session.set('flex-nav-template', template);
      return Session.set('flex-nav-data', data);
    }

    return setFlex;
  }();

  _proto.getFlex = function () {
    function getFlex() {
      return {
        template: Session.get('flex-nav-template'),
        data: Session.get('flex-nav-data')
      };
    }

    return getFlex;
  }();

  _proto.toggleCurrent = function () {
    function toggleCurrent() {
      if (this.flexNav && this.flexNav.opened) {
        return this.closeFlex();
      }

      return AccountBox.toggle();
    }

    return toggleCurrent;
  }();

  _proto.validate = function () {
    function validate() {
      var invalid = [];
      this.sideNav.find('input.required').each(function () {
        if (!this.value.length) {
          return invalid.push($(this).prev('label').html());
        }
      });

      if (invalid.length) {
        return invalid;
      }

      return false;
    }

    return validate;
  }();

  _proto.openFlex = function () {
    function openFlex() {
      var callback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {};

      if (!this.initiated) {
        return this.openQueue.push({
          config: this.getFlex(),
          callback: callback
        });
      }

      if (this.animating === true) {
        return;
      }

      this.toggleFlex(1, callback);
    }

    return openFlex;
  }();

  _proto.init = function () {
    function init() {
      var _this2 = this;

      this.sideNav = $('.sidebar');
      this.flexNav = this.sideNav.find('.flex-nav');
      this.setFlex('');
      this.initiated = true;

      if (this.openQueue.length > 0) {
        this.openQueue.forEach(function (item) {
          _this2.setFlex(item.config.template, item.config.data);

          return _this2.openFlex(item.callback);
        });
        this.openQueue = [];
      }
    }

    return init;
  }();

  return _class;
}())();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"collapseArrow.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/collapseArrow.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createCollapseable: function () {
    return createCollapseable;
  }
});
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
module.link("./collapseArrow.html");

var createCollapseable = function (template) {
  var getInicialFromInstance = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {
    return false;
  };
  template.onCreated(function () {
    this.collapsedMedia = new ReactiveVar(getInicialFromInstance(Template.instance()));
  });
  template.helpers({
    collapsed: function () {
      return Template.instance().collapsedMedia.get();
    },
    collapsedMediaVar: function () {
      return Template.instance().collapsedMedia;
    }
  });
};

Template.collapseArrow.events({
  'click .collapse-switch': function (e, i) {
    e.preventDefault();
    i.data.collapsedMedia.set(!i.data.collapsedMedia.get());
  }
});
Template.collapseArrow.helpers({
  collapsed: function () {
    return this.collapsedMedia.get();
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"mainReady.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/mainReady.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  mainReady: function () {
    return mainReady;
  }
});
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var mainReady = new ReactiveVar(false);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"menu.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/menu.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);

var _createClass;

module.link("@babel/runtime/helpers/createClass", {
  default: function (v) {
    _createClass = v;
  }
}, 1);

var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 2);
module.export({
  menu: function () {
    return menu;
  }
});
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 3);
var isRtl;
module.link("../../../utils", {
  isRtl: function (v) {
    isRtl = v;
  }
}, 4);
var sideNavW = 280;

var map = function (x, in_min, in_max, out_min, out_max) {
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
};

var menu = new ( /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(_class, _Emitter);

  function _class() {
    var _this;

    _this = _Emitter.call(this) || this;
    _this._open = false;
    _this.updateUnreadBars = _.throttle(function () {
      if (_this.list == null) {
        return;
      }

      var listOffset = _this.list.offset();

      var listHeight = _this.list.height();

      var showTop = false;
      var showBottom = false;
      $('li.sidebar-item--unread').each(function () {
        if ($(this).offset().top < listOffset.top - $(this).height()) {
          showTop = true;
        }

        if ($(this).offset().top > listOffset.top + listHeight) {
          showBottom = true;
        }
      });

      if (showTop === true) {
        $('.top-unread-rooms').removeClass('hidden');
      } else {
        $('.top-unread-rooms').addClass('hidden');
      }

      if (showBottom === true) {
        return $('.bottom-unread-rooms').removeClass('hidden');
      }

      return $('.bottom-unread-rooms').addClass('hidden');
    }, 200);
    _this.sideNavW = sideNavW;
    return _this;
  }

  var _proto = _class.prototype;

  _proto.touchstart = function () {
    function touchstart(e) {
      this.movestarted = false;
      this.blockmove = false;
      this.touchstartX = undefined;
      this.touchstartY = undefined;
      this.diff = 0;

      if (e.target === this.sidebarWrap[0] || $(e.target).closest('.main-content').length > 0) {
        this.closePopover();
        this.touchstartX = e.touches[0].clientX;
        this.touchstartY = e.touches[0].clientY;
        this.mainContent = $('.main-content');
      }
    }

    return touchstart;
  }();

  _proto.touchmove = function () {
    function touchmove(e) {
      if (this.touchstartX == null) {
        return;
      }

      var _e$touches = _slicedToArray(e.touches, 1),
          touch = _e$touches[0];

      var diffX = touch.clientX - this.touchstartX;
      var diffY = touch.clientY - this.touchstartY;
      var absX = Math.abs(diffX);
      var absY = Math.abs(diffY);

      if (!this.movestarted && absY > 5) {
        this.blockmove = true;
      }

      if (this.blockmove) {
        return;
      }

      this.sidebar.css('transition', 'none');
      this.sidebarWrap.css('transition', 'none');

      if (this.movestarted === true || absX > 5) {
        this.movestarted = true;

        if (this.isRtl) {
          if (this.isOpen()) {
            this.diff = -sideNavW + diffX;
          } else {
            this.diff = diffX;
          }

          if (this.diff < -sideNavW) {
            this.diff = -sideNavW;
          }

          if (this.diff > 0) {
            this.diff = 0;
          }
        } else {
          if (this.isOpen()) {
            this.diff = sideNavW + diffX;
          } else {
            this.diff = diffX;
          }

          if (this.diff > sideNavW) {
            this.diff = sideNavW;
          }

          if (this.diff < 0) {
            this.diff = 0;
          }
        } // if (map((this.diff / sideNavW), 0, 1, -.1, .8) > 0) {


        this.sidebar.css('box-shadow', '0 0 15px 1px rgba(0,0,0,.3)'); // this.sidebarWrap.css('z-index', '9998');

        this.translate(this.diff); // }
      }
    }

    return touchmove;
  }();

  _proto.translate = function () {
    function translate(diff) {
      var width = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : sideNavW;

      if (diff === undefined) {
        diff = this.isRtl ? -1 * sideNavW : sideNavW;
      }

      this.sidebarWrap.css('width', '100%');
      this.wrapper.css('overflow', 'hidden');
      this.sidebarWrap.css('background-color', '#000');
      this.sidebarWrap.css('opacity', map(Math.abs(diff) / width, 0, 1, -0.1, 0.8).toFixed(2));
      this.isRtl ? this.sidebar.css('transform', "translate3d(" + (sideNavW + diff).toFixed(3) + "px, 0 , 0)") : this.sidebar.css('transform', "translate3d(" + (diff - sideNavW).toFixed(3) + "px, 0 , 0)");
    }

    return translate;
  }();

  _proto.touchend = function () {
    function touchend() {
      var max = sideNavW * 0.76,
          min = sideNavW * 0.24;

      if (this.movestarted !== true) {
        return;
      }

      this.movestarted = false;

      if (this.isRtl) {
        if (this.isOpen()) {
          return this.diff >= -max ? this.close() : this.open();
        }

        if (this.diff <= -min) {
          return this.open();
        }

        return this.close();
      }

      if (this.isOpen()) {
        if (this.diff >= max) {
          return this.open();
        }

        return this.close();
      }

      if (this.diff >= min) {
        return this.open();
      }

      return this.close();
    }

    return touchend;
  }();

  _proto.init = function () {
    function init() {
      var _this2 = this;

      this.menu = $('.sidebar');
      this.sidebar = this.menu;
      this.sidebarWrap = $('.sidebar-wrap');
      this.wrapper = $('.messages-box > .wrapper');

      var ignore = function (fn) {
        return function (event) {
          return document.body.clientWidth <= 780 && fn(event);
        };
      };

      document.body.addEventListener('touchstart', ignore(function (e) {
        return _this2.touchstart(e);
      }));
      document.body.addEventListener('touchmove', ignore(function (e) {
        return _this2.touchmove(e);
      }));
      document.body.addEventListener('touchend', ignore(function (e) {
        return _this2.touchend(e);
      }));
      this.sidebarWrap.on('click', ignore(function (e) {
        e.target === _this2.sidebarWrap[0] && _this2.isOpen() && _this2.emit('clickOut', e);
      }));
      this.on('close', function () {
        _this2.sidebarWrap.css('width', ''); // this.sidebarWrap.css('z-index', '');


        _this2.sidebarWrap.css('background-color', '');

        _this2.sidebar.css('transform', '');

        _this2.sidebar.css('box-shadow', '');

        _this2.sidebar.css('transition', '');

        _this2.sidebarWrap.css('transition', '');

        _this2.wrapper && _this2.wrapper.css('overflow', '');
      });
      this.on('open', ignore(function () {
        _this2.sidebar.css('box-shadow', '0 0 15px 1px rgba(0,0,0,.3)'); // this.sidebarWrap.css('z-index', '9998');


        _this2.translate();
      }));
      this.mainContent = $('.main-content');
      this.list = $('.rooms-list');
      this._open = false;
      Session.set('isMenuOpen', this._open);
    }

    return init;
  }();

  _proto.closePopover = function () {
    function closePopover() {
      return this.menu.find('[data-popover="anchor"]:checked').prop('checked', false).length > 0;
    }

    return closePopover;
  }();

  _proto.isOpen = function () {
    function isOpen() {
      return Session.get('isMenuOpen');
    }

    return isOpen;
  }();

  _proto.open = function () {
    function open() {
      this._open = true;
      Session.set('isMenuOpen', this._open);
      this.emit('open');
    }

    return open;
  }();

  _proto.close = function () {
    function close() {
      this._open = false;
      Session.set('isMenuOpen', this._open);
      this.emit('close');
    }

    return close;
  }();

  _proto.toggle = function () {
    function toggle() {
      return this.isOpen() ? this.close() : this.open();
    }

    return toggle;
  }();

  _createClass(_class, [{
    key: "isRtl",
    get: function () {
      return isRtl(Meteor._localStorage.getItem('userLanguage'));
    }
  }]);

  return _class;
}(Emitter))();
var passClosePopover = false;
menu.on('clickOut', function () {
  if (!menu.closePopover()) {
    passClosePopover = true;
    menu.close();
  }
});
menu.on('close', function () {
  if (!menu.sidebar) {
    return;
  }

  menu.sidebar.css('transition', '');
  menu.sidebarWrap.css('transition', '');

  if (passClosePopover) {
    passClosePopover = false;
    return;
  }

  menu.closePopover();
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageArgs.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/messageArgs.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  messageArgs: function () {
    return messageArgs;
  }
});

var messageArgs = function (context) {
  return context && context._arguments && context._arguments[1] && context._arguments[1].hash || context;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBox.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/messageBox.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
module.export({
  messageBox: function () {
    return messageBox;
  }
});

var MessageBoxActions = /*#__PURE__*/function () {
  function MessageBoxActions() {
    this.actions = {};
  }

  var _proto = MessageBoxActions.prototype;

  _proto.add = function () {
    function add(group, label, config) {
      if (!group && !label && !config) {
        return;
      }

      if (!this.actions[group]) {
        this.actions[group] = [];
      }

      var actionExists = this.actions[group].find(function (action) {
        return action.label === label;
      });

      if (actionExists) {
        return;
      }

      this.actions[group].push(_objectSpread(_objectSpread({}, config), {}, {
        label: label
      }));
    }

    return add;
  }();

  _proto.remove = function () {
    function remove(group, expression) {
      if (!group || !this.actions[group]) {
        return false;
      }

      this.actions[group] = this.actions[group].filter(function (action) {
        return !expression.test(action.id);
      });
      return this.actions[group];
    }

    return remove;
  }();

  _proto.get = function () {
    function get(group) {
      var _this = this;

      if (!group) {
        return Object.keys(this.actions).reduce(function (ret, key) {
          var actions = _this.actions[key].filter(function (action) {
            return !action.condition || action.condition();
          });

          if (actions.length) {
            ret[key] = actions;
          }

          return ret;
        }, {});
      }

      return this.actions[group].filter(function (action) {
        return !action.condition || action.condition();
      });
    }

    return get;
  }();

  _proto.getById = function () {
    function getById(id) {
      var messageActions = this.actions;
      var actions = [];
      Object.keys(messageActions).forEach(function (action) {
        actions = actions.concat(messageActions[action]);
      });
      return actions.filter(function (action) {
        return action.id === id;
      });
    }

    return getById;
  }();

  return MessageBoxActions;
}();

var messageBox = {
  actions: new MessageBoxActions()
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageContext.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/messageContext.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
module.export({
  messageContext: function () {
    return messageContext;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var Subscriptions, Rooms, Users;
module.link("../../../models/client", {
  Subscriptions: function (v) {
    Subscriptions = v;
  },
  Rooms: function (v) {
    Rooms = v;
  },
  Users: function (v) {
    Users = v;
  }
}, 4);
var hasPermission;
module.link("../../../authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 5);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 6);
var getUserPreference, roomTypes;
module.link("../../../utils/client", {
  getUserPreference: function (v) {
    getUserPreference = v;
  },
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 7);
var AutoTranslate;
module.link("../../../autotranslate/client", {
  AutoTranslate: function (v) {
    AutoTranslate = v;
  }
}, 8);
var fireGlobalEvent;
module.link("../../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 9);
var actionLinks;
module.link("../../../action-links/client", {
  actionLinks: function (v) {
    actionLinks = v;
  }
}, 10);
var goToRoomById;
module.link("../../../../client/lib/utils/goToRoomById", {
  goToRoomById: function (v) {
    goToRoomById = v;
  }
}, 11);
var isLayoutEmbedded;
module.link("../../../../client/lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded: function (v) {
    isLayoutEmbedded = v;
  }
}, 12);
var handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 13);
var fields = {
  'name': 1,
  'username': 1,
  'settings.preferences.enableMessageParserEarlyAdoption': 1,
  'settings.preferences.showMessageInMainThread': 1,
  'settings.preferences.autoImageLoad': 1,
  'settings.preferences.saveMobileBandwidth': 1,
  'settings.preferences.collapseMediaByDefault': 1,
  'settings.preferences.hideRoles': 1
};

function messageContext() {
  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Template.instance(),
      rid = _ref.rid;

  var uid = Meteor.userId();
  var user = Users.findOne({
    _id: uid
  }, {
    fields: fields
  }) || {};
  var instance = Template.instance();

  var openThread = function (e) {
    var _e$currentTarget$data = e.currentTarget.dataset,
        rid = _e$currentTarget$data.rid,
        mid = _e$currentTarget$data.mid,
        tmid = _e$currentTarget$data.tmid;
    var room = Rooms.findOne({
      _id: rid
    });
    FlowRouter.go(FlowRouter.getRouteName(), {
      rid: rid,
      name: room.name,
      tab: 'thread',
      context: tmid || mid
    }, {
      jump: tmid && tmid !== mid && mid && mid
    });
    e.preventDefault();
    e.stopPropagation();
  };

  var runAction = isLayoutEmbedded() ? function (msg, e) {
    var actionlink = e.currentTarget.dataset.actionlink;
    return fireGlobalEvent('click-action-link', {
      actionlink: actionlink,
      value: msg._id,
      message: msg
    });
  } : function (msg, e) {
    var actionlink = e.currentTarget.dataset.actionlink;
    actionLinks.run(actionlink, msg._id, instance, function (err) {
      if (err) {
        handleError(err);
      }
    });
  };

  var openDiscussion = function (e) {
    e.preventDefault();
    e.stopPropagation();
    var drid = e.currentTarget.dataset.drid;
    goToRoomById(drid);
  };

  var replyBroadcast = function (e) {
    var _e$currentTarget$data2 = e.currentTarget.dataset,
        username = _e$currentTarget$data2.username,
        mid = _e$currentTarget$data2.mid;
    roomTypes.openRouteLink('d', {
      name: username
    }, _objectSpread(_objectSpread({}, FlowRouter.current().queryParams), {}, {
      reply: mid
    }));
  };

  return {
    u: user,
    room: Tracker.nonreactive(function () {
      return Rooms.findOne({
        _id: rid
      }, {
        fields: {
          _updatedAt: 0,
          lastMessage: 0
        }
      });
    }),
    subscription: Subscriptions.findOne({
      rid: rid
    }, {
      fields: {
        name: 1,
        autoTranslate: 1,
        rid: 1,
        tunread: 1,
        tunreadUser: 1,
        tunreadGroup: 1
      }
    }),
    actions: {
      openThread: function () {
        return openThread;
      },
      runAction: function (msg) {
        return function () {
          return function (e) {
            e.preventDefault();
            e.stopPropagation();
            runAction(msg, e);
          };
        };
      },
      openDiscussion: function () {
        return openDiscussion;
      },
      replyBroadcast: function () {
        return replyBroadcast;
      }
    },
    settings: {
      translateLanguage: AutoTranslate.getLanguage(rid),
      showMessageInMainThread: getUserPreference(user, 'showMessageInMainThread'),
      autoImageLoad: getUserPreference(user, 'autoImageLoad'),
      enableMessageParserEarlyAdoption: getUserPreference(user, 'enableMessageParserEarlyAdoption'),
      saveMobileBandwidth: Meteor.Device.isPhone() && getUserPreference(user, 'saveMobileBandwidth'),
      collapseMediaByDefault: getUserPreference(user, 'collapseMediaByDefault'),
      showreply: true,
      showReplyButton: true,
      hasPermissionDeleteMessage: hasPermission('delete-message', rid),
      hasPermissionDeleteOwnMessage: hasPermission('delete-own-message'),
      hideRoles: !settings.get('UI_DisplayRoles') || getUserPreference(user, 'hideRoles'),
      UI_Use_Real_Name: settings.get('UI_Use_Real_Name'),
      Chatops_Username: settings.get('Chatops_Username'),
      AutoTranslate_Enabled: settings.get('AutoTranslate_Enabled'),
      Message_AllowEditing: settings.get('Message_AllowEditing'),
      Message_AllowEditing_BlockEditInMinutes: settings.get('Message_AllowEditing_BlockEditInMinutes'),
      Message_ShowEditedStatus: settings.get('Message_ShowEditedStatus'),
      API_Embed: settings.get('API_Embed'),
      API_EmbedDisabledFor: settings.get('API_EmbedDisabledFor'),
      Message_GroupingPeriod: settings.get('Message_GroupingPeriod') * 1000
    }
  };
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"modal.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/modal.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
module.export({
  modal: function () {
    return modal;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var t, getUserPreference;
module.link("../../../utils", {
  t: function (v) {
    t = v;
  },
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 3);
module.link("./modal.html");
var handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 4);
var modalStack = [];

var createModal = function () {
  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var fn = arguments.length > 1 ? arguments[1] : undefined;
  var onCancel = arguments.length > 2 ? arguments[2] : undefined;
  config.confirmButtonText = config.confirmButtonText || (config.type === 'error' ? t('Ok') : t('Send'));
  config.cancelButtonText = config.cancelButtonText || t('Cancel');
  config.closeOnConfirm = config.closeOnConfirm == null ? true : config.closeOnConfirm;
  config.showConfirmButton = config.showConfirmButton == null ? true : config.showConfirmButton;
  config.showFooter = config.showConfirmButton === true || config.showCancelButton === true;
  config.confirmOnEnter = config.confirmOnEnter == null ? true : config.confirmOnEnter;
  config.closeOnEscape = config.closeOnEscape == null ? true : config.closeOnEscape;

  if (config.type === 'input') {
    config.input = true;
    config.type = false;

    if (!config.inputType) {
      config.inputType = 'text';
    }
  }

  var renderedModal;
  var timer;

  var instance = _objectSpread(_objectSpread({}, config), {}, {
    render: function () {
      if (renderedModal) {
        renderedModal.firstNode().style.display = '';
        return;
      }

      renderedModal = Blaze.renderWithData(Template.rc_modal, instance, document.body);

      if (config.timer) {
        timer = setTimeout(function () {
          instance.close();
        }, config.timer);
      }
    },
    hide: function () {
      if (renderedModal) {
        renderedModal.firstNode().style.display = 'none';
      }

      if (timer) {
        clearTimeout(timer);
        timer = undefined;
      }
    },
    destroy: function () {
      if (renderedModal) {
        Blaze.remove(renderedModal);
        renderedModal = undefined;
      }

      if (timer) {
        clearTimeout(timer);
        timer = undefined;
      }
    },
    close: function () {
      if (onCancel) {
        onCancel.call(instance);
      }

      instance.destroy();
      modalStack = modalStack.filter(function (modal) {
        return modal !== instance;
      });

      if (modalStack.length) {
        modalStack[modalStack.length - 1].render();
      }
    },
    confirm: function (value) {
      config.closeOnConfirm && instance.close();

      if (fn) {
        fn.call(instance, value);
        return;
      }

      instance.close();
    },
    cancel: function () {
      instance.close();
    },
    showInputError: function (text) {
      var errorEl = document.querySelector('.rc-modal__content-error');
      errorEl.innerHTML = text;
      errorEl.style.display = 'block';
    }
  });

  return instance;
};

var modal = {
  open: function () {
    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var fn = arguments.length > 1 ? arguments[1] : undefined;
    var onCancel = arguments.length > 2 ? arguments[2] : undefined;
    modalStack.forEach(function (instance) {
      instance.destroy();
    });
    modalStack = [];
    var instance = createModal(config, fn, onCancel);

    if (config.dontAskAgain) {
      var dontAskAgainList = getUserPreference(Meteor.userId(), 'dontAskAgainList');

      if (dontAskAgainList && dontAskAgainList.some(function (dontAsk) {
        return dontAsk.action === config.dontAskAgain.action;
      })) {
        instance.confirm(true);
        return;
      }
    }

    instance.render();
    modalStack.push(instance);
  },
  push: function () {
    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var fn = arguments.length > 1 ? arguments[1] : undefined;
    var onCancel = arguments.length > 2 ? arguments[2] : undefined;
    var instance = createModal(config, fn, onCancel);
    modalStack.forEach(function (instance) {
      instance.hide();
    });
    instance.render();
    modalStack.push(instance);
    return instance;
  },
  cancel: function () {
    if (modalStack.length) {
      modalStack[modalStack.length - 1].cancel();
    }
  },
  close: function () {
    if (modalStack.length) {
      modalStack[modalStack.length - 1].close();
    }
  },
  confirm: function (value) {
    if (modalStack.length) {
      modalStack[modalStack.length - 1].confirm(value);
    }
  },
  showInputError: function (text) {
    if (modalStack.length) {
      modalStack[modalStack.length - 1].showInputError(text);
    }
  },
  onKeyDown: function (event) {
    if (!modalStack.length) {
      return;
    }

    var instance = modalStack[modalStack.length - 1];

    if (event.key === 'Escape') {
      event.preventDefault();
      event.stopPropagation();
      instance.close();
    }

    if (instance && instance.confirmOnEnter && event.key === 'Enter') {
      event.preventDefault();
      event.stopPropagation();

      if (instance.input) {
        return instance.confirm($('.js-modal-input').val());
      }

      instance.confirm(true);
    }
  }
};
Template.rc_modal.helpers({
  showFooter: function () {
    var showCancelButton = this.showCancelButton,
        showConfirmButton = this.showConfirmButton;
    return showCancelButton || showConfirmButton;
  },
  hasAction: function () {
    return !!this.action;
  },
  type: function () {
    return this.type && "rc-modal__content-icon rc-modal__content-icon--modal-" + this.type;
  },
  modalIcon: function () {
    switch (this.type) {
      case 'success':
        return 'checkmark-circled';

      case 'error':
        return 'circle-cross';

      case 'info':
        return 'info-circled';

      default:
        return "modal-" + this.type;
    }
  }
});
Template.rc_modal.onRendered(function () {
  this.oldFocus = document.activeElement;

  if (this.data.input) {
    $('.js-modal-input', this.firstNode).focus();
  } else if (this.data.showConfirmButton && this.data.confirmOnEnter) {
    $('.js-confirm', this.firstNode).focus();
  }

  if (this.data.onRendered) {
    this.data.onRendered();
  }

  this.data.closeOnEscape && document.addEventListener('keydown', modal.onKeyDown);
});
Template.rc_modal.onDestroyed(function () {
  this.oldFocus && this.oldFocus.focus();
  document.removeEventListener('keydown', modal.onKeyDown);
});
Template.rc_modal.events({
  'click .js-action': function (event, instance) {
    !this.action || this.action.call(instance.data.data, event, instance);
    event.stopPropagation();
    this.close();
  },
  'click .js-input-action': function (e, instance) {
    !this.inputAction || this.inputAction.call(instance.data.data, e, instance);
    e.stopPropagation();
  },
  'click .js-close': function (e) {
    e.preventDefault();
    e.stopPropagation();
    this.cancel();
  },
  'click .js-confirm': function (event, instance) {
    event.stopPropagation();
    var dontAskAgain = instance.data.dontAskAgain;

    if (dontAskAgain && document.getElementById('dont-ask-me-again').checked) {
      var dontAskAgainObject = {
        action: dontAskAgain.action,
        label: dontAskAgain.label
      };
      var dontAskAgainList = getUserPreference(Meteor.userId(), 'dontAskAgainList');

      if (dontAskAgainList) {
        dontAskAgainList.push(dontAskAgainObject);
      } else {
        dontAskAgainList = [dontAskAgainObject];
      }

      Meteor.call('saveUserPreferences', {
        dontAskAgainList: dontAskAgainList
      }, function (error) {
        if (error) {
          return handleError(error);
        }
      });
    }

    if (instance.data.input) {
      this.confirm(document.getElementsByClassName('js-modal-input')[0].value);
      return;
    }

    this.confirm(true);
  },
  'click .rc-modal-wrapper': function (event, instance) {
    if (instance.data.allowOutsideClick === false) {
      return false;
    }

    if (event.currentTarget === event.target) {
      event.stopPropagation();
      this.close();
    }
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"openRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/openRoom.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);
module.export({
  openRoom: function () {
    return openRoom;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 2);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 3);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 4);
var appLayout;
module.link("../../../../client/lib/appLayout", {
  appLayout: function (v) {
    appLayout = v;
  }
}, 5);
var Messages, ChatSubscription;
module.link("../../../models", {
  Messages: function (v) {
    Messages = v;
  },
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 6);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 7);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 8);
var roomTypes;
module.link("../../../utils", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 9);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 10);
var call;
module.link("../../../../client/lib/utils/call", {
  call: function (v) {
    call = v;
  }
}, 11);
var RoomManager, RoomHistoryManager;
module.link("..", {
  RoomManager: function (v) {
    RoomManager = v;
  },
  RoomHistoryManager: function (v) {
    RoomHistoryManager = v;
  }
}, 12);
var NewRoomManager;
module.link("../../../../client/lib/RoomManager", {
  RoomManager: function (v) {
    NewRoomManager = v;
  }
}, 13);
var Rooms;
module.link("../../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 14);
var fireGlobalEvent;
module.link("../../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 15);
window.currentTracker = undefined; // cleanup session when hot reloading

Session.set('openedRoom', null);
NewRoomManager.on('changed', function (rid) {
  Session.set('openedRoom', rid);
  RoomManager.openedRoom = rid;
});

var openRoom = function () {
  function _callee2(type, name) {
    var render,
        _args2 = arguments;
    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              render = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : true;
              window.currentTracker && window.currentTracker.stop();
              window.currentTracker = Tracker.autorun(function () {
                function _callee(c) {
                  var user, room, sub, messageId, msg, message, _await$call, rid;

                  return _regeneratorRuntime.async(function () {
                    function _callee$(_context) {
                      while (1) {
                        switch (_context.prev = _context.next) {
                          case 0:
                            user = Meteor.user();

                            if (!(user && user.username == null || user == null && settings.get('Accounts_AllowAnonymousRead') === false)) {
                              _context.next = 4;
                              break;
                            }

                            appLayout.renderMainLayout();
                            return _context.abrupt("return");

                          case 4:
                            _context.prev = 4;
                            _context.t0 = roomTypes.findRoom(type, name, user);

                            if (_context.t0) {
                              _context.next = 10;
                              break;
                            }

                            _context.next = 9;
                            return _regeneratorRuntime.awrap(call('getRoomByTypeAndName', type, name));

                          case 9:
                            _context.t0 = _context.sent;

                          case 10:
                            room = _context.t0;
                            Rooms.upsert({
                              _id: room._id
                            }, _.omit(room, '_id'));

                            if (!(room._id !== name && type === 'd')) {
                              _context.next = 15;
                              break;
                            }

                            // Redirect old url using username to rid
                            RoomManager.close(type + name);
                            return _context.abrupt("return", FlowRouter.go('direct', {
                              rid: room._id
                            }, FlowRouter.current().queryParams));

                          case 15:
                            if (!(room._id === Session.get('openedRoom') && !FlowRouter.getQueryParam('msg'))) {
                              _context.next = 17;
                              break;
                            }

                            return _context.abrupt("return");

                          case 17:
                            RoomManager.open(type + name);

                            if (render) {
                              appLayout.renderMainLayout({
                                center: 'room'
                              });
                            }

                            c.stop();

                            if (window.currentTracker) {
                              window.currentTracker = undefined;
                            }

                            NewRoomManager.open(room._id);
                            fireGlobalEvent('room-opened', _.omit(room, 'usernames'));
                            Session.set('editRoomTitle', false); // KonchatNotification.removeRoomNotification(params._id)
                            // update user's room subscription

                            sub = ChatSubscription.findOne({
                              rid: room._id
                            });

                            if (sub && sub.open === false) {
                              callWithErrorHandling('openRoom', room._id);
                            }

                            if (!FlowRouter.getQueryParam('msg')) {
                              _context.next = 39;
                              break;
                            }

                            messageId = FlowRouter.getQueryParam('msg');
                            msg = {
                              _id: messageId,
                              rid: room._id
                            };
                            _context.t1 = Messages.findOne({
                              _id: msg._id
                            });

                            if (_context.t1) {
                              _context.next = 34;
                              break;
                            }

                            _context.next = 33;
                            return _regeneratorRuntime.awrap(callWithErrorHandling('getMessages', [msg._id]));

                          case 33:
                            _context.t1 = _context.sent[0];

                          case 34:
                            message = _context.t1;

                            if (!(message && (message.tmid || message.tcount))) {
                              _context.next = 37;
                              break;
                            }

                            return _context.abrupt("return", FlowRouter.setParams({
                              tab: 'thread',
                              context: message.tmid || message._id
                            }));

                          case 37:
                            RoomHistoryManager.getSurroundingMessages(msg);
                            FlowRouter.setQueryParams({
                              msg: undefined
                            });

                          case 39:
                            return _context.abrupt("return", callbacks.run('enter-room', sub));

                          case 42:
                            _context.prev = 42;
                            _context.t2 = _context["catch"](4);
                            c.stop();

                            if (!(type === 'd')) {
                              _context.next = 57;
                              break;
                            }

                            _context.prev = 46;
                            _context.next = 49;
                            return _regeneratorRuntime.awrap(call.apply(void 0, ['createDirectMessage'].concat(_toConsumableArray(name.split(', ')))));

                          case 49:
                            _await$call = _context.sent;
                            rid = _await$call.rid;
                            return _context.abrupt("return", FlowRouter.go('direct', {
                              rid: rid
                            }, FlowRouter.current().queryParams));

                          case 54:
                            _context.prev = 54;
                            _context.t3 = _context["catch"](46);
                            console.error(_context.t3);

                          case 57:
                            Session.set('roomNotFound', {
                              type: type,
                              name: name,
                              error: _context.t2
                            });
                            appLayout.renderMainLayout({
                              center: 'roomNotFound'
                            });

                          case 59:
                          case "end":
                            return _context.stop();
                        }
                      }
                    }

                    return _callee$;
                  }(), null, null, [[4, 42], [46, 54]], Promise);
                }

                return _callee;
              }());

            case 3:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popout.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/popout.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  popout: function () {
    return popout;
  }
});
module.link("./popout.html");
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);
var popout = {
  context: null,
  isAudioOnly: false,
  showVideoControls: true,
  showStreamControls: false,
  x: 0,
  y: 0,
  open: function () {
    var _this = this;

    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var fn = arguments.length > 1 ? arguments[1] : undefined;
    this.close();
    this.context = Blaze.renderWithData(Template.popout, config, document.body);
    this.fn = fn;
    this.config = config;
    this.onCloseCallback = config.onCloseCallback || null;
    this.timer = null;

    if (config.timer) {
      this.timer = setTimeout(function () {
        return _this.close();
      }, config.timer);
    }

    if (config.data) {
      this.isAudioOnly = config.data.isAudioOnly;
      this.showVideoControls = config.data.showVideoControls;
      this.showStreamControls = config.data.showStreamControls;
    }
  },
  close: function () {
    if (this.context) {
      Blaze.remove(this.context);
    }

    this.context = null;
    this.fn = null;

    if (this.timer) {
      clearTimeout(this.timer);
    }

    if (typeof this.onCloseCallback === 'function') {
      this.onCloseCallback();
    }
  },
  dragstart: function (event) {
    if (!event.target.classList.contains('dropzone-overlay')) {
      var popoutElement = document.querySelector('.rc-popout-wrapper');
      setTimeout(function () {
        popoutElement.style.display = 'none';
      }, 0);
    }
  },
  dragover: function (event) {
    var e = event.originalEvent || event;
    e.dataTransfer.dropEffect = 'move';
    e.preventDefault();
  },
  dragend: function (event) {
    if (!event.target.classList.contains('dropzone-overlay')) {
      var popoutElement = document.querySelector('.rc-popout-wrapper');
      popoutElement.style.display = 'initial';
    }
  },
  drop: function (event) {
    var e = event.originalEvent || event;
    e.preventDefault(); // do not mess with the position if we are dropping files in the dropzone

    if (!event.target.classList.contains('dropzone-overlay')) {
      var popoutElement = document.querySelector('.rc-popout-wrapper');
      var positionTop = e.clientY - popout.y;
      var positionLeft = e.clientX - popout.x;
      popoutElement.style.left = (positionLeft >= 0 ? positionLeft : 0) + "px";
      popoutElement.style.top = (positionTop >= 0 ? positionTop : 0) + "px";
    }
  }
};
Template.popout.helpers({
  state: function () {
    return Template.instance().isMinimized.get() ? 'closed' : 'open';
  },
  isAudioOnly: function () {
    return Template.instance().isAudioOnly.get();
  },
  isMuted: function () {
    return Template.instance().isMuted.get();
  },
  isPlaying: function () {
    return Template.instance().isPlaying.get();
  },
  showVideoControls: function () {
    return Template.instance().showVideoControls.get();
  },
  showStreamControls: function () {
    return Template.instance().showStreamControls.get();
  },
  getStreamStatus: function () {
    return Template.instance().streamStatus.get();
  }
});
Template.popout.onRendered(function () {
  Template.instance().isMinimized.set(popout.isAudioOnly);
  Template.instance().isAudioOnly.set(popout.isAudioOnly);
  Template.instance().showVideoControls.set(popout.showVideoControls);
  Template.instance().showStreamControls.set(popout.showStreamControls);

  if (this.data.onRendered) {
    this.data.onRendered();
  }
});
Template.popout.onCreated(function () {
  this.isMinimized = new ReactiveVar(popout.isAudioOnly);
  this.isAudioOnly = new ReactiveVar(popout.isAudioOnly);
  this.canOpenExternal = new ReactiveVar(popout.canOpenExternal);
  this.showVideoControls = new ReactiveVar(popout.showVideoControls);
  this.showStreamControls = new ReactiveVar(popout.showStreamControls);
  this.isMuted = new ReactiveVar(false);
  this.isPlaying = new ReactiveVar(true);
  this.streamStatus = new ReactiveVar('preparing');
  document.body.addEventListener('dragstart', popout.dragstart, true);
  document.body.addEventListener('dragover', popout.dragover, true);
  document.body.addEventListener('dragend', popout.dragend, true);
  document.body.addEventListener('drop', popout.drop, true);
});
Template.popout.onDestroyed(function () {
  popout.context = null;
  document.body.removeEventListener('dragstart', popout.dragstart, true);
  document.body.removeEventListener('dragover', popout.dragover, true);
  document.body.removeEventListener('dragend', popout.dragend, true);
  document.body.removeEventListener('drop', popout.drop, true);
});
Template.popout.events({
  'click .js-action': function (e, instance) {
    !this.action || this.action.call(instance.data.data, e, instance);
    e.stopPropagation();
    popout.close();
  },
  'click .js-close': function (e) {
    e.stopPropagation();
    popout.close();
  },
  'click .js-minimize': function (e, i) {
    e.stopPropagation();

    if (i.isMinimized.get()) {
      i.isMinimized.set(false);
      window.liveStreamPlayer.setSize(380, 214);
    } else {
      i.isMinimized.set(true);
      window.liveStreamPlayer.setSize(0, 0);
    }
  },
  'dragstart .rc-popout-wrapper': function (event) {
    var e = event.originalEvent || event;
    var url = this.data && this.data.streamingSource || '.rc-popout-wrapper';
    popout.x = e.offsetX;
    popout.y = e.offsetY;
    e.dataTransfer.setData('application/x-moz-node', e.currentTarget);
    e.dataTransfer.setData('text/plain', url);
    e.dataTransfer.effectAllowed = 'move';
  },
  'dragend .rc-popout-wrapper': function (event) {
    event.preventDefault();
  },
  'click .rc-popout__controls--record': function (e, i) {
    e.preventDefault();

    if (i.streamStatus.get() === 'ready') {
      document.querySelector('.streaming-popup').dispatchEvent(new Event('startStreaming'));
      i.streamStatus.set('starting');
    } else if (i.streamStatus.get() === 'broadcasting') {
      document.querySelector('.streaming-popup').dispatchEvent(new Event('stopStreaming'));
      i.streamStatus.set('finished');
      setTimeout(function () {
        return popout && popout.close();
      }, 2000);
    }
  },
  'broadcastStreamReady .streaming-popup': function (e, i) {
    e.preventDefault();
    i.streamStatus.set('ready');
  },
  'broadcastStream .streaming-popup': function (e, i) {
    e.preventDefault();
    i.streamStatus.set('broadcasting');
  },
  'click .rc-popout__controls--play': function (e, i) {
    window.liveStreamPlayer.playVideo();
    i.isPlaying.set(true);
  },
  'click .rc-popout__controls--pause': function (e, i) {
    window.liveStreamPlayer.pauseVideo();
    i.isPlaying.set(false);
  },
  'click .rc-popout__controls--mute': function (e, i) {
    window.liveStreamPlayer.mute();
    i.isMuted.set(true);
  },
  'click .rc-popout__controls--unmute': function (e, i) {
    window.liveStreamPlayer.unMute();
    i.isMuted.set(false);
  },
  'playerStateChanged .rc-popout': function (e, i) {
    if (e.detail === window.YT.PlayerState.PLAYING) {
      i.isPlaying.set(true);
    } else if (e.detail === window.YT.PlayerState.PAUSED) {
      i.isPlaying.set(false);
    }
  }
});
callbacks.add('afterLogoutCleanUp', function () {
  return popout.close();
}, callbacks.priority.MEDIUM, 'popout-close-after-logout-cleanup');
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"popover.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/popover.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["currentTarget"];

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);
module.export({
  popover: function () {
    return popover;
  }
});
module.link("./popover.html");
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var messageBox;
module.link("./messageBox", {
  messageBox: function (v) {
    messageBox = v;
  }
}, 3);
var MessageAction;
module.link("./MessageAction", {
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 4);
var isRtl;
module.link("../../../utils/client", {
  isRtl: function (v) {
    isRtl = v;
  }
}, 5);
var popover = {
  renderedPopover: null,
  open: function (_ref) {
    var currentTarget = _ref.currentTarget,
        config = _objectWithoutProperties(_ref, _excluded);

    // Popover position must be computed as soon as possible, avoiding DOM changes over currentTarget
    var data = _objectSpread({
      targetRect: currentTarget === null || currentTarget === void 0 ? void 0 : currentTarget.getBoundingClientRect()
    }, config);

    this.renderedPopover = Blaze.renderWithData(Template.popover, data, document.body);
  },
  close: function () {
    if (!this.renderedPopover) {
      return false;
    }

    Blaze.remove(this.renderedPopover);
    var activeElement = this.renderedPopover.dataVar.curValue.activeElement;

    if (activeElement) {
      $(activeElement).removeClass('active');
    }
  }
};
Template.popover.helpers({
  hasAction: function () {
    return !!this.action;
  }
});
Template.popover.onRendered(function () {
  var _this = this;

  if (this.data.onRendered) {
    this.data.onRendered();
  }

  $('.rc-popover').click(function (e) {
    if (e.currentTarget === e.target) {
      popover.close();
    }
  });
  var _this$data = this.data,
      _this$data$offsetVert = _this$data.offsetVertical,
      offsetVertical = _this$data$offsetVert === void 0 ? 0 : _this$data$offsetVert,
      _this$data$offsetHori = _this$data.offsetHorizontal,
      offsetHorizontal = _this$data$offsetHori === void 0 ? 0 : _this$data$offsetHori;
  var activeElement = this.data.activeElement;
  var originalWidth = window.innerWidth;
  var popoverContent = this.firstNode.children[0];

  var position = _.throttle(function () {
    var direction = typeof _this.data.direction === 'function' ? _this.data.direction() : _this.data.direction;
    var verticalDirection = /top/.test(direction) ? 'top' : 'bottom';
    var rtlDirection = isRtl() ^ /inverted/.test(direction) ? 'left' : 'right';
    var rightDirection = /right/.test(direction) ? 'right' : rtlDirection;
    var horizontalDirection = /left/.test(direction) ? 'left' : rightDirection;
    var position = typeof _this.data.position === 'function' ? _this.data.position() : _this.data.position;
    var customCSSProperties = typeof _this.data.customCSSProperties === 'function' ? _this.data.customCSSProperties() : _this.data.customCSSProperties;
    var mousePosition = typeof _this.data.mousePosition === 'function' ? _this.data.mousePosition() : _this.data.mousePosition || {
      x: _this.data.targetRect[horizontalDirection === 'left' ? 'right' : 'left'],
      y: _this.data.targetRect[verticalDirection]
    };
    var offsetWidth = offsetHorizontal * (horizontalDirection === 'left' ? 1 : -1);
    var offsetHeight = offsetVertical * (verticalDirection === 'bottom' ? 1 : -1);
    var leftDiff = window.innerWidth - originalWidth;

    if (position) {
      popoverContent.style.top = position.top + "px";
      popoverContent.style.left = position.left + leftDiff + "px";
    } else {
      var clientHeight = _this.data.targetRect.height;
      var popoverWidth = popoverContent.offsetWidth;
      var popoverHeight = popoverContent.offsetHeight;
      var windowWidth = window.innerWidth;
      var windowHeight = window.innerHeight;
      var top = mousePosition.y - clientHeight + offsetHeight;

      if (verticalDirection === 'top') {
        top = mousePosition.y - popoverHeight + offsetHeight;

        if (top < 0) {
          top = 10 + offsetHeight;
        }
      }

      if (top + popoverHeight > windowHeight) {
        top = windowHeight - 10 - popoverHeight - offsetHeight;
      }

      var left = mousePosition.x - popoverWidth + offsetWidth;

      if (horizontalDirection === 'right') {
        left = mousePosition.x + offsetWidth;
      }

      if (left + popoverWidth >= windowWidth) {
        left = mousePosition.x - popoverWidth + offsetWidth;
      }

      if (left <= 0) {
        left = mousePosition.x + offsetWidth;
      }

      popoverContent.style.top = top + "px";
      popoverContent.style.left = left + leftDiff + "px";
    }

    if (customCSSProperties) {
      Object.keys(customCSSProperties).forEach(function (property) {
        popoverContent.style[property] = customCSSProperties[property];
      });
    }

    var realTop = Number(popoverContent.style.top.replace('px', ''));

    if (realTop + popoverContent.offsetHeight > window.innerHeight) {
      popoverContent.style.overflow = 'scroll';
      popoverContent.style.bottom = 0;
      popoverContent.className = 'rc-popover__content rc-popover__content-scroll';
    }

    if (activeElement) {
      $(activeElement).addClass('active');
    }

    popoverContent.style.opacity = 1;
  }, 50);

  var observer = new MutationObserver(position);
  observer.observe(popoverContent, {
    childList: true,
    subtree: true
  });
  $(window).on('resize', position);
  position();
  this.position = position;
  this.observer = observer;
  this.firstNode.style.visibility = 'visible';
});
Template.popover.onDestroyed(function () {
  var _this$observer;

  if (this.data.onDestroyed) {
    this.data.onDestroyed();
  }

  $(window).off('resize', this.position);
  (_this$observer = this.observer) === null || _this$observer === void 0 ? void 0 : _this$observer.disconnect();
});
Template.popover.events({
  'click .js-action': function (e, instance) {
    !this.action || this.action.call(this, e, instance.data.data);
    popover.close();
  },
  'click .js-close': function () {
    popover.close();
  },
  'click [data-type="messagebox-action"]': function (event, t) {
    var id = event.currentTarget.dataset.id;
    var actions = messageBox.actions.getById(id);
    actions.filter(function (_ref2) {
      var action = _ref2.action;
      return !!action;
    }).forEach(function (_ref3) {
      var action = _ref3.action;
      action.call(null, _objectSpread(_objectSpread({}, t.data.data), {}, {
        event: event
      }));
    });
    popover.close();
  },
  'click [data-type="message-action"]': function (e, t) {
    var button = MessageAction.getButtonById(e.currentTarget.dataset.id);

    if ((button != null ? button.action : undefined) != null) {
      e.stopPropagation();
      e.preventDefault();
      var _t$data$instance = t.data.instance,
          tabBar = _t$data$instance.tabBar,
          rid = _t$data$instance.rid;
      button.action.call(t.data.data, e, {
        tabBar: tabBar,
        rid: rid
      });
      popover.close();
      return false;
    }
  }
});
Template.popover.helpers({
  isSafariIos: /iP(ad|hone|od).+Version\/[\d\.]+.*Safari/i.test(navigator.userAgent)
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"readMessages.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/lib/readMessages.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  readMessage: function () {
    return readMessage;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 2);
var RoomHistoryManager;
module.link("./RoomHistoryManager", {
  RoomHistoryManager: function (v) {
    RoomHistoryManager = v;
  }
}, 3);
var RoomManager;
module.link("./RoomManager", {
  RoomManager: function (v) {
    RoomManager = v;
  }
}, 4);
var ChatSubscription, ChatMessage;
module.link("../../../models", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  },
  ChatMessage: function (v) {
    ChatMessage = v;
  }
}, 5);
var readMessage = new ( /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(_class, _Emitter);

  function _class() {
    var _this;

    _this = _Emitter.call(this) || this;
    _this.debug = false;

    _this.enable();

    return _this;
  }

  var _proto = _class.prototype;

  _proto.read = function () {
    function read() {
      var rid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Session.get('openedRoom');

      if (!this.enabled) {
        this.log('readMessage -> readNow canceled by enabled: false');
        return;
      }

      var subscription = ChatSubscription.findOne({
        rid: rid
      });

      if (subscription == null) {
        this.log('readMessage -> readNow canceled, no subscription found for rid:', rid);
        return;
      }

      if (subscription.alert === false && subscription.unread === 0) {
        this.log('readMessage -> readNow canceled, alert', subscription.alert, 'and unread', subscription.unread);
        return;
      }

      var room = RoomManager.getOpenedRoomByRid(rid);

      if (room == null) {
        this.log('readMessage -> readNow canceled, no room found for typeName:', subscription.t + subscription.name);
        return;
      } // Only read messages if user saw the first unread message


      var unreadMark = $('.message.first-unread');

      if (unreadMark.length > 0) {
        var position = unreadMark.position();
        var visible = (position != null ? position.top : undefined) >= 0;

        if (!visible && room.unreadSince.get()) {
          this.log('readMessage -> readNow canceled, unread mark visible:', visible, 'unread since exists', room.unreadSince.get() != null);
          return;
        } // if unread mark is not visible and there is more more not loaded unread messages

      } else if (RoomHistoryManager.getRoom(rid).unreadNotLoaded.get() > 0) {
        return;
      }

      return this.readNow(rid);
    }

    return read;
  }();

  _proto.readNow = function () {
    function readNow() {
      var _this2 = this;

      var rid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Session.get('openedRoom');

      if (rid == null) {
        this.log('readMessage -> readNow canceled, no rid informed');
        return;
      }

      var subscription = ChatSubscription.findOne({
        rid: rid
      });

      if (subscription == null) {
        this.log('readMessage -> readNow canceled, no subscription found for rid:', rid);
        return;
      }

      return Meteor.call('readMessages', rid, function () {
        RoomHistoryManager.getRoom(rid).unreadNotLoaded.set(0);
        return _this2.emit(rid);
      });
    }

    return readNow;
  }();

  _proto.log = function () {
    function log() {
      var _console;

      return this.debug && (_console = console).log.apply(_console, arguments);
    }

    return log;
  }();

  _proto.disable = function () {
    function disable() {
      this.enabled = false;
    }

    return disable;
  }();

  _proto.enable = function () {
    function enable() {
      this.enabled = document.hasFocus();
    }

    return enable;
  }();

  _proto.isEnable = function () {
    function isEnable() {
      return this.enabled === true;
    }

    return isEnable;
  }();

  _proto.refreshUnreadMark = function () {
    function refreshUnreadMark(rid) {
      if (rid == null) {
        return;
      }

      var subscription = ChatSubscription.findOne({
        rid: rid
      }, {
        reactive: false
      });

      if (subscription == null) {
        return;
      }

      var room = RoomManager.openedRooms[subscription.t + subscription.name];

      if (room == null) {
        return;
      }

      if (!subscription.alert && subscription.unread === 0) {
        $('.message.first-unread').removeClass('first-unread');
        room.unreadSince.set(undefined);
        return;
      }

      var lastReadRecord = ChatMessage.findOne({
        rid: subscription.rid,
        ts: {
          $lt: subscription.ls
        }
      }, {
        sort: {
          ts: -1
        }
      });

      var _RoomHistoryManager$g = RoomHistoryManager.getRoom(rid),
          unreadNotLoaded = _RoomHistoryManager$g.unreadNotLoaded;

      if (lastReadRecord == null && unreadNotLoaded.get() === 0) {
        lastReadRecord = {
          ts: new Date(0)
        };
      }

      room.unreadSince.set((lastReadRecord || unreadNotLoaded.get() > 0) && subscription.ls);

      if (!lastReadRecord) {
        return;
      }

      var firstUnreadRecord = ChatMessage.findOne({
        'rid': subscription.rid,
        'ts': {
          $gt: lastReadRecord.ts
        },
        'u._id': {
          $ne: Meteor.userId()
        }
      }, {
        sort: {
          ts: 1
        }
      });

      if (firstUnreadRecord) {
        room.unreadFirstId = firstUnreadRecord._id;
        $('.message.first-unread').removeClass('first-unread');
        $(".message#" + firstUnreadRecord._id).addClass('first-unread');
      }
    }

    return refreshUnreadMark;
  }();

  return _class;
}(Emitter))();
Meteor.startup(function () {
  $(window).on('blur', function () {
    return readMessage.disable();
  }).on('focus', function () {
    readMessage.enable();
    readMessage.read();
  }).on('touchend', function () {
    readMessage.enable();
  }).on('keyup', function (e) {
    var key = e.which;

    if (key === 27) {
      // ESCAPE KEY
      var rid = Session.get('openedRoom');

      if (!rid) {
        return;
      }

      readMessage.readNow(rid);
      readMessage.refreshUnreadMark(rid);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/client/index.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/modal", {
  modal: "modal"
}, 0);
module.link("./lib/SideNav", {
  SideNav: "SideNav"
}, 1);
module.link("./lib/AccountBox", {
  AccountBox: "AccountBox"
}, 2);
module.link("./lib/menu", {
  menu: "menu"
}, 3);
module.link("./lib/MessageAction", {
  MessageAction: "MessageAction"
}, 4);
module.link("./lib/messageBox", {
  messageBox: "messageBox"
}, 5);
module.link("./lib/popover", {
  popover: "popover"
}, 6);
module.link("./lib/readMessages", {
  readMessage: "readMessage"
}, 7);
module.link("./lib/RoomManager", {
  RoomManager: "RoomManager"
}, 8);
module.link("./lib/RoomHistoryManager", {
  upsertMessage: "upsertMessage",
  RoomHistoryManager: "RoomHistoryManager",
  normalizeThreadMessage: "normalizeThreadMessage"
}, 9);
module.link("./lib/mainReady", {
  mainReady: "mainReady"
}, 10);
module.link("./lib/IframeLogin", {
  IframeLogin: "IframeLogin",
  iframeLogin: "iframeLogin"
}, 11);
module.link("./lib/popout", {
  popout: "popout"
}, 12);
module.link("../lib/MessageProperties", {
  messageProperties: "messageProperties"
}, 13);
module.link("../lib/MessageTypes", {
  MessageTypes: "MessageTypes"
}, 14);
module.link("../lib/Message", {
  Message: "Message"
}, 15);
module.link("./lib/openRoom", {
  openRoom: "openRoom"
}, 16);
module.link("./lib/collapseArrow", {
  "*": "*"
}, 17);
module.link("./lib/messageArgs", {
  "*": "*"
}, 18);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"Message.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/lib/Message.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Message: function () {
    return Message;
  }
});
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var s;
module.link("underscore.string", {
  "default": function (v) {
    s = v;
  }
}, 2);
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 3);
var MessageTypes;
module.link("./MessageTypes", {
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 4);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 5);
var Message = {
  parse: function (msg, language) {
    var messageType = MessageTypes.getType(msg);

    if (messageType) {
      if (messageType.render) {
        return messageType.render(msg);
      }

      if (messageType.template) {
        // Render message
        return;
      }

      if (messageType.message) {
        if (!language) {
          language = Meteor._localStorage.getItem('userLanguage');
        }

        var data = typeof messageType.data === 'function' && messageType.data(msg) || {};
        return TAPi18n.__(messageType.message, data, language);
      }
    }

    if (msg.u && msg.u.username === settings.get('Chatops_Username')) {
      msg.html = msg.msg;
      return msg.html;
    }

    msg.html = msg.msg;

    if (s.trim(msg.html) !== '') {
      msg.html = escapeHTML(msg.html);
    }

    msg.html = msg.html.replace(/\n/gm, '<br/>');
    return msg.html;
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"MessageProperties.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/lib/MessageProperties.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  messageProperties: function () {
    return messageProperties;
  }
});
var GraphemeSplitter;
module.link("grapheme-splitter", {
  "default": function (v) {
    GraphemeSplitter = v;
  }
}, 0);
var emoji;
module.link("../../emoji", {
  emoji: function (v) {
    emoji = v;
  }
}, 1);
var splitter = new GraphemeSplitter();
var messageProperties = {
  length: function (message) {
    return splitter.countGraphemes(message);
  },
  messageWithoutEmojiShortnames: function (message) {
    return message.replace(/:\w+:/gm, function (match) {
      if (emoji.list[match] !== undefined) {
        return ' ';
      }

      return match;
    });
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"MessageTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/lib/MessageTypes.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  MessageTypes: function () {
    return MessageTypes;
  }
});
var MessageTypes = new ( /*#__PURE__*/function () {
  function _class() {
    this.types = {};
  }

  var _proto = _class.prototype;

  _proto.registerType = function () {
    function registerType(options) {
      this.types[options.id] = options;
      return options;
    }

    return registerType;
  }();

  _proto.getType = function () {
    function getType(message) {
      return this.types[message && message.t];
    }

    return getType;
  }();

  _proto.isSystemMessage = function () {
    function isSystemMessage(message) {
      var type = this.types[message && message.t];
      return type && type.system;
    }

    return isSystemMessage;
  }();

  return _class;
}())();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-utils/index.js                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"livechat":{"client":{"views":{"app":{"dialog":{"closeRoom.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/dialog/closeRoom.html                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.closeRoom.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.closeRoom.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/dialog/template.closeRoom.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("closeRoom");
Template["closeRoom"] = new Template("Template.closeRoom", (function() {
  var view = this;
  return HTML.SECTION({
    class: "create-channel"
  }, "\n\t\t", HTML.DIV({
    class: "create-channel__wrapper"
  }, "\n\t\t\t", HTML.P({
    class: "create-channel__description"
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Close_room_description");
  })), "\n\t\t\t", HTML.FORM({
    id: "close-room",
    class: "close-room__content"
  }, "\n\t\t\t\t", HTML.DIV({
    class: "create-channel__inputs"
  }, "\n\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "rc-input ", Blaze.If(function() {
        return Spacebars.call(view.lookup("invalidComment"));
      }, function() {
        return "rc-input--error";
      }) ];
    }
  }, "\n\t\t\t\t\t\t", HTML.LABEL({
    class: "rc-input__label"
  }, "\n\t\t\t\t\t\t\t", HTML.DIV({
    class: "rc-input__wrapper"
  }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
    name: "comment",
    id: "comment",
    type: "text",
    class: "rc-input__element",
    placeholder: function() {
      return Spacebars.mustache(view.lookup("_"), "Please_add_a_comment");
    },
    autofocus: ""
  }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("invalidComment"));
  }, function() {
    return [ "\n\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error"
    }, "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error-icon"
    }, "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__error-icon"),
        icon: Spacebars.call("warning"),
        classes: Spacebars.call("rc-input__error-icon-svg")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error-message"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Please_add_a_comment_to_close_the_room");
    })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "rc-input ", Blaze.If(function() {
        return Spacebars.call(view.lookup("invalidTags"));
      }, function() {
        return "rc-input--error";
      }) ];
    }
  }, "\n\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasAvailableTags"));
  }, function() {
    return [ "\n\t\t\t\t\t\t", HTML.DIV({
      class: "rc-form-group rc-form-group--small rc-form-group--inline"
    }, "\n\t\t\t\t\t\t\t", HTML.SELECT({
      id: "tagSelect",
      class: "rc-input rc-input--small rc-form-item-inline"
    }, "\n\t\t\t\t\t\t\t\t", HTML.OPTION({
      value: "placeholder",
      disabled: "",
      selected: ""
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Select_tag");
    })), "\n\t\t\t\t\t\t\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("availableUserTags"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t\t\t", HTML.OPTION({
        value: function() {
          return Spacebars.mustache(view.lookup("_id"));
        }
      }, Blaze.View("lookup:.", function() {
        return Spacebars.mustache(view.lookup("."));
      })), "\n\t\t\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t\t\t"), HTML.Raw('\n\t\t\t\t\t\t\t<button id="addTag" class="rc-button rc-button--primary rc-form-item-inline"><i class="icon-plus"></i></button>\n\t\t\t\t\t\t')), "\n\t\t\t\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t\t\t", HTML.LABEL({
      class: "rc-input__label"
    }, "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__wrapper"
    }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__icon"
    }, "\n\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        icon: Spacebars.call("edit")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
      id: "tagInput",
      class: "rc-input__element",
      type: "text",
      name: "tags",
      autocomplete: "off",
      placeholder: function() {
        return Spacebars.mustache(view.lookup("tagsPlaceHolder"));
      }
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("invalidTags"));
  }, function() {
    return [ "\n\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error"
    }, "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error-icon"
    }, "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__error-icon"),
        icon: Spacebars.call("warning"),
        classes: Spacebars.call("rc-input__error-icon-svg")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__error-message"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "error-tags-must-be-assigned-before-closing-chat");
    })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
    class: "rc-form-group rc-form-group--small"
  }, "\n\t\t\t\t\t\t", HTML.UL({
    id: "tags",
    class: "chip-container current-room-tags"
  }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
    return Spacebars.call(view.lookup("tags"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", HTML.LI({
      class: "remove-tag",
      title: function() {
        return Spacebars.mustache(view.lookup("."));
      }
    }, "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("canRemoveTag"), view.lookup("availableUserTags"), view.lookup("."));
    }, function() {
      return HTML.Raw('\n\t\t\t\t\t\t\t\t\t<i class="icon icon-cancel-circled"></i>\n\t\t\t\t\t\t\t\t');
    }), "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:.", function() {
      return Spacebars.mustache(view.lookup("."));
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t\t", HTML.DIV({
    class: "rc-input"
  }, "\n\t\t\t\t", HTML.BUTTON({
    form: "close-room",
    class: "rc-button rc-button--primary js-close-room"
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), " Confirm ");
  })), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"closeRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/dialog/closeRoom.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 3);
var settings;
module.link("../../../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var modal;
module.link("../../../../../ui-utils/client", {
  modal: function (v) {
    modal = v;
  }
}, 5);
var APIClient, t;
module.link("../../../../../utils", {
  APIClient: function (v) {
    APIClient = v;
  },
  t: function (v) {
    t = v;
  }
}, 6);
var hasRole;
module.link("../../../../../authorization", {
  hasRole: function (v) {
    hasRole = v;
  }
}, 7);
module.link("./closeRoom.html");
var handleError;
module.link("../../../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 8);

var validateRoomComment = function (comment) {
  if (!settings.get('Livechat_request_comment_when_closing_conversation')) {
    return true;
  }

  return (comment === null || comment === void 0 ? void 0 : comment.length) > 0;
};

var validateRoomTags = function (tagsRequired, tags) {
  if (!tagsRequired) {
    return true;
  }

  return (tags === null || tags === void 0 ? void 0 : tags.length) > 0;
};

var checkUserTagPermission = function () {
  var availableUserTags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var tag = arguments.length > 1 ? arguments[1] : undefined;

  if (hasRole(Meteor.userId(), ['admin', 'livechat-manager'])) {
    return true;
  }

  return availableUserTags.includes(tag);
};

Template.closeRoom.helpers({
  invalidComment: function () {
    return Template.instance().invalidComment.get();
  },
  tags: function () {
    return Template.instance().tags.get();
  },
  invalidTags: function () {
    return Template.instance().invalidTags.get();
  },
  availableUserTags: function () {
    return Template.instance().availableUserTags.get();
  },
  tagsPlaceHolder: function () {
    var placeholder = TAPi18n.__('Enter_a_tag');

    if (!Template.instance().tagsRequired.get()) {
      placeholder = placeholder.concat("(" + TAPi18n.__('Optional') + ")");
    }

    return placeholder;
  },
  hasAvailableTags: function () {
    var tags = Template.instance().availableTags.get();
    return (tags === null || tags === void 0 ? void 0 : tags.length) > 0;
  },
  canRemoveTag: function (availableUserTags, tag) {
    return checkUserTagPermission(availableUserTags, tag);
  }
});
Template.closeRoom.events({
  'submit .close-room__content': function () {
    function _callee(e, instance) {
      var comment, tagsRequired, tags;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                e.preventDefault();
                e.stopPropagation();
                comment = instance.$('#comment').val();
                instance.invalidComment.set(!validateRoomComment(comment));

                if (!instance.invalidComment.get()) {
                  _context.next = 6;
                  break;
                }

                return _context.abrupt("return");

              case 6:
                tagsRequired = instance.tagsRequired.get();
                tags = instance.tags.get();
                instance.invalidTags.set(!validateRoomTags(tagsRequired, tags));

                if (!instance.invalidTags.get()) {
                  _context.next = 11;
                  break;
                }

                return _context.abrupt("return");

              case 11:
                Meteor.call('livechat:closeRoom', this.rid, comment, {
                  clientAction: true,
                  tags: tags
                }, function (error
                /* , result*/
                ) {
                  if (error) {
                    console.log(error);
                    return handleError(error);
                  }

                  modal.open({
                    title: t('Chat_closed'),
                    text: t('Chat_closed_successfully'),
                    type: 'success',
                    timer: 1000,
                    showConfirmButton: false
                  });
                });

              case 12:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, this, null, Promise);
    }

    return _callee;
  }(),
  'click .remove-tag': function (e, instance) {
    e.stopPropagation();
    e.preventDefault();
    var tag = this.valueOf();
    var availableTags = instance.availableTags.get();
    var hasAvailableTags = (availableTags === null || availableTags === void 0 ? void 0 : availableTags.length) > 0;
    var availableUserTags = instance.availableUserTags.get();

    if (hasAvailableTags && !checkUserTagPermission(availableUserTags, tag)) {
      return;
    }

    var tags = instance.tags.get();
    tags = tags.filter(function (el) {
      return el !== tag;
    });
    instance.tags.set(tags);
  },
  'click #addTag': function (e, instance) {
    e.stopPropagation();
    e.preventDefault();

    if ($('#tagSelect').find(':selected').is(':disabled')) {
      return;
    }

    var tags = _toConsumableArray(instance.tags.get());

    var tagVal = $('#tagSelect').val();

    if (tagVal === '' || tags.includes(tagVal)) {
      return;
    }

    tags.push(tagVal);
    instance.tags.set(tags);
    $('#tagSelect').val('placeholder');
  },
  'keydown #tagInput': function (e, instance) {
    if (e.which === 13) {
      e.stopPropagation();
      e.preventDefault();

      var tags = _toConsumableArray(instance.tags.get());

      var tagVal = $('#tagInput').val();

      if (tagVal === '' || tags.includes(tagVal)) {
        return;
      }

      tags.push(tagVal);
      instance.tags.set(tags);
      $('#tagInput').val('');
    }
  }
});
Template.closeRoom.onRendered(function () {
  this.find('#comment').focus();
});
Template.closeRoom.onCreated(function () {
  function _callee2() {
    var _this = this;

    var _Template$currentData, rid, _await$APIClient$v1$g, room, _await$APIClient$v1$g2, department, uid, _await$APIClient$v1$g3, departments, agentDepartments;

    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              this.tags = new ReactiveVar([]);
              this.invalidComment = new ReactiveVar(false);
              this.invalidTags = new ReactiveVar(false);
              this.tagsRequired = new ReactiveVar(false);
              this.availableTags = new ReactiveVar([]);
              this.availableUserTags = new ReactiveVar([]);
              this.agentDepartments = new ReactiveVar([]);

              this.onEnterTag = function () {
                return _this.invalidTags.set(!validateRoomTags(_this.tagsRequired.get(), _this.tags.get()));
              };

              _Template$currentData = Template.currentData(), rid = _Template$currentData.rid;
              _context2.next = 11;
              return _regeneratorRuntime.awrap(APIClient.v1.get("rooms.info?roomId=" + rid));

            case 11:
              _await$APIClient$v1$g = _context2.sent;
              room = _await$APIClient$v1$g.room;
              this.tags.set((room === null || room === void 0 ? void 0 : room.tags) || []);

              if (!(room !== null && room !== void 0 && room.departmentId)) {
                _context2.next = 20;
                break;
              }

              _context2.next = 17;
              return _regeneratorRuntime.awrap(APIClient.v1.get("livechat/department/" + room.departmentId + "?includeAgents=false"));

            case 17:
              _await$APIClient$v1$g2 = _context2.sent;
              department = _await$APIClient$v1$g2.department;
              this.tagsRequired.set(department === null || department === void 0 ? void 0 : department.requestTagBeforeClosingChat);

            case 20:
              uid = Meteor.userId();
              _context2.next = 23;
              return _regeneratorRuntime.awrap(APIClient.v1.get("livechat/agents/" + uid + "/departments"));

            case 23:
              _await$APIClient$v1$g3 = _context2.sent;
              departments = _await$APIClient$v1$g3.departments;
              agentDepartments = departments.map(function (dept) {
                return dept.departmentId;
              });
              this.agentDepartments.set(agentDepartments);
              Meteor.call('livechat:getTagsList', function (err, tagsList) {
                _this.availableTags.set(tagsList);

                var isAdmin = hasRole(uid, ['admin', 'livechat-manager']);
                var availableTags = tagsList.filter(function (_ref) {
                  var departments = _ref.departments;
                  return isAdmin || departments.length === 0 || departments.some(function (i) {
                    return agentDepartments.includes(i);
                  });
                }).map(function (_ref2) {
                  var name = _ref2.name;
                  return name;
                });

                _this.availableUserTags.set(availableTags);
              });

            case 28:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, this, null, Promise);
  }

  return _callee2;
}());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"tabbar":{"agentEdit.html":[
  "./template.agentEdit.js"
],"template.agentEdit.js":[],"agentInfo.html":[
  "./template.agentInfo.js"
],"template.agentInfo.js":[],"contactChatHistory.html":[
  "./template.contactChatHistory.js"
],"template.contactChatHistory.js":[],"contactChatHistoryItem.html":[
  "./template.contactChatHistoryItem.js"
],"template.contactChatHistoryItem.js":[],"contactChatHistoryMessages.html":[
  "./template.contactChatHistoryMessages.js"
],"template.contactChatHistoryMessages.js":[],"visitorEdit.html":[
  "./template.visitorEdit.js"
],"template.visitorEdit.js":[],"visitorEditCustomField.html":[
  "./template.visitorEditCustomField.js"
],"template.visitorEditCustomField.js":[],"visitorForward.html":[
  "./template.visitorForward.js"
],"template.visitorForward.js":[],"visitorInfo.html":[
  "./template.visitorInfo.js"
],"template.visitorInfo.js":[],"visitorNavigation.html":[
  "./template.visitorNavigation.js"
],"template.visitorNavigation.js":[],"visitorTranscript.html":[
  "./template.visitorTranscript.js"
],"template.visitorTranscript.js":[],"agentEdit.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/templating",
  "../customTemplates/register",
  "./agentEdit.html",
  "../../../../../authorization",
  "../../../../../utils/client",
  "../../../../../../client/lib/utils/handleError",
  "../../../../../../client/lib/toast"
],"agentInfo.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/session",
  "meteor/templating",
  "meteor/rocketchat:tap-i18n",
  "underscore",
  "underscore.string",
  "../customTemplates/register",
  "./agentInfo.html",
  "../../../../../ui-utils",
  "../../../../../utils/client",
  "../../../../../authorization",
  "../../../../../../client/lib/utils/handleError"
],"contactChatHistory.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "meteor/tracker",
  "meteor/templating",
  "moment",
  "meteor/reactive-var",
  "./contactChatHistory.html",
  "./contactChatHistoryItem.html",
  "underscore",
  "../../../../../utils/client"
],"contactChatHistoryItem.js":[
  "@babel/runtime/regenerator",
  "moment",
  "./contactChatHistoryItem.html",
  "meteor/templating",
  "meteor/reactive-var"
],"contactChatHistoryMessages.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "meteor/templating",
  "./contactChatHistoryMessages.html",
  "meteor/reactive-var",
  "underscore",
  "../../../../../ui-utils/client/lib/messageContext",
  "../../../../../utils/client"
],"visitorEdit.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/templating",
  "../../../../../utils",
  "../../../../../authorization/client",
  "./visitorEdit.html",
  "../../../../../utils/client",
  "../customTemplates/register",
  "../../../../../../client/lib/toast"
],"visitorEditCustomField.js":[
  "meteor/templating",
  "./visitorEditCustomField.html"
],"visitorForward.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/kadira:flow-router",
  "meteor/templating",
  "../../../../../models",
  "../../../../../utils",
  "./visitorForward.html",
  "../../../../../utils/client",
  "../../../../../../client/lib/toast"
],"visitorInfo.js":[
  "@babel/runtime/regenerator",
  "meteor/rocketchat:tap-i18n",
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/kadira:flow-router",
  "meteor/session",
  "meteor/templating",
  "underscore",
  "moment",
  "ua-parser-js",
  "../../../../../ui-utils",
  "../../../../../models",
  "../../../../../settings",
  "../../../../../utils",
  "../../../../../authorization",
  "./visitorInfo.html",
  "../../../../../utils/client",
  "../../../../../ui-utils/client",
  "../customTemplates/register",
  "../../../../../markdown/client",
  "../../../../../../client/lib/utils/handleError",
  "../../../../../../client/lib/utils/formatDateAndTime"
],"visitorNavigation.js":[
  "@babel/runtime/regenerator",
  "meteor/reactive-var",
  "meteor/templating",
  "moment",
  "underscore",
  "../../../../../models",
  "../../../../../utils",
  "./visitorNavigation.html",
  "../../../../../utils/client"
],"visitorTranscript.js":[
  "@babel/runtime/regenerator",
  "meteor/meteor",
  "meteor/reactive-var",
  "meteor/templating",
  "../../../../../../client/lib/toast",
  "../../../../../../client/lib/utils/handleError",
  "../../../../../utils",
  "../../../../../utils/client",
  "./visitorTranscript.html",
  "../../../../../../lib/emailValidator"
]},"livechatDashboard.html":[
  "./template.livechatDashboard.js"
],"template.livechatDashboard.js":[],"livechatNotSubscribed.html":[
  "./template.livechatNotSubscribed.js"
],"template.livechatNotSubscribed.js":[],"livechatReadOnly.html":[
  "./template.livechatReadOnly.js"
],"template.livechatReadOnly.js":[],"livechatRoomTagSelector.html":[
  "./template.livechatRoomTagSelector.js"
],"template.livechatRoomTagSelector.js":[],"business-hours":{"BusinessHours.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/business-hours/BusinessHours.ts                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  businessHourManager: function () {
    return businessHourManager;
  }
});
var SingleBusinessHourBehavior;
module.link("./Single", {
  SingleBusinessHourBehavior: function (v) {
    SingleBusinessHourBehavior = v;
  }
}, 0);

var BusinessHoursManager = /*#__PURE__*/function () {
  function BusinessHoursManager(businessHour) {
    this.behavior = void 0;
    this.setBusinessHourBehavior(businessHour);
  }

  var _proto = BusinessHoursManager.prototype;

  _proto.setBusinessHourBehavior = function () {
    function setBusinessHourBehavior(businessHour) {
      this.registerBusinessHourBehavior(businessHour);
    }

    return setBusinessHourBehavior;
  }();

  _proto.registerBusinessHourBehavior = function () {
    function registerBusinessHourBehavior(behavior) {
      this.behavior = behavior;
    }

    return registerBusinessHourBehavior;
  }();

  _proto.getTemplate = function () {
    function getTemplate() {
      return this.behavior.getView();
    }

    return getTemplate;
  }();

  _proto.showCustomTemplate = function () {
    function showCustomTemplate(businessHourData) {
      return this.behavior.showCustomTemplate(businessHourData);
    }

    return showCustomTemplate;
  }();

  _proto.showBackButton = function () {
    function showBackButton() {
      return this.behavior.showBackButton();
    }

    return showBackButton;
  }();

  _proto.showTimezoneTemplate = function () {
    function showTimezoneTemplate() {
      return this.behavior.showTimezoneTemplate();
    }

    return showTimezoneTemplate;
  }();

  return BusinessHoursManager;
}();

var businessHourManager = new BusinessHoursManager(new SingleBusinessHourBehavior());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Single.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/business-hours/Single.ts                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  SingleBusinessHourBehavior: function () {
    return SingleBusinessHourBehavior;
  }
});

var SingleBusinessHourBehavior = /*#__PURE__*/function () {
  function SingleBusinessHourBehavior() {}

  var _proto = SingleBusinessHourBehavior.prototype;

  _proto.getView = function () {
    function getView() {
      return 'livechatBusinessHoursForm';
    }

    return getView;
  }();

  _proto.showCustomTemplate = function () {
    function showCustomTemplate() {
      return false;
    }

    return showCustomTemplate;
  }();

  _proto.showBackButton = function () {
    function showBackButton() {
      return false;
    }

    return showBackButton;
  }();

  _proto.showTimezoneTemplate = function () {
    function showTimezoneTemplate() {
      return false;
    }

    return showTimezoneTemplate;
  }();

  return SingleBusinessHourBehavior;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"customTemplates":{"register.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/views/app/customTemplates/register.js                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  customFormTemplate: function () {
    return customFormTemplate;
  },
  addCustomFormTemplate: function () {
    return addCustomFormTemplate;
  },
  removeCustomTemplate: function () {
    return removeCustomTemplate;
  },
  getCustomFormTemplate: function () {
    return getCustomFormTemplate;
  }
});
var customFormTemplate = new Map();

var addCustomFormTemplate = function (form, customTemplateName) {
  return customFormTemplate.set(form, customTemplateName);
};

var removeCustomTemplate = function (form) {
  return customFormTemplate.delete(form);
};

var getCustomFormTemplate = function (form) {
  return customFormTemplate.get(form);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"livechatReadOnly.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/regenerator",
  "meteor/meteor",
  "meteor/templating",
  "meteor/reactive-var",
  "meteor/kadira:flow-router",
  "../../../../models",
  "../../../../../client/lib/utils/callWithErrorHandling",
  "./livechatReadOnly.html",
  "../../../../utils/client",
  "../../lib/stream/inquiry"
],"livechatRoomTagSelector.js":[
  "meteor/meteor",
  "meteor/templating",
  "meteor/reactive-var",
  "./livechatRoomTagSelector.html"
]},"admin.js":[
  "./app/livechatDashboard.html"
],"regular.js":[
  "./app/livechatReadOnly",
  "./app/livechatNotSubscribed.html",
  "./app/livechatRoomTagSelector",
  "./app/tabbar/agentEdit",
  "./app/tabbar/agentInfo",
  "./app/tabbar/visitorEdit",
  "./app/tabbar/visitorEditCustomField",
  "./app/tabbar/visitorForward",
  "./app/tabbar/contactChatHistory",
  "./app/tabbar/contactChatHistoryItem",
  "./app/tabbar/contactChatHistoryMessages",
  "./app/tabbar/visitorInfo",
  "./app/tabbar/visitorNavigation",
  "./app/tabbar/visitorTranscript"
]},"externalFrame":{"externalFrameContainer.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/externalFrameContainer.html                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.externalFrameContainer.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.externalFrameContainer.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/template.externalFrameContainer.js                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("ExternalFrameContainer");
Template["ExternalFrameContainer"] = new Template("Template.ExternalFrameContainer", (function() {
  var view = this;
  return HTML.DIV({
    class: "flex-nav"
  }, "\n\t\t", HTML.IFRAME({
    class: "external-frame",
    src: function() {
      return Spacebars.mustache(view.lookup("externalFrameUrl"));
    }
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"crypto.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/crypto.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);
module.export({
  generateKey: function () {
    return generateKey;
  },
  getKeyFromString: function () {
    return getKeyFromString;
  },
  encrypt: function () {
    return encrypt;
  },
  decrypt: function () {
    return decrypt;
  }
});

function ab2str(buf) {
  return String.fromCharCode.apply(String, _toConsumableArray(new Uint16Array(buf)));
}

function str2ab(str) {
  var buf = new ArrayBuffer(str.length * 2); // 2 bytes for each char

  var bufView = new Uint16Array(buf);

  for (var i = 0, strLen = str.length; i < strLen; i++) {
    bufView[i] = str.charCodeAt(i);
  }

  return buf;
}

function generateKey() {
  var key, exportedKey;
  return _regeneratorRuntime.async(function () {
    function generateKey$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.next = 2;
            return _regeneratorRuntime.awrap(crypto.subtle.generateKey({
              name: 'AES-GCM',
              length: 256
            }, true, ['encrypt', 'decrypt']));

          case 2:
            key = _context.sent;
            _context.next = 5;
            return _regeneratorRuntime.awrap(crypto.subtle.exportKey('jwk', key));

          case 5:
            exportedKey = _context.sent;
            return _context.abrupt("return", JSON.stringify(exportedKey));

          case 7:
          case "end":
            return _context.stop();
        }
      }
    }

    return generateKey$;
  }(), null, null, null, Promise);
}

function getKeyFromString(keyStr) {
  var key;
  return _regeneratorRuntime.async(function () {
    function getKeyFromString$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            key = JSON.parse(keyStr);
            return _context2.abrupt("return", crypto.subtle.importKey('jwk', key, {
              name: 'AES-GCM',
              length: 256
            }, true, ['encrypt', 'decrypt']));

          case 2:
          case "end":
            return _context2.stop();
        }
      }
    }

    return getKeyFromString$;
  }(), null, null, null, Promise);
}

function encrypt(text, key) {
  var vector, data, enc, cipherText;
  return _regeneratorRuntime.async(function () {
    function encrypt$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            vector = crypto.getRandomValues(new Uint8Array(16));
            data = new TextEncoder().encode(text);
            _context3.next = 4;
            return _regeneratorRuntime.awrap(crypto.subtle.encrypt({
              name: 'AES-GCM',
              iv: vector
            }, key, data));

          case 4:
            enc = _context3.sent;
            cipherText = new Uint8Array(enc);
            return _context3.abrupt("return", encodeURIComponent(btoa(ab2str(vector) + ab2str(cipherText))));

          case 7:
          case "end":
            return _context3.stop();
        }
      }
    }

    return encrypt$;
  }(), null, null, null, Promise);
}

function decrypt(data, key) {
  var binaryData, vector, buffer, decoded;
  return _regeneratorRuntime.async(function () {
    function decrypt$(_context4) {
      while (1) {
        switch (_context4.prev = _context4.next) {
          case 0:
            binaryData = atob(decodeURIComponent(data));
            vector = new Uint8Array(new Uint16Array(str2ab(binaryData.slice(0, 16))));
            buffer = new Uint8Array(new Uint16Array(str2ab(binaryData.slice(16))));
            _context4.next = 5;
            return _regeneratorRuntime.awrap(crypto.subtle.decrypt({
              name: 'AES-GCM',
              iv: vector
            }, key, buffer));

          case 5:
            decoded = _context4.sent;
            return _context4.abrupt("return", new TextDecoder().decode(decoded));

          case 7:
          case "end":
            return _context4.stop();
        }
      }
    }

    return decrypt$;
  }(), null, null, null, Promise);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"externalFrameContainer.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/externalFrameContainer.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 2);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 3);
var APIClient;
module.link("../../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 4);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 5);
var encrypt, getKeyFromString;
module.link("./crypto", {
  encrypt: function (v) {
    encrypt = v;
  },
  getKeyFromString: function (v) {
    getKeyFromString = v;
  }
}, 6);
module.link("./externalFrameContainer.html");
Template.ExternalFrameContainer.helpers({
  externalFrameUrl: function () {
    var authToken = Template.instance().authToken.get();

    if (!authToken) {
      return '';
    }

    var frameURLSetting = settings.get('Omnichannel_External_Frame_URL');

    try {
      var frameURL = new URL(frameURLSetting);
      frameURL.searchParams.append('uid', Meteor.userId());
      frameURL.searchParams.append('rid', Session.get('openedRoom'));
      frameURL.searchParams.append('t', authToken);
      return frameURL.toString();
    } catch (_unused) {
      console.error('Invalid URL provided to external frame');
      return '';
    }
  }
});
Template.ExternalFrameContainer.onCreated(function () {
  function _callee() {
    var _APIClient$getCredent, authToken, keyStr;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              this.authToken = new ReactiveVar();
              _APIClient$getCredent = APIClient.getCredentials(), authToken = _APIClient$getCredent['X-Auth-Token'];
              keyStr = settings.get('Omnichannel_External_Frame_Encryption_JWK');

              if (!keyStr) {
                _context.next = 16;
                break;
              }

              _context.t0 = this.authToken;
              _context.t1 = _regeneratorRuntime;
              _context.t2 = encrypt;
              _context.t3 = authToken;
              _context.next = 10;
              return _regeneratorRuntime.awrap(getKeyFromString(keyStr));

            case 10:
              _context.t4 = _context.sent;
              _context.t5 = (0, _context.t2)(_context.t3, _context.t4);
              _context.next = 14;
              return _context.t1.awrap.call(_context.t1, _context.t5);

            case 14:
              _context.t6 = _context.sent;
              return _context.abrupt("return", _context.t0.set.call(_context.t0, _context.t6));

            case 16:
              this.authToken.set(authToken);

            case 17:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, this, null, Promise);
  }

  return _callee;
}());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"generateNewKey.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/generateNewKey.ts                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var generateKey;
module.link("./crypto", {
  generateKey: function (v) {
    generateKey = v;
  }
}, 1);
Meteor.methods({
  omnichannelExternalFrameGenerateKey: function () {
    function _callee() {
      var key;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return _regeneratorRuntime.awrap(generateKey());

              case 2:
                key = _context.sent;
                Meteor.call('saveSetting', 'Omnichannel_External_Frame_Encryption_JWK', key);

              case 4:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }()
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/index.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./generateNewKey");
module.link("./tabBar");
module.link("./externalFrameContainer");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/externalFrame/tabBar.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMemo;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var useSetting;
module.link("../../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 1);
var addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 2);
addAction('omnichannel-external-frame', function () {
  var enabled = useSetting('Omnichannel_External_Frame_Enabled');
  return useMemo(function () {
    return enabled ? {
      groups: ['live'],
      id: 'omnichannel-external-frame',
      title: 'Omnichannel_External_Frame',
      icon: 'cube',
      template: 'ExternalFrameContainer',
      order: -1
    } : null;
  }, [enabled]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"stream":{"inquiry.js":[
  "meteor/meteor",
  "../../../lib/stream/constants"
],"queueManager.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "meteor/meteor",
  "../../../../utils/client",
  "../../collections/LivechatInquiry",
  "./inquiry",
  "../../../../../client/lib/utils/callWithErrorHandling",
  "../../../../utils",
  "../../../../custom-sounds/client/lib/CustomSounds"
]},"chartHandler.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "meteor/rocketchat:tap-i18n"
],"messageTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/lib/messageTypes.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var actionLinks;
module.link("../../../action-links/client", {
  actionLinks: function (v) {
    actionLinks = v;
  }
}, 0);
actionLinks.register('createLivechatCall', function (message, params, instance) {
  instance.tabBar.open('video');
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"collections":{"LivechatInquiry.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/collections/LivechatInquiry.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  LivechatInquiry: function () {
    return LivechatInquiry;
  }
});
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
var LivechatInquiry = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"startup":{"notifyUnreadRooms.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/startup/notifyUnreadRooms.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var getUserPreference;
module.link("../../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 3);
var Subscriptions, Users;
module.link("../../../models", {
  Subscriptions: function (v) {
    Subscriptions = v;
  },
  Users: function (v) {
    Users = v;
  }
}, 4);
var CustomSounds;
module.link("../../../custom-sounds/client", {
  CustomSounds: function (v) {
    CustomSounds = v;
  }
}, 5);
var audio = null;
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (!settings.get('Livechat_continuous_sound_notification_new_livechat_room')) {
      audio && audio.pause();
      return;
    }

    var subs = Subscriptions.find({
      t: 'l',
      ls: {
        $exists: 0
      },
      open: true
    }).count();

    if (subs === 0) {
      audio && audio.pause();
      return;
    }

    var user = Users.findOne(Meteor.userId(), {
      fields: {
        'settings.preferences.newRoomNotification': 1
      }
    });
    var newRoomNotification = getUserPreference(user, 'newRoomNotification');
    audio = CustomSounds.play(newRoomNotification, {
      loop: true
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"stylesheets":{"livechat.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/stylesheets/livechat.css                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/index.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/messageTypes");
module.link("./roomType");
module.link("./route");
module.link("./ui");
module.link("./tabBar");
module.link("./startup/notifyUnreadRooms");
module.link("./views/app/dialog/closeRoom");
module.link("./stylesheets/livechat.css");
module.link("./externalFrame");
module.link("./lib/messageTypes");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/roomType.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var roomTypes;
module.link("../../utils", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 0);
var LivechatRoomType;
module.link("../lib/LivechatRoomType", {
  "default": function (v) {
    LivechatRoomType = v;
  }
}, 1);
roomTypes.add(new LivechatRoomType());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"route.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/route.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  livechatManagerRoutes: function () {
    return livechatManagerRoutes;
  },
  load: function () {
    return load;
  }
});
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var AccountBox;
module.link("../../ui-utils", {
  AccountBox: function (v) {
    AccountBox = v;
  }
}, 1);
module.link("../../../client/views/omnichannel/routes");
var livechatManagerRoutes = FlowRouter.group({
  prefix: '/omnichannel',
  name: 'omnichannel'
});

var load = function () {
  return module.dynamicImport('./views/admin');
};

AccountBox.addRoute({
  name: 'livechat-dashboard',
  path: '/dashboard',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Livechat_Dashboard',
  pageTemplate: 'livechatDashboard'
}, livechatManagerRoutes, load);
AccountBox.addRoute({
  name: 'livechat-departments',
  path: '/departments',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Departments',
  pageTemplate: 'livechatDepartments'
}, livechatManagerRoutes, load);
AccountBox.addRoute({
  name: 'livechat-department-edit',
  path: '/departments/:_id/edit',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Edit_Department',
  pageTemplate: 'livechatDepartmentForm',
  customContainer: true
}, livechatManagerRoutes, load);
AccountBox.addRoute({
  name: 'livechat-department-new',
  path: '/departments/new',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'New_Department',
  pageTemplate: 'livechatDepartmentForm',
  customContainer: true
}, livechatManagerRoutes, load);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/tabBar.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var lazy;
module.link("react", {
  lazy: function (v) {
    lazy = v;
  }
}, 0);
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
addAction('room-info', {
  groups: ['live'],
  id: 'room-info',
  title: 'Room_Info',
  icon: 'info-circled',
  template: /*#__PURE__*/lazy(function () {
    return module.dynamicImport('../../../client/views/omnichannel/directory/chats/contextualBar/ChatsContextualBar');
  }),
  order: 0
});
addAction('contact-chat-history', {
  groups: ['live'],
  id: 'contact-chat-history',
  title: 'Contact_Chat_History',
  icon: 'clock',
  template: 'contactChatHistory',
  order: 11
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ui.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/client/ui.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 0);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);
var hasAllPermission;
module.link("../../authorization", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  }
}, 2);
var AccountBox, MessageTypes;
module.link("../../ui-utils", {
  AccountBox: function (v) {
    AccountBox = v;
  },
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 3);
Tracker.autorun(function (c) {
  // import omnichannel tabbar templates right away if omnichannel enabled
  if (!settings.get('Livechat_enabled')) {
    return;
  }

  module.dynamicImport('./views/regular');
  c.stop();
});
AccountBox.addItem({
  name: 'Omnichannel',
  icon: 'headset',
  href: '/omnichannel/current',
  sideNav: 'omnichannelFlex',
  condition: function () {
    return settings.get('Livechat_enabled') && hasAllPermission('view-livechat-manager');
  }
});
MessageTypes.registerType({
  id: 'livechat-close',
  system: true,
  message: 'Conversation_closed',
  data: function (message) {
    return {
      comment: message.msg
    };
  }
});
MessageTypes.registerType({
  id: 'livechat-started',
  system: true,
  message: 'Chat_started'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"stream":{"constants.js":[]},"LivechatRoomType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/lib/LivechatRoomType.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  "default": function () {
    return LivechatRoomType;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var ChatRoom;
module.link("../../models", {
  ChatRoom: function (v) {
    ChatRoom = v;
  }
}, 2);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var hasPermission;
module.link("../../authorization", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 4);
var openRoom;
module.link("../../ui-utils", {
  openRoom: function (v) {
    openRoom = v;
  }
}, 5);
var RoomMemberActions, RoomSettingsEnum, UiTextContext, RoomTypeRouteConfig, RoomTypeConfig;
module.link("../../utils", {
  RoomMemberActions: function (v) {
    RoomMemberActions = v;
  },
  RoomSettingsEnum: function (v) {
    RoomSettingsEnum = v;
  },
  UiTextContext: function (v) {
    UiTextContext = v;
  },
  RoomTypeRouteConfig: function (v) {
    RoomTypeRouteConfig = v;
  },
  RoomTypeConfig: function (v) {
    RoomTypeConfig = v;
  }
}, 6);
var getAvatarURL;
module.link("../../utils/lib/getAvatarURL", {
  getAvatarURL: function (v) {
    getAvatarURL = v;
  }
}, 7);
var LivechatInquiry;

if (Meteor.isClient) {
  var _require = require('../client/collections/LivechatInquiry');

  LivechatInquiry = _require.LivechatInquiry;
}

var LivechatRoomRoute = /*#__PURE__*/function (_RoomTypeRouteConfig) {
  _inheritsLoose(LivechatRoomRoute, _RoomTypeRouteConfig);

  function LivechatRoomRoute() {
    return _RoomTypeRouteConfig.call(this, {
      name: 'live',
      path: '/live/:id/:tab?/:context?'
    }) || this;
  }

  var _proto = LivechatRoomRoute.prototype;

  _proto.action = function () {
    function action(params) {
      openRoom('l', params.id);
    }

    return action;
  }();

  _proto.link = function () {
    function link(sub) {
      return {
        id: sub.rid
      };
    }

    return link;
  }();

  return LivechatRoomRoute;
}(RoomTypeRouteConfig);

var LivechatRoomType = /*#__PURE__*/function (_RoomTypeConfig) {
  _inheritsLoose(LivechatRoomType, _RoomTypeConfig);

  function LivechatRoomType() {
    var _this;

    _this = _RoomTypeConfig.call(this, {
      identifier: 'l',
      order: 5,
      icon: 'omnichannel',
      label: 'Omnichannel',
      route: new LivechatRoomRoute()
    }) || this;
    _this.notSubscribedTpl = 'livechatNotSubscribed';
    _this.readOnlyTpl = 'livechatReadOnly';
    return _this;
  }

  var _proto2 = LivechatRoomType.prototype;

  _proto2.enableMembersListProfile = function () {
    function enableMembersListProfile() {
      return true;
    }

    return enableMembersListProfile;
  }();

  _proto2.findRoom = function () {
    function findRoom(identifier) {
      return ChatRoom.findOne({
        _id: identifier
      });
    }

    return findRoom;
  }();

  _proto2.roomName = function () {
    function roomName(roomData) {
      return roomData.name || roomData.fname || roomData.label;
    }

    return roomName;
  }();

  _proto2.condition = function () {
    function condition() {
      return settings.get('Livechat_enabled') && hasPermission('view-l-room');
    }

    return condition;
  }();

  _proto2.canSendMessage = function () {
    function canSendMessage(rid) {
      var room = ChatRoom.findOne({
        _id: rid
      }, {
        fields: {
          open: 1
        }
      });
      return room && room.open === true;
    }

    return canSendMessage;
  }();

  _proto2.getUserStatus = function () {
    function getUserStatus(rid) {
      var room = Session.get("roomData" + rid);

      if (room) {
        return room.v && room.v.status;
      }

      var inquiry = LivechatInquiry.findOne({
        rid: rid
      });
      return inquiry && inquiry.v && inquiry.v.status;
    }

    return getUserStatus;
  }();

  _proto2.allowRoomSettingChange = function () {
    function allowRoomSettingChange(room, setting) {
      switch (setting) {
        case RoomSettingsEnum.JOIN_CODE:
          return false;

        default:
          return true;
      }
    }

    return allowRoomSettingChange;
  }();

  _proto2.allowMemberAction = function () {
    function allowMemberAction(room, action) {
      return [RoomMemberActions.INVITE, RoomMemberActions.JOIN].includes(action);
    }

    return allowMemberAction;
  }();

  _proto2.getUiText = function () {
    function getUiText(context) {
      switch (context) {
        case UiTextContext.HIDE_WARNING:
          return 'Hide_Livechat_Warning';

        case UiTextContext.LEAVE_WARNING:
          return 'Hide_Livechat_Warning';

        default:
          return '';
      }
    }

    return getUiText;
  }();

  _proto2.readOnly = function () {
    function readOnly(rid) {
      var room = ChatRoom.findOne({
        _id: rid
      }, {
        fields: {
          open: 1,
          servedBy: 1
        }
      });

      if (!room || !room.open) {
        return true;
      }

      var inquiry = LivechatInquiry.findOne({
        rid: rid
      }, {
        fields: {
          status: 1
        }
      });

      if (inquiry && inquiry.status === 'queued') {
        return true;
      }

      return !room.servedBy;
    }

    return readOnly;
  }();

  _proto2.getAvatarPath = function () {
    function getAvatarPath(roomData) {
      return getAvatarURL({
        username: "@" + this.roomName(roomData)
      });
    }

    return getAvatarPath;
  }();

  _proto2.openCustomProfileTab = function () {
    function openCustomProfileTab(instance, room, username) {
      if (!room || !room.v || room.v.username !== username) {
        return false;
      }

      instance.tabBar.openUserInfo();
      return true;
    }

    return openCustomProfileTab;
  }();

  _proto2.showQuickActionButtons = function () {
    function showQuickActionButtons() {
      return true;
    }

    return showQuickActionButtons;
  }();

  _proto2.isLivechatRoom = function () {
    function isLivechatRoom() {
      return true;
    }

    return isLivechatRoom;
  }();

  return LivechatRoomType;
}(RoomTypeConfig);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livechat/lib/messageTypes.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
var formatDistance;
module.link("date-fns/formatDistance", {
  "default": function (v) {
    formatDistance = v;
  }
}, 0);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 1);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 2);
var MessageTypes;
module.link("../../ui-utils", {
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 3);
MessageTypes.registerType({
  id: 'livechat_navigation_history',
  system: true,
  message: 'New_visitor_navigation',
  data: function (message) {
    if (!message.navigation || !message.navigation.page) {
      return;
    }

    return {
      history: "" + ((message.navigation.page.title ? message.navigation.page.title + " - " : '') + message.navigation.page.location.href)
    };
  }
});
MessageTypes.registerType({
  id: 'livechat_transfer_history',
  system: true,
  message: 'New_chat_transfer',
  data: function (message) {
    if (!message.transferData) {
      return;
    }

    var comment = message.transferData.comment;
    var commentLabel = comment && comment !== '' ? '_with_a_comment' : '';
    var from = message.transferData.transferredBy && (message.transferData.transferredBy.name || message.transferData.transferredBy.username);
    var transferTypes = {
      agent: function () {
        return TAPi18n.__("Livechat_transfer_to_agent" + commentLabel, _objectSpread({
          from: from,
          to: message.transferData.transferredTo && (message.transferData.transferredTo.name || message.transferData.transferredTo.username)
        }, comment && {
          comment: comment
        }));
      },
      department: function () {
        return TAPi18n.__("Livechat_transfer_to_department" + commentLabel, _objectSpread({
          from: from,
          to: message.transferData.nextDepartment && message.transferData.nextDepartment.name
        }, comment && {
          comment: comment
        }));
      },
      queue: function () {
        return TAPi18n.__('Livechat_transfer_return_to_the_queue', {
          from: from
        });
      }
    };
    return {
      transfer: transferTypes[message.transferData.scope]()
    };
  }
});
MessageTypes.registerType({
  id: 'livechat_transcript_history',
  system: true,
  message: 'Livechat_chat_transcript_sent',
  data: function (message) {
    if (!message.requestData) {
      return;
    }

    var _message$requestData = message.requestData;
    _message$requestData = _message$requestData === void 0 ? {} : _message$requestData;
    var type = _message$requestData.type,
        _message$requestData$ = _message$requestData.visitor,
        visitor = _message$requestData$ === void 0 ? {} : _message$requestData$,
        _message$requestData$2 = _message$requestData.user,
        user = _message$requestData$2 === void 0 ? {} : _message$requestData$2;
    var requestTypes = {
      visitor: function () {
        return TAPi18n.__('Livechat_visitor_transcript_request', {
          guest: visitor.name || visitor.username
        });
      },
      user: function () {
        return TAPi18n.__('Livechat_user_sent_chat_transcript_to_visitor', {
          agent: user.name || user.username,
          guest: visitor.name || visitor.username
        });
      }
    };
    return {
      transcript: requestTypes[type]()
    };
  }
});
MessageTypes.registerType({
  id: 'livechat_video_call',
  system: true,
  message: 'New_videocall_request'
});
MessageTypes.registerType({
  id: 'livechat_webrtc_video_call',
  render: function (message) {
    if (message.msg === 'ended' && message.webRtcCallEndTs && message.ts) {
      return TAPi18n.__('WebRTC_call_ended_message', {
        callDuration: formatDistance(new Date(message.webRtcCallEndTs), new Date(message.ts)),
        endTime: moment(message.webRtcCallEndTs).format('h:mm A')
      });
    }

    if (message.msg === 'declined' && message.webRtcCallEndTs) {
      return TAPi18n.__('WebRTC_call_declined_message');
    }

    return message.msg;
  }
});
MessageTypes.registerType({
  id: 'omnichannel_placed_chat_on_hold',
  system: true,
  message: 'Omnichannel_placed_chat_on_hold',
  data: function (message) {
    return {
      comment: message.comment
    };
  }
});
MessageTypes.registerType({
  id: 'omnichannel_on_hold_chat_resumed',
  system: true,
  message: 'Omnichannel_on_hold_chat_resumed',
  data: function (message) {
    return {
      comment: message.comment
    };
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"message-snippet":{"client":{"tabBar":{"views":{"snippetedMessages.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/tabBar/views/snippetedMessages.html                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.snippetedMessages.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.snippetedMessages.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/tabBar/views/template.snippetedMessages.js                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("snippetedMessages");
Template["snippetedMessages"] = new Template("Template.snippetedMessages", (function() {
  var view = this;
  return [ HTML.DIV({
    class: "list-view snippeted-messages-list flex-tab__header"
  }, "\n\t\t", HTML.DIV({
    class: "title"
  }, "\n\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Snippet_Messages");
  })), "\n\t\t"), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.templateInstance().subscriptionsReady());
  }, function() {
    return [ "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hasMessages"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "No_snippet_messages");
      })), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t"), "\n\t", HTML.DIV({
    class: "flex-tab__result js-list"
  }, "\n\t\t", HTML.UL({
    class: "list clearfix"
  }, "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("messages")),
        _variable: "msg"
      };
    }, function() {
      return Blaze._TemplateWith(function() {
        return {
          msg: Spacebars.call(view.lookup("msg")),
          room: Spacebars.call(view.lookup("room")),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          u: Spacebars.call(view.lookup("u"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      });
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasMore"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "load-more"
    }, "\n\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t"), "\n\t\t" ];
  }), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"snippetedMessages.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/tabBar/views/snippetedMessages.js                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["_id"],
    _excluded2 = ["_id"];

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 3);
var messageContext;
module.link("../../../../ui-utils/client/lib/messageContext", {
  messageContext: function (v) {
    messageContext = v;
  }
}, 4);
var APIClient;
module.link("../../../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 5);
var Messages;
module.link("../../../../models/client", {
  Messages: function (v) {
    Messages = v;
  }
}, 6);
var upsertMessageBulk;
module.link("../../../../ui-utils/client/lib/RoomHistoryManager", {
  upsertMessageBulk: function (v) {
    upsertMessageBulk = v;
  }
}, 7);
var LIMIT_DEFAULT = 50;
Template.snippetedMessages.helpers({
  hasMessages: function () {
    return Template.instance().messages.find().count();
  },
  messages: function () {
    var instance = Template.instance();
    return instance.messages.find({}, {
      limit: instance.limit.get(),
      sort: {
        ts: -1
      }
    });
  },
  hasMore: function () {
    return Template.instance().hasMore.get();
  },
  messageContext: messageContext
});
Template.snippetedMessages.onCreated(function () {
  var _this = this;

  this.rid = this.data.rid;
  this.hasMore = new ReactiveVar(true);
  this.messages = new Mongo.Collection(null);
  this.limit = new ReactiveVar(LIMIT_DEFAULT);
  this.autorun(function () {
    var query = {
      _hidden: {
        $ne: true
      },
      snippeted: true,
      rid: _this.rid
    };
    _this.cursor && _this.cursor.stop();

    _this.limit.set(LIMIT_DEFAULT);

    _this.cursor = Messages.find(query).observe({
      added: function (_ref) {
        var _id = _ref._id,
            message = _objectWithoutProperties(_ref, _excluded);

        _this.messages.upsert({
          _id: _id
        }, message);
      },
      changed: function (_ref2) {
        var _id = _ref2._id,
            message = _objectWithoutProperties(_ref2, _excluded2);

        _this.messages.upsert({
          _id: _id
        }, message);
      },
      removed: function (_ref3) {
        var _id = _ref3._id;

        _this.messages.remove({
          _id: _id
        });
      }
    });
  });
  this.autorun(function () {
    function _callee() {
      var limit, _await$APIClient$v1$g, messages, total;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                limit = _this.limit.get();
                _context.next = 3;
                return _regeneratorRuntime.awrap(APIClient.v1.get("chat.getSnippetedMessages?roomId=" + _this.rid + "&count=" + limit));

              case 3:
                _await$APIClient$v1$g = _context.sent;
                messages = _await$APIClient$v1$g.messages;
                total = _await$APIClient$v1$g.total;
                upsertMessageBulk({
                  msgs: messages
                }, _this.messages);

                _this.hasMore.set(total > limit);

              case 8:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }());
});
Template.mentionsFlexTab.onDestroyed(function () {
  this.cursor.stop();
});
Template.snippetedMessages.events({
  'scroll .js-list': _.throttle(function (e, instance) {
    if (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight && instance.hasMore.get()) {
      return instance.limit.set(instance.limit.get() + 50);
    }
  }, 200)
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/tabBar/tabBar.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMemo;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
var useSetting;
module.link("../../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 2);
addAction('snippeted-messages', function () {
  var snippetingEnabled = useSetting('Message_AllowSnippeting');
  return useMemo(function () {
    return snippetingEnabled ? {
      groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
      id: 'snippeted-messages',
      title: 'snippet-message',
      icon: 'code',
      template: 'snippetedMessages',
      order: 20
    } : null;
  }, [snippetingEnabled]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"page":{"snippetPage.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/page/snippetPage.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.snippetPage.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.snippetPage.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/page/template.snippetPage.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("snippetPage");
Template["snippetPage"] = new Template("Template.snippetPage", (function() {
  var view = this;
  return HTML.DIV({
    id: function() {
      return Spacebars.mustache(view.lookup("_id"));
    },
    class: function() {
      return [ "snippet-page ", Spacebars.mustache(view.lookup("t")), " ", Spacebars.mustache(view.lookup("own")), " ", Spacebars.mustache(view.lookup("isTemp")) ];
    },
    "data-username": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("u"), "username"));
    },
    "data-groupable": function() {
      return Spacebars.mustache(view.lookup("isGroupable"));
    },
    "data-date": function() {
      return Spacebars.mustache(view.lookup("date"));
    },
    "data-timestamp": function() {
      return Spacebars.mustache(view.lookup("timestamp"));
    }
  }, "\n\t\t", HTML.DIV({
    class: "snippet-informations"
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      username: Spacebars.call(Spacebars.dot(view.lookup("snippet"), "u", "username"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("avatar"));
  }), "\n\t\t\t", HTML.SPAN({
    class: "username"
  }, Blaze.View("lookup:snippet.u.username", function() {
    return Spacebars.mustache(Spacebars.dot(view.lookup("snippet"), "u", "username"));
  })), "\n\t\t\t", HTML.SPAN({
    class: "snippet-filename"
  }, Blaze.View("lookup:snippet.snippetName", function() {
    return Spacebars.mustache(Spacebars.dot(view.lookup("snippet"), "snippetName"));
  })), "\n\t\t"), "\n\n\n\n\t\t", HTML.SPAN({
    class: "info"
  }, " ", Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Snippet_Added", view.lookup("date"));
  })), "\n\t\t", HTML.A({
    class: "download-button",
    target: "_blank",
    href: function() {
      return [ "/snippet/download/", Spacebars.mustache(Spacebars.dot(view.lookup("snippet"), "_id")), "/", Spacebars.mustache(Spacebars.dot(view.lookup("snippet"), "snippetName")) ];
    }
  }, HTML.Raw('\n\t\t\t<i class="icon-download"></i>\n\t\t\t'), Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Download_Snippet");
  }), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "body",
    dir: "auto"
  }, "\n\t\t\t", Blaze.View("lookup:snippetContent", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("snippetContent")));
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"stylesheets":{"snippetPage.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/page/stylesheets/snippetPage.css                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"snippetPage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/page/snippetPage.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 3);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var Markdown;
module.link("../../../markdown/client", {
  Markdown: function (v) {
    Markdown = v;
  }
}, 5);
var APIClient;
module.link("../../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 6);
var formatTime;
module.link("../../../../client/lib/utils/formatTime", {
  formatTime: function (v) {
    formatTime = v;
  }
}, 7);
Template.snippetPage.helpers({
  snippet: function () {
    return Template.instance().message.get();
  },
  snippetContent: function () {
    var message = Template.instance().message.get();

    if (message === undefined) {
      return null;
    }

    message.html = message.msg;
    var markdown = Markdown.parse(message);
    return markdown.tokens[0].text;
  },
  date: function () {
    var snippet = Template.instance().message.get();

    if (snippet !== undefined) {
      return moment(snippet.ts).format(settings.get('Message_DateFormat'));
    }
  },
  time: function () {
    var snippet = Template.instance().message.get();

    if (snippet !== undefined) {
      return formatTime(snippet.ts);
    }
  }
});
Template.snippetPage.onCreated(function () {
  function _callee() {
    var snippetId, _await$APIClient$v1$g, message;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              snippetId = FlowRouter.getParam('snippetId');
              this.message = new ReactiveVar({});
              _context.next = 4;
              return _regeneratorRuntime.awrap(APIClient.v1.get("chat.getSnippetedMessageById?messageId=" + snippetId));

            case 4:
              _await$APIClient$v1$g = _context.sent;
              message = _await$APIClient$v1$g.message;
              this.message.set(message);

            case 7:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, this, null, Promise);
  }

  return _callee;
}());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"actionButton.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/actionButton.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// import { Meteor } from 'meteor/meteor';
// import { MessageAction, modal } from '../../ui-utils';
// import { messageArgs } from '../../ui-utils/client/lib/messageArgs';
// import { t, handleError } from '../../utils';
// import { settings } from '../../settings';
// import { Subscriptions } from '../../models';
// import { hasAtLeastOnePermission } from '../../authorization';
//
// Meteor.startup(function() {
// 	MessageAction.addButton({
// 		id: 'snippeted-message',
// 		icon: 'code',
// 		label: 'Snippet',
// 		context: [
// 			'snippeted',
// 			'message',
// 			'message-mobile',
// 		],
// 		order: 10,
// 		group: 'menu',
// 		action() {
// 			const { msg: message } = messageArgs(this);
//
// 			modal.open({
// 				title: 'Create a Snippet',
// 				text: 'The name of your snippet (with file extension):',
// 				type: 'input',
// 				showCancelButton: true,
// 				closeOnConfirm: false,
// 				inputPlaceholder: 'Snippet name',
// 			}, function(filename) {
// 				if (filename === false) {
// 					return false;
// 				}
// 				if (filename === '') {
// 					modal.showInputError('You need to write something!');
// 					return false;
// 				}
// 				message.snippeted = true;
// 				Meteor.call('snippetMessage', message, filename, function(error) {
// 					if (error) {
// 						return handleError(error);
// 					}
// 					modal.open({
// 						title: t('Nice'),
// 						text: `Snippet '${ filename }' created.`,
// 						type: 'success',
// 						timer: 2000,
// 					});
// 				});
// 			});
//
// 		},
// 		condition(message) {
// 			if (Subscriptions.findOne({ rid: message.rid, 'u._id': Meteor.userId() }) === undefined) {
// 				return false;
// 			}
//
// 			if (message.snippeted || ((settings.get('Message_AllowSnippeting') === undefined) ||
// 				(settings.get('Message_AllowSnippeting') === null) ||
// 				(settings.get('Message_AllowSnippeting')) === false)) {
// 				return false;
// 			}
//
// 			return hasAtLeastOnePermission('snippet-message', message.rid);
// 		},
// 	});
//
// });
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/index.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./actionButton");
module.link("./messageType");
module.link("./snippetMessage");
module.link("./page/snippetPage.html");
module.link("./page/snippetPage");
module.link("./tabBar/tabBar");
module.link("./tabBar/views/snippetedMessages.html");
module.link("./tabBar/views/snippetedMessages");
module.link("./page/stylesheets/snippetPage.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/messageType.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 1);
var MessageTypes;
module.link("../../ui-utils", {
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 2);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'message_snippeted',
    system: true,
    message: 'Snippeted_a_message',
    data: function (message) {
      var snippetLink = "<a href=\"/snippet/" + message.snippetId + "/" + encodeURIComponent(message.snippetName) + "\">" + escapeHTML(message.snippetName) + "</a>";
      return {
        snippetLink: snippetLink
      };
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"snippetMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-snippet/client/snippetMessage.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);
var ChatMessage, Subscriptions;
module.link("../../models", {
  ChatMessage: function (v) {
    ChatMessage = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 2);
Meteor.methods({
  snippetMessage: function (message) {
    if (typeof Meteor.userId() === 'undefined' || Meteor.userId() === null) {
      return false;
    }

    if (typeof settings.get('Message_AllowSnippeting') === 'undefined' || settings.get('Message_AllowSnippeting') === null || settings.get('Message_AllowSnippeting') === false) {
      return false;
    }

    var subscription = Subscriptions.findOne({
      'rid': message.rid,
      'u._id': Meteor.userId()
    });

    if (subscription === undefined) {
      return false;
    }

    ChatMessage.update({
      _id: message._id
    }, {
      $set: {
        snippeted: true
      }
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"apps":{"client":{"gameCenter":{"gameCenter.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/gameCenter.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.gameCenter.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.gameCenter.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/template.gameCenter.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("GameCenter");
Template["GameCenter"] = new Template("Template.GameCenter", (function() {
  var view = this;
  return [ Blaze._TemplateWith(function() {
    return {
      onScroll: Spacebars.call(view.lookup("onTableScroll")),
      onResize: Spacebars.call(view.lookup("onTableResize")),
      onSort: Spacebars.call(view.lookup("onTableSort"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("table"), function() {
      return [ "\n\t", HTML.TBODY({
        class: "rc-game__list"
      }, "\n\t\t", HTML.THEAD("\n\t\t\t", HTML.TR("\n\t\t\t\t", HTML.TH({
        class: "js-sort rc-table-td--medium",
        "data-sort": "name"
      }, "\n\t\t\t\t\t", HTML.DIV({
        class: "table-fake-th"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Name");
      })), "\n\t\t\t\t"), "\n\t\t\t\t", HTML.TH({
        class: "rc-table-td"
      }, "\n\t\t\t\t\t", HTML.DIV({
        class: "table-fake-th"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Description");
      }), " "), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t\t", Blaze.Each(function() {
        return Spacebars.call(view.lookup("games"));
      }, function() {
        return [ "\n\t\t", HTML.TR({
          class: "rc-game-center__game",
          "data-name": function() {
            return Spacebars.mustache(view.lookup("name"));
          }
        }, "\n\t\t\t", HTML.TD("\n\t\t\t\t", HTML.DIV({
          class: "rc-table-wrapper"
        }, "\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("icon"));
        }, function() {
          return [ "\n\t\t\t\t\t", HTML.DIV({
            class: "rc-table-avatar",
            style: function() {
              return [ "background-image:url(", Spacebars.mustache(view.lookup("icon")), ")" ];
            }
          }), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-table-info"
        }, "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "rc-table-title"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:name", function() {
          return Spacebars.mustache(view.lookup("name"));
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t\t", HTML.TD("\n\t\t\t\t", HTML.DIV({
          class: "rc-table-wrapper"
        }, "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-table-info"
        }, "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "rc-table-title"
        }, "\n\t\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("summary"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:summary", function() {
            return Spacebars.mustache(view.lookup("summary"));
          }), "\n\t\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:description", function() {
            return Spacebars.mustache(view.lookup("description"));
          }), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("summary"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.SPAN({
            class: "rc-table-subtitle"
          }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:description", function() {
            return Spacebars.mustache(view.lookup("description"));
          }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t\t", HTML.TD("\n\t\t\t\t", HTML.DIV({
          class: "rc-table-wrapper"
        }, "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-table-info"
        }, "\n\t\t\t\t\t\t\t", HTML.BUTTON({
          class: "game-center__invite-players js-invite",
          title: "Invite Friends"
        }, "\n\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call("game-center__invite-players-icon"),
            icon: Spacebars.call("plus")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t\t" ];
      }), "\n\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isLoading"));
      }, function() {
        return [ "\n\t\t", HTML.TR("\n\t\t\t", HTML.TD({
          colspan: "3",
          style: "position: relative;"
        }, Spacebars.include(view.lookupTemplate("loading"))), "\n\t\t"), "\n\t\t" ];
      }), "\n\t"), "\n\t" ];
    });
  }), "\n\t", HTML.DIV({
    class: function() {
      return [ "rc-user-info-container flex-nav animated", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("showGame"));
      }, function() {
        return " animated-hidden";
      }) ];
    }
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("showGame"));
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return Spacebars.dataMustache(view.lookup("gameContainerOptions"));
    }, function() {
      return Spacebars.include(view.lookupTemplate("GameContainer"));
    }), "\n\t\t" ];
  }), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"gameContainer.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/gameContainer.html                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.gameContainer.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.gameContainer.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/template.gameContainer.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("GameContainer");
Template["GameContainer"] = new Template("Template.GameContainer", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(view.lookup("isContextualBar"));
  }, function() {
    return [ "\n\t", HTML.HEADER({
      class: "contextual-bar__header"
    }, "\n\t\t", HTML.DIV({
      class: "contextual-bar__header-data"
    }, "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("showBackButton"));
    }, function() {
      return [ "\n\t\t\t", HTML.BUTTON({
        class: "rc-button rc-button--nude contextual-bar__header-back-btn js-back",
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Apps_Game_Center_Back");
        }
      }, HTML.Raw('\n\t\t\t\t<i class="icon-angle-left"></i>\n\t\t\t')), "\n\t\t\t" ];
    }), "\n\t\t\t", HTML.IMG({
      class: "rc-table-avatar contextual-bar__header-icon",
      src: function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("game"), "icon"));
      }
    }), "\n\t\t\t", HTML.H1({
      class: "contextual-bar__header-title"
    }, Blaze.View("lookup:game.name", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("game"), "name"));
    })), "\n\t\t"), "\n\t\t", HTML.BUTTON({
      class: "contextual-bar__header-close rc-game__close"
    }, "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("contextual-bar__header-close-icon"),
        icon: Spacebars.call("plus")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t"), "\n\t"), "\n\t" ];
  }), "\n\n\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("isLoading"));
  }, function() {
    return [ "\n\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t" ];
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: function() {
        return [ "rc-game__container ", Blaze.If(function() {
          return Spacebars.call(view.lookup("isModal"));
        }, function() {
          return " rc-game-modal__container ";
        }) ];
      }
    }, "\n\t\t\t", HTML.IFRAME({
      class: function() {
        return [ "rc-game__main ", Blaze.If(function() {
          return Spacebars.call(view.lookup("isModal"));
        }, function() {
          return " rc-game-modal__main ";
        }) ];
      },
      src: function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("game"), "url"));
      },
      style: "position:absolute; width: 100%; height: 100%;"
    }), "\n\t\t"), "\n\t" ];
  }) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"invitePlayers.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/invitePlayers.html                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.invitePlayers.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.invitePlayers.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/template.invitePlayers.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("InvitePlayers");
Template["InvitePlayers"] = new Template("Template.InvitePlayers", (function() {
  var view = this;
  return HTML.SECTION({
    class: "invite-players"
  }, "\n\t\t", HTML.DIV({
    class: "invite-players__wrapper"
  }, "\n\t\t\t", HTML.FORM({
    id: "invite-players",
    class: "invite-players__content"
  }, "\n\t\t\t\t", HTML.DIV({
    class: "invite-players__inputs"
  }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
    return {
      onClickTag: Spacebars.call(view.lookup("onClickTagUser")),
      deleteLastItem: Spacebars.call(view.lookup("deleteLastItemUser")),
      list: Spacebars.call(view.lookup("selectedUsers")),
      onSelect: Spacebars.call(view.lookup("onSelectUser")),
      collection: Spacebars.call("UserAndRoom"),
      endpoint: Spacebars.call("users.autocomplete"),
      field: Spacebars.call("username"),
      sort: Spacebars.call("username"),
      label: Spacebars.call("Invite_Users"),
      placeholder: Spacebars.call("Username_Placeholder"),
      name: Spacebars.call("users"),
      icon: Spacebars.call("at"),
      noMatchTemplate: Spacebars.call("userSearchEmpty"),
      templateItem: Spacebars.call("popupList_item_default"),
      modifier: Spacebars.call(view.lookup("userModifier"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("SearchInvitePlayers"));
  }), "\n\t\t\t\t"), HTML.Raw('\n\t\t\t\t<input form="invite-players" style="background-color: #1D74F5; float: right;" class="rc-button rc-button--right rc-button--primary js-invite-players" type="submit" data-button="create" value="Invite">\n\t\t\t')), "\n\t\t"), "\n\t");
}));

Template.__checkName("SearchInvitePlayers");
Template["SearchInvitePlayers"] = new Template("Template.SearchInvitePlayers", (function() {
  var view = this;
  return HTML.DIV(HTML.Attrs({
    class: "rc-input",
    id: function() {
      return [ "search-", Spacebars.mustache(view.lookup("name")) ];
    }
  }, function() {
    return Spacebars.attrMustache(view.lookup("disabled"));
  }), "\n\t\t", HTML.LABEL({
    class: "rc-input__label"
  }, "\n\t\t\t", HTML.DIV({
    class: "rc-input__title"
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), view.lookup("label"));
  })), "\n\t\t\t", HTML.DIV({
    class: "rc-input__wrapper"
  }, "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("icon"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "rc-input__icon"
    }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call(view.lookup("icon"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", HTML.DIV({
    class: function() {
      return [ "rc-tags", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("icon"));
      }, function() {
        return " rc-tags--no-icon";
      }) ];
    }
  }, "\n\t\t\t\t\t", Blaze.Each(function() {
    return {
      _sequence: Spacebars.call(view.lookup("list")),
      _variable: "item"
    };
  }, function() {
    return [ " ", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("item"));
    }, function() {
      return Spacebars.include(view.lookupTemplate("tag"));
    }), " " ];
  }), "\n\t\t\t\t\t", HTML.INPUT(HTML.Attrs({
    type: "text",
    id: function() {
      return Spacebars.mustache(view.lookup("name"));
    },
    class: "rc-tags__input",
    placeholder: function() {
      return Spacebars.mustache(view.lookup("_"), view.lookup("placeholder"));
    },
    name: function() {
      return Spacebars.mustache(view.lookup("name"));
    },
    autocomplete: "off"
  }, function() {
    return Spacebars.attrMustache(view.lookup("disabled"));
  })), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("config"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("autocomplete"), "isShowing");
    }, function() {
      return [ "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          data: Spacebars.call(view.lookup("config")),
          items: Spacebars.call(view.lookup("items")),
          ready: Spacebars.call(Spacebars.dataMustache(view.lookup("autocomplete"), "isLoaded"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("popupList"));
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "rc-input__description"
  }, Blaze.View("lookup:description", function() {
    return Spacebars.mustache(view.lookup("description"));
  })), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"gameCenter.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/gameCenter.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var modal;
module.link("../../../ui-utils/client", {
  modal: function (v) {
    modal = v;
  }
}, 2);
var APIClient, t;
module.link("../../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  },
  t: function (v) {
    t = v;
  }
}, 3);
module.link("./gameCenter.html");
var handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 4);

var getExternalComponents = function () {
  function _callee(instance) {
    var _await$APIClient$get, externalComponents;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.prev = 0;
              _context.next = 3;
              return _regeneratorRuntime.awrap(APIClient.get('apps/externalComponents'));

            case 3:
              _await$APIClient$get = _context.sent;
              externalComponents = _await$APIClient$get.externalComponents;
              instance.games.set(externalComponents);
              _context.next = 11;
              break;

            case 8:
              _context.prev = 8;
              _context.t0 = _context["catch"](0);
              handleError(_context.t0);

            case 11:
              instance.isLoading.set(false);
              instance.ready.set(true);

            case 13:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, [[0, 8]], Promise);
  }

  return _callee;
}();

var openGame = function (gameManifestInfo) {
  var instance = Template.instance();
  var _gameManifestInfo$loc = gameManifestInfo.location,
      location = _gameManifestInfo$loc === void 0 ? 'MODAL' : _gameManifestInfo$loc;

  if (location === 'CONTEXTUAL_BAR') {
    instance.gameManifestInfo.set(gameManifestInfo);
  } else if (location === 'MODAL') {
    modal.open({
      allowOutsideClick: false,
      data: {
        game: gameManifestInfo
      },
      template: 'GameContainer',
      type: 'rc-game'
    });
  }
};

Template.GameCenter.helpers({
  isReady: function () {
    if (Template.instance().ready != null) {
      return Template.instance().ready.get();
    }

    return false;
  },
  games: function () {
    return Template.instance().games.get();
  },
  isLoading: function () {
    return Template.instance().isLoading.get();
  },
  onTableScroll: function () {
    var instance = Template.instance();

    if (instance.loading || instance.end.get()) {
      return;
    }

    return function (currentTarget) {
      if (currentTarget.offsetHeight + currentTarget.scrollTop >= currentTarget.scrollHeight - 100) {
        return instance.page.set(instance.page.get() + 1);
      }
    };
  },
  showGame: function () {
    return Template.instance().gameManifestInfo.get();
  },
  gameContainerOptions: function () {
    var _Template$instance = Template.instance(),
        gameManifestInfo = _Template$instance.gameManifestInfo,
        clearGameManifestInfo = _Template$instance.clearGameManifestInfo;

    return {
      game: gameManifestInfo.get(),
      showBackButton: true,
      clearGameManifestInfo: clearGameManifestInfo
    };
  }
});
Template.GameCenter.onCreated(function () {
  var _this = this;

  this.ready = new ReactiveVar(false);
  this.games = new ReactiveVar([]);
  this.isLoading = new ReactiveVar(true);
  this.page = new ReactiveVar(0);
  this.end = new ReactiveVar(false);
  this.gameManifestInfo = new ReactiveVar(null);

  this.clearGameManifestInfo = function () {
    _this.gameManifestInfo.set(null);
  };

  getExternalComponents(this);
});
Template.GameCenter.events({
  'click .rc-game-center__game': function () {
    var gameManifestInfo = this;
    openGame(gameManifestInfo);
  },
  'click .js-invite': function (event) {
    event.stopPropagation();
    modal.open({
      title: t('Apps_Game_Center_Invite_Friends'),
      content: 'InvitePlayers',
      data: this,
      confirmOnEnter: false,
      showCancelButton: false,
      showConfirmButton: false,
      html: false
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"gameContainer.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/gameContainer.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var modal;
module.link("../../../ui-utils/client", {
  modal: function (v) {
    modal = v;
  }
}, 1);
var Apps;
module.link("../orchestrator", {
  Apps: function (v) {
    Apps = v;
  }
}, 2);
var APIClient;
module.link("../../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 3);
module.link("./gameContainer.html");

var getExternalComponent = function () {
  function _callee() {
    var _Template$instance, externalComponent, realAppClientUIHost, currentUser, currentRoom;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _Template$instance = Template.instance(), externalComponent = _Template$instance.data.game;
              realAppClientUIHost = Apps.getUIHost();
              _context.next = 4;
              return _regeneratorRuntime.awrap(realAppClientUIHost.getClientUserInfo());

            case 4:
              currentUser = _context.sent;
              _context.next = 7;
              return _regeneratorRuntime.awrap(realAppClientUIHost.getClientRoomInfo());

            case 7:
              currentRoom = _context.sent;
              externalComponent.state = {
                currentUser: currentUser,
                currentRoom: currentRoom
              };
              return _context.abrupt("return", externalComponent);

            case 10:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}();

Template.GameContainer.helpers({
  isContextualBar: function () {
    var _Template$instance2 = Template.instance(),
        game = _Template$instance2.data.game;

    var location = game.location;
    return location === 'CONTEXTUAL_BAR';
  },
  isModal: function () {
    var _Template$instance3 = Template.instance(),
        game = _Template$instance3.data.game;

    var location = game.location;
    return location === 'MODAL';
  }
});
Template.GameContainer.events({
  'click .rc-game__close': function () {
    var _Template$instance4 = Template.instance(),
        clearGameManifestInfo = _Template$instance4.data.clearGameManifestInfo;

    clearGameManifestInfo();
    modal.cancel();
  },
  'click .js-back': function () {
    var _Template$instance5 = Template.instance(),
        clearGameManifestInfo = _Template$instance5.data.clearGameManifestInfo;

    clearGameManifestInfo();
  }
});
Template.GameContainer.onCreated(function () {
  function _callee2() {
    var externalComponent;
    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              _context2.next = 2;
              return _regeneratorRuntime.awrap(getExternalComponent());

            case 2:
              externalComponent = _context2.sent;
              APIClient.post('apps/externalComponentEvent', {
                event: 'IPostExternalComponentOpened',
                externalComponent: externalComponent
              });

            case 4:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}());
Template.GameContainer.onDestroyed(function () {
  function _callee3() {
    var externalComponent;
    return _regeneratorRuntime.async(function () {
      function _callee3$(_context3) {
        while (1) {
          switch (_context3.prev = _context3.next) {
            case 0:
              _context3.next = 2;
              return _regeneratorRuntime.awrap(getExternalComponent());

            case 2:
              externalComponent = _context3.sent;
              APIClient.post('apps/externalComponentEvent', {
                event: 'IPostExternalComponentClosed',
                externalComponent: externalComponent
              });

            case 4:
            case "end":
              return _context3.stop();
          }
        }
      }

      return _callee3$;
    }(), null, null, null, Promise);
  }

  return _callee3;
}());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"invitePlayers.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/invitePlayers.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 3);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 4);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 5);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 6);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 7);
var AutoComplete;
module.link("../../../meteor-autocomplete/client", {
  AutoComplete: function (v) {
    AutoComplete = v;
  }
}, 8);
var roomTypes;
module.link("../../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 9);
var ChatRoom;
module.link("../../../models/client", {
  ChatRoom: function (v) {
    ChatRoom = v;
  }
}, 10);
var modal;
module.link("../../../ui-utils/client", {
  modal: function (v) {
    modal = v;
  }
}, 11);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 12);
module.link("./invitePlayers.html");
Template.InvitePlayers.helpers({
  onSelectUser: function () {
    return Template.instance().onSelectUser;
  },
  selectedUsers: function () {
    var myUsername = Meteor.user().username;
    var message = this.message;
    var users = Template.instance().selectedUsers.get().map(function (e) {
      return e;
    });

    if (message) {
      users.unshift(message.u);
    }

    return users.filter(function (_ref) {
      var username = _ref.username;
      return myUsername !== username;
    });
  },
  onClickTagUser: function () {
    return Template.instance().onClickTagUser;
  },
  deleteLastItemUser: function () {
    return Template.instance().deleteLastItemUser;
  },
  onClickTagRoom: function () {
    return Template.instance().onClickTagRoom;
  },
  deleteLastItemRoom: function () {
    return Template.instance().deleteLastItemRoom;
  },
  selectedRoom: function () {
    return Template.instance().selectedRoom.get();
  },
  onSelectRoom: function () {
    return Template.instance().onSelectRoom;
  },
  roomCollection: function () {
    return ChatRoom;
  },
  roomSelector: function () {
    return function (expression) {
      return {
        name: {
          $regex: ".*" + expression + ".*"
        }
      };
    };
  },
  roomModifier: function () {
    return function (filter) {
      var text = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
      var f = filter.get();
      return "#" + (f.length === 0 ? text : text.replace(new RegExp(filter.get(), 'i'), function (part) {
        return "<strong>" + part + "</strong>";
      }));
    };
  },
  userModifier: function () {
    return function (filter) {
      var text = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
      var f = filter.get();
      return "@" + (f.length === 0 ? text : text.replace(new RegExp(filter.get(), 'i'), function (part) {
        return "<strong>" + part + "</strong>";
      }));
    };
  },
  nameSuggestion: function () {
    return Template.instance().discussionName.get();
  }
});
Template.InvitePlayers.events({
  'submit #invite-players, click .js-invite-players': function () {
    function _callee(e, instance) {
      var name, users, privateGroupName, result;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                e.preventDefault();
                name = instance.data.name;
                users = instance.selectedUsers.get().map(function (_ref2) {
                  var username = _ref2.username;
                  return username;
                });
                privateGroupName = name.replace(/\s/g, '-') + "-" + Random.id(10);
                _context.prev = 4;
                _context.next = 7;
                return _regeneratorRuntime.awrap(callWithErrorHandling('createPrivateGroup', privateGroupName, users));

              case 7:
                result = _context.sent;
                roomTypes.openRouteLink(result.t, result); // This ensures the message is only sent after the
                // user has been redirected to the new room, preventing a
                // weird bug that made the message appear as unsent until
                // the screen gets refreshed

                Tracker.autorun(function (c) {
                  if (Session.get('openedRoom') !== result.rid) {
                    return;
                  }

                  callWithErrorHandling('sendMessage', {
                    _id: Random.id(),
                    rid: result.rid,
                    msg: TAPi18n.__('Apps_Game_Center_Play_Game_Together', {
                      name: name
                    })
                  });
                  c.stop();
                });
                modal.close();
                _context.next = 16;
                break;

              case 13:
                _context.prev = 13;
                _context.t0 = _context["catch"](4);
                console.warn(_context.t0);

              case 16:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, [[4, 13]], Promise);
    }

    return _callee;
  }()
});
Template.InvitePlayers.onCreated(function () {
  var _this = this;

  this.selectedUsers = new ReactiveVar([]);

  this.onSelectUser = function (_ref3) {
    var user = _ref3.item;

    if (user.username === Meteor.user().username) {
      return;
    }

    var users = _this.selectedUsers.get();

    if (!users.find(function (u) {
      return user.username === u.username;
    })) {
      _this.selectedUsers.set([].concat(_toConsumableArray(users), [user]));
    }
  };

  this.onClickTagUser = function (_ref4) {
    var username = _ref4.username;

    _this.selectedUsers.set(_this.selectedUsers.get().filter(function (user) {
      return user.username !== username;
    }));
  };

  this.deleteLastItemUser = function () {
    var arr = _this.selectedUsers.get();

    arr.pop();

    _this.selectedUsers.set(arr);
  };
});
Template.SearchInvitePlayers.helpers({
  list: function () {
    return this.list;
  },
  items: function () {
    return Template.instance().ac.filteredList();
  },
  config: function () {
    var _Template$instance = Template.instance(),
        filter = _Template$instance.filter;

    var _Template$instance$da = Template.instance().data,
        noMatchTemplate = _Template$instance$da.noMatchTemplate,
        templateItem = _Template$instance$da.templateItem,
        modifier = _Template$instance$da.modifier;
    return {
      filter: filter.get(),
      template_item: templateItem,
      noMatchTemplate: noMatchTemplate,
      modifier: function (text) {
        return modifier(filter, text);
      }
    };
  },
  autocomplete: function (key) {
    var instance = Template.instance();
    var param = instance.ac[key];
    return typeof param === 'function' ? param.apply(instance.ac) : param;
  }
});
Template.SearchInvitePlayers.events({
  'input input': function (e, t) {
    var input = e.target;
    var position = input.selectionEnd || input.selectionStart;
    var length = input.value.length;
    document.activeElement === input && e && /input/i.test(e.type) && (input.selectionEnd = position + input.value.length - length);
    t.filter.set(input.value);
  },
  'click .rc-popup-list__item': function (e, t) {
    t.ac.onItemClick(this, e);
  },
  'keydown input': function (e, t) {
    var KEYCODE_BACKSPACE = 8;
    var KEYCODE_DELETE = 46;
    t.ac.onKeyDown(e);

    if ([KEYCODE_BACKSPACE, KEYCODE_DELETE].includes(e.keyCode) && e.target.value === '') {
      var deleteLastItem = t.deleteLastItem;
      return deleteLastItem && deleteLastItem();
    }
  },
  'keyup input': function (e, t) {
    t.ac.onKeyUp(e);
  },
  'focus input': function (e, t) {
    t.ac.onFocus(e);
  },
  'blur input': function (e, t) {
    t.ac.onBlur(e);
  },
  'click .rc-tags__tag': function (_ref5, t) {
    var target = _ref5.target;
    var onClickTag = t.onClickTag;
    return onClickTag & onClickTag(Blaze.getData(target));
  }
});
Template.SearchInvitePlayers.onRendered(function () {
  var name = this.data.name;
  this.ac.element = this.firstNode.querySelector("[name=" + name + "]");
  this.ac.$element = $(this.ac.element);
});
Template.SearchInvitePlayers.onCreated(function () {
  this.filter = new ReactiveVar('');
  this.selected = new ReactiveVar([]);
  this.onClickTag = this.data.onClickTag;
  this.deleteLastItem = this.data.deleteLastItem;
  var _this$data = this.data,
      collection = _this$data.collection,
      endpoint = _this$data.endpoint,
      field = _this$data.field,
      sort = _this$data.sort,
      onSelect = _this$data.onSelect,
      _this$data$selector = _this$data.selector,
      selector = _this$data$selector === void 0 ? function (match) {
    return {
      term: match
    };
  } : _this$data$selector;
  this.ac = new AutoComplete({
    selector: {
      anchor: '.rc-input__label',
      item: '.rc-popup-list__item',
      container: '.rc-popup-list__list'
    },
    onSelect: onSelect,
    position: 'fixed',
    limit: 10,
    inputDelay: 300,
    rules: [{
      collection: collection,
      endpoint: endpoint,
      field: field,
      matchAll: true,
      doNotChangeWidth: false,
      selector: selector,
      sort: sort
    }]
  });
  this.ac.tmplInst = this;
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/gameCenter/tabBar.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMemo;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
var useEndpointData;
module.link("../../../../client/hooks/useEndpointData", {
  useEndpointData: function (v) {
    useEndpointData = v;
  }
}, 2);
var AsyncStatePhase;
module.link("../../../../client/hooks/useAsyncState", {
  AsyncStatePhase: function (v) {
    AsyncStatePhase = v;
  }
}, 3);
addAction('game-center', function () {
  var _useEndpointData = useEndpointData('/apps/externalComponents'),
      _useEndpointData$valu = _useEndpointData.value,
      value = _useEndpointData$valu === void 0 ? {
    externalComponents: []
  } : _useEndpointData$valu,
      state = _useEndpointData.phase,
      error = _useEndpointData.error;

  var hasExternalComponents = value && value.externalComponents.length > 0;
  var hasError = !!error;
  return useMemo(function () {
    return state === AsyncStatePhase.RESOLVED && !hasError && hasExternalComponents ? {
      groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
      id: 'game-center',
      title: 'Apps_Game_Center',
      icon: 'game',
      template: 'GameCenter',
      order: -1
    } : null;
  }, [hasError, hasExternalComponents, state]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"communication":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/communication/index.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./websockets", {
  AppWebsocketReceiver: "AppWebsocketReceiver",
  AppEvents: "AppEvents"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"websockets.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/communication/websockets.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  AppEvents: function () {
    return AppEvents;
  },
  AppWebsocketReceiver: function () {
    return AppWebsocketReceiver;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 1);
var slashCommands, APIClient;
module.link("../../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  },
  APIClient: function (v) {
    APIClient = v;
  }
}, 2);
var CachedCollectionManager;
module.link("../../../ui-cached-collection", {
  CachedCollectionManager: function (v) {
    CachedCollectionManager = v;
  }
}, 3);
var loadButtons;
module.link("../../../ui-message/client/ActionButtonSyncer", {
  loadButtons: function (v) {
    loadButtons = v;
  }
}, 4);
var AppEvents = Object.freeze({
  APP_ADDED: 'app/added',
  APP_REMOVED: 'app/removed',
  APP_UPDATED: 'app/updated',
  APP_STATUS_CHANGE: 'app/statusUpdate',
  APP_SETTING_UPDATED: 'app/settingUpdated',
  COMMAND_ADDED: 'command/added',
  COMMAND_DISABLED: 'command/disabled',
  COMMAND_UPDATED: 'command/updated',
  COMMAND_REMOVED: 'command/removed',
  ACTIONS_CHANGED: 'actions/changed'
});

var AppWebsocketReceiver = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(AppWebsocketReceiver, _Emitter);

  function AppWebsocketReceiver() {
    var _this;

    _this = _Emitter.call(this) || this;

    _this.onCommandAddedOrUpdated = function (command) {
      APIClient.v1.get('commands.get', {
        command: command
      }).then(function (result) {
        slashCommands.commands[command] = result.command;
      });
    };

    _this.onCommandRemovedOrDisabled = function (command) {
      delete slashCommands.commands[command];
    };

    _this.onActionsChanged = function () {
      return loadButtons();
    };

    _this.streamer = new Meteor.Streamer('apps');
    CachedCollectionManager.onLogin(function () {
      _this.listenStreamerEvents();
    });
    return _this;
  }

  var _proto = AppWebsocketReceiver.prototype;

  _proto.listenStreamerEvents = function () {
    function listenStreamerEvents() {
      var _this2 = this;

      Object.values(AppEvents).forEach(function (eventName) {
        _this2.streamer.on(eventName, _this2.emit.bind(_this2, eventName));
      });
      this.streamer.on(AppEvents.COMMAND_ADDED, this.onCommandAddedOrUpdated);
      this.streamer.on(AppEvents.COMMAND_UPDATED, this.onCommandAddedOrUpdated);
      this.streamer.on(AppEvents.COMMAND_REMOVED, this.onCommandRemovedOrDisabled);
      this.streamer.on(AppEvents.COMMAND_DISABLED, this.onCommandRemovedOrDisabled);
      this.streamer.on(AppEvents.ACTIONS_CHANGED, this.onActionsChanged);
    }

    return listenStreamerEvents;
  }();

  _proto.registerListener = function () {
    function registerListener(event, listener) {
      this.on(event, listener);
    }

    return registerListener;
  }();

  _proto.unregisterListener = function () {
    function unregisterListener(event, listener) {
      this.off(event, listener);
    }

    return unregisterListener;
  }();

  return AppWebsocketReceiver;
}(Emitter);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"RealAppsEngineUIHost.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/RealAppsEngineUIHost.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 1);
module.export({
  RealAppsEngineUIHost: function () {
    return RealAppsEngineUIHost;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var AppsEngineUIHost;
module.link("@rocket.chat/apps-engine/client/AppsEngineUIHost", {
  AppsEngineUIHost: function (v) {
    AppsEngineUIHost = v;
  }
}, 2);
var Rooms;
module.link("../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 3);
var APIClient;
module.link("../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 4);
var getUserAvatarURL;
module.link("../../utils/lib/getUserAvatarURL", {
  getUserAvatarURL: function (v) {
    getUserAvatarURL = v;
  }
}, 5);
var baseURI;
module.link("../../../client/lib/baseURI", {
  baseURI: function (v) {
    baseURI = v;
  }
}, 6);

var RealAppsEngineUIHost = /*#__PURE__*/function (_AppsEngineUIHost) {
  _inheritsLoose(RealAppsEngineUIHost, _AppsEngineUIHost);

  function RealAppsEngineUIHost() {
    var _this;

    _this = _AppsEngineUIHost.call(this) || this;
    _this._baseURL = baseURI.replace(/\/$/, '');
    return _this;
  }

  var _proto = RealAppsEngineUIHost.prototype;

  _proto.getUserAvatarUrl = function () {
    function getUserAvatarUrl(username) {
      var avatarUrl = getUserAvatarURL(username);

      if (!avatarUrl.startsWith('http') && !avatarUrl.startsWith('data')) {
        return "" + this._baseURL + avatarUrl;
      }

      return avatarUrl;
    }

    return getUserAvatarUrl;
  }();

  _proto.getClientRoomInfo = function () {
    function getClientRoomInfo() {
      var _this2 = this;

      var _Rooms$findOne, slugifiedName, id, cachedMembers, _await$APIClient$get, members;

      return _regeneratorRuntime.async(function () {
        function getClientRoomInfo$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _Rooms$findOne = Rooms.findOne(Session.get('openedRoom')), slugifiedName = _Rooms$findOne.name, id = _Rooms$findOne._id;
                cachedMembers = [];
                _context.prev = 2;
                _context.next = 5;
                return _regeneratorRuntime.awrap(APIClient.get('v1/groups.members', {
                  roomId: id
                }));

              case 5:
                _await$APIClient$get = _context.sent;
                members = _await$APIClient$get.members;
                cachedMembers = members.map(function (_ref) {
                  var _id = _ref._id,
                      username = _ref.username;
                  return {
                    id: _id,
                    username: username,
                    avatarUrl: _this2.getUserAvatarUrl(username)
                  };
                });
                _context.next = 13;
                break;

              case 10:
                _context.prev = 10;
                _context.t0 = _context["catch"](2);
                console.warn(_context.t0);

              case 13:
                return _context.abrupt("return", {
                  id: id,
                  slugifiedName: slugifiedName,
                  members: cachedMembers
                });

              case 14:
              case "end":
                return _context.stop();
            }
          }
        }

        return getClientRoomInfo$;
      }(), null, null, [[2, 10]], Promise);
    }

    return getClientRoomInfo;
  }();

  _proto.getClientUserInfo = function () {
    function getClientUserInfo() {
      var _Meteor$user, username, _id;

      return _regeneratorRuntime.async(function () {
        function getClientUserInfo$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                _Meteor$user = Meteor.user(), username = _Meteor$user.username, _id = _Meteor$user._id;
                return _context2.abrupt("return", {
                  id: _id,
                  username: username,
                  avatarUrl: this.getUserAvatarUrl(username)
                });

              case 2:
              case "end":
                return _context2.stop();
            }
          }
        }

        return getClientUserInfo$;
      }(), null, this, null, Promise);
    }

    return getClientUserInfo;
  }();

  return RealAppsEngineUIHost;
}(AppsEngineUIHost);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"i18n.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/i18n.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);
module.export({
  loadAppI18nResources: function () {
    return loadAppI18nResources;
  },
  handleI18nResources: function () {
    return handleI18nResources;
  }
});
var TAPi18next;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18next: function (v) {
    TAPi18next = v;
  }
}, 0);
var Apps;
module.link("./orchestrator", {
  Apps: function (v) {
    Apps = v;
  }
}, 1);
var Utilities;
module.link("../lib/misc/Utilities", {
  Utilities: function (v) {
    Utilities = v;
  }
}, 2);
var AppEvents;
module.link("./communication", {
  AppEvents: function (v) {
    AppEvents = v;
  }
}, 3);

var loadAppI18nResources = function (appId, languages) {
  Object.entries(languages).forEach(function (_ref) {
    var _ref2 = _slicedToArray(_ref, 2),
        language = _ref2[0],
        translations = _ref2[1];

    try {
      // Translations keys must be scoped under app id
      var scopedTranslations = Object.entries(translations).reduce(function (translations, _ref3) {
        var _ref4 = _slicedToArray(_ref3, 2),
            key = _ref4[0],
            value = _ref4[1];

        translations[Utilities.getI18nKeyForApp(key, appId)] = value;
        return translations;
      }, {});
      TAPi18next.addResourceBundle(language, 'project', scopedTranslations);
    } catch (error) {
      Apps.handleError(error);
    }
  });
};

var handleAppAdded = function () {
  function _callee(appId) {
    var languages;
    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return _regeneratorRuntime.awrap(Apps.getAppLanguages(appId));

            case 2:
              languages = _context.sent;
              loadAppI18nResources(appId, languages);

            case 4:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}();

var handleI18nResources = function () {
  function _callee2() {
    var apps;
    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              _context2.next = 2;
              return _regeneratorRuntime.awrap(Apps.getAppsLanguages());

            case 2:
              apps = _context2.sent;
              apps.forEach(function (_ref5) {
                var id = _ref5.id,
                    languages = _ref5.languages;
                loadAppI18nResources(id, languages);
              });
              Apps.getWsListener().unregisterListener(AppEvents.APP_ADDED, handleAppAdded);
              Apps.getWsListener().registerListener(AppEvents.APP_ADDED, handleAppAdded);

            case 6:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/index.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./gameCenter/tabBar");
module.link("./gameCenter/gameContainer");
module.link("./gameCenter/gameCenter");
module.link("./gameCenter/invitePlayers");
module.link("./orchestrator", {
  Apps: "Apps"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"orchestrator.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/client/orchestrator.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 2);
module.export({
  Apps: function () {
    return Apps;
  }
});
var AppClientManager;
module.link("@rocket.chat/apps-engine/client/AppClientManager", {
  AppClientManager: function (v) {
    AppClientManager = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 3);
var hasAtLeastOnePermission;
module.link("../../authorization", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 4);
var settings;
module.link("../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 5);
var CachedCollectionManager;
module.link("../../ui-cached-collection", {
  CachedCollectionManager: function (v) {
    CachedCollectionManager = v;
  }
}, 6);
var APIClient;
module.link("../../utils", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 7);
var AppWebsocketReceiver;
module.link("./communication", {
  AppWebsocketReceiver: function (v) {
    AppWebsocketReceiver = v;
  }
}, 8);
var handleI18nResources;
module.link("./i18n", {
  handleI18nResources: function (v) {
    handleI18nResources = v;
  }
}, 9);
var RealAppsEngineUIHost;
module.link("./RealAppsEngineUIHost", {
  RealAppsEngineUIHost: function (v) {
    RealAppsEngineUIHost = v;
  }
}, 10);

var createDeferredValue = function () {
  var resolve;
  var reject;
  var promise = new Promise(function (_resolve, _reject) {
    resolve = _resolve;
    reject = _reject;
  });
  return [promise, resolve, reject];
};

var AppClientOrchestrator = function () {
  function AppClientOrchestrator() {
    var _this = this;

    this.load = function () {
      function _callee(isEnabled) {
        var _createDeferredValue, _createDeferredValue2;

        return _regeneratorRuntime.async(function () {
          function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  if (!_this.isLoaded) {
                    _this.ws = new AppWebsocketReceiver();
                    _this.isLoaded = true;
                  }

                  _this.setEnabled(isEnabled); // Since the deferred value (a promise) is immutable after resolved,
                  // it need to be recreated to resolve a new value


                  _createDeferredValue = createDeferredValue();
                  _createDeferredValue2 = _slicedToArray(_createDeferredValue, 2);
                  _this.deferredIsEnabled = _createDeferredValue2[0];
                  _this.setEnabled = _createDeferredValue2[1];
                  _context.next = 8;
                  return _regeneratorRuntime.awrap(handleI18nResources());

                case 8:
                  _this.setEnabled(isEnabled);

                case 9:
                case "end":
                  return _context.stop();
              }
            }
          }

          return _callee$;
        }(), null, null, null, Promise);
      }

      return _callee;
    }();

    this.getWsListener = function () {
      return _this.ws;
    };

    this.getAppClientManager = function () {
      return _this._manager;
    };

    this.handleError = function (error) {
      console.error(error);

      if (hasAtLeastOnePermission(['manage-apps'])) {
        dispatchToastMessage({
          type: 'error',
          message: error.message
        });
      }
    };

    this.isEnabled = function () {
      return _this.deferredIsEnabled;
    };

    this.getApps = function () {
      function _callee2() {
        var _await$APIClient$get, apps;

        return _regeneratorRuntime.async(function () {
          function _callee2$(_context2) {
            while (1) {
              switch (_context2.prev = _context2.next) {
                case 0:
                  _context2.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get('apps'));

                case 2:
                  _await$APIClient$get = _context2.sent;
                  apps = _await$APIClient$get.apps;
                  return _context2.abrupt("return", apps);

                case 5:
                case "end":
                  return _context2.stop();
              }
            }
          }

          return _callee2$;
        }(), null, null, null, Promise);
      }

      return _callee2;
    }();

    this.getAppsFromMarketplace = function () {
      function _callee3() {
        var appsOverviews;
        return _regeneratorRuntime.async(function () {
          function _callee3$(_context3) {
            while (1) {
              switch (_context3.prev = _context3.next) {
                case 0:
                  _context3.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get('apps', {
                    marketplace: 'true'
                  }));

                case 2:
                  appsOverviews = _context3.sent;
                  return _context3.abrupt("return", appsOverviews.map(function (_ref) {
                    var latest = _ref.latest,
                        price = _ref.price,
                        pricingPlans = _ref.pricingPlans,
                        purchaseType = _ref.purchaseType,
                        isEnterpriseOnly = _ref.isEnterpriseOnly;
                    return _objectSpread(_objectSpread({}, latest), {}, {
                      price: price,
                      pricingPlans: pricingPlans,
                      purchaseType: purchaseType,
                      isEnterpriseOnly: isEnterpriseOnly
                    });
                  }));

                case 4:
                case "end":
                  return _context3.stop();
              }
            }
          }

          return _callee3$;
        }(), null, null, null, Promise);
      }

      return _callee3;
    }();

    this.getAppsOnBundle = function () {
      function _callee4(bundleId) {
        var _await$APIClient$get2, apps;

        return _regeneratorRuntime.async(function () {
          function _callee4$(_context4) {
            while (1) {
              switch (_context4.prev = _context4.next) {
                case 0:
                  _context4.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get("apps/bundles/" + bundleId + "/apps"));

                case 2:
                  _await$APIClient$get2 = _context4.sent;
                  apps = _await$APIClient$get2.apps;
                  return _context4.abrupt("return", apps);

                case 5:
                case "end":
                  return _context4.stop();
              }
            }
          }

          return _callee4$;
        }(), null, null, null, Promise);
      }

      return _callee4;
    }();

    this.getAppsLanguages = function () {
      function _callee5() {
        var _await$APIClient$get3, apps;

        return _regeneratorRuntime.async(function () {
          function _callee5$(_context5) {
            while (1) {
              switch (_context5.prev = _context5.next) {
                case 0:
                  _context5.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get('apps/languages'));

                case 2:
                  _await$APIClient$get3 = _context5.sent;
                  apps = _await$APIClient$get3.apps;
                  return _context5.abrupt("return", apps);

                case 5:
                case "end":
                  return _context5.stop();
              }
            }
          }

          return _callee5$;
        }(), null, null, null, Promise);
      }

      return _callee5;
    }();

    this.getApp = function () {
      function _callee6(appId) {
        var _await$APIClient$get4, app;

        return _regeneratorRuntime.async(function () {
          function _callee6$(_context6) {
            while (1) {
              switch (_context6.prev = _context6.next) {
                case 0:
                  _context6.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get("apps/" + appId));

                case 2:
                  _await$APIClient$get4 = _context6.sent;
                  app = _await$APIClient$get4.app;
                  return _context6.abrupt("return", app);

                case 5:
                case "end":
                  return _context6.stop();
              }
            }
          }

          return _callee6$;
        }(), null, null, null, Promise);
      }

      return _callee6;
    }();

    this.getAppFromMarketplace = function () {
      function _callee7(appId, version) {
        var _await$APIClient$get5, app;

        return _regeneratorRuntime.async(function () {
          function _callee7$(_context7) {
            while (1) {
              switch (_context7.prev = _context7.next) {
                case 0:
                  _context7.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get("apps/" + appId, {
                    marketplace: 'true',
                    version: version
                  }));

                case 2:
                  _await$APIClient$get5 = _context7.sent;
                  app = _await$APIClient$get5.app;
                  return _context7.abrupt("return", app);

                case 5:
                case "end":
                  return _context7.stop();
              }
            }
          }

          return _callee7$;
        }(), null, null, null, Promise);
      }

      return _callee7;
    }();

    this.getLatestAppFromMarketplace = function () {
      function _callee8(appId, version) {
        var _await$APIClient$get6, app;

        return _regeneratorRuntime.async(function () {
          function _callee8$(_context8) {
            while (1) {
              switch (_context8.prev = _context8.next) {
                case 0:
                  _context8.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get("apps/" + appId, {
                    marketplace: 'true',
                    update: 'true',
                    appVersion: version
                  }));

                case 2:
                  _await$APIClient$get6 = _context8.sent;
                  app = _await$APIClient$get6.app;
                  return _context8.abrupt("return", app);

                case 5:
                case "end":
                  return _context8.stop();
              }
            }
          }

          return _callee8$;
        }(), null, null, null, Promise);
      }

      return _callee8;
    }();

    this.getAppSettings = function () {
      function _callee9(appId) {
        var _await$APIClient$get7, settings;

        return _regeneratorRuntime.async(function () {
          function _callee9$(_context9) {
            while (1) {
              switch (_context9.prev = _context9.next) {
                case 0:
                  _context9.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get("apps/" + appId + "/settings"));

                case 2:
                  _await$APIClient$get7 = _context9.sent;
                  settings = _await$APIClient$get7.settings;
                  return _context9.abrupt("return", settings);

                case 5:
                case "end":
                  return _context9.stop();
              }
            }
          }

          return _callee9$;
        }(), null, null, null, Promise);
      }

      return _callee9;
    }();

    this.setAppSettings = function () {
      function _callee10(appId, settings) {
        var _await$APIClient$post, updated;

        return _regeneratorRuntime.async(function () {
          function _callee10$(_context10) {
            while (1) {
              switch (_context10.prev = _context10.next) {
                case 0:
                  _context10.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.post("apps/" + appId + "/settings", undefined, {
                    settings: settings
                  }));

                case 2:
                  _await$APIClient$post = _context10.sent;
                  updated = _await$APIClient$post.updated;
                  return _context10.abrupt("return", updated);

                case 5:
                case "end":
                  return _context10.stop();
              }
            }
          }

          return _callee10$;
        }(), null, null, null, Promise);
      }

      return _callee10;
    }();

    this.getAppApis = function () {
      function _callee11(appId) {
        var _await$APIClient$get8, apis;

        return _regeneratorRuntime.async(function () {
          function _callee11$(_context11) {
            while (1) {
              switch (_context11.prev = _context11.next) {
                case 0:
                  _context11.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get("apps/" + appId + "/apis"));

                case 2:
                  _await$APIClient$get8 = _context11.sent;
                  apis = _await$APIClient$get8.apis;
                  return _context11.abrupt("return", apis);

                case 5:
                case "end":
                  return _context11.stop();
              }
            }
          }

          return _callee11$;
        }(), null, null, null, Promise);
      }

      return _callee11;
    }();

    this.getAppLanguages = function () {
      function _callee12(appId) {
        var _await$APIClient$get9, languages;

        return _regeneratorRuntime.async(function () {
          function _callee12$(_context12) {
            while (1) {
              switch (_context12.prev = _context12.next) {
                case 0:
                  _context12.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get("apps/" + appId + "/languages"));

                case 2:
                  _await$APIClient$get9 = _context12.sent;
                  languages = _await$APIClient$get9.languages;
                  return _context12.abrupt("return", languages);

                case 5:
                case "end":
                  return _context12.stop();
              }
            }
          }

          return _callee12$;
        }(), null, null, null, Promise);
      }

      return _callee12;
    }();

    this.installApp = function () {
      function _callee13(appId, version, permissionsGranted) {
        var _await$APIClient$post2, app;

        return _regeneratorRuntime.async(function () {
          function _callee13$(_context13) {
            while (1) {
              switch (_context13.prev = _context13.next) {
                case 0:
                  _context13.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.post('apps/', {
                    appId: appId,
                    marketplace: true,
                    version: version,
                    permissionsGranted: permissionsGranted
                  }));

                case 2:
                  _await$APIClient$post2 = _context13.sent;
                  app = _await$APIClient$post2.app;
                  return _context13.abrupt("return", app);

                case 5:
                case "end":
                  return _context13.stop();
              }
            }
          }

          return _callee13$;
        }(), null, null, null, Promise);
      }

      return _callee13;
    }();

    this.updateApp = function () {
      function _callee14(appId, version, permissionsGranted) {
        var _await$APIClient$post3, app;

        return _regeneratorRuntime.async(function () {
          function _callee14$(_context14) {
            while (1) {
              switch (_context14.prev = _context14.next) {
                case 0:
                  _context14.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.post("apps/" + appId, {
                    appId: appId,
                    marketplace: true,
                    version: version,
                    permissionsGranted: permissionsGranted
                  }));

                case 2:
                  _await$APIClient$post3 = _context14.sent;
                  app = _await$APIClient$post3.app;
                  return _context14.abrupt("return", app);

                case 5:
                case "end":
                  return _context14.stop();
              }
            }
          }

          return _callee14$;
        }(), null, null, null, Promise);
      }

      return _callee14;
    }();

    this.uninstallApp = function (appId) {
      return APIClient.delete("apps/" + appId);
    };

    this.syncApp = function (appId) {
      return APIClient.post("apps/" + appId + "/sync");
    };

    this.setAppStatus = function () {
      function _callee15(appId, status) {
        var _await$APIClient$post4, effectiveStatus;

        return _regeneratorRuntime.async(function () {
          function _callee15$(_context15) {
            while (1) {
              switch (_context15.prev = _context15.next) {
                case 0:
                  _context15.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.post("apps/" + appId + "/status", {
                    status: status
                  }));

                case 2:
                  _await$APIClient$post4 = _context15.sent;
                  effectiveStatus = _await$APIClient$post4.status;
                  return _context15.abrupt("return", effectiveStatus);

                case 5:
                case "end":
                  return _context15.stop();
              }
            }
          }

          return _callee15$;
        }(), null, null, null, Promise);
      }

      return _callee15;
    }();

    this.enableApp = function (appId) {
      return _this.setAppStatus(appId, 'manually_enabled');
    };

    this.disableApp = function (appId) {
      return _this.setAppStatus(appId, 'manually_disabled');
    };

    this.buildExternalUrl = function (appId) {
      var purchaseType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'buy';
      var details = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
      return APIClient.get('apps', {
        buildExternalUrl: 'true',
        appId: appId,
        purchaseType: purchaseType,
        details: details
      });
    };

    this.getCategories = function () {
      function _callee16() {
        var categories;
        return _regeneratorRuntime.async(function () {
          function _callee16$(_context16) {
            while (1) {
              switch (_context16.prev = _context16.next) {
                case 0:
                  _context16.next = 2;
                  return _regeneratorRuntime.awrap(APIClient.get('apps', {
                    categories: 'true'
                  }));

                case 2:
                  categories = _context16.sent;
                  return _context16.abrupt("return", categories);

                case 4:
                case "end":
                  return _context16.stop();
              }
            }
          }

          return _callee16$;
        }(), null, null, null, Promise);
      }

      return _callee16;
    }();

    this.getUIHost = function () {
      return _this._appClientUIHost;
    };

    this._appClientUIHost = new RealAppsEngineUIHost();
    this._manager = new AppClientManager(this._appClientUIHost);
    this.isLoaded = false;

    var _createDeferredValue3 = createDeferredValue();

    var _createDeferredValue4 = _slicedToArray(_createDeferredValue3, 2);

    this.deferredIsEnabled = _createDeferredValue4[0];
    this.setEnabled = _createDeferredValue4[1];
  }

  return AppClientOrchestrator;
}();

var Apps = new AppClientOrchestrator();
Meteor.startup(function () {
  CachedCollectionManager.onLogin(function () {
    Meteor.call('apps/is-enabled', function (error, isEnabled) {
      if (error) {
        Apps.handleError(error);
        return;
      }

      Apps.getAppClientManager().initialize();
      Apps.load(isEnabled);
    });
  });
  Tracker.autorun(function () {
    var isEnabled = settings.get('Apps_Framework_enabled');
    Apps.load(isEnabled);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"misc":{"Utilities.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/apps/lib/misc/Utilities.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);

var _typeof;

module.link("@babel/runtime/helpers/typeof", {
  default: function (v) {
    _typeof = v;
  }
}, 1);
module.export({
  Utilities: function () {
    return Utilities;
  }
});

var Utilities = /*#__PURE__*/function () {
  function Utilities() {}

  Utilities.getI18nKeyForApp = function () {
    function getI18nKeyForApp(key, appId) {
      return key && "apps-" + appId + "-" + key;
    }

    return getI18nKeyForApp;
  }();

  Utilities.curl = function () {
    function curl(_ref) {
      var method = _ref.method,
          params = _ref.params,
          auth = _ref.auth,
          _ref$headers = _ref.headers,
          headers = _ref$headers === void 0 ? {} : _ref$headers,
          url = _ref.url,
          query = _ref.query,
          content = _ref.content;
      var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var newLine = '\\\n   ';
      var cmd = ['curl']; // curl options

      if (opts.verbose) {
        cmd.push('-v');
      }

      if (opts.headers) {
        cmd.push('-i');
      } // method


      cmd.push('-X');
      cmd.push((method || 'GET').toUpperCase()); // URL

      var u = url;

      if (_typeof(params) === 'object') {
        Object.entries(params).forEach(function (_ref2) {
          var _ref3 = _slicedToArray(_ref2, 2),
              key = _ref3[0],
              value = _ref3[1];

          u = u.replace(":" + key, value);
        });
      }

      if (_typeof(query) === 'object') {
        var queryString = Object.entries(query).map(function (_ref4) {
          var _ref5 = _slicedToArray(_ref4, 2),
              key = _ref5[0],
              value = _ref5[1];

          return key + "=" + value;
        }).join('&');
        u += "?" + queryString;
      }

      cmd.push(u); // username

      if (auth) {
        cmd.push(newLine);
        cmd.push('-u');
        cmd.push(auth);
      } // headers


      var headerKeys = [];
      Object.entries(headers).forEach(function (_ref6) {
        var _ref7 = _slicedToArray(_ref6, 2),
            key = _ref7[0],
            val = _ref7[1];

        key = key.toLowerCase();
        headerKeys.push(key);
        cmd.push(newLine);
        cmd.push('-H');
        cmd.push("\"" + key + (val ? ': ' : ';') + (val || '') + "\"");
      });

      if (content) {
        if (_typeof(content) === 'object') {
          if (!headerKeys.includes('content-type')) {
            cmd.push(newLine);
            cmd.push('-H');
            cmd.push('"content-type: application/json"');
          }

          content = JSON.stringify(content);
        }

        cmd.push(newLine);
        cmd.push('--data-binary');
        cmd.push("'" + content + "'");
      }

      return cmd.join(' ');
    }

    return curl;
  }();

  return Utilities;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}}},"chatpal-search":{"client":{"template":{"admin.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/admin.html                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.admin.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.admin.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/template.admin.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("ChatpalAdmin");
Template["ChatpalAdmin"] = new Template("Template.ChatpalAdmin", (function() {
  var view = this;
  return HTML.SECTION({
    class: "page-container page-list"
  }, "\n\t\t", HTML.HEADER({
    class: "rc-header"
  }, "\n\t\t\t", HTML.DIV({
    class: "rc-header__wrap"
  }, "\n\t\t\t\t", HTML.SPAN({
    class: "rc-header__block"
  }, "\n\t\t\t\t\t", Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_AdminPage");
  }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "content"
  }, "\n\t\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("isAdmin"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "You_are_not_authorized_to_view_this_page");
    })), "\n\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Chatpal_Get_more_information_about_chatpal_on_our_website"));
    })), "\n\t\t\t\t", HTML.FORM("\n\t\t\t\t\t", HTML.DIV({
      class: "rocket-form"
    }, "\n\t\t\t\t\t\t", HTML.FIELDSET("\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "input-line"
    }, "\n\t\t\t\t\t\t\t\t", HTML.LABEL(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Chatpal_Email_Address");
    })), HTML.Raw('\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<input class="rc-input__element" type="text" autocomplete="off" name="email">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "input-line"
    }, "\n\t\t\t\t\t\t\t\t", HTML.LABEL(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Chatpal_Terms_and_Conditions");
    })), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
      id: "chatpal-tac",
      class: "chatpal-tac rc-input__element"
    }, "\n\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:tac", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("tac")));
    }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "input-line"
    }, "\n\t\t\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t\t\t", HTML.LABEL(HTML.Raw('\n\t\t\t\t\t\t\t\t\t\t<input type="checkbox" name="readtac">\n\t\t\t\t\t\t\t\t\t\t'), Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Chatpal_TAC_read");
    }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
      class: "submit"
    }, "\n\t\t\t\t\t\t\t", HTML.BUTTON({
      class: "rc-button rc-button--primary send"
    }, HTML.SPAN(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Chatpal_create_key");
    }))), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("apiKey"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV({
        class: "apikey"
      }, HTML.Raw("\n\t\t\t\t\t\t<h2>Here is your Chatpal Api Key</h2>\n\t\t\t\t\t\t"), HTML.DIV({
        class: "key"
      }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:apiKey", function() {
        return Spacebars.mustache(view.lookup("apiKey"));
      }), "\n\t\t\t\t\t\t"), HTML.Raw('<!-- TODO copy to clipboard -->\n\t\t\t\t\t\t<p>Please copy the key and insert it in the key field of the Chatpal Provider in the <a href="./admin/Search">Search Admin Page</a>.</p>\n\t\t\t\t\t')), "\n\t\t\t\t" ];
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"result.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/result.html                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.result.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.result.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/template.result.js                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("ChatpalSearchResultTemplate");
Template["ChatpalSearchResultTemplate"] = new Template("Template.ChatpalSearchResultTemplate", (function() {
  var view = this;
  return HTML.DIV({
    class: "chatpal-search-container"
  }, "\n\t\t", HTML.UL({
    class: "chatpal-search-typefilter"
  }, "\n\t\t\t", HTML.LI({
    value: "All",
    class: function() {
      return Spacebars.mustache(view.lookup("navSelected"), "All");
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_All_Results");
  })), "\n\t\t\t", HTML.LI({
    value: "Room",
    class: function() {
      return Spacebars.mustache(view.lookup("navSelected"), "Room");
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_Current_Room_Only");
  })), "\n\t\t\t", HTML.LI({
    value: "Messages",
    class: function() {
      return Spacebars.mustache(view.lookup("navSelected"), "Messages");
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_Messages_Only");
  })), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "chatpal-search-result"
  }, "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("searching"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "chatpal_search-loader"
    }, "\n\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t"), "\n\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("result"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.P({
        class: "chatpal-search-welcome"
      }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Chatpal_Welcome");
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }), "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("$eq"), view.lookup("resultType"), "All");
    }, function() {
      return [ "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("result"), "user", "docs"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-header"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Chatpal_Users");
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-list"
        }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("result"), "user", "docs"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("ChatpalSearchSingleUser")), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("result"), "room", "docs"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-header"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Chatpal_Rooms");
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-list"
        }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("result"), "room", "docs"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("ChatpalSearchSingleRoom")), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("result"), "message", "docs"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-header"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Chatpal_Messages");
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-list"
        }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("result"), "message", "docs"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("ChatpalSearchSingleMessage")), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("moreMessagesThanDisplayed"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "chatpal-show-more-messages"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), "Chatpal_More");
          })), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t" ];
      }), "\n\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("$not"), view.lookup("resultsFoundForAllSearch"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-header"
        }, "\n\t\t\t\t\t\t\t", HTML.H2({
          class: "chatpal-search-number"
        }, "\n\t\t\t\t\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Chatpal_No_Results");
        })), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("resultMessagesOnly"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV({
        class: "chatpal-search-result-header"
      }, "\n\t\t\t\t\t\t", HTML.H2({
        class: "chatpal-search-number"
      }, "\n\t\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("resultNumFound"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:resultNumFound", function() {
          return Spacebars.mustache(view.lookup("resultNumFound"));
        }), "\n\t\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("result"), "message"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "chatpal-search-result-list"
        }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("result"), "message", "docs"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("ChatpalSearchSingleMessage")), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("resultPaging"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.dataMustache(view.lookup("$neq"), Spacebars.dot(view.lookup("resultPaging"), "numOfPages"), 0);
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "chatpal-paging"
          }, "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("$gt"), Spacebars.dot(view.lookup("resultPaging"), "currentPage"), 1);
          }, function() {
            return HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="chatpal-paging-prev chatpal-paging-button">\n\t\t\t\t\t\t\t\t\t\t<i class="icon-left-circled2"></i>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t');
          }), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "chatpal-paging-text"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), "Chatpal_search_page_of", Spacebars.dot(view.lookup("resultPaging"), "currentPage"), Spacebars.dot(view.lookup("resultPaging"), "numOfPages"));
          })), "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("$lt"), Spacebars.dot(view.lookup("resultPaging"), "currentPage"), Spacebars.dot(view.lookup("resultPaging"), "numOfPages"));
          }, function() {
            return HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="chatpal-paging-next chatpal-paging-button">\n\t\t\t\t\t\t\t\t\t\t<i class="icon-right-circled2"></i>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t');
          }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

Template.__checkName("ChatpalSearchSingleMessage");
Template["ChatpalSearchSingleMessage"] = new Template("Template.ChatpalSearchSingleMessage", (function() {
  var view = this;
  return HTML.DIV({
    class: "chatpal-search-result-single"
  }, "\n\t\t", HTML.H2("\n\t\t\t", HTML.SPAN({
    class: "chatpal-channel"
  }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call(view.lookup("roomIcon"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t\t\t\t", Blaze.View("lookup:roomName", function() {
    return Spacebars.mustache(view.lookup("roomName"));
  })), "\n\t\t\t", HTML.A({
    class: "chatpal-link",
    href: function() {
      return [ Spacebars.mustache(view.lookup("roomLink")), "?msg=", Spacebars.mustache(view.lookup("_id")) ];
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_go_to_message");
  })), "\n\t\t\t", HTML.SPAN({
    class: "chatpal-date"
  }, Blaze.View("lookup:date", function() {
    return Spacebars.mustache(view.lookup("date"));
  })), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "chatpal-avatar"
  }, "\n\t\t\t", HTML.DIV({
    class: "chatpal-avatar-image",
    style: function() {
      return [ "background-image:url(", Spacebars.mustache(view.lookup("getAvatarUrl"), view.lookup("username")), ");" ];
    }
  }), "\n\t\t"), "\n\t\t", HTML.SPAN({
    class: "chatpal-name"
  }, Blaze.View("lookup:username", function() {
    return Spacebars.mustache(view.lookup("username"));
  })), "\n\t\t", HTML.SPAN({
    class: "chatpal-time"
  }, Blaze.View("lookup:time", function() {
    return Spacebars.mustache(view.lookup("time"));
  })), "\n\t\t", HTML.DIV({
    class: "chatpal-message"
  }, Blaze.View("lookup:text", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("text")));
  })), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("roomNotSubscribed"));
  }, function() {
    return [ "\n\t\t\t", HTML.DIV({
      class: "chatpal-info color-info-font-color"
    }, HTML.I(Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Chatpal_channel_not_joined_yet"));
    }))), "\n\t\t" ];
  }), "\n\t");
}));

Template.__checkName("ChatpalSearchSingleUser");
Template["ChatpalSearchSingleUser"] = new Template("Template.ChatpalSearchSingleUser", (function() {
  var view = this;
  return HTML.DIV({
    class: "chatpal-search-result-user"
  }, "\n\t\t", HTML.DIV({
    class: "chatpal-avatar"
  }, "\n\t\t\t", HTML.DIV({
    class: "chatpal-avatar-image",
    style: function() {
      return [ "background-image:url(", Spacebars.mustache(view.lookup("getAvatarUrl"), view.lookup("cleanUsername")), ");" ];
    }
  }), "\n\t\t"), "\n\t\t", HTML.H2(Blaze.View("lookup:user_name", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("user_name")));
  })), "\n\t\t", HTML.DIV({
    class: "direct-message"
  }, "\n\t\t\t", HTML.A({
    href: function() {
      return Spacebars.mustache(view.lookup("getDMUrl"), view.lookup("cleanUsername"));
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_go_to_user");
  })), "\n\t\t"), "\n\t");
}));

Template.__checkName("ChatpalSearchSingleRoom");
Template["ChatpalSearchSingleRoom"] = new Template("Template.ChatpalSearchSingleRoom", (function() {
  var view = this;
  return HTML.DIV({
    class: "chatpal-search-result-user chatpal-search-result-room"
  }, "\n\t\t", HTML.H2("\n\t\t\t", HTML.SPAN({
    class: "chatpal-channel"
  }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call(view.lookup("roomIcon"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t\t\t\t", Blaze.View("lookup:room_name", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("room_name")));
  })), "\n\t\t\t", HTML.A({
    class: "chatpal-link",
    href: function() {
      return Spacebars.mustache(view.lookup("roomLink"));
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_go_to_room");
  })), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "chatpal-search-pills"
  }, "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("room_topic"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "chatpal-search-pills-topic"
    }, Blaze.View("lookup:room_topic", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("room_topic")));
    })), "\n\t\t\t" ];
  }), "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("room_description"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "chatpal-search-pills-description"
    }, Blaze.View("lookup:room_description", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("room_description")));
    })), "\n\t\t\t" ];
  }), "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("room_announcement"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "chatpal-search-pills-announcement"
    }, Blaze.View("lookup:room_announcement", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("room_announcement")));
    })), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("roomNotSubscribed"));
  }, function() {
    return [ "\n\t\t\t", HTML.DIV({
      class: "chatpal-info color-info-font-color"
    }, HTML.I(Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Chatpal_channel_not_joined_yet"));
    }))), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"suggestion.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/suggestion.html                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.suggestion.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.suggestion.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/template.suggestion.js                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("ChatpalSuggestionItemTemplate");
Template["ChatpalSuggestionItemTemplate"] = new Template("Template.ChatpalSuggestionItemTemplate", (function() {
  var view = this;
  return HTML.DIV({
    class: "chatpal-suggestion"
  }, "\n\t\t", HTML.SPAN({
    class: "chatpal-suggestion-text"
  }, Blaze.View("lookup:text", function() {
    return Spacebars.mustache(view.lookup("text"));
  })), "\n\t\t", HTML.SPAN({
    class: "chatpal-suggestion-hint"
  }, "\n\t\t\t", Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Chatpal_run_search");
  }), "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call("chatpal-enter")
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"admin.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/admin.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 3);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var hasRole;
module.link("../../../authorization", {
  hasRole: function (v) {
    hasRole = v;
  }
}, 5);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 6);
var validateEmail;
module.link("../../../../lib/emailValidator", {
  validateEmail: function (v) {
    validateEmail = v;
  }
}, 7);
Template.ChatpalAdmin.onCreated(function () {
  var _this = this;

  this.validateEmail = validateEmail;
  this.apiKey = new ReactiveVar();
  var lang = settings.get('Language');
  this.lang = lang === 'de' || lang === 'en' ? lang : 'en';
  this.tac = new ReactiveVar();
  Meteor.call('chatpalUtilsGetTaC', this.lang, function (err, data) {
    _this.tac.set(data);
  });
});
Template.ChatpalAdmin.events({
  'submit form': function (e, t) {
    e.preventDefault();
    var email = e.target.email.value;
    var tac = e.target.readtac.checked;

    if (!tac) {
      return dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('Chatpal_ERROR_TAC_must_be_checked')
      });
    }

    if (!email || email === '') {
      return dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('Chatpal_ERROR_Email_must_be_set')
      });
    }

    if (!t.validateEmail(email)) {
      return dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('Chatpal_ERROR_Email_must_be_valid')
      });
    } // TODO register


    try {
      Meteor.call('chatpalUtilsCreateKey', email, function (err, key) {
        if (!key) {
          return dispatchToastMessage({
            type: 'error',
            message: TAPi18n.__('Chatpal_ERROR_username_already_exists')
          });
        }

        dispatchToastMessage({
          type: 'info',
          message: TAPi18n.__('Chatpal_created_key_successfully')
        });
        t.apiKey.set(key);
      });
    } catch (e) {
      console.log(e);
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('Chatpal_ERROR_username_already_exists')
      }); // TODO error messages
    }
  }
}); // template

Template.ChatpalAdmin.helpers({
  apiKey: function () {
    return Template.instance().apiKey.get();
  },
  isAdmin: function () {
    return hasRole(Meteor.userId(), 'admin');
  },
  tac: function () {
    return Template.instance().tac.get();
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"result.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/result.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 2);
var roomTypes, getURL;
module.link("../../../utils", {
  roomTypes: function (v) {
    roomTypes = v;
  },
  getURL: function (v) {
    getURL = v;
  }
}, 3);
var Subscriptions;
module.link("../../../models", {
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 4);
var getAvatarUrl;
module.link("../../../utils/lib/getUserAvatarURL", {
  getUserAvatarURL: function (v) {
    getAvatarUrl = v;
  }
}, 5);
var formatTime;
module.link("../../../../client/lib/utils/formatTime", {
  formatTime: function (v) {
    formatTime = v;
  }
}, 6);
var formatDate;
module.link("../../../../client/lib/utils/formatDate", {
  formatDate: function (v) {
    formatDate = v;
  }
}, 7);

var getDMUrl = function (username) {
  return getURL("/direct/" + username);
};

Template.ChatpalSearchResultTemplate.onCreated(function () {
  this.badRequest = new ReactiveVar(false);
  this.resultType = new ReactiveVar(this.data.settings.DefaultResultType);
  this.data.parentPayload.resultType = this.resultType.get();
});
Template.ChatpalSearchResultTemplate.events = {
  'click .chatpal-search-typefilter li': function (evt, t) {
    t.data.parentPayload.resultType = evt.currentTarget.getAttribute('value');
    t.data.payload.start = 0;
    t.resultType.set(t.data.parentPayload.resultType);
    t.data.search();
  },
  'click .chatpal-paging-prev': function (env, t) {
    t.data.payload.start -= t.data.settings.PageSize;
    t.data.search();
  },
  'click .chatpal-paging-next': function (env, t) {
    t.data.payload.start = (t.data.payload.start || 0) + t.data.settings.PageSize;
    t.data.search();
  },
  'click .chatpal-show-more-messages': function (evt, t) {
    t.data.parentPayload.resultType = 'Messages';
    t.data.payload.start = 0;
    t.data.payload.rows = t.data.settings.PageSize;
    t.resultType.set(t.data.parentPayload.resultType);
    t.data.search();
  }
};
Template.ChatpalSearchResultTemplate.helpers({
  result: function () {
    return Template.instance().data.result.get();
  },
  searching: function () {
    return Template.instance().data.searching.get();
  },
  resultType: function () {
    return Template.instance().resultType.get();
  },
  navSelected: function (type) {
    return Template.instance().resultType.get() === type ? 'selected' : '';
  },
  resultsFoundForAllSearch: function () {
    var result = Template.instance().data.result.get();

    if (!result) {
      return true;
    }

    return result.message.numFound > 0 || result.user.numFound > 0 || result.room.numFound > 0;
  },
  moreMessagesThanDisplayed: function () {
    var result = Template.instance().data.result.get();
    return result.message.docs.length < result.message.numFound;
  },
  resultNumFound: function () {
    var result = Template.instance().data.result.get();

    if (result) {
      switch (result.message.numFound) {
        case 0:
          return TAPi18n.__('Chatpal_no_search_results');

        case 1:
          return TAPi18n.__('Chatpal_one_search_result');

        default:
          return TAPi18n.__('Chatpal_search_results', result.message.numFound);
      }
    }
  },
  resultMessagesOnly: function () {
    return Template.instance().resultType.get() === 'Messages' || Template.instance().resultType.get() === 'Room';
  },
  resultPaging: function () {
    var result = Template.instance().data.result.get();
    var pageSize = Template.instance().data.settings.PageSize;

    if (result) {
      return {
        currentPage: 1 + result.message.start / pageSize,
        numOfPages: Math.ceil(result.message.numFound / pageSize)
      };
    }
  }
});
Template.ChatpalSearchSingleMessage.helpers({
  roomIcon: function () {
    var room = this.r;

    if (room && room.t === 'd') {
      return 'at';
    }

    return roomTypes.getIcon(room);
  },
  roomLink: function () {
    return roomTypes.getRouteLink(this.r.t, this.r);
  },
  roomName: function () {
    return roomTypes.getRoomName(this.r.t, this.r);
  },
  roomNotSubscribed: function () {
    var subscription = Subscriptions.findOne({
      rid: this.rid
    });
    return typeof subscription === 'undefined';
  },
  time: function () {
    return formatTime(this.created);
  },
  date: function () {
    return formatDate(this.created);
  },
  getAvatarUrl: getAvatarUrl
});
Template.ChatpalSearchSingleRoom.helpers({
  roomIcon: function () {
    if (this.t === 'd') {
      return 'at';
    }

    return roomTypes.getIcon(this);
  },
  roomLink: function () {
    return roomTypes.getRouteLink(this.t, this);
  },
  roomNotSubscribed: function () {
    var subscription = Subscriptions.findOne({
      rid: this.rid
    });
    return typeof subscription === 'undefined';
  }
});
Template.ChatpalSearchSingleUser.helpers({
  cleanUsername: function () {
    var username = this.user_username || this.username; // varies whether users or messages of users are displayed

    return username.replace(/<\/?em>/gi, '');
  },
  getAvatarUrl: getAvatarUrl,
  getDMUrl: getDMUrl
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"suggestion.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/template/suggestion.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
Template.ChatpalSuggestionItemTemplate.onCreated(function () {
  if (this.data.type === 'link') {
    this.data.action = function () {
      console.log('an example for an external link');
    };
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/index.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template/admin.html");
module.link("./template/result.html");
module.link("./template/suggestion.html");
module.link("./template/admin");
module.link("./template/result");
module.link("./template/suggestion");
module.link("./style.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"style.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/chatpal-search/client/style.css                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"livestream":{"client":{"views":{"broadcastView.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/broadcastView.html                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.broadcastView.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.broadcastView.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/template.broadcastView.js                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("broadcastView");
Template["broadcastView"] = new Template("Template.broadcastView", (function() {
  var view = this;
  return HTML.DIV({
    class: "streaming-popup"
  }, "\n    ", HTML.VIDEO({
    id: "player",
    src: function() {
      return Spacebars.mustache(view.lookup("broadcastSource"));
    },
    muted: "",
    autoplay: "",
    width: "380px"
  }), "\n  ");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"liveStreamTab.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/liveStreamTab.html                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.liveStreamTab.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.liveStreamTab.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/template.liveStreamTab.js                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("liveStreamTab");
Template["liveStreamTab"] = new Template("Template.liveStreamTab", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(view.lookup("hasSource"));
  }, function() {
    return [ "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isPopoutOpen"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("canDock"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          type: "button",
          class: "rc-button rc-button--primary js-close button-block",
          title: function() {
            return Spacebars.mustache(view.lookup("_"), "Livestream_close");
          }
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Livestream_close");
        })), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          type: "button",
          class: "rc-button rc-button--primary js-close button-block",
          title: function() {
            return Spacebars.mustache(view.lookup("_"), "Livestream_switch_to_room");
          }
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Livestream_switch_to_room");
        })), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("hasThumbnail"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "thumbnail-container",
          style: function() {
            return [ "background: url(", Spacebars.mustache(view.lookup("thumbnailUrl")), ") 100% no-repeat no-repeat;" ];
          }
        }, "\n\t\t\t\t\t\t", HTML.A({
          href: "#",
          class: "js-popout popout--absolute-center"
        }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            icon: Spacebars.call("play-solid"),
            block: Spacebars.call("popout")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.A({
          href: "#",
          class: "js-popout popout--absolute-center"
        }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            icon: Spacebars.call("play-solid"),
            block: Spacebars.call("popout")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t ", HTML.P(" ", Blaze.View("lookup:streamingUnavailableMessage", function() {
      return Spacebars.mustache(view.lookup("streamingUnavailableMessage"));
    }), " "), "\n\t\t" ];
  }), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("canEdit"));
  }, function() {
    return [ "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("editing"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("broadcastEnabled"));
      }, function() {
        return [ "\n\t\t\t\t\t", Spacebars.include(view.lookupTemplate("liveStreamBroadcast")), "\n\t\t\t\t" ];
      }), "\n\t\t\t\t", HTML.FORM({
        class: "liveStreamTab__form"
      }, "\n\t\t\t\t\t", HTML.LABEL({
        class: "rc-input__label"
      }, HTML.Raw("\n\t\t\t\t\t\t<p> Livestream not available message: </p>\n\t\t\t\t\t\t"), HTML.INPUT({
        type: "text",
        name: "streaming-message",
        class: "rc-input__element content-background-color editing",
        placeholder: function() {
          return Spacebars.mustache(view.lookup("_"), "Livestream_not_found");
        },
        value: function() {
          return Spacebars.mustache(view.lookup("streamingUnavailableMessage"));
        }
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.LABEL({
        class: "rc-input__label"
      }, HTML.Raw("\n\t\t\t\t\t\t<p> Livestream source (URL): </p>\n\t\t\t\t\t\t"), HTML.INPUT({
        type: "text",
        name: "streaming-source",
        class: "rc-input__element content-background-color editing",
        placeholder: function() {
          return Spacebars.mustache(view.lookup("_"), "Livestream_url");
        },
        value: function() {
          return Spacebars.mustache(view.lookup("streamingSource"));
        }
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
        class: "rc-switch"
      }, "\n\t\t\t\t\t\t", HTML.LABEL({
        class: "rc-switch__label",
        tabindex: "-1"
      }, "\n\t\t\t\t\t\t\t", HTML.INPUT({
        type: "checkbox",
        class: "rc-switch__input",
        name: "streaming-audio-only",
        checked: function() {
          return Spacebars.mustache(view.lookup("isAudioOnly"));
        }
      }), HTML.Raw('\n\t\t\t\t\t\t\t<span class="rc-switch__button">\n\t\t\t\t\t\t\t<span class="rc-switch__button-inside"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t'), HTML.SPAN({
        class: "rc-switch__text"
      }, "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Livestream_enable_audio_only");
      }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "rc-switch__description"
      }, Blaze.View("lookup:typeDescription", function() {
        return Spacebars.mustache(view.lookup("typeDescription"));
      })), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
        class: "rc-user-info__flex"
      }, "\n\t\t\t\t\t\t", HTML.BUTTON({
        type: "button",
        class: "rc-button rc-button--nude js-cancel button-block",
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Cancel");
        }
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Cancel");
      })), "\n\t\t\t\t\t\t", HTML.BUTTON({
        type: "button",
        class: "rc-button rc-button--submit js-clear button-block",
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Clear");
        }
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Clear");
      })), "\n\t\t\t\t\t\t", HTML.BUTTON({
        type: "button",
        class: "rc-button rc-button--primary js-save button-block",
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Save");
        }
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Save");
      })), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: "setting-block livestream--url"
      }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("permalink")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t\t", HTML.A({
        href: "#",
        class: "current-setting streaming-source-settings"
      }, " ", Blaze.View("lookup:streamingSource", function() {
        return Spacebars.mustache(view.lookup("streamingSource"));
      }), " "), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"liveStreamView.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/liveStreamView.html                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.liveStreamView.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.liveStreamView.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/template.liveStreamView.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("liveStreamView");
Template["liveStreamView"] = new Template("Template.liveStreamView", (function() {
  var view = this;
  return HTML.Raw('<div class="streaming-popup">\n    <div id="ytplayer"></div>\n  </div>');
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"livestreamBroadcast.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/livestreamBroadcast.html                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.livestreamBroadcast.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.livestreamBroadcast.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/template.livestreamBroadcast.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("liveStreamBroadcast");
Template["liveStreamBroadcast"] = new Template("Template.liveStreamBroadcast", (function() {
  var view = this;
  return HTML.Raw('<button type="button" class="rc-button rc-button--stack rc-button--primary js-broadcast"> Broadcast my Camera </button>');
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"broadcastView.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/broadcastView.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  call: function () {
    return call;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 2);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 3);
var handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 4);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 5);

var getMedia = function () {
  return navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
};

var createAndConnect = function (url) {
  if (!('WebSocket' in window)) {
    // eslint-disable-line no-negated-in-lhs
    return false;
  }

  var ws = new WebSocket(url);

  ws.onerror = function (evt) {
    return console.error("Error: " + evt.data);
  };

  return ws;
};

var sendMessageToWebSocket = function (message, ws) {
  if (ws != null) {
    if (ws.readyState === 1) {
      ws.send(message);
    }
  }
};

var call = function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  return new Promise(function (resolve, reject) {
    var _Meteor;

    (_Meteor = Meteor).call.apply(_Meteor, args.concat([function (err, result) {
      if (err) {
        handleError(err);
        reject(err);
      }

      resolve(result);
    }]));
  });
};

var delay = function (time) {
  return new Promise(function (resolve) {
    return setTimeout(resolve, time);
  });
};

var waitForStreamStatus = function () {
  function _callee2(id, status) {
    var streamActive;
    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              streamActive = new Promise(function () {
                function _callee(resolve) {
                  var currentStatus;
                  return _regeneratorRuntime.async(function () {
                    function _callee$(_context) {
                      while (1) {
                        switch (_context.prev = _context.next) {
                          case 0:
                            if (!true) {
                              _context.next = 10;
                              break;
                            }

                            _context.next = 3;
                            return _regeneratorRuntime.awrap(call('livestreamStreamStatus', {
                              streamId: id
                            }));

                          case 3:
                            currentStatus = _context.sent;

                            if (!(currentStatus === status)) {
                              _context.next = 6;
                              break;
                            }

                            return _context.abrupt("return", resolve(status));

                          case 6:
                            _context.next = 8;
                            return _regeneratorRuntime.awrap(delay(1500));

                          case 8:
                            _context.next = 0;
                            break;

                          case 10:
                          case "end":
                            return _context.stop();
                        }
                      }
                    }

                    return _callee$;
                  }(), null, null, null, Promise);
                }

                return _callee;
              }());
              _context2.next = 3;
              return _regeneratorRuntime.awrap(streamActive);

            case 3:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();

var waitForBroadcastStatus = function () {
  function _callee4(id, status) {
    var broadcastActive;
    return _regeneratorRuntime.async(function () {
      function _callee4$(_context4) {
        while (1) {
          switch (_context4.prev = _context4.next) {
            case 0:
              broadcastActive = new Promise(function () {
                function _callee3(resolve) {
                  var currentStatus;
                  return _regeneratorRuntime.async(function () {
                    function _callee3$(_context3) {
                      while (1) {
                        switch (_context3.prev = _context3.next) {
                          case 0:
                            if (!true) {
                              _context3.next = 10;
                              break;
                            }

                            _context3.next = 3;
                            return _regeneratorRuntime.awrap(call('getBroadcastStatus', {
                              broadcastId: id
                            }));

                          case 3:
                            currentStatus = _context3.sent;

                            if (!(currentStatus === status)) {
                              _context3.next = 6;
                              break;
                            }

                            return _context3.abrupt("return", resolve(status));

                          case 6:
                            _context3.next = 8;
                            return _regeneratorRuntime.awrap(delay(1500));

                          case 8:
                            _context3.next = 0;
                            break;

                          case 10:
                          case "end":
                            return _context3.stop();
                        }
                      }
                    }

                    return _callee3$;
                  }(), null, null, null, Promise);
                }

                return _callee3;
              }());
              _context4.next = 3;
              return _regeneratorRuntime.awrap(broadcastActive);

            case 3:
            case "end":
              return _context4.stop();
          }
        }
      }

      return _callee4$;
    }(), null, null, null, Promise);
  }

  return _callee4;
}();

Template.broadcastView.helpers({
  broadcastSource: function () {
    return Template.instance().mediaStream.get() ? window.URL.createObjectURL(Template.instance().mediaStream.get()) : '';
  },
  mediaRecorder: function () {
    Template.instance().mediaRecorder.get();
  }
});
Template.broadcastView.onCreated(function () {
  function _callee5() {
    var connection;
    return _regeneratorRuntime.async(function () {
      function _callee5$(_context5) {
        while (1) {
          switch (_context5.prev = _context5.next) {
            case 0:
              connection = createAndConnect(settings.get('Broadcasting_media_server_url') + "/" + this.data.id);
              this.mediaStream = new ReactiveVar(null);
              this.mediaRecorder = new ReactiveVar(null);
              this.connection = new ReactiveVar(connection);

            case 4:
            case "end":
              return _context5.stop();
          }
        }
      }

      return _callee5$;
    }(), null, this, null, Promise);
  }

  return _callee5;
}());
Template.broadcastView.onDestroyed(function () {
  if (this.connection.get()) {
    this.connection.get().close();
  }

  if (this.mediaRecorder.get()) {
    this.mediaRecorder.get().stop();
    this.mediaRecorder.set(null);
  }

  if (this.mediaStream.get()) {
    this.mediaStream.get().getTracks().map(function (track) {
      return track.stop();
    });
    this.mediaStream.set(null);
  }
});
Template.broadcastView.onRendered(function () {
  function _callee6() {
    var localMediaStream, connection, options, mediaRecorder;
    return _regeneratorRuntime.async(function () {
      function _callee6$(_context6) {
        while (1) {
          switch (_context6.prev = _context6.next) {
            case 0:
              navigator.getMedia = getMedia();

              if (navigator.getMedia) {
                _context6.next = 3;
                break;
              }

              return _context6.abrupt("return", alert('getUserMedia() is not supported in your browser!'));

            case 3:
              _context6.next = 5;
              return _regeneratorRuntime.awrap(new Promise(function (resolve, reject) {
                return navigator.getMedia({
                  video: true,
                  audio: true
                }, resolve, reject);
              }));

            case 5:
              localMediaStream = _context6.sent;
              connection = this.connection.get();
              this.mediaStream.set(localMediaStream);
              options = {
                mimeType: 'video/webm;codecs=vp9'
              };

              if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                options = {
                  mimeType: 'video/webm;codecs=vp8'
                };

                if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                  options = {
                    mimeType: 'video/webm'
                  };

                  if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                    options = {
                      mimeType: ''
                    };
                  }
                }
              }

              _context6.prev = 10;
              mediaRecorder = new MediaRecorder(localMediaStream, options);

              mediaRecorder.ondataavailable = function (event) {
                if (!(event.data || event.data.size > 0)) {
                  return;
                }

                sendMessageToWebSocket(event.data, connection);
              };

              mediaRecorder.start(100); // collect 100ms of data

              this.mediaRecorder.set(mediaRecorder);
              _context6.next = 17;
              return _regeneratorRuntime.awrap(waitForStreamStatus(this.data.stream.id, 'active'));

            case 17:
              _context6.next = 19;
              return _regeneratorRuntime.awrap(call('setLivestreamStatus', {
                broadcastId: this.data.broadcast.id,
                status: 'testing'
              }));

            case 19:
              _context6.next = 21;
              return _regeneratorRuntime.awrap(waitForBroadcastStatus(this.data.broadcast.id, 'testing'));

            case 21:
              document.querySelector('.streaming-popup').dispatchEvent(new Event('broadcastStreamReady'));
              _context6.next = 27;
              break;

            case 24:
              _context6.prev = 24;
              _context6.t0 = _context6["catch"](10);
              console.log(_context6.t0);

            case 27:
            case "end":
              return _context6.stop();
          }
        }
      }

      return _callee6$;
    }(), null, this, [[10, 24]], Promise);
  }

  return _callee6;
}());
Template.broadcastView.events({
  'startStreaming .streaming-popup': function () {
    function _callee7(e, i) {
      return _regeneratorRuntime.async(function () {
        function _callee7$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                _context7.next = 2;
                return _regeneratorRuntime.awrap(call('setLivestreamStatus', {
                  broadcastId: i.data.broadcast.id,
                  status: 'live'
                }));

              case 2:
                document.querySelector('.streaming-popup').dispatchEvent(new Event('broadcastStream'));
                _context7.next = 5;
                return _regeneratorRuntime.awrap(call('saveRoomSettings', Session.get('openedRoom'), 'streamingOptions', {
                  id: i.data.broadcast.id,
                  url: "https://www.youtube.com/embed/" + i.data.broadcast.id,
                  thumbnail: "https://img.youtube.com/vi/" + i.data.broadcast.id + "/0.jpg"
                }));

              case 5:
              case "end":
                return _context7.stop();
            }
          }
        }

        return _callee7$;
      }(), null, null, null, Promise);
    }

    return _callee7;
  }(),
  'stopStreaming .streaming-popup': function () {
    function _callee8(e, i) {
      return _regeneratorRuntime.async(function () {
        function _callee8$(_context8) {
          while (1) {
            switch (_context8.prev = _context8.next) {
              case 0:
                _context8.next = 2;
                return _regeneratorRuntime.awrap(call('setBroadcastStatus', {
                  broadcastId: i.data.broadcast.id,
                  status: 'complete'
                }));

              case 2:
                _context8.next = 4;
                return _regeneratorRuntime.awrap(call('saveRoomSettings', Session.get('openedRoom'), 'streamingOptions', {}, function (err) {
                  if (err) {
                    return handleError(err);
                  }

                  i.editing.set(false);
                  i.streamingOptions.set({});
                }));

              case 4:
                if (i.mediaRecorder.get()) {
                  i.mediaRecorder.get().stop();
                  i.mediaRecorder.set(null);
                }

                if (i.mediaStream.get()) {
                  i.mediaStream.get().getTracks().map(function (track) {
                    return track.stop();
                  });
                  i.mediaStream.set(null);
                }

              case 6:
              case "end":
                return _context8.stop();
            }
          }
        }

        return _callee8$;
      }(), null, null, null, Promise);
    }

    return _callee8;
  }()
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"liveStreamTab.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/liveStreamTab.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);
module.export({
  call: function () {
    return call;
  },
  close: function () {
    return close;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 2);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 3);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 4);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 5);
var auth;
module.link("../oauth.js", {
  auth: function (v) {
    auth = v;
  }
}, 6);
var RocketChatAnnouncement;
module.link("../../../lib", {
  RocketChatAnnouncement: function (v) {
    RocketChatAnnouncement = v;
  }
}, 7);
var popout;
module.link("../../../ui-utils", {
  popout: function (v) {
    popout = v;
  }
}, 8);
var t;
module.link("../../../utils", {
  t: function (v) {
    t = v;
  }
}, 9);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 10);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 11);
var hasAllPermission;
module.link("../../../authorization", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  }
}, 12);
var Users, Rooms;
module.link("../../../models", {
  Users: function (v) {
    Users = v;
  },
  Rooms: function (v) {
    Rooms = v;
  }
}, 13);
var handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 14);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 15);

var call = function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  return new Promise(function (resolve, reject) {
    var _Meteor;

    (_Meteor = Meteor).call.apply(_Meteor, args.concat([function (err, result) {
      if (err) {
        handleError(err);
        reject(err);
      }

      resolve(result);
    }]));
  });
};

var close = function (popup) {
  return new Promise(function (resolve) {
    var checkInterval = setInterval(function () {
      if (popup.closed) {
        clearInterval(checkInterval);
        resolve();
      }
    }, 300);
  });
};

function optionsFromUrl(url) {
  var options = {};
  var parsedUrl = url.match(/(http:|https:|)\/\/(www.)?(youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/|embed\?clip=)?([A-Za-z0-9._%-]*)(\&\S+)?/);
  options.url = url;

  if (parsedUrl != null) {
    options.id = parsedUrl[6];

    if (parsedUrl[3].includes('youtu')) {
      options.url = "https://www.youtube.com/embed/" + parsedUrl[6];
      options.thumbnail = "https://img.youtube.com/vi/" + parsedUrl[6] + "/0.jpg";
    } // @TODO add support for other urls

  }

  return options;
}

Template.liveStreamTab.helpers({
  broadcastEnabled: function () {
    return !!settings.get('Broadcasting_enabled');
  },
  streamingSource: function () {
    return Template.instance().streamingOptions.get() ? Template.instance().streamingOptions.get().url : '';
  },
  streamingUnavailableMessage: function () {
    return Template.instance().streamingOptions.get() && Template.instance().streamingOptions.get().message && Template.instance().streamingOptions.get().message !== '' ? Template.instance().streamingOptions.get().message : t('Livestream_not_found');
  },
  thumbnailUrl: function () {
    return Template.instance().streamingOptions.get() ? Template.instance().streamingOptions.get().thumbnail : '';
  },
  hasThumbnail: function () {
    return !!Template.instance().streamingOptions.get() && !!Template.instance().streamingOptions.get().thumbnail && Template.instance().streamingOptions.get().thumbnail !== '';
  },
  hasSource: function () {
    return !!Template.instance().streamingOptions.get() && !!Template.instance().streamingOptions.get().url && Template.instance().streamingOptions.get().url !== '';
  },
  canEdit: function () {
    return hasAllPermission('edit-room', this.rid);
  },
  editing: function () {
    return Template.instance().editing.get() || Template.instance().streamingOptions.get() == null || Template.instance().streamingOptions.get() != null && (Template.instance().streamingOptions.get().url == null || Template.instance().streamingOptions.get().url === '');
  },
  canDock: function () {
    var livestreamTabSource = Template.instance().streamingOptions.get().url;
    var popoutSource = null;

    try {
      if (popout.context) {
        popoutSource = Blaze.getData(popout.context).data && Blaze.getData(popout.context).data.streamingSource;
      }

      if (popoutSource != null && livestreamTabSource === popoutSource) {
        return true;
      }
    } catch (e) {
      return false;
    }

    return false;
  },
  isPopoutOpen: function () {
    return Template.instance().popoutOpen.get();
  },
  isAudioOnly: function () {
    return Template.instance().streamingOptions.get() ? Template.instance().streamingOptions.get().isAudioOnly : false;
  }
});
Template.liveStreamTab.onCreated(function () {
  var _this = this;

  this.editing = new ReactiveVar(false);
  this.streamingOptions = new ReactiveVar();
  this.popoutOpen = new ReactiveVar(popout.context != null);
  this.autorun(function () {
    var room = Rooms.findOne(_this.data.rid, {
      fields: {
        streamingOptions: 1
      }
    });

    _this.streamingOptions.set(room.streamingOptions);
  });
});
Template.liveStreamTab.onDestroyed(function () {
  if (popout.docked) {
    popout.close();
  }
});
Template.liveStreamTab.events({
  'click .js-cancel': function (e, i) {
    e.preventDefault();
    i.editing.set(false);
  },
  'click .js-clear': function (e, i) {
    e.preventDefault();
    var clearedObject = {};
    Meteor.call('saveRoomSettings', this.rid, 'streamingOptions', clearedObject, function (err) {
      if (err) {
        return handleError(err);
      }

      i.editing.set(false);
      i.streamingOptions.set(clearedObject);
      var roomAnnouncement = new RocketChatAnnouncement().getByRoom(i.data.rid);

      if (roomAnnouncement.getMessage() !== '') {
        roomAnnouncement.clear();
      }

      return dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Livestream_source_changed_succesfully')
      });
    });
  },
  'click .js-save': function (e, i) {
    e.preventDefault();

    var streamingOptions = _objectSpread(_objectSpread({}, optionsFromUrl(i.find('[name=streaming-source]').value)), {}, {
      isAudioOnly: i.find('[name=streaming-audio-only]').checked,
      message: i.find('[name=streaming-message]').value,
      type: 'livestream'
    });

    Meteor.call('saveRoomSettings', this.rid, 'streamingOptions', streamingOptions, function (err) {
      if (err) {
        return handleError(err);
      }

      i.editing.set(false);
      i.streamingOptions.set(streamingOptions);

      if (streamingOptions.url !== '') {
        new RocketChatAnnouncement({
          room: i.data.rid,
          message: 'Broadcast is now live. Click here to watch!',
          callback: 'openBroadcast'
        }).save();
      } else {
        var roomAnnouncement = new RocketChatAnnouncement().getByRoom(i.data.rid);

        if (roomAnnouncement.getMessage() !== '') {
          roomAnnouncement.clear();
        }
      }

      return dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Livestream_source_changed_succesfully')
      });
    });
  },
  'click .streaming-source-settings': function (e, i) {
    e.preventDefault();
    i.editing.set(true);
  },
  'click .js-dock': function (e) {
    e.stopPropagation();
    popout.docked = true;
  },
  'click .js-close': function (e, i) {
    e.stopPropagation();
    var popoutSource = '';

    if (popout.context) {
      popoutSource = Blaze.getData(popout.context).data && Blaze.getData(popout.context).data.streamingSource;
    }

    popout.close();

    if (popoutSource !== Template.instance().streamingOptions.get().url) {
      popout.open({
        content: 'liveStreamView',
        data: {
          streamingSource: i.streamingOptions.get().url,
          isAudioOnly: i.streamingOptions.get().isAudioOnly,
          showVideoControls: true,
          streamingOptions: i.streamingOptions.get()
        },
        onCloseCallback: function () {
          return i.popoutOpen.set(false);
        }
      });
    }
  },
  'submit .liveStreamTab__form': function (e, i) {
    e.preventDefault();
    e.stopPropagation();

    var streamingOptions = _objectSpread(_objectSpread({}, optionsFromUrl(i.find('[name=streaming-source]').value)), {}, {
      isAudioOnly: i.find('[name=streaming-audio-only]').checked,
      message: i.find('[name=streaming-message]').value,
      type: 'livestream'
    });

    Meteor.call('saveRoomSettings', this.rid, 'streamingOptions', streamingOptions, function (err) {
      if (err) {
        return handleError(err);
      }

      i.editing.set(false);
      i.streamingOptions.set(streamingOptions);

      if (streamingOptions.url !== '') {
        new RocketChatAnnouncement({
          room: i.data.rid,
          message: 'Broadcast is now live. Click here to watch!',
          callback: 'openBroadcast'
        }).save();
      } else {
        var roomAnnouncement = new RocketChatAnnouncement().getByRoom(i.data.rid);

        if (roomAnnouncement.getMessage() !== '') {
          roomAnnouncement.clear();
        }
      }

      return dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Livestream_source_changed_succesfully')
      });
    });
  },
  'click .js-popout': function (e, i) {
    e.preventDefault();
    popout.open({
      content: 'liveStreamView',
      data: {
        streamingSource: i.streamingOptions.get().url,
        isAudioOnly: i.streamingOptions.get().isAudioOnly,
        showVideoControls: true,
        streamingOptions: i.streamingOptions.get()
      },
      onCloseCallback: function () {
        return i.popoutOpen.set(false);
      }
    });
    i.popoutOpen.set(true);
  },
  'click .js-broadcast': function () {
    function _callee(e, i) {
      var user, result;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                e.preventDefault();
                e.currentTarget.classList.add('loading');
                _context.prev = 2;
                user = Users.findOne({
                  _id: Meteor.userId()
                }, {
                  fields: {
                    'settings.livestream': 1
                  }
                });

                if (!(!user.settings || !user.settings.livestream)) {
                  _context.next = 7;
                  break;
                }

                _context.next = 7;
                return _regeneratorRuntime.awrap(auth());

              case 7:
                _context.next = 9;
                return _regeneratorRuntime.awrap(call('livestreamGet', {
                  rid: i.data.rid
                }));

              case 9:
                result = _context.sent;
                popout.open({
                  content: 'broadcastView',
                  data: _objectSpread(_objectSpread({}, result), {}, {
                    showVideoControls: false,
                    showStreamControls: true
                  }),
                  onCloseCallback: function () {
                    return i.popoutOpen.set(false);
                  }
                });
                _context.next = 16;
                break;

              case 13:
                _context.prev = 13;
                _context.t0 = _context["catch"](2);
                console.log(_context.t0);

              case 16:
                _context.prev = 16;
                e.currentTarget.classList.remove('loading');
                return _context.finish(16);

              case 19:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, [[2, 13, 16, 19]], Promise);
    }

    return _callee;
  }()
});
callbacks.add('openBroadcast', function (rid) {
  var roomData = Session.get("roomData" + rid);

  if (!roomData) {
    return;
  }

  popout.open({
    content: 'liveStreamView',
    data: {
      streamingSource: roomData.streamingOptions.url,
      isAudioOnly: roomData.streamingOptions.isAudioOnly,
      showVideoControls: true,
      streamingOptions: roomData.streamingOptions
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"liveStreamView.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/liveStreamView.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);

this.onYouTubePlayerAPIReady = function () {
  var playerReadyEvent = new Event('playerReady');
  document.querySelector('.streaming-popup').dispatchEvent(playerReadyEvent);
};

this.liveStreamPlayer = null;
Template.liveStreamView.onCreated(function () {
  this.streamingOptions = new ReactiveVar(this.data.streamingOptions);
});
Template.liveStreamView.onRendered(function () {
  if (window.YT) {
    window.liveStreamPlayer = new window.YT.Player('ytplayer', {
      width: '380',
      height: '214',
      videoId: this.data.streamingOptions.id || '',
      playerVars: {
        autoplay: 1,
        controls: 0,
        showinfo: 0,
        enablejsapi: 1,
        fs: 0,
        modestbranding: 1,
        rel: 0
      },
      events: {
        onStateChange: function (e) {
          var playerStateChangedEvent = new CustomEvent('playerStateChanged', {
            detail: e.data
          });
          document.querySelector('.rc-popout').dispatchEvent(playerStateChangedEvent);
        }
      }
    });
  } else {
    var tag = document.createElement('script');
    tag.src = 'https://www.youtube.com/player_api';
    tag.type = 'text/javascript';
    var firstScriptTag = document.body.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
  }
});
Template.liveStreamView.events({
  'playerReady .streaming-popup': function (e, i) {
    window.liveStreamPlayer = new window.YT.Player('ytplayer', {
      width: '380',
      height: '214',
      videoId: i.streamingOptions.get().id || '',
      playerVars: {
        autoplay: 1,
        controls: 0,
        showinfo: 0,
        enablejsapi: 1,
        fs: 0,
        modestbranding: 1,
        rel: 0
      },
      events: {
        onStateChange: function (e) {
          var playerStateChangedEvent = new CustomEvent('playerStateChanged', {
            detail: e.data
          });
          document.querySelector('.rc-popout').dispatchEvent(playerStateChangedEvent);
        }
      }
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"livestreamBroadcast.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/views/livestreamBroadcast.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"styles":{"liveStreamTab.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/styles/liveStreamTab.css                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./views/liveStreamTab.html");
module.link("./views/liveStreamTab");
module.link("./views/livestreamBroadcast.html");
module.link("./views/livestreamBroadcast");
module.link("./views/broadcastView.html");
module.link("./views/broadcastView");
module.link("./views/liveStreamView.html");
module.link("./views/liveStreamView");
module.link("./tabBar");
module.link("./styles/liveStreamTab.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oauth.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/oauth.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  close: function () {
    return close;
  },
  auth: function () {
    return auth;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);

var close = function (popup) {
  return new Promise(function (resolve) {
    var checkInterval = setInterval(function () {
      if (popup.closed) {
        clearInterval(checkInterval);
        resolve();
      }
    }, 300);
  });
};

var auth = function () {
  function _callee() {
    var oauthWindow;
    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              oauthWindow = window.open(settings.get('Site_Url') + "/api/v1/livestream/oauth?userId=" + Meteor.userId(), 'youtube-integration-oauth', 'width=400,height=600');
              return _context.abrupt("return", close(oauthWindow));

            case 2:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/livestream/client/tabBar.tsx                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["label"];

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);
var React, useMemo;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var Option, Badge;
module.link("@rocket.chat/fuselage", {
  Option: function (v) {
    Option = v;
  },
  Badge: function (v) {
    Badge = v;
  }
}, 1);
var useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 2);
var useTranslation;
module.link("../../../client/contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 3);
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 4);
var Header;
module.link("../../../client/components/Header", {
  "default": function (v) {
    Header = v;
  }
}, 5);
addAction('livestream', function (_ref) {
  var _room$streamingOption;

  var room = _ref.room;
  var enabled = useSetting('Livestream_enabled');
  var t = useTranslation();
  var isLive = (room === null || room === void 0 ? void 0 : (_room$streamingOption = room.streamingOptions) === null || _room$streamingOption === void 0 ? void 0 : _room$streamingOption.id) && room.streamingOptions.type === 'livestream';
  return useMemo(function () {
    return enabled ? {
      groups: ['channel', 'group', 'team'],
      id: 'livestream',
      title: 'Livestream',
      icon: 'podcast',
      template: 'liveStreamTab',
      order: isLive ? -1 : 15,
      renderAction: function (props) {
        return /*#__PURE__*/React.createElement(Header.ToolBoxAction, props, isLive ? /*#__PURE__*/React.createElement(Header.Badge, {
          title: t('Livestream_live_now'),
          variant: "danger"
        }, "!") : null);
      },
      renderOption: function (_ref2) {
        var _ref2$label = _ref2.label,
            title = _ref2$label.title,
            icon = _ref2$label.icon,
            props = _objectWithoutProperties(_ref2, _excluded);

        return /*#__PURE__*/React.createElement(Option, _extends({
          label: title,
          title: title,
          icon: icon
        }, props), isLive ? /*#__PURE__*/React.createElement(Badge, {
          title: t('Livestream_live_now'),
          variant: "danger"
        }, "!") : null);
      }
    } : null;
  }, [enabled, isLive, t]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"mentions-flextab":{"client":{"views":{"mentionsFlexTab.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/views/mentionsFlexTab.html                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.mentionsFlexTab.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.mentionsFlexTab.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/views/template.mentionsFlexTab.js                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("mentionsFlexTab");
Template["mentionsFlexTab"] = new Template("Template.mentionsFlexTab", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(view.templateInstance().subscriptionsReady());
  }, function() {
    return [ "\n\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hasMessages"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "list-view mentioned-messages-list flex-tab__header"
      }, "\n\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "No_mentions_found");
      })), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  }), "\n\t", HTML.DIV({
    class: "flex-tab__result js-list"
  }, "\n\t\t", HTML.UL({
    class: "mentioned-messages-list list clearfix"
  }, "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("messages")),
        _variable: "msg"
      };
    }, function() {
      return Blaze._TemplateWith(function() {
        return {
          groupable: Spacebars.call(false),
          msg: Spacebars.call(view.lookup("msg")),
          room: Spacebars.call(view.lookup("room")),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          u: Spacebars.call(view.lookup("u")),
          customClass: Spacebars.call("mentions"),
          context: Spacebars.call("mentions")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      });
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasMore"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "load-more"
    }, "\n\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t"), "\n\t\t" ];
  }), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"mentionsFlexTab.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/views/mentionsFlexTab.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["_id"],
    _excluded2 = ["_id"];

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 2);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 2);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 3);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 4);
var messageContext;
module.link("../../../ui-utils/client/lib/messageContext", {
  messageContext: function (v) {
    messageContext = v;
  }
}, 5);
var upsertMessageBulk;
module.link("../../../ui-utils/client/lib/RoomHistoryManager", {
  upsertMessageBulk: function (v) {
    upsertMessageBulk = v;
  }
}, 6);
var APIClient;
module.link("../../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 7);
var Messages, Users;
module.link("../../../models/client", {
  Messages: function (v) {
    Messages = v;
  },
  Users: function (v) {
    Users = v;
  }
}, 8);
var getCommonRoomEvents;
module.link("../../../ui/client/views/app/lib/getCommonRoomEvents", {
  getCommonRoomEvents: function (v) {
    getCommonRoomEvents = v;
  }
}, 9);
var LIMIT_DEFAULT = 50;
Template.mentionsFlexTab.helpers({
  hasMessages: function () {
    return Template.instance().messages.find().count();
  },
  messages: function () {
    var instance = Template.instance();
    return instance.messages.find({}, {
      limit: instance.limit.get(),
      sort: {
        ts: -1
      }
    });
  },
  hasMore: function () {
    return Template.instance().hasMore.get();
  },
  messageContext: messageContext
});
Template.mentionsFlexTab.onCreated(function () {
  var _this = this;

  this.messages = new Mongo.Collection(null);
  this.hasMore = new ReactiveVar(true);
  this.limit = new ReactiveVar(LIMIT_DEFAULT);
  this.autorun(function () {
    var query = {
      '_hidden': {
        $ne: true
      },
      'mentions.username': Users.findOne(Meteor.userId(), {
        fields: {
          username: 1
        }
      }).username,
      'rid': _this.data.rid,
      '_updatedAt': {
        $gt: new Date()
      }
    };
    _this.cursor && _this.cursor.stop();

    _this.limit.set(LIMIT_DEFAULT);

    _this.cursor = Messages.find(query).observe({
      added: function (_ref) {
        var _id = _ref._id,
            message = _objectWithoutProperties(_ref, _excluded);

        _this.messages.upsert({
          _id: _id
        }, message);
      },
      changed: function (_ref2) {
        var _id = _ref2._id,
            message = _objectWithoutProperties(_ref2, _excluded2);

        _this.messages.upsert({
          _id: _id
        }, message);
      },
      removed: function (_ref3) {
        var _id = _ref3._id;

        _this.messages.remove({
          _id: _id
        });
      }
    });
  });
  this.autorun(function () {
    function _callee() {
      var limit, _await$APIClient$v1$g, messages, total;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                limit = _this.limit.get();
                _context.next = 3;
                return _regeneratorRuntime.awrap(APIClient.v1.get("chat.getMentionedMessages?roomId=" + _this.data.rid + "&count=" + limit));

              case 3:
                _await$APIClient$v1$g = _context.sent;
                messages = _await$APIClient$v1$g.messages;
                total = _await$APIClient$v1$g.total;
                upsertMessageBulk({
                  msgs: messages
                }, _this.messages);

                _this.hasMore.set(total > limit);

              case 8:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }());
});
Template.mentionsFlexTab.onDestroyed(function () {
  this.cursor.stop();
});
Template.mentionsFlexTab.events(_objectSpread(_objectSpread({}, getCommonRoomEvents()), {}, {
  'scroll .js-list': _.throttle(function (e, instance) {
    if (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight && instance.hasMore.get()) {
      return instance.limit.set(instance.limit.get() + 50);
    }
  }, 200)
}));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"actionButton.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/actionButton.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 2);
var MessageAction, RoomHistoryManager;
module.link("../../ui-utils", {
  MessageAction: function (v) {
    MessageAction = v;
  },
  RoomHistoryManager: function (v) {
    RoomHistoryManager = v;
  }
}, 3);
var messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 4);
var Rooms;
module.link("../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 5);
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'jump-to-message',
    icon: 'jump',
    label: 'Jump_to_message',
    context: ['mentions', 'threads'],
    action: function (e) {
      e.preventDefault();
      e.stopPropagation();

      var _messageArgs = messageArgs(this),
          message = _messageArgs.msg;

      if (window.matchMedia('(max-width: 500px)').matches) {
        Template.instance().tabBar.close();
      }

      if (message.tmid) {
        return FlowRouter.go(FlowRouter.getRouteName(), {
          tab: 'thread',
          context: message.tmid,
          rid: message.rid,
          name: Rooms.findOne({
            _id: message.rid
          }).name
        }, {
          jump: message._id
        });
      }

      RoomHistoryManager.getSurroundingMessages(message, 50);
    },
    order: 100,
    group: ['message', 'menu']
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/index.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./views/mentionsFlexTab.html");
module.link("./views/mentionsFlexTab");
module.link("./actionButton");
module.link("./tabBar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions-flextab/client/tabBar.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 0);
addAction('mentions', {
  groups: ['channel', 'group', 'team'],
  id: 'mentions',
  title: 'Mentions',
  icon: 'at',
  template: 'mentionsFlexTab',
  order: 9
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"message-pin":{"client":{"views":{"pinnedMessages.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/views/pinnedMessages.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.pinnedMessages.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.pinnedMessages.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/views/template.pinnedMessages.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("pinnedMessages");
Template["pinnedMessages"] = new Template("Template.pinnedMessages", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(view.templateInstance().subscriptionsReady());
  }, function() {
    return [ "\n\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hasMessages"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "list-view pinned-messages-list flex-tab__header"
      }, "\n\t\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "No_pinned_messages");
      })), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  }), "\n\t", HTML.DIV({
    class: "flex-tab__result pinned-messages-list js-list"
  }, "\n\t\t", HTML.UL({
    class: "list clearfix"
  }, "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("messages")),
        _variable: "msg"
      };
    }, function() {
      return Blaze._TemplateWith(function() {
        return {
          context: Spacebars.call("pinned"),
          msg: Spacebars.call(view.lookup("msg")),
          room: Spacebars.call(view.lookup("room")),
          groupable: Spacebars.call(true),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          u: Spacebars.call(view.lookup("u"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      });
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasMore"));
  }, function() {
    return [ "\n\t\t\t", HTML.DIV({
      class: "load-more"
    }, "\n\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t"), "\n\t\t" ];
  }), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"stylesheets":{"messagepin.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/views/stylesheets/messagepin.css                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"pinnedMessages.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/views/pinnedMessages.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["_id"],
    _excluded2 = ["_id"];

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 2);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 3);
var upsertMessageBulk;
module.link("../../../ui-utils/client/lib/RoomHistoryManager", {
  upsertMessageBulk: function (v) {
    upsertMessageBulk = v;
  }
}, 4);
var messageContext;
module.link("../../../ui-utils/client/lib/messageContext", {
  messageContext: function (v) {
    messageContext = v;
  }
}, 5);
var APIClient;
module.link("../../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 6);
var Messages;
module.link("../../../models/client", {
  Messages: function (v) {
    Messages = v;
  }
}, 7);
var getCommonRoomEvents;
module.link("../../../ui/client/views/app/lib/getCommonRoomEvents", {
  getCommonRoomEvents: function (v) {
    getCommonRoomEvents = v;
  }
}, 8);
var LIMIT_DEFAULT = 50;
Template.pinnedMessages.helpers({
  hasMessages: function () {
    return Template.instance().messages.find().count();
  },
  messages: function () {
    var instance = Template.instance();
    return instance.messages.find({}, {
      limit: instance.limit.get(),
      sort: {
        ts: -1
      }
    });
  },
  hasMore: function () {
    return Template.instance().hasMore.get();
  },
  messageContext: messageContext
});
Template.pinnedMessages.onCreated(function () {
  var _this = this;

  this.pinnedMessages = new ReactiveVar([]);
  this.hasMore = new ReactiveVar(true);
  this.limit = new ReactiveVar(LIMIT_DEFAULT);
  this.rid = this.data.rid;
  this.messages = new Mongo.Collection(null);
  this.autorun(function () {
    var query = {
      t: {
        $ne: 'rm'
      },
      _hidden: {
        $ne: true
      },
      pinned: true,
      rid: _this.data.rid,
      _updatedAt: {
        $gte: new Date()
      }
    };
    _this.cursor && _this.cursor.stop();

    _this.limit.set(LIMIT_DEFAULT);

    _this.cursor = Messages.find(query).observe({
      added: function (_ref) {
        var _id = _ref._id,
            message = _objectWithoutProperties(_ref, _excluded);

        _this.messages.upsert({
          _id: _id
        }, message);
      },
      changed: function (_ref2) {
        var _id = _ref2._id,
            message = _objectWithoutProperties(_ref2, _excluded2);

        _this.messages.upsert({
          _id: _id
        }, message);
      },
      removed: function (_ref3) {
        var _id = _ref3._id;

        _this.messages.remove({
          _id: _id
        });
      }
    });
  });
  this.autorun(function () {
    function _callee() {
      var limit, _await$APIClient$v1$g, messages, total;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                limit = _this.limit.get();
                _context.next = 3;
                return _regeneratorRuntime.awrap(APIClient.v1.get("chat.getPinnedMessages?roomId=" + _this.rid + "&count=" + limit));

              case 3:
                _await$APIClient$v1$g = _context.sent;
                messages = _await$APIClient$v1$g.messages;
                total = _await$APIClient$v1$g.total;
                upsertMessageBulk({
                  msgs: messages
                }, _this.messages);

                _this.hasMore.set(total > limit);

              case 8:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }());
});
Template.mentionsFlexTab.onDestroyed(function () {
  this.cursor.stop();
});
Template.pinnedMessages.events(_objectSpread(_objectSpread({}, getCommonRoomEvents()), {}, {
  'scroll .js-list': _.throttle(function (e, instance) {
    if (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight && instance.hasMore.get()) {
      return instance.limit.set(instance.limit.get() + 50);
    }
  }, 200)
}));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"actionButton.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/actionButton.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 2);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 3);
var RoomHistoryManager, MessageAction;
module.link("../../ui-utils", {
  RoomHistoryManager: function (v) {
    RoomHistoryManager = v;
  },
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 4);
var messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 5);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 6);
var hasAtLeastOnePermission;
module.link("../../authorization", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 7);
var Rooms;
module.link("../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 8);
var roomTypes;
module.link("../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 9);
var handleError;
module.link("../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 10);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 11);
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'pin-message',
    icon: 'pin',
    label: 'Pin',
    context: ['pinned', 'message', 'message-mobile', 'threads', 'direct'],
    action: function () {
      var _messageArgs = messageArgs(this),
          message = _messageArgs.msg;

      message.pinned = true;
      Meteor.call('pinMessage', message, function (error) {
        if (error) {
          return handleError(error);
        }
      });
    },
    condition: function (_ref) {
      var msg = _ref.msg,
          subscription = _ref.subscription,
          room = _ref.room;

      if (!settings.get('Message_AllowPinning') || msg.pinned || !subscription) {
        return false;
      }

      var isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return hasAtLeastOnePermission('pin-message', msg.rid);
    },
    order: 7,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'unpin-message',
    icon: 'pin',
    label: 'Unpin',
    context: ['pinned', 'message', 'message-mobile', 'threads', 'direct'],
    action: function () {
      var _messageArgs2 = messageArgs(this),
          message = _messageArgs2.msg;

      message.pinned = false;
      Meteor.call('unpinMessage', message, function (error) {
        if (error) {
          return handleError(error);
        }
      });
    },
    condition: function (_ref2) {
      var msg = _ref2.msg,
          subscription = _ref2.subscription;

      if (!subscription || !settings.get('Message_AllowPinning') || !msg.pinned) {
        return false;
      }

      return hasAtLeastOnePermission('pin-message', msg.rid);
    },
    order: 8,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'jump-to-pin-message',
    icon: 'jump',
    label: 'Jump_to_message',
    context: ['pinned', 'message-mobile', 'direct'],
    action: function () {
      var _messageArgs3 = messageArgs(this),
          message = _messageArgs3.msg;

      if (window.matchMedia('(max-width: 500px)').matches) {
        Template.instance().tabBar.close();
      }

      if (message.tmid) {
        return FlowRouter.go(FlowRouter.getRouteName(), {
          tab: 'thread',
          context: message.tmid,
          rid: message.rid,
          jump: message._id,
          name: Rooms.findOne({
            _id: message.rid
          }).name
        }, {
          jump: message._id
        });
      }

      return RoomHistoryManager.getSurroundingMessages(message, 50);
    },
    condition: function (_ref3) {
      var subscription = _ref3.subscription;
      return !!subscription;
    },
    order: 100,
    group: ['message', 'menu']
  });
  MessageAction.addButton({
    id: 'permalink-pinned',
    icon: 'permalink',
    label: 'Get_link',
    classes: 'clipboard',
    context: ['pinned'],
    action: function () {
      function _callee() {
        var _messageArgs4, message, permalink;

        return _regeneratorRuntime.async(function () {
          function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  _messageArgs4 = messageArgs(this), message = _messageArgs4.msg;
                  _context.next = 3;
                  return _regeneratorRuntime.awrap(MessageAction.getPermaLink(message._id));

                case 3:
                  permalink = _context.sent;
                  navigator.clipboard.writeText(permalink);
                  dispatchToastMessage({
                    type: 'success',
                    message: TAPi18n.__('Copied')
                  });

                case 6:
                case "end":
                  return _context.stop();
              }
            }
          }

          return _callee$;
        }(), null, this, null, Promise);
      }

      return _callee;
    }(),
    condition: function (_ref4) {
      var subscription = _ref4.subscription;
      return !!subscription;
    },
    order: 101,
    group: 'menu'
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./actionButton");
module.link("./messageType");
module.link("./pinMessage");
module.link("./tabBar");
module.link("./views/pinnedMessages.html");
module.link("./views/pinnedMessages");
module.link("./views/stylesheets/messagepin.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/messageType.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var MessageTypes;
module.link("../../ui-utils", {
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 1);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'message_pinned',
    system: true,
    message: 'Pinned_a_message'
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"pinMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/pinMessage.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 1);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var ChatMessage, Subscriptions;
module.link("../../models", {
  ChatMessage: function (v) {
    ChatMessage = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 3);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 4);
Meteor.methods({
  pinMessage: function (message) {
    if (!Meteor.userId()) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-not-authorized')
      });
      return false;
    }

    if (!settings.get('Message_AllowPinning')) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('pinning-not-allowed')
      });
      return false;
    }

    if (Subscriptions.findOne({
      rid: message.rid
    }) == null) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-pinning-message')
      });
      return false;
    }

    if (typeof message._id !== 'string') {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-pinning-message')
      });
      return false;
    }

    dispatchToastMessage({
      type: 'success',
      message: TAPi18n.__('Message_has_been_pinned')
    });
    return ChatMessage.update({
      _id: message._id,
      rid: message.rid
    }, {
      $set: {
        pinned: true
      }
    });
  },
  unpinMessage: function (message) {
    if (!Meteor.userId()) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-not-authorized')
      });
      return false;
    }

    if (!settings.get('Message_AllowPinning')) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('unpinning-not-allowed')
      });
      return false;
    }

    if (Subscriptions.findOne({
      rid: message.rid
    }) == null) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-unpinning-message')
      });
      return false;
    }

    if (typeof message._id !== 'string') {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-unpinning-message')
      });
      return false;
    }

    dispatchToastMessage({
      type: 'success',
      message: TAPi18n.__('Message_has_been_unpinned')
    });
    return ChatMessage.update({
      _id: message._id,
      rid: message.rid
    }, {
      $set: {
        pinned: false
      }
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-pin/client/tabBar.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMemo;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
var useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 2);
addAction('pinned-messages', function () {
  var pinningAllowed = useSetting('Message_AllowPinning');
  return useMemo(function () {
    return pinningAllowed ? {
      groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
      id: 'pinned-messages',
      title: 'Pinned_Messages',
      icon: 'pin',
      template: 'pinnedMessages',
      order: 11
    } : null;
  }, [pinningAllowed]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"message-star":{"client":{"views":{"starredMessages.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/views/starredMessages.html                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.starredMessages.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.starredMessages.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/views/template.starredMessages.js                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("starredMessages");
Template["starredMessages"] = new Template("Template.starredMessages", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(view.templateInstance().subscriptionsReady());
  }, function() {
    return [ "\n\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hasMessages"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "list-view starred-messages-list flex-tab__header"
      }, "\n\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "No_starred_messages");
      })), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  }), "\n\t", HTML.DIV({
    class: "flex-tab__result js-list"
  }, "\n\t\t", HTML.UL({
    class: "list clearfix"
  }, "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.Each(function() {
      return {
        _sequence: Spacebars.call(view.lookup("messages")),
        _variable: "msg"
      };
    }, function() {
      return [ "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          msg: Spacebars.call(view.lookup("msg")),
          context: Spacebars.call("starred"),
          room: Spacebars.call(view.lookup("room")),
          groupable: Spacebars.call(false),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          u: Spacebars.call(view.lookup("u"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("hasMore"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "load-more"
    }, "\n\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t"), "\n\t\t" ];
  }), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"stylesheets":{"messagestar.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/views/stylesheets/messagestar.css                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"starredMessages.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/views/starredMessages.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["_id"],
    _excluded2 = ["_id"];

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 2);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 3);
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 4);
var messageContext;
module.link("../../../ui-utils/client/lib/messageContext", {
  messageContext: function (v) {
    messageContext = v;
  }
}, 5);
var Messages;
module.link("../../../models/client", {
  Messages: function (v) {
    Messages = v;
  }
}, 6);
var upsertMessageBulk;
module.link("../../../ui-utils/client/lib/RoomHistoryManager", {
  upsertMessageBulk: function (v) {
    upsertMessageBulk = v;
  }
}, 7);
var APIClient;
module.link("../../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 8);
var getCommonRoomEvents;
module.link("../../../ui/client/views/app/lib/getCommonRoomEvents", {
  getCommonRoomEvents: function (v) {
    getCommonRoomEvents = v;
  }
}, 9);
var LIMIT_DEFAULT = 50;
Template.starredMessages.helpers({
  hasMessages: function () {
    return Template.instance().messages.find().count();
  },
  messages: function () {
    var instance = Template.instance();
    return instance.messages.find({}, {
      limit: instance.limit.get(),
      sort: {
        ts: -1
      }
    });
  },
  hasMore: function () {
    return Template.instance().hasMore.get();
  },
  messageContext: messageContext
});
Template.starredMessages.onCreated(function () {
  var _this = this;

  this.rid = this.data.rid;
  this.messages = new Mongo.Collection(null);
  this.hasMore = new ReactiveVar(true);
  this.limit = new ReactiveVar(LIMIT_DEFAULT);
  this.autorun(function () {
    var query = {
      '_hidden': {
        $ne: true
      },
      'starred._id': Meteor.userId(),
      'rid': _this.rid,
      '_updatedAt': {
        $gt: new Date()
      }
    };
    _this.cursor && _this.cursor.stop();

    _this.limit.set(LIMIT_DEFAULT);

    _this.cursor = Messages.find(query).observe({
      added: function (_ref) {
        var _id = _ref._id,
            message = _objectWithoutProperties(_ref, _excluded);

        _this.messages.upsert({
          _id: _id
        }, message);
      },
      changed: function (_ref2) {
        var _id = _ref2._id,
            message = _objectWithoutProperties(_ref2, _excluded2);

        _this.messages.upsert({
          _id: _id
        }, message);
      },
      removed: function (_ref3) {
        var _id = _ref3._id;

        _this.messages.remove({
          _id: _id
        });
      }
    });
  });
  this.autorun(function () {
    function _callee() {
      var limit, _await$APIClient$v1$g, messages, total;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                limit = _this.limit.get();
                _context.next = 3;
                return _regeneratorRuntime.awrap(APIClient.v1.get("chat.getStarredMessages?roomId=" + _this.rid + "&count=" + limit));

              case 3:
                _await$APIClient$v1$g = _context.sent;
                messages = _await$APIClient$v1$g.messages;
                total = _await$APIClient$v1$g.total;
                upsertMessageBulk({
                  msgs: messages
                }, _this.messages);

                _this.hasMore.set(total > limit);

              case 8:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }());
});
Template.mentionsFlexTab.onDestroyed(function () {
  this.cursor.stop();
});
Template.starredMessages.events(_objectSpread(_objectSpread({}, getCommonRoomEvents()), {}, {
  'scroll .js-list': _.throttle(function (e, instance) {
    if (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight) {
      return instance.limit.set(instance.limit.get() + 50);
    }
  }, 200)
}));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"actionButton.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/actionButton.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 2);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 3);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var RoomHistoryManager, MessageAction;
module.link("../../ui-utils", {
  RoomHistoryManager: function (v) {
    RoomHistoryManager = v;
  },
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 5);
var messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 6);
var Rooms;
module.link("../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 7);
var roomTypes;
module.link("../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 8);
var handleError;
module.link("../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 9);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 10);
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'star-message',
    icon: 'star',
    label: 'Star',
    context: ['starred', 'message', 'message-mobile', 'threads'],
    action: function () {
      var _messageArgs = messageArgs(this),
          message = _messageArgs.msg;

      message.starred = Meteor.userId();
      Meteor.call('starMessage', message, function (error) {
        if (error) {
          return handleError(error);
        }
      });
    },
    condition: function (_ref) {
      var message = _ref.msg,
          subscription = _ref.subscription,
          u = _ref.u,
          room = _ref.room;

      if (subscription == null && settings.get('Message_AllowStarring')) {
        return false;
      }

      var isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return !message.starred || !message.starred.find(function (star) {
        return star._id === u._id;
      });
    },
    order: 9,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'unstar-message',
    icon: 'star',
    label: 'Unstar_Message',
    context: ['starred', 'message', 'message-mobile', 'threads'],
    action: function () {
      var _messageArgs2 = messageArgs(this),
          message = _messageArgs2.msg;

      message.starred = false;
      Meteor.call('starMessage', message, function (error) {
        if (error) {
          handleError(error);
        }
      });
    },
    condition: function (_ref2) {
      var message = _ref2.msg,
          subscription = _ref2.subscription,
          u = _ref2.u;

      if (subscription == null && settings.get('Message_AllowStarring')) {
        return false;
      }

      return message.starred && message.starred.find(function (star) {
        return star._id === u._id;
      });
    },
    order: 9,
    group: 'menu'
  });
  MessageAction.addButton({
    id: 'jump-to-star-message',
    icon: 'jump',
    label: 'Jump_to_message',
    context: ['starred', 'threads', 'message-mobile'],
    action: function () {
      var _messageArgs3 = messageArgs(this),
          message = _messageArgs3.msg;

      if (window.matchMedia('(max-width: 500px)').matches) {
        Template.instance().tabBar.close();
      }

      if (message.tmid) {
        return FlowRouter.go(FlowRouter.getRouteName(), {
          tab: 'thread',
          context: message.tmid,
          rid: message.rid,
          jump: message._id,
          name: Rooms.findOne({
            _id: message.rid
          }).name
        }, {
          jump: message._id
        });
      }

      RoomHistoryManager.getSurroundingMessages(message, 50);
    },
    condition: function (_ref3) {
      var msg = _ref3.msg,
          subscription = _ref3.subscription,
          u = _ref3.u;

      if (subscription == null || !settings.get('Message_AllowStarring')) {
        return false;
      }

      return msg.starred && msg.starred.find(function (star) {
        return star._id === u._id;
      });
    },
    order: 100,
    group: ['message', 'menu']
  });
  MessageAction.addButton({
    id: 'permalink-star',
    icon: 'permalink',
    label: 'Get_link',
    classes: 'clipboard',
    context: ['starred', 'threads'],
    action: function () {
      function _callee() {
        var _messageArgs4, message, permalink;

        return _regeneratorRuntime.async(function () {
          function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  _messageArgs4 = messageArgs(this), message = _messageArgs4.msg;
                  _context.next = 3;
                  return _regeneratorRuntime.awrap(MessageAction.getPermaLink(message._id));

                case 3:
                  permalink = _context.sent;
                  navigator.clipboard.writeText(permalink);
                  dispatchToastMessage({
                    type: 'success',
                    message: TAPi18n.__('Copied')
                  });

                case 6:
                case "end":
                  return _context.stop();
              }
            }
          }

          return _callee$;
        }(), null, this, null, Promise);
      }

      return _callee;
    }(),
    condition: function (_ref4) {
      var msg = _ref4.msg,
          subscription = _ref4.subscription,
          u = _ref4.u;

      if (subscription == null) {
        return false;
      }

      return msg.starred && msg.starred.find(function (star) {
        return star._id === u._id;
      });
    },
    order: 101,
    group: 'menu'
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/index.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./actionButton");
module.link("./starMessage");
module.link("./tabBar");
module.link("./views/starredMessages.html");
module.link("./views/starredMessages");
module.link("./views/stylesheets/messagestar.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"starMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/starMessage.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 1);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var ChatMessage, Subscriptions;
module.link("../../models", {
  ChatMessage: function (v) {
    ChatMessage = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 3);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 4);
Meteor.methods({
  starMessage: function (message) {
    if (!Meteor.userId()) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-starring-message')
      });
      return false;
    }

    if (Subscriptions.findOne({
      rid: message.rid
    }) == null) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-starring-message')
      });
      return false;
    }

    if (!ChatMessage.findOneByRoomIdAndMessageId(message.rid, message._id)) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-starring-message')
      });
      return false;
    }

    if (!settings.get('Message_AllowStarring')) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('error-starring-message')
      });
      return false;
    }

    if (message.starred) {
      dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Message_has_been_starred')
      });
    } else {
      dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Message_has_been_unstarred')
      });
    }

    return ChatMessage.update({
      _id: message._id
    }, {
      $set: {
        starred: !!message.starred
      }
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-star/client/tabBar.ts                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 0);
addAction('starred-messages', {
  groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
  id: 'starred-messages',
  title: 'Starred_Messages',
  icon: 'star',
  template: 'starredMessages',
  order: 10
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"oauth2-server-config":{"client":{"oauth":{"oauth2-client.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/oauth/oauth2-client.html                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oauth2-client.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oauth2-client.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/oauth/template.oauth2-client.js                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("authorize");
Template["authorize"] = new Template("Template.authorize", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("currentUser"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "oauth-panel"
    }, "\n\t\t\t", HTML.FORM({
      method: "post",
      action: "",
      role: "form",
      class: function() {
        return Blaze.Unless(function() {
          return Spacebars.call(view.templateInstance().subscriptionsReady());
        }, function() {
          return "hidden";
        });
      }
    }, "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("currentUser"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV({
        class: "user-info"
      }, "\n\t\t\t\t\t\t", HTML.DIV({
        class: "thumb"
      }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          username: Spacebars.call(Spacebars.dot(view.lookup("currentUser"), "username"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("avatar"));
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
        class: "username"
      }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "You_are_logged_in_as");
      }), "\n\t\t\t\t\t\t\t", HTML.H1(Blaze.View("lookup:currentUser.username", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("currentUser"), "username"));
      })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }), "\n\n\t\t\t\t", HTML.DIV({
      class: "integration-info"
    }, "\n\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t", HTML.SPAN(HTML.B(Blaze.View("lookup:getClient.name", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("getClient"), "name"));
    })), " ", Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "will_be_able_to");
    })), HTML.Raw('\n\t\t\t\t\t\t<ul class="integration-permissions">\n\t\t\t\t\t\t\t<li>Post Messages</li>\n\t\t\t\t\t\t\t<li>Create Channels</li>\n\t\t\t\t\t\t\t<li>Change Channel Topic</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t')), "\n\t\t\t\t"), HTML.Raw('\n\t\t\t\t<input type="hidden" name="allow" value="yes">\n\t\t\t\t'), HTML.INPUT({
      type: "hidden",
      name: "token",
      value: function() {
        return Spacebars.mustache(view.lookup("getToken"));
      }
    }), "\n\t\t\t\t", HTML.INPUT({
      type: "hidden",
      name: "client_id",
      value: function() {
        return Spacebars.mustache(view.lookup("client_id"));
      }
    }), "\n\t\t\t\t", HTML.INPUT({
      type: "hidden",
      name: "redirect_uri",
      value: function() {
        return Spacebars.mustache(view.lookup("redirect_uri"));
      }
    }), HTML.Raw('\n\t\t\t\t<input type="hidden" name="response_type" value="code">\n\t\t\t\t'), HTML.DIV({
      class: "buttons-group"
    }, "\n\t\t\t\t\t", HTML.BUTTON({
      id: "logout-oauth",
      class: "rc-button rc-button--danger logout"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Logout");
    })), "\n\t\t\t\t\t", HTML.BUTTON({
      id: "cancel-oauth",
      type: "button",
      class: "rc-button rc-button--cancel"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Cancel");
    })), "\n\t\t\t\t\t", HTML.BUTTON({
      type: "submit",
      class: "rc-button rc-button--primary save"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Authorize");
    })), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.templateInstance().subscriptionsReady());
    }, function() {
      return [ "\n\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "loading");
      }), "...\n\t\t\t" ];
    }), "\n\t\t"), "\n\t" ];
  }, function() {
    return [ "\n\t\t", Spacebars.include(view.lookupTemplate("loginButtons")), "\n\t" ];
  });
}));

Template.__checkName("oauth404");
Template["oauth404"] = new Template("Template.oauth404", (function() {
  var view = this;
  return HTML.DIV({
    class: "oauth-panel"
  }, "\n\t\t\t", HTML.FORM("\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.dataMustache(view.lookup("$eq"), view.lookup("error"), "404");
  }, function() {
    return HTML.Raw("\n\t\t\t\t\t<h2>Invalid OAuth client</h2>\n\t\t\t\t");
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.dataMustache(view.lookup("$eq"), view.lookup("error"), "invalid_redirect_uri");
  }, function() {
    return HTML.Raw("\n\t\t\t\t\t<h2>Redirect URL does not match</h2>\n\t\t\t\t");
  }), "\n\t\t\t"), "\n\t\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"stylesheets":{"oauth2.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/oauth/stylesheets/oauth2.css                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"oauth2-client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/oauth/oauth2-client.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 2);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 3);
var APIClient;
module.link("../../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 4);
Template.authorize.onCreated(function () {
  function _callee() {
    var _await$APIClient$v1$g, oauthApp;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              this.oauthApp = new ReactiveVar({});
              _context.next = 3;
              return _regeneratorRuntime.awrap(APIClient.v1.get("oauth-apps.get?clientId=" + this.data.client_id()));

            case 3:
              _await$APIClient$v1$g = _context.sent;
              oauthApp = _await$APIClient$v1$g.oauthApp;
              this.oauthApp.set(oauthApp);

            case 6:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, this, null, Promise);
  }

  return _callee;
}());
Template.authorize.helpers({
  getToken: function () {
    return Meteor._localStorage.getItem(Accounts.LOGIN_TOKEN_KEY);
  },
  getClient: function () {
    return Template.instance().oauthApp.get();
  }
});
Template.authorize.events({
  'click #logout-oauth': function () {
    return Meteor.logout();
  },
  'click #cancel-oauth': function () {
    return window.close();
  }
});
Template.authorize.onRendered(function () {
  var user = Meteor.user();

  if (user && user.oauth && user.oauth.authorizedClients && user.oauth.authorizedClients.includes(this.data.client_id())) {
    $('button[type=submit]').click();
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"admin":{"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/admin/startup.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var hasAllPermission;
module.link("../../../authorization", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  }
}, 0);
var registerAdminSidebarItem;
module.link("../../../../client/views/admin", {
  registerAdminSidebarItem: function (v) {
    registerAdminSidebarItem = v;
  }
}, 1);
registerAdminSidebarItem({
  href: 'admin-oauth-apps',
  i18nLabel: 'OAuth Apps',
  icon: 'discover',
  permissionGranted: function () {
    return hasAllPermission('manage-oauth-apps');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oauth2-server-config/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./oauth/oauth2-client.html");
module.link("./oauth/oauth2-client");
module.link("./admin/startup");
module.link("./oauth/stylesheets/oauth2.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"search":{"client":{"provider":{"result.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/provider/result.html                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.result.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.result.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/provider/template.result.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("DefaultSearchResultTemplate");
Template["DefaultSearchResultTemplate"] = new Template("Template.DefaultSearchResultTemplate", (function() {
  var view = this;
  return [ HTML.DIV({
    class: "rocket-default-search-settings"
  }, "\n\t\t", HTML.DIV("\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("globalSearchEnabled"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.LABEL(HTML.Raw('\n\t\t\t\t\t<input type="checkbox" id="global-search">'), Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Global_Search");
    }), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t"), "\n\t", HTML.DIV({
    class: "rocket-default-search-results"
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("result"));
  }, function() {
    return [ "\n\t\t\t", Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("$and"), Spacebars.dot(view.lookup("result"), "message"), Spacebars.dot(view.lookup("result"), "message", "docs"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: "flex-tab__result js-list"
      }, "\n\t\t\t\t\t", HTML.UL({
        class: "list clearfix"
      }, "\n\t\t\t\t\t\t", Spacebars.With(function() {
        return Spacebars.call(view.lookup("messageContext"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(Spacebars.dot(view.lookup("result"), "message", "docs")),
            _variable: "msg"
          };
        }, function() {
          return Blaze._TemplateWith(function() {
            return {
              msg: Spacebars.call(Spacebars.dataMustache(view.lookup("messageParse"), view.lookup("msg"))),
              groupable: Spacebars.call(true),
              room: Spacebars.call(view.lookup("room")),
              subscription: Spacebars.call(view.lookup("subscription")),
              settings: Spacebars.call(view.lookup("settings")),
              u: Spacebars.call(view.lookup("u"))
            };
          }, function() {
            return Spacebars.include(view.lookupTemplate("message"));
          });
        }), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "No_results_found");
      })), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t\t\t", HTML.DIV({
    class: "load-more"
  }, "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("searching"));
  }, function() {
    return [ "\n\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t" ];
  }), "\n\t\t\t"), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"suggestion.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/provider/suggestion.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.suggestion.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.suggestion.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/provider/template.suggestion.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("DefaultSuggestionItemTemplate");
Template["DefaultSuggestionItemTemplate"] = new Template("Template.DefaultSuggestionItemTemplate", (function() {
  var view = this;
  return HTML.DIV({
    class: "default-suggestion"
  }, "\n\t\t", Blaze.View("lookup:text", function() {
    return Spacebars.mustache(view.lookup("text"));
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"result.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/provider/result.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 3);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 4);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 5);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 6);
var messageContext;
module.link("../../../ui-utils/client/lib/messageContext", {
  messageContext: function (v) {
    messageContext = v;
  }
}, 7);
var MessageAction, RoomHistoryManager;
module.link("../../../ui-utils", {
  MessageAction: function (v) {
    MessageAction = v;
  },
  RoomHistoryManager: function (v) {
    RoomHistoryManager = v;
  }
}, 8);
var messageArgs;
module.link("../../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 9);
var Rooms;
module.link("../../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 10);
var getCommonRoomEvents;
module.link("../../../ui/client/views/app/lib/getCommonRoomEvents", {
  getCommonRoomEvents: function (v) {
    getCommonRoomEvents = v;
  }
}, 11);
var goToRoomById;
module.link("../../../../client/lib/utils/goToRoomById", {
  goToRoomById: function (v) {
    goToRoomById = v;
  }
}, 12);
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'jump-to-search-message',
    icon: 'jump',
    label: 'Jump_to_message',
    context: ['search'],
    action: function () {
      var _messageArgs = messageArgs(this),
          message = _messageArgs.msg;

      if (message.tmid) {
        return FlowRouter.go(FlowRouter.getRouteName(), {
          tab: 'thread',
          context: message.tmid,
          rid: message.rid,
          name: Rooms.findOne({
            _id: message.rid
          }).name
        }, {
          jump: message._id
        });
      }

      if (Session.get('openedRoom') === message.rid) {
        return RoomHistoryManager.getSurroundingMessages(message, 50);
      }

      goToRoomById(message.rid); // RocketChat.MessageAction.hideDropDown();

      if (window.matchMedia('(max-width: 500px)').matches) {
        Template.instance().tabBar.close();
      }

      window.setTimeout(function () {
        RoomHistoryManager.getSurroundingMessages(message, 50);
      }, 400); // 400ms is popular among game devs as a good delay before transition starts
      // ie. 50, 100, 200, 400, 800 are the favored timings
    },
    order: 100,
    group: 'menu'
  });
});
Template.DefaultSearchResultTemplate.onRendered(function () {
  var _this = this;

  var list = this.firstNode.parentNode.querySelector('.rocket-default-search-results');
  this.autorun(function () {
    var result = _this.data.result.get();

    if (result && _this.hasMore.get()) {
      Tracker.afterFlush(function () {
        if (list.scrollHeight < list.offsetHeight) {
          _this.data.payload.limit = (_this.data.payload.limit || _this.pageSize) + _this.pageSize;

          _this.data.search();
        }
      });
    }
  });
});
Template.DefaultSearchResultTemplate.onCreated(function () {
  var _this2 = this;

  // paging
  this.pageSize = this.data.settings.PageSize; // global search

  this.globalSearchEnabled = this.data.settings.GlobalSearchEnabled;
  this.data.parentPayload.searchAll = this.globalSearchEnabled;
  this.hasMore = new ReactiveVar(true);
  this.autorun(function () {
    var result = _this2.data.result.get();

    _this2.hasMore.set(!(result && result.message.docs.length < (_this2.data.payload.limit || _this2.pageSize)));
  });
});
Template.DefaultSearchResultTemplate.events(_objectSpread(_objectSpread({}, getCommonRoomEvents()), {}, {
  'change #global-search': function (e, t) {
    t.data.parentPayload.searchAll = e.target.checked;
    t.data.payload.limit = t.pageSize;
    t.data.result.set(undefined);
    t.data.search();
  },
  'scroll .rocket-default-search-results': _.throttle(function (e, t) {
    if (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight && t.hasMore.get()) {
      t.data.payload.limit = (t.data.payload.limit || t.pageSize) + t.pageSize;
      t.data.search();
    }
  }, 200)
}));
Template.DefaultSearchResultTemplate.helpers({
  result: function () {
    return Template.instance().data.result.get();
  },
  globalSearchEnabled: function () {
    return Template.instance().globalSearchEnabled;
  },
  searching: function () {
    return Template.instance().data.searching.get();
  },
  hasMore: function () {
    return Template.instance().hasMore.get();
  },
  messageParse: function (msg) {
    var text = Template.instance().data.text.get();
    msg.searchedText = text;
    return _objectSpread(_objectSpread({
      customClass: 'search',
      actionContext: 'search'
    }, msg), {}, {
      groupable: false
    });
  },
  messageContext: function () {
    var result = messageContext.call(this, {
      rid: Session.get('openedRoom')
    });
    return _objectSpread(_objectSpread({}, result), {}, {
      settings: _objectSpread(_objectSpread({}, result.settings), {}, {
        showReplyButton: false,
        showreply: false
      })
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"search":{"search.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/search/search.html                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.search.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.search.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/search/template.search.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("RocketSearch");
Template["RocketSearch"] = new Template("Template.RocketSearch", (function() {
  var view = this;
  return Blaze.Unless(function() {
    return Spacebars.call(view.lookup("isActive"));
  }, function() {
    return [ "\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("error"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "rocket-search-error"
      }, "\n\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), view.lookup("error"));
      }), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  }, function() {
    return [ "\n\t", HTML.DIV({
      class: function() {
        return [ "rocket-search-tab list-view ", Spacebars.mustache(Spacebars.dot(view.lookup("provider"), "key")) ];
      }
    }, "\n\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("provider"), "description"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "title"
      }, "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
        return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup("provider"), "description")));
      })), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t\t", HTML.DIV({
      class: "control rocket-search-input"
    }, "\n\t\t\t", HTML.FORM({
      class: "search-form",
      role: "form"
    }, "\n\t\t\t\t", HTML.DIV({
      class: "rc-input"
    }, "\n\t\t\t\t\t", HTML.LABEL({
      class: "rc-input__label"
    }, "\n\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__wrapper"
    }, "\n\t\t\t\t\t\t\t", HTML.DIV({
      class: "rc-input__icon"
    }, "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call(Spacebars.dot(view.lookup("provider"), "icon"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t", HTML.INPUT({
      value: function() {
        return Spacebars.mustache(view.lookup("text"));
      },
      type: "text",
      class: "rc-input__element",
      name: "message-search",
      id: "message-search",
      placeholder: function() {
        return Spacebars.mustache(view.lookup("_"), "Search_Messages");
      },
      autocomplete: "off",
      "aria-label": function() {
        return Spacebars.mustache(view.lookup("_"), "Search_Messages");
      }
    }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("suggestions"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        id: "rocket-search-suggestions"
      }, "\n\t\t\t\t\t", Blaze.Each(function() {
        return Spacebars.call(view.lookup("suggestions"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: function() {
            return [ "rocket-search-suggestion-item ", Spacebars.mustache(view.lookup("suggestionSelected"), view.lookup("@index")) ];
          }
        }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            template: Spacebars.call(Spacebars.dot(view.lookup("provider"), "suggestionItemTemplate"))
          };
        }, function() {
          return Spacebars.include(function() {
            return Spacebars.call(Template.__dynamic);
          });
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t"), "\n\t\t\t\t" ];
    }), "\n\t\t\t"), "\n\t\t"), "\n\n\t\t", HTML.DIV({
      class: "rocket-search-result"
    }, "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        template: Spacebars.call(Spacebars.dot(view.lookup("provider"), "resultTemplate")),
        data: Spacebars.call(view.lookup("scope"))
      };
    }, function() {
      return Spacebars.include(function() {
        return Spacebars.call(Template.__dynamic);
      });
    }), "\n\t\t"), "\n\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"search.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/search/search.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 2);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 3);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 4);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 5);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 6);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 7);
Template.RocketSearch.onCreated(function () {
  var _this = this;

  this.provider = new ReactiveVar();
  this.isActive = new ReactiveVar(false);
  this.error = new ReactiveVar();
  this.suggestions = new ReactiveVar();
  this.suggestionActive = new ReactiveVar();
  Meteor.call('rocketchatSearch.getProvider', function (error, provider) {
    if (!error && provider) {
      _this.scope.settings = provider.settings;

      _this.provider.set(provider);

      _this.isActive.set(true);
    } else {
      _this.error.set('Search_current_provider_not_active');
    }
  });

  var _search = function () {
    var _p = Object.assign({}, _this.scope.parentPayload, _this.scope.payload);

    if (_this.scope.text.get()) {
      _this.scope.searching.set(true);

      Meteor.call('rocketchatSearch.search', _this.scope.text.get(), {
        rid: Session.get('openedRoom'),
        uid: Meteor.userId()
      }, _p, function (err, result) {
        if (err) {
          dispatchToastMessage({
            type: 'error',
            message: TAPi18n.__('Search_message_search_failed')
          });

          _this.scope.searching.set(false);
        } else {
          _this.scope.searching.set(false);

          _this.scope.result.set(result);
        }
      });
    }
  };

  this.scope = {
    searching: new ReactiveVar(false),
    result: new ReactiveVar(),
    text: new ReactiveVar(),
    settings: {},
    parentPayload: {},
    payload: {},
    search: _search
  };

  this.search = function (value) {
    _this.scope.result.set(undefined);

    _this.scope.payload = {};

    _this.scope.text.set(value);

    _search();
  };

  this.suggest = function (value) {
    _this.suggestions.set();

    var _p = Object.assign({}, _this.scope.parentPayload, _this.scope.payload);

    Meteor.call('rocketchatSearch.suggest', value, {
      rid: Session.get('openedRoom'),
      uid: Meteor.userId()
    }, _this.scope.parentPayload, _p, function (err, result) {
      if (err) {// TODO what should happen
      } else {
        _this.suggestionActive.set(undefined);

        if (value !== _this.scope.text.get()) {
          _this.suggestions.set(result);
        }
      }
    });
  };
});
Template.RocketSearch.events = {
  'keydown #message-search': function (evt, t) {
    if (evt.keyCode === 13) {
      if (t.suggestionActive.get() !== undefined) {
        var suggestion = t.suggestions.get()[t.suggestionActive.get()];

        if (suggestion.action) {
          var value = suggestion.action();

          if (value) {
            t.search(value);
          }
        } else {
          t.search(suggestion.text);
        }
      } else {
        t.search(evt.target.value.trim());
      }

      t.suggestions.set();
      return evt.preventDefault();
    }

    var suggestions = t.suggestions.get();
    var suggestionActive = t.suggestionActive.get();

    if (evt.keyCode === 40 && suggestions) {
      t.suggestionActive.set(suggestionActive !== undefined && suggestionActive < suggestions.length - 1 ? suggestionActive + 1 : 0);
      return;
    }

    if (evt.keyCode === 38 && suggestions) {
      t.suggestionActive.set(suggestionActive !== undefined && suggestionActive === 0 ? suggestions.length - 1 : suggestionActive - 1);
    }
  },
  'keyup #message-search': _.debounce(function (evt, t) {
    if (evt.keyCode === 13) {
      return evt.preventDefault();
    }

    var value = evt.target.value;

    if (evt.keyCode === 40 || evt.keyCode === 38) {
      return evt.preventDefault();
    }

    if (!t.provider.get().supportsSuggestions) {
      t.search(value);
    } else {
      t.suggest(value);
    }
  }, 300),
  'click .rocket-search-suggestion-item': function (e, t) {
    if (this.action) {
      var value = this.action();

      if (value) {
        t.search(value);
      } else {
        t.suggestions.set();
      }
    } else {
      t.search(this.text);
    }
  },
  'mouseenter .rocket-search-suggestion-item': function (e, t) {
    t.suggestionActive.set(t.suggestions.get().indexOf(this));
  }
};
Template.RocketSearch.helpers({
  error: function () {
    return Template.instance().error.get();
  },
  provider: function () {
    return Template.instance().provider.get();
  },
  scope: function () {
    return Template.instance().scope;
  },
  text: function () {
    return Template.instance().scope.text.get();
  },
  isActive: function () {
    return Template.instance().isActive.get();
  },
  suggestions: function () {
    return Template.instance().suggestions.get();
  },
  suggestionActive: function () {
    return Template.instance().suggestionActive.get();
  },
  suggestionSelected: function (index) {
    return Template.instance().suggestionActive.get() === index ? 'active' : '';
  }
}); // add closer to suggestions

Template.RocketSearch.onRendered(function () {
  var _this2 = this;

  $(document).on("click.suggestionclose." + this.data.rid, function () {
    // if (e.target.id !== 'rocket-search-suggestions' && !$(e.target).parents('#rocket-search-suggestions').length) {
    _this2.suggestions.set(); // }

  });
  Tracker.autorun(function (c) {
    if (_this2.isActive.get() === true) {
      Tracker.afterFlush(function () {
        document.querySelector('#message-search').focus();
      });
      c.stop();
    }
  });
});
Template.RocketSearch.onDestroyed(function () {
  $(document).off("click.suggestionclose." + this.data.rid);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"style":{"style.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/style/style.css                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/search/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./search/search.html");
module.link("./search/search");
module.link("./provider/suggestion.html");
module.link("./provider/result.html");
module.link("./provider/result");
module.link("./style/style.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"threads":{"client":{"flextab":{"messageBoxFollow.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/messageBoxFollow.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBoxFollow.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBoxFollow.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/template.messageBoxFollow.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBoxFollow");
Template["messageBoxFollow"] = new Template("Template.messageBoxFollow", (function() {
  var view = this;
  return HTML.BUTTON({
    class: "js-follow rc-button rc-button--primary rc-message-box__join-button"
  }, "\n\t\t", Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Follow");
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"thread.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/thread.html                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.thread.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.thread.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/template.thread.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("thread");
Template["thread"] = new Template("Template.thread", (function() {
  var view = this;
  return HTML.SECTION({
    class: function() {
      return [ "contextual-bar__content flex-tab threads dropzone ", Spacebars.mustache(view.lookup("dragAndDrop")), " ", Spacebars.mustache(view.lookup("hideUsername")) ];
    }
  }, "\n\t\t", HTML.DIV({
    class: function() {
      return [ "dropzone-overlay ", Spacebars.mustache(view.lookup("isDropzoneDisabled")), " background-transparent-darkest color-content-background-color" ];
    }
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), view.lookup("dragAndDropLabel"));
  })), "\n\t\t", HTML.DIV({
    class: "thread-list js-scroll-thread"
  }, "\n\t\t\t", HTML.UL({
    class: "thread"
  }, "\n\t\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("messageContext"));
  }, function() {
    return [ "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isLoading"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.LI({
        class: "load-more"
      }, "\n\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          groupable: Spacebars.call(false),
          hideRoles: Spacebars.call(true),
          msg: Spacebars.call(view.lookup("mainMessage")),
          room: Spacebars.call(view.lookup("room")),
          subscription: Spacebars.call(view.lookup("subscription")),
          settings: Spacebars.call(view.lookup("settings")),
          customClass: Spacebars.call("thread-main"),
          templatePrefix: Spacebars.call("thread-"),
          u: Spacebars.call(view.lookup("u")),
          ignored: Spacebars.call(false),
          shouldCollapseReplies: Spacebars.call(true)
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("message"));
      }), "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.call(view.lookup("messages")),
          _variable: "msg"
        };
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            hideRoles: Spacebars.call(true),
            msg: Spacebars.call(view.lookup("msg")),
            room: Spacebars.call(view.lookup("room")),
            shouldCollapseReplies: Spacebars.call(true),
            subscription: Spacebars.call(view.lookup("subscription")),
            settings: Spacebars.call(view.lookup("settings")),
            templatePrefix: Spacebars.call("thread-"),
            u: Spacebars.call(view.lookup("u")),
            context: Spacebars.call("threads")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("message"));
        }), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t" ];
  }), "\n\t\t\t"), "\n\t\t"), "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("messageBoxData"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messageBox"));
  }), "\n\t\t", HTML.FOOTER({
    class: "thread-footer"
  }, "\n\t\t\t", Spacebars.With(function() {
    return Spacebars.call(view.lookup("checkboxData"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      style: "display: flex;"
    }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("."));
    }, function() {
      return Spacebars.include(view.lookupTemplate("Checkbox"));
    }), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t\t", HTML.LABEL({
    for: "sendAlso",
    class: "thread-footer__text"
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Also_send_to_channel");
  })), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxFollow.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/messageBoxFollow.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 1);
module.link("./messageBoxFollow.html");
Template.messageBoxFollow.events({
  'click .js-follow': function () {
    var tmid = this.tmid;
    callWithErrorHandling('followMessage', {
      mid: tmid
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"thread.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/thread.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["context", "tab"],
    _excluded2 = ["_id"],
    _excluded3 = ["_id"];

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 2);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 2);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 3);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 4);
var ReactiveDict;
module.link("meteor/reactive-dict", {
  ReactiveDict: function (v) {
    ReactiveDict = v;
  }
}, 5);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 6);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 7);
var chatMessages, ChatMessages;
module.link("../../../ui", {
  chatMessages: function (v) {
    chatMessages = v;
  },
  ChatMessages: function (v) {
    ChatMessages = v;
  }
}, 8);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 9);
var messageContext;
module.link("../../../ui-utils/client/lib/messageContext", {
  messageContext: function (v) {
    messageContext = v;
  }
}, 10);
var upsertMessageBulk;
module.link("../../../ui-utils/client/lib/RoomHistoryManager", {
  upsertMessageBulk: function (v) {
    upsertMessageBulk = v;
  }
}, 11);
var Messages;
module.link("../../../models", {
  Messages: function (v) {
    Messages = v;
  }
}, 12);
var fileUpload;
module.link("../../../ui/client/lib/fileUpload", {
  fileUpload: function (v) {
    fileUpload = v;
  }
}, 13);
var dropzoneEvents, dropzoneHelpers;
module.link("../../../ui/client/views/app/room", {
  dropzoneEvents: function (v) {
    dropzoneEvents = v;
  },
  dropzoneHelpers: function (v) {
    dropzoneHelpers = v;
  }
}, 14);
module.link("./thread.html");
var getUserPreference;
module.link("../../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 15);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 16);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 17);
module.link("./messageBoxFollow");
var getCommonRoomEvents;
module.link("../../../ui/client/views/app/lib/getCommonRoomEvents", {
  getCommonRoomEvents: function (v) {
    getCommonRoomEvents = v;
  }
}, 18);
var keyCodes;
module.link("../../../../client/lib/utils/keyCodes", {
  keyCodes: function (v) {
    keyCodes = v;
  }
}, 19);
var sort = {
  ts: 1
};
Template.thread.events(_objectSpread(_objectSpread(_objectSpread({}, dropzoneEvents), getCommonRoomEvents()), {}, {
  'click .js-close': function (e) {
    e.preventDefault();
    e.stopPropagation();
    var close = this.close;
    return close && close();
  },
  'scroll .js-scroll-thread': _.throttle(function (_ref, i) {
    var e = _ref.currentTarget;
    i.atBottom = e.scrollTop >= e.scrollHeight - e.clientHeight;
  }, 150),
  'click .toggle-hidden': function (e) {
    var id = e.currentTarget.dataset.message;
    document.querySelector("#thread-" + id).classList.toggle('message--ignored');
  }
}));
Template.thread.helpers(_objectSpread(_objectSpread({}, dropzoneHelpers), {}, {
  mainMessage: function () {
    var _Template$instance = Template.instance(),
        Threads = _Template$instance.Threads,
        state = _Template$instance.state;

    var tmid = state.get('tmid');
    return Threads.findOne({
      _id: tmid
    });
  },
  isLoading: function () {
    return Template.instance().state.get('loading') !== false;
  },
  messages: function () {
    var _Template$instance2 = Template.instance(),
        Threads = _Template$instance2.Threads,
        state = _Template$instance2.state;

    var tmid = state.get('tmid');
    return Threads.find({
      tmid: tmid,
      _id: {
        $ne: tmid
      }
    }, {
      sort: sort
    });
  },
  messageContext: function () {
    var result = messageContext.call(this, {
      rid: this.mainMessage.rid
    });
    return _objectSpread(_objectSpread({}, result), {}, {
      settings: _objectSpread(_objectSpread({}, result.settings), {}, {
        showReplyButton: false,
        showreply: false
      })
    });
  },
  messageBoxData: function () {
    var instance = Template.instance();

    var _Template$currentData = Template.currentData(),
        _Template$currentData2 = _Template$currentData.mainMessage,
        rid = _Template$currentData2.rid,
        tmid = _Template$currentData2._id,
        subscription = _Template$currentData.subscription;

    var showFormattingTips = settings.get('Message_ShowFormattingTips');
    return {
      showFormattingTips: showFormattingTips,
      tshow: instance.state.get('sendToChannel'),
      subscription: subscription,
      rid: rid,
      tmid: tmid,
      onSend: function () {
        instance.sendToBottom();
        instance.state.set('sendToChannel', false);

        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        return instance.chatMessages && instance.chatMessages.send.apply(instance.chatMessages, args);
      },
      onKeyUp: function () {
        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
          args[_key2] = arguments[_key2];
        }

        return instance.chatMessages && instance.chatMessages.keyup.apply(instance.chatMessages, args);
      },
      onKeyDown: function () {
        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
          args[_key3] = arguments[_key3];
        }

        var result = instance.chatMessages && instance.chatMessages.keydown.apply(instance.chatMessages, args);
        var event = args[0];
        var keyCode = event.which;

        if (keyCode === keyCodes.ESCAPE && !result && !event.target.value.trim()) {
          var _FlowRouter$current = FlowRouter.current(),
              name = _FlowRouter$current.route.name,
              _FlowRouter$current$p = _FlowRouter$current.params,
              context = _FlowRouter$current$p.context,
              tab = _FlowRouter$current$p.tab,
              params = _objectWithoutProperties(_FlowRouter$current$p, _excluded);

          FlowRouter.go(name, params);
        }
      }
    };
  },
  hideUsername: function () {
    return getUserPreference(Meteor.userId(), 'hideUsernames') ? 'hide-usernames' : undefined;
  },
  checkboxData: function () {
    var instance = Template.instance();
    var checked = instance.state.get('sendToChannel');
    return {
      id: 'sendAlso',
      checked: checked,
      onChange: function () {
        return instance.state.set('sendToChannel', !checked);
      }
    };
  }
}));
Template.thread.onRendered(function () {
  var _this = this;

  var rid = Tracker.nonreactive(function () {
    return _this.state.get('rid');
  });
  var tmid = Tracker.nonreactive(function () {
    return _this.state.get('tmid');
  });
  this.atBottom = true;
  this.chatMessages = new ChatMessages(this.Threads);
  this.chatMessages.initializeWrapper(this.find('.js-scroll-thread'));
  this.chatMessages.initializeInput(this.find('.js-input-message'), {
    rid: rid,
    tmid: tmid
  });
  this.sendToBottom = _.throttle(function () {
    _this.atBottom = true;
    _this.chatMessages.wrapper.scrollTop = _this.chatMessages.wrapper.scrollHeight;
  }, 300);

  this.sendToBottomIfNecessary = function () {
    _this.atBottom && _this.sendToBottom();
  };

  var observer = new ResizeObserver(this.sendToBottomIfNecessary);
  observer.observe(this.firstNode.querySelector('.js-scroll-thread ul'));

  this.onFile = function (filesToUpload) {
    fileUpload(filesToUpload, _this.chatMessages.input, {
      rid: _this.state.get('rid'),
      tmid: _this.state.get('tmid')
    });
  };

  this.autorun(function () {
    var rid = _this.state.get('rid');

    var tmid = _this.state.get('tmid');

    if (!rid) {
      return;
    }

    _this.callbackRemove && _this.callbackRemove();

    _this.callbackRemove = function () {
      return callbacks.remove('streamNewMessage', "thread-" + rid);
    };

    callbacks.add('streamNewMessage', _.debounce(function (msg) {
      if (Session.get('openedRoom') !== msg.rid || rid !== msg.rid || msg.editedAt || msg.tmid !== tmid) {
        return;
      }

      Meteor.call('readThreads', tmid);
    }, 1000), callbacks.priority.MEDIUM, "thread-" + rid);
  });
  this.autorun(function () {
    var tmid = _this.state.get('tmid');

    _this.threadsObserve && _this.threadsObserve.stop();
    _this.threadsObserve = Messages.find({
      $or: [{
        tmid: tmid
      }, {
        _id: tmid
      }],
      _hidden: {
        $ne: true
      }
    }, {
      fields: {
        collapsed: 0,
        threadMsg: 0,
        repliesCount: 0
      }
    }).observe({
      added: function (_ref2) {
        var _id = _ref2._id,
            message = _objectWithoutProperties(_ref2, _excluded2);

        _this.Threads.upsert({
          _id: _id
        }, message);
      },
      changed: function (_ref3) {
        var _id = _ref3._id,
            message = _objectWithoutProperties(_ref3, _excluded3);

        _this.Threads.update({
          _id: _id
        }, message);
      },
      removed: function (_ref4) {
        var _id = _ref4._id;
        return _this.Threads.remove(_id);
      }
    });

    _this.loadMore();
  });
  this.autorun(function () {
    var rid = _this.state.get('rid');

    var tmid = _this.state.get('tmid');

    _this.chatMessages.initializeInput(_this.find('.js-input-message'), {
      rid: rid,
      tmid: tmid
    });

    if (rid && tmid) {
      chatMessages[rid + "-" + tmid] = _this.chatMessages;
    }
  });
  this.autorun(function () {
    FlowRouter.watchPathChange();
    var jump = FlowRouter.getQueryParam('jump');

    var _Template$currentData3 = Template.currentData(),
        mainMessage = _Template$currentData3.mainMessage;

    _this.state.set({
      tmid: mainMessage._id,
      rid: mainMessage.rid,
      jump: jump
    });
  });
  this.autorun(function () {
    var jump = _this.state.get('jump');

    var loading = _this.state.get('loading');

    if (jump && _this.lastJump !== jump && loading === false) {
      _this.lastJump = jump;
      _this.find('.js-scroll-thread').style.scrollBehavior = 'smooth';

      _this.state.set('jump', null);

      Tracker.afterFlush(function () {
        var message = _this.find("#thread-" + jump);

        message.classList.add('highlight');

        var removeClass = function () {
          message.classList.remove('highlight');
          message.removeEventListener('animationend', removeClass);
        };

        message.addEventListener('animationend', removeClass);
        setTimeout(function () {
          message.scrollIntoView();
        }, 300);
      });
    }
  });
});
Template.thread.onCreated(function () {
  function _callee2() {
    var _this2 = this;

    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              this.Threads = new Mongo.Collection(null);
              this.state = new ReactiveDict({
                sendToChannel: !this.data.mainMessage.tcount
              });

              this.loadMore = function () {
                function _callee() {
                  var _Tracker$nonreactive, tmid, messages;

                  return _regeneratorRuntime.async(function () {
                    function _callee$(_context) {
                      while (1) {
                        switch (_context.prev = _context.next) {
                          case 0:
                            _Tracker$nonreactive = Tracker.nonreactive(function () {
                              return _this2.state.all();
                            }), tmid = _Tracker$nonreactive.tmid;

                            if (tmid) {
                              _context.next = 3;
                              break;
                            }

                            return _context.abrupt("return");

                          case 3:
                            _this2.state.set('loading', true);

                            _context.next = 6;
                            return _regeneratorRuntime.awrap(callWithErrorHandling('getThreadMessages', {
                              tmid: tmid
                            }));

                          case 6:
                            messages = _context.sent;
                            upsertMessageBulk({
                              msgs: messages
                            }, _this2.Threads);
                            Tracker.afterFlush(function () {
                              _this2.state.set('loading', false);
                            });

                          case 9:
                          case "end":
                            return _context.stop();
                        }
                      }
                    }

                    return _callee$;
                  }(), null, null, null, Promise);
                }

                return _callee;
              }();

            case 3:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, this, null, Promise);
  }

  return _callee2;
}());
Template.thread.onDestroyed(function () {
  var Threads = this.Threads,
      threadsObserve = this.threadsObserve,
      callbackRemove = this.callbackRemove,
      state = this.state,
      chatMessages = this.chatMessages;
  Threads.remove({});
  threadsObserve && threadsObserve.stop();
  callbackRemove && callbackRemove();
  var tmid = state.get('tmid');
  var rid = state.get('rid');

  if (rid && tmid) {
    chatMessages.onDestroyed && chatMessages.onDestroyed(rid, tmid);
    delete chatMessages[rid + "-" + tmid];
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"threadlist.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/threadlist.tsx                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var React, useMemo, lazy;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useMemo: function (v) {
    useMemo = v;
  },
  lazy: function (v) {
    lazy = v;
  }
}, 0);
var addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
var useSetting;
module.link("../../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 2);
var Header;
module.link("../../../../client/components/Header", {
  "default": function (v) {
    Header = v;
  }
}, 3);

var getVariant = function (tunreadUser, tunreadGroup) {
  if (tunreadUser > 0) {
    return 'danger';
  }

  if (tunreadGroup > 0) {
    return 'warning';
  }

  return 'primary';
};

var template = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../../../../client/views/room/contextualBar/Threads');
});
addAction('thread', function (options) {
  var _room$tunread2, _room$tunreadUser2, _room$tunreadGroup2;

  var room = options.room;
  var threadsEnabled = useSetting('Threads_enabled');
  return useMemo(function () {
    return threadsEnabled ? {
      groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
      id: 'thread',
      full: true,
      title: 'Threads',
      icon: 'thread',
      template: template,
      renderAction: function (props) {
        var _room$tunread, _room$tunreadUser, _room$tunreadGroup;

        var tunread = ((_room$tunread = room.tunread) === null || _room$tunread === void 0 ? void 0 : _room$tunread.length) || 0;
        var tunreadUser = ((_room$tunreadUser = room.tunreadUser) === null || _room$tunreadUser === void 0 ? void 0 : _room$tunreadUser.length) || 0;
        var tunreadGroup = ((_room$tunreadGroup = room.tunreadGroup) === null || _room$tunreadGroup === void 0 ? void 0 : _room$tunreadGroup.length) || 0;
        var unread = tunread > 99 ? '99+' : tunread;
        var variant = getVariant(tunreadUser, tunreadGroup);
        return /*#__PURE__*/React.createElement(Header.ToolBoxAction, props, unread > 0 && /*#__PURE__*/React.createElement(Header.Badge, {
          variant: variant
        }, unread));
      },
      order: 2
    } : null;
  }, [threadsEnabled, (_room$tunread2 = room.tunread) === null || _room$tunread2 === void 0 ? void 0 : _room$tunread2.length, (_room$tunreadUser2 = room.tunreadUser) === null || _room$tunreadUser2 === void 0 ? void 0 : _room$tunreadUser2.length, (_room$tunreadGroup2 = room.tunreadGroup) === null || _room$tunreadGroup2 === void 0 ? void 0 : _room$tunreadGroup2.length]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"threads.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/flextab/threads.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../threads.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"normalizeThreadTitle.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/lib/normalizeThreadTitle.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 1);
module.export({
  normalizeThreadTitle: function () {
    return normalizeThreadTitle;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 1);
var filterMarkdown;
module.link("../../../markdown/lib/markdown", {
  filterMarkdown: function (v) {
    filterMarkdown = v;
  }
}, 2);
var Users;
module.link("../../../models/client", {
  Users: function (v) {
    Users = v;
  }
}, 3);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var MentionsParser;
module.link("../../../mentions/lib/MentionsParser", {
  MentionsParser: function (v) {
    MentionsParser = v;
  }
}, 5);
var emojiParser;
module.link("../../../emoji/client/emojiParser.js", {
  emojiParser: function (v) {
    emojiParser = v;
  }
}, 6);

var normalizeThreadTitle = function (_ref) {
  var message = _extends({}, _ref);

  if (message.msg) {
    var filteredMessage = filterMarkdown(escapeHTML(message.msg));

    if (!message.channels && !message.mentions) {
      return filteredMessage;
    }

    var uid = Meteor.userId();
    var me = uid && (Users.findOne(uid, {
      fields: {
        username: 1
      }
    }) || {}).username;
    var pattern = settings.get('UTF8_User_Names_Validation');
    var useRealName = settings.get('UI_Use_Real_Name');
    var instance = new MentionsParser({
      pattern: function () {
        return pattern;
      },
      useRealName: function () {
        return useRealName;
      },
      me: function () {
        return me;
      },
      userTemplate: function (_ref2) {
        var label = _ref2.label;
        return "<strong> " + label + " </strong>";
      },
      roomTemplate: function (_ref3) {
        var prefix = _ref3.prefix,
            mention = _ref3.mention;
        return prefix + "<strong> " + mention + " </strong>";
      }
    });

    var _emojiParser = emojiParser({
      html: filteredMessage
    }),
        html = _emojiParser.html;

    return instance.parse(_objectSpread(_objectSpread({}, message), {}, {
      msg: filteredMessage,
      html: html
    })).html;
  }

  if (message.attachments) {
    var attachment = message.attachments.find(function (attachment) {
      return attachment.title || attachment.description;
    });

    if (attachment && attachment.description) {
      return escapeHTML(attachment.description);
    }

    if (attachment && attachment.title) {
      return escapeHTML(attachment.title);
    }
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"messageAction":{"follow.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/messageAction/follow.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 2);
var Messages;
module.link("../../../models/client", {
  Messages: function (v) {
    Messages = v;
  }
}, 3);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var MessageAction;
module.link("../../../ui-utils/client", {
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 5);
var messageArgs;
module.link("../../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 6);
var roomTypes;
module.link("../../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 7);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 8);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 9);
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (!settings.get('Threads_enabled')) {
      return MessageAction.removeButton('follow-message');
    }

    MessageAction.addButton({
      id: 'follow-message',
      icon: 'bell',
      label: 'Follow_message',
      context: ['message', 'message-mobile', 'threads'],
      action: function () {
        function _callee() {
          var _messageArgs, msg;

          return _regeneratorRuntime.async(function () {
            function _callee$(_context) {
              while (1) {
                switch (_context.prev = _context.next) {
                  case 0:
                    _messageArgs = messageArgs(this), msg = _messageArgs.msg;
                    callWithErrorHandling('followMessage', {
                      mid: msg._id
                    }).then(function () {
                      return dispatchToastMessage({
                        type: 'success',
                        message: TAPi18n.__('You_followed_this_message')
                      });
                    });

                  case 2:
                  case "end":
                    return _context.stop();
                }
              }
            }

            return _callee$;
          }(), null, this, null, Promise);
        }

        return _callee;
      }(),
      condition: function (_ref, context) {
        var _ref$msg = _ref.msg,
            _id = _ref$msg._id,
            tmid = _ref$msg.tmid,
            _ref$msg$replies = _ref$msg.replies,
            replies = _ref$msg$replies === void 0 ? [] : _ref$msg$replies,
            u = _ref.u,
            room = _ref.room;

        if (tmid || context) {
          var parentMessage = Messages.findOne({
            _id: tmid || _id
          }, {
            fields: {
              replies: 1
            }
          });

          if (parentMessage) {
            replies = parentMessage.replies || [];
          }
        }

        var isLivechatRoom = roomTypes.isLivechatRoom(room.t);

        if (isLivechatRoom) {
          return false;
        }

        return !replies.includes(u._id);
      },
      order: 2,
      group: 'menu'
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"replyInThread.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/messageAction/replyInThread.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 2);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var MessageAction;
module.link("../../../ui-utils/client", {
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 4);
var messageArgs;
module.link("../../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 5);
var roomTypes;
module.link("../../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 6);
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (!settings.get('Threads_enabled')) {
      return MessageAction.removeButton('reply-in-thread');
    }

    MessageAction.addButton({
      id: 'reply-in-thread',
      icon: 'thread',
      label: 'Reply_in_thread',
      context: ['message', 'message-mobile'],
      action: function (e) {
        var _messageArgs = messageArgs(this),
            message = _messageArgs.msg;

        e.stopPropagation();
        FlowRouter.setParams({
          tab: 'thread',
          context: message.tmid || message._id
        });
      },
      condition: function (_ref) {
        var subscription = _ref.subscription,
            room = _ref.room;
        var isLivechatRoom = roomTypes.isLivechatRoom(room.t);

        if (isLivechatRoom) {
          return false;
        }

        return Boolean(subscription);
      },
      order: -1,
      group: ['message', 'menu']
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"unfollow.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/messageAction/unfollow.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 2);
var Messages;
module.link("../../../models/client", {
  Messages: function (v) {
    Messages = v;
  }
}, 3);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var MessageAction;
module.link("../../../ui-utils/client", {
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 5);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 6);
var messageArgs;
module.link("../../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 7);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 8);
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (!settings.get('Threads_enabled')) {
      return MessageAction.removeButton('unfollow-message');
    }

    MessageAction.addButton({
      id: 'unfollow-message',
      icon: 'bell-off',
      label: 'Unfollow_message',
      context: ['message', 'message-mobile', 'threads'],
      action: function () {
        function _callee() {
          var _messageArgs, msg;

          return _regeneratorRuntime.async(function () {
            function _callee$(_context) {
              while (1) {
                switch (_context.prev = _context.next) {
                  case 0:
                    _messageArgs = messageArgs(this), msg = _messageArgs.msg;
                    callWithErrorHandling('unfollowMessage', {
                      mid: msg._id
                    }).then(function () {
                      return dispatchToastMessage({
                        type: 'success',
                        message: TAPi18n.__('You_unfollowed_this_message')
                      });
                    });

                  case 2:
                  case "end":
                    return _context.stop();
                }
              }
            }

            return _callee$;
          }(), null, this, null, Promise);
        }

        return _callee;
      }(),
      condition: function (_ref, context) {
        var _ref$msg = _ref.msg,
            _id = _ref$msg._id,
            tmid = _ref$msg.tmid,
            _ref$msg$replies = _ref$msg.replies,
            replies = _ref$msg$replies === void 0 ? [] : _ref$msg$replies,
            u = _ref.u;

        if (tmid || context) {
          var parentMessage = Messages.findOne({
            _id: tmid || _id
          }, {
            fields: {
              replies: 1
            }
          });

          if (parentMessage) {
            replies = parentMessage.replies || [];
          }
        }

        return replies.includes(u._id);
      },
      order: 2,
      group: 'menu'
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/index.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./flextab/threadlist");
module.link("./flextab/thread");
module.link("./flextab/threads");
module.link("./messageAction/follow");
module.link("./messageAction/unfollow");
module.link("./messageAction/replyInThread");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"threads.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/threads/client/threads.css                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-account":{"client":{"avatar":{"avatar.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-account/client/avatar/avatar.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.avatar.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.avatar.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-account/client/avatar/template.avatar.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("avatar");
Template["avatar"] = new Template("Template.avatar", (function() {
  var view = this;
  return HTML.DIV({
    class: "avatar"
  }, "\n\t\t", Blaze._TemplateWith(function() {
    return {
      src: Spacebars.call(view.lookup("src")),
      alt: Spacebars.call(view.lookup("alt")),
      class: Spacebars.call("avatar-image"),
      placeholder: Spacebars.call(true)
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("lazyloadImage"));
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"avatar.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-account/client/avatar/avatar.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var Rooms;
module.link("../../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 2);
var getRoomAvatarURL;
module.link("../../../utils/lib/getRoomAvatarURL", {
  getRoomAvatarURL: function (v) {
    getRoomAvatarURL = v;
  }
}, 3);
var getUserAvatarURL;
module.link("../../../utils/lib/getUserAvatarURL", {
  getUserAvatarURL: function (v) {
    getUserAvatarURL = v;
  }
}, 4);

var getUsername = function (_ref) {
  var userId = _ref.userId,
      username = _ref.username;
  var query = {};

  if (username) {
    query.username = username;
  }

  if (userId) {
    query._id = userId;
  }

  var user = Meteor.users.findOne(query, {
    fields: {
      username: 1,
      avatarETag: 1
    }
  });

  if (!user) {
    return {};
  }

  return user;
};

var getRoomETag = function (rid) {
  return Rooms.findOne({
    _id: rid
  }, {
    fields: {
      avatarETag: 1
    }
  });
};

Template.avatar.helpers({
  src: function () {
    var _Template$instance$da = Template.instance().data,
        url = _Template$instance$da.url,
        rid = _Template$instance$da.rid;

    if (url) {
      return url;
    }

    if (rid) {
      var _ref2 = getRoomETag(rid) || {},
          _avatarETag = _ref2.avatarETag;

      return getRoomAvatarURL(rid, _avatarETag);
    }

    if (this.roomIcon && this.username) {
      return getUserAvatarURL("@" + this.username);
    }

    var _getUsername = getUsername(this),
        username = _getUsername.username,
        avatarETag = _getUsername.avatarETag;

    if (!username) {
      if (this.username) {
        return getUserAvatarURL(this.username);
      }

      return;
    }

    return getUserAvatarURL(username, avatarETag);
  },
  alt: function () {
    var _getUsername2 = getUsername(this),
        username = _getUsername2.username;

    return username;
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-account/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./avatar/avatar.html");
module.link("./avatar/avatar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-login":{"client":{"login":{"form.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/form.html                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.form.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.form.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/template.form.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("loginForm");
Template["loginForm"] = new Template("Template.loginForm", (function() {
  var view = this;
  return [ HTML.FORM({
    id: "login-card",
    class: "content-background-color color-primary-font-color",
    method: "/",
    novalidate: ""
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.dataMustache(view.lookup("state"), "wait-activation");
  }, function() {
    return [ "\n\t\t\t", HTML.HEADER("\n\t\t\t\t", HTML.H2({
      "data-i18n": "Registration_Succeeded"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Registration_Succeeded"));
    })), "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Wait_activation_warning");
    })), "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Please_wait_activation");
    })), "\n\t\t\t"), "\n\t\t" ];
  }, function() {
    return Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("state"), "wait-email-activation");
    }, function() {
      return [ "\n\t\t\t", HTML.HEADER("\n\t\t\t\t", HTML.H2({
        "data-i18n": "Registration_Succeeded"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Registration_Succeeded"));
      })), "\n\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "We_have_sent_registration_email");
      })), "\n\t\t\t"), "\n\t\t" ];
    }, function() {
      return [ "\n\t\t\t", Spacebars.include(view.lookupTemplate("loginServices")), "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("needsValidateEmail"));
      }, function() {
        return [ "\n\t\t\t\t", HTML.DIV({
          class: "alert error-color error-background error-border"
        }, "\n\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "You_need_confirm_email");
        }), "\n\t\t\t\t"), "\n\t\t\t" ];
      }), "\n\n\t\t\t", HTML.DIV({
        class: "fields"
      }, "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("state"), "login");
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("showFormLogin"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label",
            for: "emailOrUsername"
          }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
            name: "emailOrUsername",
            id: "emailOrUsername",
            type: "text",
            class: "rc-input__element",
            autocapitalize: "off",
            autocorrect: "off",
            placeholder: function() {
              return Spacebars.mustache(view.lookup("emailOrUsernamePlaceholder"));
            },
            autofocus: ""
          }), HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label",
            for: "pass"
          }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
            name: "pass",
            id: "pass",
            type: "password",
            class: "rc-input__element",
            autocapitalize: "off",
            autocorrect: "off",
            placeholder: function() {
              return Spacebars.mustache(view.lookup("passwordPlaceholder"));
            },
            autofocus: ""
          }), HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("state"), "register");
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-input"
        }, "\n\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-input__label",
          for: "name"
        }, "\n\t\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input__wrapper"
        }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
          name: "name",
          id: "name",
          type: "text",
          class: "rc-input__element",
          autocapitalize: "off",
          autocorrect: "off",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("namePlaceholder"));
          },
          autofocus: ""
        }), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-input"
        }, "\n\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-input__label",
          for: "email"
        }, "\n\t\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input__wrapper"
        }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
          name: "email",
          id: "email",
          type: "text",
          class: "rc-input__element",
          autocapitalize: "off",
          autocorrect: "off",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("_"), "Email");
          },
          autofocus: ""
        }), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\n\t\t\t\t\t", HTML.DIV({
          class: "rc-input"
        }, "\n\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-input__label",
          for: "pass"
        }, "\n\t\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input__wrapper"
        }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
          name: "pass",
          id: "pass",
          type: "password",
          class: "rc-input__element",
          autocapitalize: "off",
          autocorrect: "off",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("passwordPlaceholder"));
          },
          autofocus: ""
        }), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("requirePasswordConfirmation"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label",
            for: "confirm-pass"
          }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
            name: "confirm-pass",
            id: "confirm-pass",
            type: "password",
            class: "rc-input__element",
            autocapitalize: "off",
            autocorrect: "off",
            placeholder: function() {
              return Spacebars.mustache(view.lookup("confirmPasswordPlaceholder"));
            },
            autofocus: ""
          }), HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("manuallyApproveNewUsers"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input"
          }, "\n\t\t\t\t\t\t\t", HTML.LABEL({
            class: "rc-input__label",
            for: "confirm-pass"
          }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
            name: "reason",
            id: "reason",
            type: "text",
            class: "rc-input__element",
            autocapitalize: "off",
            autocorrect: "off",
            placeholder: function() {
              return Spacebars.mustache(view.lookup("_"), "Reason_To_Join");
            },
            autofocus: ""
          }), HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("state"), "forgot-password", "email-verification");
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-input"
        }, "\n\t\t\t\t\t\t", HTML.LABEL({
          class: "rc-input__label",
          for: "email"
        }, "\n\t\t\t\t\t\t\t", HTML.DIV({
          class: "rc-input__wrapper"
        }, "\n\t\t\t\t\t\t\t\t", HTML.INPUT({
          name: "email",
          id: "email",
          type: "text",
          class: "rc-input__element",
          autocapitalize: "off",
          autocorrect: "off",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("_"), "Email");
          },
          autofocus: "",
          value: function() {
            return Blaze.If(function() {
              return Spacebars.dataMustache(view.lookup("state"), "email-verification");
            }, function() {
              return Blaze.View("lookup:typedEmail", function() {
                return Spacebars.mustache(view.lookup("typedEmail"));
              });
            });
          }
        }), HTML.Raw('\n\t\t\t\t\t\t\t\t<div class="input-error"></div>\n\t\t\t\t\t\t\t')), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\n\t\t\t", HTML.DIV({
        class: "rc-button__group rc-button__group--vertical"
      }, "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("state"), "login");
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("showFormLogin"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.BUTTON({
            class: "rc-button rc-button--primary login"
          }, Blaze.View("lookup:btnLoginSave", function() {
            return Spacebars.mustache(view.lookup("btnLoginSave"));
          })), "\n\n\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("passwordResetAllowed"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
              type: "button",
              class: "rc-button rc-button--nude forgot-password"
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Forgot_password");
            })), "\n\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t" ];
        }), "\n\n\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("registrationAllowed"));
        }, function() {
          return [ "\n\t\t\t\t\t\t", HTML.BUTTON({
            type: "button",
            class: "rc-button rc-button--nude register"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), "Register");
          })), "\n\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("linkReplacementText"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
              class: "register-link-replacement"
            }, "\n\t\t\t\t\t\t\t\t", Blaze.View("lookup:linkReplacementText", function() {
              return Spacebars.makeRaw(Spacebars.mustache(view.lookup("linkReplacementText")));
            }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-button__group rc-button__group--vertical"
        }, "\n\t\t\t\t\t\t", HTML.BUTTON({
          class: "rc-button rc-button--primary login"
        }, Blaze.View("lookup:btnLoginSave", function() {
          return Spacebars.mustache(view.lookup("btnLoginSave"));
        })), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\t\t" ];
    });
  }), "\n\t\t", Blaze.Unless(function() {
    return Spacebars.dataMustache(view.lookup("state"), "login");
  }, function() {
    return [ "\n\t\t\t", HTML.DIV({
      class: "rc-button__group rc-button__group--vertical"
    }, "\n\t\t\t\t", HTML.BUTTON({
      type: "button",
      class: "rc-button rc-button--nude back-to-login"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Back_to_login");
    })), "\n\t\t\t"), "\n\t\t" ];
  }), "\n\t"), "\n\t", HTML.DIV({
    class: "login-terms"
  }, "\n\t\t", Blaze.View("lookup:loginTerms", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("loginTerms")));
  }), HTML.Raw('\n\t\t<div class="powered-by">\n\t\t\tPowered by <a class="color-tertiary-font-color" href="https://rocket.chat">Open Source Chat Platform Rocket.Chat</a>.\n\t\t</div>\n\t')) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"layout.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/layout.html                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.layout.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.layout.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/template.layout.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("loginLayout");
Template["loginLayout"] = new Template("Template.loginLayout", (function() {
  var view = this;
  return HTML.SECTION({
    class: "rc-old full-page color-tertiary-font-color",
    style: function() {
      return Spacebars.With(function() {
        return Spacebars.call(view.lookup("backgroundUrl"));
      }, function() {
        return [ "background-image: url('", Blaze.View("lookup:.", function() {
          return Spacebars.mustache(view.lookup("."));
        }), "')" ];
      });
    }
  }, "\n\t\t", HTML.DIV({
    class: "wrapper"
  }, "\n\t\t\t", Spacebars.include(view.lookupTemplate("loginLayoutHeader")), "\n\t\t\t", Spacebars.include(view.lookupTemplate("loginForm")), "\n\t\t\t", Spacebars.include(view.lookupTemplate("loginLayoutFooter")), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"services.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/services.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.services.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.services.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/template.services.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("loginServices");
Template["loginServices"] = new Template("Template.loginServices", (function() {
  var view = this;
  return [ Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("loginService"), "length"));
  }, function() {
    return [ "\n\t", HTML.DIV({
      class: "oauth-login buttons-group"
    }, "\n\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("loginService"));
    }, function() {
      return [ "\n\t\t", HTML.BUTTON({
        type: "button",
        class: function() {
          return [ "rc-button rc-button--secondary external-login ", Spacebars.mustache(Spacebars.dot(view.lookup("service"), "service")) ];
        },
        title: function() {
          return Spacebars.mustache(view.lookup("displayName"));
        },
        style: function() {
          return [ Blaze.If(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("service"), "buttonColor"));
          }, function() {
            return [ "background-color:", Blaze.View("lookup:service.buttonColor", function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("service"), "buttonColor"));
            }), ";" ];
          }), Blaze.If(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("service"), "buttonLabelColor"));
          }, function() {
            return [ "color:", Blaze.View("lookup:service.buttonLabelColor", function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("service"), "buttonLabelColor"));
            }), ";" ];
          }) ];
        }
      }, "\n\t\t\t", HTML.I({
        class: function() {
          return [ "icon-", Spacebars.mustache(view.lookup("icon")), " service-icon" ];
        }
      }), HTML.Raw('<i class="icon-spin animate-spin loading-icon hidden"></i>'), HTML.SPAN(Blaze.View("lookup:service.buttonLabelText", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("service"), "buttonLabelText"));
      })), "\n\t\t"), "\n\t\t" ];
    }), "\n\t"), "\n\t" ];
  }), " ", Spacebars.include(view.lookupTemplate("AppleOauthButton")) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"form.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/form.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 3);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 4);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 5);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 6);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 7);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 8);
var t;
module.link("../../../utils", {
  t: function (v) {
    t = v;
  }
}, 9);
var handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 10);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 11);
Template.loginForm.helpers({
  userName: function () {
    var user = Meteor.user();
    return user && user.username;
  },
  namePlaceholder: function () {
    if (settings.get('Accounts_RequireNameForSignUp')) {
      return t('Name');
    }

    return t('Name_optional');
  },
  showFormLogin: function () {
    return settings.get('Accounts_ShowFormLogin');
  },
  state: function () {
    for (var _len = arguments.length, state = new Array(_len), _key = 0; _key < _len; _key++) {
      state[_key] = arguments[_key];
    }

    return state.indexOf(Template.instance().state.get()) > -1;
  },
  btnLoginSave: function () {
    if (Template.instance().loading.get()) {
      return t('Please_wait') + "...";
    }

    switch (Template.instance().state.get()) {
      case 'register':
        return t('Register');

      case 'login':
        return t('Login');

      case 'email-verification':
        return t('Send_confirmation_email');

      case 'forgot-password':
        return t('Reset_password');
    }
  },
  loginTerms: function () {
    return settings.get('Layout_Login_Terms');
  },
  registrationAllowed: function () {
    var validSecretUrl = Template.instance().validSecretURL;
    return settings.get('Accounts_RegistrationForm') === 'Public' || validSecretUrl && validSecretUrl.get();
  },
  linkReplacementText: function () {
    return settings.get('Accounts_RegistrationForm_LinkReplacementText');
  },
  passwordResetAllowed: function () {
    return settings.get('Accounts_PasswordReset');
  },
  requirePasswordConfirmation: function () {
    return settings.get('Accounts_RequirePasswordConfirmation');
  },
  emailOrUsernamePlaceholder: function () {
    return settings.get('Accounts_EmailOrUsernamePlaceholder') || t('Email_or_username');
  },
  passwordPlaceholder: function () {
    return settings.get('Accounts_PasswordPlaceholder') || t('Password');
  },
  confirmPasswordPlaceholder: function () {
    return settings.get('Accounts_ConfirmPasswordPlaceholder') || t('Confirm_password');
  },
  manuallyApproveNewUsers: function () {
    return settings.get('Accounts_ManuallyApproveNewUsers');
  },
  typedEmail: function () {
    var _Template$instance$ty;

    return (_Template$instance$ty = Template.instance().typedEmail) === null || _Template$instance$ty === void 0 ? void 0 : _Template$instance$ty.trim();
  }
});
Template.loginForm.events({
  'submit #login-card': function (event, instance) {
    event.preventDefault();
    $(event.target).find('button.login').focus();
    instance.loading.set(true);
    var formData = instance.validate();
    var state = instance.state.get();

    if (formData) {
      var _formData$emailOrUser;

      if (state === 'email-verification') {
        var _formData$email;

        Meteor.call('sendConfirmationEmail', (_formData$email = formData.email) === null || _formData$email === void 0 ? void 0 : _formData$email.trim(), function () {
          instance.loading.set(false);
          callbacks.run('userConfirmationEmailRequested');
          dispatchToastMessage({
            type: 'success',
            message: t('We_have_sent_registration_email')
          });
          return instance.state.set('login');
        });
        return;
      }

      if (state === 'forgot-password') {
        var _formData$email2;

        Meteor.call('sendForgotPasswordEmail', (_formData$email2 = formData.email) === null || _formData$email2 === void 0 ? void 0 : _formData$email2.trim(), function (err) {
          if (err) {
            handleError(err);
            return instance.state.set('login');
          }

          instance.loading.set(false);
          callbacks.run('userForgotPasswordEmailRequested');
          dispatchToastMessage({
            type: 'success',
            message: t('If_this_email_is_registered')
          });
          return instance.state.set('login');
        });
        return;
      }

      if (state === 'register') {
        formData.secretURL = FlowRouter.getParam('hash');
        return Meteor.call('registerUser', formData, function (error) {
          var _formData$email3;

          instance.loading.set(false);

          if (error != null) {
            if (error.reason === 'Email already exists.') {
              dispatchToastMessage({
                type: 'error',
                message: t('Email_already_exists')
              });
            } else {
              handleError(error);
            }

            return;
          }

          callbacks.run('userRegistered');
          return Meteor.loginWithPassword((_formData$email3 = formData.email) === null || _formData$email3 === void 0 ? void 0 : _formData$email3.trim(), formData.pass, function (error) {
            if (error && error.error === 'error-invalid-email') {
              return instance.state.set('wait-email-activation');
            }

            if (error && error.error === 'error-user-is-not-activated') {
              return instance.state.set('wait-activation');
            }

            Session.set('forceLogin', false);
          });
        });
      }

      var loginMethod = 'loginWithPassword';

      if (settings.get('LDAP_Enable')) {
        loginMethod = 'loginWithLDAP';
      }

      if (settings.get('CROWD_Enable')) {
        loginMethod = 'loginWithCrowd';
      }

      return Meteor[loginMethod]((_formData$emailOrUser = formData.emailOrUsername) === null || _formData$emailOrUser === void 0 ? void 0 : _formData$emailOrUser.trim(), formData.pass, function (error) {
        instance.loading.set(false);

        if (error != null) {
          switch (error.error) {
            case 'error-user-is-not-activated':
              return dispatchToastMessage({
                type: 'error',
                message: t('Wait_activation_warning')
              });

            case 'error-invalid-email':
              instance.typedEmail = formData.emailOrUsername;
              return instance.state.set('email-verification');

            case 'error-app-user-is-not-allowed-to-login':
              dispatchToastMessage({
                type: 'error',
                message: t('App_user_not_allowed_to_login')
              });
              break;

            case 'error-login-blocked-for-ip':
              dispatchToastMessage({
                type: 'error',
                message: t('Error_login_blocked_for_ip')
              });
              break;

            case 'error-login-blocked-for-user':
              dispatchToastMessage({
                type: 'error',
                message: t('Error_login_blocked_for_user')
              });
              break;

            case 'error-license-user-limit-reached':
              dispatchToastMessage({
                type: 'error',
                message: t('error-license-user-limit-reached')
              });
              break;

            default:
              return dispatchToastMessage({
                type: 'error',
                message: t('User_not_found_or_incorrect_password')
              });
          }
        }

        Session.set('forceLogin', false);
      });
    }
  },
  'click .register': function () {
    Template.instance().state.set('register');
    return callbacks.run('loginPageStateChange', Template.instance().state.get());
  },
  'click .back-to-login': function () {
    Template.instance().state.set('login');
    return callbacks.run('loginPageStateChange', Template.instance().state.get());
  },
  'click .forgot-password': function () {
    Template.instance().state.set('forgot-password');
    return callbacks.run('loginPageStateChange', Template.instance().state.get());
  }
});
Template.loginForm.onCreated(function () {
  var _this = this;

  var instance = this;
  this.loading = new ReactiveVar(false);

  if (Session.get('loginDefaultState')) {
    this.state = new ReactiveVar(Session.get('loginDefaultState'));
  } else {
    this.state = new ReactiveVar('login');
  }

  Tracker.autorun(function () {
    var registrationForm = settings.get('Accounts_RegistrationForm');

    if (registrationForm === 'Disabled' && _this.state.get() === 'register') {
      _this.state.set('login');
    }
  });
  this.validSecretURL = new ReactiveVar(false);

  this.validate = function () {
    var formData = $('#login-card').serializeArray();
    var formObj = {};
    var validationObj = {};
    formData.forEach(function (field) {
      formObj[field.name] = field.value;
    });
    var state = instance.state.get();

    if (state !== 'login') {
      if (!(formObj.email && /\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]+\b/i.test(formObj.email))) {
        validationObj.email = t('Invalid_email');
      }
    }

    if (state === 'login') {
      if (!formObj.emailOrUsername) {
        validationObj.emailOrUsername = t('Invalid_email');
      }
    }

    if (state !== 'forgot-password' && state !== 'email-verification') {
      if (!formObj.pass) {
        validationObj.pass = t('Invalid_pass');
      }
    }

    if (state === 'register') {
      if (settings.get('Accounts_RequireNameForSignUp') && !formObj.name) {
        validationObj.name = t('Invalid_name');
      }

      if (settings.get('Accounts_RequirePasswordConfirmation') && formObj['confirm-pass'] !== formObj.pass) {
        validationObj['confirm-pass'] = t('Invalid_confirm_pass');
      }

      if (settings.get('Accounts_ManuallyApproveNewUsers') && !formObj.reason) {
        validationObj.reason = t('Invalid_reason');
      }
    }

    $('#login-card h2').removeClass('error');
    $('#login-card input.error, #login-card select.error').removeClass('error');
    $('#login-card .input-error').text('');

    if (!_.isEmpty(validationObj)) {
      $('#login-card h2').addClass('error');
      Object.keys(validationObj).forEach(function (key) {
        var value = validationObj[key];
        $("#login-card input[name=" + key + "], #login-card select[name=" + key + "]").addClass('error');
        $("#login-card input[name=" + key + "]~.input-error, #login-card select[name=" + key + "]~.input-error").text(value);
      });
      instance.loading.set(false);
      return false;
    }

    return formObj;
  };

  if (FlowRouter.getParam('hash')) {
    return Meteor.call('checkRegistrationSecretURL', FlowRouter.getParam('hash'), function () {
      return _this.validSecretURL.set(true);
    });
  }
});
Template.loginForm.onRendered(function () {
  var _this2 = this;

  Session.set('loginDefaultState');
  return Tracker.autorun(function () {
    callbacks.run('loginPageStateChange', _this2.state.get());

    switch (_this2.state.get()) {
      case 'login':
      case 'forgot-password':
      case 'email-verification':
        return Meteor.defer(function () {
          return $('input[name=email]').select().focus();
        });

      case 'register':
        return Meteor.defer(function () {
          return $('input[name=name]').select().focus();
        });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"layout.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/layout.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);
Template.loginLayout.helpers({
  backgroundUrl: function () {
    var asset = settings.get('Assets_background');
    var prefix = __meteor_runtime_config__.ROOT_URL_PATH_PREFIX || '';

    if (asset && (asset.url || asset.defaultUrl)) {
      return prefix + "/" + (asset.url || asset.defaultUrl);
    }
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"services.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/login/services.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var capitalize;
module.link("@rocket.chat/string-helpers", {
  capitalize: function (v) {
    capitalize = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration: function (v) {
    ServiceConfiguration = v;
  }
}, 3);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 4);
Template.loginServices.helpers({
  loginService: function () {
    return ServiceConfiguration.configurations.find({
      showButton: {
        $ne: false
      }
    }, {
      sort: {
        service: 1
      }
    }).fetch().map(function (service) {
      switch (service.service) {
        case 'meteor-developer':
          return {
            service: service,
            displayName: 'Meteor',
            icon: 'meteor'
          };

        case 'github':
          return {
            service: service,
            displayName: 'GitHub',
            icon: 'github-circled'
          };

        case 'gitlab':
          return {
            service: service,
            displayName: 'GitLab',
            icon: service.service
          };

        case 'wordpress':
          return {
            service: service,
            displayName: 'WordPress',
            icon: service.service
          };

        default:
          return {
            service: service,
            displayName: capitalize(String(service.service || '')),
            icon: service.service
          };
      }
    });
  }
});
var loginMethods = {
  'meteor-developer': 'MeteorDeveloperAccount',
  'linkedin': 'Linkedin'
};
Template.loginServices.events({
  'click .external-login': function (e) {
    if (this.service == null || this.service.service == null) {
      return;
    }

    var loadingIcon = $(e.currentTarget).find('.loading-icon');
    var serviceIcon = $(e.currentTarget).find('.service-icon');
    loadingIcon.removeClass('hidden');
    serviceIcon.addClass('hidden');
    var loginWithService = "loginWith" + (loginMethods[this.service.service] || capitalize(String(this.service.service || '')));
    var serviceConfig = this.service.clientConfig || {};
    Meteor[loginWithService](serviceConfig, function (error) {
      loadingIcon.addClass('hidden');
      serviceIcon.removeClass('hidden');

      if (!error) {
        return;
      }

      if (error.reason) {
        dispatchToastMessage({
          type: 'error',
          message: error.reason
        });
        return;
      }

      dispatchToastMessage({
        type: 'error',
        message: error.message
      });
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"username":{"username.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/username/username.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.username.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.username.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/username/template.username.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("username");
Template["username"] = new Template("Template.username", (function() {
  var view = this;
  return HTML.SECTION({
    class: "rc-old full-page color-tertiary-font-color",
    style: function() {
      return Spacebars.With(function() {
        return Spacebars.call(view.lookup("backgroundUrl"));
      }, function() {
        return [ "background-image: url('", Blaze.View("lookup:.", function() {
          return Spacebars.mustache(view.lookup("."));
        }), "')" ];
      });
    }
  }, "\n\t\t", HTML.DIV({
    class: "wrapper"
  }, "\n\t\t\t", HTML.FORM({
    id: "login-card",
    class: "content-background-color color-primary-font-color",
    method: "/"
  }, "\n\t\t\t\t", HTML.HEADER("\n\t\t\t\t\t", HTML.H2(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Username_title");
  })), "\n\t\t\t\t\t", HTML.P(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Username_description");
  })), "\n\t\t\t\t"), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "blocked"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "alert error-color error-background error-border"
    }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "error-blocked-username", Spacebars.kw({
        field: Spacebars.dot(view.lookup("username"), "escaped")
      })));
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "unavailable"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "alert error-color error-background error-border"
    }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "error-field-unavailable", Spacebars.kw({
        field: Spacebars.dot(view.lookup("username"), "escaped")
      })));
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "invalid"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "alert error-color error-background error-border"
    }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Username_invalid", Spacebars.dot(view.lookup("username"), "escaped")));
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "empty"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "alert error-color error-background error-border"
    }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "Username_cant_be_empty"));
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t\t", HTML.DIV({
    class: "fields"
  }, "\n\t\t\t\t\t", HTML.DIV({
    class: "input-text active"
  }, "\n\t\t\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "ready"));
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", HTML.SPAN("\n\t\t\t\t\t\t\t\t", HTML.INPUT({
      type: "text",
      name: "username",
      id: "username",
      value: function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("username"), "username"));
      },
      dir: "auto",
      class: "rc-input__element",
      placeholder: function() {
        return Spacebars.mustache(view.lookup("_"), "Username");
      }
    }), "\n\t\t\t\t\t\t\t"), HTML.Raw("\n\t\t\t\t\t\t\t<i></i>\n\t\t\t\t\t\t") ];
  }, function() {
    return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Loading_suggestion");
    }), "\n\t\t\t\t\t\t" ];
  }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\n        ", Spacebars.include(view.lookupTemplate("customFieldsForm")), "\n\t\t\t\t", Blaze.If(function() {
    return Spacebars.call(Spacebars.dot(view.lookup("username"), "ready"));
  }, function() {
    return [ "\n\t\t\t\t\t", HTML.DIV({
      class: "rc-button__group rc-button__group--vertical"
    }, "\n\t\t\t\t\t\t", HTML.BUTTON({
      "data-loading-text": function() {
        return [ Spacebars.mustache(view.lookup("_"), " Please_wait "), "..." ];
      },
      class: "rc-button rc-button--primary login"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Use_this_username");
    })), "\n\t\t\t\t\t\t", HTML.BUTTON({
      type: "reset",
      class: "rc-button rc-button--nude"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Logout");
    })), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
  }), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"username.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/username/username.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 4);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 5);
var Button;
module.link("../../../ui", {
  Button: function (v) {
    Button = v;
  }
}, 6);
var t;
module.link("../../../utils", {
  t: function (v) {
    t = v;
  }
}, 7);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 8);
var dispatchToastMessage;
module.link("../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 9);
Template.username.onCreated(function () {
  var _this = this;

  var self = this;
  self.customFields = new ReactiveVar();
  self.username = new ReactiveVar();
  Tracker.autorun(function () {
    var Accounts_CustomFields = settings.get('Accounts_CustomFields');

    if (typeof Accounts_CustomFields === 'string' && Accounts_CustomFields.trim() !== '') {
      try {
        return _this.customFields.set(JSON.parse(settings.get('Accounts_CustomFields')));
      } catch (error1) {
        return console.error('Invalid JSON for Accounts_CustomFields');
      }
    } else {
      return _this.customFields.set(null);
    }
  });

  var validateCustomFields = function (formObj, validationObj) {
    var customFields = self.customFields.get();

    if (!customFields) {
      return;
    }

    for (var field in meteorBabelHelpers.sanitizeForInObject(formObj)) {
      if (formObj.hasOwnProperty(field)) {
        var value = formObj[field];

        if (customFields[field] == null) {
          continue;
        }

        var customField = customFields[field];

        if (customField.required === true && !value) {
          validationObj[field] = t('Field_required');
          return validationObj[field];
        }

        if (customField.maxLength != null && value.length > customField.maxLength) {
          validationObj[field] = t('Max_length_is', customField.maxLength);
          return validationObj[field];
        }

        if (customField.minLength != null && value.length < customField.minLength) {
          validationObj[field] = t('Min_length_is', customField.minLength);
          return validationObj[field];
        }
      }
    }
  };

  this.validate = function () {
    var formData = $('#login-card').serializeArray();
    var formObj = {};
    var validationObj = {};
    formData.forEach(function (field) {
      formObj[field.name] = field.value;
    });
    $('#login-card h2').removeClass('error');
    $('#login-card input.error, #login-card select.error').removeClass('error');
    $('#login-card .input-error').text('');
    validateCustomFields(formObj, validationObj);

    if (!_.isEmpty(validationObj)) {
      $('#login-card h2').addClass('error');
      Object.keys(validationObj).forEach(function (key) {
        var value = validationObj[key];
        $("#login-card input[name=" + key + "], #login-card select[name=" + key + "]").addClass('error');
        $("#login-card input[name=" + key + "]~.input-error, #login-card select[name=" + key + "]~.input-error").text(value);
      });
      return false;
    }

    return formObj;
  };

  return Meteor.call('getUsernameSuggestion', function (error, username) {
    self.username.set({
      ready: true,
      username: username
    });
    return Meteor.defer(function () {
      return self.find('input').focus();
    });
  });
});
Template.username.helpers({
  username: function () {
    return Template.instance().username.get();
  },
  backgroundUrl: function () {
    var asset = settings.get('Assets_background');
    var prefix = __meteor_runtime_config__.ROOT_URL_PATH_PREFIX || '';

    if (asset && (asset.url || asset.defaultUrl)) {
      return prefix + "/" + (asset.url || asset.defaultUrl);
    }
  }
});
Template.username.events({
  'focus .input-text input': function (event) {
    return $(event.currentTarget).parents('.input-text').addClass('focus');
  },
  'blur .input-text input': function (event) {
    if (event.currentTarget.value === '') {
      return $(event.currentTarget).parents('.input-text').removeClass('focus');
    }
  },
  'reset #login-card': function () {
    Meteor.logout();
  },
  'submit #login-card': function (event, instance) {
    event.preventDefault();
    var formData = instance.validate();
    var username = instance.username.get();
    username.empty = false;
    username.error = false;
    username.invalid = false;
    instance.username.set(username);
    var button = $(event.target).find('button.login');
    Button.loading(button);

    if (!formData) {
      Button.reset(button);
      return;
    }

    var usernameValue = $('#username').val().trim();

    if (usernameValue === '') {
      username.empty = true;
      instance.username.set(username);
      Button.reset(button);
      return;
    }

    Meteor.call('saveCustomFields', formData, function (err) {
      if (err != null) {
        dispatchToastMessage({
          type: 'error',
          message: err.error
        });
      }
    });
    Meteor.call('setUsername', usernameValue, function (err) {
      if (err != null) {
        if (err.error === 'username-invalid') {
          username.invalid = true;
        } else if (err.error === 'error-blocked-username') {
          username.blocked = true;
        } else {
          username.unavailable = true;
        }

        username.username = usernameValue;
        username.escaped = _.escape(usernameValue);
      }

      Button.reset(button);
      instance.username.set(username);
      return callbacks.run('usernameSet');
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-login/client/index.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./login/form.html");
module.link("./login/layout.html");
module.link("./login/layout");
module.link("./login/services.html");
module.link("./username/username.html");
module.link("./login/form");
module.link("./login/services");
module.link("./username/username");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-master":{"client":{"loading":{"loading.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/loading/loading.html                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.loading.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.loading.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/loading/template.loading.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("loading");
Template["loading"] = new Template("Template.loading", (function() {
  var view = this;
  return HTML.DIV({
    class: function() {
      return [ "loading-animation ", Spacebars.mustache(view.lookup("class")) ];
    }
  }, HTML.Raw('\n\t\t<div class="bounce bounce1"></div>\n\t\t<div class="bounce bounce2"></div>\n\t\t<div class="bounce bounce3"></div>\n\t'));
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/loading/index.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./loading.css");
module.link("./loading.html");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"loading.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/loading/loading.css                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"body.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/body.html                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.body.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.body.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/template.body.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.body.addContent((function() {
  var view = this;
  return "";
}));
Meteor.startup(Template.body.renderToDocument);
Meteor.startup(function() {
  var attrs = {"class":"color-primary-font-color"};
  for (var prop in attrs) {
    document.body.setAttribute(prop, attrs[prop]);
  }
});

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"error.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/error.html                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.error.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.error.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/template.error.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("error");
Template["error"] = new Template("Template.error", (function() {
  var view = this;
  return HTML.SECTION({
    class: "rc-old full-page color-tertiary-font-color"
  }, "\n\t\t", HTML.DIV({
    class: "wrapper"
  }, HTML.Raw('\n\t\t\t<header>\n\t\t\t\t<a class="logo" href="/">\n\t\t\t\t\t<img src="images/logo/logo.svg?v=3">\n\t\t\t\t</a>\n\t\t\t</header>\n\t\t\t'), HTML.H1(Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Not_found_or_not_allowed");
  })), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"body.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/body.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Clipboard;
module.link("clipboard", {
  "default": function (v) {
    Clipboard = v;
  }
}, 0);
var s;
module.link("underscore.string", {
  "default": function (v) {
    s = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 2);
var Match;
module.link("meteor/check", {
  Match: function (v) {
    Match = v;
  }
}, 3);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 4);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 5);
var t;
module.link("../../utils/client", {
  t: function (v) {
    t = v;
  }
}, 6);
var chatMessages;
module.link("../../ui", {
  chatMessages: function (v) {
    chatMessages = v;
  }
}, 7);
var popover, RoomManager;
module.link("../../ui-utils", {
  popover: function (v) {
    popover = v;
  },
  RoomManager: function (v) {
    RoomManager = v;
  }
}, 8);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 9);
var ChatSubscription;
module.link("../../models", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 10);
module.link("./body.html");
var imperativeModal;
module.link("../../../client/lib/imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 11);
var GenericModal;
module.link("../../../client/components/GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 12);
var fireGlobalEvent;
module.link("../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 13);
var isLayoutEmbedded;
module.link("../../../client/lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded: function (v) {
    isLayoutEmbedded = v;
  }
}, 14);
Template.body.onRendered(function () {
  new Clipboard('.clipboard');
  $(document.body).on('keydown', function (e) {
    var unread = Session.get('unread');

    if (e.keyCode === 27 && (e.shiftKey === true || e.ctrlKey === true) && unread != null && unread !== '') {
      e.preventDefault();
      e.stopPropagation();

      var handleClearUnreadAllMessages = function () {
        var subscriptions = ChatSubscription.find({
          open: true
        }, {
          fields: {
            unread: 1,
            alert: 1,
            rid: 1,
            t: 1,
            name: 1,
            ls: 1
          }
        });
        subscriptions.forEach(function (subscription) {
          if (subscription.alert || subscription.unread > 0) {
            Meteor.call('readMessages', subscription.rid);
          }
        });
        imperativeModal.close();
      };

      imperativeModal.open({
        component: GenericModal,
        props: {
          children: t('Are_you_sure_you_want_to_clear_all_unread_messages'),
          variant: 'warning',
          title: t('Clear_all_unreads_question'),
          confirmText: t('Yes_clear_all'),
          onClose: imperativeModal.close,
          onCancel: imperativeModal.close,
          onConfirm: handleClearUnreadAllMessages
        }
      });
    }
  });
  $(document.body).on('keydown', function (e) {
    var target = e.target;

    if (e.ctrlKey === true || e.metaKey === true) {
      popover.close();
      return;
    }

    if (!(e.keyCode > 45 && e.keyCode < 91 || e.keyCode === 8)) {
      return;
    }

    if (/input|textarea|select/i.test(target.tagName)) {
      return;
    }

    if (target.id === 'pswp') {
      return;
    }

    popover.close();

    if (document.querySelector('.rc-modal-wrapper dialog[open]')) {
      return;
    }

    var inputMessage = chatMessages[RoomManager.openedRoom] && chatMessages[RoomManager.openedRoom].input;

    if (!inputMessage) {
      return;
    }

    inputMessage.focus();
  });

  var handleMessageLinkClick = function (event) {
    var link = event.currentTarget;

    if (link.origin === s.rtrim(Meteor.absoluteUrl(), '/') && /msg=([a-zA-Z0-9]+)/.test(link.search)) {
      fireGlobalEvent('click-message-link', {
        link: link.pathname + link.search
      });
    }
  };

  this.autorun(function () {
    if (isLayoutEmbedded()) {
      $(document.body).on('click', 'a', handleMessageLinkClick);
    } else {
      $(document.body).off('click', 'a', handleMessageLinkClick);
    }
  });
  this.autorun(function (c) {
    var w = window;
    var d = document;
    var script = 'script';
    var l = 'dataLayer';
    var i = settings.get('GoogleTagManager_id');

    if (Match.test(i, String) && i.trim() !== '') {
      c.stop();
      return function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
          'gtm.start': new Date().getTime(),
          'event': 'gtm.js'
        });
        var f = d.getElementsByTagName(s)[0];
        var j = d.createElement(s);
        var dl = l !== 'dataLayer' ? "&l=" + l : '';
        j.async = true;
        j.src = "//www.googletagmanager.com/gtm.js?id=" + i + dl;
        return f.parentNode.insertBefore(j, f);
      }(w, d, script, l, i);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-master/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./body");
module.link("./loading");
module.link("./error.html");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-message":{"client":{"messageBox":{"messageBox.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBox.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBox.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBox.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.messageBox.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBox");
Template["messageBox"] = new Template("Template.messageBox", (function() {
  var view = this;
  return HTML.DIV({
    class: function() {
      return [ "rc-message-box rc-new ", Blaze.If(function() {
        return Spacebars.call(view.lookup("isEmbedded"));
      }, function() {
        return "rc-message-box--embedded";
      }) ];
    }
  }, "\n\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("isAnonymousOrMustJoinWithCode"));
  }, function() {
    return [ "\n\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        rid: Spacebars.call(view.lookup("rid")),
        tmid: Spacebars.call(view.lookup("tmid"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("userActionIndicator"));
    }), "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isWritable"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("popupConfig"));
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
          return Spacebars.call(view.lookup("popupConfig"));
        }, function() {
          return Spacebars.include(view.lookupTemplate("messagePopupConfig"));
        }), "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
          return Spacebars.call(view.lookup("popupConfig"));
        }, function() {
          return Spacebars.include(view.lookupTemplate("messagePopupSlashCommandPreview"));
        }), "\n\t\t\t\t" ];
      }), "\n\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("replyMessageData"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "reply-preview__wrap message-popup"
        }, "\n\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(view.lookup("replyMessageData")),
            _variable: "reply"
          };
        }, function() {
          return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
            return {
              input: Spacebars.call(view.lookup("input")),
              replyMessageData: Spacebars.call(view.lookup("reply"))
            };
          }, function() {
            return Spacebars.include(view.lookupTemplate("messageBoxReplyPreview"));
          }), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\n\t\t\t\t", HTML.LABEL({
        class: "rc-message-box__container"
      }, "\n\t\t\t\t\t", HTML.SPAN({
        class: function() {
          return [ "rc-message-box__icon emoji-picker-icon ", Blaze.Unless(function() {
            return Spacebars.call(view.lookup("isEmojiEnabled"));
          }, function() {
            return "emoji-picker-icon--disabled";
          }), " js-emoji-picker" ];
        },
        "aria-haspopup": "true"
      }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          block: Spacebars.call("rc-input__icon-svg"),
          icon: Spacebars.call("emoji")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.TEXTAREA({
        "aria-label": function() {
          return Spacebars.mustache(view.lookup("_"), "Message");
        },
        name: "msg",
        maxlength: function() {
          return Spacebars.mustache(view.lookup("maxMessageLength"));
        },
        placeholder: function() {
          return Spacebars.mustache(view.lookup("_"), "Message");
        },
        rows: "1",
        class: "rc-message-box__textarea js-input-message"
      }), HTML.Raw('\n\t\t\t\t\t<div class="js-input-message-shadow"></div>\n\t\t\t\t\t'), Blaze.If(function() {
        return Spacebars.call(view.lookup("isSendIconVisible"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "rc-message-box__icon rc-message-box__send js-send",
          "data-desktop": ""
        }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call("rc-input__icon-svg"),
            icon: Spacebars.call("send")
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("customAction"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
            return {
              template: Spacebars.call(Spacebars.dot(view.lookup("customAction"), "template")),
              data: Spacebars.call(Spacebars.dot(view.lookup("customAction"), "data"))
            };
          }, function() {
            return Spacebars.include(function() {
              return Spacebars.call(Template.__dynamic);
            });
          }), "\n\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\n\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("canSend"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
              return {
                rid: Spacebars.call(view.lookup("rid")),
                tmid: Spacebars.call(view.lookup("tmid"))
              };
            }, function() {
              return Spacebars.include(view.lookupTemplate("messageBoxAudioMessage"));
            }), "\n\t\t\t\t\t\t\t\t", HTML.SPAN({
              class: "rc-message-box__action-menu js-action-menu",
              "data-desktop": "",
              "aria-haspopup": "true"
            }, "\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(view.lookup("actions"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.SPAN({
                class: "rc-message-box__icon"
              }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
                return {
                  block: Spacebars.call("rc-input__icon-svg"),
                  icon: Spacebars.call("plus")
                };
              }, function() {
                return Spacebars.include(view.lookupTemplate("icon"));
              }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", HTML.BUTTON({
              class: "js-join rc-button rc-button--primary rc-message-box__join-button"
            }, "\n\t\t\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "join");
            }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t" ];
      }), "\n\n\t\t\t\t\t", HTML.SPAN({
        class: "rc-message-box__action-label js-message-actions",
        "data-small": ""
      }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.call(view.lookup("actions")),
          _variable: "action"
        };
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", HTML.SPAN({
          class: "js-message-action",
          "data-id": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("action"), "id"));
          }
        }, "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call("rc-message-box__action"),
            icon: Spacebars.call(Spacebars.dot(view.lookup("action"), "icon"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\n\t\t\t\t\t", HTML.SPAN({
        class: "rc-message-box__send js-message-action js-send",
        disabled: function() {
          return Spacebars.mustache(view.lookup("isSendIconDisabled"));
        },
        "data-small": ""
      }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          block: Spacebars.call("rc-message-box__action"),
          icon: Spacebars.call("send")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("showFormattingTips"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.DIV({
          class: "rc-message-box__toolbar-formatting"
        }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(view.lookup("formattingButtons")),
            _variable: "formattingButton"
          };
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("formattingButton"), "icon"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", HTML.BUTTON({
              class: "rc-message-box__toolbar-formatting-item js-format",
              "data-id": function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("formattingButton"), "label"));
              },
              title: function() {
                return Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup("formattingButton"), "label"));
              }
            }, "\n\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
              return {
                block: Spacebars.call("rc-message-box__toolbar-formatting-icon"),
                icon: Spacebars.call(Spacebars.dot(view.lookup("formattingButton"), "icon"))
              };
            }, function() {
              return Spacebars.include(view.lookupTemplate("icon"));
            }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", HTML.SPAN({
              class: "rc-message-box__toolbar-formatting-item",
              title: function() {
                return Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup("formattingButton"), "label"));
              }
            }, "\n\t\t\t\t\t\t\t\t\t", HTML.A({
              href: function() {
                return Spacebars.mustache(Spacebars.dot(view.lookup("formattingButton"), "link"));
              },
              target: "_blank",
              rel: "noopener noreferrer",
              class: "rc-message-box__toolbar-formatting-link"
            }, Blaze.View("lookup:formattingButton.text", function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("formattingButton"), "text"));
            })), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: "rc-message-box__cannot-send"
      }, "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isBlockedOrBlocker"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "room_is_blocked");
        }), "\n\t\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            rid: Spacebars.call(view.lookup("rid")),
            isSubscribed: Spacebars.call(view.lookup("isSubscribed")),
            onHold: Spacebars.call(view.lookup("onHold"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("messageBoxReadOnly"));
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        rid: Spacebars.call(view.lookup("rid"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("messageBoxNotSubscribed"));
    }), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxAudioMessage.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxAudioMessage.html                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBoxAudioMessage.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBoxAudioMessage.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.messageBoxAudioMessage.js                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBoxAudioMessage");
Template["messageBoxAudioMessage"] = new Template("Template.messageBoxAudioMessage", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isAllowed"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: function() {
        return [ "rc-message-box__audio-message ", Spacebars.mustache(view.lookup("stateClass")) ];
      }
    }, "\n\t\t\t", HTML.DIV({
      class: "rc-message-box__icon rc-message-box__audio-message-cancel js-audio-message-cancel"
    }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call("circle-cross")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t"), "\n\t\t\t", HTML.DIV({
      class: "rc-message-box__audio-message-timer"
    }, HTML.Raw('\n\t\t\t\t<span class="rc-message-box__audio-message-timer-dot"></span>\n\t\t\t\t'), HTML.SPAN({
      class: "rc-message-box__audio-message-timer-text"
    }, Blaze.View("lookup:time", function() {
      return Spacebars.mustache(view.lookup("time"));
    })), "\n\t\t\t"), "\n\t\t\t", HTML.DIV({
      class: "rc-message-box__icon rc-message-box__audio-message-done js-audio-message-done"
    }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call("checkmark-circled")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t"), "\n\t\t\t", HTML.DIV({
      class: "rc-message-box__icon rc-message-box__audio-message-mic js-audio-message-record"
    }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call("mic")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t"), "\n\t\t\t", HTML.DIV({
      class: "rc-message-box__icon rc-message-box__audio-message-loading js-audio-message-loading"
    }, "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-input__icon-svg"),
        icon: Spacebars.call("loading")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t"), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxNotSubscribed.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxNotSubscribed.html                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBoxNotSubscribed.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBoxNotSubscribed.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.messageBoxNotSubscribed.js                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBoxNotSubscribed");
Template["messageBoxNotSubscribed"] = new Template("Template.messageBoxNotSubscribed", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("customTemplate"));
  }, function() {
    return [ "\n\t\t", Blaze._TemplateWith(function() {
      return {
        template: Spacebars.call(view.lookup("customTemplate"))
      };
    }, function() {
      return Spacebars.include(function() {
        return Spacebars.call(Template.__dynamic);
      });
    }), "\n\t" ];
  }, function() {
    return [ "\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("canJoinRoom"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "rc-message-box__join"
      }, "\n\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.makeRaw(Spacebars.mustache(view.lookup("_"), "you_are_in_preview_mode_of", Spacebars.kw({
          room_name: view.lookup("roomName")
        })));
      }), "\n\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isJoinCodeRequired"));
      }, function() {
        return [ "\n\t\t\t\t", HTML.INPUT({
          type: "password",
          name: "joinCode",
          placeholder: function() {
            return Spacebars.mustache(view.lookup("_"), "Password");
          },
          class: "rc-input__element rc-message-box__join-code"
        }), "\n\t\t\t\t" ];
      }), "\n\n\t\t\t\t", HTML.BUTTON({
        class: "rc-button rc-button--primary rc-button--small rc-message-box__join-button js-join-code"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "join");
      })), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isAnonymousReadAllowed"));
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "rc-button-group"
      }, "\n\t\t\t\t", HTML.BUTTON({
        class: "rc-button rc-button--primary rc-button--small js-register"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Sign_in_to_start_talking");
      })), "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isAnonymousWriteAllowed"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          class: "rc-button rc-button--small js-register-anonymous"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Or_talk_as_anonymous");
        })), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxReadOnly.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxReadOnly.html                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBoxReadOnly.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBoxReadOnly.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.messageBoxReadOnly.js                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBoxReadOnly");
Template["messageBoxReadOnly"] = new Template("Template.messageBoxReadOnly", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("customTemplate"));
  }, function() {
    return [ "\n\t\t", Blaze._TemplateWith(function() {
      return {
        template: Spacebars.call(view.lookup("customTemplate"))
      };
    }, function() {
      return Spacebars.include(function() {
        return Spacebars.call(Template.__dynamic);
      });
    }), "\n\t" ];
  }, function() {
    return [ "\n\t\t", HTML.SPAN("\n\t\t\t", Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "room_is_read_only");
    }), "\n\t\t"), "\n\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("isSubscribed"));
    }, function() {
      return [ "\n\t\t\t", HTML.BUTTON({
        class: "js-join rc-button rc-button--primary rc-message-box__join-button"
      }, "\n\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "join");
      }), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxReplyPreview.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxReplyPreview.html                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageBoxReplyPreview.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageBoxReplyPreview.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.messageBoxReplyPreview.js                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageBoxReplyPreview");
Template["messageBoxReplyPreview"] = new Template("Template.messageBoxReplyPreview", (function() {
  var view = this;
  return HTML.DIV({
    class: "reply-preview message-popup"
  }, "\n\t\t", HTML.DIV({
    class: "message"
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      attachments: Spacebars.call(view.lookup("attachments"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("reactAttachments"));
  }), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "rc-message-box__icon cancel-reply",
    "data-mid": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("replyMessageData"), "_id"));
    }
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      block: Spacebars.call("rc-input__icon-svg"),
      icon: Spacebars.call("cross")
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userActionIndicator.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/userActionIndicator.html                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.userActionIndicator.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.userActionIndicator.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/template.userActionIndicator.js                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("userActionIndicator");
Template["userActionIndicator"] = new Template("Template.userActionIndicator", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("data"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "rc-message-box__activity"
    }, "\n\t\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("data"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.SPAN({
        class: "rc-message-box__activity-user"
      }, Blaze.View("lookup:users", function() {
        return Spacebars.mustache(view.lookup("users"));
      })), "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("multi"));
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "are");
        }), HTML.Raw("&nbsp;"), Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), view.lookup("action"));
        }), Blaze.Unless(function() {
          return Spacebars.call(view.lookup("end"));
        }, function() {
          return ",";
        }), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "is");
        }), HTML.Raw("&nbsp;"), Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), view.lookup("action"));
        }), Blaze.Unless(function() {
          return Spacebars.call(view.lookup("end"));
        }, function() {
          return ",";
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBox.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBox.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var ReactiveDict;
module.link("meteor/reactive-dict", {
  ReactiveDict: function (v) {
    ReactiveDict = v;
  }
}, 2);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 3);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 4);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 5);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 6);
var setupAutogrow;
module.link("./messageBoxAutogrow", {
  setupAutogrow: function (v) {
    setupAutogrow = v;
  }
}, 7);
var formattingButtons, applyFormatting;
module.link("./messageBoxFormatting", {
  formattingButtons: function (v) {
    formattingButtons = v;
  },
  applyFormatting: function (v) {
    applyFormatting = v;
  }
}, 8);
var EmojiPicker;
module.link("../../../emoji", {
  EmojiPicker: function (v) {
    EmojiPicker = v;
  }
}, 9);
var Users;
module.link("../../../models", {
  Users: function (v) {
    Users = v;
  }
}, 10);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 11);
var fileUpload, KonchatNotification;
module.link("../../../ui", {
  fileUpload: function (v) {
    fileUpload = v;
  },
  KonchatNotification: function (v) {
    KonchatNotification = v;
  }
}, 12);
var messageBox, popover;
module.link("../../../ui-utils", {
  messageBox: function (v) {
    messageBox = v;
  },
  popover: function (v) {
    popover = v;
  }
}, 13);
var t, roomTypes, getUserPreference;
module.link("../../../utils/client", {
  t: function (v) {
    t = v;
  },
  roomTypes: function (v) {
    roomTypes = v;
  },
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 14);
module.link("./messageBoxActions");
module.link("./messageBoxReplyPreview");
module.link("./userActionIndicator.ts");
module.link("./messageBoxAudioMessage");
module.link("./messageBoxNotSubscribed");
module.link("./messageBox.html");
module.link("./messageBoxReadOnly");
var getImageExtensionFromMime;
module.link("../../../../lib/getImageExtensionFromMime", {
  getImageExtensionFromMime: function (v) {
    getImageExtensionFromMime = v;
  }
}, 15);
var keyCodes;
module.link("../../../../client/lib/utils/keyCodes", {
  keyCodes: function (v) {
    keyCodes = v;
  }
}, 16);
var isRTL;
module.link("../../../../client/lib/utils/isRTL", {
  isRTL: function (v) {
    isRTL = v;
  }
}, 17);
var call;
module.link("../../../../client/lib/utils/call", {
  call: function (v) {
    call = v;
  }
}, 18);
Template.messageBox.onCreated(function () {
  var _this = this;

  this.state = new ReactiveDict();
  this.popupConfig = new ReactiveVar(null);
  this.replyMessageData = new ReactiveVar();
  this.isMicrophoneDenied = new ReactiveVar(true);
  this.isSendIconVisible = new ReactiveVar(false);

  this.set = function (value) {
    var input = _this.input;

    if (!input) {
      return;
    }

    input.value = value;
    $(input).trigger('change').trigger('input');
  };

  this.insertNewLine = function () {
    var input = _this.input,
        autogrow = _this.autogrow;

    if (!input) {
      return;
    }

    if (document.selection) {
      input.focus();
      var sel = document.selection.createRange();
      sel.text = '\n';
    } else if (input.selectionStart || input.selectionStart === 0) {
      var newPosition = input.selectionStart + 1;
      var before = input.value.substring(0, input.selectionStart);
      var after = input.value.substring(input.selectionEnd, input.value.length);
      input.value = before + "\n" + after;
      input.selectionStart = newPosition;
      input.selectionEnd = newPosition;
    } else {
      input.value += '\n';
    }

    $(input).trigger('change').trigger('input');
    input.blur();
    input.focus();
    autogrow.update();
  };

  this.send = function (event) {
    var input = _this.input;

    if (!input) {
      return;
    }

    var autogrow = _this.autogrow,
        _this$data = _this.data,
        rid = _this$data.rid,
        tmid = _this$data.tmid,
        onSend = _this$data.onSend,
        tshow = _this$data.tshow;
    var value = input.value;

    _this.set('');

    if (!onSend) {
      return;
    }

    onSend.call(_this.data, event, {
      rid: rid,
      tmid: tmid,
      value: value,
      tshow: tshow
    }, function () {
      autogrow.update();
      input.focus();
    });
  };
});
Template.messageBox.onRendered(function () {
  var _this2 = this;

  var inputSetup = false;
  this.autorun(function () {
    var _Template$currentData = Template.currentData(),
        rid = _Template$currentData.rid,
        subscription = _Template$currentData.subscription;

    var room = Session.get("roomData" + rid);

    if (!inputSetup) {
      var $input = $(_this2.find('.js-input-message'));
      _this2.source = $input[0];

      if (_this2.source) {
        inputSetup = true;
      }

      $input.on('dataChange', function () {
        var messages = $input.data('reply') || [];

        _this2.replyMessageData.set(messages);
      });
    }

    if (!room) {
      return _this2.state.set({
        room: false,
        isBlockedOrBlocker: false,
        mustJoinWithCode: false
      });
    }

    var isBlocked = room && room.t === 'd' && subscription && subscription.blocked;
    var isBlocker = room && room.t === 'd' && subscription && subscription.blocker;
    var isBlockedOrBlocker = isBlocked || isBlocker;
    var mustJoinWithCode = !subscription && room.joinCodeRequired;
    return _this2.state.set({
      room: false,
      isBlockedOrBlocker: isBlockedOrBlocker,
      mustJoinWithCode: mustJoinWithCode
    });
  });
  this.autorun(function () {
    var _Template$currentData2 = Template.currentData(),
        rid = _Template$currentData2.rid,
        tmid = _Template$currentData2.tmid,
        onInputChanged = _Template$currentData2.onInputChanged,
        onResize = _Template$currentData2.onResize;

    Tracker.afterFlush(function () {
      var input = _this2.find('.js-input-message');

      if (_this2.input === input) {
        return;
      }

      _this2.input = input;
      onInputChanged && onInputChanged(input);

      if (input && rid) {
        _this2.popupConfig.set({
          rid: rid,
          tmid: tmid,
          getInput: function () {
            return input;
          }
        });
      } else {
        _this2.popupConfig.set(null);
      }

      if (_this2.autogrow) {
        _this2.autogrow.destroy();

        _this2.autogrow = null;
      }

      if (!input) {
        return;
      }

      var shadow = _this2.find('.js-input-message-shadow');

      _this2.autogrow = setupAutogrow(input, shadow, onResize);
    });
  });
});
Template.messageBox.onDestroyed(function () {
  if (!this.autogrow) {
    return;
  }

  this.autogrow.destroy();
});
Template.messageBox.helpers({
  isAnonymousOrMustJoinWithCode: function () {
    var instance = Template.instance();

    var _Template$currentData3 = Template.currentData(),
        rid = _Template$currentData3.rid;

    if (!rid) {
      return false;
    }

    var isAnonymous = !Meteor.userId();
    return isAnonymous || instance.state.get('mustJoinWithCode');
  },
  isWritable: function () {
    var _Template$currentData4 = Template.currentData(),
        rid = _Template$currentData4.rid,
        subscription = _Template$currentData4.subscription;

    if (!rid) {
      return true;
    }

    var isBlockedOrBlocker = Template.instance().state.get('isBlockedOrBlocker');

    if (isBlockedOrBlocker) {
      return false;
    }

    if (subscription !== null && subscription !== void 0 && subscription.onHold) {
      return false;
    }

    var isReadOnly = roomTypes.readOnly(rid, Users.findOne({
      _id: Meteor.userId()
    }, {
      fields: {
        username: 1
      }
    }));
    var isArchived = roomTypes.archived(rid) || subscription && subscription.t === 'd' && subscription.archived;
    return !isReadOnly && !isArchived;
  },
  popupConfig: function () {
    return Template.instance().popupConfig.get();
  },
  input: function () {
    return Template.instance().input;
  },
  replyMessageData: function () {
    return Template.instance().replyMessageData.get();
  },
  isEmojiEnabled: function () {
    return getUserPreference(Meteor.userId(), 'useEmojis');
  },
  maxMessageLength: function () {
    return settings.get('Message_AllowConvertLongMessagesToAttachment') ? null : settings.get('Message_MaxAllowedSize');
  },
  isSendIconVisible: function () {
    return Template.instance().isSendIconVisible.get();
  },
  canSend: function () {
    var _Template$currentData5 = Template.currentData(),
        rid = _Template$currentData5.rid;

    if (!rid) {
      return true;
    }

    return roomTypes.verifyCanSendMessage(rid);
  },
  actions: function () {
    var actionGroups = messageBox.actions.get();
    return Object.values(actionGroups).reduce(function (actions, actionGroup) {
      return [].concat(_toConsumableArray(actions), _toConsumableArray(actionGroup));
    }, []);
  },
  formattingButtons: function () {
    return formattingButtons.filter(function (_ref) {
      var condition = _ref.condition;
      return !condition || condition();
    });
  },
  isBlockedOrBlocker: function () {
    return Template.instance().state.get('isBlockedOrBlocker');
  },
  onHold: function () {
    var _Template$currentData6 = Template.currentData(),
        rid = _Template$currentData6.rid,
        subscription = _Template$currentData6.subscription;

    return rid && !!(subscription !== null && subscription !== void 0 && subscription.onHold);
  },
  isSubscribed: function () {
    var _Template$currentData7 = Template.currentData(),
        subscription = _Template$currentData7.subscription;

    return !!subscription;
  }
});

var handleFormattingShortcut = function (event, instance) {
  var isMacOS = navigator.platform.indexOf('Mac') !== -1;
  var isCmdOrCtrlPressed = isMacOS && event.metaKey || !isMacOS && event.ctrlKey;

  if (!isCmdOrCtrlPressed) {
    return false;
  }

  var key = event.key.toLowerCase();

  var _ref2 = formattingButtons.filter(function (_ref3) {
    var condition = _ref3.condition;
    return !condition || condition();
  }).find(function (_ref4) {
    var command = _ref4.command;
    return command === key;
  }) || {},
      pattern = _ref2.pattern;

  if (!pattern) {
    return false;
  }

  var input = instance.input;
  applyFormatting(pattern, input);
  return true;
};

var sendOnEnter;
var sendOnEnterActive;
Tracker.autorun(function () {
  sendOnEnter = getUserPreference(Meteor.userId(), 'sendOnEnter');
  sendOnEnterActive = sendOnEnter == null || sendOnEnter === 'normal' || sendOnEnter === 'desktop' && Meteor.Device.isDesktop();
});

var handleSubmit = function (event, instance) {
  var keyCode = event.which;
  var isSubmitKey = keyCode === keyCodes.CARRIAGE_RETURN || keyCode === keyCodes.NEW_LINE;

  if (!isSubmitKey) {
    return false;
  }

  var withModifier = event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;
  var isSending = sendOnEnterActive && !withModifier || !sendOnEnterActive && withModifier;

  if (isSending) {
    instance.send(event);
    return true;
  }

  instance.insertNewLine();
  return true;
};

Template.messageBox.events({
  'click .js-join': function () {
    function _callee(event) {
      var joinCodeInput, joinCode;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                event.stopPropagation();
                event.preventDefault();
                joinCodeInput = Template.instance().find('[name=joinCode]');
                joinCode = joinCodeInput && joinCodeInput.value;
                _context.next = 6;
                return _regeneratorRuntime.awrap(call('joinRoom', this.rid, joinCode));

              case 6:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, this, null, Promise);
    }

    return _callee;
  }(),
  'click .js-emoji-picker': function (event, instance) {
    event.stopPropagation();
    event.preventDefault();

    if (!getUserPreference(Meteor.userId(), 'useEmojis')) {
      return;
    }

    if (EmojiPicker.isOpened()) {
      EmojiPicker.close();
      return;
    }

    EmojiPicker.open(instance.source, function (emoji) {
      var emojiValue = ":" + emoji + ": ";
      var input = instance.input;
      var caretPos = input.selectionStart;
      var textAreaTxt = input.value;
      input.focus();

      if (!document.execCommand || !document.execCommand('insertText', false, emojiValue)) {
        instance.set(textAreaTxt.substring(0, caretPos) + emojiValue + textAreaTxt.substring(caretPos));
        input.focus();
      }

      input.selectionStart = caretPos + emojiValue.length;
      input.selectionEnd = caretPos + emojiValue.length;
    });
  },
  'focus .js-input-message': function () {
    KonchatNotification.removeRoomNotification(this.rid);
  },
  'keydown .js-input-message': function (event, instance) {
    var isEventHandled = handleFormattingShortcut(event, instance) || handleSubmit(event, instance);

    if (isEventHandled) {
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    var rid = this.rid,
        tmid = this.tmid,
        onKeyDown = this.onKeyDown;
    onKeyDown && onKeyDown.call(this, event, {
      rid: rid,
      tmid: tmid
    });
  },
  'keyup .js-input-message': function (event) {
    var rid = this.rid,
        tmid = this.tmid,
        onKeyUp = this.onKeyUp;
    onKeyUp && onKeyUp.call(this, event, {
      rid: rid,
      tmid: tmid
    });
  },
  'paste .js-input-message': function (event, instance) {
    var rid = this.rid,
        tmid = this.tmid;
    var input = instance.input,
        autogrow = instance.autogrow;
    setTimeout(function () {
      return autogrow && autogrow.update();
    }, 50);

    if (!event.originalEvent.clipboardData) {
      return;
    }

    var items = _toConsumableArray(event.originalEvent.clipboardData.items);

    if (items.some(function (_ref5) {
      var kind = _ref5.kind,
          type = _ref5.type;
      return kind === 'string' && type === 'text/plain';
    })) {
      return;
    }

    var files = items.filter(function (item) {
      return item.kind === 'file' && item.type.indexOf('image/') !== -1;
    }).map(function (item) {
      var fileItem = item.getAsFile();
      var imageExtension = getImageExtensionFromMime(fileItem.type);
      var extension = imageExtension ? "." + imageExtension : '';
      return {
        file: fileItem,
        name: "Clipboard - " + moment().format(settings.get('Message_TimeAndDateFormat')) + extension
      };
    }).filter(function (_ref6) {
      var file = _ref6.file;
      return file !== null;
    });

    if (files.length) {
      event.preventDefault();
      fileUpload(files, input, {
        rid: rid,
        tmid: tmid
      });
    }
  },
  'input .js-input-message': function (event, instance) {
    var input = instance.input;

    if (!input) {
      return;
    }

    instance.isSendIconVisible.set(!!input.value);

    if (input.value.length > 0) {
      input.dir = isRTL(input.value) ? 'rtl' : 'ltr';
    }

    var rid = this.rid,
        tmid = this.tmid,
        onValueChanged = this.onValueChanged;
    onValueChanged && onValueChanged.call(this, event, {
      rid: rid,
      tmid: tmid
    });
  },
  'propertychange .js-input-message': function (event, instance) {
    if (event.originalEvent.propertyName !== 'value') {
      return;
    }

    var input = instance.input;

    if (!input) {
      return;
    }

    instance.sendIconDisabled.set(!!input.value);

    if (input.value.length > 0) {
      input.dir = isRTL(input.value) ? 'rtl' : 'ltr';
    }

    var rid = this.rid,
        tmid = this.tmid,
        onValueChanged = this.onValueChanged;
    onValueChanged && onValueChanged.call(this, event, {
      rid: rid,
      tmid: tmid
    });
  },
  'click .js-send': function () {
    function _callee2(event, instance) {
      return _regeneratorRuntime.async(function () {
        function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                instance.send(event);

              case 1:
              case "end":
                return _context2.stop();
            }
          }
        }

        return _callee2$;
      }(), null, null, null, Promise);
    }

    return _callee2;
  }(),
  'click .js-action-menu': function (event, instance) {
    var groups = messageBox.actions.get();
    var config = {
      popoverClass: 'message-box',
      columns: [{
        groups: Object.keys(groups).map(function (group) {
          var items = [];
          groups[group].forEach(function (item) {
            items.push({
              icon: item.icon,
              name: t(item.label),
              type: 'messagebox-action',
              id: item.id
            });
          });
          return {
            title: t(group),
            items: items
          };
        })
      }],
      offsetVertical: 10,
      direction: 'top-inverted',
      currentTarget: event.currentTarget.firstElementChild.firstElementChild,
      data: {
        rid: this.rid,
        tmid: this.tmid,
        prid: this.subscription.prid,
        messageBox: instance.firstNode
      },
      activeElement: event.currentTarget
    };
    popover.open(config);
  },
  'click .js-message-actions .js-message-action': function (event, instance) {
    var _this3 = this;

    var id = event.currentTarget.dataset.id;
    var actions = messageBox.actions.getById(id);
    actions.filter(function (_ref7) {
      var action = _ref7.action;
      return !!action;
    }).forEach(function (_ref8) {
      var action = _ref8.action;
      action.call(null, {
        rid: _this3.rid,
        tmid: _this3.tmid,
        messageBox: instance.firstNode,
        prid: _this3.subscription.prid,
        event: event
      });
    });
  },
  'click .js-format': function (event, instance) {
    event.preventDefault();
    event.stopPropagation();
    var id = event.currentTarget.dataset.id;

    var _ref9 = formattingButtons.filter(function (_ref10) {
      var condition = _ref10.condition;
      return !condition || condition();
    }).find(function (_ref11) {
      var label = _ref11.label;
      return label === id;
    }) || {},
        pattern = _ref9.pattern;

    if (!pattern) {
      return;
    }

    applyFormatting(pattern, instance.input);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxActions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxActions.js                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var VRecDialog;
module.link("../../../ui-vrecord/client", {
  VRecDialog: function (v) {
    VRecDialog = v;
  }
}, 4);
var messageBox, modal;
module.link("../../../ui-utils", {
  messageBox: function (v) {
    messageBox = v;
  },
  modal: function (v) {
    modal = v;
  }
}, 5);
var fileUpload;
module.link("../../../ui", {
  fileUpload: function (v) {
    fileUpload = v;
  }
}, 6);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 7);
var t;
module.link("../../../utils", {
  t: function (v) {
    t = v;
  }
}, 8);
messageBox.actions.add('Create_new', 'Video_message', {
  id: 'video-message',
  icon: 'video',
  condition: function () {
    return (navigator.mediaDevices || navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia) && window.MediaRecorder && settings.get('FileUpload_Enabled') && settings.get('Message_VideoRecorderEnabled') && (!settings.get('FileUpload_MediaTypeBlackList') || !settings.get('FileUpload_MediaTypeBlackList').match(/video\/webm|video\/\*/i)) && (!settings.get('FileUpload_MediaTypeWhiteList') || settings.get('FileUpload_MediaTypeWhiteList').match(/video\/webm|video\/\*/i));
  },
  action: function (_ref) {
    var rid = _ref.rid,
        tmid = _ref.tmid,
        messageBox = _ref.messageBox;
    return VRecDialog.opened ? VRecDialog.close() : VRecDialog.open(messageBox, {
      rid: rid,
      tmid: tmid
    });
  }
});
messageBox.actions.add('Add_files_from', 'Computer', {
  id: 'file-upload',
  icon: 'computer',
  condition: function () {
    return settings.get('FileUpload_Enabled');
  },
  action: function (_ref2) {
    var rid = _ref2.rid,
        tmid = _ref2.tmid,
        event = _ref2.event,
        messageBox = _ref2.messageBox;
    event.preventDefault();
    var $input = $(document.createElement('input'));
    $input.css('display', 'none');
    $input.attr({
      id: 'fileupload-input',
      type: 'file',
      multiple: 'multiple'
    });
    $(document.body).append($input);
    $input.one('change', function () {
      function _callee(e) {
        var _await$module$dynamic, mime, filesToUpload;

        return _regeneratorRuntime.async(function () {
          function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  _context.next = 2;
                  return _regeneratorRuntime.awrap(module.dynamicImport('../../../utils/lib/mimeTypes'));

                case 2:
                  _await$module$dynamic = _context.sent;
                  mime = _await$module$dynamic.mime;
                  filesToUpload = _toConsumableArray(e.target.files).map(function (file) {
                    Object.defineProperty(file, 'type', {
                      value: mime.lookup(file.name)
                    });
                    return {
                      file: file,
                      name: file.name
                    };
                  });
                  fileUpload(filesToUpload, $('.js-input-message', messageBox).get(0), {
                    rid: rid,
                    tmid: tmid
                  });
                  $input.remove();

                case 7:
                case "end":
                  return _context.stop();
              }
            }
          }

          return _callee$;
        }(), null, null, null, Promise);
      }

      return _callee;
    }());
    $input.click(); // Simple hack for iOS aka codegueira

    if (navigator.userAgent.match(/(iPad|iPhone|iPod)/g)) {
      $input.click();
    }
  }
});
var canGetGeolocation = new ReactiveVar(false);

var getGeolocationPermission = function () {
  return new Promise(function (resolve) {
    if (!navigator.permissions) {
      resolve(true);
    }

    navigator.permissions.query({
      name: 'geolocation'
    }).then(function (_ref3) {
      var state = _ref3.state;
      resolve(state);
    });
  });
};

var getGeolocationPosition = function () {
  return new Promise(function (resolvePos) {
    navigator.geolocation.getCurrentPosition(resolvePos, function () {
      resolvePos(false);
    }, {
      enableHighAccuracy: true,
      maximumAge: 0,
      timeout: 10000
    });
  });
};

var getCoordinates = function () {
  function _callee3() {
    var status, resolveModal, modalAnswer, _position, position;

    return _regeneratorRuntime.async(function () {
      function _callee3$(_context3) {
        while (1) {
          switch (_context3.prev = _context3.next) {
            case 0:
              _context3.next = 2;
              return _regeneratorRuntime.awrap(getGeolocationPermission());

            case 2:
              status = _context3.sent;

              if (!(status === 'prompt')) {
                _context3.next = 10;
                break;
              }

              modalAnswer = new Promise(function (resolve) {
                resolveModal = resolve;
              });
              modal.open({
                title: t('You_will_be_asked_for_permissions'),
                confirmButtonText: t('Continue'),
                showCancelButton: true,
                closeOnConfirm: true,
                closeOnCancel: true
              }, function () {
                function _callee2(isConfirm) {
                  var position, newStatus;
                  return _regeneratorRuntime.async(function () {
                    function _callee2$(_context2) {
                      while (1) {
                        switch (_context2.prev = _context2.next) {
                          case 0:
                            if (!isConfirm) {
                              resolveModal(false);
                            }

                            _context2.next = 3;
                            return _regeneratorRuntime.awrap(getGeolocationPosition());

                          case 3:
                            position = _context2.sent;

                            if (!position) {
                              newStatus = getGeolocationPermission();
                              resolveModal(newStatus);
                            }

                            resolveModal(position);

                          case 6:
                          case "end":
                            return _context2.stop();
                        }
                      }
                    }

                    return _callee2$;
                  }(), null, null, null, Promise);
                }

                return _callee2;
              }());
              _context3.next = 8;
              return _regeneratorRuntime.awrap(modalAnswer);

            case 8:
              _position = _context3.sent;
              return _context3.abrupt("return", _position);

            case 10:
              if (!(status === 'denied')) {
                _context3.next = 12;
                break;
              }

              return _context3.abrupt("return", status);

            case 12:
              _context3.next = 14;
              return _regeneratorRuntime.awrap(getGeolocationPosition());

            case 14:
              position = _context3.sent;
              return _context3.abrupt("return", position);

            case 16:
            case "end":
              return _context3.stop();
          }
        }
      }

      return _callee3$;
    }(), null, null, null, Promise);
  }

  return _callee3;
}();

messageBox.actions.add('Share', 'My_location', {
  id: 'share-location',
  icon: 'map-pin',
  condition: function () {
    return canGetGeolocation.get();
  },
  action: function () {
    function _callee4(_ref4) {
      var rid, tmid, position, _position$coords, latitude, longitude, text;

      return _regeneratorRuntime.async(function () {
        function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                rid = _ref4.rid, tmid = _ref4.tmid;
                _context4.next = 3;
                return _regeneratorRuntime.awrap(getCoordinates());

              case 3:
                position = _context4.sent;

                if (position) {
                  _context4.next = 6;
                  break;
                }

                return _context4.abrupt("return");

              case 6:
                if (!(position === 'denied')) {
                  _context4.next = 9;
                  break;
                }

                modal.open({
                  title: t('Cannot_share_your_location'),
                  text: t('The_necessary_browser_permissions_for_location_sharing_are_not_granted'),
                  confirmButtonText: t('Ok'),
                  closeOnConfirm: true
                });
                return _context4.abrupt("return");

              case 9:
                _position$coords = position.coords, latitude = _position$coords.latitude, longitude = _position$coords.longitude;
                text = "<div class=\"upload-preview\"><div class=\"upload-preview-file\" style=\"background-size: cover; box-shadow: 0 0 0px 1px #dfdfdf; border-radius: 2px; height: 250px; width:100%; max-width: 500px; background-image:url(https://maps.googleapis.com/maps/api/staticmap?zoom=14&size=500x250&markers=color:gray%7Clabel:%7C" + latitude + "," + longitude + "&key=" + settings.get('MapView_GMapsAPIKey') + ")\" ></div></div>";
                modal.open({
                  title: t('Share_Location_Title'),
                  text: text,
                  showCancelButton: true,
                  closeOnConfirm: true,
                  closeOnCancel: true,
                  html: true
                }, function (isConfirm) {
                  if (isConfirm !== true) {
                    return;
                  }

                  Meteor.call('sendMessage', {
                    _id: Random.id(),
                    rid: rid,
                    tmid: tmid,
                    msg: '',
                    location: {
                      type: 'Point',
                      coordinates: [longitude, latitude]
                    }
                  });
                });

              case 12:
              case "end":
                return _context4.stop();
            }
          }
        }

        return _callee4$;
      }(), null, null, null, Promise);
    }

    return _callee4;
  }()
});
Meteor.startup(function () {
  Tracker.autorun(function () {
    var isMapViewEnabled = settings.get('MapView_Enabled') === true;
    var isGeolocationCurrentPositionSupported = navigator.geolocation && navigator.geolocation.getCurrentPosition;
    var googleMapsApiKey = settings.get('MapView_GMapsAPIKey');
    canGetGeolocation.set(isMapViewEnabled && isGeolocationCurrentPositionSupported && googleMapsApiKey && googleMapsApiKey.length);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxAudioMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxAudioMessage.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var AudioRecorder, fileUpload, USER_ACTIVITIES, UserAction;
module.link("../../../ui", {
  AudioRecorder: function (v) {
    AudioRecorder = v;
  },
  fileUpload: function (v) {
    fileUpload = v;
  },
  USER_ACTIVITIES: function (v) {
    USER_ACTIVITIES = v;
  },
  UserAction: function (v) {
    UserAction = v;
  }
}, 3);
var t;
module.link("../../../utils", {
  t: function (v) {
    t = v;
  }
}, 4);
module.link("./messageBoxAudioMessage.html");

var startRecording = function () {
  function _callee(rid, tmid) {
    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.prev = 0;
              _context.next = 3;
              return _regeneratorRuntime.awrap(AudioRecorder.start());

            case 3:
              UserAction.performContinuously(rid, USER_ACTIVITIES.USER_RECORDING, {
                tmid: tmid
              });
              _context.next = 9;
              break;

            case 6:
              _context.prev = 6;
              _context.t0 = _context["catch"](0);
              throw _context.t0;

            case 9:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, [[0, 6]], Promise);
  }

  return _callee;
}();

var stopRecording = function () {
  function _callee2(rid, tmid) {
    var result;
    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              _context2.next = 2;
              return _regeneratorRuntime.awrap(new Promise(function (resolve) {
                return AudioRecorder.stop(resolve);
              }));

            case 2:
              result = _context2.sent;
              UserAction.stop(rid, USER_ACTIVITIES.USER_RECORDING, {
                tmid: tmid
              });
              return _context2.abrupt("return", result);

            case 5:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();

var recordingInterval = new ReactiveVar(null);
var recordingRoomId = new ReactiveVar(null);

var clearIntervalVariables = function () {
  if (recordingInterval.get()) {
    clearInterval(recordingInterval.get());
    recordingInterval.set(null);
    recordingRoomId.set(null);
  }
};

var cancelRecording = function () {
  function _callee3(instance, rid, tmid) {
    var blob;
    return _regeneratorRuntime.async(function () {
      function _callee3$(_context3) {
        while (1) {
          switch (_context3.prev = _context3.next) {
            case 0:
              clearIntervalVariables();
              instance.time.set('00:00');
              _context3.next = 4;
              return _regeneratorRuntime.awrap(stopRecording(rid, tmid));

            case 4:
              blob = _context3.sent;
              instance.state.set(null);
              return _context3.abrupt("return", blob);

            case 7:
            case "end":
              return _context3.stop();
          }
        }
      }

      return _callee3$;
    }(), null, null, null, Promise);
  }

  return _callee3;
}();

Template.messageBoxAudioMessage.onCreated(function () {
  function _callee4() {
    var _this = this;

    var permissionStatus;
    return _regeneratorRuntime.async(function () {
      function _callee4$(_context4) {
        while (1) {
          switch (_context4.prev = _context4.next) {
            case 0:
              this.state = new ReactiveVar(null);
              this.time = new ReactiveVar('00:00');
              this.isMicrophoneDenied = new ReactiveVar(false);

              if (!navigator.permissions) {
                _context4.next = 16;
                break;
              }

              _context4.prev = 4;
              _context4.next = 7;
              return _regeneratorRuntime.awrap(navigator.permissions.query({
                name: 'microphone'
              }));

            case 7:
              permissionStatus = _context4.sent;
              this.isMicrophoneDenied.set(permissionStatus.state === 'denied');

              permissionStatus.onchange = function () {
                _this.isMicrophoneDenied.set(permissionStatus.state === 'denied');
              };

              return _context4.abrupt("return");

            case 13:
              _context4.prev = 13;
              _context4.t0 = _context4["catch"](4);
              console.warn(_context4.t0);

            case 16:
              if (!(!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices)) {
                _context4.next = 19;
                break;
              }

              this.isMicrophoneDenied.set(true);
              return _context4.abrupt("return");

            case 19:
              _context4.prev = 19;
              _context4.next = 22;
              return _regeneratorRuntime.awrap(navigator.mediaDevices.enumerateDevices());

            case 22:
              if (_context4.sent.some(function (_ref) {
                var kind = _ref.kind;
                return kind === 'audioinput';
              })) {
                _context4.next = 25;
                break;
              }

              this.isMicrophoneDenied.set(true);
              return _context4.abrupt("return");

            case 25:
              _context4.next = 30;
              break;

            case 27:
              _context4.prev = 27;
              _context4.t1 = _context4["catch"](19);
              console.warn(_context4.t1);

            case 30:
            case "end":
              return _context4.stop();
          }
        }
      }

      return _callee4$;
    }(), null, this, [[4, 13], [19, 27]], Promise);
  }

  return _callee4;
}());
Template.messageBoxAudioMessage.onDestroyed(function () {
  function _callee5() {
    var _this$data, rid, tmid;

    return _regeneratorRuntime.async(function () {
      function _callee5$(_context5) {
        while (1) {
          switch (_context5.prev = _context5.next) {
            case 0:
              if (!(this.state.get() === 'recording')) {
                _context5.next = 4;
                break;
              }

              _this$data = this.data, rid = _this$data.rid, tmid = _this$data.tmid;
              _context5.next = 4;
              return _regeneratorRuntime.awrap(cancelRecording(this, rid, tmid));

            case 4:
            case "end":
              return _context5.stop();
          }
        }
      }

      return _callee5$;
    }(), null, this, null, Promise);
  }

  return _callee5;
}());
Template.messageBoxAudioMessage.helpers({
  isAllowed: function () {
    return AudioRecorder.isSupported() && !Template.instance().isMicrophoneDenied.get() && settings.get('FileUpload_Enabled') && settings.get('Message_AudioRecorderEnabled') && (!settings.get('FileUpload_MediaTypeBlackList') || !settings.get('FileUpload_MediaTypeBlackList').match(/audio\/mp3|audio\/\*/i)) && (!settings.get('FileUpload_MediaTypeWhiteList') || settings.get('FileUpload_MediaTypeWhiteList').match(/audio\/mp3|audio\/\*/i));
  },
  stateClass: function () {
    if (recordingRoomId.get() && recordingRoomId.get() !== Template.currentData().rid) {
      return 'rc-message-box__audio-message--busy';
    }

    var state = Template.instance().state.get();
    return state && "rc-message-box__audio-message--" + state;
  },
  time: function () {
    return Template.instance().time.get();
  }
});
Template.messageBoxAudioMessage.events({
  'click .js-audio-message-record': function () {
    function _callee6(event, instance) {
      var startTime;
      return _regeneratorRuntime.async(function () {
        function _callee6$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                event.preventDefault();

                if (!(recordingRoomId.get() && recordingRoomId.get() !== this.rid)) {
                  _context6.next = 3;
                  break;
                }

                return _context6.abrupt("return");

              case 3:
                instance.state.set('recording');
                _context6.prev = 4;
                _context6.next = 7;
                return _regeneratorRuntime.awrap(startRecording(this.rid, this.tmid));

              case 7:
                startTime = new Date();
                recordingInterval.set(setInterval(function () {
                  var now = new Date();
                  var distance = (now.getTime() - startTime.getTime()) / 1000;
                  var minutes = Math.floor(distance / 60);
                  var seconds = Math.floor(distance % 60);
                  instance.time.set(String(minutes).padStart(2, '0') + ":" + String(seconds).padStart(2, '0'));
                }, 1000));
                recordingRoomId.set(this.rid);
                _context6.next = 17;
                break;

              case 12:
                _context6.prev = 12;
                _context6.t0 = _context6["catch"](4);
                console.log(_context6.t0);
                instance.isMicrophoneDenied.set(true);
                instance.state.set(null);

              case 17:
              case "end":
                return _context6.stop();
            }
          }
        }

        return _callee6$;
      }(), null, this, [[4, 12]], Promise);
    }

    return _callee6;
  }(),
  'click .js-audio-message-cancel': function () {
    function _callee7(event, instance) {
      return _regeneratorRuntime.async(function () {
        function _callee7$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                event.preventDefault();
                _context7.next = 3;
                return _regeneratorRuntime.awrap(cancelRecording(instance, this.rid, this.tmid));

              case 3:
              case "end":
                return _context7.stop();
            }
          }
        }

        return _callee7$;
      }(), null, this, null, Promise);
    }

    return _callee7;
  }(),
  'click .js-audio-message-done': function () {
    function _callee8(event, instance) {
      var rid, tmid, blob;
      return _regeneratorRuntime.async(function () {
        function _callee8$(_context8) {
          while (1) {
            switch (_context8.prev = _context8.next) {
              case 0:
                event.preventDefault();
                instance.state.set('loading');
                rid = this.rid, tmid = this.tmid;
                _context8.next = 5;
                return _regeneratorRuntime.awrap(cancelRecording(instance, rid, tmid));

              case 5:
                blob = _context8.sent;
                _context8.next = 8;
                return _regeneratorRuntime.awrap(fileUpload([{
                  file: blob,
                  type: 'video',
                  name: t('Audio record') + ".mp3"
                }], {
                  input: blob
                }, {
                  rid: rid,
                  tmid: tmid
                }));

              case 8:
              case "end":
                return _context8.stop();
            }
          }
        }

        return _callee8$;
      }(), null, this, null, Promise);
    }

    return _callee8;
  }()
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxAutogrow.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxAutogrow.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  setupAutogrow: function () {
    return setupAutogrow;
  }
});

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);

var replaceWhitespaces = function (whitespaces) {
  return '&nbsp;'.repeat(whitespaces.length - 1) + " ";
};

var setupAutogrow = function (textarea, shadow, callback) {
  var width = textarea.clientWidth;
  var height = textarea.clientHeight;

  var _window$getComputedSt = window.getComputedStyle(textarea),
      font = _window$getComputedSt.font,
      lineHeight = _window$getComputedSt.lineHeight,
      maxHeightPx = _window$getComputedSt.maxHeight;

  shadow.style.position = 'fixed';
  shadow.style.top = '-10000px';
  shadow.style.left = '-10000px';
  shadow.style.width = width + "px";
  shadow.style.font = font;
  shadow.style.lineHeight = lineHeight;
  shadow.style.resize = 'none';
  shadow.style.wordWrap = 'break-word';
  var minHeight = height;
  var maxHeight = parseInt(maxHeightPx, 10);
  var lastWidth = width;
  var lastHeight = minHeight;
  var textLenght = 0;

  var update = function () {
    var width = textarea.clientWidth,
        text = textarea.value;
    var isMaximumHeightReached = lastHeight >= maxHeight;
    var isTextLengthOutdated = textLenght && textLenght < text.length;
    var wasWidthChanged = width !== lastWidth;

    if (isMaximumHeightReached && isTextLengthOutdated && !wasWidthChanged) {
      return true;
    }

    var shadowText = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n$/, '<br/>&nbsp;').replace(/\n/g, '<br/>').replace(/ {2,}/g, replaceWhitespaces);

    if (wasWidthChanged) {
      shadow.style.width = width + "px";
      lastWidth = width;
    }

    shadow.innerHTML = shadowText;
    var shadowHeight = Math.max(shadow.clientHeight + 1, minHeight) + 1;
    var height = Math.min(shadowHeight, maxHeight);

    if (height === lastHeight) {
      return true;
    }

    lastHeight = height;
    var overflow = height < maxHeight ? 'hidden' : '';

    if (height < maxHeight) {
      textLenght = text.length;
    }

    textarea.style.overflow = overflow;
    textarea.style.height = height + "px";
    callback && callback();
  };

  var updateThrottled = _.throttle(update, 300);

  var $textarea = $(textarea);
  $textarea.on('focus', update);
  $textarea.on('change input', updateThrottled);
  window.addEventListener('resize', updateThrottled, false);

  var destroy = function () {
    $textarea.off('focus', update);
    $textarea.off('change input', updateThrottled);
    window.removeEventListener('resize', updateThrottled);
  };

  update();
  return {
    update: update,
    destroy: destroy
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxFormatting.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxFormatting.js                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);
module.export({
  formattingButtons: function () {
    return formattingButtons;
  },
  applyFormatting: function () {
    return applyFormatting;
  }
});
var Markdown;
module.link("../../../markdown/client", {
  Markdown: function (v) {
    Markdown = v;
  }
}, 0);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);
var formattingButtons = [{
  label: 'bold',
  icon: 'bold',
  pattern: '*{{text}}*',
  command: 'b',
  condition: function () {
    return Markdown && settings.get('Markdown_Parser') === 'original';
  }
}, {
  label: 'bold',
  icon: 'bold',
  pattern: '**{{text}}**',
  command: 'b',
  condition: function () {
    return Markdown && settings.get('Markdown_Parser') === 'marked';
  }
}, {
  label: 'italic',
  icon: 'italic',
  pattern: '_{{text}}_',
  command: 'i',
  condition: function () {
    return Markdown && settings.get('Markdown_Parser') !== 'disabled';
  }
}, {
  label: 'strike',
  icon: 'strike',
  pattern: '~{{text}}~',
  condition: function () {
    return Markdown && settings.get('Markdown_Parser') === 'original';
  }
}, {
  label: 'strike',
  icon: 'strike',
  pattern: '~~{{text}}~~',
  condition: function () {
    return Markdown && settings.get('Markdown_Parser') === 'marked';
  }
}, {
  label: 'inline_code',
  icon: 'code',
  pattern: '`{{text}}`',
  condition: function () {
    return Markdown && settings.get('Markdown_Parser') !== 'disabled';
  }
}, {
  label: 'multi_line',
  icon: 'multiline',
  pattern: '```\n{{text}}\n``` ',
  condition: function () {
    return Markdown && settings.get('Markdown_Parser') !== 'disabled';
  }
}, {
  label: 'KaTeX',
  text: function () {
    if (!settings.get('Katex_Enabled')) {
      return;
    }

    if (settings.get('Katex_Dollar_Syntax')) {
      return '$$KaTeX$$';
    }

    if (settings.get('Katex_Parenthesis_Syntax')) {
      return '\\[KaTeX\\]';
    }
  },
  link: 'https://khan.github.io/KaTeX/function-support.html',
  condition: function () {
    return settings.get('Katex_Enabled');
  }
}];

function applyFormatting(pattern, input) {
  var _input$selectionEnd = input.selectionEnd,
      selectionEnd = _input$selectionEnd === void 0 ? input.value.length : _input$selectionEnd,
      _input$selectionStart = input.selectionStart,
      selectionStart = _input$selectionStart === void 0 ? 0 : _input$selectionStart;
  var initText = input.value.slice(0, selectionStart);
  var selectedText = input.value.slice(selectionStart, selectionEnd);
  var finalText = input.value.slice(selectionEnd, input.value.length);
  input.focus();
  var startPattern = pattern.substr(0, pattern.indexOf('{{text}}'));

  var startPatternFound = _toConsumableArray(startPattern).reverse().every(function (char, index) {
    return input.value.substr(selectionStart - index - 1, 1) === char;
  });

  if (startPatternFound) {
    var endPattern = pattern.substr(pattern.indexOf('{{text}}') + '{{text}}'.length);

    var endPatternFound = _toConsumableArray(endPattern).every(function (char, index) {
      return input.value.substr(selectionEnd + index, 1) === char;
    });

    if (endPatternFound) {
      input.selectionStart = selectionStart - startPattern.length;
      input.selectionEnd = selectionEnd + endPattern.length;

      if (!document.execCommand || !document.execCommand('insertText', false, selectedText)) {
        input.value = initText.substr(0, initText.length - startPattern.length) + selectedText + finalText.substr(endPattern.length);
      }

      input.selectionStart = selectionStart - startPattern.length;
      input.selectionEnd = input.selectionStart + selectedText.length;
      $(input).change();
      return;
    }
  }

  if (!document.execCommand || !document.execCommand('insertText', false, pattern.replace('{{text}}', selectedText))) {
    input.value = initText + pattern.replace('{{text}}', selectedText) + finalText;
  }

  input.selectionStart = selectionStart + pattern.indexOf('{{text}}');
  input.selectionEnd = input.selectionStart + selectedText.length;
  $(input).change();
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxNotSubscribed.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxNotSubscribed.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var RoomManager, RoomHistoryManager;
module.link("../../../ui-utils/client", {
  RoomManager: function (v) {
    RoomManager = v;
  },
  RoomHistoryManager: function (v) {
    RoomHistoryManager = v;
  }
}, 4);
var roomTypes;
module.link("../../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 5);
var hasAllPermission;
module.link("../../../authorization/client", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  }
}, 6);
module.link("./messageBoxNotSubscribed.html");
var call;
module.link("../../../../client/lib/utils/call", {
  call: function (v) {
    call = v;
  }
}, 7);
Template.messageBoxNotSubscribed.helpers({
  customTemplate: function () {
    return roomTypes.getNotSubscribedTpl(this.rid);
  },
  canJoinRoom: function () {
    return Meteor.userId() && roomTypes.verifyShowJoinLink(this.rid);
  },
  roomName: function () {
    var room = Session.get("roomData" + this.rid);
    return roomTypes.getRoomName(room.t, room);
  },
  isJoinCodeRequired: function () {
    var room = Session.get("roomData" + this.rid);
    return room && room.joinCodeRequired;
  },
  isAnonymousReadAllowed: function () {
    return Meteor.userId() == null && settings.get('Accounts_AllowAnonymousRead') === true;
  },
  isAnonymousWriteAllowed: function () {
    return Meteor.userId() == null && settings.get('Accounts_AllowAnonymousRead') === true && settings.get('Accounts_AllowAnonymousWrite') === true;
  }
});
Template.messageBoxNotSubscribed.events({
  'click .js-join-code': function () {
    function _callee(event) {
      var joinCodeInput, joinCode;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                event.stopPropagation();
                event.preventDefault();
                joinCodeInput = Template.instance().find('[name=joinCode]');
                joinCode = joinCodeInput && joinCodeInput.value;
                _context.next = 6;
                return _regeneratorRuntime.awrap(call('joinRoom', this.rid, joinCode));

              case 6:
                if (hasAllPermission('preview-c-room') === false && RoomHistoryManager.getRoom(this.rid).loaded === 0) {
                  RoomManager.getOpenedRoomByRid(this.rid).streamActive = false;
                  RoomManager.getOpenedRoomByRid(this.rid).ready = false;
                  RoomHistoryManager.getRoom(this.rid).loaded = null;
                  RoomManager.computation.invalidate();
                }

              case 7:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, this, null, Promise);
    }

    return _callee;
  }(),
  'click .js-register': function (event) {
    event.stopPropagation();
    event.preventDefault();
    Session.set('forceLogin', true);
  },
  'click .js-register-anonymous': function () {
    function _callee2(event) {
      var _await$call, token;

      return _regeneratorRuntime.async(function () {
        function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                event.stopPropagation();
                event.preventDefault();
                _context2.next = 4;
                return _regeneratorRuntime.awrap(call('registerUser', {}));

              case 4:
                _await$call = _context2.sent;
                token = _await$call.token;
                Meteor.loginWithToken(token);

              case 7:
              case "end":
                return _context2.stop();
            }
          }
        }

        return _callee2$;
      }(), null, null, null, Promise);
    }

    return _callee2;
  }()
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxReadOnly.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxReadOnly.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var roomTypes;
module.link("../../../utils", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 1);
module.link("./messageBoxReadOnly.html");
Template.messageBoxReadOnly.helpers({
  customTemplate: function () {
    return roomTypes.getReadOnlyTpl(this.rid);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBoxReplyPreview.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/messageBoxReplyPreview.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
module.link("./messageBoxReplyPreview.html");
Template.messageBoxReplyPreview.helpers({
  attachments: function () {
    var replyMessageData = this.replyMessageData;
    return [{
      text: replyMessageData.msg,
      author_name: replyMessageData.u.username
    }];
  }
});
Template.messageBoxReplyPreview.events({
  'click .cancel-reply': function (event) {
    event.preventDefault();
    event.stopPropagation();
    var mid = event.currentTarget.dataset.mid;
    var $input = $(this.input);
    this.input.focus();
    var messages = $input.data('reply') || [];
    var filtered = messages.filter(function (_ref) {
      var _id = _ref._id;
      return _id !== mid;
    });
    $input.data('reply', filtered).trigger('dataChange');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userActionIndicator.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageBox/userActionIndicator.ts                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var UserAction;
module.link("../../../ui", {
  UserAction: function (v) {
    UserAction = v;
  }
}, 1);
var t;
module.link("../../../utils/client", {
  t: function (v) {
    t = v;
  }
}, 2);
var getConfig;
module.link("../../../../client/lib/utils/getConfig", {
  getConfig: function (v) {
    getConfig = v;
  }
}, 3);
module.link("./userActionIndicator.html");
var maxUsernames = parseInt(getConfig('max-usernames-typing') || '2');
Template.userActionIndicator.helpers({
  data: function () {
    var roomAction = UserAction.get(this.tmid || this.rid) || {};

    if (!Object.keys(roomAction).length) {
      return [];
    }

    var activities = Object.entries(roomAction);
    var userActions = activities.map(function (_ref) {
      var _ref2 = _slicedToArray(_ref, 2),
          key = _ref2[0],
          _users = _ref2[1];

      var users = Object.keys(_users);

      if (users.length === 0) {
        return {
          end: false
        };
      }

      var action = key.split('-')[1];

      if (users.length === 1) {
        return {
          action: action,
          multi: false,
          users: users[0],
          end: false
        };
      }

      var last = users.pop();

      if (users.length >= maxUsernames) {
        last = t('others');
      }

      var usernames = [users.slice(0, maxUsernames - 1).join(', '), last];
      return {
        action: action,
        multi: true,
        users: usernames.join(" " + t('and') + " "),
        end: false
      };
    }).filter(function (i) {
      return i.action;
    });

    if (!Object.keys(userActions).length) {
      return [];
    } // insert end=true for the last item.


    userActions[userActions.length - 1].end = true;
    return userActions;
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"popup":{"messagePopup.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopup.html                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopup.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopup.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopup.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopup");
Template["messagePopup"] = new Template("Template.messagePopup", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isOpen"));
  }, function() {
    return [ "\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("sidebar"));
    }, function() {
      return [ "\n\t\t\t", HTML.UL({
        class: "rooms-list__list rooms-list__toolbar-search",
        style: function() {
          return [ "top: ", Spacebars.mustache(view.lookup("sidebarHeaderHeight")), "; height: calc(100vh - ", Spacebars.mustache(view.lookup("sidebarHeaderHeight")), "); width: ", Spacebars.mustache(view.lookup("sidebarWidth")) ];
        }
      }, "\n\t\t\t\t", Blaze.Each(function() {
        return Spacebars.call(view.lookup("data"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            template: Spacebars.call(Spacebars.dot(view.lookup(".."), "template")),
            data: Spacebars.call(view.lookup("toolbarData"))
          };
        }, function() {
          return Spacebars.include(function() {
            return Spacebars.call(Template.__dynamic);
          });
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\t\t" ];
    }, function() {
      return [ "\n\t\t\t", HTML.DIV({
        class: "message-popup-position"
      }, "\n\t\t\t\t", HTML.DIV({
        class: function() {
          return [ "message-popup content-background-color ", Spacebars.mustache(view.lookup("cls")) ];
        },
        id: "popup"
      }, "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("title"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "message-popup-title secondary-background-color border-component-color"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:title", function() {
          return Spacebars.mustache(view.lookup("title"));
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", HTML.DIV({
        class: "message-popup-items"
      }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return Spacebars.call(view.lookup("data"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", HTML.DIV({
          class: "popup-item",
          "data-id": function() {
            return Spacebars.mustache(view.lookup("_id"));
          }
        }, "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            template: Spacebars.call(Spacebars.dot(view.lookup(".."), "template"))
          };
        }, function() {
          return Spacebars.include(function() {
            return Spacebars.call(Template.__dynamic);
          });
        }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("data"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Blaze.Unless(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("isLoading"), "get"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("emptyTemplate"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
              return {
                template: Spacebars.call(view.lookup("emptyTemplate"))
              };
            }, function() {
              return Spacebars.include(function() {
                return Spacebars.call(Template.__dynamic);
              });
            }), "\n\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("isLoading"), "get"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupChannel.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupChannel.html                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupChannel.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupChannel.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupChannel.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupChannel");
Template["messagePopupChannel"] = new Template("Template.messagePopupChannel", (function() {
  var view = this;
  return [ Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call(view.lookup("channelIcon"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), "\n\t", Blaze.View("lookup:name", function() {
    return Spacebars.mustache(view.lookup("name"));
  }) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupConfig.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupConfig.html                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupConfig.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupConfig.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupConfig.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupConfig");
Template["messagePopupConfig"] = new Template("Template.messagePopupConfig", (function() {
  var view = this;
  return HTML.DIV({
    class: "message-popup-results"
  }, "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("popupUserConfig"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messagePopup"));
  }), "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("popupChannelConfig"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messagePopup"));
  }), "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("popupSlashCommandsConfig"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messagePopup"));
  }), "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("popupEmojiConfig"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messagePopup"));
  }), "\n\t\t", Blaze._TemplateWith(function() {
    return Spacebars.call(view.lookup("popupReactionEmojiConfig"));
  }, function() {
    return Spacebars.include(view.lookupTemplate("messagePopup"));
  }), "\n\n\t\t", Blaze.Each(function() {
    return Spacebars.call(view.lookup("customMessagePopups"));
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("getCustomConfig"));
    }, function() {
      return Spacebars.include(view.lookupTemplate("messagePopup"));
    }), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupEmoji.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupEmoji.html                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupEmoji.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupEmoji.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupEmoji.js                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupEmoji");
Template["messagePopupEmoji"] = new Template("Template.messagePopupEmoji", (function() {
  var view = this;
  return [ Blaze.View("lookup:renderEmoji", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("renderEmoji"), view.lookup("_id")));
  }), "\n\t", Blaze.View("lookup:_id", function() {
    return Spacebars.mustache(view.lookup("_id"));
  }) ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupSlashCommand.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupSlashCommand.html                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupSlashCommand.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupSlashCommand.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupSlashCommand.js                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupSlashCommand");
Template["messagePopupSlashCommand"] = new Template("Template.messagePopupSlashCommand", (function() {
  var view = this;
  return HTML.DIV({
    class: "popup-slash-command"
  }, "\n\t\t", HTML.DIV({
    class: "popup-slash-command-format"
  }, HTML.STRONG("/", Blaze.View("lookup:_id", function() {
    return Spacebars.mustache(view.lookup("_id"));
  })), Blaze.If(function() {
    return Spacebars.call(view.lookup("params"));
  }, function() {
    return [ " ", Blaze.View("lookup:params", function() {
      return Spacebars.mustache(view.lookup("params"));
    }) ];
  })), "\n\t\t", HTML.DIV({
    class: "popup-slash-command-description"
  }, Blaze.View("lookup:description", function() {
    return Spacebars.mustache(view.lookup("description"));
  })), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupSlashCommandPreview.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupSlashCommandPreview.html                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupSlashCommandPreview.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupSlashCommandPreview.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupSlashCommandPreview.js                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupSlashCommandPreview");
Template["messagePopupSlashCommandPreview"] = new Template("Template.messagePopupSlashCommandPreview", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isOpen"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "message-popup-position"
    }, "\n\t\t\t", HTML.DIV({
      class: function() {
        return [ "message-popup content-background-color ", Spacebars.mustache(view.lookup("cls")) ];
      }
    }, "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isLoading"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV({
        class: "message-popup-title secondary-background-color border-component-color"
      }, "\n\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Loading...");
      }), "\n\t\t\t\t\t\t", Spacebars.include(view.lookupTemplate("loading")), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t", Spacebars.With(function() {
        return Spacebars.call(view.lookup("preview"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV({
          class: "message-popup-title secondary-background-color border-component-color"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), view.lookup("i18nTitle"));
        }), " ", HTML.STRONG(Blaze.View("lookup:getArgs", function() {
          return Spacebars.mustache(view.lookup("getArgs"));
        })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t\t", HTML.DIV({
          class: "message-popup-items preview-items"
        }, "\n\t\t\t\t\t\t\t", Blaze.Each(function() {
          return Spacebars.call(view.lookup("items"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "popup-item",
            "data-id": function() {
              return Spacebars.mustache(view.lookup("id"));
            }
          }, "\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("isType"), "image", view.lookup("type"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.IMG({
              src: function() {
                return Spacebars.mustache(view.lookup("value"));
              },
              alt: function() {
                return Spacebars.mustache(view.lookup("value"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("isType"), "audio", view.lookup("type"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.AUDIO({
              controls: ""
            }, "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SOURCE({
              src: function() {
                return Spacebars.mustache(view.lookup("value"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t\t\tYour browser does not support the audio element.\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("isType"), "video", view.lookup("type"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.VIDEO({
              controls: "",
              class: "inline-video"
            }, "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.SOURCE({
              src: function() {
                return Spacebars.mustache(view.lookup("value"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t\t\tYour browser does not support the video element.\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("isType"), "text", view.lookup("type"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.H4(Blaze.View("lookup:value", function() {
              return Spacebars.mustache(view.lookup("value"));
            })), HTML.Raw(" <!-- Not sure what to do here -->\n\t\t\t\t\t\t\t\t\t") ];
          }), "\n\n\t\t\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("isType"), "other", view.lookup("type"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t\t\t", HTML.CODE(Blaze.View("lookup:value", function() {
              return Spacebars.mustache(view.lookup("value"));
            })), "\n\t\t\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t"), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupUser.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupUser.html                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupUser.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupUser.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/template.messagePopupUser.js                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupUser");
Template["messagePopupUser"] = new Template("Template.messagePopupUser", (function() {
  var view = this;
  return HTML.DIV({
    class: "popup-user",
    title: function() {
      return [ Blaze.If(function() {
        return Spacebars.call(view.lookup("outside"));
      }, function() {
        return Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Not_in_channel");
        });
      }), " ", Blaze.If(function() {
        return Spacebars.call(view.lookup("suggestion"));
      }, function() {
        return Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "Suggestion_from_recent_messages");
        });
      }) ];
    }
  }, "\n\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("system"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "popup-user-avatar_wrap"
    }, "\n\t\t\t", HTML.DIV({
      class: function() {
        return [ "popup-user-status border-transparent-dark popup-user-status-", Spacebars.mustache(view.lookup("status")) ];
      }
    }), "\n\t\t\t", HTML.DIV({
      class: "popup-user-avatar",
      style: function() {
        return [ "background-image:url(", Spacebars.mustache(view.lookup("avatarUrlFromUsername"), view.lookup("username"), view.lookup("avatarETag")), ");" ];
      }
    }), "\n\t\t"), "\n\t\t" ];
  }), "\n\t\t", HTML.DIV({
    class: "popup-user-name"
  }, "\n\t\t\t", HTML.STRONG(Blaze.View("lookup:username", function() {
    return Spacebars.mustache(view.lookup("username"));
  })), " ", Blaze.View("lookup:name", function() {
    return Spacebars.mustache(view.lookup("name"));
  }), Blaze.If(function() {
    return Spacebars.call(view.lookup("nickname"));
  }, function() {
    return [ " (", Blaze.View("lookup:nickname", function() {
      return Spacebars.mustache(view.lookup("nickname"));
    }), ")" ];
  }), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "popup-user-notice"
  }, "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("outside"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "popup-user-not_in_channel"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Not_in_channel");
    })), "\n\t\t\t" ];
  }), "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("suggestion"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.DIV({
      class: "popup-user-not_in_channel"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Suggestion_from_recent_messages");
    })), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"customMessagePopups.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/customMessagePopups.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);
module.export({
  customMessagePopups: function () {
    return customMessagePopups;
  },
  addMessagePopup: function () {
    return addMessagePopup;
  },
  removeMessagePopup: function () {
    return removeMessagePopup;
  }
});
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var customMessagePopups = new ReactiveVar([]);

var nonReactiveGetFunc = function () {
  return Tracker.nonreactive(function () {
    return customMessagePopups.get();
  });
};

var addMessagePopup = function (configGetter, name) {
  customMessagePopups.set([].concat(_toConsumableArray(nonReactiveGetFunc()), [{
    configGetter: configGetter,
    name: name
  }]));
};

var removeMessagePopup = function (popupName) {
  var customMessagePopupsList = nonReactiveGetFunc();
  var element = customMessagePopupsList.findIndex(function (_ref) {
    var name = _ref.name;
    return name === popupName;
  });

  if (element < 0) {
    return;
  }

  var listWithRemovedElement = [].concat(_toConsumableArray(customMessagePopupsList.slice(0, element)), _toConsumableArray(customMessagePopupsList.slice(element + 1, customMessagePopupsList.length)));
  customMessagePopups.set(_toConsumableArray(listWithRemovedElement));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopup.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 3);
module.link("./messagePopup.html");
var keys = {
  TAB: 9,
  ENTER: 13,
  ESC: 27,
  ARROW_LEFT: 37,
  ARROW_UP: 38,
  ARROW_RIGHT: 39,
  ARROW_DOWN: 40
};

function getCursorPosition(input) {
  if (input == null) {
    return;
  }

  if (input.selectionStart != null) {
    return input.selectionStart;
  }

  if (document.selection != null) {
    input.focus();
    var sel = document.selection.createRange();
    var selLen = document.selection.createRange().text.length;
    sel.moveStart('character', -input.value.length);
    return sel.text.length - selLen;
  }
}

function setCursorPosition(input, caretPos) {
  if (input == null) {
    return;
  }

  if (input.selectionStart != null) {
    input.focus();
    return input.setSelectionRange(caretPos, caretPos);
  }

  if (document.selection != null) {
    var range = input.createTextRange();
    range.move('character', caretPos);
    return range.select();
  }
}

function val(v, d) {
  if (v != null) {
    return v;
  }

  return d;
}

Template.messagePopup.onCreated(function () {
  var template = this;
  template.textFilter = new ReactiveVar('');
  template.textFilterDelay = val(template.data.textFilterDelay, 0);
  template.open = val(template.data.open, new ReactiveVar(false));
  template.hasData = new ReactiveVar(false);
  template.value = new ReactiveVar();
  template.trigger = val(template.data.trigger, '');
  template.triggerAnywhere = val(template.data.triggerAnywhere, true);
  template.closeOnEsc = val(template.data.closeOnEsc, true);
  template.blurOnSelectItem = val(template.data.blurOnSelectItem, false);
  template.prefix = val(template.data.prefix, template.trigger);
  template.suffix = val(template.data.suffix, '');

  if (template.triggerAnywhere === true) {
    template.matchSelectorRegex = val(template.data.matchSelectorRegex, new RegExp("(?:^| |\n)" + template.trigger + "[^\\s]*$"));
  } else {
    template.matchSelectorRegex = val(template.data.matchSelectorRegex, new RegExp("(?:^)" + template.trigger + "[^\\s]*$"));
  }

  template.selectorRegex = val(template.data.selectorRegex, new RegExp(template.trigger + "([^\\s]*)$"));
  template.replaceRegex = val(template.data.replaceRegex, new RegExp(template.trigger + "[^\\s]*$"));
  template.getValue = val(template.data.getValue, function (_id) {
    return _id;
  });

  template.up = function () {
    var current = template.find('.popup-item.selected');
    var previous = $(current).prev('.popup-item')[0] || template.find('.popup-item:last-child');

    if (previous != null) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
      previous.className += ' selected sidebar-item__popup-active';
      previous.scrollIntoView(false);
      return template.value.set(previous.getAttribute('data-id'));
    }
  };

  template.down = function () {
    var current = template.find('.popup-item.selected');
    var next = $(current).next('.popup-item')[0] || template.find('.popup-item');

    if (next && next.classList.contains('popup-item')) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
      next.className += ' selected sidebar-item__popup-active';
      next.scrollIntoView(false);
      return template.value.set(next.getAttribute('data-id'));
    }
  };

  template.verifySelection = function () {
    if (!template.open.curValue) {
      return;
    }

    var current = template.find('.popup-item.selected');

    if (current == null) {
      var first = template.find('.popup-item');

      if (first != null) {
        first.className += ' selected sidebar-item__popup-active';
        return template.value.set(first.getAttribute('data-id'));
      }

      return template.value.set(null);
    }
  };

  template.onInputKeydown = function (event) {
    if (template.open.curValue !== true || template.hasData.curValue !== true) {
      return;
    }

    if (event.which === keys.ENTER || event.which === keys.TAB) {
      if (template.blurOnSelectItem === true) {
        template.input.blur();
      } else {
        template.open.set(false);
      }

      template.enterValue();

      if (template.data.cleanOnEnter) {
        template.input.value = '';
      }

      event.preventDefault();
      event.stopPropagation();
      return;
    }

    if (event.which === keys.ARROW_UP) {
      template.up();
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    if (event.which === keys.ARROW_DOWN) {
      template.down();
      event.preventDefault();
      event.stopPropagation();
    }
  };

  template.setTextFilter = _.debounce(function (value) {
    return template.textFilter.set(value);
  }, template.textFilterDelay);

  template.onInputKeyup = function (event) {
    if (template.closeOnEsc === true && template.open.curValue === true && event.which === keys.ESC) {
      template.open.set(false);
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    var value = template.input.value.substr(0, getCursorPosition(template.input));

    if (template.matchSelectorRegex.test(value)) {
      template.setTextFilter(value.match(template.selectorRegex)[1]);
      template.open.set(true);
    } else {
      template.open.set(false);
    }

    if (template.open.curValue !== true) {
      return;
    }

    if (event.which !== keys.ARROW_UP && event.which !== keys.ARROW_DOWN) {
      return Meteor.defer(function () {
        template.verifySelection();
      });
    }
  };

  template.onFocus = function () {
    template.clickingItem = false;

    if (template.open.curValue === true) {
      return;
    }

    var value = template.input.value.substr(0, getCursorPosition(template.input));

    if (template.matchSelectorRegex.test(value)) {
      template.setTextFilter(value.match(template.selectorRegex)[1]);
      template.open.set(true);
      return Meteor.defer(function () {
        return template.verifySelection();
      });
    }

    return template.open.set(false);
  };

  template.onBlur = function () {
    if (template.open.curValue === false) {
      return;
    }

    if (template.clickingItem === true) {
      return;
    }

    return template.open.set(false);
  };

  template.enterValue = function () {
    if (template.value.curValue == null) {
      return;
    }

    var value = template.input.value;
    var caret = getCursorPosition(template.input);
    var firstPartValue = value.substr(0, caret);
    var lastPartValue = value.substr(caret);
    var getValue = this.getValue(template.value.curValue, template.data.collection, template.records.get(), firstPartValue);

    if (!getValue) {
      return;
    }

    firstPartValue = firstPartValue.replace(template.selectorRegex, template.prefix + getValue + template.suffix);
    template.input.value = firstPartValue + lastPartValue;
    return setCursorPosition(template.input, firstPartValue.length);
  };

  template.records = new ReactiveVar([]);
  template.autorun(function () {
    var filter = template.textFilter.get();

    if (filter != null) {
      var filterCallback = function (result) {
        template.hasData.set(result && result.length > 0);
        template.records.set(result);
        return Meteor.defer(function () {
          return template.verifySelection();
        });
      };

      var result = template.data.getFilter(template.data.collection, filter, filterCallback);

      if (result != null) {
        return filterCallback(result);
      }
    }
  });
});
Template.messagePopup.onRendered(function () {
  if (this.data.getInput != null) {
    this.input = typeof this.data.getInput === 'function' && this.data.getInput();
  } else if (this.data.input) {
    this.input = this.parentTemplate().find(this.data.input);
  }

  if (this.input == null) {
    console.error('Input not found for popup');
  }

  var self = this;
  self.autorun(function () {
    var open = self.open.get();

    if ($('.reply-preview').length) {
      if (open === true) {
        $('.reply-preview').addClass('reply-preview-with-popup');
        setTimeout(function () {
          $('#popup').addClass('popup-with-reply-preview');
        }, 50);
      }
    }

    if (open === false) {
      $('.reply-preview').removeClass('reply-preview-with-popup');
      $('#popup').removeClass('popup-with-reply-preview');
    }
  });
  $(this.input).on('keyup', this.onInputKeyup.bind(this));
  $(this.input).on('keydown', this.onInputKeydown.bind(this));
  $(this.input).on('focus', this.onFocus.bind(this));
  $(this.input).on('blur', this.onBlur.bind(this));
});
Template.messagePopup.onDestroyed(function () {
  $(this.input).off('keyup', this.onInputKeyup);
  $(this.input).off('keydown', this.onInputKeydown);
  $(this.input).off('focus', this.onFocus);
  $(this.input).off('blur', this.onBlur);
});
Template.messagePopup.events({
  'mouseenter .popup-item': function (e) {
    if (e.currentTarget.className.indexOf('selected') > -1) {
      return;
    }

    var template = Template.instance();
    var current = template.find('.popup-item.selected');

    if (current != null) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
    }

    e.currentTarget.className += ' selected sidebar-item__popup-active';
    return template.value.set(this._id);
  },
  'mousedown .popup-item, touchstart .popup-item': function () {
    var template = Template.instance();
    template.clickingItem = true;
  },
  'mouseup .popup-item, touchend .popup-item': function (e) {
    e.stopPropagation();
    var template = Template.instance();
    var wasMenuIconClicked = e.target.classList.contains('sidebar-item__menu-icon');
    template.clickingItem = false;

    if (!wasMenuIconClicked) {
      template.value.set(this._id);
      template.enterValue();
      template.open.set(false);
    }
  }
});
Template.messagePopup.helpers({
  isOpen: function () {
    return Template.instance().open.get() && (Template.instance().hasData.get() || Template.instance().data.emptyTemplate != null || !Template.instance().parentTemplate(1).subscriptionsReady());
  },
  data: function () {
    var template = Template.instance();
    return Object.assign(template.records.get(), {
      toolbar: true
    });
  },
  toolbarData: function () {
    return _objectSpread(_objectSpread({}, Template.currentData()), {}, {
      toolbar: true
    });
  },
  sidebarHeaderHeight: function () {
    return document.querySelector('.sidebar__header').offsetHeight + "px";
  },
  sidebarWidth: function () {
    return document.querySelector('.sidebar').offsetWidth + "px";
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupChannel.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupChannel.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var roomTypes;
module.link("../../../utils", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 1);
module.link("./messagePopupChannel.html");
Template.messagePopupChannel.helpers({
  channelIcon: function () {
    return roomTypes.getIcon(this);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupConfig.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupConfig.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 2);
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 3);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 4);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 5);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 6);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 7);
var escapeRegExp;
module.link("@rocket.chat/string-helpers", {
  escapeRegExp: function (v) {
    escapeRegExp = v;
  }
}, 8);
var Messages, Subscriptions;
module.link("../../../models/client", {
  Messages: function (v) {
    Messages = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 9);
var settings;
module.link("../../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 10);
var hasAllPermission, hasAtLeastOnePermission;
module.link("../../../authorization/client", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  },
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 11);
var EmojiPicker, emoji;
module.link("../../../emoji", {
  EmojiPicker: function (v) {
    EmojiPicker = v;
  },
  emoji: function (v) {
    emoji = v;
  }
}, 12);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 13);
var t, getUserPreference, slashCommands;
module.link("../../../utils/client", {
  t: function (v) {
    t = v;
  },
  getUserPreference: function (v) {
    getUserPreference = v;
  },
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 14);
var customMessagePopups;
module.link("./customMessagePopups", {
  customMessagePopups: function (v) {
    customMessagePopups = v;
  }
}, 15);
module.link("./messagePopupConfig.html");
module.link("./messagePopupSlashCommand.html");
module.link("./messagePopupUser.html");

var reloadUsersFromRoomMessages = function (rid, template) {
  var user = Meteor.userId() && Meteor.users.findOne(Meteor.userId(), {
    fields: {
      username: 1
    }
  });

  if (!rid || !user) {
    return;
  }

  template.usersFromRoomMessages.remove({});
  var uniqueMessageUsersControl = {};
  Messages.find({
    rid: rid,
    'u.username': {
      $ne: user.username
    },
    't': {
      $exists: false
    }
  }, {
    fields: {
      'u.username': 1,
      'u.name': 1,
      'ts': 1
    },
    sort: {
      ts: -1
    }
  }).fetch().filter(function (_ref) {
    var username = _ref.u.username;
    var notMapped = !uniqueMessageUsersControl[username];
    uniqueMessageUsersControl[username] = true;
    return notMapped;
  }).forEach(function (_ref2) {
    var _ref2$u = _ref2.u,
        username = _ref2$u.username,
        name = _ref2$u.name,
        ts = _ref2.ts;
    return template.usersFromRoomMessages.upsert(username, {
      _id: username,
      username: username,
      name: name,
      status: Tracker.nonreactive(function () {
        return Session.get("user_" + username + "_status") || 'offline';
      }),
      ts: ts
    });
  });
};

var fetchUsersFromServer = _.throttle(function () {
  function _callee(filterText, records, rid, cb) {
    var usernames, _await$callWithErrorH, users;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              usernames = records.map(function (_ref3) {
                var username = _ref3.username;
                return username;
              });
              _context.next = 3;
              return _regeneratorRuntime.awrap(callWithErrorHandling('spotlight', filterText, usernames, {
                users: true,
                mentions: true
              }, rid));

            case 3:
              _await$callWithErrorH = _context.sent;
              users = _await$callWithErrorH.users;

              if (!(!users || users.length <= 0)) {
                _context.next = 7;
                break;
              }

              return _context.abrupt("return");

            case 7:
              users // .slice(0, 5)
              .forEach(function (_ref4) {
                var username = _ref4.username,
                    nickname = _ref4.nickname,
                    name = _ref4.name,
                    status = _ref4.status,
                    avatarETag = _ref4.avatarETag,
                    outside = _ref4.outside;
                // if (records.length < 5) {
                records.push({
                  _id: username,
                  username: username,
                  nickname: nickname,
                  name: name,
                  status: status,
                  avatarETag: avatarETag,
                  outside: outside,
                  sort: 3
                }); // }
              });
              records.sort(function (_ref5, _ref6) {
                var sortA = _ref5.sort;
                var sortB = _ref6.sort;
                return sortA - sortB;
              });
              cb && cb(records);

            case 10:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}(), 1000);

var fetchRoomsFromServer = _.throttle(function () {
  function _callee2(filterText, records, rid, cb) {
    var _await$callWithErrorH2, rooms;

    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              if (hasAllPermission('view-outside-room')) {
                _context2.next = 3;
                break;
              }

              cb && cb([]);
              return _context2.abrupt("return");

            case 3:
              _context2.next = 5;
              return _regeneratorRuntime.awrap(callWithErrorHandling('spotlight', filterText, null, {
                rooms: true,
                mentions: true
              }, rid));

            case 5:
              _await$callWithErrorH2 = _context2.sent;
              rooms = _await$callWithErrorH2.rooms;

              if (!(!rooms || rooms.length <= 0)) {
                _context2.next = 9;
                break;
              }

              return _context2.abrupt("return");

            case 9:
              rooms.slice(0, 5).forEach(function (room) {
                if (records.length < 5) {
                  records.push(room);
                }
              });
              cb && cb(records);

            case 11:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}(), 1000);

var emojiSort = function (recents) {
  return function (a, b) {
    var idA = a._id;
    var idB = a._id;

    if (recents.includes(a._id)) {
      idA = recents.indexOf(a._id) + idA;
    }

    if (recents.includes(b._id)) {
      idB = recents.indexOf(b._id) + idB;
    }

    if (idA < idB) {
      return -1;
    }

    if (idA > idB) {
      return 1;
    }

    return 0;
  };
};

var exactFinalTone = new RegExp('^tone[1-5]:*$');
var colorBlind = new RegExp('tone[1-5]:*$');
var seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');

var getEmojis = function (collection, filter) {
  var key = ":" + filter;

  if (!getUserPreference(Meteor.userId(), 'useEmojis')) {
    return [];
  }

  if (!emoji.packages.emojione || emoji.packages.emojione.asciiList[key]) {
    return [];
  }

  var regExp = new RegExp(escapeRegExp(filter), 'i');
  var recents = EmojiPicker.getRecent().map(function (item) {
    return ":" + item + ":";
  });
  return Object.keys(collection).map(function (_id) {
    var data = collection[key];
    return {
      _id: _id,
      data: data
    };
  }).filter(function (_ref7) {
    var _id = _ref7._id;
    return regExp.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id));
  }).sort(emojiSort(recents)).slice(0, 10);
};

var addEmojiToRecents = function (emoji) {
  var pickerEl = document.querySelector('.emoji-picker');

  if (!pickerEl) {
    return;
  }

  var view = Blaze.getView(pickerEl);

  if (!view) {
    return;
  }

  Template._withTemplateInstanceFunc(view.templateInstance, function () {
    EmojiPicker.addRecent(emoji.replace(/:/g, ''));
  });
};

Template.messagePopupConfig.onCreated(function () {
  var _this = this;

  this.usersFromRoomMessages = new Mongo.Collection(null);
  this.autorun(function () {
    var rid = _this.data.rid;
    reloadUsersFromRoomMessages(rid, _this);
  });
});
Template.messagePopupConfig.helpers({
  customMessagePopups: function () {
    return customMessagePopups.get();
  },
  getCustomConfig: function () {
    var template = Template.instance();
    return this.configGetter(template);
  },
  popupUserConfig: function () {
    var _this2 = this;

    var template = Template.instance();
    var suggestionsCount = settings.get('Number_of_users_autocomplete_suggestions');
    return {
      title: t('People'),
      collection: template.usersFromRoomMessages,
      template: 'messagePopupUser',
      rid: this.rid,
      getInput: this.getInput,
      textFilterDelay: 500,
      trigger: '@',
      suffix: ' ',
      getFilter: function (collection) {
        var filter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
        var cb = arguments.length > 2 ? arguments[2] : undefined;
        var rid = _this2.rid;
        var filterText = filter.trim();
        var filterRegex = filterText !== '' && new RegExp("" + escapeRegExp(filterText), 'i');
        var items = template.usersFromRoomMessages.find(_objectSpread({
          ts: {
            $exists: true
          }
        }, filterText && {
          $or: [{
            username: filterRegex
          }, {
            name: filterRegex
          }]
        }), {
          limit: filterText ? 2 : suggestionsCount,
          sort: {
            ts: -1
          }
        }).fetch().map(function (u) {
          u.suggestion = true;
          return u;
        }); // // If needed, add to list the online users
        // if (items.length < 5 && filterRegex) {
        // 	const usernamesAlreadyFetched = items.map(({ username }) => username);
        // 	if (!hasAllPermission('view-outside-room')) {
        // 		const usernamesFromDMs = Subscriptions
        // 			.find(
        // 				{
        // 					t: 'd',
        // 					$and: [
        // 						{
        // 							...filterRegex && {
        // 								$or: [
        // 									{ name: filterRegex },
        // 									{ fname: filterRegex },
        // 								],
        // 							},
        // 						},
        // 						{
        // 							name: { $nin: usernamesAlreadyFetched },
        // 						},
        // 					],
        // 				},
        // 				{
        // 					fields: { name: 1 },
        // 				},
        // 			)
        // 			.map(({ name }) => name);
        // 		const newItems = Users
        // 			.find(
        // 				{
        // 					username: {
        // 						$in: usernamesFromDMs,
        // 					},
        // 				},
        // 				{
        // 					fields: {
        // 						username: 1,
        // 						nickname: 1,
        // 						name: 1,
        // 						status: 1,
        // 					},
        // 					limit: 5 - usernamesAlreadyFetched.length,
        // 				},
        // 			)
        // 			.fetch()
        // 			.map(({ username, name, status, nickname }) => ({
        // 				_id: username,
        // 				username,
        // 				nickname,
        // 				name,
        // 				status,
        // 				sort: 1,
        // 			}));
        // 		items.push(...newItems);
        // 	} else {
        // 		const user = Meteor.users.findOne(Meteor.userId(), { fields: { username: 1 } });
        // 		const newItems = Meteor.users.find({
        // 			$and: [
        // 				{
        // 					...filterRegex && {
        // 						$or: [
        // 							{ username: filterRegex },
        // 							{ name: filterRegex },
        // 						],
        // 					},
        // 				},
        // 				{
        // 					username: {
        // 						$nin: [
        // 							user && user.username,
        // 							...usernamesAlreadyFetched,
        // 						],
        // 					},
        // 				},
        // 			],
        // 		},
        // 		{
        // 			fields: {
        // 				username: 1,
        // 				nickname: 1,
        // 				name: 1,
        // 				status: 1,
        // 			},
        // 			limit: 5 - usernamesAlreadyFetched.length,
        // 		})
        // 			.fetch()
        // 			.map(({ username, name, status, nickname }) => ({
        // 				_id: username,
        // 				username,
        // 				nickname,
        // 				name,
        // 				status,
        // 				sort: 1,
        // 			}));
        // 		items.push(...newItems);
        // 	}
        // }
        // Get users from Server

        if (items.length < suggestionsCount && filterText !== '') {
          fetchUsersFromServer(filterText, items, rid, cb);
        }

        if (!filterRegex || filterRegex.test('all')) {
          items.push({
            _id: 'all',
            username: 'all',
            system: true,
            name: t('Notify_all_in_this_room'),
            sort: 4
          });
        }

        if (!filterRegex || filterRegex.test('here')) {
          items.push({
            _id: 'here',
            username: 'here',
            system: true,
            name: t('Notify_active_in_this_room'),
            sort: 4
          });
        }

        return items;
      },
      getValue: function (_id) {
        return _id;
      }
    };
  },
  popupChannelConfig: function () {
    var _this3 = this;

    return {
      title: t('Channels'),
      collection: Subscriptions,
      trigger: '#',
      suffix: ' ',
      textFilterDelay: 500,
      template: 'messagePopupChannel',
      rid: this.rid,
      getInput: this.getInput,
      getFilter: function (collection, filter, cb) {
        var rid = _this3.rid;
        var exp = new RegExp(filter, 'i');
        var records = collection.find({
          name: exp,
          t: {
            $in: ['c', 'p']
          }
        }, {
          reactive: 1,
          limit: 5,
          sort: {
            ls: -1
          }
        }).fetch();

        if (records.length < 5 && filter && filter.trim() !== '') {
          fetchRoomsFromServer(filter, records, rid, cb);
        }

        return records;
      },
      getValue: function (_id, collection, records) {
        var record = _.findWhere(records, {
          _id: _id
        });

        return record && record.name;
      }
    };
  },
  popupSlashCommandsConfig: function () {
    var _this4 = this;

    return {
      title: t('Commands'),
      collection: slashCommands.commands,
      trigger: '/',
      suffix: ' ',
      triggerAnywhere: false,
      template: 'messagePopupSlashCommand',
      rid: this.rid,
      getInput: this.getInput,
      getFilter: function (collection, filter) {
        var rid = _this4.rid;
        return Object.keys(collection).map(function (command) {
          var item = collection[command];
          return {
            _id: command,
            params: item.params ? TAPi18n.__(item.params) : '',
            description: TAPi18n.__(item.description),
            permission: item.permission
          };
        }).filter(function (command) {
          var isMatch = command._id.indexOf(filter) > -1;

          if (!isMatch) {
            return false;
          }

          if (!command.permission) {
            return true;
          }

          return hasAtLeastOnePermission(command.permission, rid);
        }).sort(function (a, b) {
          return a._id > b._id;
        }).slice(0, 11);
      }
    };
  },
  popupEmojiConfig: function () {
    return {
      title: t('Emoji'),
      collection: emoji.list,
      template: 'messagePopupEmoji',
      trigger: ':',
      prefix: '',
      suffix: ' ',
      rid: this.rid,
      getInput: this.getInput,
      getFilter: getEmojis,
      getValue: function (emojiText) {
        addEmojiToRecents(emojiText);
        return emojiText;
      }
    };
  },
  popupReactionEmojiConfig: function () {
    return {
      title: t('Emoji'),
      collection: emoji.list,
      template: 'messagePopupEmoji',
      trigger: '\\+:',
      prefix: '+',
      suffix: ' ',
      rid: this.rid,
      getInput: this.getInput,
      getFilter: getEmojis,
      getValue: function (emojiText) {
        addEmojiToRecents(emojiText);
        return emojiText;
      }
    };
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupEmoji.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupEmoji.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
module.link("./messagePopupEmoji.html");
Template.messagePopupEmoji.helpers({
  value: function () {
    var length = this.data.length;
    return this.data[length - 1];
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messagePopupSlashCommandPreview.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/popup/messagePopupSlashCommandPreview.js                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 3);
var slashCommands;
module.link("../../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 4);
var hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 5);
module.link("./messagePopupSlashCommandPreview.html");
var keys = {
  TAB: 9,
  ENTER: 13,
  ESC: 27,
  ARROW_LEFT: 37,
  ARROW_UP: 38,
  ARROW_RIGHT: 39,
  ARROW_DOWN: 40
};

function getCursorPosition(input) {
  if (!input) {
    return;
  }

  if (input.selectionStart) {
    return input.selectionStart;
  }

  if (document.selection) {
    input.focus();
    var sel = document.selection.createRange();
    var selLen = document.selection.createRange().text.length;
    sel.moveStart('character', -input.value.length);
    return sel.text.length - selLen;
  }
}

Template.messagePopupSlashCommandPreview.onCreated(function () {
  this.open = new ReactiveVar(false);
  this.isLoading = new ReactiveVar(true);
  this.preview = new ReactiveVar();
  this.selectedItem = new ReactiveVar();
  this.commandName = new ReactiveVar('');
  this.commandArgs = new ReactiveVar(''); // regex ensures a command is entered into the input
  // such as "/testing " before continuing

  this.matchSelectorRegex = /(?:^)(\/[\w\d\S]+ )[^]*$/;
  this.selectorRegex = /(\/[\w\d\S]+ )([^]*)$/;
  this.replaceRegex = /(\/[\w\d\S]+ )[^]*$/; // WHAT'S THIS

  this.dragging = false;
  var template = this;
  template.fetchPreviews = _.debounce(function () {
    function _previewFetcher(cmd, args) {
      var command = cmd;
      var params = args;
      var _template$data = template.data,
          rid = _template$data.rid,
          tmid = _template$data.tmid;
      Meteor.call('getSlashCommandPreviews', {
        cmd: cmd,
        params: params,
        msg: {
          rid: rid,
          tmid: tmid
        }
      }, function (err, preview) {
        if (err) {
          return;
        }

        if (!preview || !Array.isArray(preview.items)) {
          template.preview.set({
            i18nTitle: 'No_results_found_for',
            items: []
          });
        } else {
          template.preview.set(preview);
        }

        template.commandName.set(command);
        template.commandArgs.set(params);
        template.isLoading.set(false);
        Meteor.defer(function () {
          template.verifySelection();
        });
      });
    }

    return _previewFetcher;
  }(), 500);

  template.enterKeyAction = function () {
    var current = template.find('.popup-item.selected');

    if (!current) {
      return;
    }

    var selectedId = current.getAttribute('data-id');

    if (!selectedId) {
      return;
    }

    var cmd = template.commandName.curValue;
    var params = template.commandArgs.curValue;

    if (!cmd || !params) {
      return;
    }

    var item = template.preview.curValue.items.find(function (i) {
      return i.id === selectedId;
    });

    if (!item) {
      return;
    }

    var _template$data2 = template.data,
        rid = _template$data2.rid,
        tmid = _template$data2.tmid;
    Meteor.call('executeSlashCommandPreview', {
      cmd: cmd,
      params: params,
      msg: {
        rid: rid,
        tmid: tmid
      }
    }, item, function (err) {
      if (err) {
        console.warn(err);
      }
    });
    template.open.set(false);
    template.inputBox.value = '';
    template.preview.set();
    template.commandName.set('');
    template.commandArgs.set('');
  };

  template.selectionLogic = function () {
    var inputValueAtCursor = template.inputBox.value.substr(0, getCursorPosition(template.inputBox));

    if (!template.matchSelectorRegex.test(inputValueAtCursor)) {
      template.open.set(false);
      return;
    }

    var matches = inputValueAtCursor.match(template.selectorRegex);
    var cmd = matches[1].replace('/', '').trim().toLowerCase();
    var command = slashCommands.commands[cmd]; // Ensure the command they're typing actually exists
    // And it provides a command preview
    // And if it provides a permission to check, they have permission to run the command

    var rid = template.data.rid;

    if (!command || !command.providesPreview || command.permission && !hasAtLeastOnePermission(command.permission, rid)) {
      template.open.set(false);
      return;
    }

    var args = matches[2]; // Check to verify there are no additional arguments passed,
    // Because we we don't care about what it if there isn't

    if (!args) {
      template.open.set(false);
      return;
    } // If they haven't changed a thing, show what we already got


    if (template.commandName.curValue === cmd && template.commandArgs.curValue === args && template.preview.curValue) {
      template.isLoading.set(false);
      template.open.set(true);
      return;
    }

    template.isLoading.set(true);
    template.open.set(true); // Fetch and display them

    template.fetchPreviews(cmd, args);
  };

  template.verifySelection = function () {
    var current = template.find('.popup-item.selected');

    if (!current) {
      var first = template.find('.popup-item');

      if (first) {
        first.className += ' selected sidebar-item__popup-active';
      }
    }
  }; // Typing data


  template.onInputKeyup = function (event) {
    if (template.open.curValue === true && event.which === keys.ESC) {
      template.open.set(false);
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    if (event.which === keys.ARROW_UP || event.which === keys.ARROW_DOWN) {
      // Arrow up and down are for navigating the choices
      return;
    }

    template.selectionLogic();
  }; // Using the keyboard to navigate the options


  template.onInputKeydown = function (event) {
    if (!template.open.curValue || template.isLoading.curValue) {
      return;
    }

    if (event.which === keys.ENTER) {
      // || event.which === keys.TAB) { <-- does using tab to select make sense?
      template.enterKeyAction();
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    if (event.which === keys.ARROW_UP) {
      template.up();
      event.preventDefault();
      event.stopPropagation();
      return;
    }

    if (event.which === keys.ARROW_DOWN) {
      template.down();
      event.preventDefault();
      event.stopPropagation();
    }
  };

  template.up = function () {
    var current = template.find('.popup-item.selected');
    var previous = $(current).prev('.popup-item')[0] || template.find('.popup-item:last-child');

    if (previous != null) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
      previous.className += ' selected sidebar-item__popup-active';
    }
  };

  template.down = function () {
    var current = template.find('.popup-item.selected');
    var next = $(current).next('.popup-item')[0] || template.find('.popup-item');

    if (next && next.classList.contains('popup-item')) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
      next.className += ' selected sidebar-item__popup-active';
    }
  };

  template.onFocus = function () {
    template.clickingItem = false;

    if (template.open.curValue) {
      return;
    }

    template.selectionLogic();
  };

  template.onBlur = function () {
    if (template.clickingItem) {
      return;
    }

    return template.open.set(false);
  };
});
Template.messagePopupSlashCommandPreview.onRendered(function () {
  function _messagePopupSlashCommandPreviewRendered() {
    if (!this.data.getInput) {
      throw Error('Somethign wrong happened.');
    }

    this.inputBox = this.data.getInput();
    $(this.inputBox).on('keyup', this.onInputKeyup.bind(this));
    $(this.inputBox).on('keydown', this.onInputKeydown.bind(this));
    $(this.inputBox).on('focus', this.onFocus.bind(this));
    $(this.inputBox).on('blur', this.onBlur.bind(this));
    var self = this;
    self.autorun(function () {
      setTimeout(self.selectionLogic, 500);
    });
  }

  return _messagePopupSlashCommandPreviewRendered;
}());
Template.messagePopupSlashCommandPreview.onDestroyed(function () {
  $(this.inputBox).off('keyup', this.onInputKeyup);
  $(this.inputBox).off('keydown', this.onInputKeydown);
  $(this.inputBox).off('focus', this.onFocus);
  $(this.inputBox).off('blur', this.onBlur);
});
Template.messagePopupSlashCommandPreview.events({
  'mouseenter .popup-item, mousedown .popup-item, touchstart .popup-item': function (e) {
    if (e.currentTarget.className.includes('selected')) {
      return;
    }

    var template = Template.instance();
    var current = template.find('.popup-item.selected');

    if (current) {
      current.className = current.className.replace(/\sselected/, '').replace('sidebar-item__popup-active', '');
    }

    e.currentTarget.className += ' selected sidebar-item__popup-active';
  },
  'mousedown .popup-item, touchstart .popup-item': function () {
    var template = Template.instance();
    template.clickingItem = true;
  },
  'mouseup .popup-item, touchend .popup-item': function () {
    var template = Template.instance();

    if (template.dragging) {
      template.dragging = false;
      return;
    }

    template.clickingItem = false;
    template.enterKeyAction();
  },
  'touchmove .popup-item': function (e) {
    e.stopPropagation();
    var template = Template.instance();
    template.dragging = true;
  }
});
Template.messagePopupSlashCommandPreview.helpers({
  isOpen: function () {
    return Template.instance().open.get(); // && ((Template.instance().hasData.get() || (Template.instance().data.emptyTemplate != null)) || !Template.instance().parentTemplate(1).subscriptionsReady());
  },
  getArgs: function () {
    return Template.instance().commandArgs.get();
  },
  isLoading: function () {
    return Template.instance().isLoading.get();
  },
  isType: function (actual, expected) {
    return actual === expected;
  },
  preview: function () {
    return Template.instance().preview.get();
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"message.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/message.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.message.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.message.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/template.message.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("message");
Template["message"] = new Template("Template.message", (function() {
  var view = this;
  return HTML.LI({
    id: function() {
      return [ Spacebars.mustache(view.lookup("templatePrefix")), Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "_id")) ];
    },
    "data-id": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "_id"));
    },
    "data-context": function() {
      return Spacebars.mustache(view.lookup("actionContext"));
    },
    class: function() {
      return [ "message ", Spacebars.mustache(view.lookup("className")), " ", Spacebars.mustache(view.lookup("ignoredClass")), " ", Spacebars.mustache(view.lookup("system")), " ", Spacebars.mustache(view.lookup("t")), " ", Spacebars.mustache(view.lookup("own")), " ", Spacebars.mustache(view.lookup("isTemp")), " ", Spacebars.mustache(view.lookup("chatops")), " ", Spacebars.mustache(view.lookup("collapsed")), " ", Spacebars.mustache(view.lookup("customClass")) ];
    },
    "data-username": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
    },
    "data-tmid": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "tmid"));
    },
    "data-groupable": function() {
      return Spacebars.mustache(view.lookup("isGroupable"));
    },
    "data-date": function() {
      return Spacebars.mustache(view.lookup("date"));
    },
    "data-timestamp": function() {
      return Spacebars.mustache(view.lookup("timestamp"));
    },
    "data-alias": function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "alias"));
    }
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("isThreadReply"));
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        parentMessage: Spacebars.call(view.lookup("parentMessage")),
        msg: Spacebars.call(view.lookup("msg")),
        tmid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "tmid")),
        class: Spacebars.call(view.lookup("bodyClass")),
        following: Spacebars.call(Spacebars.dot(view.lookup("msg"), "following"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("messageThread"));
    }), "\n\t\t\t", HTML.DIV({
      class: "thread-replied js-open-thread"
    }, "\n\t\t\t\t", HTML.BUTTON({
      "aria-label": function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
      },
      class: "thumb user-card-message",
      "data-username": function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
      }
    }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        username: Spacebars.call(Spacebars.dot(view.lookup("msg"), "u", "username"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("avatar"));
    }), "\n\t\t\t\t"), "\n\t\t\t\t", HTML.SPAN({
      role: "button",
      class: "js-toggle-thread-reply thread-reply-preview color-primary-font-color"
    }, "\n\t\t\t\t\t", HTML.SPAN({
      class: "message-body--unstyled"
    }, Blaze.View("lookup:threadMessage", function() {
      return Spacebars.makeRaw(Spacebars.mustache(view.lookup("threadMessage")));
    })), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t" ];
  }), "\n\t\t", Blaze.Unless(function() {
    return Spacebars.call(view.lookup("shouldHideBody"));
  }, function() {
    return [ "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "avatar"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("avatarFromUsername"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          "aria-label": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          },
          class: "thumb user-card-message",
          "data-username": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          }
        }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            username: Spacebars.call(view.lookup("avatarFromUsername"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("avatar"));
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          "aria-label": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          },
          class: "thumb user-card-message",
          "data-username": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          }
        }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            url: Spacebars.call(view.lookup("avatarFromMessage"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("avatar"));
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("msg"), "emoji"));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          "aria-label": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          },
          class: "thumb user-card-message",
          "data-username": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          }
        }, "\n\t\t\t\t\t\t", HTML.DIV({
          class: "avatar"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:renderEmoji", function() {
          return Spacebars.makeRaw(Spacebars.mustache(view.lookup("renderEmoji"), Spacebars.dot(view.lookup("msg"), "emoji")));
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.BUTTON({
          "aria-label": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          },
          class: "thumb user-card-message",
          "data-username": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
          }
        }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            username: Spacebars.call(Spacebars.dot(view.lookup("msg"), "u", "username"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("avatar"));
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }), "\n\t\t\t", HTML.DIV({
      class: "message-body-wrapper"
    }, "\n\t\t\t\t", HTML.DIV({
      class: "title border-component-color color-info-font-color"
    }, "\n\t\t\t\t\t", HTML.BUTTON({
      type: "button",
      class: "user user-card-message color-primary-font-color",
      "data-username": function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
      },
      tabindex: "1"
    }, "\n\t\t\t\t\t\t", Blaze.View("lookup:getName", function() {
      return Spacebars.mustache(view.lookup("getName"));
    }), Blaze.If(function() {
      return Spacebars.call(view.lookup("showUsername"));
    }, function() {
      return [ " ", HTML.SPAN({
        class: "message-alias border-component-color color-info-font-color"
      }, "@", Blaze.View("lookup:msg.u.username", function() {
        return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "u", "username"));
      })) ];
    }), "\n\t\t\t\t\t"), HTML.Raw('\n\t\t\t\t\t<span class="info border-component-color color-info-font-color"></span>\n\t\t\t\t\t'), Blaze.If(function() {
      return Spacebars.call(view.lookup("showRoles"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.call(view.lookup("roleTags")),
          _variable: "role"
        };
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", HTML.SPAN({
          class: "role-tag color-secondary-color border-component-color",
          "data-role": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("role"), "description"));
          }
        }, Blaze.View("lookup:role.description", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("role"), "description"));
        })), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isBot"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "is-bot color-secondary-color border-component-color"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Bot");
      })), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", HTML.TIME({
      class: "time",
      title: function() {
        return [ Spacebars.mustache(view.lookup("date")), " ", Spacebars.mustache(view.lookup("time")) ];
      },
      datetime: function() {
        return [ Spacebars.mustache(view.lookup("date")), " ", Spacebars.mustache(view.lookup("time")) ];
      }
    }, Blaze.View("lookup:time", function() {
      return Spacebars.mustache(view.lookup("time"));
    })), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("showTranslated"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "translated"
      }, "\n\t\t\t\t\t\t\t", HTML.I({
        class: function() {
          return [ "icon-language ", Blaze.If(function() {
            return Spacebars.call(Spacebars.dot(view.lookup("msg"), "autoTranslateFetching"));
          }, function() {
            return "loading";
          }) ];
        },
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Translated");
        }
      }), "\n\t\t\t\t\t\t\t", HTML.SPAN({
        class: "translation-provider"
      }, Blaze.View("lookup:translationProvider", function() {
        return Spacebars.mustache(view.lookup("translationProvider"));
      })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "sentByEmail"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "sent-by-email"
      }, "\n\t\t\t\t\t\t\t", HTML.I({
        class: "icon-mail",
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Message_sent_by_email");
        }
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("edited"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "edited",
        title: function() {
          return [ Spacebars.mustache(view.lookup("_"), "edited"), " ", Spacebars.mustache(view.lookup("_"), "at"), " ", Spacebars.mustache(view.lookup("editTime")), " ", Spacebars.mustache(view.lookup("_"), "by"), " ", Spacebars.mustache(view.lookup("editedBy")) ];
        }
      }, "\n\t\t\t\t\t\t\t", HTML.I({
        class: function() {
          return [ "icon-pencil", Blaze.If(function() {
            return Spacebars.dataMustache(view.lookup("$neq"), view.lookup("editedBy"), Spacebars.dot(view.lookup("msg"), "u", "username"));
          }, function() {
            return " error-color";
          }) ];
        },
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Edited");
        }
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "pinned"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Message_has_been_pinned");
        },
        class: "pinned"
      }, HTML.Raw('<i class="icon-pin"></i>')), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("showStar"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        title: function() {
          return Spacebars.mustache(view.lookup("_"), "Message_has_been_starred");
        },
        class: "starred"
      }, HTML.Raw('<i class="icon-star"></i>')), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("following"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", Blaze.Unless(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("msg"), "tcount"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", HTML.SPAN({
          title: function() {
            return Spacebars.mustache(view.lookup("_"), "Following");
          },
          class: "following"
        }, HTML.Raw('<i class="icon-bell"></i>')), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "alert"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.DIV({
        title: function() {
          return Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup("msg"), "alert"));
        },
        class: "message-unread"
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "private"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "private"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Only_you_can_see_this_message");
      })), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("fromSearch"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "user color-info-font-color"
      }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call(view.lookup("roomIcon"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), Blaze.View("lookup:channelName", function() {
        return Spacebars.mustache(view.lookup("channelName"));
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isIgnored"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.SPAN({
        class: "toggle-hidden icon-right-dir",
        "data-message": function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("msg"), "_id"));
        }
      }, " ", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Message_Ignored");
      }), " "), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t"), "\n\t\t\t\t", HTML.DIV({
      class: function() {
        return [ "body ", Spacebars.mustache(view.lookup("bodyClass")) ];
      },
      dir: "auto",
      "data-unread-text": function() {
        return Spacebars.mustache(view.lookup("_"), "Unread_Messages");
      }
    }, "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("isSnippet"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.DIV({
        class: "snippet-name"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Snippet_name");
      }), ": ", Blaze.View("lookup:snippetName", function() {
        return Spacebars.mustache(view.lookup("snippetName"));
      })), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "blocks"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", HTML.DIV({
        class: "rc-ui-kit"
      }, "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          blocks: Spacebars.call(Spacebars.dot(view.lookup("msg"), "blocks")),
          rid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "rid")),
          mid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "_id"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("Blocks"));
      }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
    }, function() {
      return [ "\n\t\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("enableMessageParserEarlyAdoption"));
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            tokens: Spacebars.call(Spacebars.dot(view.lookup("msg"), "md")),
            mentions: Spacebars.call(Spacebars.dot(view.lookup("msg"), "mentions"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("MessageBody"));
        }), "\n\t\t\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", Blaze.View("lookup:body", function() {
          return Spacebars.makeRaw(Spacebars.mustache(view.lookup("body")));
        }), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "location"));
    }, function() {
      return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          location: Spacebars.call(Spacebars.dot(view.lookup("msg"), "location"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("messageLocation"));
      }), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("hasOembed"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze.Each(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("msg"), "urls"));
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.View("lookup:injectMessage", function() {
          return Spacebars.mustache(view.lookup("injectMessage"), view.lookup("."), Spacebars.dot(view.lookup(".."), "msg"));
        }), "\n\t\t\t\t\t", Blaze.View("lookup:injectSettings", function() {
          return Spacebars.mustache(view.lookup("injectSettings"), view.lookup("."), Spacebars.dot(view.lookup(".."), "settings"));
        }), "\n\t\t\t\t\t", Blaze.View("lookup:injectIndex", function() {
          return Spacebars.mustache(view.lookup("injectIndex"), view.lookup("."), view.lookup("@index"));
        }), "\n\t\t\t\t\t", Spacebars.include(view.lookupTemplate("oembedBaseWidget")), "\n\t\t\t\t" ];
      }), "\n\t\t\t" ];
    }), "\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("hasAttachments"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          attachments: Spacebars.call(Spacebars.dot(view.lookup("msg"), "attachments")),
          file: Spacebars.call(Spacebars.dot(view.lookup("msg"), "file"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("reactAttachments"));
      }), "\n\t\t\t" ];
    }), "\n\n\n\t\t\t", Spacebars.With(function() {
      return Spacebars.call(view.lookup("readReceipt"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: function() {
          return [ "read-receipt ", Spacebars.mustache(view.lookup("readByEveryone")) ];
        }
      }, "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          icon: Spacebars.call("check")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hideMessageActions"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.DIV({
        class: "message-actions"
      }, "\n\n\t\t\t\t\t", HTML.DIV({
        class: "message-actions__buttons"
      }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.dataMustache(view.lookup("messageActions"), "message"),
          _variable: "action"
        };
      }, function() {
        return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
          class: "message-actions__button",
          "data-message-action": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("action"), "id"));
          },
          title: function() {
            return Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup("action"), "label"));
          }
        }, "\n\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
          return {
            block: Spacebars.call("message-actions__button-icon"),
            icon: Spacebars.call(Spacebars.dot(view.lookup("action"), "icon"))
          };
        }, function() {
          return Spacebars.include(view.lookupTemplate("icon"));
        }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t" ];
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.DIV({
        class: "message-actions__menu",
        "aria-haspopup": "true"
      }, "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          block: Spacebars.call("message-actions__menu-icon"),
          icon: Spacebars.call("menu")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("icon"));
      }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hideActionLinks"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          mid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "_id")),
          actions: Spacebars.call(view.lookup("actionLinks")),
          runAction: Spacebars.call(Spacebars.dataMustache(Spacebars.dot(view.lookup("actions"), "runAction"), view.lookup("msg")))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("MessageActions"));
      }), "\n\t\t\t" ];
    }), "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("hideReactions"));
    }, function() {
      return [ "\n\t\t\t", HTML.UL({
        class: "reactions"
      }, "\n\t\t\t\t", Blaze.Each(function() {
        return {
          _sequence: Spacebars.call(view.lookup("reactions")),
          _variable: "reaction"
        };
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.LI(HTML.Attrs({
          "data-emoji": function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("reaction"), "emoji"));
          }
        }, function() {
          return Spacebars.attrMustache(view.lookup("markUserReaction"), view.lookup("reaction"));
        }), "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "reaction-emoji"
        }, Blaze.View("lookup:renderEmoji", function() {
          return Spacebars.makeRaw(Spacebars.mustache(view.lookup("renderEmoji"), Spacebars.dot(view.lookup("reaction"), "emoji")));
        })), "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "reaction-count"
        }, Blaze.View("lookup:reaction.count", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("reaction"), "count"));
        })), "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "people",
          style: "font-weight: bold"
        }, "\n\t\t\t\t\t\t\t", Blaze.View("lookup:reaction.usernames", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("reaction"), "usernames"));
        }), " ", HTML.SPAN({
          style: "color: #aaa;"
        }, Blaze.View("lookup:reaction.reaction", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("reaction"), "reaction"));
        })), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t\t\t", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("hideAddReaction"));
      }, function() {
        return HTML.Raw('\n\t\t\t\t\t<li class="add-reaction">\n\t\t\t\t\t\t<span class="icon-people-plus"></span>\n\t\t\t\t\t</li>\n\t\t\t\t');
      }), "\n\t\t\t"), "\n\t\t\t" ];
    }), "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("msg"), "drid"));
    }, function() {
      return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
        return {
          count: Spacebars.call(Spacebars.dot(view.lookup("msg"), "dcount")),
          drid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "drid")),
          lm: Spacebars.call(Spacebars.dot(view.lookup("msg"), "dlm")),
          openDiscussion: Spacebars.call(Spacebars.dot(view.lookup("actions"), "openDiscussion"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("DiscussionMetric"));
      }), "\n\t\t\t" ];
    }), "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.dataMustache(view.lookup("$and"), Spacebars.dot(view.lookup("settings"), "showReplyButton"), Spacebars.dot(view.lookup("msg"), "tcount"));
    }, function() {
      return [ "\n\t\t\t    ", Blaze._TemplateWith(function() {
        return {
          counter: Spacebars.call(Spacebars.dot(view.lookup("msg"), "tcount")),
          following: Spacebars.call(view.lookup("following")),
          lm: Spacebars.call(Spacebars.dot(view.lookup("msg"), "tlm")),
          rid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "rid")),
          mid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "_id")),
          unread: Spacebars.call(view.lookup("unread")),
          mention: Spacebars.call(view.lookup("mention")),
          all: Spacebars.call(view.lookup("all")),
          openThread: Spacebars.call(Spacebars.dot(view.lookup("actions"), "openThread"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("ThreadMetric"));
      }), "\n\t\t\t" ];
    }), "\n\n\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("broadcast"));
    }, function() {
      return [ "\n\t\t\t \t", Blaze._TemplateWith(function() {
        return {
          mid: Spacebars.call(Spacebars.dot(view.lookup("msg"), "_id")),
          username: Spacebars.call(Spacebars.dot(view.lookup("msg"), "u", "username")),
          replyBroadcast: Spacebars.call(Spacebars.dot(view.lookup("actions"), "replyBroadcast"))
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("BroadCastMetric"));
      }), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageThread.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageThread.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messageThread.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messageThread.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/template.messageThread.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messageThread");
Template["messageThread"] = new Template("Template.messageThread", (function() {
  var view = this;
  return HTML.Q({
    role: "button",
    title: function() {
      return Spacebars.mustache(view.lookup("_"), "Open_thread");
    },
    class: "thread-quote js-open-thread"
  }, "\n\t\t", Blaze._TemplateWith(function() {
    return {
      icon: Spacebars.call("thread"),
      block: Spacebars.call("thread-icons")
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("icon"));
  }), " ", HTML.DIV({
    class: "thread-quote__message "
  }, HTML.SPAN({
    class: "message-body--unstyled"
  }, Blaze.View("lookup:parentMessage", function() {
    return Spacebars.makeRaw(Spacebars.mustache(view.lookup("parentMessage")));
  }))), "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("following"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      role: "button",
      class: "js-unfollow-thread",
      title: function() {
        return Spacebars.mustache(view.lookup("_"), "Following");
      }
    }, "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        icon: Spacebars.call("bell"),
        block: Spacebars.call("thread-icons")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t"), "\n\t\t" ];
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      role: "button",
      class: "js-follow-thread",
      title: function() {
        return Spacebars.mustache(view.lookup("_"), "Not_following");
      }
    }, "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        icon: Spacebars.call("bell-off"),
        block: Spacebars.call("thread-icons")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t"), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"actionButtons":{"lib":{"applyButtonFilters.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/actionButtons/lib/applyButtonFilters.ts                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _enumToFilter;

module.export({
  applyAuthFilter: function () {
    return applyAuthFilter;
  },
  applyRoomFilter: function () {
    return applyRoomFilter;
  },
  applyButtonFilters: function () {
    return applyButtonFilters;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var RoomTypeFilter;
module.link("@rocket.chat/apps-engine/definition/ui", {
  RoomTypeFilter: function (v) {
    RoomTypeFilter = v;
  }
}, 1);
var hasAtLeastOnePermission, hasPermission, hasRole;
module.link("../../../../authorization/client", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  },
  hasPermission: function (v) {
    hasPermission = v;
  },
  hasRole: function (v) {
    hasRole = v;
  }
}, 2);
var isDirectMessageRoom, isMultipleDirectMessageRoom, isOmnichannelRoom, isPrivateDiscussion, isPrivateTeamRoom, isPublicDiscussion, isPublicTeamRoom;
module.link("../../../../../definition/IRoom", {
  isDirectMessageRoom: function (v) {
    isDirectMessageRoom = v;
  },
  isMultipleDirectMessageRoom: function (v) {
    isMultipleDirectMessageRoom = v;
  },
  isOmnichannelRoom: function (v) {
    isOmnichannelRoom = v;
  },
  isPrivateDiscussion: function (v) {
    isPrivateDiscussion = v;
  },
  isPrivateTeamRoom: function (v) {
    isPrivateTeamRoom = v;
  },
  isPublicDiscussion: function (v) {
    isPublicDiscussion = v;
  },
  isPublicTeamRoom: function (v) {
    isPublicTeamRoom = v;
  }
}, 3);

var applyAuthFilter = function (button, room) {
  var _ref = button.when || {},
      hasAllPermissions = _ref.hasAllPermissions,
      hasOnePermission = _ref.hasOnePermission,
      hasAllRoles = _ref.hasAllRoles,
      hasOneRole = _ref.hasOneRole;

  var hasAllPermissionsResult = hasAllPermissions ? hasPermission(hasAllPermissions) : true;
  var hasOnePermissionResult = hasOnePermission ? hasAtLeastOnePermission(hasOnePermission) : true;
  var hasAllRolesResult = hasAllRoles ? hasAllRoles.every(function (role) {
    return hasRole(Meteor.userId(), role, room === null || room === void 0 ? void 0 : room._id);
  }) : true;
  var hasOneRoleResult = hasOneRole ? hasRole(Meteor.userId(), hasOneRole, room === null || room === void 0 ? void 0 : room._id) : true;
  return hasAllPermissionsResult && hasOnePermissionResult && hasAllRolesResult && hasOneRoleResult;
};

var enumToFilter = (_enumToFilter = {}, _enumToFilter[RoomTypeFilter.PUBLIC_CHANNEL] = function (room) {
  return room.t === 'c';
}, _enumToFilter[RoomTypeFilter.PRIVATE_CHANNEL] = function (room) {
  return room.t === 'p';
}, _enumToFilter[RoomTypeFilter.PUBLIC_TEAM] = isPublicTeamRoom, _enumToFilter[RoomTypeFilter.PRIVATE_TEAM] = isPrivateTeamRoom, _enumToFilter[RoomTypeFilter.PUBLIC_DISCUSSION] = isPublicDiscussion, _enumToFilter[RoomTypeFilter.PRIVATE_DISCUSSION] = isPrivateDiscussion, _enumToFilter[RoomTypeFilter.DIRECT] = isDirectMessageRoom, _enumToFilter[RoomTypeFilter.DIRECT_MULTIPLE] = isMultipleDirectMessageRoom, _enumToFilter[RoomTypeFilter.LIVE_CHAT] = isOmnichannelRoom, _enumToFilter);

var applyRoomFilter = function (button, room) {
  var _ref2 = button.when || {},
      roomTypes = _ref2.roomTypes;

  return !roomTypes || roomTypes.some(function (filter) {
    var _enumToFilter$filter;

    return (_enumToFilter$filter = enumToFilter[filter]) === null || _enumToFilter$filter === void 0 ? void 0 : _enumToFilter$filter.call(enumToFilter, room);
  });
};

var applyButtonFilters = function (button, room) {
  return applyAuthFilter(button, room) && (!room || applyRoomFilter(button, room));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"messageAction.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/actionButtons/messageAction.ts                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  onAdded: function () {
    return onAdded;
  },
  onRemoved: function () {
    return onRemoved;
  }
});
var Utilities;
module.link("../../../apps/lib/misc/Utilities", {
  Utilities: function (v) {
    Utilities = v;
  }
}, 0);
var MessageAction, messageArgs;
module.link("../../../ui-utils/client", {
  MessageAction: function (v) {
    MessageAction = v;
  },
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 1);
var t;
module.link("../../../utils/client", {
  t: function (v) {
    t = v;
  }
}, 2);
var triggerActionButtonAction;
module.link("../ActionManager", {
  triggerActionButtonAction: function (v) {
    triggerActionButtonAction = v;
  }
}, 3);
var applyButtonFilters;
module.link("./lib/applyButtonFilters", {
  applyButtonFilters: function (v) {
    applyButtonFilters = v;
  }
}, 4);

var getIdForActionButton = function (_ref) {
  var appId = _ref.appId,
      actionId = _ref.actionId;
  return appId + "/" + actionId;
};

var onAdded = function (button) {
  var _button$when;

  return (// eslint-disable-next-line no-void
    void MessageAction.addButton({
      id: getIdForActionButton(button),
      // icon: button.icon || '',
      label: t(Utilities.getI18nKeyForApp(button.labelI18n, button.appId)),
      context: ((_button$when = button.when) === null || _button$when === void 0 ? void 0 : _button$when.messageActionContext) || ['message', 'message-mobile', 'threads', 'starred'],
      condition: function (_ref2) {
        var room = _ref2.room;
        return applyButtonFilters(button, room);
      },
      action: function () {
        function _callee() {
          var _messageArgs, msg;

          return _regeneratorRuntime.async(function () {
            function _callee$(_context) {
              while (1) {
                switch (_context.prev = _context.next) {
                  case 0:
                    _messageArgs = messageArgs(this), msg = _messageArgs.msg;
                    triggerActionButtonAction({
                      rid: msg.rid,
                      mid: msg._id,
                      actionId: button.actionId,
                      appId: button.appId,
                      payload: {
                        context: button.context
                      }
                    });

                  case 2:
                  case "end":
                    return _context.stop();
                }
              }
            }

            return _callee$;
          }(), null, this, null, Promise);
        }

        return _callee;
      }()
    })
  );
};

var onRemoved = function (button) {
  return MessageAction.removeButton(getIdForActionButton(button));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageBox.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/actionButtons/messageBox.ts                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onAdded: function () {
    return onAdded;
  },
  onRemoved: function () {
    return onRemoved;
  }
});
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 0);
var Rooms;
module.link("../../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 1);
var messageBox;
module.link("../../../ui-utils/client", {
  messageBox: function (v) {
    messageBox = v;
  }
}, 2);
var applyButtonFilters;
module.link("./lib/applyButtonFilters", {
  applyButtonFilters: function (v) {
    applyButtonFilters = v;
  }
}, 3);
var triggerActionButtonAction;
module.link("../ActionManager", {
  triggerActionButtonAction: function (v) {
    triggerActionButtonAction = v;
  }
}, 4);
var t;
module.link("../../../utils/client", {
  t: function (v) {
    t = v;
  }
}, 5);
var Utilities;
module.link("../../../apps/lib/misc/Utilities", {
  Utilities: function (v) {
    Utilities = v;
  }
}, 6);

var getIdForActionButton = function (_ref) {
  var appId = _ref.appId,
      actionId = _ref.actionId;
  return appId + "/" + actionId;
};

var APP_GROUP = 'Create_new';

var onAdded = function (button) {
  return (// eslint-disable-next-line no-void
    void messageBox.actions.add(APP_GROUP, t(Utilities.getI18nKeyForApp(button.labelI18n, button.appId)), {
      id: getIdForActionButton(button),
      // icon: button.icon || '',
      condition: function () {
        return applyButtonFilters(button, Rooms.findOne(Session.get('openedRoom')));
      },
      action: function () {
        triggerActionButtonAction({
          rid: Session.get('openedRoom'),
          actionId: button.actionId,
          appId: button.appId,
          payload: {
            context: button.context
          }
        });
      }
    })
  );
};

var onRemoved = function (button) {
  return (// eslint-disable-next-line no-void
    void messageBox.actions.remove(APP_GROUP, new RegExp(getIdForActionButton(button)))
  );
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabbar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/actionButtons/tabbar.ts                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onAdded: function () {
    return onAdded;
  },
  onRemoved: function () {
    return onRemoved;
  }
});
var addAction, deleteAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  },
  deleteAction: function (v) {
    deleteAction = v;
  }
}, 0);
var Utilities;
module.link("../../../apps/lib/misc/Utilities", {
  Utilities: function (v) {
    Utilities = v;
  }
}, 1);
var t;
module.link("../../../utils/client", {
  t: function (v) {
    t = v;
  }
}, 2);
var triggerActionButtonAction;
module.link("../ActionManager", {
  triggerActionButtonAction: function (v) {
    triggerActionButtonAction = v;
  }
}, 3);
var applyButtonFilters;
module.link("./lib/applyButtonFilters", {
  applyButtonFilters: function (v) {
    applyButtonFilters = v;
  }
}, 4);

var getIdForActionButton = function (_ref) {
  var appId = _ref.appId,
      actionId = _ref.actionId;
  return appId + "/" + actionId;
};

var onAdded = function (button) {
  return (// eslint-disable-next-line no-void
    void addAction(getIdForActionButton(button), function (_ref2) {
      var room = _ref2.room;
      return applyButtonFilters(button, room) ? {
        id: button.actionId,
        icon: '',
        order: 300,
        title: t(Utilities.getI18nKeyForApp(button.labelI18n, button.appId)),
        // Filters were applied in the applyButtonFilters function
        // if the code made it this far, the button should be shown
        groups: ['group', 'channel', 'live', 'team', 'direct', 'direct_multiple'],
        action: function () {
          return triggerActionButtonAction({
            rid: room._id,
            actionId: button.actionId,
            appId: button.appId,
            payload: {
              context: button.context
            }
          });
        }
      } : null;
    })
  );
};

var onRemoved = function (button) {
  return deleteAction(getIdForActionButton(button));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ActionButtonSyncer.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/ActionButtonSyncer.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  addButton: function () {
    return addButton;
  },
  removeButton: function () {
    return removeButton;
  },
  loadButtons: function () {
    return loadButtons;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var UIActionButtonContext;
module.link("@rocket.chat/apps-engine/definition/ui", {
  UIActionButtonContext: function (v) {
    UIActionButtonContext = v;
  }
}, 1);
var APIClient;
module.link("../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 2);
var TabBar;
module.link("./actionButtons/tabbar", {
  "*": function (v) {
    TabBar = v;
  }
}, 3);
var MessageAction;
module.link("./actionButtons/messageAction", {
  "*": function (v) {
    MessageAction = v;
  }
}, 4);
var MessageBox;
module.link("./actionButtons/messageBox", {
  "*": function (v) {
    MessageBox = v;
  }
}, 5);
var registeredButtons = [];

var addButton = function (button) {
  switch (button.context) {
    case UIActionButtonContext.MESSAGE_ACTION:
      MessageAction.onAdded(button);
      break;

    case UIActionButtonContext.ROOM_ACTION:
      TabBar.onAdded(button);
      break;

    case UIActionButtonContext.MESSAGE_BOX_ACTION:
      MessageBox.onAdded(button);
      break;
  }

  registeredButtons.push(Object.freeze(button));
};

var removeButton = function (button) {
  switch (button.context) {
    case UIActionButtonContext.MESSAGE_ACTION:
      MessageAction.onRemoved(button);
      break;

    case UIActionButtonContext.ROOM_ACTION:
      TabBar.onRemoved(button);
      break;

    case UIActionButtonContext.MESSAGE_BOX_ACTION:
      MessageBox.onRemoved(button);
      break;
  }
};

var loadButtons = function () {
  return APIClient.get('apps/actionButtons').then(function (value) {
    registeredButtons.forEach(function (button) {
      return removeButton(button);
    });
    registeredButtons = [];
    value.map(addButton);
  });
};

Meteor.startup(function () {
  return loadButtons();
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ActionManager.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/ActionManager.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["triggerId"],
    _excluded2 = ["type", "actionId", "appId", "rid", "mid", "viewId", "container"],
    _excluded3 = ["type"],
    _excluded4 = ["viewId"],
    _excluded5 = ["view"],
    _excluded6 = ["type"];

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 2);
module.export({
  on: function () {
    return on;
  },
  off: function () {
    return off;
  },
  generateTriggerId: function () {
    return generateTriggerId;
  },
  triggerAction: function () {
    return triggerAction;
  },
  triggerBlockAction: function () {
    return triggerBlockAction;
  },
  triggerActionButtonAction: function () {
    return triggerActionButtonAction;
  },
  triggerSubmitView: function () {
    return triggerSubmitView;
  },
  triggerCancel: function () {
    return triggerCancel;
  },
  getUserInteractionPayloadByViewId: function () {
    return getUserInteractionPayloadByViewId;
  }
});
var UIKitIncomingInteractionType;
module.link("@rocket.chat/apps-engine/definition/uikit", {
  UIKitIncomingInteractionType: function (v) {
    UIKitIncomingInteractionType = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 2);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 3);
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 4);
var Notifications;
module.link("../../notifications/client/lib/Notifications", {
  "default": function (v) {
    Notifications = v;
  }
}, 5);
var CachedCollectionManager;
module.link("../../ui-cached-collection", {
  CachedCollectionManager: function (v) {
    CachedCollectionManager = v;
  }
}, 6);
var modal;
module.link("../../ui-utils/client/lib/modal", {
  modal: function (v) {
    modal = v;
  }
}, 7);
var APIClient;
module.link("../../utils", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 8);
var UIKitInteractionTypes;
module.link("../../../definition/UIKit", {
  UIKitInteractionTypes: function (v) {
    UIKitInteractionTypes = v;
  }
}, 9);
var banners;
module.link("../../../client/lib/banners", {
  "*": function (v) {
    banners = v;
  }
}, 10);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 11);
var t;
module.link("../../utils/client", {
  t: function (v) {
    t = v;
  }
}, 12);
var events = new Emitter();

var on = function () {
  events.on.apply(events, arguments);
};

var off = function () {
  events.off.apply(events, arguments);
};

var TRIGGER_TIMEOUT = 5000;
var TRIGGER_TIMEOUT_ERROR = 'TRIGGER_TIMEOUT_ERROR';
var triggersId = new Map();
var instances = new Map();

var invalidateTriggerId = function (id) {
  var appId = triggersId.get(id);
  triggersId.delete(id);
  return appId;
};

var generateTriggerId = function (appId) {
  var triggerId = Random.id();
  triggersId.set(triggerId, appId);
  setTimeout(invalidateTriggerId, TRIGGER_TIMEOUT, triggerId);
  return triggerId;
};

var handlePayloadUserInteraction = function (type, _ref) {
  var triggerId = _ref.triggerId,
      data = _objectWithoutProperties(_ref, _excluded);

  if (!triggersId.has(triggerId)) {
    return;
  }

  var appId = invalidateTriggerId(triggerId);

  if (!appId) {
    return;
  }

  var view = data.view;
  var viewId = data.viewId;

  if (view && view.id) {
    viewId = view.id;
  }

  if (!viewId) {
    return;
  }

  if ([UIKitInteractionTypes.ERRORS].includes(type)) {
    events.emit(viewId, _objectSpread({
      type: type,
      triggerId: triggerId,
      viewId: viewId,
      appId: appId
    }, data));
    return UIKitInteractionTypes.ERRORS;
  }

  if ([UIKitInteractionTypes.BANNER_UPDATE, UIKitInteractionTypes.MODAL_UPDATE, UIKitInteractionTypes.CONTEXTUAL_BAR_UPDATE].includes(type)) {
    events.emit(viewId, _objectSpread({
      type: type,
      triggerId: triggerId,
      viewId: viewId,
      appId: appId
    }, data));
    return type;
  }

  if ([UIKitInteractionTypes.MODAL_OPEN].includes(type)) {
    var instance = modal.push({
      template: 'ModalBlock',
      modifier: 'uikit',
      closeOnEscape: false,
      data: _objectSpread({
        triggerId: triggerId,
        viewId: viewId,
        appId: appId
      }, data)
    });
    instances.set(viewId, {
      close: function () {
        instance.close();
        instances.delete(viewId);
      }
    });
    return UIKitInteractionTypes.MODAL_OPEN;
  }

  if ([UIKitInteractionTypes.CONTEXTUAL_BAR_OPEN].includes(type)) {
    instances.set(viewId, {
      payload: _objectSpread({
        type: type,
        triggerId: triggerId,
        appId: appId,
        viewId: viewId
      }, data),
      close: function () {
        instances.delete(viewId);
      }
    });
    FlowRouter.setParams({
      tab: 'app',
      context: viewId
    });
    return UIKitInteractionTypes.CONTEXTUAL_BAR_OPEN;
  }

  if ([UIKitInteractionTypes.BANNER_OPEN].includes(type)) {
    banners.open(data);
    instances.set(viewId, {
      close: function () {
        banners.closeById(viewId);
      }
    });
    return UIKitInteractionTypes.BANNER_OPEN;
  }

  if ([UIKitIncomingInteractionType.BANNER_CLOSE].includes(type)) {
    var _instance = instances.get(viewId);

    if (_instance) {
      _instance.close();
    }

    return UIKitIncomingInteractionType.BANNER_CLOSE;
  }

  if ([UIKitIncomingInteractionType.CONTEXTUAL_BAR_CLOSE].includes(type)) {
    var _instance2 = instances.get(viewId);

    if (_instance2) {
      _instance2.close();
    }

    return UIKitIncomingInteractionType.CONTEXTUAL_BAR_CLOSE;
  }

  return UIKitInteractionTypes.MODAL_ClOSE;
};

var triggerAction = function () {
  function _callee2(_ref2) {
    var type, actionId, appId, rid, mid, viewId, container, rest;
    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              type = _ref2.type, actionId = _ref2.actionId, appId = _ref2.appId, rid = _ref2.rid, mid = _ref2.mid, viewId = _ref2.viewId, container = _ref2.container, rest = _objectWithoutProperties(_ref2, _excluded2);
              return _context2.abrupt("return", new Promise(function () {
                function _callee(resolve, reject) {
                  var triggerId, payload, _await$APIClient$post, interactionType, data;

                  return _regeneratorRuntime.async(function () {
                    function _callee$(_context) {
                      while (1) {
                        switch (_context.prev = _context.next) {
                          case 0:
                            triggerId = generateTriggerId(appId);
                            payload = rest.payload || rest;
                            setTimeout(reject, TRIGGER_TIMEOUT, [TRIGGER_TIMEOUT_ERROR, {
                              triggerId: triggerId,
                              appId: appId
                            }]);
                            _context.next = 5;
                            return _regeneratorRuntime.awrap(APIClient.post("apps/ui.interaction/" + appId, {
                              type: type,
                              actionId: actionId,
                              payload: payload,
                              container: container,
                              mid: mid,
                              rid: rid,
                              triggerId: triggerId,
                              viewId: viewId
                            }));

                          case 5:
                            _await$APIClient$post = _context.sent;
                            interactionType = _await$APIClient$post.type;
                            data = _objectWithoutProperties(_await$APIClient$post, _excluded3);
                            return _context.abrupt("return", resolve(handlePayloadUserInteraction(interactionType, data)));

                          case 9:
                          case "end":
                            return _context.stop();
                        }
                      }
                    }

                    return _callee$;
                  }(), null, null, null, Promise);
                }

                return _callee;
              }()));

            case 2:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();

var triggerBlockAction = function (options) {
  return triggerAction(_objectSpread({
    type: UIKitIncomingInteractionType.BLOCK
  }, options));
};

var triggerActionButtonAction = function (options) {
  return triggerAction(_objectSpread({
    type: UIKitIncomingInteractionType.ACTION_BUTTON
  }, options)).catch(function () {
    function _callee3(reason) {
      return _regeneratorRuntime.async(function () {
        function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                if (Array.isArray(reason) && reason[0] === TRIGGER_TIMEOUT_ERROR) {
                  dispatchToastMessage({
                    type: 'error',
                    message: t('UIKit_Interaction_Timeout')
                  });
                }

              case 1:
              case "end":
                return _context3.stop();
            }
          }
        }

        return _callee3$;
      }(), null, null, null, Promise);
    }

    return _callee3;
  }());
};

var triggerSubmitView = function () {
  function _callee4(_ref3) {
    var viewId, options, close, result;
    return _regeneratorRuntime.async(function () {
      function _callee4$(_context4) {
        while (1) {
          switch (_context4.prev = _context4.next) {
            case 0:
              viewId = _ref3.viewId, options = _objectWithoutProperties(_ref3, _excluded4);

              close = function () {
                var instance = instances.get(viewId);

                if (instance) {
                  instance.close();
                }
              };

              _context4.prev = 2;
              _context4.next = 5;
              return _regeneratorRuntime.awrap(triggerAction(_objectSpread({
                type: UIKitIncomingInteractionType.VIEW_SUBMIT,
                viewId: viewId
              }, options)));

            case 5:
              result = _context4.sent;

              if (!result || UIKitInteractionTypes.MODAL_CLOSE === result) {
                close();
              }

              _context4.next = 12;
              break;

            case 9:
              _context4.prev = 9;
              _context4.t0 = _context4["catch"](2);
              close();

            case 12:
            case "end":
              return _context4.stop();
          }
        }
      }

      return _callee4$;
    }(), null, null, [[2, 9]], Promise);
  }

  return _callee4;
}();

var triggerCancel = function () {
  function _callee5(_ref4) {
    var view, options, instance;
    return _regeneratorRuntime.async(function () {
      function _callee5$(_context5) {
        while (1) {
          switch (_context5.prev = _context5.next) {
            case 0:
              view = _ref4.view, options = _objectWithoutProperties(_ref4, _excluded5);
              instance = instances.get(view.id);
              _context5.prev = 2;
              _context5.next = 5;
              return _regeneratorRuntime.awrap(triggerAction(_objectSpread({
                type: UIKitIncomingInteractionType.VIEW_CLOSED,
                view: view
              }, options)));

            case 5:
              _context5.prev = 5;

              if (instance) {
                instance.close();
              }

              return _context5.finish(5);

            case 8:
            case "end":
              return _context5.stop();
          }
        }
      }

      return _callee5$;
    }(), null, null, [[2,, 5, 8]], Promise);
  }

  return _callee5;
}();

var getUserInteractionPayloadByViewId = function (viewId) {
  if (!viewId) {
    throw new Error('No viewId provided when checking for `user interaction payload`');
  }

  var instance = instances.get(viewId);

  if (!instance) {
    return {};
  }

  return instance.payload;
};

Meteor.startup(function () {
  return CachedCollectionManager.onLogin(function () {
    return Notifications.onUser('uiInteraction', function (_ref5) {
      var type = _ref5.type,
          data = _objectWithoutProperties(_ref5, _excluded6);

      handlePayloadUserInteraction(type, data);
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./message");
module.link("./messageBox/messageBox");
module.link("./popup/customMessagePopups");
module.link("./popup/messagePopup");
module.link("./popup/messagePopupChannel");
module.link("./popup/messagePopupConfig");
module.link("./popup/messagePopupEmoji");
module.link("./popup/messagePopupSlashCommandPreview");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"message.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/message.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 2);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var dompurify;
module.link("dompurify", {
  "default": function (v) {
    dompurify = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 4);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 5);
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 6);
var timeAgo;
module.link("../../../client/lib/utils/timeAgo", {
  timeAgo: function (v) {
    timeAgo = v;
  }
}, 7);
var formatDateAndTime;
module.link("../../../client/lib/utils/formatDateAndTime", {
  formatDateAndTime: function (v) {
    formatDateAndTime = v;
  }
}, 8);
var normalizeThreadTitle;
module.link("../../threads/client/lib/normalizeThreadTitle", {
  normalizeThreadTitle: function (v) {
    normalizeThreadTitle = v;
  }
}, 9);
var MessageTypes, MessageAction;
module.link("../../ui-utils/client", {
  MessageTypes: function (v) {
    MessageTypes = v;
  },
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 10);
var RoomRoles, UserRoles, Roles;
module.link("../../models/client", {
  RoomRoles: function (v) {
    RoomRoles = v;
  },
  UserRoles: function (v) {
    UserRoles = v;
  },
  Roles: function (v) {
    Roles = v;
  }
}, 11);
var Markdown;
module.link("../../markdown/client", {
  Markdown: function (v) {
    Markdown = v;
  }
}, 12);
var t, roomTypes;
module.link("../../utils", {
  t: function (v) {
    t = v;
  },
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 13);
var AutoTranslate;
module.link("../../autotranslate/client", {
  AutoTranslate: function (v) {
    AutoTranslate = v;
  }
}, 14);
var renderMentions;
module.link("../../mentions/client/client", {
  renderMentions: function (v) {
    renderMentions = v;
  }
}, 15);
var renderMessageBody;
module.link("../../../client/lib/utils/renderMessageBody", {
  renderMessageBody: function (v) {
    renderMessageBody = v;
  }
}, 16);
var settings;
module.link("../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 17);
var formatTime;
module.link("../../../client/lib/utils/formatTime", {
  formatTime: function (v) {
    formatTime = v;
  }
}, 18);
var formatDate;
module.link("../../../client/lib/utils/formatDate", {
  formatDate: function (v) {
    formatDate = v;
  }
}, 19);
module.link("./messageThread");
module.link("./message.html");

var renderBody = function (msg, settings) {
  var searchedText = msg.searchedText ? msg.searchedText : '';
  var isSystemMessage = MessageTypes.isSystemMessage(msg);
  var messageType = MessageTypes.getType(msg) || {};

  if (messageType.render) {
    msg = messageType.render(msg);
  } else if (messageType.template) {// render template
  } else if (messageType.message) {
    msg.msg = escapeHTML(msg.msg);
    msg = TAPi18n.__(messageType.message, _objectSpread({}, typeof messageType.data === 'function' && messageType.data(msg)));
    msg = dompurify.sanitize(msg);
  } else if (msg.u && msg.u.username === settings.Chatops_Username) {
    msg.html = msg.msg;
    msg = renderMentions(msg);
    msg = msg.html;
  } else {
    msg = renderMessageBody(msg);
  }

  if (isSystemMessage) {
    msg.html = Markdown.parse(msg.html);
  }

  if (searchedText) {
    msg = msg.replace(new RegExp(searchedText, 'gi'), function (str) {
      return "<mark>" + str + "</mark>";
    });
  }

  return msg;
};

Template.message.helpers({
  enableMessageParserEarlyAdoption: function () {
    var enableMessageParserEarlyAdoption = this.settings.enableMessageParserEarlyAdoption,
        msg = this.msg;
    return enableMessageParserEarlyAdoption && msg.md;
  },
  unread: function () {
    var _subscription$tunread;

    var msg = this.msg,
        subscription = this.subscription;
    return subscription === null || subscription === void 0 ? void 0 : (_subscription$tunread = subscription.tunread) === null || _subscription$tunread === void 0 ? void 0 : _subscription$tunread.includes(msg._id);
  },
  mention: function () {
    var _subscription$tunread2;

    var msg = this.msg,
        subscription = this.subscription;
    return subscription === null || subscription === void 0 ? void 0 : (_subscription$tunread2 = subscription.tunreadUser) === null || _subscription$tunread2 === void 0 ? void 0 : _subscription$tunread2.includes(msg._id);
  },
  all: function () {
    var _subscription$tunread3;

    var msg = this.msg,
        subscription = this.subscription;
    return subscription === null || subscription === void 0 ? void 0 : (_subscription$tunread3 = subscription.tunreadGroup) === null || _subscription$tunread3 === void 0 ? void 0 : _subscription$tunread3.includes(msg._id);
  },
  following: function () {
    var msg = this.msg,
        u = this.u;
    return msg.replies && msg.replies.indexOf(u._id) > -1;
  },
  body: function () {
    var msg = this.msg,
        settings = this.settings;
    return Tracker.nonreactive(function () {
      return renderBody(msg, settings);
    });
  },
  i18nReplyCounter: function () {
    var msg = this.msg;

    if (msg.tcount === 1) {
      return 'reply_counter';
    }

    return 'reply_counter_plural';
  },
  i18nDiscussionCounter: function () {
    var msg = this.msg;
    return "<span class='reply-counter'>" + msg.dcount + "</span>";
  },
  formatDateAndTime: formatDateAndTime,
  encodeURI: function (text) {
    return encodeURI(text);
  },
  broadcast: function () {
    var msg = this.msg,
        _this$room = this.room,
        room = _this$room === void 0 ? {} : _this$room,
        u = this.u;
    return !msg.private && !msg.t && msg.u._id !== u._id && room && room.broadcast;
  },
  isIgnored: function () {
    var ignored = this.ignored,
        msg = this.msg;
    var isIgnored = typeof ignored !== 'undefined' ? ignored : msg.ignored;
    return isIgnored;
  },
  ignoredClass: function () {
    var ignored = this.ignored,
        msg = this.msg;
    var isIgnored = typeof ignored !== 'undefined' ? ignored : msg.ignored;
    return isIgnored ? 'message--ignored' : '';
  },
  isDecrypting: function () {
    var msg = this.msg;
    return msg.e2e === 'pending';
  },
  isBot: function () {
    var msg = this.msg;
    return msg.bot && 'bot';
  },
  hasAttachments: function () {
    var _msg$attachments;

    var msg = this.msg;
    return (_msg$attachments = msg.attachments) === null || _msg$attachments === void 0 ? void 0 : _msg$attachments.length;
  },
  roleTags: function () {
    var msg = this.msg,
        hideRoles = this.hideRoles,
        settings = this.settings;

    if (settings.hideRoles || hideRoles) {
      return [];
    }

    if (!msg.u || !msg.u._id) {
      return [];
    }

    var userRoles = UserRoles.findOne(msg.u._id);
    var roomRoles = RoomRoles.findOne({
      'u._id': msg.u._id,
      'rid': msg.rid
    });
    var roles = [].concat(_toConsumableArray(userRoles && userRoles.roles || []), _toConsumableArray(roomRoles && roomRoles.roles || []));
    return Roles.find({
      _id: {
        $in: roles
      },
      description: {
        $exists: 1,
        $ne: ''
      }
    }, {
      fields: {
        description: 1
      }
    });
  },
  isGroupable: function () {
    var msg = this.msg,
        _this$room2 = this.room,
        room = _this$room2 === void 0 ? {} : _this$room2,
        settings = this.settings,
        groupable = this.groupable;

    if (groupable === false || settings.allowGroup === false || room.broadcast || msg.groupable === false || MessageTypes.isSystemMessage(msg) && !msg.tmid) {
      return 'false';
    }
  },
  avatarFromUsername: function () {
    var msg = this.msg;

    if (msg.avatar != null && msg.avatar[0] === '@') {
      return msg.avatar.replace(/^@/, '');
    }
  },
  avatarFromMessage: function () {
    var msg = this.msg;

    if (msg && msg.avatar) {
      return encodeURI(msg.avatar);
    }

    return '';
  },
  getName: function () {
    var msg = this.msg,
        settings = this.settings;

    if (msg.alias) {
      return msg.alias;
    }

    if (!msg.u) {
      return '';
    }

    return settings.UI_Use_Real_Name && msg.u.name || msg.u.username;
  },
  showUsername: function () {
    var msg = this.msg,
        settings = this.settings;
    return msg.alias || settings.UI_Use_Real_Name && msg.u && msg.u.name;
  },
  own: function () {
    var msg = this.msg,
        _this$u = this.u,
        u = _this$u === void 0 ? {} : _this$u;

    if (msg.u && msg.u._id === u._id) {
      return 'own';
    }
  },
  t: function () {
    var msg = this.msg;
    return msg.t;
  },
  timestamp: function () {
    var msg = this.msg;
    return +msg.ts;
  },
  chatops: function () {
    var msg = this.msg,
        settings = this.settings;

    if (msg.u && msg.u.username === settings.Chatops_Username) {
      return 'chatops-message';
    }
  },
  time: function () {
    var msg = this.msg,
        useTimeAgo = this.timeAgo;
    return useTimeAgo ? timeAgo(msg.ts) : formatTime(msg.ts);
  },
  date: function () {
    var msg = this.msg;
    return formatDate(msg.ts);
  },
  isTemp: function () {
    var msg = this.msg;

    if (msg.temp === true) {
      return 'temp';
    }
  },
  threadMessage: function () {
    var msg = this.msg;
    return normalizeThreadTitle(msg);
  },
  bodyClass: function () {
    var msg = this.msg;
    return MessageTypes.isSystemMessage(msg) ? 'color-info-font-color' : 'color-primary-font-color';
  },
  system: function (returnClass) {
    var msg = this.msg;

    if (MessageTypes.isSystemMessage(msg)) {
      if (returnClass) {
        return 'color-info-font-color';
      }

      return 'system';
    }
  },
  showTranslated: function () {
    var msg = this.msg,
        subscription = this.subscription,
        settings = this.settings,
        u = this.u;

    if (settings.AutoTranslate_Enabled && msg.u && msg.u._id !== u._id && !MessageTypes.isSystemMessage(msg)) {
      var autoTranslate = subscription && subscription.autoTranslate;
      return msg.autoTranslateFetching || !!autoTranslate !== !!msg.autoTranslateShowInverse && msg.translations && msg.translations[settings.translateLanguage];
    }
  },
  translationProvider: function () {
    var _AutoTranslate$provid;

    var instance = Template.instance();
    var translationProvider = instance.data.msg.translationProvider;
    return translationProvider && ((_AutoTranslate$provid = AutoTranslate.providersMetadata[translationProvider]) === null || _AutoTranslate$provid === void 0 ? void 0 : _AutoTranslate$provid.displayName);
  },
  edited: function () {
    var msg = this.msg;
    return msg.editedAt && !MessageTypes.isSystemMessage(msg);
  },
  editTime: function () {
    var msg = this.msg;
    return msg.editedAt ? formatDateAndTime(msg.editedAt) : '';
  },
  editedBy: function () {
    var msg = this.msg;

    if (!msg.editedAt) {
      return '';
    } // try to return the username of the editor,
    // otherwise a special "?" character that will be
    // rendered as a special avatar


    return msg.editedBy && msg.editedBy.username || '?';
  },
  label: function () {
    var msg = this.msg;

    if (msg.i18nLabel) {
      return t(msg.i18nLabel);
    }

    if (msg.label) {
      return msg.label;
    }
  },
  hasOembed: function () {
    var msg = this.msg,
        settings = this.settings; // there is no URLs, there is no template to show the oembed (oembed package removed) or oembed is not enable

    if (!(msg.urls && msg.urls.length > 0) || !Template.oembedBaseWidget || !settings.API_Embed) {
      return false;
    } // check if oembed is disabled for message's sender


    if ((settings.API_EmbedDisabledFor || '').split(',').map(function (username) {
      return username.trim();
    }).includes(msg.u && msg.u.username)) {
      return false;
    }

    return true;
  },
  reactions: function () {
    var _this$msg$reactions = this.msg.reactions,
        reactions = _this$msg$reactions === void 0 ? {} : _this$msg$reactions,
        _this$u2 = this.u,
        myUsername = _this$u2.username,
        myName = _this$u2.name;
    return Object.entries(reactions).map(function (_ref) {
      var _ref2 = _slicedToArray(_ref, 2),
          emoji = _ref2[0],
          reaction = _ref2[1];

      var myDisplayName = reaction.names ? myName : "@" + myUsername;
      var displayNames = reaction.names || reaction.usernames.map(function (username) {
        return "@" + username;
      });
      var selectedDisplayNames = displayNames.slice(0, 15).filter(function (displayName) {
        return displayName !== myDisplayName;
      });

      if (displayNames.some(function (displayName) {
        return displayName === myDisplayName;
      })) {
        selectedDisplayNames.unshift(t('You'));
      }

      var usernames;

      if (displayNames.length > 15) {
        usernames = selectedDisplayNames.join(', ') + " " + t('And_more', {
          length: displayNames.length - 15
        }).toLowerCase();
      } else if (displayNames.length > 1) {
        usernames = selectedDisplayNames.slice(0, -1).join(', ') + " " + t('and') + " " + selectedDisplayNames[selectedDisplayNames.length - 1];
      } else {
        usernames = selectedDisplayNames[0];
      }

      return {
        emoji: emoji,
        count: displayNames.length,
        usernames: usernames,
        reaction: " " + t('Reacted_with').toLowerCase() + " " + emoji,
        userReacted: displayNames.indexOf(myDisplayName) > -1
      };
    });
  },
  markUserReaction: function (reaction) {
    if (reaction.userReacted) {
      return {
        "class": 'selected'
      };
    }
  },
  hideReactions: function () {
    var msg = this.msg;

    if (_.isEmpty(msg.reactions)) {
      return 'hidden';
    }
  },
  hideAddReaction: function () {
    var room = this.room,
        u = this.u,
        msg = this.msg,
        subscription = this.subscription;

    if (!room) {
      return true;
    }

    if (!subscription) {
      return true;
    }

    if (msg.private) {
      return true;
    }

    if (roomTypes.readOnly(room._id, u._id) && !room.reactWhenReadOnly) {
      return true;
    }
  },
  hideMessageActions: function () {
    var msg = this.msg;
    return msg.private || MessageTypes.isSystemMessage(msg);
  },
  actionLinks: function () {
    var msg = this.msg; // remove 'method_id' and 'params' properties

    return _.map(msg.actionLinks, function (actionLink, key) {
      return _.extend({
        id: key
      }, _.omit(actionLink, 'method_id', 'params'));
    });
  },
  hideActionLinks: function () {
    var msg = this.msg;

    if (_.isEmpty(msg.actionLinks)) {
      return 'hidden';
    }
  },
  injectMessage: function (data, _ref3) {
    var _id = _ref3._id,
        rid = _ref3.rid;
    data.msg = {
      _id: _id,
      rid: rid
    };
  },
  injectIndex: function (data, index) {
    data.index = index;
  },
  injectSettings: function (data, settings) {
    data.settings = settings;
  },
  className: function () {
    return this.msg.className;
  },
  channelName: function () {
    var subscription = this.subscription; // const subscription = Subscriptions.findOne({ rid: this.rid });

    return subscription && subscription.name;
  },
  roomIcon: function () {
    var room = this.room;

    if (room && room.t === 'd') {
      return 'at';
    }

    return roomTypes.getIcon(room);
  },
  customClass: function () {
    var customClass = this.customClass,
        msg = this.msg;
    return customClass || msg.customClass;
  },
  fromSearch: function () {
    var customClass = this.customClass,
        msg = this.msg;
    return [msg.customClass, customClass].includes('search');
  },
  actionContext: function () {
    var msg = this.msg;
    return msg.actionContext;
  },
  messageActions: function (group) {
    var msg = this.msg,
        ctx = this.context;
    var messageGroup = group;
    var context = ctx || msg.actionContext;

    if (!group) {
      messageGroup = 'message';
    }

    if (!context) {
      context = 'message';
    }

    return MessageAction.getButtons(this, context, messageGroup);
  },
  isSnippet: function () {
    var msg = this.msg;
    return msg.actionContext === 'snippeted';
  },
  isThreadReply: function () {
    var groupable = this.groupable,
        _this$msg = this.msg,
        tmid = _this$msg.tmid,
        t = _this$msg.t,
        _groupable = _this$msg.groupable,
        showreply = this.settings.showreply;
    return !(groupable === true || _groupable === true) && !!(tmid && showreply && (!t || t === 'e2e'));
  },
  shouldHideBody: function () {
    var _this$msg2 = this.msg,
        tmid = _this$msg2.tmid,
        actionContext = _this$msg2.actionContext,
        showreply = this.settings.showreply,
        context = this.context;
    return showreply && tmid && !(actionContext || context);
  },
  collapsed: function () {
    var _this$msg3 = this.msg,
        tmid = _this$msg3.tmid,
        collapsed = _this$msg3.collapsed,
        showreply = this.settings.showreply,
        shouldCollapseReplies = this.shouldCollapseReplies;
    var isCollapsedThreadReply = shouldCollapseReplies && tmid && showreply && collapsed !== false;

    if (isCollapsedThreadReply) {
      return 'collapsed';
    }
  },
  collapseSwitchClass: function () {
    var _this$msg$collapsed = this.msg.collapsed,
        collapsed = _this$msg$collapsed === void 0 ? true : _this$msg$collapsed;
    return collapsed ? 'icon-right-dir' : 'icon-down-dir';
  },
  parentMessage: function () {
    var threadMsg = this.msg.threadMsg;
    return threadMsg;
  },
  showStar: function () {
    var msg = this.msg;
    return msg.starred && msg.starred.length > 0 && msg.starred.find(function (star) {
      return star._id === Meteor.userId();
    }) && !(msg.actionContext === 'starred' || this.context === 'starred');
  },
  readReceipt: function () {
    if (!settings.get('Message_Read_Receipt_Enabled')) {
      return;
    }

    return {
      readByEveryone: !this.msg.unread && 'read' || 'color-component-color'
    };
  }
});

var hasTempClass = function (node) {
  return node.classList.contains('temp');
};

var getPreviousSentMessage = function (currentNode) {
  if (hasTempClass(currentNode)) {
    return currentNode.previousElementSibling;
  }

  if (currentNode.previousElementSibling != null) {
    var previousValid = currentNode.previousElementSibling;

    while (previousValid != null && (hasTempClass(previousValid) || !previousValid.classList.contains('message'))) {
      previousValid = previousValid.previousElementSibling;
    }

    return previousValid;
  }
};

var isNewDay = function (currentNode, previousNode, forceDate, showDateSeparator) {
  if (!showDateSeparator) {
    return false;
  }

  if (forceDate || !previousNode) {
    return true;
  }

  var currentDataset = currentNode.dataset;
  var previousDataset = previousNode.dataset;
  var previousMessageDate = new Date(parseInt(previousDataset.timestamp));
  var currentMessageDate = new Date(parseInt(currentDataset.timestamp));

  if (previousMessageDate.toDateString() !== currentMessageDate.toDateString()) {
    return true;
  }

  return false;
};

var isSequential = function (currentNode, previousNode, forceDate, period, showDateSeparator, shouldCollapseReplies) {
  if (!previousNode) {
    return false;
  }

  if (showDateSeparator && forceDate) {
    return false;
  }

  var currentDataset = currentNode.dataset;
  var previousDataset = previousNode.dataset;
  var previousMessageDate = new Date(parseInt(previousDataset.timestamp));
  var currentMessageDate = new Date(parseInt(currentDataset.timestamp));

  if (showDateSeparator && previousMessageDate.toDateString() !== currentMessageDate.toDateString()) {
    return false;
  }

  if (!shouldCollapseReplies && currentDataset.tmid) {
    return previousDataset.id === currentDataset.tmid || previousDataset.tmid === currentDataset.tmid;
  }

  if (previousDataset.tmid && !currentDataset.tmid) {
    return false;
  }

  if ([previousDataset.groupable, currentDataset.groupable].includes('false')) {
    return false;
  }

  if (previousDataset.username !== currentDataset.username) {
    return false;
  }

  if (previousDataset.alias !== currentDataset.alias) {
    return false;
  }

  if (parseInt(currentDataset.timestamp) - parseInt(previousDataset.timestamp) <= period) {
    return true;
  }

  return false;
};

var processSequentials = function (_ref4) {
  var index = _ref4.index,
      currentNode = _ref4.currentNode,
      settings = _ref4.settings,
      forceDate = _ref4.forceDate,
      _ref4$showDateSeparat = _ref4.showDateSeparator,
      showDateSeparator = _ref4$showDateSeparat === void 0 ? true : _ref4$showDateSeparat,
      groupable = _ref4.groupable,
      shouldCollapseReplies = _ref4.shouldCollapseReplies;

  if (!showDateSeparator && !groupable) {
    return;
  } // const currentDataset = currentNode.dataset;


  var previousNode = (index === undefined || index > 0) && getPreviousSentMessage(currentNode);
  var nextNode = currentNode.nextElementSibling;

  if (!previousNode) {
    setTimeout(function () {
      currentNode.dispatchEvent(new CustomEvent('MessageGroup', {
        bubbles: true
      }));
    }, 100);
  }

  if (isSequential(currentNode, previousNode, forceDate, settings.Message_GroupingPeriod, showDateSeparator, shouldCollapseReplies)) {
    currentNode.classList.add('sequential');
  } else {
    currentNode.classList.remove('sequential');
  }

  if (isNewDay(currentNode, previousNode, forceDate, showDateSeparator)) {
    currentNode.classList.add('new-day');
  } else {
    currentNode.classList.remove('new-day');
  }

  if (nextNode && nextNode.dataset) {
    if (isSequential(nextNode, currentNode, forceDate, settings.Message_GroupingPeriod, showDateSeparator, shouldCollapseReplies)) {
      nextNode.classList.add('sequential');
    } else {
      nextNode.classList.remove('sequential');
    }

    if (isNewDay(nextNode, currentNode, forceDate, showDateSeparator)) {
      nextNode.classList.add('new-day');
    } else {
      nextNode.classList.remove('new-day');
    }
  }
};

Template.message.onRendered(function () {
  var currentNode = this.firstNode;
  this.autorun(function () {
    return processSequentials(_objectSpread({
      currentNode: currentNode
    }, Template.currentData()));
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageThread.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-message/client/messageThread.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var callWithErrorHandling;
module.link("../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 3);
var Messages;
module.link("../../models/client", {
  Messages: function (v) {
    Messages = v;
  }
}, 4);
var normalizeThreadTitle;
module.link("../../threads/client/lib/normalizeThreadTitle", {
  normalizeThreadTitle: function (v) {
    normalizeThreadTitle = v;
  }
}, 5);
module.link("./messageThread.html");

var findParentMessage = function () {
  var waiting = [];
  var resolve;
  var pending = new Promise(function (r) {
    resolve = r;
  });

  var getMessages = _.debounce(function () {
    function _callee() {
      var _tmp;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _tmp = [].concat(waiting);
                waiting.length = 0;
                resolve(callWithErrorHandling('getMessages', _tmp));
                pending = new Promise(function (r) {
                  resolve = r;
                });

              case 4:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }(), 500);

  var get = function () {
    function _callee2(tmid) {
      var messages;
      return _regeneratorRuntime.async(function () {
        function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                getMessages();
                _context2.next = 3;
                return _regeneratorRuntime.awrap(pending);

              case 3:
                messages = _context2.sent;
                return _context2.abrupt("return", messages.find(function (_ref) {
                  var _id = _ref._id;
                  return _id === tmid;
                }));

              case 5:
              case "end":
                return _context2.stop();
            }
          }
        }

        return _callee2$;
      }(), null, null, null, Promise);
    }

    return _callee2;
  }();

  return function () {
    function _callee3(tmid) {
      var message;
      return _regeneratorRuntime.async(function () {
        function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                message = Messages.findOne({
                  _id: tmid
                });

                if (!message) {
                  _context3.next = 3;
                  break;
                }

                return _context3.abrupt("return", message);

              case 3:
                if (waiting.indexOf(tmid) === -1) {
                  waiting.push(tmid);
                }

                return _context3.abrupt("return", get(tmid));

              case 5:
              case "end":
                return _context3.stop();
            }
          }
        }

        return _callee3$;
      }(), null, null, null, Promise);
    }

    return _callee3;
  }();
}();

Template.messageThread.helpers({
  parentMessage: function () {
    var _Template$instance = Template.instance(),
        parentMessage = _Template$instance.parentMessage;

    if (parentMessage) {
      return normalizeThreadTitle(parentMessage.get());
    }
  }
});
Template.messageThread.onCreated(function () {
  var _this = this;

  this.parentMessage = new ReactiveVar();
  this.autorun(function () {
    function _callee4() {
      var _Template$currentData, tmid;

      return _regeneratorRuntime.async(function () {
        function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                _Template$currentData = Template.currentData(), tmid = _Template$currentData.tmid;
                _context4.t0 = _this.parentMessage;
                _context4.next = 4;
                return _regeneratorRuntime.awrap(findParentMessage(tmid));

              case 4:
                _context4.t1 = _context4.sent;

                _context4.t0.set.call(_context4.t0, _context4.t1);

              case 6:
              case "end":
                return _context4.stop();
            }
          }
        }

        return _callee4$;
      }(), null, null, null, Promise);
    }

    return _callee4;
  }());
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"videobridge":{"client":{"views":{"bbbLiveView.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/client/views/bbbLiveView.html                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.bbbLiveView.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.bbbLiveView.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/client/views/template.bbbLiveView.js                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("bbbLiveView");
Template["bbbLiveView"] = new Template("Template.bbbLiveView", (function() {
  var view = this;
  return HTML.IFRAME({
    allowfullscreen: "true",
    webkitallowfullscreen: "true",
    mozallowfullscreen: "true",
    allow: "microphone *; camera *; display-capture *",
    src: function() {
      return Spacebars.mustache(view.lookup("source"));
    },
    width: "380",
    height: "400",
    frameborder: "0"
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"actionLink.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/client/actionLink.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 2);
var actionLinks;
module.link("../../action-links/client", {
  actionLinks: function (v) {
    actionLinks = v;
  }
}, 3);
var Rooms;
module.link("../../models", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 4);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 5);
actionLinks.register('joinJitsiCall', function (message, params, instance) {
  if (Session.get('openedRoom')) {
    var _Meteor$user, _room$muted;

    var rid = Session.get('openedRoom');
    var room = Rooms.findOne({
      _id: rid
    });
    var username = (_Meteor$user = Meteor.user()) === null || _Meteor$user === void 0 ? void 0 : _Meteor$user.username;
    var currentTime = new Date().getTime();
    var jitsiTimeout = new Date(room && room.jitsiTimeout || currentTime).getTime();

    if (room && room !== null && room !== void 0 && (_room$muted = room.muted) !== null && _room$muted !== void 0 && _room$muted.includes(username)) {
      dispatchToastMessage({
        type: 'error',
        message: TAPi18n.__('You_have_been_muted', '')
      });
    } else if (jitsiTimeout > currentTime) {
      instance.tabBar.open('video');
    } else {
      dispatchToastMessage({
        type: 'info',
        message: TAPi18n.__('Call Already Ended', '')
      });
    }
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./views/bbbLiveView.html");
module.link("./tabBar");
module.link("./actionLink");
module.link("../lib/messageType");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/client/tabBar.tsx                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["label"],
    _excluded2 = ["label"];

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);
var React, useMemo, lazy;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useMemo: function (v) {
    useMemo = v;
  },
  lazy: function (v) {
    lazy = v;
  }
}, 0);
var useStableArray;
module.link("@rocket.chat/fuselage-hooks", {
  useStableArray: function (v) {
    useStableArray = v;
  }
}, 1);
var Option, Badge;
module.link("@rocket.chat/fuselage", {
  Option: function (v) {
    Option = v;
  },
  Badge: function (v) {
    Badge = v;
  }
}, 2);
var useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 3);
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 4);
var useTranslation;
module.link("../../../client/contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 5);
var useUser;
module.link("../../../client/contexts/UserContext", {
  useUser: function (v) {
    useUser = v;
  }
}, 6);
var Header;
module.link("../../../client/components/Header", {
  "default": function (v) {
    Header = v;
  }
}, 7);
var templateBBB = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../../../client/views/room/contextualBar/Call/BBB');
});
addAction('bbb_video', function (_ref) {
  var _room$muted;

  var room = _ref.room;
  var enabled = useSetting('bigbluebutton_Enabled');
  var t = useTranslation();
  var live = (room === null || room === void 0 ? void 0 : room.streamingOptions) && room.streamingOptions.type === 'call';
  var enabledDirect = useSetting('bigbluebutton_enable_d');
  var enabledGroup = useSetting('bigbluebutton_enable_p');
  var enabledChannel = useSetting('bigbluebutton_enable_c');
  var enabledTeams = useSetting('bigbluebutton_enable_teams');
  var groups = useStableArray([enabledDirect && 'direct', 'direct_multiple', enabledGroup && 'group', enabledTeams && 'team', enabledChannel && 'channel'].filter(Boolean));
  var user = useUser();
  var username = user ? user.username : '';
  var enableOption = enabled && (!username || !((_room$muted = room.muted) !== null && _room$muted !== void 0 && _room$muted.includes(username)));
  return useMemo(function () {
    return enableOption ? {
      groups: groups,
      id: 'bbb_video',
      title: 'BBB_Video_Call',
      icon: 'phone',
      template: templateBBB,
      order: live ? -1 : 4,
      renderAction: function (props) {
        return /*#__PURE__*/React.createElement(Header.ToolBoxAction, props, live ? /*#__PURE__*/React.createElement(Header.Badge, {
          title: t('Started_a_video_call'),
          variant: "primary"
        }, "!") : null);
      },
      renderOption: function (_ref2) {
        var _ref2$label = _ref2.label,
            title = _ref2$label.title,
            icon = _ref2$label.icon,
            props = _objectWithoutProperties(_ref2, _excluded);

        return /*#__PURE__*/React.createElement(Option, _extends({
          label: title,
          title: title,
          icon: icon
        }, props), /*#__PURE__*/React.createElement(Badge, {
          title: t('Started_a_video_call'),
          variant: "primary"
        }, "!"));
      }
    } : null;
  }, [enableOption, groups, live, t]);
});
var templateJitsi = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../../../client/views/room/contextualBar/Call/Jitsi');
});
addAction('video', function (_ref3) {
  var _room$muted2;

  var room = _ref3.room;
  var enabled = useSetting('Jitsi_Enabled');
  var t = useTranslation();
  var enabledChannel = useSetting('Jitsi_Enable_Channels');
  var enabledTeams = useSetting('Jitsi_Enable_Teams');
  var enabledLiveChat = useSetting('Omnichannel_call_provider') === 'Jitsi';
  var groups = useStableArray(['direct', 'direct_multiple', 'group', enabledLiveChat && 'live', enabledTeams && 'team', enabledChannel && 'channel'].filter(Boolean));
  var currentTime = new Date().getTime();
  var jitsiTimeout = new Date((room === null || room === void 0 ? void 0 : room.jitsiTimeout) || currentTime).getTime();
  var live = jitsiTimeout > currentTime || null;
  var user = useUser();
  var username = user ? user.username : '';
  var enableOption = enabled && (!username || !((_room$muted2 = room.muted) !== null && _room$muted2 !== void 0 && _room$muted2.includes(username)));
  return useMemo(function () {
    return enableOption ? {
      groups: groups,
      id: 'video',
      title: 'Call',
      icon: 'phone',
      template: templateJitsi,
      full: true,
      order: live ? -1 : 4,
      renderAction: function (props) {
        return /*#__PURE__*/React.createElement(Header.ToolBoxAction, props, live && /*#__PURE__*/React.createElement(Header.Badge, {
          title: t('Started_a_video_call'),
          variant: "primary"
        }, "!"));
      },
      renderOption: function (_ref4) {
        var _ref4$label = _ref4.label,
            title = _ref4$label.title,
            icon = _ref4$label.icon,
            props = _objectWithoutProperties(_ref4, _excluded2);

        return /*#__PURE__*/React.createElement(Option, _extends({
          label: title,
          title: title,
          icon: icon
        }, props), live && /*#__PURE__*/React.createElement(Badge, {
          title: t('Started_a_video_call'),
          variant: "primary"
        }, "!"));
      }
    } : null;
  }, [enableOption, groups, live, t]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"messageType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/videobridge/lib/messageType.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 1);
var MessageTypes;
module.link("../../ui-utils", {
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 2);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'jitsi_call_started',
    system: true,
    message: TAPi18n.__('Started_a_video_call')
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"constants.js":[]},"authorization":{"client":{"requiresPermission.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/requiresPermission.html                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.requiresPermission.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.requiresPermission.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/template.requiresPermission.js                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("requiresPermission");
Template["requiresPermission"] = new Template("Template.requiresPermission", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.dataMustache(view.lookup("hasPermission"), view.lookup("."));
  }, function() {
    return [ "\n\t\t", Blaze._InOuterTemplateScope(view, function() {
      return Spacebars.include(function() {
        return Spacebars.call(view.templateContentBlock);
      });
    }), "\n\t" ];
  }, function() {
    return [ "\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.templateElseBlock);
    }, function() {
      return [ "\n\t\t\t", Blaze._InOuterTemplateScope(view, function() {
        return Spacebars.include(function() {
          return Spacebars.call(view.templateElseBlock);
        });
      }), "\n\t\t" ];
    }, function() {
      return [ "\n\t\t\t", Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Not_found_or_not_allowed");
      }), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"lib":{"ChatPermissions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/lib/ChatPermissions.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ChatPermissions: function () {
    return ChatPermissions;
  }
});
var AuthzCachedCollection;
module.link("../../../models", {
  AuthzCachedCollection: function (v) {
    AuthzCachedCollection = v;
  }
}, 0);
var ChatPermissions = AuthzCachedCollection.collection;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"streamer.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/lib/streamer.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  rolesStreamer: function () {
    return rolesStreamer;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var rolesStreamer = new Meteor.Streamer('roles');
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"hasPermission.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/hasPermission.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  hasAllPermission: function () {
    return hasAllPermission;
  },
  hasAtLeastOnePermission: function () {
    return hasAtLeastOnePermission;
  },
  userHasAllPermission: function () {
    return userHasAllPermission;
  },
  hasPermission: function () {
    return hasPermission;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ChatPermissions;
module.link("./lib/ChatPermissions", {
  ChatPermissions: function (v) {
    ChatPermissions = v;
  }
}, 1);
var Models;
module.link("../../models/client", {
  "*": function (v) {
    Models = v;
  }
}, 2);
var AuthorizationUtils;
module.link("../lib/AuthorizationUtils", {
  AuthorizationUtils: function (v) {
    AuthorizationUtils = v;
  }
}, 3);

var isValidScope = function (scope) {
  return typeof scope === 'string' && scope in Models;
};

var createPermissionValidator = function (quantifier) {
  return function (permissionIds, scope, userId) {
    var user = Models.Users.findOneById(userId, {
      fields: {
        roles: 1
      }
    });
    var checkEachPermission = quantifier.bind(permissionIds);
    return checkEachPermission(function (permissionId) {
      var _permission$roles;

      if (user !== null && user !== void 0 && user.roles) {
        if (AuthorizationUtils.isPermissionRestrictedForRoleList(permissionId, user.roles)) {
          return false;
        }
      }

      var permission = ChatPermissions.findOne(permissionId, {
        fields: {
          roles: 1
        }
      });
      var roles = (_permission$roles = permission === null || permission === void 0 ? void 0 : permission.roles) !== null && _permission$roles !== void 0 ? _permission$roles : [];
      return roles.some(function (roleName) {
        var role = Models.Roles.findOne(roleName, {
          fields: {
            scope: 1
          }
        });
        var roleScope = role === null || role === void 0 ? void 0 : role.scope;

        if (!isValidScope(roleScope)) {
          return false;
        }

        var model = Models[roleScope];
        return model.isUserInRole && model.isUserInRole(userId, roleName, scope);
      });
    });
  };
};

var atLeastOne = createPermissionValidator(Array.prototype.some);
var all = createPermissionValidator(Array.prototype.every);

var validatePermissions = function (permissions, scope, predicate, userId) {
  var _userId;

  userId = (_userId = userId) !== null && _userId !== void 0 ? _userId : Meteor.userId();

  if (!userId) {
    return false;
  }

  if (!Models.AuthzCachedCollection.ready.get()) {
    return false;
  }

  return predicate([].concat(permissions), scope, userId);
};

var hasAllPermission = function (permissions, scope) {
  return validatePermissions(permissions, scope, all);
};

var hasAtLeastOnePermission = function (permissions, scope) {
  return validatePermissions(permissions, scope, atLeastOne);
};

var userHasAllPermission = function (permissions, scope, userId) {
  return validatePermissions(permissions, scope, all, userId);
};

var hasPermission = hasAllPermission;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hasRole.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/hasRole.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  hasRole: function () {
    return hasRole;
  }
});
var Roles;
module.link("../../models", {
  Roles: function (v) {
    Roles = v;
  }
}, 0);

var hasRole = function (userId, roleNames, scope) {
  roleNames = [].concat(roleNames);
  return Roles.isUserInRoles(userId, roleNames, scope);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  hasAllPermission: function () {
    return hasAllPermission;
  },
  hasAtLeastOnePermission: function () {
    return hasAtLeastOnePermission;
  },
  hasRole: function () {
    return hasRole;
  },
  hasPermission: function () {
    return hasPermission;
  },
  userHasAllPermission: function () {
    return userHasAllPermission;
  },
  AuthorizationUtils: function () {
    return AuthorizationUtils;
  }
});
var hasAllPermission, hasAtLeastOnePermission, hasPermission, userHasAllPermission;
module.link("./hasPermission", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  },
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  },
  hasPermission: function (v) {
    hasPermission = v;
  },
  userHasAllPermission: function (v) {
    userHasAllPermission = v;
  }
}, 0);
var hasRole;
module.link("./hasRole", {
  hasRole: function (v) {
    hasRole = v;
  }
}, 1);
var AuthorizationUtils;
module.link("../lib/AuthorizationUtils", {
  AuthorizationUtils: function (v) {
    AuthorizationUtils = v;
  }
}, 2);
module.link("./requiresPermission.html");
module.link("./startup");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/client/startup.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var hasAtLeastOnePermission;
module.link("./hasPermission", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 2);
var CachedCollectionManager;
module.link("../../ui-cached-collection", {
  CachedCollectionManager: function (v) {
    CachedCollectionManager = v;
  }
}, 3);
var APIClient;
module.link("../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 4);
var Roles;
module.link("../../models/client", {
  Roles: function (v) {
    Roles = v;
  }
}, 5);
var rolesStreamer;
module.link("./lib/streamer", {
  rolesStreamer: function (v) {
    rolesStreamer = v;
  }
}, 6);
var registerAdminSidebarItem;
module.link("../../../client/views/admin", {
  registerAdminSidebarItem: function (v) {
    registerAdminSidebarItem = v;
  }
}, 7);
Meteor.startup(function () {
  CachedCollectionManager.onLogin(function () {
    function _callee() {
      var _await$APIClient$v1$g, roles;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return _regeneratorRuntime.awrap(APIClient.v1.get('roles.list'));

              case 2:
                _await$APIClient$v1$g = _context.sent;
                roles = _await$APIClient$v1$g.roles;
                // if a role is checked before this collection is populated, it will return undefined
                Roles._collection._docs._map = new Map(roles.map(function (record) {
                  return [record._id, record];
                }));
                Object.values(Roles._collection.queries).forEach(function (query) {
                  return Roles._collection._recomputeResults(query);
                });
                Roles.ready.set(true);

              case 7:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }());
  registerAdminSidebarItem({
    href: 'admin-permissions',
    i18nLabel: 'Permissions',
    icon: 'lock',
    permissionGranted: function () {
      return hasAtLeastOnePermission(['access-permissions', 'access-setting-permissions']);
    }
  });
  var events = {
    changed: function (role) {
      delete role.type;
      Roles.upsert({
        _id: role._id
      }, role);
    },
    removed: function (role) {
      Roles.remove({
        _id: role._id
      });
    }
  };
  Tracker.autorun(function (c) {
    if (!Meteor.userId()) {
      return;
    }

    rolesStreamer.on('roles', function (role) {
      return events[role.type](role);
    });
    c.stop();
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"AuthorizationUtils.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/lib/AuthorizationUtils.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 0);
module.export({
  AuthorizationUtils: function () {
    return AuthorizationUtils;
  }
});
var restrictedRolePermissions = new Map();

var AuthorizationUtils = /*#__PURE__*/function () {
  function AuthorizationUtils() {}

  AuthorizationUtils.addRolePermissionWhiteList = function () {
    function addRolePermissionWhiteList(roleId, list) {
      if (!roleId) {
        throw new Error('invalid-param');
      }

      if (!list) {
        throw new Error('invalid-param');
      }

      if (!restrictedRolePermissions.has(roleId)) {
        restrictedRolePermissions.set(roleId, new Set());
      }

      var rules = restrictedRolePermissions.get(roleId);

      for (var _iterator = _createForOfIteratorHelperLoose(list), _step; !(_step = _iterator()).done;) {
        var permissionId = _step.value;
        rules.add(permissionId);
      }
    }

    return addRolePermissionWhiteList;
  }();

  AuthorizationUtils.isPermissionRestrictedForRole = function () {
    function isPermissionRestrictedForRole(permissionId, roleId) {
      if (!roleId || !permissionId) {
        throw new Error('invalid-param');
      }

      if (!restrictedRolePermissions.has(roleId)) {
        return false;
      }

      var rules = restrictedRolePermissions.get(roleId);

      if (!rules || !rules.size) {
        return false;
      }

      return !rules.has(permissionId);
    }

    return isPermissionRestrictedForRole;
  }();

  AuthorizationUtils.isPermissionRestrictedForRoleList = function () {
    function isPermissionRestrictedForRoleList(permissionId, roleList) {
      if (!roleList || !permissionId) {
        throw new Error('invalid-param');
      }

      for (var _iterator2 = _createForOfIteratorHelperLoose(roleList), _step2; !(_step2 = _iterator2()).done;) {
        var roleId = _step2.value;

        if (this.isPermissionRestrictedForRole(permissionId, roleId)) {
          return true;
        }
      }

      return false;
    }

    return isPermissionRestrictedForRoleList;
  }();

  return AuthorizationUtils;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":[
  "./AuthorizationUtils"
]},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/authorization/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"emoji":{"client":{"emojiPicker.html":[
  "./template.emojiPicker.js"
],"template.emojiPicker.js":[],"lib":{"EmojiPicker.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji/client/lib/EmojiPicker.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  EmojiPicker: function () {
    return EmojiPicker;
  }
});

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 2);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 3);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 4);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 5);
var emoji;
module.link("../../lib/rocketchat", {
  emoji: function (v) {
    emoji = v;
  }
}, 6);
var updatePositions = true;
var EmojiPicker = {
  width: 365,
  height: 300,
  initiated: false,
  input: null,
  source: null,
  recent: [],
  tone: null,
  opened: false,
  pickCallback: null,
  scrollingToCategory: false,
  currentCategory: new ReactiveVar('recent'),
  init: function () {
    function _callee() {
      var _this = this;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (!this.initiated) {
                  _context.next = 2;
                  break;
                }

                return _context.abrupt("return");

              case 2:
                this.initiated = true;
                this.recent = Meteor._localStorage.getItem('emoji.recent') ? Meteor._localStorage.getItem('emoji.recent').split(',') : [];
                this.tone = Meteor._localStorage.getItem('emoji.tone') || 0;
                Blaze.render(Template.emojiPicker, document.body);
                $(document).click(function (event) {
                  if (!_this.opened) {
                    return;
                  }

                  if (!$(event.target).closest('.emoji-picker').length && !$(event.target).is('.emoji-picker')) {
                    if (_this.opened) {
                      _this.close();
                    }
                  }
                });
                $(window).resize(_.debounce(function () {
                  if (!_this.opened) {
                    return;
                  }

                  _this.setPosition();
                }, 300));

              case 8:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, this, null, Promise);
    }

    return _callee;
  }(),
  isOpened: function () {
    return this.opened;
  },
  setTone: function (tone) {
    this.tone = tone;

    Meteor._localStorage.setItem('emoji.tone', tone);
  },
  getTone: function () {
    return this.tone;
  },
  getRecent: function () {
    return this.recent;
  },
  setPosition: function () {
    var windowHeight = window.innerHeight;
    var windowWidth = window.innerWidth;
    var windowBorder = 10;
    var sourcePos = $(this.source).offset();
    var left = sourcePos.left,
        top = sourcePos.top;
    var cssProperties = {
      top: top,
      left: left
    };
    var isLargerThanWindow = this.width + windowBorder > windowWidth;

    if (top + this.height >= windowHeight) {
      cssProperties.top = windowHeight - this.height - windowBorder - 75;
    }

    if (left < windowBorder) {
      cssProperties.left = isLargerThanWindow ? 0 : windowBorder;
    }

    if (left + this.width >= windowWidth) {
      cssProperties.left = isLargerThanWindow ? 0 : windowWidth - this.width - windowBorder;
    }

    return $('.emoji-picker').css(cssProperties);
  },
  open: function () {
    function _callee2(source, callback) {
      var containerEl, emojiInput;
      return _regeneratorRuntime.async(function () {
        function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                if (this.initiated) {
                  _context2.next = 3;
                  break;
                }

                _context2.next = 3;
                return _regeneratorRuntime.awrap(this.init());

              case 3:
                this.pickCallback = callback;
                this.source = source;
                containerEl = this.setPosition();
                containerEl.addClass('show');
                emojiInput = containerEl.find('.js-emojipicker-search');

                if (emojiInput) {
                  emojiInput.focus();
                }

                this.calculateCategoryPositions();

                if (this.recent.length === 0 && this.currentCategory.get() === 'recent') {
                  this.showCategory(emoji.packages.emojiCustom.list.length > 0 ? 'rocket' : 'people', false);
                }

                this.opened = true;

              case 12:
              case "end":
                return _context2.stop();
            }
          }
        }

        return _callee2$;
      }(), null, this, null, Promise);
    }

    return _callee2;
  }(),
  close: function () {
    $('.emoji-picker').removeClass('show');
    this.opened = false;
    this.source.focus();
  },
  pickEmoji: function (emoji) {
    this.pickCallback(emoji);
    this.close();
    this.addRecent(emoji);
  },
  addRecent: function (_emoji) {
    var pos = this.recent.indexOf(_emoji);

    if (pos !== -1) {
      this.recent.splice(pos, 1);
    }

    this.recent.unshift(_emoji); // limit recent emojis to 27 (3 rows of 9)

    this.recent.splice(27);
    updatePositions = true;

    Meteor._localStorage.setItem('emoji.recent', this.recent);

    emoji.packages.base.emojisByCategory.recent = this.recent;
    this.updateRecent('recent');
  },
  removeFromRecent: function (_emoji) {
    var pos = this.recent.indexOf(_emoji);

    if (pos === -1) {
      return;
    }

    this.recent.splice(pos, 1);

    Meteor._localStorage.setItem('emoji.recent', this.recent);
  },
  updateRecent: function () {
    function _callee3(category) {
      var emojiPickerImport, updateRecentEmoji;
      return _regeneratorRuntime.async(function () {
        function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                _context3.next = 2;
                return _regeneratorRuntime.awrap(module.dynamicImport('../emojiPicker'));

              case 2:
                emojiPickerImport = _context3.sent;
                updateRecentEmoji = emojiPickerImport.updateRecentEmoji;
                updateRecentEmoji(category);

              case 5:
              case "end":
                return _context3.stop();
            }
          }
        }

        return _callee3$;
      }(), null, null, null, Promise);
    }

    return _callee3;
  }(),
  calculateCategoryPositions: function () {
    if (!updatePositions) {
      return;
    }

    updatePositions = false;
    var containerScroll = $('.emoji-picker .emojis').scrollTop();
    this.catPositions = Array.from(document.querySelectorAll('.emoji-list-category')).map(function (el) {
      var _$$position = $(el).position(),
          top = _$$position.top;

      return {
        el: el,
        top: top + containerScroll
      };
    });
  },
  getCategoryPositions: function () {
    return this.catPositions;
  },
  showCategory: function (category) {
    var _this2 = this;

    var animate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
    this.scrollingToCategory = animate;
    $('.emoji-picker .js-emojipicker-search').val('').change().focus();
    this.currentCategory.set(category);
    Tracker.afterFlush(function () {
      var header = $("#emoji-list-category-" + category);
      var container = $('.emoji-picker .emojis');
      var scrollTop = header.position().top + container.scrollTop(); // - container.position().top;

      if (animate) {
        return container.animate({
          scrollTop: scrollTop
        }, 300, function () {
          _this2.scrollingToCategory = false;
        });
      }

      container.scrollTop(scrollTop);
    });
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"emojiParser.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji/client/emojiParser.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);
module.export({
  emojiParser: function () {
    return emojiParser;
  },
  createEmojiMessageRenderer: function () {
    return createEmojiMessageRenderer;
  }
});
var isIE11;
module.link("../../../client/lib/utils/isIE11", {
  isIE11: function (v) {
    isIE11 = v;
  }
}, 0);
var emoji;
module.link("../lib/rocketchat", {
  emoji: function (v) {
    emoji = v;
  }
}, 1);

/*
 * emojiParser is a function that will replace emojis
 * @param {Object} message - The message object
 */
var emojiParser = function (message) {
  var _message$html;

  if (!((_message$html = message.html) !== null && _message$html !== void 0 && _message$html.trim())) {
    return message;
  }

  var html = message.html.trim(); // &#39; to apostrophe (') for emojis such as :')

  html = html.replace(/&#39;/g, "'"); // '<br>' to ' <br> ' for emojis such at line breaks

  html = html.replace(/<br>/g, ' <br> ');
  html = Object.entries(emoji.packages).reverse().reduce(function (value, _ref) {
    var _ref2 = _slicedToArray(_ref, 2),
        emojiPackage = _ref2[1];

    return emojiPackage.render(value);
  }, html);
  var checkEmojiOnly = document.createElement('div');
  checkEmojiOnly.innerHTML = html;
  var emojis = Array.from(checkEmojiOnly.querySelectorAll('.emoji:not(:empty), .emojione:not(:empty)'));
  var hasText = false;

  if (!isIE11) {
    var filter = function (node) {
      if (node.nodeType === Node.ELEMENT_NODE && (node.classList.contains('emojione') || node.classList.contains('emoji'))) {
        return NodeFilter.FILTER_REJECT;
      }

      return NodeFilter.FILTER_ACCEPT;
    };

    var walker = document.createTreeWalker(checkEmojiOnly, NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_TEXT, filter);

    while (walker.nextNode()) {
      if (walker.currentNode.nodeType === Node.TEXT_NODE && walker.currentNode.nodeValue.trim() !== '') {
        hasText = true;
        break;
      }
    }

    var emojiOnly = emojis.length && !hasText;

    if (emojiOnly) {
      for (var i = 0, len = emojis.length; i < len; i++) {
        var classList = emojis[i].classList;
        classList.add('big');
      }

      html = checkEmojiOnly.innerHTML;
    }
  } // apostrophe (') back to &#39;


  html = html.replace(/\'/g, '&#39;'); // line breaks ' <br> ' back to '<br>'

  html = html.replace(/ <br> /g, '<br>');
  return _objectSpread(_objectSpread({}, message), {}, {
    html: html
  });
};

var createEmojiMessageRenderer = function () {
  return emojiParser;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emojiPicker.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "underscore",
  "meteor/reactive-var",
  "meteor/reactive-dict",
  "meteor/kadira:flow-router",
  "meteor/templating",
  "@rocket.chat/string-helpers",
  "../../theme/client/imports/components/emojiPicker.css",
  "../../utils/client",
  "./lib/EmojiPicker",
  "../lib/rocketchat",
  "./emojiPicker.html"
],"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji/client/index.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/EmojiPicker", {
  EmojiPicker: "EmojiPicker"
}, 0);
module.link("../lib/rocketchat", {
  emoji: "emoji"
}, 1);
module.link("./emojiParser", {
  createEmojiMessageRenderer: "createEmojiMessageRenderer"
}, 2);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"rocketchat.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji/lib/rocketchat.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  emoji: function () {
    return emoji;
  }
});
var emojioneRender;
module.link("../../emoji-emojione/lib/emojioneRender", {
  emojioneRender: function (v) {
    emojioneRender = v;
  }
}, 0);
var EmojiPicker;

var removeFromRecent = function (emoji) {
  if (!EmojiPicker) {
    // since this function will be only called client side, the import needs to happen here
    var _require = require('../client/lib/EmojiPicker');

    EmojiPicker = _require.EmojiPicker;
  }

  EmojiPicker.removeFromRecent(emoji.replace(/(^:|:$)/g, ''));
};

var emoji = {
  packages: {
    base: {
      emojiCategories: [{
        key: 'recent',
        i18n: 'Frequently_Used'
      }],
      categoryIndex: 0,
      emojisByCategory: {
        recent: []
      },
      toneList: {},
      render: emojioneRender,
      renderPicker: function (emojiToRender) {
        if (!emoji.list[emojiToRender]) {
          removeFromRecent(emojiToRender);
          return;
        }

        var correctPackage = emoji.list[emojiToRender].emojiPackage;
        return emoji.packages[correctPackage].renderPicker(emojiToRender);
      }
    }
  },
  list: {}
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji/index.js                                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lazy-load":{"client":{"lazyloadImage.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lazy-load/client/lazyloadImage.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.lazyloadImage.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.lazyloadImage.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lazy-load/client/template.lazyloadImage.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("lazyloadImage");
Template["lazyloadImage"] = new Template("Template.lazyloadImage", (function() {
  var view = this;
  return HTML.IMG({
    "data-src": function() {
      return Spacebars.mustache(view.lookup("srcUrl"));
    },
    src: function() {
      return Spacebars.mustache(view.lookup("lazySrcUrl"));
    },
    alt: function() {
      return Spacebars.mustache(view.lookup("alt"));
    },
    height: function() {
      return Spacebars.mustache(view.lookup("height"));
    },
    class: function() {
      return Spacebars.mustache(view.lookup("class"));
    },
    "data-title": function() {
      return Spacebars.mustache(view.lookup("title"));
    },
    "data-description": function() {
      return Spacebars.mustache(view.lookup("description"));
    }
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lazy-load/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  addImage: function () {
    return addImage;
  }
});
module.link("./lazyloadImage");
var map = new WeakMap();
var featureExists = !!window.IntersectionObserver;

var loadImage = function (el) {
  var instance = map.get(el);
  map.delete(el);

  if (!instance) {
    return;
  }

  var img = new Image();
  var src = el.getAttribute('data-src');

  img.onload = function () {
    el.className = el.className.replace('lazy-img', '');
    el.src = src;
    el.removeAttribute('data-src');
    instance.loaded.set(true);
  };

  img.src = src;
};

var observer = featureExists && new IntersectionObserver(function (entries, observer) {
  return entries.forEach(function (entry) {
    if (entry.isIntersecting) {
      observer.unobserve(entry.target);
      return loadImage(entry.target);
    }
  });
}, {
  threshold: [0],
  trackVisibility: true,
  delay: 230
});

var addImage = function (instance) {
  var el = instance.firstNode;
  map.set(el, instance);

  if (featureExists) {
    return observer.observe(el);
  }

  loadImage(el);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"lazyloadImage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/lazy-load/client/lazyloadImage.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
module.link("./lazyloadImage.html");
var addImage;
module.link(".", {
  addImage: function (v) {
    addImage = v;
  }
}, 2);
var emptyImageEncoded = 'iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8+/u3PQAJJAM0dIyWdgAAAABJRU5ErkJggg==';
var imgsrcs = new Set();
Template.lazyloadImage.helpers({
  "class": function () {
    var loaded = Template.instance().loaded.get();
    return this.class + " " + (loaded ? '' : 'lazy-img');
  },
  srcUrl: function () {
    if (Template.instance().loaded.get()) {
      return;
    }

    return this.src;
  },
  lazySrcUrl: function () {
    var preview = this.preview,
        placeholder = this.placeholder,
        src = this.src;

    var _Template$instance = Template.instance(),
        loaded = _Template$instance.loaded;

    if (loaded.get() || !preview && !placeholder || imgsrcs.has(src)) {
      return src;
    }

    imgsrcs.add(this.src);
    return "data:image/png;base64," + (preview || emptyImageEncoded);
  }
});
Template.lazyloadImage.onCreated(function () {
  this.loaded = new ReactiveVar(false);
});
Template.lazyloadImage.onRendered(function () {
  addImage(this);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"meteor-autocomplete":{"client":{"inputs.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/inputs.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.inputs.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.inputs.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/template.inputs.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("inputAutocomplete");
Template["inputAutocomplete"] = new Template("Template.inputAutocomplete", (function() {
  var view = this;
  return [ HTML.INPUT(HTML.Attrs({
    type: "text"
  }, function() {
    return Spacebars.attrMustache(view.lookup("attributes"));
  })), "\n    ", Spacebars.include(view.lookupTemplate("autocompleteContainer")) ];
}));

Template.__checkName("textareaAutocomplete");
Template["textareaAutocomplete"] = new Template("Template.textareaAutocomplete", (function() {
  var view = this;
  return [ HTML.TEXTAREA(HTML.Attrs(function() {
    return Spacebars.attrMustache(view.lookup("attributes"));
  }, {
    value: function() {
      return Blaze._InOuterTemplateScope(view, function() {
        return Spacebars.include(function() {
          return Spacebars.call(view.templateContentBlock);
        });
      });
    }
  })), "\n    ", Spacebars.include(view.lookupTemplate("autocompleteContainer")) ];
}));

Template.__checkName("_autocompleteContainer");
Template["_autocompleteContainer"] = new Template("Template._autocompleteContainer", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isShowing"));
  }, function() {
    return [ "\n    ", HTML.DIV({
      class: "-autocomplete-container"
    }, "\n        ", Blaze.If(function() {
      return Spacebars.call(view.lookup("isLoaded"));
    }, function() {
      return [ "\n            ", Blaze.Unless(function() {
        return Spacebars.call(view.lookup("empty"));
      }, function() {
        return [ "\n            ", HTML.UL({
          class: "-autocomplete-list"
        }, "\n                ", Blaze.Each(function() {
          return Spacebars.call(view.lookup("filteredList"));
        }, function() {
          return [ "\n                ", HTML.LI({
            class: "-autocomplete-item"
          }, "\n                    ", Spacebars.With(function() {
            return Spacebars.call(Spacebars.dot(view.lookup(".."), "currentTemplate"));
          }, function() {
            return [ "\n                        ", Spacebars.With(function() {
              return Spacebars.call(view.lookup(".."));
            }, function() {
              return [ "  \n                            ", Spacebars.include(view.lookupTemplate("..")), "  \n                        " ];
            }), "\n                    " ];
          }), "\n                "), "\n                " ];
        }), "\n            "), "\n            " ];
      }, function() {
        return [ "\n                ", Spacebars.include(view.lookupTemplate("noMatchTemplate")), "\n            " ];
      }), "\n        " ];
    }, function() {
      return [ "\n            ", Spacebars.include(view.lookupTemplate("loading")), "\n        " ];
    }), "\n    "), "\n    " ];
  });
}));

Template.__checkName("_noMatch");
Template["_noMatch"] = new Template("Template._noMatch", (function() {
  var view = this;
  return HTML.Raw("(<i>no matches</i>)");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"autocomplete-client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/autocomplete-client.js                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 2);
module.export({
  "default": function () {
    return AutoComplete;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Match;
module.link("meteor/check", {
  Match: function (v) {
    Match = v;
  }
}, 1);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 2);
var Deps;
module.link("meteor/deps", {
  Deps: function (v) {
    Deps = v;
  }
}, 3);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 4);
var getCaretCoordinates;
module.link("meteor/dandv:caret-position", {
  getCaretCoordinates: function (v) {
    getCaretCoordinates = v;
  }
}, 5);
var AutoCompleteRecords;
module.link("./collection", {
  "default": function (v) {
    AutoCompleteRecords = v;
  }
}, 6);
var APIClient;
module.link("../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 7);

var isServerSearch = function (rule) {
  return _.isString(rule.collection);
};

var validateRule = function (rule) {
  if (rule.subscription != null && !Match.test(rule.collection, String)) {
    throw new Error('Collection name must be specified as string for server-side search');
  } // XXX back-compat message, to be removed


  if (rule.callback) {
    console.warn('autocomplete no longer supports callbacks; use event listeners instead.');
  }
};

var isWholeField = function (rule) {
  // either '' or null both count as whole field.
  return !rule.token;
};

var getRegExp = function (rule) {
  if (!isWholeField(rule)) {
    // Expressions for the range from the last word break to the current cursor position
    return new RegExp("(^|\\b|\\s)" + rule.token + "([\\w.]*)$");
  } // Whole-field behavior - word characters or spaces


  return new RegExp('(^)(.*)$');
};

var getFindParams = function (rule, filter, limit) {
  // This is a different 'filter' - the selector from the settings
  // We need to extend so that we don't copy over rule.filter
  var selector = _.extend({}, rule.filter || {});

  var options = {
    limit: limit
  };

  if (!filter) {
    // Match anything, no sort, limit X
    return [selector, options];
  }

  if (rule.sort && rule.field) {
    var sortspec = {}; // Only sort if there is a filter, for faster performance on a match of anything

    sortspec[rule.field] = 1;
    options.sort = sortspec;
  }

  if (_.isFunction(rule.selector)) {
    // Custom selector
    _.extend(selector, rule.selector(filter));
  } else {
    selector[rule.field] = {
      $regex: rule.matchAll ? filter : "^" + filter,
      // default is case insensitive search - empty string is not the same as undefined!
      $options: typeof rule.options === 'undefined' ? 'i' : rule.options
    };
  }

  return [selector, options];
};

var getField = function (obj, str) {
  var string = str.split('.');
  string.forEach(function (key) {
    obj = obj[key];
  });
  return obj;
};

var AutoComplete = /*#__PURE__*/function () {
  function AutoComplete(settings) {
    var _this = this;

    this.KEYS = [40, 38, 13, 27, 9];
    this.limit = settings.limit || 5;
    this.position = settings.position || 'bottom';
    this.rules = settings.rules;
    this.selector = _objectSpread({
      container: '.-autocomplete-container',
      item: '.-autocomplete-item'
    }, settings.selector);
    var rules = this.rules;
    Object.keys(rules).forEach(function (key) {
      var rule = rules[key];
      validateRule(rule);
    });
    this.onSelect = settings.onSelect;

    this.expressions = function () {
      return Object.keys(rules).map(function (key) {
        var rule = rules[key];
        return getRegExp(rule);
      });
    }();

    this.matched = -1;
    this.loaded = true; // Reactive dependencies for current matching rule and filter

    this.ruleDep = new Deps.Dependency();
    this.filterDep = new Deps.Dependency();
    this.loadingDep = new Deps.Dependency(); // Autosubscribe to the record set published by the server based on the filter
    // This will tear down server subscriptions when they are no longer being used.

    this.sub = null;
    this.comp = Deps.autorun(function () {
      function _callee() {
        var rule, filter, _getFindParams, _getFindParams2, selector, endpointName, _await$APIClient$v1$g, items;

        return _regeneratorRuntime.async(function () {
          function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  rule = _this.matchedRule();
                  filter = _this.getFilter();

                  if (_this.sub) {
                    // Stop any existing sub immediately, don't wait
                    _this.sub.stop();
                  }

                  if (rule && filter) {
                    _context.next = 5;
                    break;
                  }

                  return _context.abrupt("return");

                case 5:
                  if (isServerSearch(rule)) {
                    _context.next = 8;
                    break;
                  }

                  _this.setLoaded(true);

                  return _context.abrupt("return");

                case 8:
                  _getFindParams = getFindParams(rule, filter, _this.limit), _getFindParams2 = _slicedToArray(_getFindParams, 1), selector = _getFindParams2[0]; // console.debug 'Subscribing to <%s> in <%s>.<%s>', filter, rule.collection, rule.field

                  _this.setLoaded(false);

                  endpointName = rule.endpoint || 'users.autocomplete';
                  _context.next = 13;
                  return _regeneratorRuntime.awrap(APIClient.v1.get(endpointName + "?selector=" + JSON.stringify(selector)));

                case 13:
                  _await$APIClient$v1$g = _context.sent;
                  items = _await$APIClient$v1$g.items;
                  AutoCompleteRecords.remove({});
                  items.forEach(function (item) {
                    return AutoCompleteRecords.insert(item);
                  });

                  _this.setLoaded(true);

                case 18:
                case "end":
                  return _context.stop();
              }
            }
          }

          return _callee$;
        }(), null, null, null, Promise);
      }

      return _callee;
    }());
  }

  var _proto = AutoComplete.prototype;

  _proto.teardown = function () {
    function teardown() {
      // Stop the reactive computation we started for this autocomplete instance
      this.comp.stop();
    }

    return teardown;
  }();

  _proto.matchedRule = function () {
    function matchedRule() {
      // reactive getters and setters for @filter and the currently matched rule
      this.ruleDep.depend();

      if (this.matched >= 0) {
        return this.rules[this.matched];
      }

      return null;
    }

    return matchedRule;
  }();

  _proto.setMatchedRule = function () {
    function setMatchedRule(i) {
      this.matched = i;
      this.ruleDep.changed();
    }

    return setMatchedRule;
  }();

  _proto.getFilter = function () {
    function getFilter() {
      this.filterDep.depend();
      return this.filter;
    }

    return getFilter;
  }();

  _proto.setFilter = function () {
    function setFilter(x) {
      this.filter = x;
      this.filterDep.changed();
      return this.filter;
    }

    return setFilter;
  }();

  _proto.isLoaded = function () {
    function isLoaded() {
      this.loadingDep.depend();
      return this.loaded;
    }

    return isLoaded;
  }();

  _proto.setLoaded = function () {
    function setLoaded(val) {
      if (val === this.loaded) {
        return; // Don't cause redraws unnecessarily
      }

      this.loaded = val;
      this.loadingDep.changed();
    }

    return setLoaded;
  }();

  _proto.onKeyUp = function () {
    function onKeyUp() {
      var _this2 = this;

      if (!this.$element) {
        return; // Don't try to do this while loading
      }

      if (this._timeoutHandler) {
        clearTimeout(this._timeoutHandler);
      }

      this._timeoutHandler = setTimeout(function () {
        _this2._timeoutHandler = 0;
        var startpos = _this2.element.selectionStart;

        var val = _this2.getText().substring(0, startpos);
        /*
        	Matching on multiple expressions.
        	We always go from a matched state to an unmatched one
        	before going to a different matched one.
         */


        var i = 0;
        var breakLoop = false;

        while (i < _this2.expressions.length) {
          var matches = val.match(_this2.expressions[i]); // matching -> not matching

          if (!matches && _this2.matched === i) {
            _this2.setMatchedRule(-1);

            breakLoop = true;
          } // not matching -> matching


          if (matches && _this2.matched === -1) {
            _this2.setMatchedRule(i);

            breakLoop = true;
          } // Did filter change?


          if (matches && _this2.filter !== matches[2]) {
            _this2.setFilter(matches[2]);

            breakLoop = true;
          }

          if (breakLoop) {
            break;
          }

          i++;
        }
      }, 300);
    }

    return onKeyUp;
  }();

  _proto.onKeyDown = function () {
    function onKeyDown(e) {
      if (this.matched === -1 || this.KEYS.indexOf(e.keyCode) < 0) {
        return;
      }

      switch (e.keyCode) {
        case 9: // TAB

        case 13:
          // ENTER
          if (this.select()) {
            // Don't jump fields or submit if select successful
            e.preventDefault();
            e.stopPropagation();
          }

          break;
        // preventDefault needed below to avoid moving cursor when selecting

        case 40:
          // DOWN
          e.preventDefault();
          this.next();
          break;

        case 38:
          // UP
          e.preventDefault();
          this.prev();
          break;

        case 27:
          // ESCAPE
          this.$element.blur();
          this.hideList();
      }
    }

    return onKeyDown;
  }();

  _proto.onFocus = function () {
    function onFocus() {
      var _this3 = this;

      // We need to run onKeyUp after the focus resolves,
      // or the caret position (selectionStart) will not be correct
      Meteor.defer(function () {
        return _this3.onKeyUp();
      });
    }

    return onFocus;
  }();

  _proto.onBlur = function () {
    function onBlur() {
      var _this4 = this;

      // We need to delay this so click events work
      // TODO this is a bit of a hack, see if we can't be smarter
      Meteor.setTimeout(function () {
        _this4.hideList();
      }, 500);
    }

    return onBlur;
  }();

  _proto.onItemClick = function () {
    function onItemClick(doc) {
      this.processSelection(doc, this.rules[this.matched]);
    }

    return onItemClick;
  }();

  _proto.onItemHover = function () {
    function onItemHover(doc, e) {
      this.tmplInst.$(this.selector.item).removeClass('selected');
      $(e.target).closest(this.selector.item).addClass('selected');
    }

    return onItemHover;
  }();

  _proto.filteredList = function () {
    function filteredList() {
      var _this5 = this;

      // @ruleDep.depend() # optional as long as we use depend on filter, because list will always get re-rendered
      var filter = this.getFilter(); // Reactively depend on the filter

      if (this.matched === -1) {
        return null;
      }

      var rule = this.rules[this.matched]; // Don't display list unless we have a token or a filter (or both)
      // Single field: nothing displayed until something is typed

      if (!(rule.token || filter)) {
        return null;
      }

      var params = getFindParams(rule, filter, this.limit);
      var selector = params[0];
      var options = params[1];
      Meteor.defer(function () {
        return _this5.ensureSelection();
      }); // if server collection, the server has already done the filtering work

      if (isServerSearch(rule)) {
        return AutoCompleteRecords.find({}, options);
      } // Otherwise, search on client


      return rule.collection.find(selector, options);
    }

    return filteredList;
  }();

  _proto.isShowing = function () {
    function isShowing() {
      var _this6 = this;

      var rule = this.matchedRule(); // Same rules as above

      var showing = rule && (rule.token || this.getFilter()); // Do this after the render

      if (showing) {
        Meteor.defer(function () {
          _this6.positionContainer();

          _this6.ensureSelection();
        });
      }

      return showing;
    }

    return isShowing;
  }() // Replace text with currently selected item
  ;

  _proto.select = function () {
    function select() {
      var node = this.tmplInst.find(this.selector.item + ".selected");

      if (node == null) {
        return false;
      }

      var doc = Blaze.getData(node);

      if (!doc) {
        return false; // Don't select if nothing matched
      }

      this.processSelection(doc, this.rules[this.matched]);
      return true;
    }

    return select;
  }();

  _proto.processSelection = function () {
    function processSelection(doc, rule) {
      var replacement = getField(doc, rule.field);

      if (!isWholeField(rule)) {
        this.replace(replacement, rule);
        this.hideList();
      } else {
        // Empty string or doesn't exist?
        // Single-field replacement: replace whole field
        this.setText(replacement); // Field retains focus, but list is hidden unless another key is pressed
        // Must be deferred or onKeyUp will trigger and match again
        // TODO this is a hack; see above

        this.onBlur();
      }

      this.onSelect && this.onSelect(doc);
      this.$element.trigger('autocompleteselect', doc);
    }

    return processSelection;
  }() // Replace the appropriate region
  ;

  _proto.replace = function () {
    function replace(replacement) {
      var startpos = this.element.selectionStart;
      var fullStuff = this.getText();
      var val = fullStuff.substring(0, startpos);
      val = val.replace(this.expressions[this.matched], "$1" + this.rules[this.matched].token + replacement);
      var posfix = fullStuff.substring(startpos, fullStuff.length);
      var separator = posfix.match(/^\s/) ? '' : ' ';
      var finalFight = val + separator + posfix;
      this.setText(finalFight);
      var newPosition = val.length + 1;
      this.element.setSelectionRange(newPosition, newPosition);
    }

    return replace;
  }();

  _proto.hideList = function () {
    function hideList() {
      this.setMatchedRule(-1);
      this.setFilter(null);
    }

    return hideList;
  }();

  _proto.getText = function () {
    function getText() {
      return this.$element.val() || this.$element.text();
    }

    return getText;
  }();

  _proto.setText = function () {
    function setText(text) {
      if (this.$element.is('input,textarea')) {
        return this.$element.val(text);
      }

      this.$element.html(text);
    }

    return setText;
  }()
  /*
  	Rendering functions
   */
  ;

  _proto.positionContainer = function () {
    function positionContainer() {
      // First render; Pick the first item and set css whenever list gets shown
      var pos = {};
      var element = this.selector.anchor ? this.tmplInst.$(this.selector.anchor) : this.$element;

      if (this.position === 'fixed') {
        var width = element.outerWidth();
        return this.tmplInst.$(this.selector.container).css({
          width: width,
          position: 'fixed'
        });
      }

      var position = element.position();

      if (!position) {
        return;
      }

      var rule = this.matchedRule();
      var offset = getCaretCoordinates(this.element, this.element.selectionStart); // In whole-field positioning, we don't move the container and make it the
      // full width of the field.

      if (rule && isWholeField(rule)) {
        pos.left = position.left;

        if (rule.doNotChangeWidth !== false) {
          pos.width = element.outerWidth(); // position.offsetWidth
        }
      } else {
        // Normal positioning, at token word
        pos = {
          left: position.left + offset.left
        };
      } // Position menu from top (above) or from bottom of caret (below, default)


      if (this.position === 'top') {
        pos.bottom = element.offsetParent().height() - position.top - offset.top;
      } else {
        pos.top = position.top + offset.top + parseInt(element.css('font-size'));
      }

      this.tmplInst.$(this.selector.container).css(_objectSpread(_objectSpread({}, pos), {}, {
        position: 'absolute'
      }));
    }

    return positionContainer;
  }();

  _proto.ensureSelection = function () {
    function ensureSelection() {
      // Re-render; make sure selected item is something in the list or none if list empty
      var selectedItem = this.tmplInst.$(this.selector.item + ".selected");

      if (!selectedItem.length) {
        // Select anything
        this.tmplInst.$(this.selector.item + ":first-child").addClass('selected');
      }
    }

    return ensureSelection;
  }() // Select next item in list
  ;

  _proto.next = function () {
    function next() {
      var currentItem = this.tmplInst.$(this.selector.item + ".selected");

      if (!currentItem.length) {
        return this.tmplInst.$(this.selector.item + ":first-child").addClass('selected');
      }

      currentItem.removeClass('selected');
      var next = currentItem.next();

      if (next.length) {
        next.addClass('selected');
      } else {
        // End of list or lost selection; Go back to first item
        this.tmplInst.$(this.selector.item + ":first-child").addClass('selected');
      }
    }

    return next;
  }() // Select previous item in list
  ;

  _proto.prev = function () {
    function prev() {
      var currentItem = this.tmplInst.$(this.selector.item + ".selected");

      if (!currentItem.length) {
        return; // Don't try to iterate an empty list
      }

      currentItem.removeClass('selected');
      var prev = currentItem.prev();

      if (prev.length) {
        prev.addClass('selected');
      } else {
        // Beginning of list or lost selection; Go to end of list
        this.tmplInst.$(this.selector.item + ":last-child").addClass('selected');
      }
    }

    return prev;
  }() // This doesn't need to be reactive because list already changes reactively
  // and will cause all of the items to re-render anyway
  ;

  _proto.currentTemplate = function () {
    function currentTemplate() {
      return this.rules[this.matched].template;
    }

    return currentTemplate;
  }();

  return AutoComplete;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"autocomplete.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/autocomplete.css                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"collection.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/collection.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
module.exportDefault(new Mongo.Collection(null));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/index.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AutoComplete: function () {
    return AutoComplete;
  }
});
module.link("./inputs.html");
module.link("./templates");
var AutoComplete;
module.link("./autocomplete-client", {
  "default": function (v) {
    AutoComplete = v;
  }
}, 0);
module.link("./autocomplete.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"templates.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-autocomplete/client/templates.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  acEvents: function () {
    return acEvents;
  },
  attributes: function () {
    return attributes;
  },
  autocompleteHelpers: function () {
    return autocompleteHelpers;
  }
});
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var AutoComplete;
module.link("./autocomplete-client", {
  "default": function (v) {
    AutoComplete = v;
  }
}, 3);
//  Events on template instances, sent to the autocomplete class
var acEvents = {
  keydown: function (e, t) {
    t.ac.onKeyDown(e);
  },
  keyup: function (e, t) {
    t.ac.onKeyUp(e);
  },
  focus: function (e, t) {
    t.ac.onFocus(e);
  },
  blur: function (e, t) {
    t.ac.onBlur(e);
  }
};
Template.inputAutocomplete.events(acEvents);
Template.textareaAutocomplete.events(acEvents);

var attributes = function () {
  return _.omit(this, 'settings'); // Render all but the settings parameter
};

var autocompleteHelpers = {
  attributes: attributes,
  autocompleteContainer: new Template('AutocompleteContainer', function () {
    var ac = new AutoComplete(Blaze.getData().settings); // Set the autocomplete object on the parent template instance

    this.parentView.templateInstance().ac = ac; // Set nodes on render in the autocomplete class

    this.onViewReady(function () {
      ac.element = this.parentView.firstNode();
      ac.$element = $(ac.element);
    });
    return Blaze.With(ac, function () {
      //eslint-disable-line
      return Template._autocompleteContainer;
    });
  })
};
Template.inputAutocomplete.helpers(autocompleteHelpers);
Template.textareaAutocomplete.helpers(autocompleteHelpers);

Template._autocompleteContainer.rendered = function () {
  this.data.tmplInst = this;
};

Template._autocompleteContainer.destroyed = function () {
  // Meteor._debug "autocomplete destroyed"
  this.data.teardown();
};
/*
  List rendering helpers
 */


Template._autocompleteContainer.events({
  // t.data is the AutoComplete instance; `this` is the data item
  'click .-autocomplete-item, click [data-autocomplete]': function (e, t) {
    t.data.onItemClick(this, e);
  },
  'mouseenter .-autocomplete-item': function (e, t) {
    t.data.onItemHover(this, e);
  }
});

Template._autocompleteContainer.helpers({
  empty: function () {
    return this.filteredList().count() === 0;
  },
  noMatchTemplate: function () {
    return this.matchedRule().noMatchTemplate || Template._noMatch;
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"oembed":{"client":{"baseWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/baseWidget.html                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.baseWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.baseWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.baseWidget.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedBaseWidget");
Template["oembedBaseWidget"] = new Template("Template.oembedBaseWidget", (function() {
  var view = this;
  return Blaze._TemplateWith(function() {
    return {
      template: Spacebars.call(view.lookup("template"))
    };
  }, function() {
    return Spacebars.include(function() {
      return Spacebars.call(Template.__dynamic);
    });
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedAudioWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedAudioWidget.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedAudioWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedAudioWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedAudioWidget.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedAudioWidget");
Template["oembedAudioWidget"] = new Template("Template.oembedAudioWidget", (function() {
  var view = this;
  return HTML.A({
    href: function() {
      return Spacebars.mustache(view.lookup("url"));
    },
    rel: "noopener noreferrer",
    target: "_blank"
  }, "\n\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("parsedUrl"));
  }, function() {
    return [ "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        collapsedMedia: Spacebars.call(view.lookup("collapsedMediaVar"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("collapseArrow"));
    }), "\n\t\t\t", Blaze.Unless(function() {
      return Spacebars.call(view.lookup("collapsed"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.SPAN({
        class: "collapse-switch icon-down-dir",
        "data-index": function() {
          return Spacebars.mustache(view.lookup("index"));
        },
        "data-collapsed": function() {
          return Spacebars.mustache(view.lookup("collapsed"));
        }
      }), "\n\t\t\t\t", HTML.BLOCKQUOTE({
        class: "message-oembed background-transparent-darker-before"
      }, "\n\t\t\t\t\t", HTML.AUDIO({
        controls: ""
      }, "\n\t\t\t\t\t\t", HTML.SOURCE({
        src: function() {
          return Spacebars.mustache(view.lookup("url"));
        },
        rel: "noopener noreferrer",
        type: function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("headers"), "contentType"));
        }
      }), "\n\t\t\t\t\t\tYour browser does not support the audio element.\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
    }), "\n\t\t" ];
  }), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedFrameWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedFrameWidget.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedFrameWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedFrameWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedFrameWidget.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedFrameWidget");
Template["oembedFrameWidget"] = new Template("Template.oembedFrameWidget", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("parsedUrl"));
  }, function() {
    return [ "\n\t", HTML.BLOCKQUOTE({
      class: "message-oembed background-transparent-darker-before"
    }, "\n\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedProviderName"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedProviderUrl"));
      }, function() {
        return [ "\n\t\t\t\t", HTML.A({
          href: function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedProviderUrl"));
          },
          rel: "noopener noreferrer",
          target: "_blank",
          style: "color: #9e9ea6"
        }, Blaze.View("lookup:meta.oembedProviderName", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedProviderName"));
        })), "\n\t\t\t" ];
      }), "\n\t\t" ];
    }), "\n\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedAuthorName"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedAuthorUrl"));
      }, function() {
        return [ HTML.Raw('\n\t\t\t\t<br class="only-after-a">\n\t\t\t\t'), HTML.A({
          href: function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedAuthorUrl"));
          },
          rel: "noopener noreferrer",
          target: "_blank"
        }, Blaze.View("lookup:meta.oembedAuthorName", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedAuthorName"));
        })), "\n\t\t\t" ];
      }), "\n\t\t" ];
    }), "\n\t\t", Blaze.If(function() {
      return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedTitle"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedUrl"));
      }, function() {
        return [ HTML.Raw('\n\t\t\t\t<br class="only-after-a">\n\t\t\t\t'), HTML.A({
          href: function() {
            return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedUrl"));
          },
          rel: "noopener noreferrer",
          target: "_blank"
        }, Blaze.View("lookup:meta.oembedTitle", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedTitle"));
        })), "\n\t\t\t" ];
      }), "\n\t\t" ];
    }), "\n\t\t", Blaze._TemplateWith(function() {
      return {
        collapsedMedia: Spacebars.call(view.lookup("collapsedMediaVar"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("collapseArrow"));
    }), HTML.Raw(" <br>\n\t\t"), Blaze.Unless(function() {
      return Spacebars.call(view.lookup("collapsed"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("meta"), "oembedDescription"));
      }, function() {
        return [ "\n\t\t\t\t", HTML.P(Blaze.View("lookup:meta.oembedDescription", function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedDescription"));
        })), "\n\t\t\t" ];
      }), "\n\t\t\t", Blaze.View("lookup:meta.oembedHtml", function() {
        return Spacebars.makeRaw(Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "oembedHtml")));
      }), "\n\t\t" ];
    }), "\n\t"), "\n" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedImageWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedImageWidget.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedImageWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedImageWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedImageWidget.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedImageWidget");
Template["oembedImageWidget"] = new Template("Template.oembedImageWidget", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("parsedUrl"));
  }, function() {
    return [ "\n\t\t", Blaze._TemplateWith(function() {
      return {
        collapsedMedia: Spacebars.call(view.lookup("collapsedMediaVar"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("collapseArrow"));
    }), HTML.Raw(" <br>\n\t\t"), Blaze.Unless(function() {
      return Spacebars.call(view.lookup("collapsed"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("loadImage"));
      }, function() {
        return [ "\n\t\t\t\t", HTML.FIGURE("\n\t\t\t\t\t", HTML.DIV({
          class: "inline-image",
          style: function() {
            return [ "background-image: url('", Spacebars.mustache(view.lookup("url")), "');" ];
          }
        }, "\n\t\t\t\t\t\t", HTML.IMG({
          src: function() {
            return Spacebars.mustache(view.lookup("url"));
          },
          rel: "noopener noreferrer",
          height: "200",
          class: "gallery-item"
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t", HTML.DIV({
          class: "image-to-download",
          "data-url": function() {
            return Spacebars.mustache(view.lookup("url"));
          }
        }, HTML.Raw('\n\t\t\t\t\t<i class="icon-picture"></i>\n\t\t\t\t\t<div>click to load</div>\n\t\t\t\t')), "\n\t\t\t" ];
      }), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedUrlWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedUrlWidget.html                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedUrlWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedUrlWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedUrlWidget.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedUrlWidget");
Template["oembedUrlWidget"] = new Template("Template.oembedUrlWidget", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("show"));
  }, function() {
    return [ "\n\t\t", HTML.BLOCKQUOTE({
      class: "message-oembed background-transparent-darker-before"
    }, "\n\t\t\t", HTML.DIV({
      style: function() {
        return [ Blaze.If(function() {
          return Spacebars.call(view.lookup("image"));
        }, function() {
          return "min-height: 80px;";
        }), " padding: 10px 3px;" ];
      }
    }, "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("image"));
    }, function() {
      return [ "\n\t\t\t\t\t", Blaze.If(function() {
        return Spacebars.call(Spacebars.dot(view.lookup("meta"), "ogImageUserGenerated"));
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t", HTML.A({
          href: function() {
            return Spacebars.mustache(view.lookup("url"));
          },
          rel: "noopener noreferrer",
          target: function() {
            return Spacebars.mustache(view.lookup("target"));
          }
        }, "\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
          return Spacebars.call(Spacebars.dot(view.lookup("meta"), "ogImage"));
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t\t", HTML.IMG({
            src: function() {
              return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "ogImage"));
            },
            rel: "noopener noreferrer",
            height: "200"
          }), "\n\t\t\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t\t\t\t", HTML.IMG({
            src: function() {
              return Spacebars.mustache(view.lookup("image"));
            },
            rel: "noopener noreferrer",
            height: "200"
          }), "\n\t\t\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }, function() {
        return [ "\n\t\t\t\t\t\t", HTML.A({
          href: function() {
            return Spacebars.mustache(view.lookup("url"));
          },
          rel: "noopener noreferrer",
          target: function() {
            return Spacebars.mustache(view.lookup("target"));
          }
        }, "\n\t\t\t\t\t\t\t", HTML.IMG({
          src: function() {
            return Spacebars.mustache(view.lookup("image"));
          },
          rel: "noopener noreferrer",
          height: "60",
          align: "left",
          style: "margin-right: 10px;"
        }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
      }), "\n\t\t\t\t" ];
    }), "\n\t\t\t\t", HTML.DIV({
      style: "color: #AAA;"
    }, Blaze.View("lookup:parsedUrl.host", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("parsedUrl"), "host"));
    })), "\n\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("title"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t", HTML.A({
        href: function() {
          return Spacebars.mustache(view.lookup("url"));
        },
        rel: "noopener noreferrer",
        target: function() {
          return Spacebars.mustache(view.lookup("target"));
        }
      }, HTML.STRONG(Blaze.View("lookup:title", function() {
        return Spacebars.makeRaw(Spacebars.mustache(view.lookup("title")));
      }))), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
    }), "\n\t\t\t\t", HTML.DIV(Blaze.View("lookup:description", function() {
      return Spacebars.mustache(view.lookup("description"));
    })), "\n\t\t\t"), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedVideoWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedVideoWidget.html                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedVideoWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedVideoWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedVideoWidget.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedVideoWidget");
Template["oembedVideoWidget"] = new Template("Template.oembedVideoWidget", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("parsedUrl"));
  }, function() {
    return [ "\n\t", HTML.BLOCKQUOTE({
      class: "message-oembed background-transparent-darker-before"
    }, "\n\t\t", HTML.DIV(HTML.A({
      href: function() {
        return Spacebars.mustache(view.lookup("url"));
      },
      rel: "noopener noreferrer",
      target: "_blank"
    }, Blaze.View("lookup:parsedUrl.host", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("parsedUrl"), "host"));
    }))), "\n\t\t", HTML.SPAN(Blaze.View("lookup:title", function() {
      return Spacebars.mustache(view.lookup("title"));
    })), "\n\t\t", Blaze._TemplateWith(function() {
      return {
        collapsedMedia: Spacebars.call(view.lookup("collapsedMediaVar"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("collapseArrow"));
    }), HTML.Raw(" <br>\n\t\t"), Blaze.Unless(function() {
      return Spacebars.call(view.lookup("collapsed"));
    }, function() {
      return [ "\n\t\t\t", HTML.VIDEO({
        controls: "",
        class: "inline-video"
      }, "\n\t\t\t\t", HTML.SOURCE({
        src: function() {
          return Spacebars.mustache(view.lookup("url"));
        },
        rel: "noopener noreferrer",
        type: function() {
          return Spacebars.mustache(view.lookup("contentType"));
        }
      }), "\n\t\t\t\tYour browser does not support the video element.\n\t\t\t"), "\n\t\t" ];
    }), "\n\t"), "\n" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedYoutubeWidget.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedYoutubeWidget.html                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.oembedYoutubeWidget.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.oembedYoutubeWidget.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/template.oembedYoutubeWidget.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("oembedYoutubeWidget");
Template["oembedYoutubeWidget"] = new Template("Template.oembedYoutubeWidget", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("parsedUrl"));
  }, function() {
    return [ "\n\t\t", HTML.BLOCKQUOTE({
      class: "message-oembed background-transparent-darker-before"
    }, "\n\t\t\t", HTML.A({
      href: function() {
        return Spacebars.mustache(view.lookup("url"));
      },
      rel: "noopener noreferrer",
      target: "_blank"
    }, Blaze.View("lookup:parsedUrl.host", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("parsedUrl"), "host"));
    })), "\n\t\t\t", Blaze._TemplateWith(function() {
      return {
        collapsedMedia: Spacebars.call(view.lookup("collapsedMediaVar"))
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("collapseArrow"));
    }), HTML.Raw(" <br>\n\t\t\t"), Blaze.Unless(function() {
      return Spacebars.call(view.lookup("collapsed"));
    }, function() {
      return [ "\n\t\t\t\t", HTML.IFRAME({
        width: "270",
        height: "200",
        src: function() {
          return Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "twitterPlayer"));
        },
        rel: "noopener noreferrer",
        frameborder: "0",
        allowfullscreen: ""
      }), HTML.Raw("<br>\n\t\t\t\t"), Blaze.View("lookup:meta.description", function() {
        return Spacebars.makeRaw(Spacebars.mustache(Spacebars.dot(view.lookup("meta"), "description")));
      }), "\n\t\t\t" ];
    }), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"baseWidget.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/baseWidget.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var createCollapseable;
module.link("../../ui-utils", {
  createCollapseable: function (v) {
    createCollapseable = v;
  }
}, 1);
createCollapseable(Template.oembedBaseWidget, function (instance) {
  return instance.data.settings.collapseMediaByDefault || false;
});
Template.oembedBaseWidget.helpers({
  template: function () {
    var _this$headers, _this$headers$content, _this$headers2, _this$headers2$conten, _this$headers3, _this$headers3$conten, _this$meta, _this$meta$twitterPla, _this$meta2;

    var _Template$instance = Template.instance(),
        collapsedMedia = _Template$instance.collapsedMedia;

    this.collapsedMediaVar = function () {
      return collapsedMedia;
    };

    this.collapsed = collapsedMedia.get();

    if ((_this$headers = this.headers) !== null && _this$headers !== void 0 && (_this$headers$content = _this$headers.contentType) !== null && _this$headers$content !== void 0 && _this$headers$content.match(/image\/.*/)) {
      return 'oembedImageWidget';
    }

    if ((_this$headers2 = this.headers) !== null && _this$headers2 !== void 0 && (_this$headers2$conten = _this$headers2.contentType) !== null && _this$headers2$conten !== void 0 && _this$headers2$conten.match(/audio\/.*/)) {
      return 'oembedAudioWidget';
    }

    if ((_this$headers3 = this.headers) !== null && _this$headers3 !== void 0 && (_this$headers3$conten = _this$headers3.contentType) !== null && _this$headers3$conten !== void 0 && _this$headers3$conten.match(/video\/.*/) || (_this$meta = this.meta) !== null && _this$meta !== void 0 && (_this$meta$twitterPla = _this$meta.twitterPlayerStreamContentType) !== null && _this$meta$twitterPla !== void 0 && _this$meta$twitterPla.match(/video\/.*/)) {
      return 'oembedVideoWidget';
    }

    if ((_this$meta2 = this.meta) !== null && _this$meta2 !== void 0 && _this$meta2.oembedHtml) {
      return 'oembedFrameWidget';
    }

    return 'oembedUrlWidget';
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./baseWidget.html");
module.link("./baseWidget");
module.link("./oembedImageWidget.html");
module.link("./oembedImageWidget");
module.link("./oembedAudioWidget.html");
module.link("./oembedVideoWidget.html");
module.link("./oembedVideoWidget");
module.link("./oembedYoutubeWidget.html");
module.link("./oembedUrlWidget.html");
module.link("./oembedUrlWidget");
module.link("./oembedFrameWidget.html");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedImageWidget.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedImageWidget.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var getUserPreference;
module.link("../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 2);
Template.oembedImageWidget.helpers({
  loadImage: function () {
    if (getUserPreference(Meteor.userId(), 'autoImageLoad') === false && this.downloadImages == null) {
      return false;
    }

    if (Meteor.Device.isPhone() && getUserPreference(Meteor.userId(), 'saveMobileBandwidth') && this.downloadImages == null) {
      return false;
    }

    return true;
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedUrlWidget.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedUrlWidget.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var unescapeHTML;
module.link("@rocket.chat/string-helpers", {
  unescapeHTML: function (v) {
    unescapeHTML = v;
  }
}, 3);

var getTitle = function (self) {
  if (self.meta == null) {
    return;
  }

  return self.meta.ogTitle || self.meta.twitterTitle || self.meta.title || self.meta.pageTitle;
};

var getDescription = function (self) {
  if (self.meta == null) {
    return;
  }

  var description = self.meta.ogDescription || self.meta.twitterDescription || self.meta.description;

  if (description == null) {
    return;
  }

  return unescapeHTML(description.replace(/(^[“\s]*)|([”\s]*$)/g, ''));
};

Template.oembedUrlWidget.helpers({
  description: function () {
    var description = getDescription(this);

    if (_.isString(description)) {
      return description;
    }
  },
  title: function () {
    var title = getTitle(this);

    if (_.isString(title)) {
      return Blaze._escape(title);
    }
  },
  target: function () {
    if (!(this.parsedUrl && this.parsedUrl.host) || !(document && document.location && document.location.host) || this.parsedUrl && this.parsedUrl.host !== document.location.host) {
      return '_blank';
    }
  },
  image: function () {
    if (this.meta == null) {
      return;
    }

    var decodedOgImage;

    if (this.meta.ogImage && this.meta.ogImage.replace) {
      decodedOgImage = this.meta.ogImage.replace(/&amp;/g, '&');
    }

    var url = decodedOgImage || this.meta.twitterImage || this.meta.msapplicationTileImage;

    if (url == null) {
      return;
    }

    url = new URL(url, this.parsedUrl.protocol + "//" + this.parsedUrl.host).href;
    return url;
  },
  show: function () {
    return getDescription(this) != null || getTitle(this) != null;
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oembedVideoWidget.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/oembed/client/oembedVideoWidget.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);

var getTitle = function (self) {
  if (self.meta == null) {
    return;
  }

  return self.meta.ogTitle || self.meta.twitterTitle || self.meta.title || self.meta.pageTitle;
};

Template.oembedVideoWidget.helpers({
  url: function () {
    if (this.meta && this.meta.twitterPlayerStream) {
      return this.meta.twitterPlayerStream;
    }

    if (this.url) {
      return this.url;
    }
  },
  contentType: function () {
    if (this.meta && this.meta.twitterPlayerStreamContentType) {
      return this.meta.twitterPlayerStreamContentType;
    }

    if (this.headers && this.headers.contentType) {
      return this.headers.contentType;
    }
  },
  title: function () {
    return getTitle(this);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"tokenpass":{"client":{"tokenChannelsList.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/tokenChannelsList.html                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.tokenChannelsList.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.tokenChannelsList.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/template.tokenChannelsList.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("tokenChannelsList");
Template["tokenChannelsList"] = new Template("Template.tokenChannelsList", (function() {
  var view = this;
  return [ HTML.Raw('<h3 class="rooms-list__type">\n\t\tToken Channels\n\t</h3>\n\t'), HTML.UL({
    class: "rooms-list__list"
  }, "\n\t\t", HTML.UL({
    class: "rooms-list__list"
  }, "\n\t\t\t", Blaze.Each(function() {
    return {
      _sequence: Spacebars.call(view.lookup("rooms")),
      _variable: "room"
    };
  }, function() {
    return [ "\n\t\t\t\t", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("room"));
    }, function() {
      return Spacebars.include(view.lookupTemplate("chatRoomItem"));
    }), "\n\t\t\t" ];
  }, function() {
    return [ "\n\t\t\t\t", HTML.P({
      class: "rooms-list__empty-room"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "No_channels_yet");
    })), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t") ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tokenpassChannelSettings.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/tokenpassChannelSettings.html                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.tokenpassChannelSettings.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.tokenpassChannelSettings.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/template.tokenpassChannelSettings.js                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("channelSettings__tokenpass");
Template["channelSettings__tokenpass"] = new Template("Template.channelSettings__tokenpass", (function() {
  var view = this;
  return HTML.LI({
    class: function() {
      return [ "channelSettings-tokenpass setting-block ", Spacebars.mustache(view.lookup("editing")) ];
    }
  }, HTML.Raw('\n\t\t<div class="header">\n\t\t\t<button type="button" class="rc-button rc-button--secondary edit js-edit">\n\t\t\t\t<i class="icon-pencil"></i>\n\t\t\t</button>\n\n\t\t\t<label>Tokenpass</label>\n\t\t</div>\n\t\t'), HTML.DIV({
    class: "details"
  }, "\n\t\t\t", HTML.DIV({
    class: "boolean"
  }, "\n\t\t\t\t", HTML.LABEL(Blaze.View("lookup:requiredLabel", function() {
    return Spacebars.mustache(view.lookup("requiredLabel"));
  })), "\n\t\t\t\t", HTML.DIV({
    class: "setting-block"
  }, "\n\t\t\t\t\t", HTML.DIV({
    class: "input checkbox toggle"
  }, "\n\t\t\t\t\t\t", HTML.INPUT(HTML.Attrs({
    type: "checkbox",
    id: "requireAllTokens",
    name: "requireAllTokens"
  }, function() {
    return Spacebars.attrMustache(view.lookup("requiredChecked"));
  }, function() {
    return Spacebars.attrMustache(view.lookup("requiredDisabled"));
  })), HTML.Raw('\n\t\t\t\t\t\t<label for="requireAllTokens"></label>\n\t\t\t\t\t')), "\n\t\t\t\t"), "\n\t\t\t"), "\n\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("list"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.UL({
      class: "chip-container"
    }, "\n\t\t\t\t\t", Blaze.Each(function() {
      return Spacebars.call(view.lookup("list"));
    }, function() {
      return [ "\n\t\t\t\t\t", HTML.LI({
        class: "js-remove",
        title: function() {
          return [ "balance: ", Spacebars.mustache(view.lookup("balance")) ];
        },
        "aria-label": function() {
          return [ Spacebars.mustache(view.lookup("token")), " ", Spacebars.mustache(view.lookup("balance")) ];
        }
      }, Blaze.If(function() {
        return Spacebars.call(view.lookup("editing"));
      }, function() {
        return HTML.Raw('<i class="icon-cancel-circled"></i>');
      }), Blaze.View("lookup:token", function() {
        return Spacebars.mustache(view.lookup("token"));
      })), "\n\t\t\t\t\t" ];
    }), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t\t", Blaze.If(function() {
    return Spacebars.call(view.lookup("editing"));
  }, function() {
    return [ "\n\t\t\t\t", HTML.FORM({
      class: "channelSettings-tokenpass__form"
    }, "\n\t\t\t\t\t", HTML.INPUT({
      type: "text",
      name: "token",
      class: "channelSettings-tokenpass__input content-background-color editing",
      placeholder: function() {
        return Spacebars.mustache(view.lookup("_"), "Token_required");
      }
    }), "\n\t\t\t\t\t", HTML.INPUT({
      type: "number",
      min: "0",
      name: "balance",
      class: "channelSettings-tokenpass__input content-background-color editing",
      placeholder: function() {
        return Spacebars.mustache(view.lookup("_"), "Minimum_balance");
      }
    }), "\n\t\t\t\t\t", HTML.BUTTON(HTML.Attrs({
      type: "button",
      class: "rc-button rc-button--secondary js-add",
      title: function() {
        return Spacebars.mustache(view.lookup("_"), "Add");
      }
    }, function() {
      return Spacebars.attrMustache(view.lookup("addDisabled"));
    }), HTML.Raw('<i class="icon-plus"></i>')), "\n\t\t\t\t\t", HTML.BUTTON({
      type: "button",
      class: "rc-button rc-button--secondary js-cancel",
      title: function() {
        return Spacebars.mustache(view.lookup("_"), "Cancel");
      }
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Cancel");
    })), "\n\t\t\t\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("save"));
    }, function() {
      return HTML.BUTTON({
        type: "button",
        class: "rc-button rc-button--primary js-save"
      }, Blaze.View("lookup:_", function() {
        return Spacebars.mustache(view.lookup("_"), "Save");
      }));
    }), "\n\t\t\t\t"), "\n\t\t\t" ];
  }), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"channelSettings.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/channelSettings.css                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./startup");
module.link("./roomType");
module.link("./tokenChannelsList.html");
module.link("./tokenChannelsList");
module.link("./tokenpassChannelSettings.html");
module.link("./tokenpassChannelSettings");
module.link("./login-button.css");
module.link("./channelSettings.css");
module.link("./styles.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/login-button.css                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/roomType.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var roomTypes, RoomTypeConfig;
module.link("../../utils", {
  roomTypes: function (v) {
    roomTypes = v;
  },
  RoomTypeConfig: function (v) {
    RoomTypeConfig = v;
  }
}, 1);

var TokenPassRoomType = /*#__PURE__*/function (_RoomTypeConfig) {
  _inheritsLoose(TokenPassRoomType, _RoomTypeConfig);

  function TokenPassRoomType() {
    var _this;

    _this = _RoomTypeConfig.call(this, {
      identifier: 'tokenpass',
      order: 1
    }) || this;
    _this.customTemplate = 'tokenChannelsList';
    return _this;
  }

  var _proto = TokenPassRoomType.prototype;

  _proto.condition = function () {
    function condition() {
      var user = Meteor.users.findOne(Meteor.userId(), {
        fields: {
          'services.tokenpass': 1
        }
      });
      var hasTokenpass = !!(user && user.services && user.services.tokenpass);
      return hasTokenpass;
    }

    return condition;
  }();

  return TokenPassRoomType;
}(RoomTypeConfig);

roomTypes.add(new TokenPassRoomType());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/startup.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ChannelSettings;
module.link("../../channel-settings", {
  ChannelSettings: function (v) {
    ChannelSettings = v;
  }
}, 1);
var Rooms;
module.link("../../models", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 2);
Meteor.startup(function () {
  ChannelSettings.addOption({
    group: ['room'],
    id: 'tokenpass',
    template: 'channelSettings__tokenpass',
    validation: function (data) {
      if (data && data.rid) {
        var room = Rooms.findOne(data.rid, {
          fields: {
            tokenpass: 1
          }
        });
        return room && room.tokenpass;
      }

      return false;
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"styles.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/styles.css                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tokenChannelsList.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/tokenChannelsList.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 3);
var Subscriptions;
module.link("../../models", {
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 4);
Template.tokenChannelsList.helpers({
  rooms: function () {
    return Template.instance().tokenpassRooms.get().filter(function (room) {
      return Subscriptions.find({
        rid: room._id
      }).count() === 0;
    });
  }
});
Template.tokenChannelsList.onRendered(function () {
  var _this = this;

  Tracker.autorun(function (c) {
    var user = Meteor.user();

    if (user && user.services && user.services.tokenpass) {
      c.stop();
      Meteor.call('findTokenChannels', function (error, result) {
        if (!error) {
          _this.tokenpassRooms.set(result);
        }
      });
    }
  });
});
Template.tokenChannelsList.onCreated(function () {
  this.tokenpassRooms = new ReactiveVar([]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tokenpassChannelSettings.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/client/tokenpassChannelSettings.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 3);
var t;
module.link("../../utils", {
  t: function (v) {
    t = v;
  }
}, 4);
var ChatRoom;
module.link("../../models", {
  ChatRoom: function (v) {
    ChatRoom = v;
  }
}, 5);
var handleError;
module.link("../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 6);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 7);
Template.channelSettings__tokenpass.helpers({
  addDisabled: function () {
    var _Template$instance = Template.instance(),
        balance = _Template$instance.balance,
        token = _Template$instance.token;

    return balance.get() && token.get() ? '' : 'disabled';
  },
  list: function () {
    return Template.instance().list.get();
  },
  save: function () {
    var _Template$instance2 = Template.instance(),
        list = _Template$instance2.list,
        initial = _Template$instance2.initial;

    return JSON.stringify(list.get()) !== JSON.stringify(initial);
  },
  editing: function () {
    return Template.instance().editing.get() ? 'tokenpass__editing' : '';
  },
  requiredChecked: function () {
    return Template.instance().requireAll.get() ? 'checked' : '';
  },
  requiredLabel: function () {
    return Template.instance().requireAll.get() ? t('Require_all_tokens') : t('Require_any_token');
  },
  requiredDisabled: function () {
    return !Template.instance().editing.get() ? 'disabled' : '';
  },
  editDisabled: function () {
    return Template.instance().editing.get() ? 'disabled' : '';
  }
});
Template.channelSettings__tokenpass.onCreated(function () {
  var room = ChatRoom.findOne(this.data.rid, {
    fields: {
      tokenpass: 1
    }
  });
  this.editing = new ReactiveVar(false);
  this.initial = room.tokenpass;
  this.requireAll = new ReactiveVar(room.tokenpass.require === 'all');
  this.list = new ReactiveVar(this.initial.tokens);
  this.token = new ReactiveVar('');
  this.balance = new ReactiveVar('');
});
Template.channelSettings__tokenpass.events({
  'click .js-edit': function (e, i) {
    i.editing.set(true);
  },
  'input [name=token]': function (e, i) {
    i.token.set(e.target.value);
  },
  'input [name=balance]': function (e, i) {
    i.balance.set(e.target.value);
  },
  'click .js-add': function (e, i) {
    e.preventDefault();
    var instance = Template.instance();
    var balance = instance.balance,
        token = instance.token,
        list = instance.list;
    list.set([].concat(_toConsumableArray(list.get().filter(function (t) {
      return t.token !== token;
    })), [{
      token: token.get(),
      balance: balance.get()
    }]));

    _toConsumableArray(i.findAll('input')).forEach(function (el) {
      el.value = '';
    });

    return balance.set('') && token.set('');
  },
  'click .js-remove': function (e, instance) {
    var _this = this;

    e.preventDefault();
    var list = instance.list,
        editing = instance.editing;

    if (!editing.get()) {
      return;
    }

    list.set(list.get().filter(function (t) {
      return t.token !== _this.token;
    }));
  },
  'click .js-save': function (e, i) {
    e.preventDefault();
    var tokenpass = {
      require: i.find('[name=requireAllTokens]').checked ? 'all' : 'any',
      tokens: i.list.get()
    };
    Meteor.call('saveRoomSettings', this.rid, 'tokenpass', tokenpass, function (err) {
      if (err) {
        return handleError(err);
      }

      i.editing.set(false);
      i.token.set('');
      i.balance.set('');
      i.initial = tokenpass;

      _toConsumableArray(i.findAll('input')).forEach(function (el) {
        el.value = '';
      });

      return dispatchToastMessage({
        type: 'success',
        message: TAPi18n.__('Room_tokenpass_config_changed_successfully')
      });
    });
  },
  'click .js-cancel': function (e, i) {
    e.preventDefault();
    i.editing.set(false);
    i.list.set(i.initial.tokens);
    i.token.set('');
    i.balance.set('');

    _toConsumableArray(i.findAll('input')).forEach(function (el) {
      el.value = '';
    });
  },
  'change [name=requireAllTokens]': function (e, instance) {
    instance.requireAll.set(e.currentTarget.checked);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/tokenpass/lib/common.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth: function (v) {
    CustomOAuth = v;
  }
}, 3);
var config = {
  serverURL: '',
  identityPath: '/oauth/user',
  authorizePath: '/oauth/authorize',
  tokenPath: '/oauth/access-token',
  scope: 'user,tca,private-balances',
  tokenSentVia: 'payload',
  usernameField: 'username',
  mergeUsers: true,
  addAutopublishFields: {
    forLoggedInUser: ['services.tokenpass'],
    forOtherUsers: ['services.tokenpass.name']
  },
  accessTokenParam: 'access_token'
};
var Tokenpass = new CustomOAuth('tokenpass', config);

if (Meteor.isServer) {
  Meteor.startup(function () {
    settings.get('API_Tokenpass_URL', function (key, value) {
      config.serverURL = value;
      Tokenpass.configure(config);
    });
  });
} else {
  Meteor.startup(function () {
    Tracker.autorun(function () {
      if (settings.get('API_Tokenpass_URL')) {
        config.serverURL = settings.get('API_Tokenpass_URL');
        Tokenpass.configure(config);
      }
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-sidenav":{"client":{"roomList.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/roomList.html                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.roomList.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.roomList.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/template.roomList.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("roomList");
Template["roomList"] = new Template("Template.roomList", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isLivechat"));
  }, function() {
    return [ "\n\t\t", Blaze._TemplateWith(function() {
      return Spacebars.call(view.lookup("."));
    }, function() {
      return Spacebars.include(view.lookupTemplate("livechat"));
    }), "\n\t" ];
  }, function() {
    return [ "\n\t\t", Spacebars.With(function() {
      return Spacebars.call(view.lookup("rooms"));
    }, function() {
      return [ "\n\t\t\t", Blaze.If(function() {
        return Spacebars.dataMustache(view.lookup("shouldAppear"), view.lookup(".."), view.lookup("."));
      }, function() {
        return [ "\n\t\t\t\t\t", HTML.H3({
          class: "rooms-list__type"
        }, "\n\t\t\t\t\t\t", HTML.SPAN({
          class: "rooms-list__type-text"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), Spacebars.dot(view.lookup(".."), "label"));
        })), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", HTML.UL({
          class: function() {
            return [ "rooms-list__list ", Spacebars.mustache(view.lookup("roomType"), view.lookup("..")) ];
          }
        }, "\n\t\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(view.lookup(".")),
            _variable: "room"
          };
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
            return Spacebars.call(view.lookup("room"));
          }, function() {
            return Spacebars.include(view.lookupTemplate("chatRoomItem"));
          }), "\n\t\t\t\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t\t\t\t", HTML.P({
            class: "rooms-list__empty-room"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), view.lookup("noSubscriptionText"));
          })), "\n\t\t\t\t\t\t" ];
        }), "\n\t\t\t\t\t"), "\n\t\t\t\t" ];
      }), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"sideNav.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/sideNav.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.sideNav.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.sideNav.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/template.sideNav.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("sideNav");
Template["sideNav"] = new Template("Template.sideNav", (function() {
  var view = this;
  return [ HTML.ASIDE({
    class: function() {
      return [ "rcx-sidebar sidebar sidebar--main sidebar--", Spacebars.mustache(view.lookup("sidebarViewMode")), " ", Blaze.If(function() {
        return Spacebars.call(view.lookup("sidebarHideAvatar"));
      }, function() {
        return "sidebar--hide-avatar";
      }) ];
    },
    role: "navigation"
  }, "\n\t\t", Spacebars.include(view.lookupTemplate("sidebarHeader")), "\n\t\t", HTML.DIV({
    class: "wrapper-unread"
  }, "\n\t\t\t", HTML.DIV({
    class: "unread-rooms background-primary-action-color color-primary-action-contrast top-unread-rooms hidden"
  }, HTML.Raw('\n\t\t\t\t<i class="icon-up-big"></i> '), Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "More_unreads");
  }), "\n\t\t\t"), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "rooms-list sidebar--custom-colors",
    "aria-label": function() {
      return Spacebars.mustache(view.lookup("_"), "Channels");
    },
    role: "region"
  }, "\n\t\t\t", Spacebars.include(view.lookupTemplate("sidebarChats")), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "wrapper-unread"
  }, "\n\t\t\t", HTML.DIV({
    class: "unread-rooms background-primary-action-color color-primary-action-contrast bottom-unread-rooms hidden"
  }, HTML.Raw('\n\t\t\t\t<i class="icon-down-big"></i> '), Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "More_unreads");
  }), "\n\t\t\t"), "\n\t\t"), "\n\t\t", HTML.DIV({
    class: "flex-nav animated-hidden"
  }, "\n\t\t\t", Blaze._TemplateWith(function() {
    return {
      template: Spacebars.call(view.lookup("flexTemplate")),
      data: Spacebars.call(view.lookup("flexData"))
    };
  }, function() {
    return Spacebars.include(function() {
      return Spacebars.call(Template.__dynamic);
    });
  }), "\n\t\t"), "\n\t\t", Spacebars.include(view.lookupTemplate("sidebarFooter")), "\n\t"), HTML.Raw('\n\t<div class="sidebar-wrap"></div>') ];
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userPresence.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/userPresence.html                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.userPresence.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.userPresence.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/template.userPresence.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("userPresence");
Template["userPresence"] = new Template("Template.userPresence", (function() {
  var view = this;
  return Blaze._InOuterTemplateScope(view, function() {
    return Spacebars.include(function() {
      return Spacebars.call(view.templateContentBlock);
    });
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./sideNav.html");
module.link("./roomList.html");
module.link("./sideNav");
module.link("./roomList");
module.link("./userPresence");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomList.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/roomList.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 2);
var ChatSubscription, Rooms, Users, Subscriptions;
module.link("../../models", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  },
  Rooms: function (v) {
    Rooms = v;
  },
  Users: function (v) {
    Users = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 3);
var UiTextContext, getUserPreference, roomTypes;
module.link("../../utils", {
  UiTextContext: function (v) {
    UiTextContext = v;
  },
  getUserPreference: function (v) {
    getUserPreference = v;
  },
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 4);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 5);
Template.roomList.helpers({
  rooms: function () {
    /*
    	modes:
    		sortby activity/alphabetical
    		merge channels into one list
    		show favorites
    		show unread
    */
    if (this.anonymous) {
      return Rooms.find({
        t: 'c'
      }, {
        sort: {
          name: 1
        }
      });
    }

    var user = Users.findOne(Meteor.userId(), {
      fields: {
        'settings.preferences.sidebarSortby': 1,
        'settings.preferences.sidebarShowFavorites': 1,
        'settings.preferences.sidebarShowUnread': 1,
        'services.tokenpass': 1,
        'messageViewMode': 1
      }
    });
    var sortBy = getUserPreference(user, 'sidebarSortby') || 'activity';
    var query = {
      open: true
    };
    var sort = {};

    if (sortBy === 'activity') {
      sort.lm = -1;
    } else {
      // alphabetical
      sort[this.identifier === 'd' && settings.get('UI_Use_Real_Name') ? 'lowerCaseFName' : 'lowerCaseName'] = /descending/.test(sortBy) ? -1 : 1;
    }

    if (this.identifier === 'unread') {
      query.alert = true;
      query.$or = [{
        hideUnreadStatus: {
          $ne: true
        }
      }, {
        unread: {
          $gt: 0
        }
      }];
      return ChatSubscription.find(query, {
        sort: sort
      });
    }

    var favoritesEnabled = !!(settings.get('Favorite_Rooms') && getUserPreference(user, 'sidebarShowFavorites'));

    if (this.identifier === 'f') {
      query.f = favoritesEnabled;
    } else {
      var types = [this.identifier];

      if (this.identifier === 'merged') {
        types = ['c', 'p', 'd'];
      }

      if (this.identifier === 'discussion') {
        types = ['c', 'p', 'd'];
        query.prid = {
          $exists: true
        };
      }

      if (this.identifier === 'tokens') {
        types = ['c', 'p'];
      }

      if (['c', 'p'].includes(this.identifier)) {
        query.tokens = {
          $exists: false
        };
      } else if (this.identifier === 'tokens' && user && user.services && user.services.tokenpass) {
        query.tokens = {
          $exists: true
        };
      }

      if (getUserPreference(user, 'sidebarShowUnread')) {
        query.$or = [{
          alert: {
            $ne: true
          }
        }, {
          $and: [{
            hideUnreadStatus: true
          }, {
            unread: 0
          }]
        }];
      }

      query.t = {
        $in: types
      };

      if (favoritesEnabled) {
        query.f = {
          $ne: favoritesEnabled
        };
      }
    }

    return ChatSubscription.find(query, {
      sort: sort
    });
  },
  isLivechat: function () {
    return this.identifier === 'l';
  },
  shouldAppear: function (group, rooms) {
    /*
    if is a normal group ('channel' 'private' 'direct')
    or is favorite and has one room
    or is unread and has one room
    */
    return !['unread', 'f'].includes(group.identifier) || rooms.length || rooms.count && rooms.count();
  },
  roomType: function (room) {
    if (room.header || room.identifier) {
      return "type-" + (room.header || room.identifier);
    }
  },
  noSubscriptionText: function () {
    var instance = Template.instance();

    if (instance.data.anonymous) {
      return 'No_channels_yet';
    }

    return roomTypes.getConfig(instance.data.identifier).getUiText(UiTextContext.NO_ROOMS_SUBSCRIBED) || 'No_channels_yet';
  }
});

var getLowerCaseNames = function (room) {
  var nameDefault = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
  var fnameDefault = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
  var name = room.name || nameDefault;
  var fname = room.fname || fnameDefault || name;
  return {
    lowerCaseName: String(name).toLowerCase(),
    lowerCaseFName: String(fname).toLowerCase()
  };
};

var mergeSubRoom = function (subscription) {
  var options = {
    fields: {
      lm: 1,
      lastMessage: 1,
      uids: 1,
      streamingOptions: 1,
      usernames: 1,
      topic: 1,
      encrypted: 1,
      jitsiTimeout: 1,
      // autoTranslate: 1,
      // autoTranslateLanguage: 1,
      description: 1,
      announcement: 1,
      broadcast: 1,
      archived: 1,
      avatarETag: 1,
      retention: 1,
      teamId: 1,
      teamMain: 1,
      onHold: 1,
      metrics: 1,
      muted: 1,
      servedBy: 1,
      ts: 1,
      waitingResponse: 1,
      v: 1,
      transcriptRequest: 1,
      tags: 1,
      closedAt: 1,
      responseBy: 1,
      priorityId: 1,
      livechatData: 1,
      departmentId: 1,
      source: 1,
      queuedAt: 1
    }
  };
  var room = Rooms.findOne({
    _id: subscription.rid
  }, options) || {};
  var lastRoomUpdate = room.lm || subscription.ts || subscription._updatedAt;
  var encrypted = room.encrypted,
      description = room.description,
      cl = room.cl,
      topic = room.topic,
      announcement = room.announcement,
      broadcast = room.broadcast,
      archived = room.archived,
      avatarETag = room.avatarETag,
      retention = room.retention,
      lastMessage = room.lastMessage,
      streamingOptions = room.streamingOptions,
      teamId = room.teamId,
      teamMain = room.teamMain,
      uids = room.uids,
      usernames = room.usernames,
      jitsiTimeout = room.jitsiTimeout,
      v = room.v,
      transcriptRequest = room.transcriptRequest,
      servedBy = room.servedBy,
      onHold = room.onHold,
      tags = room.tags,
      closedAt = room.closedAt,
      metrics = room.metrics,
      muted = room.muted,
      waitingResponse = room.waitingResponse,
      responseBy = room.responseBy,
      priorityId = room.priorityId,
      livechatData = room.livechatData,
      departmentId = room.departmentId,
      ts = room.ts,
      source = room.source,
      queuedAt = room.queuedAt;
  subscription.lm = subscription.lr ? new Date(Math.max(subscription.lr, lastRoomUpdate)) : lastRoomUpdate;
  return Object.assign(subscription, getLowerCaseNames(subscription), {
    encrypted: encrypted,
    description: description,
    cl: cl,
    topic: topic,
    announcement: announcement,
    broadcast: broadcast,
    archived: archived,
    avatarETag: avatarETag,
    retention: retention,
    lastMessage: lastMessage,
    streamingOptions: streamingOptions,
    teamId: teamId,
    teamMain: teamMain,
    uids: uids,
    usernames: usernames,
    jitsiTimeout: jitsiTimeout,
    v: v,
    transcriptRequest: transcriptRequest,
    servedBy: servedBy,
    onHold: onHold,
    tags: tags,
    closedAt: closedAt,
    metrics: metrics,
    muted: muted,
    waitingResponse: waitingResponse,
    responseBy: responseBy,
    priorityId: priorityId,
    livechatData: livechatData,
    departmentId: departmentId,
    ts: ts,
    source: source,
    queuedAt: queuedAt
  });
};

var mergeRoomSub = function (room) {
  var sub = Subscriptions.findOne({
    rid: room._id
  });

  if (!sub) {
    return room;
  }

  var encrypted = room.encrypted,
      description = room.description,
      cl = room.cl,
      topic = room.topic,
      announcement = room.announcement,
      broadcast = room.broadcast,
      archived = room.archived,
      avatarETag = room.avatarETag,
      retention = room.retention,
      lastMessage = room.lastMessage,
      streamingOptions = room.streamingOptions,
      teamId = room.teamId,
      teamMain = room.teamMain,
      uids = room.uids,
      usernames = room.usernames,
      jitsiTimeout = room.jitsiTimeout,
      v = room.v,
      transcriptRequest = room.transcriptRequest,
      servedBy = room.servedBy,
      onHold = room.onHold,
      tags = room.tags,
      closedAt = room.closedAt,
      metrics = room.metrics,
      muted = room.muted,
      waitingResponse = room.waitingResponse,
      responseBy = room.responseBy,
      priorityId = room.priorityId,
      livechatData = room.livechatData,
      departmentId = room.departmentId,
      ts = room.ts,
      source = room.source,
      queuedAt = room.queuedAt;
  Subscriptions.update({
    rid: room._id
  }, {
    $set: _objectSpread({
      encrypted: encrypted,
      description: description,
      cl: cl,
      topic: topic,
      announcement: announcement,
      broadcast: broadcast,
      archived: archived,
      avatarETag: avatarETag,
      retention: retention,
      uids: uids,
      usernames: usernames,
      lastMessage: lastMessage,
      streamingOptions: streamingOptions,
      teamId: teamId,
      teamMain: teamMain,
      v: v,
      transcriptRequest: transcriptRequest,
      servedBy: servedBy,
      onHold: onHold,
      tags: tags,
      closedAt: closedAt,
      metrics: metrics,
      muted: muted,
      waitingResponse: waitingResponse,
      responseBy: responseBy,
      priorityId: priorityId,
      livechatData: livechatData,
      departmentId: departmentId,
      jitsiTimeout: jitsiTimeout,
      ts: ts,
      source: source,
      queuedAt: queuedAt
    }, getLowerCaseNames(room, sub.name, sub.fname))
  });
  Subscriptions.update({
    rid: room._id,
    lm: {
      $lt: room.lm
    }
  }, {
    $set: {
      lm: room.lm
    }
  });
  return room;
};

callbacks.add('cachedCollection-received-rooms', mergeRoomSub);
callbacks.add('cachedCollection-sync-rooms', mergeRoomSub);
callbacks.add('cachedCollection-loadFromServer-rooms', mergeRoomSub);
callbacks.add('cachedCollection-received-subscriptions', mergeSubRoom);
callbacks.add('cachedCollection-sync-subscriptions', mergeSubRoom);
callbacks.add('cachedCollection-loadFromServer-subscriptions', mergeSubRoom);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"sideNav.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/sideNav.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 3);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 4);
var SideNav, menu;
module.link("../../ui-utils", {
  SideNav: function (v) {
    SideNav = v;
  },
  menu: function (v) {
    menu = v;
  }
}, 5);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 6);
var roomTypes, getUserPreference;
module.link("../../utils", {
  roomTypes: function (v) {
    roomTypes = v;
  },
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 7);
var Users;
module.link("../../models", {
  Users: function (v) {
    Users = v;
  }
}, 8);
Template.sideNav.helpers({
  flexTemplate: function () {
    return SideNav.getFlex().template;
  },
  flexData: function () {
    return SideNav.getFlex().data;
  },
  roomType: function () {
    return roomTypes.getTypes().map(function (roomType) {
      return {
        template: roomType.customTemplate || 'roomList',
        data: {
          header: roomType.header,
          identifier: roomType.identifier,
          isCombined: roomType.isCombined,
          label: roomType.label
        }
      };
    });
  },
  loggedInUser: function () {
    return !!Meteor.userId();
  },
  sidebarViewMode: function () {
    var viewMode = getUserPreference(Meteor.userId(), 'sidebarViewMode');
    return viewMode || 'condensed';
  },
  sidebarHideAvatar: function () {
    return !getUserPreference(Meteor.userId(), 'sidebarDisplayAvatar');
  }
});
Template.sideNav.events({
  'click .close-flex': function () {
    return SideNav.closeFlex();
  },
  'click .arrow': function () {
    return SideNav.toggleCurrent();
  },
  'scroll .rooms-list': function () {
    return menu.updateUnreadBars();
  },
  'dropped .sidebar': function (e) {
    return e.preventDefault();
  },
  'mouseenter .sidebar-item__link': function (e) {
    var element = e.currentTarget;
    setTimeout(function () {
      var ellipsedElement = element.querySelector('.sidebar-item__ellipsis');
      var isTextEllipsed = ellipsedElement.offsetWidth < ellipsedElement.scrollWidth;

      if (isTextEllipsed) {
        element.setAttribute('title', element.getAttribute('aria-label'));
      } else {
        element.removeAttribute('title');
      }
    }, 0);
  }
});

var redirectToDefaultChannelIfNeeded = function () {
  var needToBeRedirect = function () {
    return ['/', '/home'].includes(FlowRouter.current().path);
  };

  Tracker.autorun(function (c) {
    var firstChannelAfterLogin = settings.get('First_Channel_After_Login');

    if (!needToBeRedirect()) {
      return c.stop();
    }

    if (!firstChannelAfterLogin) {
      return c.stop();
    }

    var room = roomTypes.findRoom('c', firstChannelAfterLogin, Meteor.userId());

    if (!room) {
      return;
    }

    c.stop();
    FlowRouter.go("/channel/" + firstChannelAfterLogin);
  });
};

Template.sideNav.onRendered(function () {
  SideNav.init();
  menu.init();
  redirectToDefaultChannelIfNeeded();
  return Meteor.defer(function () {
    return menu.updateUnreadBars();
  });
});
Template.sideNav.onCreated(function () {
  var _this = this;

  this.groupedByType = new ReactiveVar(false);
  this.autorun(function () {
    var user = Users.findOne(Meteor.userId(), {
      fields: {
        'settings.preferences.sidebarGroupByType': 1
      }
    });
    var userPref = getUserPreference(user, 'sidebarGroupByType');

    _this.groupedByType.set(userPref || settings.get('UI_Group_Channels_By_Type'));
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userPresence.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-sidenav/client/userPresence.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 0);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var Presence;
module.link("../../../client/lib/presence", {
  Presence: function (v) {
    Presence = v;
  }
}, 4);
module.link("./userPresence.html");
var data = new Map();
var options = {
  threshold: 0.1
};
var lastEntries = [];

var handleEntries = function (entries) {
  lastEntries = entries.filter(function (_ref) {
    var isIntersecting = _ref.isIntersecting;
    return isIntersecting;
  });
  lastEntries.forEach(function () {
    function _callee(entry) {
      var _data$get, uid;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _data$get = data.get(entry.target), uid = _data$get.uid;
                Presence.get(uid);

              case 2:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }());
};

var featureExists = !!window.IntersectionObserver;
var observer = featureExists && new IntersectionObserver(handleEntries, options);
Tracker.autorun(function () {
  // Only clear statuses on disconnect, prevent process it on reconnect again
  var isConnected = Meteor.status().connected;

  if (!Meteor.userId() || !isConnected) {
    Presence.reset();
    return Meteor.users.update({
      status: {
        $exists: true
      }
    }, {
      $unset: {
        status: true
      }
    }, {
      multi: true
    });
  }

  Presence.restart();

  if (featureExists) {
    for (var _iterator = _createForOfIteratorHelperLoose(data.keys()), _step; !(_step = _iterator()).done;) {
      var node = _step.value;
      observer.unobserve(node);
      observer.observe(node);
    }

    return;
  }

  Accounts.onLogout(function () {
    Presence.reset();
  });
});
Template.userPresence.onRendered(function () {
  if (!this.data || !this.data.uid) {
    return;
  }

  data.set(this.firstNode, this.data);

  if (featureExists) {
    return observer.observe(this.firstNode);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-vrecord":{"client":{"vrecord.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/vrecord.html                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.vrecord.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.vrecord.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/template.vrecord.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("vrecDialog");
Template["vrecDialog"] = new Template("Template.vrecDialog", (function() {
  var view = this;
  return HTML.DIV({
    class: "rc-old vrec-dialog secondary-background-color"
  }, HTML.Raw('\n\t\t<div class="video-container">\n\t\t\t<video width="320" height="240" src=""></video>\n\t\t</div>\n\t\t'), HTML.DIV({
    class: "buttons"
  }, "\n\t\t\t", HTML.BUTTON(HTML.Attrs({
    class: function() {
      return [ "rc-button rc-button--primary record rc-button--small ", Spacebars.mustache(view.lookup("recordDisabled")) ];
    }
  }, function() {
    return Spacebars.attrMustache(view.lookup("recordDisabled"));
  }), "\n\t\t\t\t", HTML.I({
    class: function() {
      return Spacebars.mustache(view.lookup("recordIcon"));
    }
  }), HTML.SPAN(Blaze.View("lookup:time", function() {
    return Spacebars.mustache(view.lookup("time"));
  })), "\n\t\t\t"), "\n\t\t\t", HTML.SPAN({
    class: "buttons__wrapper"
  }, "\n\t\t\t\t", HTML.BUTTON({
    class: "rc-button rc-button--nude rc-button--small cancel"
  }, Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Cancel");
  })), "\n\t\t\t\t", HTML.BUTTON(HTML.Attrs({
    class: function() {
      return [ "rc-button rc-button--primary rc-button--small ok ", Spacebars.mustache(view.lookup("okDisabled")) ];
    }
  }, function() {
    return Spacebars.attrMustache(view.lookup("okDisabled"));
  }), Blaze.View("lookup:_", function() {
    return Spacebars.mustache(view.lookup("_"), "Ok");
  })), "\n\t\t\t"), "\n\t\t"), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"VRecDialog.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/VRecDialog.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  VRecDialog: function () {
    return VRecDialog;
  }
});
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var VideoRecorder;
module.link("../../ui", {
  VideoRecorder: function (v) {
    VideoRecorder = v;
  }
}, 2);
var VRecDialog = new ( /*#__PURE__*/function () {
  function _class2() {
    this.opened = false;
    this.dialogView = null;
  }

  var _proto = _class2.prototype;

  _proto.init = function () {
    function init() {
      this.dialogView = Blaze.render(Template.vrecDialog, document.body);
    }

    return init;
  }();

  _proto.open = function () {
    function open(source, _ref) {
      var rid = _ref.rid,
          tmid = _ref.tmid;

      if (!this.dialogView) {
        this.init();
      }

      this.dialogView.templateInstance().update({
        rid: rid,
        tmid: tmid,
        input: source.querySelector('.js-input-message')
      });
      this.source = source;
      var dialog = $('.vrec-dialog');
      this.dialogView.templateInstance().setPosition(dialog, source);
      dialog.addClass('show');
      this.opened = true;
      return this.initializeCamera();
    }

    return open;
  }();

  _proto.close = function () {
    function close() {
      $('.vrec-dialog').removeClass('show');
      this.opened = false;

      if (this.video != null) {
        return VideoRecorder.stop();
      }
    }

    return close;
  }();

  _proto.initializeCamera = function () {
    function initializeCamera() {
      this.video = $('.vrec-dialog video').get('0');

      if (!this.video) {
        return;
      }

      return VideoRecorder.start(this.video);
    }

    return initializeCamera;
  }();

  return _class2;
}())();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  VRecDialog: function () {
    return VRecDialog;
  }
});
module.link("./vrecord.html");
module.link("./vrecord");
var VRecDialog;
module.link("./VRecDialog", {
  VRecDialog: function (v) {
    VRecDialog = v;
  }
}, 0);
module.link("./vrecord.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"vrecord.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/vrecord.css                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"vrecord.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-vrecord/client/vrecord.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 3);
var VRecDialog;
module.link("./VRecDialog", {
  VRecDialog: function (v) {
    VRecDialog = v;
  }
}, 4);
var VideoRecorder, fileUpload, UserAction, USER_ACTIVITIES;
module.link("../../ui", {
  VideoRecorder: function (v) {
    VideoRecorder = v;
  },
  fileUpload: function (v) {
    fileUpload = v;
  },
  UserAction: function (v) {
    UserAction = v;
  },
  USER_ACTIVITIES: function (v) {
    USER_ACTIVITIES = v;
  }
}, 5);
Template.vrecDialog.helpers({
  recordIcon: function () {
    if (VideoRecorder.cameraStarted.get() && VideoRecorder.recording.get()) {
      return 'icon-stop';
    }

    return 'icon-circle';
  },
  okDisabled: function () {
    if (VideoRecorder.cameraStarted.get() && VideoRecorder.recordingAvailable.get()) {
      return '';
    }

    return 'disabled';
  },
  recordDisabled: function () {
    return VideoRecorder.cameraStarted.get() ? '' : 'disabled';
  },
  time: function () {
    return Template.instance().time.get();
  }
});
var recordingInterval = new ReactiveVar(null);

var stopVideoRecording = function (rid, tmid) {
  if (recordingInterval.get()) {
    clearInterval(recordingInterval.get());
    recordingInterval.set(null);
  }

  UserAction.stop(rid, USER_ACTIVITIES.USER_RECORDING, {
    tmid: tmid
  });
};

Template.vrecDialog.events({
  'click .vrec-dialog .cancel': function (e, t) {
    var rid = t.rid.get();
    var tmid = t.tmid.get();
    VideoRecorder.stop();
    VRecDialog.close();
    t.time.set('');
    stopVideoRecording(rid, tmid);
  },
  'click .vrec-dialog .record': function (e, t) {
    var rid = t.rid.get();
    var tmid = t.tmid.get();

    if (VideoRecorder.recording.get()) {
      VideoRecorder.stopRecording();
      stopVideoRecording(rid, tmid);
    } else {
      VideoRecorder.record();
      UserAction.performContinuously(rid, USER_ACTIVITIES.USER_RECORDING, {
        tmid: tmid
      });
      t.time.set('00:00');
      var startTime = new Date();
      recordingInterval.set(setInterval(function () {
        var now = new Date();
        var distance = (now.getTime() - startTime.getTime()) / 1000;
        var minutes = Math.floor(distance / 60);
        var seconds = Math.floor(distance % 60);
        t.time.set(String(minutes).padStart(2, '0') + ":" + String(seconds).padStart(2, '0'));
      }, 1000));
    }
  },
  'click .vrec-dialog .ok': function (e, instance) {
    var _ref = [instance.rid.get(), instance.tmid.get(), instance.input.get()],
        rid = _ref[0],
        tmid = _ref[1],
        input = _ref[2];

    var cb = function (blob) {
      fileUpload([{
        file: blob,
        type: 'video',
        name: TAPi18n.__('Video record') + ".webm"
      }], input, {
        rid: rid,
        tmid: tmid
      });
      VRecDialog.close();
    };

    VideoRecorder.stop(cb);
    instance.time.set('');
    stopVideoRecording(rid, tmid);
  }
});
Template.vrecDialog.onCreated(function () {
  var _this = this;

  this.width = 400;
  this.height = 290;
  this.rid = new ReactiveVar();
  this.tmid = new ReactiveVar();
  this.input = new ReactiveVar();
  this.time = new ReactiveVar('');

  this.update = function (_ref2) {
    var rid = _ref2.rid,
        tmid = _ref2.tmid,
        input = _ref2.input;

    _this.rid.set(rid);

    _this.tmid.set(tmid);

    _this.input.set(input);
  };

  this.setPosition = function (dialog, source) {
    var _this2 = this;

    var anchor = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'left';

    var _set = function () {
      var sourcePos = $(source).offset();
      var top = sourcePos.top - _this2.height - 5;

      if (top < 0) {
        top = 10;
      }

      if (anchor === 'left') {
        var right = window.innerWidth - (sourcePos.left + source.offsetWidth - 25);

        if (right < 0) {
          right = 10;
        }

        return dialog.css({
          top: top + "px",
          right: right + "px"
        });
      }

      var left = sourcePos.left - _this2.width + 100;

      if (left < 0) {
        left = 10;
      }

      return dialog.css({
        top: top + "px",
        left: left + "px"
      });
    };

    var set = _.debounce(_set, 2000);

    _set();

    this.remove = set;
    $(window).on('resize', set);
  };
});
Template.vrecDialog.onDestroyed(function () {
  VRecDialog.close(this.rid.get());
  $(window).off('resize', this.remove);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"webdav":{"client":{"selectWebdavAccount.html":[
  "./template.selectWebdavAccount.js"
],"template.selectWebdavAccount.js":[],"webdavFilePicker.html":[
  "./template.webdavFilePicker.js"
],"template.webdavFilePicker.js":[],"startup":{"messageBoxActions.js":[
  "meteor/meteor",
  "meteor/tracker",
  "../../../utils",
  "../../../settings",
  "../../../ui-utils",
  "../../../models/client",
  "../../../../client/lib/imperativeModal",
  "../../../../client/views/room/webdav/AddWebdavAccountModal"
],"sync.js":[
  "@babel/runtime/regenerator",
  "meteor/meteor",
  "meteor/tracker",
  "../../../utils/client",
  "../../../models/client",
  "../../../notifications/client"
]},"actionButton.js":[
  "@babel/runtime/helpers/slicedToArray",
  "meteor/meteor",
  "../../utils",
  "../../models/client",
  "../../settings",
  "../../ui-utils",
  "../../ui-utils/client/lib/messageArgs"
],"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webdav/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);
Meteor.startup(function () {
  Tracker.autorun(function (c) {
    if (!settings.get('Webdav_Integration_Enabled')) {
      return;
    }

    c.stop();
    module.dynamicImport('./startup/messageBoxActions');
    module.dynamicImport('./startup/sync');
    module.dynamicImport('./actionButton');
    module.dynamicImport('./webdavFilePicker.html');
    module.dynamicImport('./webdavFilePicker.css');
    module.dynamicImport('./webdavFilePicker');
    module.dynamicImport('./selectWebdavAccount.html');
    module.dynamicImport('./selectWebdavAccount');
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"selectWebdavAccount.js":[
  "meteor/meteor",
  "meteor/templating",
  "../../ui-utils",
  "../../utils",
  "../../models/client",
  "../../../client/lib/toast"
],"webdavFilePicker.css":[],"webdavFilePicker.js":[
  "@babel/runtime/regenerator",
  "meteor/meteor",
  "meteor/templating",
  "underscore",
  "meteor/session",
  "meteor/ui",
  "meteor/reactive-var",
  "meteor/reactive-dict",
  "../../ui/client/views/app/helpers",
  "../../ui-utils/client",
  "../../utils/client",
  "../../file-upload/client",
  "../../../client/lib/utils/call",
  "../../../client/lib/toast"
]}},"discussion":{"client":{"lib":{"messageTypes":{"discussionMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/client/lib/messageTypes/discussionMessage.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var MessageTypes;
module.link("../../../../ui-utils/client", {
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 1);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'discussion-created',
    system: false,
    message: 'discussion-created',
    data: function (message) {
      return {
        message: "<svg class=\"rc-icon\" aria-hidden=\"true\"><use xlink:href=\"#icon-discussion\"></use></svg> " + message.msg
      };
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"createDiscussionMessageAction.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/client/createDiscussionMessageAction.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var hasPermission;
module.link("../../authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 3);
var MessageAction;
module.link("../../ui-utils/client", {
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 4);
var messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 5);
var roomTypes;
module.link("../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 6);
var imperativeModal;
module.link("../../../client/lib/imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 7);
var CreateDiscussion;
module.link("../../../client/components/CreateDiscussion/CreateDiscussion", {
  "default": function (v) {
    CreateDiscussion = v;
  }
}, 8);
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (!settings.get('Discussion_enabled')) {
      return MessageAction.removeButton('start-discussion');
    }

    MessageAction.addButton({
      id: 'start-discussion',
      icon: 'discussion',
      label: 'Discussion_start',
      context: ['message', 'message-mobile'],
      action: function () {
        function _callee() {
          var _message$msg;

          var _messageArgs, message, room;

          return _regeneratorRuntime.async(function () {
            function _callee$(_context) {
              while (1) {
                switch (_context.prev = _context.next) {
                  case 0:
                    _messageArgs = messageArgs(this), message = _messageArgs.msg, room = _messageArgs.room;
                    imperativeModal.open({
                      component: CreateDiscussion,
                      props: {
                        defaultParentRoom: room.prid || room._id,
                        onClose: imperativeModal.close,
                        parentMessageId: message._id,
                        nameSuggestion: message === null || message === void 0 ? void 0 : (_message$msg = message.msg) === null || _message$msg === void 0 ? void 0 : _message$msg.substr(0, 140)
                      }
                    });

                  case 2:
                  case "end":
                    return _context.stop();
                }
              }
            }

            return _callee$;
          }(), null, this, null, Promise);
        }

        return _callee;
      }(),
      condition: function (_ref) {
        var _ref$msg = _ref.msg,
            uid = _ref$msg.u._id,
            drid = _ref$msg.drid,
            dcount = _ref$msg.dcount,
            room = _ref.room,
            subscription = _ref.subscription,
            u = _ref.u;

        if (drid || !isNaN(dcount)) {
          return false;
        }

        if (!subscription) {
          return false;
        }

        var isLivechatRoom = roomTypes.isLivechatRoom(room.t);

        if (isLivechatRoom) {
          return false;
        }

        return uid !== u._id ? hasPermission('start-discussion-other-user') : hasPermission('start-discussion');
      },
      order: 1,
      group: 'menu'
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"discussionFromMessageBox.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/client/discussionFromMessageBox.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var messageBox;
module.link("../../ui-utils/client", {
  messageBox: function (v) {
    messageBox = v;
  }
}, 2);
var settings;
module.link("../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var hasPermission;
module.link("../../authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 4);
var imperativeModal;
module.link("../../../client/lib/imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 5);
var CreateDiscussion;
module.link("../../../client/components/CreateDiscussion/CreateDiscussion", {
  "default": function (v) {
    CreateDiscussion = v;
  }
}, 6);
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (!settings.get('Discussion_enabled')) {
      return messageBox.actions.remove('Create_new', /start-discussion/);
    }

    messageBox.actions.add('Create_new', 'Discussion', {
      id: 'start-discussion',
      icon: 'discussion',
      condition: function () {
        return hasPermission('start-discussion') || hasPermission('start-discussion-other-user');
      },
      action: function (data) {
        imperativeModal.open({
          component: CreateDiscussion,
          props: {
            defaultParentRoom: data.prid || data.rid,
            onClose: imperativeModal.close
          }
        });
      }
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/messageTypes/discussionMessage");
module.link("./createDiscussionMessageAction");
module.link("./discussionFromMessageBox");
module.link("./tabBar");
module.link("../lib/discussionRoomType");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/client/tabBar.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMemo, lazy;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  },
  lazy: function (v) {
    lazy = v;
  }
}, 0);
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
var useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 2);
var template = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../../../client/views/room/contextualBar/Discussions');
});
addAction('discussions', function (_ref) {
  var prid = _ref.room.prid;
  var discussionEnabled = useSetting('Discussion_enabled');
  return useMemo(function () {
    return discussionEnabled && !prid ? {
      groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
      id: 'discussions',
      title: 'Discussions',
      icon: 'discussion',
      template: template,
      full: true,
      order: 3
    } : null;
  }, [discussionEnabled, prid]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"discussionRoomType.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/discussion/lib/discussionRoomType.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  DiscussionRoomType: function () {
    return DiscussionRoomType;
  }
});
var RoomTypeConfig, roomTypes;
module.link("../../utils", {
  RoomTypeConfig: function (v) {
    RoomTypeConfig = v;
  },
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 0);

var DiscussionRoomType = /*#__PURE__*/function (_RoomTypeConfig) {
  _inheritsLoose(DiscussionRoomType, _RoomTypeConfig);

  function DiscussionRoomType() {
    return _RoomTypeConfig.call(this, {
      identifier: 't',
      order: 25,
      label: 'Discussion'
    }) || this;
  }

  return DiscussionRoomType;
}(RoomTypeConfig);

roomTypes.add(new DiscussionRoomType());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"markdown":{"lib":{"parser":{"filtered":{"filtered.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/filtered/filtered.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  filtered: function () {
    return filtered;
  }
});

var filtered = function (message) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
    supportSchemesForLink: 'http,https'
  };
  var schemes = options.supportSchemesForLink.split(',').join('|'); // Remove block code backticks

  message = message.replace(/```/g, ''); // Remove inline code backticks

  message = message.replace(new RegExp(/`([^`\r\n]+)\`/gm), function (match) {
    return match.substr(1, match.length - 2);
  }); // Filter [text](url), ![alt_text](image_url)

  message = message.replace(new RegExp("!?\\[([^\\]]+)\\]\\((?:" + schemes + "):\\/\\/[^\\)]+\\)", 'gm'), function (match, title) {
    return title;
  }); // Filter <http://link|Text>

  message = message.replace(new RegExp("(?:<|&lt;)(?:" + schemes + "):\\/\\/[^\\|]+\\|(.+?)(?=>|&gt;)(?:>|&gt;)", 'gm'), function (match, title) {
    return title;
  }); // Filter headings

  message = message.replace(/(^#{1,4}) (([\S\w\d-_\/\*\.,\\][ \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]?)+)/gm, '$2'); // Filter bold

  message = message.replace(/(^|>|[ >_~`])\*{1,2}([^\*\r\n]+)\*{1,2}([<_~`]|\B|\b|$)/gm, '$1$2$3'); // Filter italics

  message = message.replace(/(^|>|[ >*~`])\_{1,2}([^\_\r\n]+)\_{1,2}([<*~`]|\B|\b|$)/gm, '$1$2$3'); // Filter strike-through text

  message = message.replace(/(^|>|[ >_*`])\~{1,2}([^~\r\n]+)\~{1,2}([<_*`]|\B|\b|$)/gm, '$1$2$3'); // Filter block quotes

  message = message.replace(/(?:>){3}\n+([\s\S]*?)\n+(?:<){3}/g, '$1'); // Filter > quote

  message = message.replace(/^>(.*)$/gm, '$1');
  return message;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"marked":{"marked.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/marked/marked.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  marked: function () {
    return marked;
  }
});
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 1);

var _marked;

module.link("marked", {
  "default": function (v) {
    _marked = v;
  }
}, 2);
var createDOMPurify;
module.link("dompurify", {
  "default": function (v) {
    createDOMPurify = v;
  }
}, 3);
var unescapeHTML, escapeHTML;
module.link("@rocket.chat/string-helpers", {
  unescapeHTML: function (v) {
    unescapeHTML = v;
  },
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 4);
var hljs, register;
module.link("../../hljs", {
  "default": function (v) {
    hljs = v;
  },
  register: function (v) {
    register = v;
  }
}, 5);
var getGlobalWindow;
module.link("../../getGlobalWindow", {
  getGlobalWindow: function (v) {
    getGlobalWindow = v;
  }
}, 6);
var renderer = new _marked.Renderer();
var msg = null;

renderer.code = function (code, lang, escaped) {
  if (this.options.highlight) {
    var out = this.options.highlight(code, lang);

    if (out != null && out !== code) {
      escaped = true;
      code = out;
    }
  }

  var text = null;

  if (!lang) {
    text = "<pre><code class=\"code-colors hljs\">" + (escaped ? code : escapeHTML(code)) + "</code></pre>";
  } else {
    text = "<pre><code class=\"code-colors hljs " + escape(lang, true) + "\">" + (escaped ? code : escapeHTML(code)) + "</code></pre>";
  }

  if (_.isString(msg)) {
    return text;
  }

  var token = "=!=" + Random.id() + "=!=";
  msg.tokens.push({
    highlight: true,
    token: token,
    text: text
  });
  return token;
};

renderer.codespan = function (text) {
  text = "<code class=\"code-colors inline\">" + text + "</code>";

  if (_.isString(msg)) {
    return text;
  }

  var token = "=!=" + Random.id() + "=!=";
  msg.tokens.push({
    token: token,
    text: text
  });
  return token;
};

renderer.blockquote = function (quote) {
  return "<blockquote class=\"background-transparent-darker-before\">" + quote + "</blockquote>";
};

var linkRenderer = renderer.link;

renderer.link = function (href, title, text) {
  var html = linkRenderer.call(renderer, href, title, text);
  return html.replace(/^<a /, '<a target="_blank" rel="nofollow noopener noreferrer" ');
};

var highlight = function (code, lang) {
  if (!lang) {
    return code;
  }

  try {
    register(lang);
    return hljs.highlight(lang, code).value;
  } catch (e) {
    // Unknown language
    return code;
  }
};

var marked = function (message, _ref) {
  var _ref$marked = _ref.marked;
  _ref$marked = _ref$marked === void 0 ? {} : _ref$marked;
  var gfm = _ref$marked.gfm,
      tables = _ref$marked.tables,
      breaks = _ref$marked.breaks,
      pedantic = _ref$marked.pedantic,
      smartLists = _ref$marked.smartLists,
      smartypants = _ref$marked.smartypants;
  msg = message;

  if (!message.tokens) {
    message.tokens = [];
  }

  message.html = _marked(unescapeHTML(message.html), {
    gfm: gfm,
    tables: tables,
    breaks: breaks,
    pedantic: pedantic,
    smartLists: smartLists,
    smartypants: smartypants,
    renderer: renderer,
    highlight: highlight
  });
  var window = getGlobalWindow();
  var DomPurify = createDOMPurify(window);
  message.html = DomPurify.sanitize(message.html, {
    ADD_ATTR: ['target']
  });
  return message;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"original":{"code.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/original/code.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  code: function () {
    return code;
  }
});
var unescapeHTML;
module.link("@rocket.chat/string-helpers", {
  unescapeHTML: function (v) {
    unescapeHTML = v;
  }
}, 0);
var hljs, register;
module.link("../../hljs", {
  "default": function (v) {
    hljs = v;
  },
  register: function (v) {
    register = v;
  }
}, 1);
var addAsToken;
module.link("./token", {
  addAsToken: function (v) {
    addAsToken = v;
  }
}, 2);

var inlinecode = function (message) {
  // Support `text`
  message.html = message.html.replace(/\`([^`\r\n]+)\`([<_*~]|\B|\b|$)/gm, function (match, p1, p2) {
    return addAsToken(message, "<span class=\"copyonly\">`</span><span><code class=\"code-colors inline\">" + p1 + "</code></span><span class=\"copyonly\">`</span>" + p2, 'inlinecode', {
      noHtml: match
    });
  });
};

var codeblocks = function (message) {
  // Count occurencies of ```
  var count = (message.html.match(/```/gm) || []).length;

  if (count) {
    // Check if we need to add a final ```
    if (count % 2 > 0) {
      message.html = message.html + "\n```";
      message.msg = message.msg + "\n```";
    } // Separate text in code blocks and non code blocks


    var msgParts = message.html.split(/(^.*)(```(?:[a-zA-Z]+)?(?:(?:.|\r|\n)*?)```)(.*\n?)$/gm);

    for (var index = 0; index < msgParts.length; index++) {
      // Verify if this part is code
      var part = msgParts[index];
      var codeMatch = part.match(/^```[\r\n]*(.*[\r\n\ ]?)[\r\n]*([\s\S]*?)```+?$/);

      if (codeMatch) {
        (function () {
          // Process highlight if this part is code
          var singleLine = codeMatch[0].indexOf('\n') === -1;
          var lang = !singleLine && Array.from(hljs.listLanguages()).includes(codeMatch[1].trim()) ? codeMatch[1].trim() : '';
          var emptyLanguage = lang === '' ? unescapeHTML(codeMatch[1] + codeMatch[2]) : unescapeHTML(codeMatch[2]);
          var code = singleLine ? unescapeHTML(codeMatch[1]) : emptyLanguage;

          var result = function () {
            if (lang) {
              try {
                register(lang);
                return hljs.highlight(lang, code);
              } catch (error) {
                console.error(error);
              }
            }

            return hljs.highlightAuto(lang + code);
          }();

          var token = addAsToken(message, "<pre><code class='code-colors hljs " + result.language + "'><span class='copyonly'>```<br></span>" + result.value + "<span class='copyonly'><br>```</span></code></pre>", 'code', {
            noHtml: codeMatch[0],
            highlight: true
          });
          msgParts[index] = token;
        })();
      } else {
        msgParts[index] = part;
      }
    } // Re-mount message


    message.html = msgParts.join('');
  }
};

var code = function (message) {
  var _message$html;

  if ((_message$html = message.html) !== null && _message$html !== void 0 && _message$html.trim()) {
    codeblocks(message);
    inlinecode(message);
  }

  return message;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"markdown.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/original/markdown.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  markdown: function () {
    return markdown;
  }
});
var addAsToken, isToken, validateAllowedTokens;
module.link("./token", {
  addAsToken: function (v) {
    addAsToken = v;
  },
  isToken: function (v) {
    isToken = v;
  },
  validateAllowedTokens: function (v) {
    validateAllowedTokens = v;
  }
}, 0);

var validateUrl = function (url, message) {
  var _message$tokens;

  // Don't render markdown inside links
  if (message !== null && message !== void 0 && (_message$tokens = message.tokens) !== null && _message$tokens !== void 0 && _message$tokens.some(function (token) {
    return url.includes(token.token);
  })) {
    return false;
  } // Valid urls don't contain whitespaces


  if (/\s/.test(url.trim())) {
    return false;
  }

  try {
    new URL(url);
    return true;
  } catch (e) {
    return false;
  }
};

var endsWithWhitespace = function (text) {
  return text.substring(text.length - 1).match(/\s/);
};

var getParseableMarkersCount = function (start, end) {
  var usableMarkers = start.length > 1 ? 2 : 1;
  return end.length - usableMarkers >= 0 ? usableMarkers : 1;
};

var getTextWrapper = function (marker, tagName) {
  return function (textPrepend, wrappedText, textAppend) {
    return textPrepend + "<span class=\"copyonly\">" + marker + "</span><" + tagName + ">" + wrappedText + "</" + tagName + "><span class=\"copyonly\">" + marker + "</span>" + textAppend;
  };
};

var getRegexReplacer = function (replaceFunction, getRegex) {
  return function (marker, tagName) {
    var wrapper = getTextWrapper(marker, tagName);
    return function (msg) {
      return msg.replace(getRegex(marker), function () {
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        return replaceFunction.apply(void 0, [wrapper].concat(args));
      });
    };
  };
};

var getParserWithCustomMarker = getRegexReplacer(function (wrapper, match, p1, p2, p3) {
  if (endsWithWhitespace(p2)) {
    return match;
  }

  var finalMarkerCount = getParseableMarkersCount(p1, p3);
  return wrapper(p1.substring(finalMarkerCount), p2, p3.substring(finalMarkerCount));
}, function (marker) {
  return new RegExp("(\\" + marker + "+(?!\\s))([^\\" + marker + "\\r\\n]+)(\\" + marker + "+)", 'gm');
});
var parseBold = getParserWithCustomMarker('*', 'strong');
var parseStrike = getParserWithCustomMarker('~', 'strike');
var parseItalic = getRegexReplacer(function (wrapper, match, p1, p2, p3, p4, p5) {
  if (p1 || p5 || endsWithWhitespace(p3)) {
    return match;
  }

  var finalMarkerCount = getParseableMarkersCount(p2, p4);
  return wrapper(p2.substring(finalMarkerCount), p3, p4.substring(finalMarkerCount));
}, function () {
  return new RegExp('([^\\r\\n\\s~*_]){0,1}(\\_+(?!\\s))([^\\_\\r\\n]+)(\\_+)([^\\r\\n\\s]){0,1}', 'gm');
})('_', 'em');

var parseNotEscaped = function (message, _ref) {
  var supportSchemesForLink = _ref.supportSchemesForLink,
      headers = _ref.headers,
      rootUrl = _ref.rootUrl;
  var msg = message.html;

  if (!message.tokens) {
    message.tokens = [];
  }

  var schemes = (supportSchemesForLink || '').split(',').join('|');

  if (headers) {
    // Support # Text for h1
    msg = msg.replace(/^# (([\S\w\d-_\/\*\.,\\][ \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]?)+)/gm, '<h1>$1</h1>'); // Support # Text for h2

    msg = msg.replace(/^## (([\S\w\d-_\/\*\.,\\][ \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]?)+)/gm, '<h2>$1</h2>'); // Support # Text for h3

    msg = msg.replace(/^### (([\S\w\d-_\/\*\.,\\][ \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]?)+)/gm, '<h3>$1</h3>'); // Support # Text for h4

    msg = msg.replace(/^#### (([\S\w\d-_\/\*\.,\\][ \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]?)+)/gm, '<h4>$1</h4>');
  } // Support *text* to make bold


  msg = parseBold(msg); // Support _text_ to make italics

  msg = parseItalic(msg); // // Support ~text~ to strike through text

  msg = parseStrike(msg); // Support for block quote
  // >>>
  // Text
  // <<<

  msg = msg.replace(/(?:&gt;){3}\n+([\s\S]*?)\n+(?:&lt;){3}/g, '<blockquote class="background-transparent-darker-before"><span class="copyonly">&gt;&gt;&gt;</span>$1<span class="copyonly">&lt;&lt;&lt;</span></blockquote>'); // Support >Text for quote

  msg = msg.replace(/^&gt;(.*)$/gm, '<blockquote class="background-transparent-darker-before"><span class="copyonly">&gt;</span>$1</blockquote>'); // Remove white-space around blockquote (prevent <br>). Because blockquote is block element.

  msg = msg.replace(/\s*<blockquote class="background-transparent-darker-before">/gm, '<blockquote class="background-transparent-darker-before">');
  msg = msg.replace(/<\/blockquote>\s*/gm, '</blockquote>'); // Remove new-line between blockquotes.

  msg = msg.replace(/<\/blockquote>\n<blockquote/gm, '</blockquote><blockquote'); // Support ![alt text](http://image url)

  msg = msg.replace(new RegExp("!\\[([^\\]]+)\\]\\(((?:" + schemes + "):\\/\\/[^\\s]+)\\)", 'gm'), function (match, title, url) {
    if (!validateUrl(url, message)) {
      return match;
    }

    if (isToken(title) && !validateAllowedTokens(message, title, ['bold', 'italic', 'strike'])) {
      return match;
    }

    url = encodeURI(url);
    var target = url.indexOf(rootUrl) === 0 ? '' : '_blank';
    return addAsToken(message, "<a data-title=\"" + url + "\" href=\"" + url + "\" title=\"" + title + "\" target=\"" + target + "\" rel=\"noopener noreferrer\"><div class=\"inline-image\" style=\"background-image: url(" + url + ");\"></div></a>", 'link');
  }); // Support [Text](http://link)

  msg = msg.replace(new RegExp("\\[([^\\]]+)\\]\\(((?:" + schemes + "):\\/\\/[^\\s]+)\\)", 'gm'), function (match, title, url) {
    if (!validateUrl(url, message)) {
      return match;
    }

    if (isToken(title) && !validateAllowedTokens(message, title, ['bold', 'italic', 'strike'])) {
      return match;
    }

    var target = url.indexOf(rootUrl) === 0 ? '' : '_blank';
    title = title.replace(/&amp;/g, '&');
    var escapedUrl = encodeURI(url);
    return addAsToken(message, "<a data-title=\"" + escapedUrl + "\" href=\"" + escapedUrl + "\" target=\"" + target + "\" rel=\"noopener noreferrer\">" + title + "</a>", 'link');
  }); // Support <http://link|Text>

  msg = msg.replace(new RegExp("(?:<|&lt;)((?:" + schemes + "):\\/\\/[^\\|]+)\\|(.+?)(?=>|&gt;)(?:>|&gt;)", 'gm'), function (match, url, title) {
    if (!validateUrl(url, message)) {
      return match;
    }

    if (isToken(title) && !validateAllowedTokens(message, title, ['bold', 'italic', 'strike'])) {
      return match;
    }

    url = encodeURI(url);
    var target = url.indexOf(rootUrl) === 0 ? '' : '_blank';
    return addAsToken(message, "<a data-title=\"" + url + "\" href=\"" + url + "\" target=\"" + target + "\" rel=\"noopener noreferrer\">" + title + "</a>", 'link');
  });
  return msg;
};

var markdown = function (message, options) {
  message.html = parseNotEscaped(message, options);
  return message;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"original.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/original/original.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  original: function () {
    return original;
  }
});
var markdown;
module.link("./markdown.js", {
  markdown: function (v) {
    markdown = v;
  }
}, 0);
var code;
module.link("./code.js", {
  code: function (v) {
    code = v;
  }
}, 1);

var original = function (message) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
    supportSchemesForLink: 'http,https',
    headers: true
  };
  // Parse markdown code
  message = code(message); // Parse markdown

  message = markdown(message, options); // Replace linebreak to br

  message.html = message.html.replace(/\n/gm, '<br>');
  return message;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"token.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/parser/original/token.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
module.export({
  addAsToken: function () {
    return addAsToken;
  },
  isToken: function () {
    return isToken;
  },
  validateAllowedTokens: function () {
    return validateAllowedTokens;
  },
  validateForbiddenTokens: function () {
    return validateForbiddenTokens;
  }
});
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 0);

var addAsToken = function (message, html, type, extra) {
  if (!message.tokens) {
    message.tokens = [];
  }

  var token = "=!=" + Random.id() + "=!=";
  message.tokens.push(_objectSpread({
    token: token,
    type: type,
    text: html
  }, extra && _objectSpread({}, extra)));
  return token;
};

var isToken = function (msg) {
  return /=!=[.a-z0-9]{17}=!=/gim.test(msg.trim());
};

var validateAllowedTokens = function (message, id, desiredTokens) {
  var tokens = id.match(/=!=[.a-z0-9]{17}=!=/gim) || [];
  var tokensFound = message.tokens.filter(function (_ref) {
    var token = _ref.token;
    return tokens.includes(token);
  });
  return tokensFound.length === 0 || tokensFound.every(function (token) {
    return desiredTokens.includes(token.type);
  });
};

var validateForbiddenTokens = function (message, id, desiredTokens) {
  var tokens = id.match(/=!=[.a-z0-9]{17}=!=/gim) || [];
  var tokensFound = message.tokens.filter(function (_ref2) {
    var token = _ref2.token;
    return tokens.includes(token);
  });
  return tokensFound.length === 0 || !tokensFound.some(function (token) {
    return desiredTokens.includes(token.type);
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"getGlobalWindow.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/getGlobalWindow.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getGlobalWindow: function () {
    return getGlobalWindow;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);

var _ref = Meteor.isServer ? require('../server/getGlobalWindow') : require('../client/getGlobalWindow'),
    getGlobalWindow = _ref.getGlobalWindow;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hljs.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/hljs.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  register: function () {
    return register;
  }
});
var hljs;
module.link("highlight.js/lib/highlight", {
  "default": function (v) {
    hljs = v;
  }
}, 0);
var clean;
module.link("highlight.js/lib/languages/clean", {
  "default": function (v) {
    clean = v;
  }
}, 1);
var markdown;
module.link("highlight.js/lib/languages/markdown", {
  "default": function (v) {
    markdown = v;
  }
}, 2);
var javascript;
module.link("highlight.js/lib/languages/javascript", {
  "default": function (v) {
    javascript = v;
  }
}, 3);
hljs.registerLanguage('markdown', markdown);
hljs.registerLanguage('clean', clean);
hljs.registerLanguage('javascript', javascript); // eslint-disable-next-line complexity

var register = function () {
  function _callee(lang) {
    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.t0 = lang;
              _context.next = _context.t0 === 'onec' ? 3 : _context.t0 === 'abnf' ? 8 : _context.t0 === 'accesslog' ? 13 : _context.t0 === 'actionscript' ? 18 : _context.t0 === 'ada' ? 23 : _context.t0 === 'apache' ? 28 : _context.t0 === 'applescript' ? 33 : _context.t0 === 'arduino' ? 38 : _context.t0 === 'armasm' ? 43 : _context.t0 === 'asciidoc' ? 48 : _context.t0 === 'aspectj' ? 53 : _context.t0 === 'autohotkey' ? 58 : _context.t0 === 'autoit' ? 63 : _context.t0 === 'avrasm' ? 68 : _context.t0 === 'awk' ? 73 : _context.t0 === 'axapta' ? 78 : _context.t0 === 'bash' ? 83 : _context.t0 === 'basic' ? 88 : _context.t0 === 'bnf' ? 93 : _context.t0 === 'brainfuck' ? 98 : _context.t0 === 'cal' ? 103 : _context.t0 === 'capnproto' ? 108 : _context.t0 === 'ceylon' ? 113 : _context.t0 === 'clean' ? 118 : _context.t0 === 'clojure' ? 123 : _context.t0 === 'clojure-repl' ? 128 : _context.t0 === 'cmake' ? 133 : _context.t0 === 'coffeescript' ? 138 : _context.t0 === 'coq' ? 143 : _context.t0 === 'cos' ? 148 : _context.t0 === 'cpp' ? 153 : _context.t0 === 'crmsh' ? 158 : _context.t0 === 'crystal' ? 163 : _context.t0 === 'cs' ? 168 : _context.t0 === 'csp' ? 173 : _context.t0 === 'css' ? 178 : _context.t0 === 'd' ? 183 : _context.t0 === 'dart' ? 188 : _context.t0 === 'delphi' ? 193 : _context.t0 === 'diff' ? 198 : _context.t0 === 'django' ? 203 : _context.t0 === 'dns' ? 208 : _context.t0 === 'dockerfile' ? 213 : _context.t0 === 'dos' ? 218 : _context.t0 === 'dsconfig' ? 223 : _context.t0 === 'dts' ? 228 : _context.t0 === 'dust' ? 233 : _context.t0 === 'ebnf' ? 238 : _context.t0 === 'elixir' ? 243 : _context.t0 === 'elm' ? 248 : _context.t0 === 'erb' ? 253 : _context.t0 === 'erlang' ? 258 : _context.t0 === 'excel' ? 263 : _context.t0 === 'fix' ? 268 : _context.t0 === 'flix' ? 273 : _context.t0 === 'fortran' ? 278 : _context.t0 === 'fsharp' ? 283 : _context.t0 === 'gams' ? 288 : _context.t0 === 'gauss' ? 293 : _context.t0 === 'gcode' ? 298 : _context.t0 === 'gherkin' ? 303 : _context.t0 === 'glsl' ? 308 : _context.t0 === 'go' ? 313 : _context.t0 === 'golo' ? 318 : _context.t0 === 'gradle' ? 323 : _context.t0 === 'groovy' ? 328 : _context.t0 === 'haml' ? 333 : _context.t0 === 'handlebars' ? 338 : _context.t0 === 'haskell' ? 343 : _context.t0 === 'haxe' ? 348 : _context.t0 === 'hsp' ? 353 : _context.t0 === 'htmlbars' ? 358 : _context.t0 === 'http' ? 363 : _context.t0 === 'hy' ? 368 : _context.t0 === 'inform7' ? 373 : _context.t0 === 'ini' ? 378 : _context.t0 === 'irpf90' ? 383 : _context.t0 === 'java' ? 388 : _context.t0 === 'javascript' ? 393 : _context.t0 === 'jboss-cli' ? 398 : _context.t0 === 'json' ? 403 : _context.t0 === 'julia' ? 408 : _context.t0 === 'julia-repl' ? 413 : _context.t0 === 'kotlin' ? 418 : _context.t0 === 'lasso' ? 423 : _context.t0 === 'ldif' ? 428 : _context.t0 === 'leaf' ? 433 : _context.t0 === 'less' ? 438 : _context.t0 === 'lisp' ? 443 : _context.t0 === 'livecodeserver' ? 448 : _context.t0 === 'livescript' ? 453 : _context.t0 === 'llvm' ? 458 : _context.t0 === 'lsl' ? 463 : _context.t0 === 'lua' ? 468 : _context.t0 === 'makefile' ? 473 : _context.t0 === 'markdown' ? 478 : _context.t0 === 'mathematica' ? 483 : _context.t0 === 'matlab' ? 488 : _context.t0 === 'maxima' ? 493 : _context.t0 === 'mel' ? 498 : _context.t0 === 'mercury' ? 503 : _context.t0 === 'mipsasm' ? 508 : _context.t0 === 'mizar' ? 513 : _context.t0 === 'perl' ? 518 : _context.t0 === 'mojolicious' ? 523 : _context.t0 === 'monkey' ? 528 : _context.t0 === 'moonscript' ? 533 : _context.t0 === 'n1ql' ? 538 : _context.t0 === 'nginx' ? 543 : _context.t0 === 'nimrod' ? 548 : _context.t0 === 'nix' ? 553 : _context.t0 === 'nsis' ? 558 : _context.t0 === 'objectivec' ? 563 : _context.t0 === 'ocaml' ? 568 : _context.t0 === 'openscad' ? 573 : _context.t0 === 'oxygene' ? 578 : _context.t0 === 'parser3' ? 583 : _context.t0 === 'pf' ? 588 : _context.t0 === 'php' ? 593 : _context.t0 === 'pony' ? 598 : _context.t0 === 'powershell' ? 603 : _context.t0 === 'processing' ? 608 : _context.t0 === 'profile' ? 613 : _context.t0 === 'prolog' ? 618 : _context.t0 === 'protobuf' ? 623 : _context.t0 === 'puppet' ? 628 : _context.t0 === 'purebasic' ? 633 : _context.t0 === 'python' ? 638 : _context.t0 === 'q' ? 643 : _context.t0 === 'qml' ? 648 : _context.t0 === 'r' ? 653 : _context.t0 === 'rib' ? 658 : _context.t0 === 'roboconf' ? 663 : _context.t0 === 'rsl' ? 668 : _context.t0 === 'ruleslanguage' ? 673 : _context.t0 === 'rust' ? 678 : _context.t0 === 'scala' ? 683 : _context.t0 === 'scheme' ? 688 : _context.t0 === 'scilab' ? 693 : _context.t0 === 'scss' ? 698 : _context.t0 === 'shell' ? 703 : _context.t0 === 'smali' ? 708 : _context.t0 === 'smalltalk' ? 713 : _context.t0 === 'sml' ? 718 : _context.t0 === 'sqf' ? 723 : _context.t0 === 'sql' ? 728 : _context.t0 === 'stan' ? 733 : _context.t0 === 'stata' ? 738 : _context.t0 === 'step21' ? 743 : _context.t0 === 'stylus' ? 748 : _context.t0 === 'subunit' ? 753 : _context.t0 === 'swift' ? 758 : _context.t0 === 'taggerscript' ? 763 : _context.t0 === 'yaml' ? 768 : _context.t0 === 'tap' ? 773 : _context.t0 === 'tcl' ? 778 : _context.t0 === 'tex' ? 783 : _context.t0 === 'thrift' ? 788 : _context.t0 === 'tp' ? 793 : _context.t0 === 'twig' ? 798 : _context.t0 === 'typescript' ? 803 : _context.t0 === 'vala' ? 808 : _context.t0 === 'vbnet' ? 813 : _context.t0 === 'vbscript' ? 818 : _context.t0 === 'vbscript-html' ? 823 : _context.t0 === 'verilog' ? 828 : _context.t0 === 'vhdl' ? 833 : _context.t0 === 'vim' ? 838 : _context.t0 === 'x86asm' ? 843 : _context.t0 === 'xl' ? 848 : _context.t0 === 'xquery' ? 853 : _context.t0 === 'zephir' ? 858 : 863;
              break;

            case 3:
              _context.t1 = hljs;
              _context.next = 6;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/1c'));

            case 6:
              _context.t2 = _context.sent.default;
              return _context.abrupt("return", _context.t1.registerLanguage.call(_context.t1, 'onec', _context.t2));

            case 8:
              _context.t3 = hljs;
              _context.next = 11;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/abnf'));

            case 11:
              _context.t4 = _context.sent.default;
              return _context.abrupt("return", _context.t3.registerLanguage.call(_context.t3, 'abnf', _context.t4));

            case 13:
              _context.t5 = hljs;
              _context.next = 16;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/accesslog'));

            case 16:
              _context.t6 = _context.sent.default;
              return _context.abrupt("return", _context.t5.registerLanguage.call(_context.t5, 'accesslog', _context.t6));

            case 18:
              _context.t7 = hljs;
              _context.next = 21;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/actionscript'));

            case 21:
              _context.t8 = _context.sent.default;
              return _context.abrupt("return", _context.t7.registerLanguage.call(_context.t7, 'actionscript', _context.t8));

            case 23:
              _context.t9 = hljs;
              _context.next = 26;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/ada'));

            case 26:
              _context.t10 = _context.sent.default;
              return _context.abrupt("return", _context.t9.registerLanguage.call(_context.t9, 'ada', _context.t10));

            case 28:
              _context.t11 = hljs;
              _context.next = 31;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/apache'));

            case 31:
              _context.t12 = _context.sent.default;
              return _context.abrupt("return", _context.t11.registerLanguage.call(_context.t11, 'apache', _context.t12));

            case 33:
              _context.t13 = hljs;
              _context.next = 36;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/applescript'));

            case 36:
              _context.t14 = _context.sent.default;
              return _context.abrupt("return", _context.t13.registerLanguage.call(_context.t13, 'applescript', _context.t14));

            case 38:
              _context.t15 = hljs;
              _context.next = 41;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/arduino'));

            case 41:
              _context.t16 = _context.sent.default;
              return _context.abrupt("return", _context.t15.registerLanguage.call(_context.t15, 'arduino', _context.t16));

            case 43:
              _context.t17 = hljs;
              _context.next = 46;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/armasm'));

            case 46:
              _context.t18 = _context.sent.default;
              return _context.abrupt("return", _context.t17.registerLanguage.call(_context.t17, 'armasm', _context.t18));

            case 48:
              _context.t19 = hljs;
              _context.next = 51;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/asciidoc'));

            case 51:
              _context.t20 = _context.sent.default;
              return _context.abrupt("return", _context.t19.registerLanguage.call(_context.t19, 'asciidoc', _context.t20));

            case 53:
              _context.t21 = hljs;
              _context.next = 56;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/aspectj'));

            case 56:
              _context.t22 = _context.sent.default;
              return _context.abrupt("return", _context.t21.registerLanguage.call(_context.t21, 'aspectj', _context.t22));

            case 58:
              _context.t23 = hljs;
              _context.next = 61;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/autohotkey'));

            case 61:
              _context.t24 = _context.sent.default;
              return _context.abrupt("return", _context.t23.registerLanguage.call(_context.t23, 'autohotkey', _context.t24));

            case 63:
              _context.t25 = hljs;
              _context.next = 66;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/autoit'));

            case 66:
              _context.t26 = _context.sent.default;
              return _context.abrupt("return", _context.t25.registerLanguage.call(_context.t25, 'autoit', _context.t26));

            case 68:
              _context.t27 = hljs;
              _context.next = 71;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/avrasm'));

            case 71:
              _context.t28 = _context.sent.default;
              return _context.abrupt("return", _context.t27.registerLanguage.call(_context.t27, 'avrasm', _context.t28));

            case 73:
              _context.t29 = hljs;
              _context.next = 76;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/awk'));

            case 76:
              _context.t30 = _context.sent.default;
              return _context.abrupt("return", _context.t29.registerLanguage.call(_context.t29, 'awk', _context.t30));

            case 78:
              _context.t31 = hljs;
              _context.next = 81;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/axapta'));

            case 81:
              _context.t32 = _context.sent.default;
              return _context.abrupt("return", _context.t31.registerLanguage.call(_context.t31, 'axapta', _context.t32));

            case 83:
              _context.t33 = hljs;
              _context.next = 86;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/bash'));

            case 86:
              _context.t34 = _context.sent.default;
              return _context.abrupt("return", _context.t33.registerLanguage.call(_context.t33, 'bash', _context.t34));

            case 88:
              _context.t35 = hljs;
              _context.next = 91;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/basic'));

            case 91:
              _context.t36 = _context.sent.default;
              return _context.abrupt("return", _context.t35.registerLanguage.call(_context.t35, 'basic', _context.t36));

            case 93:
              _context.t37 = hljs;
              _context.next = 96;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/bnf'));

            case 96:
              _context.t38 = _context.sent.default;
              return _context.abrupt("return", _context.t37.registerLanguage.call(_context.t37, 'bnf', _context.t38));

            case 98:
              _context.t39 = hljs;
              _context.next = 101;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/brainfuck'));

            case 101:
              _context.t40 = _context.sent.default;
              return _context.abrupt("return", _context.t39.registerLanguage.call(_context.t39, 'brainfuck', _context.t40));

            case 103:
              _context.t41 = hljs;
              _context.next = 106;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/cal'));

            case 106:
              _context.t42 = _context.sent.default;
              return _context.abrupt("return", _context.t41.registerLanguage.call(_context.t41, 'cal', _context.t42));

            case 108:
              _context.t43 = hljs;
              _context.next = 111;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/capnproto'));

            case 111:
              _context.t44 = _context.sent.default;
              return _context.abrupt("return", _context.t43.registerLanguage.call(_context.t43, 'capnproto', _context.t44));

            case 113:
              _context.t45 = hljs;
              _context.next = 116;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/ceylon'));

            case 116:
              _context.t46 = _context.sent.default;
              return _context.abrupt("return", _context.t45.registerLanguage.call(_context.t45, 'ceylon', _context.t46));

            case 118:
              _context.t47 = hljs;
              _context.next = 121;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/clean'));

            case 121:
              _context.t48 = _context.sent.default;
              return _context.abrupt("return", _context.t47.registerLanguage.call(_context.t47, 'clean', _context.t48));

            case 123:
              _context.t49 = hljs;
              _context.next = 126;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/clojure'));

            case 126:
              _context.t50 = _context.sent.default;
              return _context.abrupt("return", _context.t49.registerLanguage.call(_context.t49, 'clojure', _context.t50));

            case 128:
              _context.t51 = hljs;
              _context.next = 131;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/clojure-repl'));

            case 131:
              _context.t52 = _context.sent.default;
              return _context.abrupt("return", _context.t51.registerLanguage.call(_context.t51, 'clojure-repl', _context.t52));

            case 133:
              _context.t53 = hljs;
              _context.next = 136;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/cmake'));

            case 136:
              _context.t54 = _context.sent.default;
              return _context.abrupt("return", _context.t53.registerLanguage.call(_context.t53, 'cmake', _context.t54));

            case 138:
              _context.t55 = hljs;
              _context.next = 141;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/coffeescript'));

            case 141:
              _context.t56 = _context.sent.default;
              return _context.abrupt("return", _context.t55.registerLanguage.call(_context.t55, 'coffeescript', _context.t56));

            case 143:
              _context.t57 = hljs;
              _context.next = 146;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/coq'));

            case 146:
              _context.t58 = _context.sent.default;
              return _context.abrupt("return", _context.t57.registerLanguage.call(_context.t57, 'coq', _context.t58));

            case 148:
              _context.t59 = hljs;
              _context.next = 151;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/cos'));

            case 151:
              _context.t60 = _context.sent.default;
              return _context.abrupt("return", _context.t59.registerLanguage.call(_context.t59, 'cos', _context.t60));

            case 153:
              _context.t61 = hljs;
              _context.next = 156;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/cpp'));

            case 156:
              _context.t62 = _context.sent.default;
              return _context.abrupt("return", _context.t61.registerLanguage.call(_context.t61, 'cpp', _context.t62));

            case 158:
              _context.t63 = hljs;
              _context.next = 161;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/crmsh'));

            case 161:
              _context.t64 = _context.sent.default;
              return _context.abrupt("return", _context.t63.registerLanguage.call(_context.t63, 'crmsh', _context.t64));

            case 163:
              _context.t65 = hljs;
              _context.next = 166;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/crystal'));

            case 166:
              _context.t66 = _context.sent.default;
              return _context.abrupt("return", _context.t65.registerLanguage.call(_context.t65, 'crystal', _context.t66));

            case 168:
              _context.t67 = hljs;
              _context.next = 171;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/cs'));

            case 171:
              _context.t68 = _context.sent.default;
              return _context.abrupt("return", _context.t67.registerLanguage.call(_context.t67, 'cs', _context.t68));

            case 173:
              _context.t69 = hljs;
              _context.next = 176;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/csp'));

            case 176:
              _context.t70 = _context.sent.default;
              return _context.abrupt("return", _context.t69.registerLanguage.call(_context.t69, 'csp', _context.t70));

            case 178:
              _context.t71 = hljs;
              _context.next = 181;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/css'));

            case 181:
              _context.t72 = _context.sent.default;
              return _context.abrupt("return", _context.t71.registerLanguage.call(_context.t71, 'css', _context.t72));

            case 183:
              _context.t73 = hljs;
              _context.next = 186;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/d'));

            case 186:
              _context.t74 = _context.sent.default;
              return _context.abrupt("return", _context.t73.registerLanguage.call(_context.t73, 'd', _context.t74));

            case 188:
              _context.t75 = hljs;
              _context.next = 191;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/dart'));

            case 191:
              _context.t76 = _context.sent.default;
              return _context.abrupt("return", _context.t75.registerLanguage.call(_context.t75, 'dart', _context.t76));

            case 193:
              _context.t77 = hljs;
              _context.next = 196;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/delphi'));

            case 196:
              _context.t78 = _context.sent.default;
              return _context.abrupt("return", _context.t77.registerLanguage.call(_context.t77, 'delphi', _context.t78));

            case 198:
              _context.t79 = hljs;
              _context.next = 201;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/diff'));

            case 201:
              _context.t80 = _context.sent.default;
              return _context.abrupt("return", _context.t79.registerLanguage.call(_context.t79, 'diff', _context.t80));

            case 203:
              _context.t81 = hljs;
              _context.next = 206;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/django'));

            case 206:
              _context.t82 = _context.sent.default;
              return _context.abrupt("return", _context.t81.registerLanguage.call(_context.t81, 'django', _context.t82));

            case 208:
              _context.t83 = hljs;
              _context.next = 211;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/dns'));

            case 211:
              _context.t84 = _context.sent.default;
              return _context.abrupt("return", _context.t83.registerLanguage.call(_context.t83, 'dns', _context.t84));

            case 213:
              _context.t85 = hljs;
              _context.next = 216;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/dockerfile'));

            case 216:
              _context.t86 = _context.sent.default;
              return _context.abrupt("return", _context.t85.registerLanguage.call(_context.t85, 'dockerfile', _context.t86));

            case 218:
              _context.t87 = hljs;
              _context.next = 221;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/dos'));

            case 221:
              _context.t88 = _context.sent.default;
              return _context.abrupt("return", _context.t87.registerLanguage.call(_context.t87, 'dos', _context.t88));

            case 223:
              _context.t89 = hljs;
              _context.next = 226;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/dsconfig'));

            case 226:
              _context.t90 = _context.sent.default;
              return _context.abrupt("return", _context.t89.registerLanguage.call(_context.t89, 'dsconfig', _context.t90));

            case 228:
              _context.t91 = hljs;
              _context.next = 231;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/dts'));

            case 231:
              _context.t92 = _context.sent.default;
              return _context.abrupt("return", _context.t91.registerLanguage.call(_context.t91, 'dts', _context.t92));

            case 233:
              _context.t93 = hljs;
              _context.next = 236;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/dust'));

            case 236:
              _context.t94 = _context.sent.default;
              return _context.abrupt("return", _context.t93.registerLanguage.call(_context.t93, 'dust', _context.t94));

            case 238:
              _context.t95 = hljs;
              _context.next = 241;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/ebnf'));

            case 241:
              _context.t96 = _context.sent.default;
              return _context.abrupt("return", _context.t95.registerLanguage.call(_context.t95, 'ebnf', _context.t96));

            case 243:
              _context.t97 = hljs;
              _context.next = 246;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/elixir'));

            case 246:
              _context.t98 = _context.sent.default;
              return _context.abrupt("return", _context.t97.registerLanguage.call(_context.t97, 'elixir', _context.t98));

            case 248:
              _context.t99 = hljs;
              _context.next = 251;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/elm'));

            case 251:
              _context.t100 = _context.sent.default;
              return _context.abrupt("return", _context.t99.registerLanguage.call(_context.t99, 'elm', _context.t100));

            case 253:
              _context.t101 = hljs;
              _context.next = 256;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/erb'));

            case 256:
              _context.t102 = _context.sent.default;
              return _context.abrupt("return", _context.t101.registerLanguage.call(_context.t101, 'erb', _context.t102));

            case 258:
              _context.t103 = hljs;
              _context.next = 261;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/erlang'));

            case 261:
              _context.t104 = _context.sent.default;
              return _context.abrupt("return", _context.t103.registerLanguage.call(_context.t103, 'erlang', _context.t104));

            case 263:
              _context.t105 = hljs;
              _context.next = 266;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/excel'));

            case 266:
              _context.t106 = _context.sent.default;
              return _context.abrupt("return", _context.t105.registerLanguage.call(_context.t105, 'excel', _context.t106));

            case 268:
              _context.t107 = hljs;
              _context.next = 271;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/fix'));

            case 271:
              _context.t108 = _context.sent.default;
              return _context.abrupt("return", _context.t107.registerLanguage.call(_context.t107, 'fix', _context.t108));

            case 273:
              _context.t109 = hljs;
              _context.next = 276;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/flix'));

            case 276:
              _context.t110 = _context.sent.default;
              return _context.abrupt("return", _context.t109.registerLanguage.call(_context.t109, 'flix', _context.t110));

            case 278:
              _context.t111 = hljs;
              _context.next = 281;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/fortran'));

            case 281:
              _context.t112 = _context.sent.default;
              return _context.abrupt("return", _context.t111.registerLanguage.call(_context.t111, 'fortran', _context.t112));

            case 283:
              _context.t113 = hljs;
              _context.next = 286;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/fsharp'));

            case 286:
              _context.t114 = _context.sent.default;
              return _context.abrupt("return", _context.t113.registerLanguage.call(_context.t113, 'fsharp', _context.t114));

            case 288:
              _context.t115 = hljs;
              _context.next = 291;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/gams'));

            case 291:
              _context.t116 = _context.sent.default;
              return _context.abrupt("return", _context.t115.registerLanguage.call(_context.t115, 'gams', _context.t116));

            case 293:
              _context.t117 = hljs;
              _context.next = 296;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/gauss'));

            case 296:
              _context.t118 = _context.sent.default;
              return _context.abrupt("return", _context.t117.registerLanguage.call(_context.t117, 'gauss', _context.t118));

            case 298:
              _context.t119 = hljs;
              _context.next = 301;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/gcode'));

            case 301:
              _context.t120 = _context.sent.default;
              return _context.abrupt("return", _context.t119.registerLanguage.call(_context.t119, 'gcode', _context.t120));

            case 303:
              _context.t121 = hljs;
              _context.next = 306;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/gherkin'));

            case 306:
              _context.t122 = _context.sent.default;
              return _context.abrupt("return", _context.t121.registerLanguage.call(_context.t121, 'gherkin', _context.t122));

            case 308:
              _context.t123 = hljs;
              _context.next = 311;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/glsl'));

            case 311:
              _context.t124 = _context.sent.default;
              return _context.abrupt("return", _context.t123.registerLanguage.call(_context.t123, 'glsl', _context.t124));

            case 313:
              _context.t125 = hljs;
              _context.next = 316;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/go'));

            case 316:
              _context.t126 = _context.sent.default;
              return _context.abrupt("return", _context.t125.registerLanguage.call(_context.t125, 'go', _context.t126));

            case 318:
              _context.t127 = hljs;
              _context.next = 321;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/golo'));

            case 321:
              _context.t128 = _context.sent.default;
              return _context.abrupt("return", _context.t127.registerLanguage.call(_context.t127, 'golo', _context.t128));

            case 323:
              _context.t129 = hljs;
              _context.next = 326;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/gradle'));

            case 326:
              _context.t130 = _context.sent.default;
              return _context.abrupt("return", _context.t129.registerLanguage.call(_context.t129, 'gradle', _context.t130));

            case 328:
              _context.t131 = hljs;
              _context.next = 331;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/groovy'));

            case 331:
              _context.t132 = _context.sent.default;
              return _context.abrupt("return", _context.t131.registerLanguage.call(_context.t131, 'groovy', _context.t132));

            case 333:
              _context.t133 = hljs;
              _context.next = 336;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/haml'));

            case 336:
              _context.t134 = _context.sent.default;
              return _context.abrupt("return", _context.t133.registerLanguage.call(_context.t133, 'haml', _context.t134));

            case 338:
              _context.t135 = hljs;
              _context.next = 341;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/handlebars'));

            case 341:
              _context.t136 = _context.sent.default;
              return _context.abrupt("return", _context.t135.registerLanguage.call(_context.t135, 'handlebars', _context.t136));

            case 343:
              _context.t137 = hljs;
              _context.next = 346;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/haskell'));

            case 346:
              _context.t138 = _context.sent.default;
              return _context.abrupt("return", _context.t137.registerLanguage.call(_context.t137, 'haskell', _context.t138));

            case 348:
              _context.t139 = hljs;
              _context.next = 351;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/haxe'));

            case 351:
              _context.t140 = _context.sent.default;
              return _context.abrupt("return", _context.t139.registerLanguage.call(_context.t139, 'haxe', _context.t140));

            case 353:
              _context.t141 = hljs;
              _context.next = 356;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/hsp'));

            case 356:
              _context.t142 = _context.sent.default;
              return _context.abrupt("return", _context.t141.registerLanguage.call(_context.t141, 'hsp', _context.t142));

            case 358:
              _context.t143 = hljs;
              _context.next = 361;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/htmlbars'));

            case 361:
              _context.t144 = _context.sent.default;
              return _context.abrupt("return", _context.t143.registerLanguage.call(_context.t143, 'htmlbars', _context.t144));

            case 363:
              _context.t145 = hljs;
              _context.next = 366;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/http'));

            case 366:
              _context.t146 = _context.sent.default;
              return _context.abrupt("return", _context.t145.registerLanguage.call(_context.t145, 'http', _context.t146));

            case 368:
              _context.t147 = hljs;
              _context.next = 371;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/hy'));

            case 371:
              _context.t148 = _context.sent.default;
              return _context.abrupt("return", _context.t147.registerLanguage.call(_context.t147, 'hy', _context.t148));

            case 373:
              _context.t149 = hljs;
              _context.next = 376;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/inform7'));

            case 376:
              _context.t150 = _context.sent.default;
              return _context.abrupt("return", _context.t149.registerLanguage.call(_context.t149, 'inform7', _context.t150));

            case 378:
              _context.t151 = hljs;
              _context.next = 381;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/ini'));

            case 381:
              _context.t152 = _context.sent.default;
              return _context.abrupt("return", _context.t151.registerLanguage.call(_context.t151, 'ini', _context.t152));

            case 383:
              _context.t153 = hljs;
              _context.next = 386;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/irpf90'));

            case 386:
              _context.t154 = _context.sent.default;
              return _context.abrupt("return", _context.t153.registerLanguage.call(_context.t153, 'irpf90', _context.t154));

            case 388:
              _context.t155 = hljs;
              _context.next = 391;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/java'));

            case 391:
              _context.t156 = _context.sent.default;
              return _context.abrupt("return", _context.t155.registerLanguage.call(_context.t155, 'java', _context.t156));

            case 393:
              _context.t157 = hljs;
              _context.next = 396;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/javascript'));

            case 396:
              _context.t158 = _context.sent.default;
              return _context.abrupt("return", _context.t157.registerLanguage.call(_context.t157, 'javascript', _context.t158));

            case 398:
              _context.t159 = hljs;
              _context.next = 401;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/jboss-cli'));

            case 401:
              _context.t160 = _context.sent.default;
              return _context.abrupt("return", _context.t159.registerLanguage.call(_context.t159, 'jboss-cli', _context.t160));

            case 403:
              _context.t161 = hljs;
              _context.next = 406;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/json'));

            case 406:
              _context.t162 = _context.sent.default;
              return _context.abrupt("return", _context.t161.registerLanguage.call(_context.t161, 'json', _context.t162));

            case 408:
              _context.t163 = hljs;
              _context.next = 411;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/julia'));

            case 411:
              _context.t164 = _context.sent.default;
              return _context.abrupt("return", _context.t163.registerLanguage.call(_context.t163, 'julia', _context.t164));

            case 413:
              _context.t165 = hljs;
              _context.next = 416;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/julia-repl'));

            case 416:
              _context.t166 = _context.sent.default;
              return _context.abrupt("return", _context.t165.registerLanguage.call(_context.t165, 'julia-repl', _context.t166));

            case 418:
              _context.t167 = hljs;
              _context.next = 421;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/kotlin'));

            case 421:
              _context.t168 = _context.sent.default;
              return _context.abrupt("return", _context.t167.registerLanguage.call(_context.t167, 'kotlin', _context.t168));

            case 423:
              _context.t169 = hljs;
              _context.next = 426;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/lasso'));

            case 426:
              _context.t170 = _context.sent.default;
              return _context.abrupt("return", _context.t169.registerLanguage.call(_context.t169, 'lasso', _context.t170));

            case 428:
              _context.t171 = hljs;
              _context.next = 431;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/ldif'));

            case 431:
              _context.t172 = _context.sent.default;
              return _context.abrupt("return", _context.t171.registerLanguage.call(_context.t171, 'ldif', _context.t172));

            case 433:
              _context.t173 = hljs;
              _context.next = 436;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/leaf'));

            case 436:
              _context.t174 = _context.sent.default;
              return _context.abrupt("return", _context.t173.registerLanguage.call(_context.t173, 'leaf', _context.t174));

            case 438:
              _context.t175 = hljs;
              _context.next = 441;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/less'));

            case 441:
              _context.t176 = _context.sent.default;
              return _context.abrupt("return", _context.t175.registerLanguage.call(_context.t175, 'less', _context.t176));

            case 443:
              _context.t177 = hljs;
              _context.next = 446;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/lisp'));

            case 446:
              _context.t178 = _context.sent.default;
              return _context.abrupt("return", _context.t177.registerLanguage.call(_context.t177, 'lisp', _context.t178));

            case 448:
              _context.t179 = hljs;
              _context.next = 451;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/livecodeserver'));

            case 451:
              _context.t180 = _context.sent.default;
              return _context.abrupt("return", _context.t179.registerLanguage.call(_context.t179, 'livecodeserver', _context.t180));

            case 453:
              _context.t181 = hljs;
              _context.next = 456;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/livescript'));

            case 456:
              _context.t182 = _context.sent.default;
              return _context.abrupt("return", _context.t181.registerLanguage.call(_context.t181, 'livescript', _context.t182));

            case 458:
              _context.t183 = hljs;
              _context.next = 461;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/llvm'));

            case 461:
              _context.t184 = _context.sent.default;
              return _context.abrupt("return", _context.t183.registerLanguage.call(_context.t183, 'llvm', _context.t184));

            case 463:
              _context.t185 = hljs;
              _context.next = 466;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/lsl'));

            case 466:
              _context.t186 = _context.sent.default;
              return _context.abrupt("return", _context.t185.registerLanguage.call(_context.t185, 'lsl', _context.t186));

            case 468:
              _context.t187 = hljs;
              _context.next = 471;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/lua'));

            case 471:
              _context.t188 = _context.sent.default;
              return _context.abrupt("return", _context.t187.registerLanguage.call(_context.t187, 'lua', _context.t188));

            case 473:
              _context.t189 = hljs;
              _context.next = 476;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/makefile'));

            case 476:
              _context.t190 = _context.sent.default;
              return _context.abrupt("return", _context.t189.registerLanguage.call(_context.t189, 'makefile', _context.t190));

            case 478:
              _context.t191 = hljs;
              _context.next = 481;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/markdown'));

            case 481:
              _context.t192 = _context.sent.default;
              return _context.abrupt("return", _context.t191.registerLanguage.call(_context.t191, 'markdown', _context.t192));

            case 483:
              _context.t193 = hljs;
              _context.next = 486;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/mathematica'));

            case 486:
              _context.t194 = _context.sent.default;
              return _context.abrupt("return", _context.t193.registerLanguage.call(_context.t193, 'mathematica', _context.t194));

            case 488:
              _context.t195 = hljs;
              _context.next = 491;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/matlab'));

            case 491:
              _context.t196 = _context.sent.default;
              return _context.abrupt("return", _context.t195.registerLanguage.call(_context.t195, 'matlab', _context.t196));

            case 493:
              _context.t197 = hljs;
              _context.next = 496;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/maxima'));

            case 496:
              _context.t198 = _context.sent.default;
              return _context.abrupt("return", _context.t197.registerLanguage.call(_context.t197, 'maxima', _context.t198));

            case 498:
              _context.t199 = hljs;
              _context.next = 501;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/mel'));

            case 501:
              _context.t200 = _context.sent.default;
              return _context.abrupt("return", _context.t199.registerLanguage.call(_context.t199, 'mel', _context.t200));

            case 503:
              _context.t201 = hljs;
              _context.next = 506;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/mercury'));

            case 506:
              _context.t202 = _context.sent.default;
              return _context.abrupt("return", _context.t201.registerLanguage.call(_context.t201, 'mercury', _context.t202));

            case 508:
              _context.t203 = hljs;
              _context.next = 511;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/mipsasm'));

            case 511:
              _context.t204 = _context.sent.default;
              return _context.abrupt("return", _context.t203.registerLanguage.call(_context.t203, 'mipsasm', _context.t204));

            case 513:
              _context.t205 = hljs;
              _context.next = 516;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/mizar'));

            case 516:
              _context.t206 = _context.sent.default;
              return _context.abrupt("return", _context.t205.registerLanguage.call(_context.t205, 'mizar', _context.t206));

            case 518:
              _context.t207 = hljs;
              _context.next = 521;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/perl'));

            case 521:
              _context.t208 = _context.sent.default;
              return _context.abrupt("return", _context.t207.registerLanguage.call(_context.t207, 'perl', _context.t208));

            case 523:
              _context.t209 = hljs;
              _context.next = 526;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/mojolicious'));

            case 526:
              _context.t210 = _context.sent.default;
              return _context.abrupt("return", _context.t209.registerLanguage.call(_context.t209, 'mojolicious', _context.t210));

            case 528:
              _context.t211 = hljs;
              _context.next = 531;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/monkey'));

            case 531:
              _context.t212 = _context.sent.default;
              return _context.abrupt("return", _context.t211.registerLanguage.call(_context.t211, 'monkey', _context.t212));

            case 533:
              _context.t213 = hljs;
              _context.next = 536;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/moonscript'));

            case 536:
              _context.t214 = _context.sent.default;
              return _context.abrupt("return", _context.t213.registerLanguage.call(_context.t213, 'moonscript', _context.t214));

            case 538:
              _context.t215 = hljs;
              _context.next = 541;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/n1ql'));

            case 541:
              _context.t216 = _context.sent.default;
              return _context.abrupt("return", _context.t215.registerLanguage.call(_context.t215, 'n1ql', _context.t216));

            case 543:
              _context.t217 = hljs;
              _context.next = 546;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/nginx'));

            case 546:
              _context.t218 = _context.sent.default;
              return _context.abrupt("return", _context.t217.registerLanguage.call(_context.t217, 'nginx', _context.t218));

            case 548:
              _context.t219 = hljs;
              _context.next = 551;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/nimrod'));

            case 551:
              _context.t220 = _context.sent.default;
              return _context.abrupt("return", _context.t219.registerLanguage.call(_context.t219, 'nimrod', _context.t220));

            case 553:
              _context.t221 = hljs;
              _context.next = 556;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/nix'));

            case 556:
              _context.t222 = _context.sent.default;
              return _context.abrupt("return", _context.t221.registerLanguage.call(_context.t221, 'nix', _context.t222));

            case 558:
              _context.t223 = hljs;
              _context.next = 561;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/nsis'));

            case 561:
              _context.t224 = _context.sent.default;
              return _context.abrupt("return", _context.t223.registerLanguage.call(_context.t223, 'nsis', _context.t224));

            case 563:
              _context.t225 = hljs;
              _context.next = 566;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/objectivec'));

            case 566:
              _context.t226 = _context.sent.default;
              return _context.abrupt("return", _context.t225.registerLanguage.call(_context.t225, 'objectivec', _context.t226));

            case 568:
              _context.t227 = hljs;
              _context.next = 571;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/ocaml'));

            case 571:
              _context.t228 = _context.sent.default;
              return _context.abrupt("return", _context.t227.registerLanguage.call(_context.t227, 'ocaml', _context.t228));

            case 573:
              _context.t229 = hljs;
              _context.next = 576;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/openscad'));

            case 576:
              _context.t230 = _context.sent.default;
              return _context.abrupt("return", _context.t229.registerLanguage.call(_context.t229, 'openscad', _context.t230));

            case 578:
              _context.t231 = hljs;
              _context.next = 581;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/oxygene'));

            case 581:
              _context.t232 = _context.sent.default;
              return _context.abrupt("return", _context.t231.registerLanguage.call(_context.t231, 'oxygene', _context.t232));

            case 583:
              _context.t233 = hljs;
              _context.next = 586;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/parser3'));

            case 586:
              _context.t234 = _context.sent.default;
              return _context.abrupt("return", _context.t233.registerLanguage.call(_context.t233, 'parser3', _context.t234));

            case 588:
              _context.t235 = hljs;
              _context.next = 591;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/pf'));

            case 591:
              _context.t236 = _context.sent.default;
              return _context.abrupt("return", _context.t235.registerLanguage.call(_context.t235, 'pf', _context.t236));

            case 593:
              _context.t237 = hljs;
              _context.next = 596;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/php'));

            case 596:
              _context.t238 = _context.sent.default;
              return _context.abrupt("return", _context.t237.registerLanguage.call(_context.t237, 'php', _context.t238));

            case 598:
              _context.t239 = hljs;
              _context.next = 601;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/pony'));

            case 601:
              _context.t240 = _context.sent.default;
              return _context.abrupt("return", _context.t239.registerLanguage.call(_context.t239, 'pony', _context.t240));

            case 603:
              _context.t241 = hljs;
              _context.next = 606;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/powershell'));

            case 606:
              _context.t242 = _context.sent.default;
              return _context.abrupt("return", _context.t241.registerLanguage.call(_context.t241, 'powershell', _context.t242));

            case 608:
              _context.t243 = hljs;
              _context.next = 611;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/processing'));

            case 611:
              _context.t244 = _context.sent.default;
              return _context.abrupt("return", _context.t243.registerLanguage.call(_context.t243, 'processing', _context.t244));

            case 613:
              _context.t245 = hljs;
              _context.next = 616;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/profile'));

            case 616:
              _context.t246 = _context.sent.default;
              return _context.abrupt("return", _context.t245.registerLanguage.call(_context.t245, 'profile', _context.t246));

            case 618:
              _context.t247 = hljs;
              _context.next = 621;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/prolog'));

            case 621:
              _context.t248 = _context.sent.default;
              return _context.abrupt("return", _context.t247.registerLanguage.call(_context.t247, 'prolog', _context.t248));

            case 623:
              _context.t249 = hljs;
              _context.next = 626;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/protobuf'));

            case 626:
              _context.t250 = _context.sent.default;
              return _context.abrupt("return", _context.t249.registerLanguage.call(_context.t249, 'protobuf', _context.t250));

            case 628:
              _context.t251 = hljs;
              _context.next = 631;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/puppet'));

            case 631:
              _context.t252 = _context.sent.default;
              return _context.abrupt("return", _context.t251.registerLanguage.call(_context.t251, 'puppet', _context.t252));

            case 633:
              _context.t253 = hljs;
              _context.next = 636;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/purebasic'));

            case 636:
              _context.t254 = _context.sent.default;
              return _context.abrupt("return", _context.t253.registerLanguage.call(_context.t253, 'purebasic', _context.t254));

            case 638:
              _context.t255 = hljs;
              _context.next = 641;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/python'));

            case 641:
              _context.t256 = _context.sent.default;
              return _context.abrupt("return", _context.t255.registerLanguage.call(_context.t255, 'python', _context.t256));

            case 643:
              _context.t257 = hljs;
              _context.next = 646;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/q'));

            case 646:
              _context.t258 = _context.sent.default;
              return _context.abrupt("return", _context.t257.registerLanguage.call(_context.t257, 'q', _context.t258));

            case 648:
              _context.t259 = hljs;
              _context.next = 651;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/qml'));

            case 651:
              _context.t260 = _context.sent.default;
              return _context.abrupt("return", _context.t259.registerLanguage.call(_context.t259, 'qml', _context.t260));

            case 653:
              _context.t261 = hljs;
              _context.next = 656;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/r'));

            case 656:
              _context.t262 = _context.sent.default;
              return _context.abrupt("return", _context.t261.registerLanguage.call(_context.t261, 'r', _context.t262));

            case 658:
              _context.t263 = hljs;
              _context.next = 661;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/rib'));

            case 661:
              _context.t264 = _context.sent.default;
              return _context.abrupt("return", _context.t263.registerLanguage.call(_context.t263, 'rib', _context.t264));

            case 663:
              _context.t265 = hljs;
              _context.next = 666;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/roboconf'));

            case 666:
              _context.t266 = _context.sent.default;
              return _context.abrupt("return", _context.t265.registerLanguage.call(_context.t265, 'roboconf', _context.t266));

            case 668:
              _context.t267 = hljs;
              _context.next = 671;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/rsl'));

            case 671:
              _context.t268 = _context.sent.default;
              return _context.abrupt("return", _context.t267.registerLanguage.call(_context.t267, 'rsl', _context.t268));

            case 673:
              _context.t269 = hljs;
              _context.next = 676;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/ruleslanguage'));

            case 676:
              _context.t270 = _context.sent.default;
              return _context.abrupt("return", _context.t269.registerLanguage.call(_context.t269, 'ruleslanguage', _context.t270));

            case 678:
              _context.t271 = hljs;
              _context.next = 681;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/rust'));

            case 681:
              _context.t272 = _context.sent.default;
              return _context.abrupt("return", _context.t271.registerLanguage.call(_context.t271, 'rust', _context.t272));

            case 683:
              _context.t273 = hljs;
              _context.next = 686;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/scala'));

            case 686:
              _context.t274 = _context.sent.default;
              return _context.abrupt("return", _context.t273.registerLanguage.call(_context.t273, 'scala', _context.t274));

            case 688:
              _context.t275 = hljs;
              _context.next = 691;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/scheme'));

            case 691:
              _context.t276 = _context.sent.default;
              return _context.abrupt("return", _context.t275.registerLanguage.call(_context.t275, 'scheme', _context.t276));

            case 693:
              _context.t277 = hljs;
              _context.next = 696;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/scilab'));

            case 696:
              _context.t278 = _context.sent.default;
              return _context.abrupt("return", _context.t277.registerLanguage.call(_context.t277, 'scilab', _context.t278));

            case 698:
              _context.t279 = hljs;
              _context.next = 701;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/scss'));

            case 701:
              _context.t280 = _context.sent.default;
              return _context.abrupt("return", _context.t279.registerLanguage.call(_context.t279, 'scss', _context.t280));

            case 703:
              _context.t281 = hljs;
              _context.next = 706;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/shell'));

            case 706:
              _context.t282 = _context.sent.default;
              return _context.abrupt("return", _context.t281.registerLanguage.call(_context.t281, 'shell', _context.t282));

            case 708:
              _context.t283 = hljs;
              _context.next = 711;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/smali'));

            case 711:
              _context.t284 = _context.sent.default;
              return _context.abrupt("return", _context.t283.registerLanguage.call(_context.t283, 'smali', _context.t284));

            case 713:
              _context.t285 = hljs;
              _context.next = 716;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/smalltalk'));

            case 716:
              _context.t286 = _context.sent.default;
              return _context.abrupt("return", _context.t285.registerLanguage.call(_context.t285, 'smalltalk', _context.t286));

            case 718:
              _context.t287 = hljs;
              _context.next = 721;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/sml'));

            case 721:
              _context.t288 = _context.sent.default;
              return _context.abrupt("return", _context.t287.registerLanguage.call(_context.t287, 'sml', _context.t288));

            case 723:
              _context.t289 = hljs;
              _context.next = 726;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/sqf'));

            case 726:
              _context.t290 = _context.sent.default;
              return _context.abrupt("return", _context.t289.registerLanguage.call(_context.t289, 'sqf', _context.t290));

            case 728:
              _context.t291 = hljs;
              _context.next = 731;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/sql'));

            case 731:
              _context.t292 = _context.sent.default;
              return _context.abrupt("return", _context.t291.registerLanguage.call(_context.t291, 'sql', _context.t292));

            case 733:
              _context.t293 = hljs;
              _context.next = 736;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/stan'));

            case 736:
              _context.t294 = _context.sent.default;
              return _context.abrupt("return", _context.t293.registerLanguage.call(_context.t293, 'stan', _context.t294));

            case 738:
              _context.t295 = hljs;
              _context.next = 741;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/stata'));

            case 741:
              _context.t296 = _context.sent.default;
              return _context.abrupt("return", _context.t295.registerLanguage.call(_context.t295, 'stata', _context.t296));

            case 743:
              _context.t297 = hljs;
              _context.next = 746;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/step21'));

            case 746:
              _context.t298 = _context.sent.default;
              return _context.abrupt("return", _context.t297.registerLanguage.call(_context.t297, 'step21', _context.t298));

            case 748:
              _context.t299 = hljs;
              _context.next = 751;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/stylus'));

            case 751:
              _context.t300 = _context.sent.default;
              return _context.abrupt("return", _context.t299.registerLanguage.call(_context.t299, 'stylus', _context.t300));

            case 753:
              _context.t301 = hljs;
              _context.next = 756;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/subunit'));

            case 756:
              _context.t302 = _context.sent.default;
              return _context.abrupt("return", _context.t301.registerLanguage.call(_context.t301, 'subunit', _context.t302));

            case 758:
              _context.t303 = hljs;
              _context.next = 761;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/swift'));

            case 761:
              _context.t304 = _context.sent.default;
              return _context.abrupt("return", _context.t303.registerLanguage.call(_context.t303, 'swift', _context.t304));

            case 763:
              _context.t305 = hljs;
              _context.next = 766;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/taggerscript'));

            case 766:
              _context.t306 = _context.sent.default;
              return _context.abrupt("return", _context.t305.registerLanguage.call(_context.t305, 'taggerscript', _context.t306));

            case 768:
              _context.t307 = hljs;
              _context.next = 771;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/yaml'));

            case 771:
              _context.t308 = _context.sent.default;
              return _context.abrupt("return", _context.t307.registerLanguage.call(_context.t307, 'yaml', _context.t308));

            case 773:
              _context.t309 = hljs;
              _context.next = 776;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/tap'));

            case 776:
              _context.t310 = _context.sent.default;
              return _context.abrupt("return", _context.t309.registerLanguage.call(_context.t309, 'tap', _context.t310));

            case 778:
              _context.t311 = hljs;
              _context.next = 781;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/tcl'));

            case 781:
              _context.t312 = _context.sent.default;
              return _context.abrupt("return", _context.t311.registerLanguage.call(_context.t311, 'tcl', _context.t312));

            case 783:
              _context.t313 = hljs;
              _context.next = 786;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/tex'));

            case 786:
              _context.t314 = _context.sent.default;
              return _context.abrupt("return", _context.t313.registerLanguage.call(_context.t313, 'tex', _context.t314));

            case 788:
              _context.t315 = hljs;
              _context.next = 791;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/thrift'));

            case 791:
              _context.t316 = _context.sent.default;
              return _context.abrupt("return", _context.t315.registerLanguage.call(_context.t315, 'thrift', _context.t316));

            case 793:
              _context.t317 = hljs;
              _context.next = 796;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/tp'));

            case 796:
              _context.t318 = _context.sent.default;
              return _context.abrupt("return", _context.t317.registerLanguage.call(_context.t317, 'tp', _context.t318));

            case 798:
              _context.t319 = hljs;
              _context.next = 801;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/twig'));

            case 801:
              _context.t320 = _context.sent.default;
              return _context.abrupt("return", _context.t319.registerLanguage.call(_context.t319, 'twig', _context.t320));

            case 803:
              _context.t321 = hljs;
              _context.next = 806;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/typescript'));

            case 806:
              _context.t322 = _context.sent.default;
              return _context.abrupt("return", _context.t321.registerLanguage.call(_context.t321, 'typescript', _context.t322));

            case 808:
              _context.t323 = hljs;
              _context.next = 811;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/vala'));

            case 811:
              _context.t324 = _context.sent.default;
              return _context.abrupt("return", _context.t323.registerLanguage.call(_context.t323, 'vala', _context.t324));

            case 813:
              _context.t325 = hljs;
              _context.next = 816;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/vbnet'));

            case 816:
              _context.t326 = _context.sent.default;
              return _context.abrupt("return", _context.t325.registerLanguage.call(_context.t325, 'vbnet', _context.t326));

            case 818:
              _context.t327 = hljs;
              _context.next = 821;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/vbscript'));

            case 821:
              _context.t328 = _context.sent.default;
              return _context.abrupt("return", _context.t327.registerLanguage.call(_context.t327, 'vbscript', _context.t328));

            case 823:
              _context.t329 = hljs;
              _context.next = 826;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/vbscript-html'));

            case 826:
              _context.t330 = _context.sent.default;
              return _context.abrupt("return", _context.t329.registerLanguage.call(_context.t329, 'vbscript-html(', _context.t330));

            case 828:
              _context.t331 = hljs;
              _context.next = 831;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/verilog'));

            case 831:
              _context.t332 = _context.sent.default;
              return _context.abrupt("return", _context.t331.registerLanguage.call(_context.t331, 'verilog', _context.t332));

            case 833:
              _context.t333 = hljs;
              _context.next = 836;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/vhdl'));

            case 836:
              _context.t334 = _context.sent.default;
              return _context.abrupt("return", _context.t333.registerLanguage.call(_context.t333, 'vhdl', _context.t334));

            case 838:
              _context.t335 = hljs;
              _context.next = 841;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/vim'));

            case 841:
              _context.t336 = _context.sent.default;
              return _context.abrupt("return", _context.t335.registerLanguage.call(_context.t335, 'vim', _context.t336));

            case 843:
              _context.t337 = hljs;
              _context.next = 846;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/x86asm'));

            case 846:
              _context.t338 = _context.sent.default;
              return _context.abrupt("return", _context.t337.registerLanguage.call(_context.t337, 'x86asm', _context.t338));

            case 848:
              _context.t339 = hljs;
              _context.next = 851;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/xl'));

            case 851:
              _context.t340 = _context.sent.default;
              return _context.abrupt("return", _context.t339.registerLanguage.call(_context.t339, 'xl', _context.t340));

            case 853:
              _context.t341 = hljs;
              _context.next = 856;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/xquery'));

            case 856:
              _context.t342 = _context.sent.default;
              return _context.abrupt("return", _context.t341.registerLanguage.call(_context.t341, 'xquery', _context.t342));

            case 858:
              _context.t343 = hljs;
              _context.next = 861;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/zephir'));

            case 861:
              _context.t344 = _context.sent.default;
              return _context.abrupt("return", _context.t343.registerLanguage.call(_context.t343, 'zephir', _context.t344));

            case 863:
              _context.t345 = hljs;
              _context.next = 866;
              return _regeneratorRuntime.awrap(module.dynamicImport('highlight.js/lib/languages/plaintext'));

            case 866:
              _context.t346 = _context.sent.default;
              return _context.abrupt("return", _context.t345.registerLanguage.call(_context.t345, 'plaintext', _context.t346));

            case 868:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}();

module.exportDefault(hljs);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"markdown.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/lib/markdown.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["parser"];

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 0);

var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 1);
module.export({
  Markdown: function () {
    return Markdown;
  },
  filterMarkdown: function () {
    return filterMarkdown;
  },
  createMarkdownMessageRenderer: function () {
    return createMarkdownMessageRenderer;
  },
  createMarkdownNotificationRenderer: function () {
    return createMarkdownNotificationRenderer;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 1);
var marked;
module.link("./parser/marked/marked", {
  marked: function (v) {
    marked = v;
  }
}, 2);
var original;
module.link("./parser/original/original", {
  original: function (v) {
    original = v;
  }
}, 3);
var filtered;
module.link("./parser/filtered/filtered", {
  filtered: function (v) {
    filtered = v;
  }
}, 4);

var _code;

module.link("./parser/original/code", {
  code: function (v) {
    _code = v;
  }
}, 5);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 6);
var parsers = {
  original: original,
  marked: marked,
  filtered: filtered
};

var MarkdownClass = /*#__PURE__*/function () {
  function MarkdownClass() {}

  var _proto = MarkdownClass.prototype;

  _proto.parse = function () {
    function parse(text) {
      var message = {
        html: escapeHTML(text)
      };
      return this.mountTokensBack(this.parseMessageNotEscaped(message)).html;
    }

    return parse;
  }();

  _proto.parseNotEscaped = function () {
    function parseNotEscaped(text) {
      var message = {
        html: text
      };
      return this.mountTokensBack(this.parseMessageNotEscaped(message)).html;
    }

    return parseNotEscaped;
  }();

  _proto.parseMessageNotEscaped = function () {
    function parseMessageNotEscaped(message) {
      var parser = settings.get('Markdown_Parser');

      if (parser === 'disabled') {
        return message;
      }

      var options = {
        supportSchemesForLink: settings.get('Markdown_SupportSchemesForLink'),
        headers: settings.get('Markdown_Headers'),
        rootUrl: Meteor.absoluteUrl(),
        marked: {
          gfm: settings.get('Markdown_Marked_GFM'),
          tables: settings.get('Markdown_Marked_Tables'),
          breaks: settings.get('Markdown_Marked_Breaks'),
          pedantic: settings.get('Markdown_Marked_Pedantic'),
          smartLists: settings.get('Markdown_Marked_SmartLists'),
          smartypants: settings.get('Markdown_Marked_Smartypants')
        }
      };
      var parse = typeof parsers[parser] === 'function' ? parsers[parser] : parsers.original;
      return parse(message, options);
    }

    return parseMessageNotEscaped;
  }();

  _proto.mountTokensBackRecursively = function () {
    function mountTokensBackRecursively(message, tokenList) {
      var useHtml = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
      var missingTokens = [];

      if (tokenList.length > 0) {
        var _loop = function (token, text, noHtml) {
          if (message.html.indexOf(token) >= 0) {
            message.html = message.html.replace(token, function () {
              return useHtml ? text : noHtml;
            }); // Uses lambda so doesn't need to escape $
          } else {
            missingTokens.push({
              token: token,
              text: text,
              noHtml: noHtml
            });
          }
        };

        for (var _iterator = _createForOfIteratorHelperLoose(tokenList), _step; !(_step = _iterator()).done;) {
          var _ref = _step.value;
          var token = _ref.token;
          var text = _ref.text;
          var noHtml = _ref.noHtml;

          _loop(token, text, noHtml);
        }
      } // If there are tokens that were missing from the string, but the last iteration replaced at least one token, then go again
      // this is done because one of the tokens may have been hidden by another one


      if (missingTokens.length > 0 && missingTokens.length < tokenList.length) {
        this.mountTokensBackRecursively(message, missingTokens, useHtml);
      }
    }

    return mountTokensBackRecursively;
  }();

  _proto.mountTokensBack = function () {
    function mountTokensBack(message) {
      var useHtml = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      if (message.tokens) {
        this.mountTokensBackRecursively(message, message.tokens, useHtml);
      }

      return message;
    }

    return mountTokensBack;
  }();

  _proto.code = function () {
    function code() {
      return _code.apply(void 0, arguments);
    }

    return code;
  }();

  _proto.filterMarkdownFromMessage = function () {
    function filterMarkdownFromMessage(message) {
      return parsers.filtered(message, {
        supportSchemesForLink: settings.get('Markdown_SupportSchemesForLink')
      });
    }

    return filterMarkdownFromMessage;
  }();

  return MarkdownClass;
}();

var Markdown = new MarkdownClass();

var filterMarkdown = function (message) {
  return Markdown.filterMarkdownFromMessage(message);
};

var createMarkdownMessageRenderer = function (_ref2) {
  var parser = _ref2.parser,
      options = _objectWithoutProperties(_ref2, _excluded);

  if (!parser || parser === 'disabled') {
    return function (message) {
      return message;
    };
  }

  var parse = typeof parsers[parser] === 'function' ? parsers[parser] : parsers.original;
  return function (message) {
    var _message$html;

    if (!(message !== null && message !== void 0 && (_message$html = message.html) !== null && _message$html !== void 0 && _message$html.trim())) {
      return message;
    }

    return parse(message, options);
  };
};

var createMarkdownNotificationRenderer = function (options) {
  return function (message) {
    return parsers.filtered(message, options);
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"getGlobalWindow.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/client/getGlobalWindow.ts                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getGlobalWindow: function () {
    return getGlobalWindow;
  }
});

var getGlobalWindow = function () {
  return window;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/markdown/client/index.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/markdown", {
  Markdown: "Markdown"
}, 0);
module.link("../lib/markdown", {
  createMarkdownMessageRenderer: "createMarkdownMessageRenderer",
  createMarkdownNotificationRenderer: "createMarkdownNotificationRenderer"
}, 1);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"action-links":{"client":{"lib":{"actionLinks.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/action-links/client/lib/actionLinks.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  actionLinks: function () {
    return actionLinks;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var handleError;
module.link("../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 1);
var Messages, Subscriptions;
module.link("../../../models/client", {
  Messages: function (v) {
    Messages = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 2);
var actionLinks = {
  actions: {},
  register: function (name, funct) {
    actionLinks.actions[name] = funct;
  },
  getMessage: function (name, messageId) {
    var userId = Meteor.userId();

    if (!userId) {
      throw new Meteor.Error('error-invalid-user', 'Invalid user', {
        "function": 'actionLinks.getMessage'
      });
    }

    var message = Messages.findOne({
      _id: messageId
    });

    if (!message) {
      throw new Meteor.Error('error-invalid-message', 'Invalid message', {
        "function": 'actionLinks.getMessage'
      });
    }

    var subscription = Subscriptions.findOne({
      'rid': message.rid,
      'u._id': userId
    });

    if (!subscription) {
      throw new Meteor.Error('error-not-allowed', 'Not allowed', {
        "function": 'actionLinks.getMessage'
      });
    }

    if (!message.actionLinks || !message.actionLinks[name]) {
      throw new Meteor.Error('error-invalid-actionlink', 'Invalid action link', {
        "function": 'actionLinks.getMessage'
      });
    }

    return message;
  },
  run: function (name, messageId, instance) {
    var message = actionLinks.getMessage(name, messageId);
    var actionLink = message.actionLinks[name];
    var ranClient = false;

    if (actionLinks && actionLinks.actions && actionLinks.actions[actionLink.method_id]) {
      // run just on client side
      actionLinks.actions[actionLink.method_id](message, actionLink.params, instance);
      ranClient = true;
    } // and run on server side


    Meteor.call('actionLinkHandler', name, messageId, function (err) {
      if (err && !ranClient) {
        handleError(err);
      }
    });
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/action-links/client/index.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  actionLinks: function () {
    return actionLinks;
  }
});
var actionLinks;
module.link("./lib/actionLinks", {
  actionLinks: function (v) {
    actionLinks = v;
  }
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"autotranslate":{"client":{"lib":{"actionButton.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/autotranslate/client/lib/actionButton.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var AutoTranslate;
module.link("./autotranslate", {
  AutoTranslate: function (v) {
    AutoTranslate = v;
  }
}, 2);
var settings;
module.link("../../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 4);
var MessageAction;
module.link("../../../ui-utils", {
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 5);
var messageArgs;
module.link("../../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 6);
var Messages;
module.link("../../../models", {
  Messages: function (v) {
    Messages = v;
  }
}, 7);
Meteor.startup(function () {
  AutoTranslate.init();
  Tracker.autorun(function () {
    if (settings.get('AutoTranslate_Enabled') && hasAtLeastOnePermission(['auto-translate'])) {
      MessageAction.addButton({
        id: 'translate',
        icon: 'language',
        label: 'Translate',
        context: ['message', 'message-mobile', 'threads'],
        action: function () {
          var _Messages$update;

          var _messageArgs = messageArgs(this),
              message = _messageArgs.msg;

          var language = AutoTranslate.getLanguage(message.rid);

          if (!message.translations || !message.translations[language]) {
            // } && !_.find(message.attachments, attachment => { return attachment.translations && attachment.translations[language]; })) {
            AutoTranslate.messageIdsToWait[message._id] = true;
            Messages.update({
              _id: message._id
            }, {
              $set: {
                autoTranslateFetching: true
              }
            });
            Meteor.call('autoTranslate.translateMessage', message, language);
          }

          var action = message.autoTranslateShowInverse ? '$unset' : '$set';
          Messages.update({
            _id: message._id
          }, (_Messages$update = {}, _Messages$update[action] = {
            autoTranslateShowInverse: true
          }, _Messages$update));
        },
        condition: function (_ref) {
          var msg = _ref.msg,
              u = _ref.u;
          return msg && msg.u && msg.u._id !== u._id && msg.translations && !msg.translations.original;
        },
        order: 90
      });
      MessageAction.addButton({
        id: 'view-original',
        icon: 'language',
        label: 'View_original',
        context: ['message', 'message-mobile', 'threads'],
        action: function () {
          var _Messages$update2;

          var _messageArgs2 = messageArgs(this),
              message = _messageArgs2.msg;

          var language = AutoTranslate.getLanguage(message.rid);

          if (!message.translations || !message.translations[language]) {
            // } && !_.find(message.attachments, attachment => { return attachment.translations && attachment.translations[language]; })) {
            AutoTranslate.messageIdsToWait[message._id] = true;
            Messages.update({
              _id: message._id
            }, {
              $set: {
                autoTranslateFetching: true
              }
            });
            Meteor.call('autoTranslate.translateMessage', message, language);
          }

          var action = message.autoTranslateShowInverse ? '$unset' : '$set';
          Messages.update({
            _id: message._id
          }, (_Messages$update2 = {}, _Messages$update2[action] = {
            autoTranslateShowInverse: true
          }, _Messages$update2));
        },
        condition: function (_ref2) {
          var msg = _ref2.msg,
              u = _ref2.u;
          return msg && msg.u && msg.u._id !== u._id && msg.translations && msg.translations.original;
        },
        order: 90
      });
    } else {
      MessageAction.removeButton('toggle-language');
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"autotranslate.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/autotranslate/client/lib/autotranslate.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);

var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 2);
module.export({
  AutoTranslate: function () {
    return AutoTranslate;
  },
  createAutoTranslateMessageRenderer: function () {
    return createAutoTranslateMessageRenderer;
  },
  createAutoTranslateMessageStreamHandler: function () {
    return createAutoTranslateMessageStreamHandler;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var mem;
module.link("mem", {
  "default": function (v) {
    mem = v;
  }
}, 3);
var Subscriptions, Messages;
module.link("../../../models", {
  Subscriptions: function (v) {
    Subscriptions = v;
  },
  Messages: function (v) {
    Messages = v;
  }
}, 4);
var hasPermission;
module.link("../../../authorization", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 5);
var callWithErrorHandling;
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 6);
var userLanguage = 'en';
var username = '';
Meteor.startup(function () {
  Tracker.autorun(function () {
    var user = Meteor.user();

    if (!user) {
      return;
    }

    userLanguage = user.language || 'en';
    username = user.username;
  });
});
var AutoTranslate = {
  initialized: false,
  providersMetadata: {},
  messageIdsToWait: {},
  supportedLanguages: [],
  findSubscriptionByRid: mem(function (rid) {
    return Subscriptions.findOne({
      rid: rid
    });
  }),
  getLanguage: function (rid) {
    var subscription = {};

    if (rid) {
      subscription = this.findSubscriptionByRid(rid);
    }

    var language = subscription && subscription.autoTranslateLanguage || userLanguage || window.defaultUserLanguage();

    if (language.indexOf('-') !== -1) {
      if (!_.findWhere(this.supportedLanguages, {
        language: language
      })) {
        return language.substr(0, 2);
      }
    }

    return language;
  },
  translateAttachments: function (attachments, language) {
    for (var _iterator = _createForOfIteratorHelperLoose(attachments), _step; !(_step = _iterator()).done;) {
      var attachment = _step.value;

      if (attachment.author_name !== username) {
        if (attachment.text && attachment.translations && attachment.translations[language]) {
          attachment.text = attachment.translations[language];
        }

        if (attachment.description && attachment.translations && attachment.translations[language]) {
          attachment.description = attachment.translations[language];
        }

        if (attachment.attachments && attachment.attachments.length > 0) {
          attachment.attachments = this.translateAttachments(attachment.attachments, language);
        }
      }
    }

    return attachments;
  },
  init: function () {
    var _this = this;

    if (this.initialized) {
      return;
    }

    Tracker.autorun(function () {
      function _callee(c) {
        var uid, _await$Promise$all, _await$Promise$all2;

        return _regeneratorRuntime.async(function () {
          function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  uid = Meteor.userId();

                  if (!(!uid || !hasPermission('auto-translate'))) {
                    _context.next = 3;
                    break;
                  }

                  return _context.abrupt("return");

                case 3:
                  c.stop();
                  _context.next = 6;
                  return _regeneratorRuntime.awrap(Promise.all([callWithErrorHandling('autoTranslate.getProviderUiMetadata'), callWithErrorHandling('autoTranslate.getSupportedLanguages', 'en')]));

                case 6:
                  _await$Promise$all = _context.sent;
                  _await$Promise$all2 = _slicedToArray(_await$Promise$all, 2);
                  _this.providersMetadata = _await$Promise$all2[0];
                  _this.supportedLanguages = _await$Promise$all2[1];

                case 10:
                case "end":
                  return _context.stop();
              }
            }
          }

          return _callee$;
        }(), null, null, null, Promise);
      }

      return _callee;
    }());
    Subscriptions.find().observeChanges({
      changed: function (id, fields) {
        if (fields.hasOwnProperty('autoTranslate') || fields.hasOwnProperty('autoTranslateLanguage')) {
          mem.clear(_this.findSubscriptionByRid);
        }
      }
    });
    this.initialized = true;
  }
};

var createAutoTranslateMessageRenderer = function () {
  AutoTranslate.init();
  return function (message) {
    var subscription = AutoTranslate.findSubscriptionByRid(message.rid);
    var autoTranslateLanguage = AutoTranslate.getLanguage(message.rid);

    if (message.u && message.u._id !== Meteor.userId()) {
      if (!message.translations) {
        message.translations = {};
      }

      if (!!(subscription && subscription.autoTranslate) !== !!message.autoTranslateShowInverse) {
        message.translations.original = message.html;

        if (message.translations[autoTranslateLanguage]) {
          message.html = message.translations[autoTranslateLanguage];
        }

        if (message.attachments && message.attachments.length > 0) {
          message.attachments = AutoTranslate.translateAttachments(message.attachments, autoTranslateLanguage);
        }
      }
    } else if (message.attachments && message.attachments.length > 0) {
      message.attachments = AutoTranslate.translateAttachments(message.attachments, autoTranslateLanguage);
    }

    return message;
  };
};

var createAutoTranslateMessageStreamHandler = function () {
  AutoTranslate.init();
  return function (message) {
    if (message.u && message.u._id !== Meteor.userId()) {
      var subscription = AutoTranslate.findSubscriptionByRid(message.rid);
      var language = AutoTranslate.getLanguage(message.rid);

      if (subscription && subscription.autoTranslate === true && message.msg && (!message.translations || !message.translations[language])) {
        // || (message.attachments && !_.find(message.attachments, attachment => { return attachment.translations && attachment.translations[language]; }))
        Messages.update({
          _id: message._id
        }, {
          $set: {
            autoTranslateFetching: true
          }
        });
      } else if (AutoTranslate.messageIdsToWait[message._id] !== undefined && subscription && subscription.autoTranslate !== true) {
        Messages.update({
          _id: message._id
        }, {
          $set: {
            autoTranslateShowInverse: true
          },
          $unset: {
            autoTranslateFetching: true
          }
        });
        delete AutoTranslate.messageIdsToWait[message._id];
      } else if (message.autoTranslateFetching === true) {
        Messages.update({
          _id: message._id
        }, {
          $unset: {
            autoTranslateFetching: true
          }
        });
      }
    }
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/autotranslate/client/lib/tabBar.ts                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var lazy, useMemo;
module.link("react", {
  lazy: function (v) {
    lazy = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
var usePermission;
module.link("../../../../client/contexts/AuthorizationContext", {
  usePermission: function (v) {
    usePermission = v;
  }
}, 2);
var useSetting;
module.link("../../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 3);
addAction('autotranslate', function () {
  var hasPermission = usePermission('auto-translate');
  var autoTranslateEnabled = useSetting('AutoTranslate_Enabled');
  return useMemo(function () {
    return hasPermission && autoTranslateEnabled ? {
      groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
      id: 'autotranslate',
      title: 'Auto_Translate',
      icon: 'language',
      template: /*#__PURE__*/lazy(function () {
        return module.dynamicImport('../../../../client/views/room/contextualBar/AutoTranslate');
      }),
      order: 20,
      full: true
    } : null;
  }, [autoTranslateEnabled, hasPermission]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/autotranslate/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/actionButton");
module.link("./lib/tabBar");
module.link("./lib/autotranslate", {
  AutoTranslate: "AutoTranslate",
  createAutoTranslateMessageRenderer: "createAutoTranslateMessageRenderer",
  createAutoTranslateMessageStreamHandler: "createAutoTranslateMessageStreamHandler"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"channel-settings":{"client":{"lib":{"ChannelSettings.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/channel-settings/client/lib/ChannelSettings.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
module.export({
  ChannelSettings: function () {
    return ChannelSettings;
  }
});
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var ChannelSettings = new ( /*#__PURE__*/function () {
  function _class() {
    this.options = new ReactiveVar({});
  }
  /*
   * Adds an option in Channel Settings
   * @config (object)
   *   id: option id (required)
   *   template (string): template name to render (required)
   *   validation (function): if option should be displayed
   */


  var _proto = _class.prototype;

  _proto.addOption = function () {
    function addOption(config) {
      var _this = this;

      if (config == null || config.id == null) {
        return false;
      }

      return Tracker.nonreactive(function () {
        var opts = _this.options.get();

        opts[config.id] = config;
        return _this.options.set(opts);
      });
    }

    return addOption;
  }();

  _proto.getOptions = function () {
    function getOptions() {
      var currentData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      var group = arguments.length > 1 ? arguments[1] : undefined;

      var allOptions = _.toArray(this.options.get());

      var allowedOptions = _.compact(_.map(allOptions, function (option) {
        var ret = _objectSpread({}, option);

        if (option.validation == null || option.validation(currentData)) {
          ret.data = Object.assign({}, typeof option.data === 'function' ? option.data() : option.data, currentData);
          return ret;
        }
      })).filter(function (option) {
        return !group || !option.group || option.group.includes(group);
      });

      return _.sortBy(allowedOptions, 'order');
    }

    return getOptions;
  }();

  return _class;
}())();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/channel-settings/client/index.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./tabBar");
module.link("./lib/ChannelSettings", {
  ChannelSettings: "ChannelSettings"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/channel-settings/client/tabBar.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var lazy;
module.link("react", {
  lazy: function (v) {
    lazy = v;
  }
}, 0);
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
addAction('channel-settings', {
  groups: ['channel', 'group'],
  id: 'channel-settings',
  anonymous: true,
  full: true,
  title: 'Room_Info',
  icon: 'info-circled',
  template: /*#__PURE__*/lazy(function () {
    return module.dynamicImport('../../../client/views/room/contextualBar/Info');
  }),
  order: 1
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/channel-settings/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"custom-sounds":{"client":{"lib":{"CustomSounds.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-sounds/client/lib/CustomSounds.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 0);
module.export({
  CustomSounds: function () {
    return CustomSounds;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var CachedCollectionManager;
module.link("../../../ui-cached-collection", {
  CachedCollectionManager: function (v) {
    CachedCollectionManager = v;
  }
}, 3);

var _getURL;

module.link("../../../utils/client", {
  getURL: function (v) {
    _getURL = v;
  }
}, 4);

var getCustomSoundId = function (sound) {
  return "custom-sound-" + sound;
};

var CustomSoundsClass = /*#__PURE__*/function () {
  function CustomSoundsClass() {
    this.play = function (sound) {
      var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
          _ref$volume = _ref.volume,
          volume = _ref$volume === void 0 ? 1 : _ref$volume,
          _ref$loop = _ref.loop,
          loop = _ref$loop === void 0 ? false : _ref$loop;

      var audio = document.querySelector("#" + getCustomSoundId(sound));

      if (!audio || !audio.play) {
        return;
      }

      audio.volume = volume;
      audio.loop = loop;
      audio.play();
      return audio;
    };

    this.pause = function (sound) {
      var audio = document.querySelector("#" + getCustomSoundId(sound));

      if (!audio || !audio.pause) {
        return;
      }

      audio.pause();

      if (audio.currentTime !== 0) {
        audio.currentTime = 0;
      }
    };

    this.list = new ReactiveVar({});
    this.add({
      _id: 'chime',
      name: 'Chime',
      extension: 'mp3',
      src: _getURL('sounds/chime.mp3')
    });
    this.add({
      _id: 'door',
      name: 'Door',
      extension: 'mp3',
      src: _getURL('sounds/door.mp3')
    });
    this.add({
      _id: 'beep',
      name: 'Beep',
      extension: 'mp3',
      src: _getURL('sounds/beep.mp3')
    });
    this.add({
      _id: 'chelle',
      name: 'Chelle',
      extension: 'mp3',
      src: _getURL('sounds/chelle.mp3')
    });
    this.add({
      _id: 'ding',
      name: 'Ding',
      extension: 'mp3',
      src: _getURL('sounds/ding.mp3')
    });
    this.add({
      _id: 'droplet',
      name: 'Droplet',
      extension: 'mp3',
      src: _getURL('sounds/droplet.mp3')
    });
    this.add({
      _id: 'highbell',
      name: 'Highbell',
      extension: 'mp3',
      src: _getURL('sounds/highbell.mp3')
    });
    this.add({
      _id: 'seasons',
      name: 'Seasons',
      extension: 'mp3',
      src: _getURL('sounds/seasons.mp3')
    });
  }

  var _proto = CustomSoundsClass.prototype;

  _proto.add = function () {
    function add(sound) {
      if (!sound.src) {
        sound.src = this.getURL(sound);
      }

      var audio = $('<audio />', {
        id: getCustomSoundId(sound._id),
        preload: true
      }).append($('<source />', {
        src: sound.src
      }));
      var list = this.list.get();
      list[sound._id] = sound;
      this.list.set(list);
      $('body').append(audio);
    }

    return add;
  }();

  _proto.remove = function () {
    function remove(sound) {
      var list = this.list.get();
      delete list[sound._id];
      this.list.set(list);
      $("#" + sound._id).remove();
    }

    return remove;
  }();

  _proto.update = function () {
    function update(sound) {
      var audio = $("#" + sound._id);

      if (audio && audio[0]) {
        var list = this.list.get();

        if (!sound.src) {
          sound.src = this.getURL(sound);
        }

        list[sound._id] = sound;
        this.list.set(list);
        $('source', audio).attr('src', sound.src);
        audio[0].load();
      } else {
        this.add(sound);
      }
    }

    return update;
  }();

  _proto.getURL = function () {
    function getURL(sound) {
      return _getURL("/custom-sounds/" + sound._id + "." + sound.extension + "?_dc=" + (sound.random || 0));
    }

    return getURL;
  }();

  _proto.getList = function () {
    function getList() {
      var list = Object.values(this.list.get());
      return _.sortBy(list, 'name');
    }

    return getList;
  }();

  return CustomSoundsClass;
}();

var CustomSounds = new CustomSoundsClass();
Meteor.startup(function () {
  return CachedCollectionManager.onLogin(function () {
    Meteor.call('listCustomSounds', function (error, result) {
      for (var _iterator = _createForOfIteratorHelperLoose(result), _step; !(_step = _iterator()).done;) {
        var sound = _step.value;
        CustomSounds.add(sound);
      }
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"notifications":{"deleteCustomSound.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-sounds/client/notifications/deleteCustomSound.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var CachedCollectionManager;
module.link("../../../ui-cached-collection", {
  CachedCollectionManager: function (v) {
    CachedCollectionManager = v;
  }
}, 1);
var Notifications;
module.link("../../../notifications", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 2);
var CustomSounds;
module.link("../lib/CustomSounds", {
  CustomSounds: function (v) {
    CustomSounds = v;
  }
}, 3);
Meteor.startup(function () {
  return CachedCollectionManager.onLogin(function () {
    return Notifications.onAll('deleteCustomSound', function (data) {
      return CustomSounds.remove(data.soundData);
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"updateCustomSound.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-sounds/client/notifications/updateCustomSound.js                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var CachedCollectionManager;
module.link("../../../ui-cached-collection", {
  CachedCollectionManager: function (v) {
    CachedCollectionManager = v;
  }
}, 1);
var Notifications;
module.link("../../../notifications", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 2);
var CustomSounds;
module.link("../lib/CustomSounds", {
  CustomSounds: function (v) {
    CustomSounds = v;
  }
}, 3);
Meteor.startup(function () {
  return CachedCollectionManager.onLogin(function () {
    return Notifications.onAll('updateCustomSound', function (data) {
      return CustomSounds.update(data.soundData);
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-sounds/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./notifications/deleteCustomSound");
module.link("./notifications/updateCustomSound");
module.link("./lib/CustomSounds", {
  CustomSounds: "CustomSounds"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"emoji-custom":{"client":{"lib":{"emojiCustom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/lib/emojiCustom.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 1);
module.export({
  getEmojiUrlFromName: function () {
    return getEmojiUrlFromName;
  },
  deleteEmojiCustom: function () {
    return deleteEmojiCustom;
  },
  updateEmojiCustom: function () {
    return updateEmojiCustom;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var escapeRegExp;
module.link("@rocket.chat/string-helpers", {
  escapeRegExp: function (v) {
    escapeRegExp = v;
  }
}, 2);
var isSetNotNull;
module.link("./function-isSet", {
  isSetNotNull: function (v) {
    isSetNotNull = v;
  }
}, 3);
var RoomManager;
module.link("../../../ui-utils/client", {
  RoomManager: function (v) {
    RoomManager = v;
  }
}, 4);
var emoji, EmojiPicker;
module.link("../../../emoji/client", {
  emoji: function (v) {
    emoji = v;
  },
  EmojiPicker: function (v) {
    EmojiPicker = v;
  }
}, 5);
var CachedCollectionManager;
module.link("../../../ui-cached-collection/client", {
  CachedCollectionManager: function (v) {
    CachedCollectionManager = v;
  }
}, 6);
var APIClient;
module.link("../../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 7);

var getEmojiUrlFromName = function (name, extension) {
  Session.get;
  var key = "emoji_random_" + name;
  var random = 0;

  if (isSetNotNull(function () {
    return Session.keys[key];
  })) {
    random = Session.keys[key];
  }

  if (name == null) {
    return;
  }

  var path = __meteor_runtime_config__.ROOT_URL_PATH_PREFIX || '';
  return path + "/emoji-custom/" + encodeURIComponent(name) + "." + extension + "?_dc=" + random;
};

var deleteEmojiCustom = function (emojiData) {
  delete emoji.list[":" + emojiData.name + ":"];
  var arrayIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf(emojiData.name);

  if (arrayIndex !== -1) {
    emoji.packages.emojiCustom.emojisByCategory.rocket.splice(arrayIndex, 1);
  }

  var arrayIndexList = emoji.packages.emojiCustom.list.indexOf(":" + emojiData.name + ":");

  if (arrayIndexList !== -1) {
    emoji.packages.emojiCustom.list.splice(arrayIndexList, 1);
  }

  if (isSetNotNull(function () {
    return emojiData.aliases;
  })) {
    for (var _iterator = _createForOfIteratorHelperLoose(emojiData.aliases), _step; !(_step = _iterator()).done;) {
      var alias = _step.value;
      delete emoji.list[":" + alias + ":"];
      var aliasIndex = emoji.packages.emojiCustom.list.indexOf(":" + alias + ":");

      if (aliasIndex !== -1) {
        emoji.packages.emojiCustom.list.splice(aliasIndex, 1);
      }
    }
  }

  EmojiPicker.updateRecent('rocket');
};

var updateEmojiCustom = function (emojiData) {
  var key = "emoji_random_" + emojiData.name;
  Session.set(key, Math.round(Math.random() * 1000));
  var previousExists = isSetNotNull(function () {
    return emojiData.previousName;
  });
  var currentAliases = isSetNotNull(function () {
    return emojiData.aliases;
  });

  if (previousExists && isSetNotNull(function () {
    return emoji.list[":" + emojiData.previousName + ":"].aliases;
  })) {
    for (var _iterator2 = _createForOfIteratorHelperLoose(emoji.list[":" + emojiData.previousName + ":"].aliases), _step2; !(_step2 = _iterator2()).done;) {
      var alias = _step2.value;
      delete emoji.list[":" + alias + ":"];
      var aliasIndex = emoji.packages.emojiCustom.list.indexOf(":" + alias + ":");

      if (aliasIndex !== -1) {
        emoji.packages.emojiCustom.list.splice(aliasIndex, 1);
      }
    }
  }

  if (previousExists && emojiData.name !== emojiData.previousName) {
    var arrayIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf(emojiData.previousName);

    if (arrayIndex !== -1) {
      emoji.packages.emojiCustom.emojisByCategory.rocket.splice(arrayIndex, 1);
    }

    var arrayIndexList = emoji.packages.emojiCustom.list.indexOf(":" + emojiData.previousName + ":");

    if (arrayIndexList !== -1) {
      emoji.packages.emojiCustom.list.splice(arrayIndexList, 1);
    }

    delete emoji.list[":" + emojiData.previousName + ":"];
  }

  var categoryIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf("" + emojiData.name);

  if (categoryIndex === -1) {
    emoji.packages.emojiCustom.emojisByCategory.rocket.push("" + emojiData.name);
    emoji.packages.emojiCustom.list.push(":" + emojiData.name + ":");
  }

  emoji.list[":" + emojiData.name + ":"] = Object.assign({
    emojiPackage: 'emojiCustom'
  }, emoji.list[":" + emojiData.name + ":"], emojiData);

  if (currentAliases) {
    for (var _iterator3 = _createForOfIteratorHelperLoose(emojiData.aliases), _step3; !(_step3 = _iterator3()).done;) {
      var _alias = _step3.value;
      emoji.packages.emojiCustom.list.push(":" + _alias + ":");
      emoji.list[":" + _alias + ":"] = {};
      emoji.list[":" + _alias + ":"].emojiPackage = 'emojiCustom';
      emoji.list[":" + _alias + ":"].aliasOf = emojiData.name;
    }
  }

  var url = getEmojiUrlFromName(emojiData.name, emojiData.extension); // update in admin interface

  if (previousExists && emojiData.name !== emojiData.previousName) {
    $(document).find(".emojiAdminPreview-image[data-emoji='" + emojiData.previousName + "']").css('background-image', "url('" + url + ")'").attr('data-emoji', "" + emojiData.name);
  } else {
    $(document).find(".emojiAdminPreview-image[data-emoji='" + emojiData.name + "']").css('background-image', "url('" + url + "')");
  } // update in picker


  if (previousExists && emojiData.name !== emojiData.previousName) {
    $(document).find("li[data-emoji='" + emojiData.previousName + "'] span").css('background-image', "url('" + url + "')").attr('data-emoji', "" + emojiData.name);
    $(document).find("li[data-emoji='" + emojiData.previousName + "']").attr('data-emoji', "" + emojiData.name).attr('class', "emoji-" + emojiData.name);
  } else {
    $(document).find("li[data-emoji='" + emojiData.name + "'] span").css('background-image', "url('" + url + "')");
  } // update in picker and opened rooms


  for (key in meteorBabelHelpers.sanitizeForInObject(RoomManager.openedRooms)) {
    if (RoomManager.openedRooms.hasOwnProperty(key)) {
      var room = RoomManager.openedRooms[key];

      if (previousExists && emojiData.name !== emojiData.previousName) {
        $(room.dom).find("span[data-emoji='" + emojiData.previousName + "']").css('background-image', "url('" + url + "')").attr('data-emoji', "" + emojiData.name);
      } else {
        $(room.dom).find("span[data-emoji='" + emojiData.name + "']").css('background-image', "url('" + url + "')");
      }
    }
  }

  EmojiPicker.updateRecent('rocket');
};

var customRender = function (html) {
  var emojisMatchGroup = emoji.packages.emojiCustom.list.map(escapeRegExp).join('|');

  if (emojisMatchGroup !== emoji.packages.emojiCustom._regexpSignature) {
    emoji.packages.emojiCustom._regexpSignature = emojisMatchGroup;
    emoji.packages.emojiCustom._regexp = new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|(" + emojisMatchGroup + ")", 'gi');
  }

  html = html.replace(emoji.packages.emojiCustom._regexp, function (shortname) {
    if (typeof shortname === 'undefined' || shortname === '' || emoji.packages.emojiCustom.list.indexOf(shortname) === -1) {
      return shortname;
    }

    var emojiAlias = shortname.replace(/:/g, '');
    var dataCheck = emoji.list[shortname];

    if (dataCheck.hasOwnProperty('aliasOf')) {
      emojiAlias = dataCheck.aliasOf;
      dataCheck = emoji.list[":" + emojiAlias + ":"];
    }

    return "<span class=\"emoji\" style=\"background-image:url(" + getEmojiUrlFromName(emojiAlias, dataCheck.extension) + ");\" data-emoji=\"" + emojiAlias + "\" title=\"" + shortname + "\">" + shortname + "</span>";
  });
  return html;
};

emoji.packages.emojiCustom = {
  emojiCategories: [{
    key: 'rocket',
    i18n: 'Custom'
  }],
  categoryIndex: 1,
  toneList: {},
  list: [],
  _regexpSignature: null,
  _regexp: null,
  render: customRender,
  renderPicker: customRender
};
Meteor.startup(function () {
  return CachedCollectionManager.onLogin(function () {
    function _callee() {
      var _await$APIClient$v1$g, emojis, _iterator4, _step4, currentEmoji, _iterator5, _step5, alias;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.prev = 0;
                _context.next = 3;
                return _regeneratorRuntime.awrap(APIClient.v1.get('emoji-custom.list'));

              case 3:
                _await$APIClient$v1$g = _context.sent;
                emojis = _await$APIClient$v1$g.emojis.update;
                emoji.packages.emojiCustom.emojisByCategory = {
                  rocket: []
                };

                for (_iterator4 = _createForOfIteratorHelperLoose(emojis); !(_step4 = _iterator4()).done;) {
                  currentEmoji = _step4.value;
                  emoji.packages.emojiCustom.emojisByCategory.rocket.push(currentEmoji.name);
                  emoji.packages.emojiCustom.list.push(":" + currentEmoji.name + ":");
                  emoji.list[":" + currentEmoji.name + ":"] = currentEmoji;
                  emoji.list[":" + currentEmoji.name + ":"].emojiPackage = 'emojiCustom';

                  for (_iterator5 = _createForOfIteratorHelperLoose(currentEmoji.aliases); !(_step5 = _iterator5()).done;) {
                    alias = _step5.value;
                    emoji.packages.emojiCustom.list.push(":" + alias + ":");
                    emoji.list[":" + alias + ":"] = {
                      emojiPackage: 'emojiCustom',
                      aliasOf: currentEmoji.name
                    };
                  }
                }

                EmojiPicker.updateRecent('rocket');
                _context.next = 13;
                break;

              case 10:
                _context.prev = 10;
                _context.t0 = _context["catch"](0);
                console.error('Error getting custom emoji', _context.t0);

              case 13:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, [[0, 10]], Promise);
    }

    return _callee;
  }());
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"function-isSet.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/lib/function-isSet.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isSet: function () {
    return isSet;
  },
  isSetNotNull: function () {
    return isSetNotNull;
  }
});

var isSet = function (fn) {
  var value;

  try {
    value = fn();
  } catch (e) {
    value = undefined;
  }

  return value !== undefined;
};

var isSetNotNull = function (fn) {
  var value;

  try {
    value = fn();
  } catch (e) {
    value = null;
  }

  return value !== null && value !== undefined;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"admin":{"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/admin/startup.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var registerAdminSidebarItem;
module.link("../../../../client/views/admin", {
  registerAdminSidebarItem: function (v) {
    registerAdminSidebarItem = v;
  }
}, 0);
var hasPermission;
module.link("../../../authorization", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 1);
registerAdminSidebarItem({
  href: 'emoji-custom',
  i18nLabel: 'Custom_Emoji',
  icon: 'emoji',
  permissionGranted: function () {
    return hasPermission('manage-emoji');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"notifications":{"deleteEmojiCustom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/notifications/deleteEmojiCustom.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Notifications;
module.link("../../../notifications", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 1);
var deleteEmojiCustom;
module.link("../lib/emojiCustom", {
  deleteEmojiCustom: function (v) {
    deleteEmojiCustom = v;
  }
}, 2);
Meteor.startup(function () {
  return Notifications.onLogged('deleteEmojiCustom', function (data) {
    return deleteEmojiCustom(data.emojiData);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"updateEmojiCustom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/notifications/updateEmojiCustom.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Notifications;
module.link("../../../notifications", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 1);
var updateEmojiCustom;
module.link("../lib/emojiCustom", {
  updateEmojiCustom: function (v) {
    updateEmojiCustom = v;
  }
}, 2);
Meteor.startup(function () {
  return Notifications.onLogged('updateEmojiCustom', function (data) {
    return updateEmojiCustom(data.emojiData);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-custom/client/index.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/emojiCustom");
module.link("./notifications/deleteEmojiCustom");
module.link("./notifications/updateEmojiCustom");
module.link("./admin/startup");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"file-upload":{"client":{"lib":{"fileUploadHandler.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/file-upload/client/lib/fileUploadHandler.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  fileUploadHandler: function () {
    return fileUploadHandler;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var UploadFS;
module.link("meteor/jalik:ufs", {
  UploadFS: function (v) {
    UploadFS = v;
  }
}, 3);
var FileUploadBase;
module.link("../../lib/FileUploadBase", {
  FileUploadBase: function (v) {
    FileUploadBase = v;
  }
}, 4);
var Uploads, Avatars;
module.link("../../../models", {
  Uploads: function (v) {
    Uploads = v;
  },
  Avatars: function (v) {
    Avatars = v;
  }
}, 5);
new UploadFS.Store({
  collection: Uploads.model,
  name: 'Uploads'
});
new UploadFS.Store({
  collection: Avatars.model,
  name: 'Avatars'
});

var fileUploadHandler = function (directive, meta, file) {
  var store = UploadFS.getStore(directive);

  if (store) {
    return new FileUploadBase(store, meta, file);
  }

  console.error('Invalid file store', directive);
};

Tracker.autorun(function () {
  if (Meteor.userId()) {
    var secure = location.protocol === 'https:' ? '; secure' : '';
    document.cookie = "rc_uid=" + escape(Meteor.userId()) + "; path=/" + secure;
    document.cookie = "rc_token=" + escape(Accounts._storedLoginToken()) + "; path=/" + secure;
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/file-upload/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  fileUploadHandler: function () {
    return fileUploadHandler;
  }
});
var fileUploadHandler;
module.link("./lib/fileUploadHandler", {
  fileUploadHandler: function (v) {
    fileUploadHandler = v;
  }
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"FileUploadBase.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/file-upload/lib/FileUploadBase.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  FileUploadBase: function () {
    return FileUploadBase;
  }
});
var path;
module.link("path", {
  "default": function (v) {
    path = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 2);
var UploadFS;
module.link("meteor/jalik:ufs", {
  UploadFS: function (v) {
    UploadFS = v;
  }
}, 3);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 4);
var canAccessRoom, hasPermission;
module.link("../../authorization", {
  canAccessRoom: function (v) {
    canAccessRoom = v;
  },
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 5);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 6);

// set ufs temp dir to $TMPDIR/ufs instead of /tmp/ufs if the variable is set
if ('TMPDIR' in process.env) {
  UploadFS.config.tmpDir = path.join(process.env.TMPDIR, 'ufs');
}

UploadFS.config.defaultStorePermissions = new UploadFS.StorePermissions({
  insert: function (userId, doc) {
    if (userId) {
      return true;
    } // allow inserts from slackbridge (message_id = slack-timestamp-milli)


    if (doc && doc.message_id && doc.message_id.indexOf('slack-') === 0) {
      return true;
    } // allow inserts to the UserDataFiles store


    if (doc && doc.store && doc.store.split(':').pop() === 'UserDataFiles') {
      return true;
    }

    if (canAccessRoom(null, null, doc)) {
      return true;
    }

    return false;
  },
  update: function (userId, doc) {
    return hasPermission(Meteor.userId(), 'delete-message', doc.rid) || settings.get('Message_AllowDeleting') && userId === doc.userId;
  },
  remove: function (userId, doc) {
    return hasPermission(Meteor.userId(), 'delete-message', doc.rid) || settings.get('Message_AllowDeleting') && userId === doc.userId;
  }
});

var FileUploadBase = /*#__PURE__*/function () {
  function FileUploadBase(store, meta, file) {
    this.id = Random.id();
    this.meta = meta;
    this.file = file;
    this.store = store;
  }

  var _proto = FileUploadBase.prototype;

  _proto.getProgress = function () {
    function getProgress() {}

    return getProgress;
  }();

  _proto.getFileName = function () {
    function getFileName() {
      return this.meta.name;
    }

    return getFileName;
  }();

  _proto.start = function () {
    function start(callback) {
      var _this = this;

      this.handler = new UploadFS.Uploader({
        store: this.store,
        data: this.file,
        file: this.meta,
        onError: function (err) {
          return callback(err);
        },
        onComplete: function (fileData) {
          var file = _.pick(fileData, '_id', 'type', 'size', 'name', 'identify', 'description');

          file.url = fileData.url.replace(Meteor.absoluteUrl(), '/');
          return callback(null, file, _this.store.options.name);
        }
      });

      this.handler.onProgress = function (file, progress) {
        _this.onProgress(progress);
      };

      return this.handler.start();
    }

    return start;
  }();

  _proto.onProgress = function () {
    function onProgress() {}

    return onProgress;
  }();

  _proto.stop = function () {
    function stop() {
      return this.handler.stop();
    }

    return stop;
  }();

  return FileUploadBase;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/file-upload/index.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"notifications":{"client":{"lib":{"Notifications.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/notifications/client/lib/Notifications.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
module.link("./Presence");

var Notifications = /*#__PURE__*/function () {
  function Notifications() {
    var _this = this;

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    this.logged = Meteor.userId() !== null;
    this.loginCb = [];
    Tracker.autorun(function () {
      if (Meteor.userId() !== null && _this.logged === false) {
        _this.loginCb.forEach(function (cb) {
          return cb();
        });
      }

      _this.logged = Meteor.userId() !== null;
    });
    this.debug = false;
    this.streamAll = new Meteor.Streamer('notify-all');
    this.streamLogged = new Meteor.Streamer('notify-logged');
    this.streamRoom = new Meteor.Streamer('notify-room');
    this.streamRoomUsers = new Meteor.Streamer('notify-room-users');
    this.streamUser = new Meteor.Streamer('notify-user');

    if (this.debug === true) {
      this.onAll(function () {
        return console.log('RocketChat.Notifications: onAll', args);
      });
      this.onUser(function () {
        return console.log('RocketChat.Notifications: onAll', args);
      });
    }
  }

  var _proto = Notifications.prototype;

  _proto.onLogin = function () {
    function onLogin(cb) {
      this.loginCb.push(cb);

      if (this.logged) {
        return cb();
      }
    }

    return onLogin;
  }();

  _proto.notifyRoom = function () {
    function notifyRoom(room, eventName) {
      for (var _len2 = arguments.length, args = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {
        args[_key2 - 2] = arguments[_key2];
      }

      if (this.debug === true) {
        console.log('RocketChat.Notifications: notifyRoom', [room, eventName].concat(args));
      }

      args.unshift(room + "/" + eventName);
      return this.streamRoom.emit.apply(this.streamRoom, args);
    }

    return notifyRoom;
  }();

  _proto.notifyUser = function () {
    function notifyUser(userId, eventName) {
      for (var _len3 = arguments.length, args = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {
        args[_key3 - 2] = arguments[_key3];
      }

      if (this.debug === true) {
        console.log('RocketChat.Notifications: notifyUser', [userId, eventName].concat(args));
      }

      args.unshift(userId + "/" + eventName);
      return this.streamUser.emit.apply(this.streamUser, args);
    }

    return notifyUser;
  }();

  _proto.notifyUsersOfRoom = function () {
    function notifyUsersOfRoom(room, eventName) {
      for (var _len4 = arguments.length, args = new Array(_len4 > 2 ? _len4 - 2 : 0), _key4 = 2; _key4 < _len4; _key4++) {
        args[_key4 - 2] = arguments[_key4];
      }

      if (this.debug === true) {
        console.log('RocketChat.Notifications: notifyUsersOfRoom', [room, eventName].concat(args));
      }

      args.unshift(room + "/" + eventName);
      return this.streamRoomUsers.emit.apply(this.streamRoomUsers, args);
    }

    return notifyUsersOfRoom;
  }();

  _proto.onAll = function () {
    function onAll(eventName, callback) {
      return this.streamAll.on(eventName, callback);
    }

    return onAll;
  }();

  _proto.onLogged = function () {
    function onLogged(eventName, callback) {
      var _this2 = this;

      return this.onLogin(function () {
        return _this2.streamLogged.on(eventName, callback);
      });
    }

    return onLogged;
  }();

  _proto.onRoom = function () {
    function onRoom(room, eventName, callback) {
      if (this.debug === true) {
        this.streamRoom.on(room, function () {
          return console.log("RocketChat.Notifications: onRoom " + room, [room, eventName, callback]);
        });
      }

      return this.streamRoom.on(room + "/" + eventName, callback);
    }

    return onRoom;
  }();

  _proto.onUser = function () {
    function onUser(eventName, callback) {
      var _this3 = this;

      var visitorId,
          _args = arguments;
      return _regeneratorRuntime.async(function () {
        function onUser$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                visitorId = _args.length > 2 && _args[2] !== undefined ? _args[2] : null;
                _context.next = 3;
                return _regeneratorRuntime.awrap(this.streamUser.on((Meteor.userId() || visitorId) + "/" + eventName, callback));

              case 3:
                return _context.abrupt("return", function () {
                  return _this3.unUser(eventName, callback, visitorId);
                });

              case 4:
              case "end":
                return _context.stop();
            }
          }
        }

        return onUser$;
      }(), null, this, null, Promise);
    }

    return onUser;
  }();

  _proto.unAll = function () {
    function unAll(callback) {
      return this.streamAll.removeListener('notify', callback);
    }

    return unAll;
  }();

  _proto.unLogged = function () {
    function unLogged(callback) {
      return this.streamLogged.removeListener('notify', callback);
    }

    return unLogged;
  }();

  _proto.unRoom = function () {
    function unRoom(room, eventName, callback) {
      return this.streamRoom.removeListener(room + "/" + eventName, callback);
    }

    return unRoom;
  }();

  _proto.unUser = function () {
    function unUser(eventName, callback) {
      var visitorId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      return this.streamUser.removeListener((Meteor.userId() || visitorId) + "/" + eventName, callback);
    }

    return unUser;
  }();

  return Notifications;
}();

module.exportDefault(new Notifications());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Presence.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/notifications/client/lib/Presence.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Presence, STATUS_MAP;
module.link("../../../../client/lib/presence", {
  Presence: function (v) {
    Presence = v;
  },
  STATUS_MAP: function (v) {
    STATUS_MAP = v;
  }
}, 1);
// TODO implement API on Streamer to be able to listen to all streamed data
// this is a hacky way to listen to all streamed data from user-presense Streamer
Meteor.StreamerCentral.on('stream-user-presence', function (uid, args) {
  if (!Array.isArray(args)) {
    throw new Error('Presence event must be an array');
  }

  var _args = _slicedToArray(args, 3),
      username = _args[0],
      status = _args[1],
      statusText = _args[2];

  Presence.notify({
    _id: uid,
    username: username,
    status: STATUS_MAP[status],
    statusText: statusText
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/notifications/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Notifications: function () {
    return Notifications;
  }
});
var Notifications;
module.link("./lib/Notifications", {
  "default": function (v) {
    Notifications = v;
  }
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/notifications/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"settings":{"client":{"lib":{"settings.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/settings/client/lib/settings.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  settings: function () {
    return settings;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveDict;
module.link("meteor/reactive-dict", {
  ReactiveDict: function (v) {
    ReactiveDict = v;
  }
}, 1);
var PublicSettingsCachedCollection;
module.link("../../../../client/lib/settings/PublicSettingsCachedCollection", {
  PublicSettingsCachedCollection: function (v) {
    PublicSettingsCachedCollection = v;
  }
}, 2);
var SettingsBase;
module.link("../../lib/settings", {
  SettingsBase: function (v) {
    SettingsBase = v;
  }
}, 3);

var Settings = /*#__PURE__*/function (_SettingsBase) {
  _inheritsLoose(Settings, _SettingsBase);

  function Settings() {
    var _this;

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _SettingsBase.call.apply(_SettingsBase, [this].concat(args)) || this;
    _this.cachedCollection = PublicSettingsCachedCollection.get();
    _this.collection = PublicSettingsCachedCollection.get().collection;
    _this.dict = new ReactiveDict('settings');
    return _this;
  }

  var _proto = Settings.prototype;

  _proto.get = function () {
    function get(_id) {
      if (_id instanceof RegExp) {
        throw new Error('RegExp Settings.get(RegExp)');
      }

      if ((arguments.length <= 1 ? 0 : arguments.length - 1) > 0) {
        throw new Error('settings.get(String, callback) only works on backend');
      }

      return this.dict.get(_id);
    }

    return get;
  }();

  _proto._storeSettingValue = function () {
    function _storeSettingValue(record, initialLoad) {
      Meteor.settings[record._id] = record.value;
      this.dict.set(record._id, record.value);
      this.load(record._id, record.value, initialLoad);
    }

    return _storeSettingValue;
  }();

  _proto.init = function () {
    function init() {
      var _this2 = this;

      var initialLoad = true;
      this.collection.find().observe({
        added: function (record) {
          return _this2._storeSettingValue(record, initialLoad);
        },
        changed: function (record) {
          return _this2._storeSettingValue(record, initialLoad);
        },
        removed: function (record) {
          delete Meteor.settings[record._id];

          _this2.dict.set(record._id, null);

          _this2.load(record._id, undefined, initialLoad);
        }
      });
      initialLoad = false;
    }

    return init;
  }();

  return Settings;
}(SettingsBase);

var settings = new Settings();
settings.init();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/settings/client/index.ts                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  settings: function () {
    return settings;
  }
});
var settings;
module.link("./lib/settings", {
  settings: function (v) {
    settings = v;
  }
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"settings.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/settings/lib/settings.ts                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  SettingsBase: function () {
    return SettingsBase;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 1);

var SettingsBase = /*#__PURE__*/function () {
  function SettingsBase() {
    this.callbacks = new Map();
    this.regexCallbacks = new Map();
  }

  var _proto = SettingsBase.prototype;

  _proto.get = function () {
    function get(_id, callback) {
      if (callback != null) {
        this.onload(_id, callback);

        if (!Meteor.settings) {
          return;
        }

        if (_id === '*') {
          return Object.keys(Meteor.settings).forEach(function (key) {
            var value = Meteor.settings[key];
            callback(key, value);
          });
        }

        if (_.isRegExp(_id) && Meteor.settings) {
          return Object.keys(Meteor.settings).forEach(function (key) {
            if (!_id.test(key)) {
              return;
            }

            var value = Meteor.settings[key];
            callback(key, value);
          });
        }

        if (typeof _id === 'string') {
          var value = Meteor.settings[_id];

          if (value != null) {
            callback(_id, Meteor.settings[_id]);
          }

          return;
        }
      }

      if (!Meteor.settings) {
        return;
      }

      if (_.isRegExp(_id)) {
        return Object.keys(Meteor.settings).reduce(function (items, key) {
          var value = Meteor.settings[key];

          if (_id.test(key)) {
            items.push({
              key: key,
              value: value
            });
          }

          return items;
        }, []);
      }

      return Meteor.settings && Meteor.settings[_id];
    }

    return get;
  }();

  _proto.set = function () {
    function set(_id, value, callback) {
      Meteor.call('saveSetting', _id, value, callback);
    }

    return set;
  }();

  _proto.batchSet = function () {
    function batchSet(settings, callback) {
      Meteor.call('saveSettings', settings, callback);
    }

    return batchSet;
  }();

  _proto.load = function () {
    function load(key, value, initialLoad) {
      var _this = this;

      ['*', key].forEach(function (item) {
        var callbacks = _this.callbacks.get(item);

        if (callbacks) {
          callbacks.forEach(function (callback) {
            return callback(key, value, initialLoad);
          });
        }
      });
      this.regexCallbacks.forEach(function (cbValue) {
        if (!(cbValue !== null && cbValue !== void 0 && cbValue.regex.test(key))) {
          return;
        }

        cbValue.callbacks.forEach(function (callback) {
          return callback(key, value, initialLoad);
        });
      });
    }

    return load;
  }();

  _proto.onload = function () {
    function onload(key, callback) {
      var _this2 = this;

      // if key is '*'
      // 	for key, value in Meteor.settings
      // 		callback key, value, false
      // else if Meteor.settings?[_id]?
      // 	callback key, Meteor.settings[_id], false
      var keys = Array.isArray(key) ? key : [key];
      keys.forEach(function (k) {
        if (_.isRegExp(k)) {
          var _this2$regexCallbacks;

          if (!_this2.regexCallbacks.has(k.source)) {
            _this2.regexCallbacks.set(k.source, {
              regex: k,
              callbacks: []
            });
          }

          (_this2$regexCallbacks = _this2.regexCallbacks.get(k.source)) === null || _this2$regexCallbacks === void 0 ? void 0 : _this2$regexCallbacks.callbacks.push(callback);
        } else {
          var _this2$callbacks$get;

          if (!_this2.callbacks.has(k)) {
            _this2.callbacks.set(k, []);
          }

          (_this2$callbacks$get = _this2.callbacks.get(k)) === null || _this2$callbacks$get === void 0 ? void 0 : _this2$callbacks$get.push(callback);
        }
      });
    }

    return onload;
  }();

  return SettingsBase;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/settings/index.js                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.ts');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.ts');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ui-clean-history":{"client":{"lib":{"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-clean-history/client/lib/tabBar.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMemo, lazy;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  },
  lazy: function (v) {
    lazy = v;
  }
}, 0);
var addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
var usePermission;
module.link("../../../../client/contexts/AuthorizationContext", {
  usePermission: function (v) {
    usePermission = v;
  }
}, 2);
var template = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../../../../client/views/room/contextualBar/PruneMessages');
});
addAction('clean-history', function (_ref) {
  var room = _ref.room;
  var hasPermission = usePermission('clean-channel-history', room._id);
  return useMemo(function () {
    return hasPermission ? {
      groups: ['channel', 'group', 'team', 'direct_multiple', 'direct'],
      id: 'clean-history',
      full: true,
      title: 'Prune_Messages',
      icon: 'eraser',
      template: template,
      order: 250
    } : null;
  }, [hasPermission]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-clean-history/client/index.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./lib/tabBar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"user-status":{"client":{"lib":{"customUserStatus.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/lib/customUserStatus.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 0);
module.export({
  deleteCustomUserStatus: function () {
    return deleteCustomUserStatus;
  },
  updateCustomUserStatus: function () {
    return updateCustomUserStatus;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var userStatus;
module.link("./userStatus", {
  userStatus: function (v) {
    userStatus = v;
  }
}, 2);
userStatus.packages.customUserStatus = {
  list: []
};

var deleteCustomUserStatus = function (customUserStatusData) {
  delete userStatus.list[customUserStatusData._id];
  var arrayIndex = userStatus.packages.customUserStatus.list.indexOf(customUserStatusData._id);

  if (arrayIndex !== -1) {
    userStatus.packages.customUserStatusData.list.splice(arrayIndex, 1);
  }
};

var updateCustomUserStatus = function (customUserStatusData) {
  var newUserStatus = {
    name: customUserStatusData.name,
    id: customUserStatusData._id,
    statusType: customUserStatusData.statusType,
    localizeName: false
  };
  var arrayIndex = userStatus.packages.customUserStatus.list.indexOf(newUserStatus.id);

  if (arrayIndex === -1) {
    userStatus.packages.customUserStatus.list.push(newUserStatus);
  } else {
    userStatus.packages.customUserStatus.list[arrayIndex] = newUserStatus;
  }

  userStatus.list[newUserStatus.id] = newUserStatus;
};

Meteor.startup(function () {
  Tracker.autorun(function () {
    if (!Meteor.userId()) {
      return;
    }

    Meteor.call('listCustomUserStatus', function (error, result) {
      if (!result) {
        return;
      }

      for (var _iterator = _createForOfIteratorHelperLoose(result), _step; !(_step = _iterator()).done;) {
        var customStatus = _step.value;
        var newUserStatus = {
          name: customStatus.name,
          id: customStatus._id,
          statusType: customStatus.statusType,
          localizeName: false
        };
        userStatus.packages.customUserStatus.list.push(newUserStatus);
        userStatus.list[newUserStatus.id] = newUserStatus;
      }
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userStatus.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/lib/userStatus.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  userStatus: function () {
    return userStatus;
  }
});
var UserStatus;
module.link("../../../../definition/UserStatus", {
  UserStatus: function (v) {
    UserStatus = v;
  }
}, 0);
var userStatus = {
  packages: {
    base: {
      render: function (html) {
        return html;
      }
    }
  },
  list: {
    online: {
      name: UserStatus.ONLINE,
      localizeName: true,
      id: UserStatus.ONLINE,
      statusType: UserStatus.ONLINE
    },
    away: {
      name: UserStatus.AWAY,
      localizeName: true,
      id: UserStatus.AWAY,
      statusType: UserStatus.AWAY
    },
    busy: {
      name: UserStatus.BUSY,
      localizeName: true,
      id: UserStatus.BUSY,
      statusType: UserStatus.BUSY
    },
    offline: {
      name: UserStatus.OFFLINE,
      localizeName: true,
      id: UserStatus.OFFLINE,
      statusType: UserStatus.OFFLINE
    }
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"admin":{"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/admin/startup.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 0);
var registerAdminSidebarItem;
module.link("../../../../client/views/admin", {
  registerAdminSidebarItem: function (v) {
    registerAdminSidebarItem = v;
  }
}, 1);
registerAdminSidebarItem({
  href: 'custom-user-status',
  i18nLabel: 'Custom_User_Status',
  icon: 'user',
  permissionGranted: function () {
    return hasAtLeastOnePermission(['manage-user-status']);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"notifications":{"deleteCustomUserStatus.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/notifications/deleteCustomUserStatus.js                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var deleteCustomUserStatus;
module.link("../lib/customUserStatus", {
  deleteCustomUserStatus: function (v) {
    deleteCustomUserStatus = v;
  }
}, 1);
var Notifications;
module.link("../../../notifications", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 2);
Meteor.startup(function () {
  return Notifications.onLogged('deleteCustomUserStatus', function (data) {
    return deleteCustomUserStatus(data.userStatusData);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"updateCustomUserStatus.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/notifications/updateCustomUserStatus.js                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var updateCustomUserStatus;
module.link("../lib/customUserStatus", {
  updateCustomUserStatus: function (v) {
    updateCustomUserStatus = v;
  }
}, 1);
var Notifications;
module.link("../../../notifications", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 2);
Meteor.startup(function () {
  return Notifications.onLogged('updateCustomUserStatus', function (data) {
    return updateCustomUserStatus(data.userStatusData);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/user-status/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./admin/startup");
module.link("./notifications/deleteCustomUserStatus");
module.link("./notifications/updateCustomUserStatus");
module.link("./lib/userStatus", {
  userStatus: "userStatus",
  UserStatusProps: "UserStatusProps"
}, 0);
module.link("./lib/customUserStatus", {
  deleteCustomUserStatus: "deleteCustomUserStatus",
  updateCustomUserStatus: "updateCustomUserStatus"
}, 1);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"utils":{"client":{"lib":{"RestApiClient.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/client/lib/RestApiClient.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _typeof;

module.link("@babel/runtime/helpers/typeof", {
  default: function (v) {
    _typeof = v;
  }
}, 2);
module.export({
  APIClient: function () {
    return APIClient;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
var jQuery;
module.link("jquery", {
  "default": function (v) {
    jQuery = v;
  }
}, 2);
var process2faReturn;
module.link("../../../../client/lib/2fa/process2faReturn", {
  process2faReturn: function (v) {
    process2faReturn = v;
  }
}, 3);
var baseURI;
module.link("../../../../client/lib/baseURI", {
  baseURI: function (v) {
    baseURI = v;
  }
}, 4);
var APIClient = {
  "delete": function (endpoint, params) {
    return APIClient._jqueryCall('DELETE', endpoint, params);
  },
  get: function (endpoint, params) {
    return APIClient._jqueryCall('GET', endpoint, params);
  },
  post: function (endpoint, params, body) {
    if (!body) {
      body = params;
      params = {};
    }

    return APIClient._jqueryCall('POST', endpoint, params, body);
  },
  put: function (endpoint, params, body) {
    if (!body) {
      body = params;
      params = {};
    }

    return APIClient._jqueryCall('PUT', endpoint, params, body);
  },
  upload: function (endpoint, params, formData, xhrOptions) {
    if (!formData) {
      formData = params;
      params = {};
    }

    return APIClient._jqueryFormDataCall(endpoint, params, formData, xhrOptions);
  },
  getCredentials: function () {
    return {
      'X-User-Id': Meteor._localStorage.getItem(Accounts.USER_ID_KEY),
      'X-Auth-Token': Meteor._localStorage.getItem(Accounts.LOGIN_TOKEN_KEY)
    };
  },
  _generateQueryFromParams: function (params) {
    var query = '';

    if (params && _typeof(params) === 'object') {
      Object.keys(params).forEach(function (key) {
        query += query === '' ? '?' : '&';

        if (Array.isArray(params[key])) {
          var encodedParams = params[key].map(function (value) {
            return encodeURIComponent(value);
          });
          var joinedArray = encodedParams.join("&" + key + "[]=");
          query += key + "[]=" + joinedArray;
        } else {
          query += key + "=" + encodeURIComponent(params[key]);
        }
      });
    }

    return query;
  },
  _jqueryCall: function (method, endpoint, params, body) {
    var headers = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
    var dataType = arguments.length > 5 ? arguments[5] : undefined;

    var query = APIClient._generateQueryFromParams(params);

    return new Promise(function () {
      function _rlRestApiGet(resolve, reject) {
        jQuery.ajax({
          method: method,
          url: baseURI + "api/" + endpoint + query,
          headers: Object.assign(_objectSpread({
            'Content-Type': 'application/json'
          }, APIClient.getCredentials()), headers),
          data: JSON.stringify(body),
          dataType: dataType,
          success: function () {
            function _rlGetSuccess(result) {
              resolve(result);
            }

            return _rlGetSuccess;
          }(),
          error: function () {
            function _rlGetFailure(xhr, status, errorThrown) {
              APIClient.processTwoFactorError({
                xhr: xhr,
                params: [method, endpoint, params, body, headers],
                resolve: resolve,
                reject: reject,
                originalCallback: function () {
                  var error = new Error(errorThrown);
                  error.xhr = xhr;
                  reject(error);
                }
              });
            }

            return _rlGetFailure;
          }()
        });
      }

      return _rlRestApiGet;
    }());
  },
  _jqueryFormDataCall: function (endpoint, params, formData) {
    var _ref = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {},
        _ref$progress = _ref.progress,
        progress = _ref$progress === void 0 ? function () {} : _ref$progress,
        _ref$error = _ref.error,
        error = _ref$error === void 0 ? function () {} : _ref$error;

    var ret = {};

    var query = APIClient._generateQueryFromParams(params);

    if (!(formData instanceof FormData)) {
      throw new Error('The formData parameter MUST be an instance of the FormData class.');
    }

    ret.promise = new Promise(function () {
      function _jqueryFormDataPromise(resolve, reject) {
        ret.xhr = jQuery.ajax({
          xhr: function () {
            var xhr = new window.XMLHttpRequest();
            xhr.upload.addEventListener('progress', function (evt) {
              if (evt.lengthComputable) {
                var percentComplete = evt.loaded / evt.total;
                progress(percentComplete * 100);
              }
            }, false);
            xhr.upload.addEventListener('error', error, false);
            return xhr;
          },
          url: baseURI + "api/" + endpoint + query,
          headers: APIClient.getCredentials(),
          data: formData,
          processData: false,
          contentType: false,
          type: 'POST',
          success: function () {
            function _jqueryFormDataSuccess(result) {
              resolve(result);
            }

            return _jqueryFormDataSuccess;
          }(),
          error: function () {
            function _jqueryFormDataError(xhr, status, errorThrown) {
              var error = new Error(errorThrown);
              error.xhr = xhr;
              reject(error);
            }

            return _jqueryFormDataError;
          }()
        });
      }

      return _jqueryFormDataPromise;
    }());
    return ret;
  },
  processTwoFactorError: function (_ref2) {
    var xhr = _ref2.xhr,
        params = _ref2.params,
        originalCallback = _ref2.originalCallback,
        resolve = _ref2.resolve,
        reject = _ref2.reject;

    if (!xhr.responseJSON || !xhr.responseJSON.errorType) {
      return originalCallback();
    }

    process2faReturn({
      error: xhr.responseJSON,
      originalCallback: originalCallback,
      onCode: function (code, method) {
        var headers = params[params.length - 1];
        headers['x-2fa-code'] = code;
        headers['x-2fa-method'] = method;

        APIClient._jqueryCall.apply(APIClient, _toConsumableArray(params)).then(resolve).catch(reject);
      }
    });
  },
  v1: {
    "delete": function (endpoint, params) {
      return APIClient.delete("v1/" + endpoint, params);
    },
    get: function (endpoint, params) {
      return APIClient.get("v1/" + endpoint, params);
    },
    post: function (endpoint, params, body) {
      return APIClient.post("v1/" + endpoint, params, body);
    },
    upload: function (endpoint, params, formData) {
      return APIClient.upload("v1/" + endpoint, params, formData);
    },
    put: function (endpoint, params, body) {
      return APIClient.put("v1/" + endpoint, params, body);
    }
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/client/lib/roomTypes.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  roomTypes: function () {
    return roomTypes;
  }
});
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 1);
var RoomTypesCommon;
module.link("../../lib/RoomTypesCommon", {
  RoomTypesCommon: function (v) {
    RoomTypesCommon = v;
  }
}, 2);
var hasAtLeastOnePermission;
module.link("../../../authorization", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 3);
var ChatRoom, ChatSubscription;
module.link("../../../models", {
  ChatRoom: function (v) {
    ChatRoom = v;
  },
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 4);
var roomTypes = new ( /*#__PURE__*/function (_RoomTypesCommon) {
  _inheritsLoose(RocketChatRoomTypes, _RoomTypesCommon);

  function RocketChatRoomTypes() {
    return _RoomTypesCommon.apply(this, arguments) || this;
  }

  var _proto = RocketChatRoomTypes.prototype;

  _proto.checkCondition = function () {
    function checkCondition(roomType) {
      return roomType.condition == null || roomType.condition();
    }

    return checkCondition;
  }();

  _proto.getTypes = function () {
    function getTypes() {
      var _this = this;

      return _.sortBy(this.roomTypesOrder, 'order').map(function (type) {
        return _this.roomTypes[type.identifier];
      }).filter(function (type) {
        return !type.condition || type.condition();
      });
    }

    return getTypes;
  }();

  _proto.getIcon = function () {
    function getIcon(roomData) {
      if (!roomData || !roomData.t || !this.roomTypes[roomData.t]) {
        return;
      }

      return this.roomTypes[roomData.t].getIcon && this.roomTypes[roomData.t].getIcon(roomData) || this.roomTypes[roomData.t].icon;
    }

    return getIcon;
  }();

  _proto.getRoomName = function () {
    function getRoomName(roomType, roomData) {
      return this.roomTypes[roomType] && this.roomTypes[roomType].roomName && this.roomTypes[roomType].roomName(roomData);
    }

    return getRoomName;
  }();

  _proto.getSecondaryRoomName = function () {
    function getSecondaryRoomName(roomType, roomData) {
      return this.roomTypes[roomType] && typeof this.roomTypes[roomType].secondaryRoomName === 'function' && this.roomTypes[roomType].secondaryRoomName(roomData);
    }

    return getSecondaryRoomName;
  }();

  _proto.getIdentifiers = function () {
    function getIdentifiers(e) {
      var except = [].concat(e);

      var list = _.reject(this.roomTypesOrder, function (t) {
        return except.indexOf(t.identifier) !== -1;
      });

      return _.map(list, function (t) {
        return t.identifier;
      });
    }

    return getIdentifiers;
  }();

  _proto.getUserStatus = function () {
    function getUserStatus(roomType, rid) {
      return this.roomTypes[roomType] && typeof this.roomTypes[roomType].getUserStatus === 'function' && this.roomTypes[roomType].getUserStatus(rid);
    }

    return getUserStatus;
  }();

  _proto.getRoomType = function () {
    function getRoomType(roomId) {
      var fields = {
        t: 1
      };
      var room = ChatRoom.findOne({
        _id: roomId
      }, {
        fields: fields
      });
      return room && room.t;
    }

    return getRoomType;
  }();

  _proto.isLivechatRoom = function () {
    function isLivechatRoom(roomType) {
      return this.roomTypes[roomType] && typeof this.roomTypes[roomType].isLivechatRoom === 'function' && this.roomTypes[roomType].isLivechatRoom();
    }

    return isLivechatRoom;
  }();

  _proto.showQuickActionButtons = function () {
    function showQuickActionButtons(roomType) {
      return this.roomTypes[roomType] && typeof this.roomTypes[roomType].showQuickActionButtons === 'function' && this.roomTypes[roomType].showQuickActionButtons();
    }

    return showQuickActionButtons;
  }();

  _proto.getUserStatusText = function () {
    function getUserStatusText(roomType, rid) {
      return this.roomTypes[roomType] && typeof this.roomTypes[roomType].getUserStatusText === 'function' && this.roomTypes[roomType].getUserStatusText(rid);
    }

    return getUserStatusText;
  }();

  _proto.findRoom = function () {
    function findRoom(roomType, identifier, user) {
      return this.roomTypes[roomType] && this.roomTypes[roomType].findRoom(identifier, user);
    }

    return findRoom;
  }();

  _proto.canSendMessage = function () {
    function canSendMessage(rid) {
      return ChatSubscription.find({
        rid: rid
      }).count() > 0;
    }

    return canSendMessage;
  }();

  _proto.readOnly = function () {
    function readOnly(rid, user) {
      var fields = {
        ro: 1,
        t: 1
      };

      if (user) {
        fields.muted = 1;
        fields.unmuted = 1;
      }

      var room = ChatRoom.findOne({
        _id: rid
      }, {
        fields: fields
      });
      var roomType = room && room.t;

      if (roomType && this.roomTypes[roomType] && this.roomTypes[roomType].readOnly) {
        return this.roomTypes[roomType].readOnly(rid, user);
      }

      if (!user) {
        return room && room.ro;
      }

      if (room) {
        if (Array.isArray(room.muted) && room.muted.indexOf(user.username) !== -1) {
          return true;
        }

        if (room.ro === true) {
          if (Array.isArray(room.unmuted) && room.unmuted.indexOf(user.username) !== -1) {
            return false;
          }

          if (hasAtLeastOnePermission('post-readonly', room._id)) {
            return false;
          }

          return true;
        }
      }

      return false;
    }

    return readOnly;
  }();

  _proto.archived = function () {
    function archived(rid) {
      var room = ChatRoom.findOne({
        _id: rid
      }, {
        fields: {
          archived: 1
        }
      });
      return room && room.archived === true;
    }

    return archived;
  }();

  _proto.verifyCanSendMessage = function () {
    function verifyCanSendMessage(rid) {
      var room = ChatRoom.findOne({
        _id: rid
      }, {
        fields: {
          t: 1
        }
      });

      if (!room || !room.t) {
        return;
      }

      var roomType = room.t;

      if (this.roomTypes[roomType] && this.roomTypes[roomType].canSendMessage) {
        return this.roomTypes[roomType].canSendMessage(rid);
      }

      return this.canSendMessage(rid);
    }

    return verifyCanSendMessage;
  }();

  _proto.verifyShowJoinLink = function () {
    function verifyShowJoinLink(rid) {
      var room = ChatRoom.findOne({
        _id: rid,
        t: {
          $exists: true,
          $ne: null
        }
      }, {
        fields: {
          t: 1
        }
      });

      if (!room || !room.t) {
        return;
      }

      var roomType = room.t;

      if (this.roomTypes[roomType] && !this.roomTypes[roomType].showJoinLink) {
        return false;
      }

      return this.roomTypes[roomType].showJoinLink(rid);
    }

    return verifyShowJoinLink;
  }();

  _proto.getNotSubscribedTpl = function () {
    function getNotSubscribedTpl(rid) {
      var room = ChatRoom.findOne({
        _id: rid,
        t: {
          $exists: true,
          $ne: null
        }
      }, {
        fields: {
          t: 1
        }
      });

      if (!room || !room.t) {
        return;
      }

      var roomType = room.t;

      if (this.roomTypes[roomType] && !this.roomTypes[roomType].notSubscribedTpl) {
        return false;
      }

      return this.roomTypes[roomType].notSubscribedTpl;
    }

    return getNotSubscribedTpl;
  }();

  _proto.getReadOnlyTpl = function () {
    function getReadOnlyTpl(rid) {
      var room = ChatRoom.findOne({
        _id: rid,
        t: {
          $exists: true,
          $ne: null
        }
      }, {
        fields: {
          t: 1
        }
      });

      if (!room || !room.t) {
        return;
      }

      var roomType = room.t;
      return this.roomTypes[roomType] && this.roomTypes[roomType].readOnlyTpl;
    }

    return getReadOnlyTpl;
  }();

  _proto.openRouteLink = function () {
    function openRouteLink(roomType, subData, queryParams) {
      if (!this.roomTypes[roomType]) {
        return false;
      }

      var routeData = {};

      if (this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link) {
        routeData = this.roomTypes[roomType].route.link(subData);
      } else if (subData && subData.name) {
        routeData = {
          name: subData.name
        };
      }

      return FlowRouter.go(this.roomTypes[roomType].route.name, routeData, queryParams);
    }

    return openRouteLink;
  }();

  return RocketChatRoomTypes;
}(RoomTypesCommon))();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/client/index.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/tapi18n", {
  t: "t",
  isRtl: "isRtl"
}, 0);
module.link("../lib/getDefaultSubscriptionPref", {
  getDefaultSubscriptionPref: "getDefaultSubscriptionPref"
}, 1);
module.link("../rocketchat.info", {
  Info: "Info"
}, 2);
module.link("../lib/getUserPreference", {
  getUserPreference: "getUserPreference"
}, 3);
module.link("../lib/fileUploadRestrictions", {
  fileUploadMediaWhiteList: "fileUploadMediaWhiteList",
  fileUploadIsValidContentType: "fileUploadIsValidContentType"
}, 4);
module.link("./lib/roomTypes", {
  roomTypes: "roomTypes"
}, 5);
module.link("../lib/RoomTypeConfig", {
  RoomTypeRouteConfig: "RoomTypeRouteConfig",
  RoomTypeConfig: "RoomTypeConfig",
  RoomSettingsEnum: "RoomSettingsEnum",
  RoomMemberActions: "RoomMemberActions",
  UiTextContext: "UiTextContext"
}, 6);
module.link("../lib/RoomTypesCommon", {
  RoomTypesCommon: "RoomTypesCommon"
}, 7);
module.link("../lib/getUserAvatarURL", {
  getUserAvatarURL: "getUserAvatarURL"
}, 8);
module.link("../lib/slashCommand", {
  slashCommands: "slashCommands"
}, 9);
module.link("../lib/getUserNotificationPreference", {
  getUserNotificationPreference: "getUserNotificationPreference"
}, 10);
module.link("../lib/getAvatarColor", {
  getAvatarColor: "getAvatarColor"
}, 11);
module.link("../lib/getURL", {
  getURL: "getURL"
}, 12);
module.link("../lib/placeholders", {
  placeholders: "placeholders"
}, 13);
module.link("../lib/templateVarHandler", {
  templateVarHandler: "templateVarHandler"
}, 14);
module.link("./lib/RestApiClient", {
  APIClient: "APIClient"
}, 15);
module.link("../lib/timeConverter", {
  secondsToHHMMSS: "secondsToHHMMSS"
}, 16);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"RoomTypeConfig.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/RoomTypeConfig.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _createClass;

module.link("@babel/runtime/helpers/createClass", {
  default: function (v) {
    _createClass = v;
  }
}, 0);
module.export({
  RoomSettingsEnum: function () {
    return RoomSettingsEnum;
  },
  RoomMemberActions: function () {
    return RoomMemberActions;
  },
  UiTextContext: function () {
    return UiTextContext;
  },
  RoomTypeRouteConfig: function () {
    return RoomTypeRouteConfig;
  },
  RoomTypeConfig: function () {
    return RoomTypeConfig;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 1);
var Users;
var settings;

if (Meteor.isServer) {
  var _require = require('../../settings/server');

  settings = _require.settings;
  Users = require('../../models/server/models/Users').default;
} else {
  var _require2 = require('../../settings/client');

  settings = _require2.settings;
}

var RoomSettingsEnum = {
  TYPE: 'type',
  NAME: 'roomName',
  TOPIC: 'roomTopic',
  ANNOUNCEMENT: 'roomAnnouncement',
  DESCRIPTION: 'roomDescription',
  READ_ONLY: 'readOnly',
  REACT_WHEN_READ_ONLY: 'reactWhenReadOnly',
  ARCHIVE_OR_UNARCHIVE: 'archiveOrUnarchive',
  JOIN_CODE: 'joinCode',
  BROADCAST: 'broadcast',
  SYSTEM_MESSAGES: 'systemMessages',
  E2E: 'encrypted'
};
var RoomMemberActions = {
  ARCHIVE: 'archive',
  IGNORE: 'ignore',
  BLOCK: 'block',
  MUTE: 'mute',
  SET_AS_OWNER: 'setAsOwner',
  SET_AS_LEADER: 'setAsLeader',
  SET_AS_MODERATOR: 'setAsModerator',
  LEAVE: 'leave',
  REMOVE_USER: 'removeUser',
  JOIN: 'join',
  INVITE: 'invite'
};
var UiTextContext = {
  CLOSE_WARNING: 'closeWarning',
  HIDE_WARNING: 'hideWarning',
  LEAVE_WARNING: 'leaveWarning',
  NO_ROOMS_SUBSCRIBED: 'noRoomsSubscribed'
};

var RoomTypeRouteConfig = /*#__PURE__*/function () {
  function RoomTypeRouteConfig(_ref) {
    var name = _ref.name,
        path = _ref.path;

    if (typeof name !== 'undefined' && (typeof name !== 'string' || name.length === 0)) {
      throw new Error('The name must be a string.');
    }

    if (typeof path !== 'undefined' && (typeof path !== 'string' || path.length === 0)) {
      throw new Error('The path must be a string.');
    }

    this._name = name;
    this._path = path;
  }

  _createClass(RoomTypeRouteConfig, [{
    key: "name",
    get: function () {
      return this._name;
    }
  }, {
    key: "path",
    get: function () {
      return this._path;
    }
  }]);

  return RoomTypeRouteConfig;
}();

var RoomTypeConfig = /*#__PURE__*/function () {
  function RoomTypeConfig(_ref2) {
    var _ref2$identifier = _ref2.identifier,
        identifier = _ref2$identifier === void 0 ? Random.id() : _ref2$identifier,
        order = _ref2.order,
        icon = _ref2.icon,
        header = _ref2.header,
        label = _ref2.label,
        route = _ref2.route;

    if (typeof identifier !== 'string' || identifier.length === 0) {
      throw new Error('The identifier must be a string.');
    }

    if (typeof order !== 'number') {
      throw new Error('The order must be a number.');
    }

    if (typeof icon !== 'undefined' && (typeof icon !== 'string' || icon.length === 0)) {
      throw new Error('The icon must be a string.');
    }

    if (typeof header !== 'undefined' && (typeof header !== 'string' || header.length === 0)) {
      throw new Error('The header must be a string.');
    }

    if (typeof label !== 'undefined' && (typeof label !== 'string' || label.length === 0)) {
      throw new Error('The label must be a string.');
    }

    if (typeof route !== 'undefined' && !(route instanceof RoomTypeRouteConfig)) {
      throw new Error('Room\'s route is not a valid route configuration. Must be an instance of "RoomTypeRouteConfig".');
    }

    this._identifier = identifier;
    this._order = order;
    this._icon = icon;
    this._header = header;
    this._label = label;
    this._route = route;
  }
  /**
   * The room type's internal identifier.
   */


  var _proto = RoomTypeConfig.prototype;

  _proto.allowRoomSettingChange = function () {
    function allowRoomSettingChange() {
      return true;
    }

    return allowRoomSettingChange;
  }();

  _proto.allowMemberAction = function () {
    function allowMemberAction() {
      return false;
    }

    return allowMemberAction;
  }()
  /**
   * Return a room's name
   *
   * @abstract
   * @return {string} Room's name according to it's type
   */
  ;

  _proto.roomName = function () {
    function roomName() {
      return '';
    }

    return roomName;
  }();

  _proto.canBeCreated = function () {
    function canBeCreated(hasPermission) {
      if (!hasPermission && typeof hasPermission !== 'function') {
        throw new Error('You MUST provide the "hasPermission" to canBeCreated function');
      }

      return Meteor.isServer ? hasPermission(Meteor.userId(), "create-" + this._identifier) : hasPermission(["create-" + this._identifier]);
    }

    return canBeCreated;
  }();

  _proto.canBeDeleted = function () {
    function canBeDeleted(hasPermission, room) {
      if (!hasPermission && typeof hasPermission !== 'function') {
        throw new Error('You MUST provide the "hasPermission" to canBeDeleted function');
      }

      return Meteor.isServer ? hasPermission(Meteor.userId(), "delete-" + room.t, room._id) : hasPermission("delete-" + room.t, room._id);
    }

    return canBeDeleted;
  }();

  _proto.supportMembersList = function () {
    function supportMembersList() {
      return true;
    }

    return supportMembersList;
  }();

  _proto.isGroupChat = function () {
    function isGroupChat() {
      return false;
    }

    return isGroupChat;
  }();

  _proto.canAddUser = function () {
    function canAddUser() {
      return false;
    }

    return canAddUser;
  }();

  _proto.userDetailShowAll = function () {
    function userDetailShowAll() {
      return true;
    }

    return userDetailShowAll;
  }();

  _proto.userDetailShowAdmin = function () {
    function userDetailShowAdmin() {
      return true;
    }

    return userDetailShowAdmin;
  }();

  _proto.preventRenaming = function () {
    function preventRenaming() {
      return false;
    }

    return preventRenaming;
  }();

  _proto.includeInRoomSearch = function () {
    function includeInRoomSearch() {
      return false;
    }

    return includeInRoomSearch;
  }();

  _proto.enableMembersListProfile = function () {
    function enableMembersListProfile() {
      return false;
    }

    return enableMembersListProfile;
  }()
  /**
   * Returns a text which can be used in generic UIs.
   * @param context The role of the text in the UI-Element
   * @return {string} A text or a translation key - the consumers of this method will pass the
   * returned value to an internationalization library
   */
  ;

  _proto.getUiText = function () {
    function getUiText() {
      return '';
    }

    return getUiText;
  }()
  /**
   * Returns the full object of message sender
   * @param {string} senderId Sender's _id
   * @return {object} Sender's object from db
   */
  ;

  _proto.getMsgSender = function () {
    function getMsgSender(senderId) {
      if (Meteor.isServer && Users) {
        return Users.findOneById(senderId);
      }

      return {};
    }

    return getMsgSender;
  }()
  /**
   * Returns details to use on notifications
   *
   * @param {object} room
   * @param {object} user
   * @param {string} notificationMessage
   * @return {object} Notification details
   */
  ;

  _proto.getNotificationDetails = function () {
    function getNotificationDetails(room, user, notificationMessage) {
      if (!Meteor.isServer) {
        return {};
      }

      var title = "#" + this.roomName(room);
      var text = (settings.get('UI_Use_Real_Name') ? user.name : user.username) + ": " + notificationMessage;
      return {
        title: title,
        text: text
      };
    }

    return getNotificationDetails;
  }()
  /**
   * Check if there is an user with the same id and loginToken
   * @param {object} allowData
   * @return {object} User's object from db
   */
  ;

  _proto.canAccessUploadedFile = function () {
    function canAccessUploadedFile() {
      return false;
    }

    return canAccessUploadedFile;
  }();

  _proto.getReadReceiptsExtraData = function () {
    function getReadReceiptsExtraData() {
      return {};
    }

    return getReadReceiptsExtraData;
  }();

  _proto.getAvatarPath = function () {
    function getAvatarPath() {
      return '';
    }

    return getAvatarPath;
  }();

  _proto.openCustomProfileTab = function () {
    function openCustomProfileTab() {
      return false;
    }

    return openCustomProfileTab;
  }();

  _proto.getDiscussionType = function () {
    function getDiscussionType() {
      return 'p';
    }

    return getDiscussionType;
  }();

  _createClass(RoomTypeConfig, [{
    key: "identifier",
    get: function () {
      return this._identifier;
    }
    /**
     * The order of this room type for the display.
     */

  }, {
    key: "order",
    get: function () {
      return this._order;
    }
    /**
     * Sets the order of this room type for the display.
     *
     * @param {number} order the number value for the order
     */
    ,
    set: function (order) {
      if (typeof order !== 'number') {
        throw new Error('The order must be a number.');
      }

      this._order = order;
    }
    /**
     * The icon class, css, to use as the visual aid.
     */

  }, {
    key: "icon",
    get: function () {
      return this._icon;
    }
    /**
     * The header name of this type.
     */

  }, {
    key: "header",
    get: function () {
      return this._header;
    }
    /**
     * The i18n label for this room type.
     */

  }, {
    key: "label",
    get: function () {
      return this._label;
    }
    /**
     * The route config for this room type.
     */

  }, {
    key: "route",
    get: function () {
      return this._route;
    }
  }]);

  return RoomTypeConfig;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomTypesCommon.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/RoomTypesCommon.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RoomTypesCommon: function () {
    return RoomTypesCommon;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 1);
var RoomTypeConfig;
module.link("./RoomTypeConfig", {
  RoomTypeConfig: function (v) {
    RoomTypeConfig = v;
  }
}, 2);
var roomExit;
module.link("./roomExit", {
  roomExit: function (v) {
    roomExit = v;
  }
}, 3);

var RoomTypesCommon = /*#__PURE__*/function () {
  function RoomTypesCommon() {
    this.roomTypes = {};
    this.roomTypesOrder = [];
    this.mainOrder = 1;
  }

  var _proto = RoomTypesCommon.prototype;

  _proto.getTypesToShowOnDashboard = function () {
    function getTypesToShowOnDashboard() {
      var _this = this;

      return Object.keys(this.roomTypes).filter(function (key) {
        return _this.roomTypes[key].includeInDashboard && _this.roomTypes[key].includeInDashboard();
      });
    }

    return getTypesToShowOnDashboard;
  }()
  /**
   * Adds a room type to the application.
   *
   * @param {RoomTypeConfig} roomConfig
   * @returns {void}
   */
  ;

  _proto.add = function () {
    function add(roomConfig) {
      if (!(roomConfig instanceof RoomTypeConfig)) {
        throw new Error('Invalid Room Configuration object, it must extend "RoomTypeConfig"');
      }

      if (this.roomTypes[roomConfig.identifier]) {
        return false;
      }

      if (!roomConfig.order) {
        roomConfig.order = this.mainOrder + 10;
        this.mainOrder += 10;
      }

      this.roomTypesOrder.push({
        identifier: roomConfig.identifier,
        order: roomConfig.order
      });
      this.roomTypes[roomConfig.identifier] = roomConfig;

      if (roomConfig.route && roomConfig.route.path && roomConfig.route.name && roomConfig.route.action) {
        var routeConfig = {
          name: roomConfig.route.name,
          action: roomConfig.route.action // triggersExit: [() => Session.set('openedRoom', '')],

        };

        if (Meteor.isClient) {
          routeConfig.triggersExit = [roomExit];
        }

        return FlowRouter.route(roomConfig.route.path, routeConfig);
      }
    }

    return add;
  }();

  _proto.hasCustomLink = function () {
    function hasCustomLink(roomType) {
      return this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link != null;
    }

    return hasCustomLink;
  }()
  /**
   * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))
   * @param {object} subData the user's subscription data
   */
  ;

  _proto.getRouteLink = function () {
    function getRouteLink(roomType, subData) {
      var routeData = this.getRouteData(roomType, subData);

      if (!routeData) {
        return false;
      }

      return FlowRouter.path(this.roomTypes[roomType].route.name, routeData);
    }

    return getRouteLink;
  }()
  /**
   * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))
   * @param {RoomTypeConfig} roomConfig room's type configuration
   */
  ;

  _proto.getConfig = function () {
    function getConfig(roomType) {
      return this.roomTypes[roomType];
    }

    return getConfig;
  }()
  /**
   * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))
   * @param {object} subData the user's subscription data
   */
  ;

  _proto.getURL = function () {
    function getURL(roomType, subData) {
      var routeData = this.getRouteData(roomType, subData);

      if (!routeData) {
        return false;
      }

      return FlowRouter.url(this.roomTypes[roomType].route.name, routeData);
    }

    return getURL;
  }();

  _proto.getRelativePath = function () {
    function getRelativePath(roomType, subData) {
      return this.getRouteLink(roomType, subData).replace(Meteor.absoluteUrl(), '');
    }

    return getRelativePath;
  }();

  _proto.getRouteData = function () {
    function getRouteData(roomType, subData) {
      if (!this.roomTypes[roomType]) {
        return false;
      }

      var routeData = {};

      if (this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link) {
        routeData = this.roomTypes[roomType].route.link(subData);
      } else if (subData && subData.name) {
        routeData = {
          rid: subData.rid || subData._id,
          name: subData.name
        };
      }

      return routeData;
    }

    return getRouteData;
  }();

  return RoomTypesCommon;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"fileUploadRestrictions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/fileUploadRestrictions.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  fileUploadIsValidContentType: function () {
    return fileUploadIsValidContentType;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 1);
var settings;

if (Meteor.isClient) {
  settings = require('../../settings/client').settings;
} else {
  settings = require('../../settings/server').settings;
}

var fileUploadMediaWhiteList = function (customWhiteList) {
  var mediaTypeWhiteList = customWhiteList || settings.get('FileUpload_MediaTypeWhiteList');

  if (!mediaTypeWhiteList || mediaTypeWhiteList === '*') {
    return;
  }

  return _.map(mediaTypeWhiteList.split(','), function (item) {
    return item.trim();
  });
};

var fileUploadMediaBlackList = function () {
  var blacklist = settings.get('FileUpload_MediaTypeBlackList');

  if (!blacklist) {
    return;
  }

  return _.map(blacklist.split(','), function (item) {
    return item.trim();
  });
};

var isTypeOnList = function (type, list) {
  if (_.contains(list, type)) {
    return true;
  }

  var wildCardGlob = '/*';

  var wildcards = _.filter(list, function (item) {
    return item.indexOf(wildCardGlob) > 0;
  });

  if (_.contains(wildcards, type.replace(/(\/.*)$/, wildCardGlob))) {
    return true;
  }
};

var fileUploadIsValidContentType = function (type, customWhiteList) {
  var blackList = fileUploadMediaBlackList();
  var whiteList = fileUploadMediaWhiteList(customWhiteList);

  if (!type && blackList) {
    return false;
  }

  if (blackList && isTypeOnList(type, blackList)) {
    return false;
  }

  if (!whiteList) {
    return true;
  }

  return isTypeOnList(type, whiteList);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getAvatarColor.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getAvatarColor.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getAvatarColor: function () {
    return getAvatarColor;
  }
});
var colors = ['#F44336', '#E91E63', '#9C27B0', '#673AB7', '#3F51B5', '#2196F3', '#03A9F4', '#00BCD4', '#009688', '#4CAF50', '#8BC34A', '#CDDC39', '#FFC107', '#FF9800', '#FF5722', '#795548', '#9E9E9E', '#607D8B'];

var getAvatarColor = function (name) {
  return colors[name.length % colors.length];
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getAvatarURL.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getAvatarURL.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getAvatarURL: function () {
    return getAvatarURL;
  }
});
var getURL;
module.link("./getURL", {
  getURL: function (v) {
    getURL = v;
  }
}, 0);

var getAvatarURL = function (_ref) {
  var username = _ref.username,
      roomId = _ref.roomId,
      cache = _ref.cache;

  if (username) {
    return getURL("/avatar/" + encodeURIComponent(username) + (cache ? "?etag=" + cache : ''));
  }

  if (roomId) {
    return getURL("/avatar/room/" + encodeURIComponent(roomId) + (cache ? "?etag=" + cache : ''));
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getDefaultSubscriptionPref.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getDefaultSubscriptionPref.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getDefaultSubscriptionPref: function () {
    return getDefaultSubscriptionPref;
  }
});

var getDefaultSubscriptionPref = function (userPref) {
  var subscription = {};

  var _ref = userPref.settings && userPref.settings.preferences || {},
      desktopNotifications = _ref.desktopNotifications,
      pushNotifications = _ref.pushNotifications,
      emailNotificationMode = _ref.emailNotificationMode,
      highlights = _ref.highlights;

  if (Array.isArray(highlights) && highlights.length) {
    subscription.userHighlights = highlights;
  }

  if (desktopNotifications && desktopNotifications !== 'default') {
    subscription.desktopNotifications = desktopNotifications;
    subscription.desktopPrefOrigin = 'user';
  }

  if (pushNotifications && pushNotifications !== 'default') {
    subscription.mobilePushNotifications = pushNotifications;
    subscription.mobilePrefOrigin = 'user';
  }

  if (emailNotificationMode && emailNotificationMode !== 'default') {
    subscription.emailNotifications = emailNotificationMode;
    subscription.emailPrefOrigin = 'user';
  }

  return subscription;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getRoomAvatarURL.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getRoomAvatarURL.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getRoomAvatarURL: function () {
    return getRoomAvatarURL;
  }
});
var getAvatarURL;
module.link("./getAvatarURL", {
  getAvatarURL: function (v) {
    getAvatarURL = v;
  }
}, 0);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);

var getRoomAvatarURL = function (roomId, etag) {
  var externalSource = (settings.get('Accounts_RoomAvatarExternalProviderUrl') || '').trim().replace(/\/$/, '');

  if (externalSource !== '') {
    return externalSource.replace('{roomId}', roomId);
  }

  if (!roomId) {
    return;
  }

  return getAvatarURL({
    roomId: roomId,
    cache: etag
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getURL.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getURL.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
module.export({
  _getURL: function () {
    return _getURL;
  },
  getURL: function () {
    return getURL;
  }
});
var s;
module.link("underscore.string", {
  "default": function (v) {
    s = v;
  }
}, 0);
var escapeRegExp;
module.link("@rocket.chat/string-helpers", {
  escapeRegExp: function (v) {
    escapeRegExp = v;
  }
}, 1);
var isURL;
module.link("./isURL", {
  isURL: function (v) {
    isURL = v;
  }
}, 2);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);

function getCloudUrl(path, _site_url, cloudRoute) {
  var cloudParams = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
  var cloudBaseUrl = (settings.get('DeepLink_Url') || '').replace(/\/+$/, '');
  var siteUrl = s.rtrim(_site_url, '/'); // Remove the protocol

  var host = siteUrl.replace(/https?\:\/\//i, '');
  path = s.ltrim(path, '/');
  Object.assign(cloudParams, {
    host: host,
    path: path
  });

  if (siteUrl.includes('http://')) {
    cloudParams.secure = 'no';
  }

  var params = Object.entries(cloudParams).map(function (_ref) {
    var _ref2 = _slicedToArray(_ref, 2),
        key = _ref2[0],
        value = _ref2[1];

    return key + "=" + encodeURIComponent(value);
  }).join('&');
  return cloudBaseUrl + "/" + cloudRoute + "?" + params;
}

var _getURL = function (path, _ref3) {
  var cdn = _ref3.cdn,
      full = _ref3.full,
      cloud = _ref3.cloud,
      cloud_route = _ref3.cloud_route,
      cloud_params = _ref3.cloud_params,
      _cdn_prefix = _ref3._cdn_prefix,
      _root_url_path_prefix = _ref3._root_url_path_prefix,
      _site_url = _ref3._site_url;

  if (isURL(path)) {
    return path;
  }

  var _path$split = path.split('?'),
      _path$split2 = _slicedToArray(_path$split, 2),
      _path = _path$split2[0],
      _query = _path$split2[1];

  path = _path;
  var query = _query ? "?" + _query : '';
  var siteUrl = s.rtrim(s.trim(_site_url || ''), '/');
  var cloudRoute = s.trim(cloud_route || '');
  var cdnPrefix = s.rtrim(s.trim(_cdn_prefix || ''), '/');
  var pathPrefix = s.rtrim(s.trim(_root_url_path_prefix || ''), '/');
  var finalPath = s.ltrim(s.trim(path), '/');
  var url = s.rtrim(pathPrefix + "/" + finalPath, '/') + query;

  if (cloud) {
    var cloudParams = cloud_params || {};
    return getCloudUrl(url, siteUrl, cloudRoute, cloudParams);
  }

  if (cdn && cdnPrefix !== '') {
    return cdnPrefix + url;
  }

  if (full) {
    return siteUrl.replace(new RegExp(escapeRegExp(pathPrefix) + "$"), '') + url;
  }

  return url;
};

var getURL = function (path) {
  var _ref4 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
      _ref4$cdn = _ref4.cdn,
      cdn = _ref4$cdn === void 0 ? true : _ref4$cdn,
      _ref4$full = _ref4.full,
      full = _ref4$full === void 0 ? false : _ref4$full,
      _ref4$cloud = _ref4.cloud,
      cloud = _ref4$cloud === void 0 ? false : _ref4$cloud,
      _ref4$cloud_route = _ref4.cloud_route,
      cloud_route = _ref4$cloud_route === void 0 ? '' : _ref4$cloud_route,
      _ref4$cloud_params = _ref4.cloud_params,
      cloud_params = _ref4$cloud_params === void 0 ? {} : _ref4$cloud_params;

  return _getURL(path, {
    cdn: cdn,
    full: full,
    cloud: cloud,
    cloud_route: cloud_route,
    cloud_params: cloud_params,
    _cdn_prefix: settings.get('CDN_PREFIX'),
    _root_url_path_prefix: __meteor_runtime_config__.ROOT_URL_PATH_PREFIX,
    _site_url: settings.get('Site_Url')
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getUserAvatarURL.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getUserAvatarURL.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getUserAvatarURL: function () {
    return getUserAvatarURL;
  }
});
var getAvatarURL;
module.link("./getAvatarURL", {
  getAvatarURL: function (v) {
    getAvatarURL = v;
  }
}, 0);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);

var getUserAvatarURL = function (username) {
  var cache = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
  var externalSource = (settings.get('Accounts_AvatarExternalProviderUrl') || '').trim().replace(/\/$/, '');

  if (externalSource !== '') {
    return externalSource.replace('{username}', username);
  }

  if (username == null) {
    return;
  }

  return getAvatarURL({
    username: username,
    cache: cache
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getUserNotificationPreference.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getUserNotificationPreference.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getUserNotificationPreference: function () {
    return getUserNotificationPreference;
  }
});
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 0);
var Users;
module.link("../../models", {
  Users: function (v) {
    Users = v;
  }
}, 1);

var getUserNotificationPreference = function (user, pref) {
  var _user, _user$settings;

  if (typeof user === 'string') {
    user = Users.findOneById(user);
  }

  var preferenceKey;

  switch (pref) {
    case 'desktop':
      preferenceKey = 'desktopNotifications';
      break;

    case 'mobile':
      preferenceKey = 'pushNotifications';
      break;

    case 'email':
      preferenceKey = 'emailNotificationMode';
      break;
  }

  if ((_user = user) !== null && _user !== void 0 && (_user$settings = _user.settings) !== null && _user$settings !== void 0 && _user$settings.preferences && typeof user.settings.preferences[preferenceKey] !== 'undefined' && user.settings.preferences[preferenceKey] !== 'default') {
    return {
      value: user.settings.preferences[preferenceKey],
      origin: 'user'
    };
  }

  var serverValue = settings.get("Accounts_Default_User_Preferences_" + preferenceKey);

  if (serverValue) {
    return {
      value: serverValue,
      origin: 'server'
    };
  }

  return null;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getUserPreference.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/getUserPreference.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _typeof;

module.link("@babel/runtime/helpers/typeof", {
  default: function (v) {
    _typeof = v;
  }
}, 0);
module.export({
  getUserPreference: function () {
    return getUserPreference;
  }
});
var Users;
module.link("../../models", {
  Users: function (v) {
    Users = v;
  }
}, 0);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);

var getUserPreference = function (user, key) {
  var defaultValue = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;
  var preference;

  if (_typeof(user) === _typeof('')) {
    var _fields;

    user = Users.findOne(user, {
      fields: (_fields = {}, _fields["settings.preferences." + key] = 1, _fields)
    });
  }

  if (user && user.settings && user.settings.preferences && user.settings.preferences.hasOwnProperty(key)) {
    preference = user.settings.preferences[key];
  } else if (defaultValue === undefined) {
    preference = settings.get("Accounts_Default_User_Preferences_" + key);
  }

  return preference !== undefined ? preference : defaultValue;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"isURL.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/isURL.js                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isURL: function () {
    return isURL;
  },
  isRelativeURL: function () {
    return isRelativeURL;
  }
});

var isURL = function (str) {
  return /^(https?:\/\/|data:)/.test(str);
};

var isRelativeURL = function (str) {
  return /^[^\/]+\/[^\/].*$|^\/[^\/].*$/gim.test(str);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"mimeTypes.js":[
  "mime-type/with-db"
],"placeholders.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/placeholders.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  placeholders: function () {
    return placeholders;
  }
});
var s;
module.link("underscore.string", {
  "default": function (v) {
    s = v;
  }
}, 0);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 1);
var placeholders = {
  replace: function (str, data) {
    if (!str) {
      return '';
    }

    str = str.replace(/\[Site_Name\]/g, settings.get('Site_Name') || '');
    str = str.replace(/\[Site_URL\]/g, settings.get('Site_Url') || '');

    if (data) {
      str = str.replace(/\[name\]/g, data.name || '');
      str = str.replace(/\[fname\]/g, s.strLeft(data.name, ' ') || '');
      str = str.replace(/\[lname\]/g, s.strRightBack(data.name, ' ') || '');
      str = str.replace(/\[email\]/g, data.email || '');
      str = str.replace(/\[password\]/g, data.password || '');
      str = str.replace(/\[reason\]/g, data.reason || '');
      str = str.replace(/\[User\]/g, data.user || '');
      str = str.replace(/\[Room\]/g, data.room || '');

      if (data.unsubscribe) {
        str = str.replace(/\[unsubscribe\]/g, data.unsubscribe);
      }
    }

    str = str.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1<br>$2');
    return str;
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomExit.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/roomExit.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  roomExit: function () {
    return roomExit;
  }
});
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 2);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);

var testIfPathAreEquals = function () {
  var oldPath = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  var newPath = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
  return oldPath.replace(/"/g, '') === newPath;
};

var roomExit = function () {
  var oldRoute = FlowRouter.current();
  Tracker.afterFlush(function () {
    var context = FlowRouter.current();

    if (oldRoute && testIfPathAreEquals(oldRoute.params.name || oldRoute.params.rid || oldRoute.params.id, context.params.name || context.params.rid || context.params.id)) {
      return;
    } // 7370 - Close flex-tab when opening a room on mobile UI


    if (window.matchMedia('(max-width: 500px)').matches) {
      var flex = document.querySelector('.flex-tab');

      if (flex) {
        var templateData = Blaze.getData(flex);
        templateData && templateData.tabBar && templateData.tabBar.close();
      }
    }

    callbacks.run('roomExit'); // Session.set('lastOpenedRoom', Session.get('openedRoom'));
    // Session.set('openedRoom', null);
    // RoomManager.openedRoom = null;
  });

  if (typeof window.currentTracker !== 'undefined') {
    window.currentTracker.stop();
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"slashCommand.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/slashCommand.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  slashCommands: function () {
    return slashCommands;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var slashCommands = {
  commands: {},
  add: function () {
    function _addingSlashCommand(command, callback) {
      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      var result = arguments.length > 3 ? arguments[3] : undefined;
      var providesPreview = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
      var previewer = arguments.length > 5 ? arguments[5] : undefined;
      var previewCallback = arguments.length > 6 ? arguments[6] : undefined;
      slashCommands.commands[command] = {
        command: command,
        callback: callback,
        params: options.params,
        description: options.description,
        permission: options.permission,
        clientOnly: options.clientOnly || false,
        result: result,
        providesPreview: providesPreview,
        previewer: previewer,
        previewCallback: previewCallback
      };
    }

    return _addingSlashCommand;
  }(),
  run: function () {
    function _runningSlashCommand(command, params, message, triggerId) {
      if (slashCommands.commands[command] && typeof slashCommands.commands[command].callback === 'function') {
        if (!message || !message.rid) {
          throw new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');
        }

        return slashCommands.commands[command].callback(command, params, message, triggerId);
      }
    }

    return _runningSlashCommand;
  }(),
  getPreviews: function () {
    function _executeSlashCommandPreview(command, params, message, preview, triggerId) {
      if (slashCommands.commands[command] && typeof slashCommands.commands[command].previewCallback === 'function') {
        if (!message || !message.rid) {
          throw new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');
        } // { id, type, value }


        if (!preview.id || !preview.type || !preview.value) {
          throw new Meteor.Error('error-invalid-preview', 'Preview Item must have an id, type, and value.');
        }

        return slashCommands.commands[command].previewCallback(command, params, message, preview, triggerId);
      }
    }

    return _executeSlashCommandPreview;
  }(),
  executePreview: function () {
    function _executeSlashCommandPreview(command, params, message, preview, triggerId) {
      if (slashCommands.commands[command] && typeof slashCommands.commands[command].previewCallback === 'function') {
        if (!message || !message.rid) {
          throw new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');
        } // { id, type, value }


        if (!preview.id || !preview.type || !preview.value) {
          throw new Meteor.Error('error-invalid-preview', 'Preview Item must have an id, type, and value.');
        }

        return slashCommands.commands[command].previewCallback(command, params, message, preview, triggerId);
      }
    }

    return _executeSlashCommandPreview;
  }()
};
Meteor.methods({
  slashCommand: function (command) {
    if (!Meteor.userId()) {
      throw new Meteor.Error('error-invalid-user', 'Invalid user', {
        method: 'slashCommand'
      });
    }

    if (!command || !command.cmd || !slashCommands.commands[command.cmd]) {
      throw new Meteor.Error('error-invalid-command', 'Invalid Command Provided', {
        method: 'executeSlashCommandPreview'
      });
    }

    return slashCommands.run(command.cmd, command.params, command.msg, command.triggerId);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tapi18n.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/tapi18n.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  t: function () {
    return t;
  },
  isRtl: function () {
    return isRtl;
  }
});

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 2);

var t = function (key) {
  for (var _len = arguments.length, replaces = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    replaces[_key - 1] = arguments[_key];
  }

  if (_.isObject(replaces[0])) {
    var _TAPi18n;

    return (_TAPi18n = TAPi18n).__.apply(_TAPi18n, [key].concat(replaces));
  }

  return TAPi18n.__(key, {
    postProcess: 'sprintf',
    sprintf: replaces
  });
};

var isRtl = function (lang) {
  var language = lang || Meteor._localStorage.getItem('userLanguage') || 'en-US';
  return ['ar', 'dv', 'fa', 'he', 'ku', 'ps', 'sd', 'ug', 'ur', 'yi'].includes(language.split('-').shift().toLowerCase());
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"templateVarHandler.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/templateVarHandler.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  templateVarHandler: function () {
    return templateVarHandler;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var logger;

if (Meteor.isServer) {
  var _require = require('../../../server/lib/logger/Logger'),
      Logger = _require.Logger;

  logger = new Logger('TemplateVarHandler');
}

var templateVarHandler = function (variable, object) {
  var templateRegex = /#{([\w\-]+)}/gi;
  var match = templateRegex.exec(variable);
  var tmpVariable = variable;

  if (match == null) {
    if (!object.hasOwnProperty(variable)) {
      logger && logger.debug("user does not have attribute: " + variable);
      return;
    }

    return object[variable];
  }

  logger && logger.debug('template found. replacing values');

  while (match != null) {
    var tmplVar = match[0];
    var tmplAttrName = match[1];

    if (!object.hasOwnProperty(tmplAttrName)) {
      logger && logger.debug("user does not have attribute: " + tmplAttrName);
      return;
    }

    var attrVal = object[tmplAttrName];
    logger && logger.debug("replacing template var: " + tmplVar + " with value: " + attrVal);
    tmpVariable = tmpVariable.replace(tmplVar, attrVal);
    match = templateRegex.exec(variable);
  }

  return tmpVariable;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"timeConverter.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/lib/timeConverter.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  secondsToHHMMSS: function () {
    return secondsToHHMMSS;
  }
});

var secondsToHHMMSS = function (sec) {
  sec = parseFloat(sec);
  var hours = Math.floor(sec / 3600);
  var minutes = Math.floor((sec - hours * 3600) / 60);
  var seconds = Math.round(sec - hours * 3600 - minutes * 60);

  if (hours < 10) {
    hours = "0" + hours;
  }

  if (minutes < 10) {
    minutes = "0" + minutes;
  }

  if (seconds < 10) {
    seconds = "0" + seconds;
  }

  if (hours > 0) {
    return hours + ":" + minutes + ":" + seconds;
  }

  if (minutes > 0) {
    return "00:" + minutes + ":" + seconds;
  }

  return "00:00:" + seconds;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"stream":{"constants.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/stream/constants.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ROOM_DATA_STREAM: function () {
    return ROOM_DATA_STREAM;
  }
});
var ROOM_DATA_STREAM = 'room-data';
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/index.js                                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.info":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/rocketchat.info                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./rocketchat.info.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.info.js":function module(require,exports){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/utils/rocketchat.info.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
exports.Info = {
    "version": "4.4.0-develop",
    "build": {
        "date": "2022-06-11T15:32:06.224Z",
        "nodeVersion": "v14.18.2",
        "arch": "arm64",
        "platform": "darwin",
        "osRelease": "21.3.0",
        "totalMemory": 8589934592,
        "freeMemory": 233750528,
        "cpus": 8
    },
    "commit": {
        "hash": "d9c65c60ac3393ee94db775221f03a042874afd1",
        "date": "Fri Jan 28 20:14:46 2022 -0300",
        "author": "Diego Sampaio",
        "subject": "Merge branch 'master' into develop",
        "tag": "4.3.3",
        "branch": "develop"
    },
    "marketplaceApiVersion": "1.30.0"
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"dolphin":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/dolphin/lib/common.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration: function (v) {
    ServiceConfiguration = v;
  }
}, 2);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth: function (v) {
    CustomOAuth = v;
  }
}, 4);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 5);
var config = {
  serverURL: '',
  authorizePath: '/m/oauth2/auth/',
  tokenPath: '/m/oauth2/token/',
  identityPath: '/m/oauth2/api/me/',
  scope: 'basic',
  addAutopublishFields: {
    forLoggedInUser: ['services.dolphin'],
    forOtherUsers: ['services.dolphin.name']
  },
  accessTokenParam: 'access_token'
};
var Dolphin = new CustomOAuth('dolphin', config);

function DolphinOnCreateUser(options, user) {
  if (user && user.services && user.services.dolphin && user.services.dolphin.NickName) {
    user.username = user.services.dolphin.NickName;
  }

  return options;
}

if (Meteor.isServer) {
  Meteor.startup(function () {
    return settings.get('Accounts_OAuth_Dolphin_URL', function (key, value) {
      config.serverURL = value;
      return Dolphin.configure(config);
    });
  });

  if (settings.get('Accounts_OAuth_Dolphin_URL')) {
    var data = {
      buttonLabelText: settings.get('Accounts_OAuth_Dolphin_button_label_text'),
      buttonColor: settings.get('Accounts_OAuth_Dolphin_button_color'),
      buttonLabelColor: settings.get('Accounts_OAuth_Dolphin_button_label_color'),
      clientId: settings.get('Accounts_OAuth_Dolphin_id'),
      secret: settings.get('Accounts_OAuth_Dolphin_secret'),
      serverURL: settings.get('Accounts_OAuth_Dolphin_URL'),
      loginStyle: settings.get('Accounts_OAuth_Dolphin_login_style')
    };
    ServiceConfiguration.configurations.upsert({
      service: 'dolphin'
    }, {
      $set: data
    });
  }

  callbacks.add('beforeCreateUser', DolphinOnCreateUser, callbacks.priority.HIGH, 'dolphin');
} else {
  Meteor.startup(function () {
    return Tracker.autorun(function () {
      if (settings.get('Accounts_OAuth_Dolphin_URL')) {
        config.serverURL = settings.get('Accounts_OAuth_Dolphin_URL');
        return Dolphin.configure(config);
      }
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/dolphin/client/index.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./login-button.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/dolphin/client/login-button.css                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"drupal":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/drupal/lib/common.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth: function (v) {
    CustomOAuth = v;
  }
}, 3);
// Drupal Server CallBack URL needs to be http(s)://{rocketchat.server}[:port]/_oauth/drupal
// In RocketChat -> Administration the URL needs to be http(s)://{drupal.server}/
var config = {
  serverURL: '',
  identityPath: '/oauth2/UserInfo',
  authorizePath: '/oauth2/authorize',
  tokenPath: '/oauth2/token',
  scope: 'openid email profile offline_access',
  tokenSentVia: 'payload',
  usernameField: 'preferred_username',
  mergeUsers: true,
  addAutopublishFields: {
    forLoggedInUser: ['services.drupal'],
    forOtherUsers: ['services.drupal.name']
  },
  accessTokenParam: 'access_token'
};
var Drupal = new CustomOAuth('drupal', config);

if (Meteor.isServer) {
  Meteor.startup(function () {
    settings.get('API_Drupal_URL', function (key, value) {
      config.serverURL = value;
      Drupal.configure(config);
    });
  });
} else {
  Meteor.startup(function () {
    Tracker.autorun(function () {
      if (settings.get('API_Drupal_URL')) {
        config.serverURL = settings.get('API_Drupal_URL');
        Drupal.configure(config);
      }
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/drupal/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./login-button.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/drupal/client/login-button.css                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"emoji-emojione":{"lib":{"emojiPicker.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-emojione/lib/emojiPicker.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  emojiCategories: function () {
    return emojiCategories;
  },
  toneList: function () {
    return toneList;
  },
  emojisByCategory: function () {
    return emojisByCategory;
  }
});
var emojiCategories = [{
  key: 'people',
  i18n: 'Smileys_and_People'
}, {
  key: 'nature',
  i18n: 'Animals_and_Nature'
}, {
  key: 'food',
  i18n: 'Food_and_Drink'
}, {
  key: 'activity',
  i18n: 'Activity'
}, {
  key: 'travel',
  i18n: 'Travel_and_Places'
}, {
  key: 'objects',
  i18n: 'Objects'
}, {
  key: 'symbols',
  i18n: 'Symbols'
}, {
  key: 'flags',
  i18n: 'Flags'
}];
var toneList = {
  'snowboarder': 1,
  'person_lifting_weights': 1,
  'woman_lifting_weights': 1,
  'man_lifting_weights': 1,
  'person_doing_cartwheel': 1,
  'woman_cartwheeling': 1,
  'man_cartwheeling': 1,
  'person_bouncing_ball': 1,
  'woman_bouncing_ball': 1,
  'man_bouncing_ball': 1,
  'person_playing_handball': 1,
  'woman_playing_handball': 1,
  'man_playing_handball': 1,
  'person_golfing': 1,
  'woman_golfing': 1,
  'man_golfing': 1,
  'horse_racing': 1,
  'person_in_lotus_position': 1,
  'woman_in_lotus_position': 1,
  'man_in_lotus_position': 1,
  'person_surfing': 1,
  'woman_surfing': 1,
  'man_surfing': 1,
  'person_swimming': 1,
  'woman_swimming': 1,
  'man_swimming': 1,
  'person_playing_water_polo': 1,
  'woman_playing_water_polo': 1,
  'man_playing_water_polo': 1,
  'person_rowing_boat': 1,
  'woman_rowing_boat': 1,
  'man_rowing_boat': 1,
  'person_climbing': 1,
  'woman_climbing': 1,
  'man_climbing': 1,
  'person_mountain_biking': 1,
  'woman_mountain_biking': 1,
  'man_mountain_biking': 1,
  'person_biking': 1,
  'woman_biking': 1,
  'man_biking': 1,
  'person_juggling': 1,
  'woman_juggling': 1,
  'man_juggling': 1,
  'bath': 1,
  'person_in_bed': 1,
  'palms_up_together': 1,
  'open_hands': 1,
  'raised_hands': 1,
  'clap': 1,
  'thumbsup': 1,
  'thumbsdown': 1,
  'punch': 1,
  'fist': 1,
  'left_facing_fist': 1,
  'right_facing_fist': 1,
  'fingers_crossed': 1,
  'v': 1,
  'love_you_gesture': 1,
  'metal': 1,
  'ok_hand': 1,
  'point_left': 1,
  'point_right': 1,
  'point_up_2': 1,
  'point_down': 1,
  'point_up': 1,
  'raised_hand': 1,
  'raised_back_of_hand': 1,
  'hand_splayed': 1,
  'vulcan': 1,
  'wave': 1,
  'call_me': 1,
  'muscle': 1,
  'leg': 1,
  'foot': 1,
  'middle_finger': 1,
  'writing_hand': 1,
  'pray': 1,
  'ear': 1,
  'nose': 1,
  'baby': 1,
  'girl': 1,
  'child': 1,
  'boy': 1,
  'woman': 1,
  'adult': 1,
  'man': 1,
  'blond_haired_person': 1,
  'blond-haired_woman': 1,
  'blond-haired_man': 1,
  'woman_red_haired': 1,
  'man_red_haired': 1,
  'woman_curly_haired': 1,
  'man_curly_haired': 1,
  'woman_white_haired': 1,
  'man_white_haired': 1,
  'woman_bald': 1,
  'man_bald': 1,
  'bearded_person': 1,
  'older_woman': 1,
  'older_adult': 1,
  'older_man': 1,
  'man_with_chinese_cap': 1,
  'person_wearing_turban': 1,
  'woman_wearing_turban': 1,
  'man_wearing_turban': 1,
  'woman_with_headscarf': 1,
  'police_officer': 1,
  'woman_police_officer': 1,
  'man_police_officer': 1,
  'construction_worker': 1,
  'woman_construction_worker': 1,
  'man_construction_worker': 1,
  'guard': 1,
  'woman_guard': 1,
  'man_guard': 1,
  'detective': 1,
  'woman_detective': 1,
  'man_detective': 1,
  'woman_health_worker': 1,
  'man_health_worker': 1,
  'woman_farmer': 1,
  'man_farmer': 1,
  'woman_cook': 1,
  'man_cook': 1,
  'woman_student': 1,
  'man_student': 1,
  'woman_singer': 1,
  'man_singer': 1,
  'woman_teacher': 1,
  'man_teacher': 1,
  'woman_factory_worker': 1,
  'man_factory_worker': 1,
  'woman_technologist': 1,
  'man_technologist': 1,
  'woman_office_worker': 1,
  'man_office_worker': 1,
  'woman_mechanic': 1,
  'man_mechanic': 1,
  'woman_scientist': 1,
  'man_scientist': 1,
  'woman_artist': 1,
  'man_artist': 1,
  'woman_firefighter': 1,
  'man_firefighter': 1,
  'woman_pilot': 1,
  'man_pilot': 1,
  'woman_astronaut': 1,
  'man_astronaut': 1,
  'woman_judge': 1,
  'man_judge': 1,
  'bride_with_veil': 1,
  'man_in_tuxedo': 1,
  'princess': 1,
  'prince': 1,
  'mrs_claus': 1,
  'santa': 1,
  'superhero': 1,
  'woman_superhero': 1,
  'man_superhero': 1,
  'supervillain': 1,
  'woman_supervillain': 1,
  'man_supervillain': 1,
  'mage': 1,
  'woman_mage': 1,
  'man_mage': 1,
  'elf': 1,
  'woman_elf': 1,
  'man_elf': 1,
  'vampire': 1,
  'woman_vampire': 1,
  'man_vampire': 1,
  'merperson': 1,
  'mermaid': 1,
  'merman': 1,
  'fairy': 1,
  'woman_fairy': 1,
  'man_fairy': 1,
  'angel': 1,
  'pregnant_woman': 1,
  'breast_feeding': 1,
  'person_bowing': 1,
  'woman_bowing': 1,
  'man_bowing': 1,
  'person_tipping_hand': 1,
  'woman_tipping_hand': 1,
  'man_tipping_hand': 1,
  'person_gesturing_no': 1,
  'woman_gesturing_no': 1,
  'man_gesturing_no': 1,
  'person_gesturing_ok': 1,
  'woman_gesturing_ok': 1,
  'man_gesturing_ok': 1,
  'person_raising_hand': 1,
  'woman_raising_hand': 1,
  'man_raising_hand': 1,
  'person_facepalming': 1,
  'woman_facepalming': 1,
  'man_facepalming': 1,
  'person_shrugging': 1,
  'woman_shrugging': 1,
  'man_shrugging': 1,
  'person_pouting': 1,
  'woman_pouting': 1,
  'man_pouting': 1,
  'person_frowning': 1,
  'woman_frowning': 1,
  'man_frowning': 1,
  'person_getting_haircut': 1,
  'woman_getting_haircut': 1,
  'man_getting_haircut': 1,
  'person_getting_massage': 1,
  'woman_getting_face_massage': 1,
  'man_getting_face_massage': 1,
  'person_in_steamy_room': 1,
  'woman_in_steamy_room': 1,
  'man_in_steamy_room': 1,
  'nail_care': 1,
  'selfie': 1,
  'dancer': 1,
  'man_dancing': 1,
  'levitate': 1,
  'person_walking': 1,
  'woman_walking': 1,
  'man_walking': 1,
  'person_running': 1,
  'woman_running': 1,
  'man_running': 1
};
var emojisByCategory = {
  symbols: ['heart', 'orange_heart', 'yellow_heart', 'green_heart', 'blue_heart', 'purple_heart', 'black_heart', 'broken_heart', 'heart_exclamation', 'two_hearts', 'revolving_hearts', 'heartbeat', 'heartpulse', 'sparkling_heart', 'cupid', 'gift_heart', 'heart_decoration', 'peace', 'cross', 'star_and_crescent', 'om_symbol', 'wheel_of_dharma', 'star_of_david', 'six_pointed_star', 'menorah', 'yin_yang', 'orthodox_cross', 'place_of_worship', 'ophiuchus', 'aries', 'taurus', 'gemini', 'cancer', 'leo', 'virgo', 'libra', 'scorpius', 'sagittarius', 'capricorn', 'aquarius', 'pisces', 'id', 'atom', 'infinity', 'accept', 'radioactive', 'biohazard', 'mobile_phone_off', 'vibration_mode', 'u6709', 'u7121', 'u7533', 'u55b6', 'u6708', 'eight_pointed_black_star', 'vs', 'white_flower', 'ideograph_advantage', 'secret', 'congratulations', 'u5408', 'u6e80', 'u5272', 'u7981', 'a', 'b', 'ab', 'cl', 'o2', 'sos', 'x', 'o', 'octagonal_sign', 'no_entry', 'name_badge', 'no_entry_sign', '100', 'anger', 'hotsprings', 'no_pedestrians', 'do_not_litter', 'no_bicycles', 'non-potable_water', 'underage', 'no_mobile_phones', 'no_smoking', 'exclamation', 'grey_exclamation', 'question', 'grey_question', 'bangbang', 'interrobang', 'low_brightness', 'high_brightness', 'part_alternation_mark', 'warning', 'children_crossing', 'trident', 'fleur-de-lis', 'beginner', 'recycle', 'white_check_mark', 'u6307', 'chart', 'sparkle', 'eight_spoked_asterisk', 'negative_squared_cross_mark', 'globe_with_meridians', 'diamond_shape_with_a_dot_inside', 'm', 'cyclone', 'zzz', 'atm', 'wc', 'wheelchair', 'parking', 'u7a7a', 'sa', 'passport_control', 'customs', 'baggage_claim', 'left_luggage', 'mens', 'womens', 'baby_symbol', 'restroom', 'put_litter_in_its_place', 'cinema', 'signal_strength', 'koko', 'symbols', 'information_source', 'abc', 'abcd', 'capital_abcd', 'ng', 'ok', 'up', 'cool', 'new', 'free', 'zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'keycap_ten', '1234', 'hash', 'asterisk', 'eject', 'arrow_forward', 'pause_button', 'play_pause', 'stop_button', 'record_button', 'track_next', 'track_previous', 'fast_forward', 'rewind', 'arrow_double_up', 'arrow_double_down', 'arrow_backward', 'arrow_up_small', 'arrow_down_small', 'arrow_right', 'arrow_left', 'arrow_up', 'arrow_down', 'arrow_upper_right', 'arrow_lower_right', 'arrow_lower_left', 'arrow_upper_left', 'arrow_up_down', 'left_right_arrow', 'arrow_right_hook', 'leftwards_arrow_with_hook', 'arrow_heading_up', 'arrow_heading_down', 'twisted_rightwards_arrows', 'repeat', 'repeat_one', 'arrows_counterclockwise', 'arrows_clockwise', 'musical_note', 'notes', 'heavy_plus_sign', 'heavy_minus_sign', 'heavy_division_sign', 'heavy_multiplication_x', 'heavy_dollar_sign', 'currency_exchange', 'tm', 'copyright', 'registered', 'wavy_dash', 'curly_loop', 'loop', 'end', 'back', 'on', 'top', 'soon', 'heavy_check_mark', 'ballot_box_with_check', 'radio_button', 'white_circle', 'black_circle', 'red_circle', 'blue_circle', 'small_red_triangle', 'small_red_triangle_down', 'small_orange_diamond', 'small_blue_diamond', 'large_orange_diamond', 'large_blue_diamond', 'white_square_button', 'black_square_button', 'black_small_square', 'white_small_square', 'black_medium_small_square', 'white_medium_small_square', 'black_medium_square', 'white_medium_square', 'black_large_square', 'white_large_square', 'speaker', 'mute', 'sound', 'loud_sound', 'bell', 'no_bell', 'mega', 'loudspeaker', 'speech_left', 'eye_in_speech_bubble', 'speech_balloon', 'thought_balloon', 'anger_right', 'spades', 'clubs', 'hearts', 'diamonds', 'black_joker', 'flower_playing_cards', 'mahjong', 'clock1', 'clock2', 'clock3', 'clock4', 'clock5', 'clock6', 'clock7', 'clock8', 'clock9', 'clock10', 'clock11', 'clock12', 'clock130', 'clock230', 'clock330', 'clock430', 'clock530', 'clock630', 'clock730', 'clock830', 'clock930', 'clock1030', 'clock1130', 'clock1230', 'digit_zero', 'digit_one', 'digit_two', 'digit_three', 'digit_four', 'digit_five', 'digit_six', 'digit_seven', 'digit_eight', 'digit_nine', 'pound_symbol', 'asterisk_symbol', 'female_sign', 'male_sign', 'medical_symbol'],
  activity: ['soccer', 'basketball', 'football', 'baseball', 'softball', 'tennis', 'volleyball', 'rugby_football', '8ball', 'ping_pong', 'badminton', 'goal', 'hockey', 'field_hockey', 'cricket_game', 'lacrosse', 'golf', 'flying_disc', 'bow_and_arrow', 'fishing_pole_and_fish', 'boxing_glove', 'martial_arts_uniform', 'running_shirt_with_sash', 'skateboard', 'ice_skate', 'curling_stone', 'sled', 'ski', 'skier', 'snowboarder', 'person_lifting_weights', 'woman_lifting_weights', 'man_lifting_weights', 'people_wrestling', 'women_wrestling', 'men_wrestling', 'person_doing_cartwheel', 'woman_cartwheeling', 'man_cartwheeling', 'person_bouncing_ball', 'woman_bouncing_ball', 'man_bouncing_ball', 'person_fencing', 'person_playing_handball', 'woman_playing_handball', 'man_playing_handball', 'person_golfing', 'woman_golfing', 'man_golfing', 'horse_racing', 'person_in_lotus_position', 'woman_in_lotus_position', 'man_in_lotus_position', 'person_surfing', 'woman_surfing', 'man_surfing', 'person_swimming', 'woman_swimming', 'man_swimming', 'person_playing_water_polo', 'woman_playing_water_polo', 'man_playing_water_polo', 'person_rowing_boat', 'woman_rowing_boat', 'man_rowing_boat', 'person_climbing', 'woman_climbing', 'man_climbing', 'person_mountain_biking', 'woman_mountain_biking', 'man_mountain_biking', 'person_biking', 'woman_biking', 'man_biking', 'trophy', 'first_place', 'second_place', 'third_place', 'medal', 'military_medal', 'rosette', 'reminder_ribbon', 'ticket', 'tickets', 'circus_tent', 'person_juggling', 'woman_juggling', 'man_juggling', 'performing_arts', 'art', 'clapper', 'microphone', 'headphones', 'musical_score', 'musical_keyboard', 'drum', 'saxophone', 'trumpet', 'guitar', 'violin', 'game_die', 'dart', 'bowling', 'video_game', 'slot_machine'],
  objects: ['watch', 'iphone', 'calling', 'computer', 'keyboard', 'desktop', 'printer', 'mouse_three_button', 'trackball', 'joystick', 'chess_pawn', 'jigsaw', 'compression', 'minidisc', 'floppy_disk', 'cd', 'dvd', 'vhs', 'camera', 'camera_with_flash', 'video_camera', 'movie_camera', 'projector', 'film_frames', 'telephone_receiver', 'telephone', 'pager', 'fax', 'tv', 'radio', 'microphone2', 'level_slider', 'control_knobs', 'stopwatch', 'timer', 'alarm_clock', 'clock', 'hourglass', 'hourglass_flowing_sand', 'satellite', 'compass', 'battery', 'electric_plug', 'magnet', 'bulb', 'flashlight', 'candle', 'fire_extinguisher', 'wastebasket', 'oil', 'money_with_wings', 'dollar', 'yen', 'euro', 'pound', 'moneybag', 'credit_card', 'gem', 'nazar_amulet', 'bricks', 'scales', 'toolbox', 'wrench', 'hammer', 'hammer_pick', 'tools', 'pick', 'nut_and_bolt', 'gear', 'chains', 'gun', 'bomb', 'knife', 'dagger', 'crossed_swords', 'shield', 'smoking', 'coffin', 'urn', 'amphora', 'crystal_ball', 'prayer_beads', 'barber', 'alembic', 'test_tube', 'petri_dish', 'dna', 'abacus', 'telescope', 'microscope', 'hole', 'pill', 'syringe', 'thermometer', 'toilet', 'potable_water', 'shower', 'bathtub', 'bath', 'broom', 'basket', 'roll_of_paper', 'soap', 'sponge', 'squeeze_bottle', 'thread', 'yarn', 'bellhop', 'key', 'key2', 'door', 'couch', 'bed', 'sleeping_accommodation', 'teddy_bear', 'frame_photo', 'shopping_bags', 'shopping_cart', 'gift', 'balloon', 'flags', 'ribbon', 'confetti_ball', 'tada', 'dolls', 'izakaya_lantern', 'wind_chime', 'red_envelope', 'envelope', 'envelope_with_arrow', 'incoming_envelope', 'e-mail', 'love_letter', 'inbox_tray', 'outbox_tray', 'package', 'label', 'mailbox_closed', 'mailbox', 'mailbox_with_mail', 'mailbox_with_no_mail', 'postbox', 'postal_horn', 'scroll', 'page_with_curl', 'page_facing_up', 'receipt', 'bookmark_tabs', 'bar_chart', 'chart_with_upwards_trend', 'chart_with_downwards_trend', 'notepad_spiral', 'calendar_spiral', 'calendar', 'date', 'card_index', 'card_box', 'ballot_box', 'file_cabinet', 'clipboard', 'file_folder', 'open_file_folder', 'dividers', 'newspaper2', 'newspaper', 'notebook', 'notebook_with_decorative_cover', 'ledger', 'closed_book', 'green_book', 'blue_book', 'orange_book', 'books', 'book', 'bookmark', 'link', 'paperclip', 'paperclips', 'triangular_ruler', 'straight_ruler', 'safety_pin', 'pushpin', 'round_pushpin', 'scissors', 'pen_ballpoint', 'pen_fountain', 'black_nib', 'paintbrush', 'crayon', 'pencil', 'pencil2', 'mag', 'mag_right', 'lock_with_ink_pen', 'closed_lock_with_key', 'lock', 'unlock'],
  nature: ['dog', 'cat', 'mouse', 'hamster', 'rabbit', 'fox', 'raccoon', 'bear', 'panda_face', 'kangaroo', 'badger', 'koala', 'tiger', 'lion_face', 'cow', 'pig', 'pig_nose', 'frog', 'monkey_face', 'see_no_evil', 'hear_no_evil', 'speak_no_evil', 'monkey', 'chicken', 'penguin', 'bird', 'baby_chick', 'hatching_chick', 'hatched_chick', 'duck', 'swan', 'eagle', 'owl', 'parrot', 'peacock', 'bat', 'wolf', 'boar', 'horse', 'unicorn', 'bee', 'bug', 'butterfly', 'snail', 'shell', 'beetle', 'ant', 'cricket', 'spider', 'spider_web', 'scorpion', 'mosquito', 'microbe', 'turtle', 'snake', 'lizard', 't_rex', 'sauropod', 'octopus', 'squid', 'shrimp', 'crab', 'lobster', 'blowfish', 'tropical_fish', 'fish', 'dolphin', 'whale', 'whale2', 'shark', 'crocodile', 'tiger2', 'leopard', 'zebra', 'gorilla', 'elephant', 'rhino', 'hippopotamus', 'dromedary_camel', 'camel', 'giraffe', 'llama', 'water_buffalo', 'ox', 'cow2', 'racehorse', 'pig2', 'ram', 'sheep', 'goat', 'deer', 'dog2', 'poodle', 'cat2', 'rooster', 'turkey', 'dove', 'rabbit2', 'mouse2', 'rat', 'chipmunk', 'hedgehog', 'feet', 'dragon', 'dragon_face', 'cactus', 'christmas_tree', 'evergreen_tree', 'deciduous_tree', 'palm_tree', 'seedling', 'herb', 'shamrock', 'four_leaf_clover', 'bamboo', 'tanabata_tree', 'leaves', 'fallen_leaf', 'maple_leaf', 'mushroom', 'ear_of_rice', 'bouquet', 'tulip', 'rose', 'wilted_rose', 'hibiscus', 'cherry_blossom', 'blossom', 'sunflower', 'sun_with_face', 'full_moon_with_face', 'first_quarter_moon_with_face', 'last_quarter_moon_with_face', 'new_moon_with_face', 'full_moon', 'waning_gibbous_moon', 'last_quarter_moon', 'waning_crescent_moon', 'new_moon', 'waxing_crescent_moon', 'first_quarter_moon', 'waxing_gibbous_moon', 'crescent_moon', 'earth_americas', 'earth_africa', 'earth_asia', 'dizzy', 'star', 'star2', 'sparkles', 'zap', 'comet', 'boom', 'fire', 'cloud_tornado', 'rainbow', 'sunny', 'white_sun_small_cloud', 'partly_sunny', 'white_sun_cloud', 'cloud', 'white_sun_rain_cloud', 'cloud_rain', 'thunder_cloud_rain', 'cloud_lightning', 'cloud_snow', 'snowflake', 'snowman2', 'snowman', 'wind_blowing_face', 'dash', 'droplet', 'sweat_drops', 'umbrella', 'umbrella2', 'ocean', 'fog'],
  food: ['green_apple', 'apple', 'pear', 'tangerine', 'lemon', 'banana', 'watermelon', 'grapes', 'strawberry', 'melon', 'cherries', 'peach', 'mango', 'pineapple', 'coconut', 'kiwi', 'tomato', 'eggplant', 'avocado', 'broccoli', 'leafy_green', 'cucumber', 'hot_pepper', 'corn', 'carrot', 'potato', 'sweet_potato', 'croissant', 'bread', 'french_bread', 'pretzel', 'bagel', 'cheese', 'egg', 'cooking', 'pancakes', 'bacon', 'cut_of_meat', 'poultry_leg', 'meat_on_bone', 'hotdog', 'hamburger', 'fries', 'pizza', 'sandwich', 'stuffed_flatbread', 'taco', 'burrito', 'salad', 'shallow_pan_of_food', 'canned_food', 'spaghetti', 'ramen', 'stew', 'curry', 'sushi', 'bento', 'fried_shrimp', 'rice_ball', 'rice', 'rice_cracker', 'fish_cake', 'fortune_cookie', 'oden', 'dango', 'shaved_ice', 'ice_cream', 'icecream', 'pie', 'cake', 'birthday', 'moon_cake', 'cupcake', 'custard', 'lollipop', 'candy', 'chocolate_bar', 'popcorn', 'salt', 'doughnut', 'dumpling', 'cookie', 'chestnut', 'peanuts', 'honey_pot', 'milk', 'baby_bottle', 'coffee', 'tea', 'cup_with_straw', 'sake', 'beer', 'beers', 'champagne_glass', 'wine_glass', 'tumbler_glass', 'cocktail', 'tropical_drink', 'champagne', 'spoon', 'fork_and_knife', 'fork_knife_plate', 'bowl_with_spoon', 'takeout_box', 'chopsticks'],
  people: ['grinning', 'smiley', 'smile', 'grin', 'laughing', 'sweat_smile', 'joy', 'rofl', 'relaxed', 'blush', 'innocent', 'slight_smile', 'upside_down', 'wink', 'relieved', 'heart_eyes', 'kissing_heart', 'smiling_face_with_3_hearts', 'kissing', 'kissing_smiling_eyes', 'kissing_closed_eyes', 'yum', 'stuck_out_tongue', 'stuck_out_tongue_closed_eyes', 'stuck_out_tongue_winking_eye', 'zany_face', 'face_with_raised_eyebrow', 'face_with_monocle', 'nerd', 'sunglasses', 'star_struck', 'partying_face', 'smirk', 'unamused', 'disappointed', 'pensive', 'worried', 'confused', 'slight_frown', 'frowning2', 'persevere', 'confounded', 'tired_face', 'weary', 'cry', 'sob', 'triumph', 'angry', 'rage', 'face_with_symbols_over_mouth', 'exploding_head', 'flushed', 'scream', 'fearful', 'cold_sweat', 'hot_face', 'cold_face', 'pleading_face', 'disappointed_relieved', 'sweat', 'hugging', 'thinking', 'face_with_hand_over_mouth', 'shushing_face', 'lying_face', 'no_mouth', 'neutral_face', 'expressionless', 'grimacing', 'rolling_eyes', 'hushed', 'frowning', 'anguished', 'open_mouth', 'astonished', 'sleeping', 'drooling_face', 'sleepy', 'dizzy_face', 'zipper_mouth', 'woozy_face', 'nauseated_face', 'face_vomiting', 'sneezing_face', 'mask', 'thermometer_face', 'head_bandage', 'money_mouth', 'cowboy', 'smiling_imp', 'imp', 'japanese_ogre', 'japanese_goblin', 'clown', 'poop', 'ghost', 'skull', 'skull_crossbones', 'alien', 'space_invader', 'robot', 'jack_o_lantern', 'smiley_cat', 'smile_cat', 'joy_cat', 'heart_eyes_cat', 'smirk_cat', 'kissing_cat', 'scream_cat', 'crying_cat_face', 'pouting_cat', 'palms_up_together', 'open_hands', 'raised_hands', 'clap', 'handshake', 'thumbsup', 'thumbsdown', 'punch', 'fist', 'left_facing_fist', 'right_facing_fist', 'fingers_crossed', 'v', 'love_you_gesture', 'metal', 'ok_hand', 'point_left', 'point_right', 'point_up_2', 'point_down', 'point_up', 'raised_hand', 'raised_back_of_hand', 'hand_splayed', 'vulcan', 'wave', 'call_me', 'muscle', 'leg', 'foot', 'middle_finger', 'writing_hand', 'pray', 'ring', 'lipstick', 'kiss', 'lips', 'tongue', 'ear', 'nose', 'footprints', 'eye', 'eyes', 'brain', 'bone', 'tooth', 'speaking_head', 'bust_in_silhouette', 'busts_in_silhouette', 'baby', 'girl', 'child', 'boy', 'woman', 'adult', 'man', 'blond_haired_person', 'blond-haired_woman', 'blond-haired_man', 'woman_red_haired', 'man_red_haired', 'woman_curly_haired', 'man_curly_haired', 'woman_white_haired', 'man_white_haired', 'woman_bald', 'man_bald', 'bearded_person', 'older_woman', 'older_adult', 'older_man', 'man_with_chinese_cap', 'person_wearing_turban', 'woman_wearing_turban', 'man_wearing_turban', 'woman_with_headscarf', 'police_officer', 'woman_police_officer', 'man_police_officer', 'construction_worker', 'woman_construction_worker', 'man_construction_worker', 'guard', 'woman_guard', 'man_guard', 'detective', 'woman_detective', 'man_detective', 'woman_health_worker', 'man_health_worker', 'woman_farmer', 'man_farmer', 'woman_cook', 'man_cook', 'woman_student', 'man_student', 'woman_singer', 'man_singer', 'woman_teacher', 'man_teacher', 'woman_factory_worker', 'man_factory_worker', 'woman_technologist', 'man_technologist', 'woman_office_worker', 'man_office_worker', 'woman_mechanic', 'man_mechanic', 'woman_scientist', 'man_scientist', 'woman_artist', 'man_artist', 'woman_firefighter', 'man_firefighter', 'woman_pilot', 'man_pilot', 'woman_astronaut', 'man_astronaut', 'woman_judge', 'man_judge', 'bride_with_veil', 'man_in_tuxedo', 'princess', 'prince', 'mrs_claus', 'santa', 'superhero', 'woman_superhero', 'man_superhero', 'supervillain', 'woman_supervillain', 'man_supervillain', 'mage', 'woman_mage', 'man_mage', 'elf', 'woman_elf', 'man_elf', 'vampire', 'woman_vampire', 'man_vampire', 'zombie', 'woman_zombie', 'man_zombie', 'genie', 'woman_genie', 'man_genie', 'merperson', 'mermaid', 'merman', 'fairy', 'woman_fairy', 'man_fairy', 'angel', 'pregnant_woman', 'breast_feeding', 'person_bowing', 'woman_bowing', 'man_bowing', 'person_tipping_hand', 'woman_tipping_hand', 'man_tipping_hand', 'person_gesturing_no', 'woman_gesturing_no', 'man_gesturing_no', 'person_gesturing_ok', 'woman_gesturing_ok', 'man_gesturing_ok', 'person_raising_hand', 'woman_raising_hand', 'man_raising_hand', 'person_facepalming', 'woman_facepalming', 'man_facepalming', 'person_shrugging', 'woman_shrugging', 'man_shrugging', 'person_pouting', 'woman_pouting', 'man_pouting', 'person_frowning', 'woman_frowning', 'man_frowning', 'person_getting_haircut', 'woman_getting_haircut', 'man_getting_haircut', 'person_getting_massage', 'woman_getting_face_massage', 'man_getting_face_massage', 'person_in_steamy_room', 'woman_in_steamy_room', 'man_in_steamy_room', 'nail_care', 'selfie', 'dancer', 'man_dancing', 'people_with_bunny_ears_partying', 'women_with_bunny_ears_partying', 'men_with_bunny_ears_partying', 'levitate', 'person_walking', 'woman_walking', 'man_walking', 'person_running', 'woman_running', 'man_running', 'couple', 'two_women_holding_hands', 'two_men_holding_hands', 'couple_with_heart', 'couple_with_heart_woman_man', 'couple_ww', 'couple_mm', 'couplekiss', 'kiss_woman_man', 'kiss_ww', 'kiss_mm', 'family', 'family_man_woman_boy', 'family_mwg', 'family_mwgb', 'family_mwbb', 'family_mwgg', 'family_wwb', 'family_wwg', 'family_wwgb', 'family_wwbb', 'family_wwgg', 'family_mmb', 'family_mmg', 'family_mmgb', 'family_mmbb', 'family_mmgg', 'family_woman_boy', 'family_woman_girl', 'family_woman_girl_boy', 'family_woman_boy_boy', 'family_woman_girl_girl', 'family_man_boy', 'family_man_girl', 'family_man_girl_boy', 'family_man_boy_boy', 'family_man_girl_girl', 'coat', 'womans_clothes', 'shirt', 'jeans', 'necktie', 'dress', 'bikini', 'kimono', 'lab_coat', 'high_heel', 'sandal', 'boot', 'mans_shoe', 'athletic_shoe', 'hiking_boot', 'womans_flat_shoe', 'socks', 'gloves', 'scarf', 'tophat', 'billed_cap', 'womans_hat', 'mortar_board', 'helmet_with_cross', 'crown', 'pouch', 'purse', 'handbag', 'briefcase', 'school_satchel', 'eyeglasses', 'dark_sunglasses', 'goggles', 'closed_umbrella', 'red_haired', 'curly_haired', 'white_haired', 'bald'],
  regional: ['regional_indicator_z', 'regional_indicator_y', 'regional_indicator_x', 'regional_indicator_w', 'regional_indicator_v', 'regional_indicator_u', 'regional_indicator_t', 'regional_indicator_s', 'regional_indicator_r', 'regional_indicator_q', 'regional_indicator_p', 'regional_indicator_o', 'regional_indicator_n', 'regional_indicator_m', 'regional_indicator_l', 'regional_indicator_k', 'regional_indicator_j', 'regional_indicator_i', 'regional_indicator_h', 'regional_indicator_g', 'regional_indicator_f', 'regional_indicator_e', 'regional_indicator_d', 'regional_indicator_c', 'regional_indicator_b', 'regional_indicator_a'],
  travel: ['red_car', 'taxi', 'blue_car', 'bus', 'trolleybus', 'race_car', 'police_car', 'ambulance', 'fire_engine', 'minibus', 'truck', 'articulated_lorry', 'tractor', 'scooter', 'bike', 'motor_scooter', 'motorcycle', 'rotating_light', 'oncoming_police_car', 'oncoming_bus', 'oncoming_automobile', 'oncoming_taxi', 'aerial_tramway', 'mountain_cableway', 'suspension_railway', 'railway_car', 'train', 'mountain_railway', 'monorail', 'bullettrain_side', 'bullettrain_front', 'light_rail', 'steam_locomotive', 'train2', 'metro', 'tram', 'station', 'airplane', 'airplane_departure', 'airplane_arriving', 'airplane_small', 'seat', 'luggage', 'satellite_orbital', 'rocket', 'flying_saucer', 'helicopter', 'canoe', 'sailboat', 'speedboat', 'motorboat', 'cruise_ship', 'ferry', 'ship', 'anchor', 'fuelpump', 'construction', 'vertical_traffic_light', 'traffic_light', 'busstop', 'map', 'moyai', 'statue_of_liberty', 'tokyo_tower', 'european_castle', 'japanese_castle', 'stadium', 'ferris_wheel', 'roller_coaster', 'carousel_horse', 'fountain', 'beach_umbrella', 'beach', 'island', 'desert', 'volcano', 'mountain', 'mountain_snow', 'mount_fuji', 'camping', 'tent', 'house', 'house_with_garden', 'homes', 'house_abandoned', 'construction_site', 'factory', 'office', 'department_store', 'post_office', 'european_post_office', 'hospital', 'bank', 'hotel', 'convenience_store', 'school', 'love_hotel', 'wedding', 'classical_building', 'church', 'mosque', 'synagogue', 'kaaba', 'shinto_shrine', 'railway_track', 'motorway', 'japan', 'rice_scene', 'park', 'sunrise', 'sunrise_over_mountains', 'stars', 'sparkler', 'fireworks', 'firecracker', 'city_sunset', 'city_dusk', 'cityscape', 'night_with_stars', 'milky_way', 'bridge_at_night', 'foggy'],
  flags: ['flag_white', 'flag_black', 'checkered_flag', 'triangular_flag_on_post', 'rainbow_flag', 'pirate_flag', 'flag_af', 'flag_ax', 'flag_al', 'flag_dz', 'flag_as', 'flag_ad', 'flag_ao', 'flag_ai', 'flag_aq', 'flag_ag', 'flag_ar', 'flag_am', 'flag_aw', 'flag_au', 'flag_at', 'flag_az', 'flag_bs', 'flag_bh', 'flag_bd', 'flag_bb', 'flag_by', 'flag_be', 'flag_bz', 'flag_bj', 'flag_bm', 'flag_bt', 'flag_bo', 'flag_ba', 'flag_bw', 'flag_br', 'flag_io', 'flag_vg', 'flag_bn', 'flag_bg', 'flag_bf', 'flag_bi', 'flag_kh', 'flag_cm', 'flag_ca', 'flag_ic', 'flag_cv', 'flag_bq', 'flag_ky', 'flag_cf', 'flag_td', 'flag_cl', 'flag_cn', 'flag_cx', 'flag_cc', 'flag_co', 'flag_km', 'flag_cg', 'flag_cd', 'flag_ck', 'flag_cr', 'flag_ci', 'flag_hr', 'flag_cu', 'flag_cw', 'flag_cy', 'flag_cz', 'flag_dk', 'flag_dj', 'flag_dm', 'flag_do', 'flag_ec', 'flag_eg', 'flag_sv', 'flag_gq', 'flag_er', 'flag_ee', 'flag_et', 'flag_eu', 'flag_fk', 'flag_fo', 'flag_fj', 'flag_fi', 'flag_fr', 'flag_gf', 'flag_pf', 'flag_tf', 'flag_ga', 'flag_gm', 'flag_ge', 'flag_de', 'flag_gh', 'flag_gi', 'flag_gr', 'flag_gl', 'flag_gd', 'flag_gp', 'flag_gu', 'flag_gt', 'flag_gg', 'flag_gn', 'flag_gw', 'flag_gy', 'flag_ht', 'flag_hn', 'flag_hk', 'flag_hu', 'flag_is', 'flag_in', 'flag_id', 'flag_ir', 'flag_iq', 'flag_ie', 'flag_im', 'flag_il', 'flag_it', 'flag_jm', 'flag_jp', 'crossed_flags', 'flag_je', 'flag_jo', 'flag_kz', 'flag_ke', 'flag_ki', 'flag_xk', 'flag_kw', 'flag_kg', 'flag_la', 'flag_lv', 'flag_lb', 'flag_ls', 'flag_lr', 'flag_ly', 'flag_li', 'flag_lt', 'flag_lu', 'flag_mo', 'flag_mk', 'flag_mg', 'flag_mw', 'flag_my', 'flag_mv', 'flag_ml', 'flag_mt', 'flag_mh', 'flag_mq', 'flag_mr', 'flag_mu', 'flag_yt', 'flag_mx', 'flag_fm', 'flag_md', 'flag_mc', 'flag_mn', 'flag_me', 'flag_ms', 'flag_ma', 'flag_mz', 'flag_mm', 'flag_na', 'flag_nr', 'flag_np', 'flag_nl', 'flag_nc', 'flag_nz', 'flag_ni', 'flag_ne', 'flag_ng', 'flag_nu', 'flag_nf', 'flag_kp', 'flag_mp', 'flag_no', 'flag_om', 'flag_pk', 'flag_pw', 'flag_ps', 'flag_pa', 'flag_pg', 'flag_py', 'flag_pe', 'flag_ph', 'flag_pn', 'flag_pl', 'flag_pt', 'flag_pr', 'flag_qa', 'flag_re', 'flag_ro', 'flag_ru', 'flag_rw', 'flag_ws', 'flag_sm', 'flag_st', 'flag_sa', 'flag_sn', 'flag_rs', 'flag_sc', 'flag_sl', 'flag_sg', 'flag_sx', 'flag_sk', 'flag_si', 'flag_gs', 'flag_sb', 'flag_so', 'flag_za', 'flag_kr', 'flag_ss', 'flag_es', 'flag_lk', 'flag_bl', 'flag_sh', 'flag_kn', 'flag_lc', 'flag_pm', 'flag_vc', 'flag_sd', 'flag_sr', 'flag_sz', 'flag_se', 'flag_ch', 'flag_sy', 'flag_tw', 'flag_tj', 'flag_tz', 'flag_th', 'flag_tl', 'flag_tg', 'flag_tk', 'flag_to', 'flag_tt', 'flag_tn', 'flag_tr', 'flag_tm', 'flag_tc', 'flag_vi', 'flag_tv', 'flag_ug', 'flag_ua', 'flag_ae', 'flag_gb', 'england', 'scotland', 'wales', 'flag_us', 'flag_uy', 'flag_uz', 'flag_vu', 'flag_va', 'flag_ve', 'flag_vn', 'flag_wf', 'flag_eh', 'flag_ye', 'flag_zm', 'flag_zw', 'flag_ac', 'flag_bv', 'flag_cp', 'flag_ea', 'flag_dg', 'flag_hm', 'flag_mf', 'flag_sj', 'flag_ta', 'flag_um', 'united_nations'],
  modifier: ['tone1', 'tone2', 'tone3', 'tone4', 'tone5']
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emojioneRender.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-emojione/lib/emojioneRender.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  emojioneRender: function () {
    return emojioneRender;
  },
  emojioneRenderFromShort: function () {
    return emojioneRenderFromShort;
  }
});
var emojione;
module.link("emojione", {
  "default": function (v) {
    emojione = v;
  }
}, 0);

function emojioneRender(message) {
  return emojione.toImage(message);
}

function emojioneRenderFromShort(message) {
  return emojione.shortnameToImage(message);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-emojione/lib/rocketchat.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var emojione;
module.link("emojione", {
  "default": function (v) {
    emojione = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var mem;
module.link("mem", {
  "default": function (v) {
    mem = v;
  }
}, 3);
var emojioneRender, emojioneRenderFromShort;
module.link("./emojioneRender", {
  emojioneRender: function (v) {
    emojioneRender = v;
  },
  emojioneRenderFromShort: function (v) {
    emojioneRenderFromShort = v;
  }
}, 4);
var emojisByCategory, emojiCategories, toneList;
module.link("./emojiPicker", {
  emojisByCategory: function (v) {
    emojisByCategory = v;
  },
  emojiCategories: function (v) {
    emojiCategories = v;
  },
  toneList: function (v) {
    toneList = v;
  }
}, 5);
var emoji;
module.link("../../emoji", {
  emoji: function (v) {
    emoji = v;
  }
}, 6);
var getUserPreference;
module.link("../../utils", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 7);
// TODO remove fix below when issue is solved: https://github.com/joypixels/emojione/issues/617
// add missing emojis not provided by JS object, but included on emoji.json
emojione.shortnames += '|:tm:|:copyright:|:registered:|:digit_zero:|:digit_one:|:digit_two:|:digit_three:|:digit_four:|:digit_five:|:digit_six:|:digit_seven:|:digit_eight:|:digit_nine:|:pound_symbol:|:asterisk_symbol:';
emojione.regShortNames = new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|(" + emojione.shortnames + ")", 'gi');
emojione.emojioneList[':tm:'] = {
  uc_base: '2122',
  uc_output: '2122-fe0f',
  uc_match: '2122-fe0f',
  uc_greedy: '2122-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':copyright:'] = {
  uc_base: '00a9',
  uc_output: '00a9-f0ef',
  uc_match: '00a9-fe0f',
  uc_greedy: '00a9-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':registered:'] = {
  uc_base: '00ae',
  uc_output: '00ae-fe0f',
  uc_match: '00ae-fe0f',
  uc_greedy: '00ae-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_zero:'] = {
  uc_base: '0030',
  uc_output: '0030-fe0f',
  uc_match: '0030-fe0f',
  uc_greedy: '0030-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_one:'] = {
  uc_base: '0031',
  uc_output: '0031-fe0f',
  uc_match: '0031-fe0f',
  uc_greedy: '0031-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_two:'] = {
  uc_base: '0032',
  uc_output: '0032-fe0f',
  uc_match: '0032-fe0f',
  uc_greedy: '0032-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_three:'] = {
  uc_base: '0033',
  uc_output: '0033-fe0f',
  uc_match: '0033-fe0f',
  uc_greedy: '0033-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_four:'] = {
  uc_base: '0034',
  uc_output: '0034-fe0f',
  uc_match: '0034-fe0f',
  uc_greedy: '0034-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_five:'] = {
  uc_base: '0035',
  uc_output: '0035-fe0f',
  uc_match: '0035-fe0f',
  uc_greedy: '0035-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_six:'] = {
  uc_base: '0036',
  uc_output: '0036-fe0f',
  uc_match: '0036-fe0f',
  uc_greedy: '0036-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_seven:'] = {
  uc_base: '0037',
  uc_output: '0037-fe0f',
  uc_match: '0037-fe0f',
  uc_greedy: '0037-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_eight:'] = {
  uc_base: '0038',
  uc_output: '0038-fe0f',
  uc_match: '0038-fe0f',
  uc_greedy: '0038-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':digit_nine:'] = {
  uc_base: '0039',
  uc_output: '0039-fe0f',
  uc_match: '0039-fe0f',
  uc_greedy: '0039-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':pound_symbol:'] = {
  uc_base: '0023',
  uc_output: '0023-fe0f',
  uc_match: '0023-fe0f',
  uc_greedy: '0023-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
};
emojione.emojioneList[':asterisk_symbol:'] = {
  uc_base: '002a',
  uc_output: '002a-fe0f',
  uc_match: '002a-fe0f',
  uc_greedy: '002a-fe0f',
  shortnames: [],
  category: 'symbols',
  emojiPackage: 'emojione'
}; // end fix
// fix for :+1: - had to replace all function that does its conversion: https://github.com/joypixels/emojione/blob/4.5.0/lib/js/emojione.js#L249

(function (ns) {
  ns.shortnameConversionMap = mem(ns.shortnameConversionMap, {
    maxAge: 1000
  });
  ns.unicodeCharRegex = mem(ns.unicodeCharRegex, {
    maxAge: 1000
  });
  var convertShortName = mem(function (shortname) {
    // the fix is basically adding this .replace(/[+]/g, '\\$&')
    if (typeof shortname === 'undefined' || shortname === '' || ns.shortnames.indexOf(shortname.replace(/[+]/g, '\\$&')) === -1) {
      // if the shortname doesnt exist just return the entire match
      return shortname;
    } // map shortname to parent


    if (!ns.emojioneList[shortname]) {
      for (var _emoji in meteorBabelHelpers.sanitizeForInObject(ns.emojioneList)) {
        if (!ns.emojioneList.hasOwnProperty(_emoji) || _emoji === '') {
          continue;
        }

        if (ns.emojioneList[_emoji].shortnames.indexOf(shortname) === -1) {
          continue;
        }

        shortname = _emoji;
        break;
      }
    }

    var unicode = ns.emojioneList[shortname].uc_output;
    var fname = ns.emojioneList[shortname].uc_base;
    var category = fname.indexOf('-1f3f') >= 0 ? 'diversity' : ns.emojioneList[shortname].category;
    var title = ns.imageTitleTag ? "title=\"" + shortname + "\"" : ''; // const size = ns.spriteSize === '32' || ns.spriteSize === '64' ? ns.spriteSize : '32';
    // if the emoji path has been set, we'll use the provided path, otherwise we'll use the default path

    var ePath = ns.defaultPathPNG !== ns.imagePathPNG ? ns.imagePathPNG : ns.defaultPathPNG + ns.emojiSize + "/"; // depending on the settings, we'll either add the native unicode as the alt tag, otherwise the shortname

    var alt = ns.unicodeAlt ? ns.convert(unicode.toUpperCase()) : shortname;

    if (ns.sprites) {
      return "<span class=\"emojione emojione-" + category + " _" + fname + "\" " + title + ">" + alt + "</span>";
    }

    return "<img class=\"emojione\" alt=\"" + alt + "\" " + title + " src=\"" + ePath + fname + ns.fileExtension + "\"/>";
  }, {
    maxAge: 1000
  });
  var convertUnicode = mem(function (entire, m1, m2, m3) {
    var mappedUnicode = ns.mapUnicodeToShort();

    if (typeof m3 === 'undefined' || m3 === '' || !(ns.unescapeHTML(m3) in ns.asciiList)) {
      // if the ascii doesnt exist just return the entire match
      return entire;
    }

    m3 = ns.unescapeHTML(m3);
    var unicode = ns.asciiList[m3];
    var shortname = mappedUnicode[unicode];
    var category = unicode.indexOf('-1f3f') >= 0 ? 'diversity' : ns.emojioneList[shortname].category;
    var title = ns.imageTitleTag ? "title=\"" + ns.escapeHTML(m3) + "\"" : ''; // const size = ns.spriteSize === '32' || ns.spriteSize === '64' ? ns.spriteSize : '32';
    // if the emoji path has been set, we'll use the provided path, otherwise we'll use the default path

    var ePath = ns.defaultPathPNG !== ns.imagePathPNG ? ns.imagePathPNG : ns.defaultPathPNG + ns.emojiSize + "/"; // depending on the settings, we'll either add the native unicode as the alt tag, otherwise the shortname

    var alt = ns.unicodeAlt ? ns.convert(unicode.toUpperCase()) : ns.escapeHTML(m3);

    if (ns.sprites) {
      return m2 + "<span class=\"emojione emojione-" + category + " _" + unicode + "\"  " + title + ">" + alt + "</span>";
    }

    return m2 + "<img class=\"emojione\" alt=\"" + alt + "\" " + title + " src=\"" + ePath + unicode + ns.fileExtension + "\"/>";
  }, {
    maxAge: 1000,
    cacheKey: JSON.stringify
  });

  ns.shortnameToImage = function (str) {
    // replace regular shortnames first
    str = str.replace(ns.regShortNames, convertShortName); // if ascii smileys are turned on, then we'll replace them!

    if (ns.ascii) {
      var asciiRX = ns.riskyMatchAscii ? ns.regAsciiRisky : ns.regAscii;
      return str.replace(asciiRX, convertUnicode);
    }

    return str;
  };
})(emojione);

emoji.packages.emojione = emojione;
emoji.packages.emojione.sprites = true;
emoji.packages.emojione.emojisByCategory = emojisByCategory;
emoji.packages.emojione.emojiCategories = emojiCategories;
emoji.packages.emojione.toneList = toneList;
emoji.packages.emojione.render = emojioneRender;
emoji.packages.emojione.renderPicker = emojioneRenderFromShort; // http://stackoverflow.com/a/26990347 function isSet() from Gajus

function isSetNotNull(fn) {
  var value;

  try {
    value = fn();
  } catch (e) {
    value = null;
  }

  return value !== null && value !== undefined;
} // RocketChat.emoji.list is the collection of emojis from all emoji packages


for (var key in meteorBabelHelpers.sanitizeForInObject(emojione.emojioneList)) {
  if (emojione.emojioneList.hasOwnProperty(key)) {
    (function () {
      var currentEmoji = emojione.emojioneList[key];
      currentEmoji.emojiPackage = 'emojione';
      emoji.list[key] = currentEmoji;

      if (currentEmoji.shortnames) {
        currentEmoji.shortnames.forEach(function (shortname) {
          emoji.list[shortname] = currentEmoji;
        });
      }
    })();
  }
} // Additional settings -- ascii emojis


Meteor.startup(function () {
  Tracker.autorun(function () {
    if (isSetNotNull(function () {
      return emoji.packages.emojione;
    })) {
      if (isSetNotNull(function () {
        return getUserPreference(Meteor.userId(), 'convertAsciiEmoji');
      })) {
        emoji.packages.emojione.ascii = getUserPreference(Meteor.userId(), 'convertAsciiEmoji');
      } else {
        emoji.packages.emojione.ascii = true;
      }
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"emojione-sprites.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-emojione/client/emojione-sprites.css                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/emoji-emojione/client/index.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/rocketchat");
module.link("./emojione-sprites.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"github-enterprise":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/github-enterprise/lib/common.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth: function (v) {
    CustomOAuth = v;
  }
}, 2);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);
// GitHub Enterprise Server CallBack URL needs to be http(s)://{rocketchat.server}[:port]/_oauth/github_enterprise
// In RocketChat -> Administration the URL needs to be http(s)://{github.enterprise.server}/
var config = {
  serverURL: '',
  identityPath: '/api/v3/user',
  authorizePath: '/login/oauth/authorize',
  tokenPath: '/login/oauth/access_token',
  addAutopublishFields: {
    forLoggedInUser: ['services.github-enterprise'],
    forOtherUsers: ['services.github-enterprise.username']
  }
};
var GitHubEnterprise = new CustomOAuth('github_enterprise', config);

if (Meteor.isServer) {
  Meteor.startup(function () {
    settings.get('API_GitHub_Enterprise_URL', function (key, value) {
      config.serverURL = value;
      GitHubEnterprise.configure(config);
    });
  });
} else {
  Meteor.startup(function () {
    Tracker.autorun(function () {
      if (settings.get('API_GitHub_Enterprise_URL')) {
        config.serverURL = settings.get('API_GitHub_Enterprise_URL');
        GitHubEnterprise.configure(config);
      }
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"github-enterprise-login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/github-enterprise/client/github-enterprise-login-button.css                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/github-enterprise/client/index.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./github-enterprise-login-button.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"gitlab":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/gitlab/lib/common.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth: function (v) {
    CustomOAuth = v;
  }
}, 4);
var config = {
  serverURL: 'https://gitlab.com',
  identityPath: '/api/v4/user',
  scope: 'read_user',
  mergeUsers: false,
  addAutopublishFields: {
    forLoggedInUser: ['services.gitlab'],
    forOtherUsers: ['services.gitlab.username']
  },
  accessTokenParam: 'access_token'
};
var Gitlab = new CustomOAuth('gitlab', config);

if (Meteor.isServer) {
  Meteor.startup(function () {
    var updateConfig = _.debounce(function () {
      config.serverURL = settings.get('API_Gitlab_URL').trim().replace(/\/*$/, '') || config.serverURL;
      config.identityPath = settings.get('Accounts_OAuth_Gitlab_identity_path') || config.identityPath;
      config.mergeUsers = Boolean(settings.get('Accounts_OAuth_Gitlab_merge_users'));
      Gitlab.configure(config);
    }, 300);

    settings.get('API_Gitlab_URL', updateConfig);
    settings.get('Accounts_OAuth_Gitlab_identity_path', updateConfig);
    settings.get('Accounts_OAuth_Gitlab_merge_users', updateConfig);
  });
} else {
  Meteor.startup(function () {
    Tracker.autorun(function () {
      var anyChange = false;

      if (settings.get('API_Gitlab_URL')) {
        config.serverURL = settings.get('API_Gitlab_URL').trim().replace(/\/*$/, '');
        anyChange = true;
      }

      if (settings.get('Accounts_OAuth_Gitlab_identity_path')) {
        config.identityPath = settings.get('Accounts_OAuth_Gitlab_identity_path').trim() || config.identityPath;
        anyChange = true;
      }

      if (settings.get('Accounts_OAuth_Gitlab_merge_users')) {
        config.mergeUsers = true;
        anyChange = true;
      }

      if (anyChange) {
        Gitlab.configure(config);
      }
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"gitlab-login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/gitlab/client/gitlab-login-button.css                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/gitlab/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./gitlab-login-button.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"importer":{"lib":{"ImporterInfo.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer/lib/ImporterInfo.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ImporterInfo: function () {
    return ImporterInfo;
  }
});

var ImporterInfo =
/**
 * Creates a new class which contains information about the importer.
 *
 * @param {string} key The unique key of this importer.
 * @param {string} name The i18n name.
 * @param {string} mimeType The type of file it expects.
 * @param {{ href: string, text: string }[]} warnings An array of warning objects. `{ href, text }`
 */
function () {
  function ImporterInfo(key) {
    var name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
    var mimeType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
    var warnings = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
    this.key = key;
    this.name = name;
    this.mimeType = mimeType;
    this.warnings = warnings;
    this.importer = undefined;
    this.instance = undefined;
  }

  return ImporterInfo;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ImporterProgressStep.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer/lib/ImporterProgressStep.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ProgressStep: function () {
    return ProgressStep;
  },
  ImportWaitingStates: function () {
    return ImportWaitingStates;
  },
  ImportFileReadyStates: function () {
    return ImportFileReadyStates;
  },
  ImportPreparingStartedStates: function () {
    return ImportPreparingStartedStates;
  },
  ImportingStartedStates: function () {
    return ImportingStartedStates;
  },
  ImportingDoneStates: function () {
    return ImportingDoneStates;
  },
  ImportingErrorStates: function () {
    return ImportingErrorStates;
  }
});
var ProgressStep = Object.freeze({
  NEW: 'importer_new',
  UPLOADING: 'importer_uploading',
  DOWNLOADING_FILE: 'importer_downloading_file',
  FILE_LOADED: 'importer_file_loaded',
  PREPARING_STARTED: 'importer_preparing_started',
  PREPARING_USERS: 'importer_preparing_users',
  PREPARING_CHANNELS: 'importer_preparing_channels',
  PREPARING_MESSAGES: 'importer_preparing_messages',
  USER_SELECTION: 'importer_user_selection',
  IMPORTING_STARTED: 'importer_importing_started',
  IMPORTING_USERS: 'importer_importing_users',
  IMPORTING_CHANNELS: 'importer_importing_channels',
  IMPORTING_MESSAGES: 'importer_importing_messages',
  IMPORTING_FILES: 'importer_importing_files',
  FINISHING: 'importer_finishing',
  DONE: 'importer_done',
  ERROR: 'importer_import_failed',
  CANCELLED: 'importer_import_cancelled'
});
var ImportWaitingStates = [ProgressStep.NEW, ProgressStep.UPLOADING, ProgressStep.DOWNLOADING_FILE];
var ImportFileReadyStates = [ProgressStep.FILE_LOADED];
var ImportPreparingStartedStates = [ProgressStep.PREPARING_STARTED, ProgressStep.PREPARING_USERS, ProgressStep.PREPARING_CHANNELS, ProgressStep.PREPARING_MESSAGES];
var ImportingStartedStates = [ProgressStep.IMPORTING_STARTED, ProgressStep.IMPORTING_USERS, ProgressStep.IMPORTING_CHANNELS, ProgressStep.IMPORTING_MESSAGES, ProgressStep.IMPORTING_FILES, ProgressStep.FINISHING];
var ImportingDoneStates = [ProgressStep.DONE, ProgressStep.ERROR, ProgressStep.CANCELLED];
var ImportingErrorStates = [ProgressStep.ERROR, ProgressStep.CANCELLED];
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Importers.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer/lib/Importers.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Importers: function () {
    return Importers;
  }
});
var ImporterInfo;
module.link("./ImporterInfo", {
  ImporterInfo: function (v) {
    ImporterInfo = v;
  }
}, 0);

/** Container class which holds all of the importer details. */
var ImportersContainer = /*#__PURE__*/function () {
  function ImportersContainer() {
    this.importers = new Map();
  }
  /**
   * Adds an importer to the import collection. Adding it more than once will
   * overwrite the previous one.
   *
   * @param {ImporterInfo} info The information related to the importer.
   * @param {*} importer The class for the importer, will be undefined on the client.
   */


  var _proto = ImportersContainer.prototype;

  _proto.add = function () {
    function add(info, importer) {
      if (!(info instanceof ImporterInfo)) {
        throw new Error('The importer must be a valid ImporterInfo instance.');
      }

      info.importer = importer;
      this.importers.set(info.key, info);
      return this.importers.get(info.key);
    }

    return add;
  }()
  /**
   * Gets the importer information that is stored.
   *
   * @param {string} key The key of the importer.
   */
  ;

  _proto.get = function () {
    function get(key) {
      return this.importers.get(key);
    }

    return get;
  }()
  /**
   * Gets all of the importers in array format.
   *
   * @returns {ImporterInfo[]} The array of importer information.
   */
  ;

  _proto.getAll = function () {
    function getAll() {
      return Array.from(this.importers.values());
    }

    return getAll;
  }();

  return ImportersContainer;
}();

var Importers = new ImportersContainer();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer/client/index.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/Importers", {
  Importers: "Importers"
}, 0);
module.link("../lib/ImporterInfo", {
  ImporterInfo: "ImporterInfo"
}, 1);
module.link("../lib/ImporterProgressStep", {
  ProgressStep: "ProgressStep"
}, 2);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"importer-csv":{"lib":{"info.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-csv/lib/info.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  CsvImporterInfo: function () {
    return CsvImporterInfo;
  }
});
var ImporterInfo;
module.link("../../importer/lib/ImporterInfo", {
  ImporterInfo: function (v) {
    ImporterInfo = v;
  }
}, 0);

var CsvImporterInfo = /*#__PURE__*/function (_ImporterInfo) {
  _inheritsLoose(CsvImporterInfo, _ImporterInfo);

  function CsvImporterInfo() {
    return _ImporterInfo.call(this, 'csv', 'CSV', 'application/zip', [{
      text: 'Importer_CSV_Information',
      href: 'https://rocket.chat/docs/administrator-guides/import/csv/'
    }]) || this;
  }

  return CsvImporterInfo;
}(ImporterInfo);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"adder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-csv/client/adder.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Importers;
module.link("../../importer/client", {
  Importers: function (v) {
    Importers = v;
  }
}, 0);
var CsvImporterInfo;
module.link("../lib/info", {
  CsvImporterInfo: function (v) {
    CsvImporterInfo = v;
  }
}, 1);
Importers.add(new CsvImporterInfo());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-csv/client/index.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./adder");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"importer-hipchat-enterprise":{"lib":{"info.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-hipchat-enterprise/lib/info.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  HipChatEnterpriseImporterInfo: function () {
    return HipChatEnterpriseImporterInfo;
  }
});
var ImporterInfo;
module.link("../../importer/lib/ImporterInfo", {
  ImporterInfo: function (v) {
    ImporterInfo = v;
  }
}, 0);

var HipChatEnterpriseImporterInfo = /*#__PURE__*/function (_ImporterInfo) {
  _inheritsLoose(HipChatEnterpriseImporterInfo, _ImporterInfo);

  function HipChatEnterpriseImporterInfo() {
    return _ImporterInfo.call(this, 'hipchatenterprise', 'HipChat (tar.gz)', 'application/gzip', [{
      text: 'Importer_HipChatEnterprise_Information',
      href: 'https://rocket.chat/docs/administrator-guides/import/hipchat/enterprise/'
    }]) || this;
  }

  return HipChatEnterpriseImporterInfo;
}(ImporterInfo);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"adder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-hipchat-enterprise/client/adder.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Importers;
module.link("../../importer/client", {
  Importers: function (v) {
    Importers = v;
  }
}, 0);
var HipChatEnterpriseImporterInfo;
module.link("../lib/info", {
  HipChatEnterpriseImporterInfo: function (v) {
    HipChatEnterpriseImporterInfo = v;
  }
}, 1);
Importers.add(new HipChatEnterpriseImporterInfo());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-hipchat-enterprise/client/index.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./adder");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"importer-slack":{"lib":{"info.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack/lib/info.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  SlackImporterInfo: function () {
    return SlackImporterInfo;
  }
});
var ImporterInfo;
module.link("../../importer/lib/ImporterInfo", {
  ImporterInfo: function (v) {
    ImporterInfo = v;
  }
}, 0);

var SlackImporterInfo = /*#__PURE__*/function (_ImporterInfo) {
  _inheritsLoose(SlackImporterInfo, _ImporterInfo);

  function SlackImporterInfo() {
    return _ImporterInfo.call(this, 'slack', 'Slack', 'application/zip') || this;
  }

  return SlackImporterInfo;
}(ImporterInfo);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"adder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack/client/adder.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Importers;
module.link("../../importer/client", {
  Importers: function (v) {
    Importers = v;
  }
}, 0);
var SlackImporterInfo;
module.link("../lib/info", {
  SlackImporterInfo: function (v) {
    SlackImporterInfo = v;
  }
}, 1);
Importers.add(new SlackImporterInfo());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack/client/index.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./adder");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"importer-slack-users":{"lib":{"info.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack-users/lib/info.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  SlackUsersImporterInfo: function () {
    return SlackUsersImporterInfo;
  }
});
var ImporterInfo;
module.link("../../importer/lib/ImporterInfo", {
  ImporterInfo: function (v) {
    ImporterInfo = v;
  }
}, 0);

var SlackUsersImporterInfo = /*#__PURE__*/function (_ImporterInfo) {
  _inheritsLoose(SlackUsersImporterInfo, _ImporterInfo);

  function SlackUsersImporterInfo() {
    return _ImporterInfo.call(this, 'slack-users', 'Slack_Users', 'text/csv', [{
      text: 'Importer_Slack_Users_CSV_Information',
      href: 'https://rocket.chat/docs/administrator-guides/import/slack/users'
    }]) || this;
  }

  return SlackUsersImporterInfo;
}(ImporterInfo);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"adder.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack-users/client/adder.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Importers;
module.link("../../importer/client", {
  Importers: function (v) {
    Importers = v;
  }
}, 0);
var SlackUsersImporterInfo;
module.link("../lib/info", {
  SlackUsersImporterInfo: function (v) {
    SlackUsersImporterInfo = v;
  }
}, 1);
Importers.add(new SlackUsersImporterInfo());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/importer-slack-users/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./adder");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"integrations":{"lib":{"rocketchat.js":[]},"client":{"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/integrations/client/startup.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var hasAtLeastOnePermission;
module.link("../../authorization", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 0);
var registerAdminSidebarItem;
module.link("../../../client/views/admin", {
  registerAdminSidebarItem: function (v) {
    registerAdminSidebarItem = v;
  }
}, 1);
registerAdminSidebarItem({
  href: 'admin-integrations',
  i18nLabel: 'Integrations',
  icon: 'code',
  permissionGranted: function () {
    return hasAtLeastOnePermission(['manage-outgoing-integrations', 'manage-own-outgoing-integrations', 'manage-incoming-integrations', 'manage-own-incoming-integrations']);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"streamer.js":[
  "meteor/meteor"
]}},"mentions":{"lib":{"MentionsParser.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions/lib/MentionsParser.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);

var _createClass;

module.link("@babel/runtime/helpers/createClass", {
  default: function (v) {
    _createClass = v;
  }
}, 1);
module.export({
  MentionsParser: function () {
    return MentionsParser;
  }
});
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 0);

var userTemplateDefault = function (_ref) {
  var prefix = _ref.prefix,
      className = _ref.className,
      mention = _ref.mention,
      title = _ref.title,
      label = _ref.label,
      _ref$type = _ref.type,
      type = _ref$type === void 0 ? 'username' : _ref$type;
  return prefix + "<a class=\"" + className + "\" data-" + type + "=\"" + mention + "\"" + (title ? " title=\"" + title + "\"" : '') + ">" + label + "</a>";
};

var roomTemplateDefault = function (_ref2) {
  var prefix = _ref2.prefix,
      reference = _ref2.reference,
      mention = _ref2.mention;
  return prefix + "<a class=\"mention-link mention-link--room\" data-channel=\"" + reference + "\">" + ("#" + mention) + "</a>";
};

var MentionsParser = /*#__PURE__*/function () {
  function MentionsParser(_ref3) {
    var _this = this;

    var pattern = _ref3.pattern,
        useRealName = _ref3.useRealName,
        _me = _ref3.me,
        _ref3$roomTemplate = _ref3.roomTemplate,
        roomTemplate = _ref3$roomTemplate === void 0 ? roomTemplateDefault : _ref3$roomTemplate,
        _ref3$userTemplate = _ref3.userTemplate,
        userTemplate = _ref3$userTemplate === void 0 ? userTemplateDefault : _ref3$userTemplate;

    this.replaceUsers = function (msg, _ref4, me) {
      var mentions = _ref4.mentions,
          temp = _ref4.temp;
      return msg.replace(_this.userMentionRegex, function (match, prefix, mention) {
        var classNames = ['mention-link'];

        if (mention === 'all') {
          classNames.push('mention-link--all');
          classNames.push('mention-link--group');
        } else if (mention === 'here') {
          classNames.push('mention-link--here');
          classNames.push('mention-link--group');
        } else if (mention === me) {
          classNames.push('mention-link--me');
          classNames.push('mention-link--user');
        } else {
          classNames.push('mention-link--user');
        }

        var className = classNames.join(' ');

        if (mention === 'all' || mention === 'here') {
          return _this.userTemplate({
            prefix: prefix,
            className: className,
            mention: mention,
            label: mention,
            type: 'group'
          });
        }

        var filterUser = function (_ref5) {
          var username = _ref5.username,
              type = _ref5.type;
          return (!type || type === 'user') && username === mention;
        };

        var filterTeam = function (_ref6) {
          var name = _ref6.name,
              type = _ref6.type;
          return type === 'team' && name === mention;
        };

        var _filter = (mentions || []).filter(function (m) {
          return filterUser(m) || filterTeam(m);
        }),
            _filter2 = _slicedToArray(_filter, 1),
            mentionObj = _filter2[0];

        var label = temp ? mention && escapeHTML(mention) : mentionObj && escapeHTML(mentionObj.type === 'team' || _this.useRealName ? mentionObj.name : mentionObj.username);

        if (!label) {
          return match;
        }

        return _this.userTemplate({
          prefix: prefix,
          className: className,
          mention: mention,
          label: label,
          type: (mentionObj === null || mentionObj === void 0 ? void 0 : mentionObj.type) === 'team' ? 'team' : 'username',
          title: _this.useRealName ? mention : label
        });
      });
    };

    this.replaceChannels = function (msg, _ref7) {
      var temp = _ref7.temp,
          channels = _ref7.channels;
      return msg.replace(/&#39;/g, "'").replace(_this.channelMentionRegex, function (match, prefix, mention) {
        if (!temp && !(channels && channels.find(function (c) {
          return c.dname ? c.dname === mention : c.name === mention;
        }))) {
          return match;
        }

        var channel = channels && channels.find(function (_ref8) {
          var name = _ref8.name,
              dname = _ref8.dname;
          return dname ? dname === mention : name === mention;
        });
        var reference = channel ? channel._id : mention;
        return _this.roomTemplate({
          prefix: prefix,
          reference: reference,
          channel: channel,
          mention: mention
        });
      });
    };

    this.pattern = pattern;
    this.useRealName = useRealName;
    this.me = _me;
    this.userTemplate = userTemplate;
    this.roomTemplate = roomTemplate;
  }

  var _proto = MentionsParser.prototype;

  _proto.getUserMentions = function () {
    function getUserMentions(str) {
      return (str.match(this.userMentionRegex) || []).map(function (match) {
        return match.trim();
      });
    }

    return getUserMentions;
  }();

  _proto.getChannelMentions = function () {
    function getChannelMentions(str) {
      return (str.match(this.channelMentionRegex) || []).map(function (match) {
        return match.trim();
      });
    }

    return getChannelMentions;
  }();

  _proto.parse = function () {
    function parse(message) {
      var msg = message && message.html || '';

      if (!msg.trim()) {
        return message;
      }

      msg = this.replaceUsers(msg, message, this.me);
      msg = this.replaceChannels(msg, message, this.me);
      message.html = msg;
      return message;
    }

    return parse;
  }();

  _createClass(MentionsParser, [{
    key: "me",
    get: function () {
      return typeof this._me === 'function' ? this._me() : this._me;
    },
    set: function (m) {
      this._me = m;
    }
  }, {
    key: "pattern",
    get: function () {
      return typeof this._pattern === 'function' ? this._pattern() : this._pattern;
    },
    set: function (p) {
      this._pattern = p;
    }
  }, {
    key: "useRealName",
    get: function () {
      return typeof this._useRealName === 'function' ? this._useRealName() : this._useRealName;
    },
    set: function (s) {
      this._useRealName = s;
    }
  }, {
    key: "userMentionRegex",
    get: function () {
      return new RegExp("(^|\\s|> ?)@(" + this.pattern + "(@(" + this.pattern + "))?)", 'gm');
    }
  }, {
    key: "channelMentionRegex",
    get: function () {
      return new RegExp("(^|\\s|>)#(" + this.pattern + "(@(" + this.pattern + "))?)", 'gm');
    }
  }]);

  return MentionsParser;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions/client/client.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  instance: function () {
    return instance;
  },
  renderMentions: function () {
    return renderMentions;
  },
  createMentionsMessageRenderer: function () {
    return createMentionsMessageRenderer;
  }
});
var MentionsParser;
module.link("../lib/MentionsParser", {
  MentionsParser: function (v) {
    MentionsParser = v;
  }
}, 0);
module.link("./mentionLink.css");
var instance = new MentionsParser({
  me: function () {
    return undefined;
  },
  pattern: function () {
    return undefined;
  },
  useRealName: function () {
    return undefined;
  }
});

var renderMentions = function (message) {
  return message;
};

var createMentionsMessageRenderer = function (_ref) {
  var me = _ref.me,
      pattern = _ref.pattern,
      useRealName = _ref.useRealName;
  module.runSetters(instance = new MentionsParser({
    me: function () {
      return me;
    },
    pattern: function () {
      return pattern;
    },
    useRealName: function () {
      return useRealName;
    }
  }), ["instance"]);
  module.runSetters(renderMentions = function (message) {
    return instance.parse(message);
  }, ["renderMentions"]);
  return function (message) {
    return instance.parse(message);
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":[
  "./client"
],"mentionLink.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mentions/client/mentionLink.css                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"nextcloud":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/nextcloud/lib/common.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth: function (v) {
    CustomOAuth = v;
  }
}, 4);
var config = {
  serverURL: '',
  tokenPath: '/index.php/apps/oauth2/api/v1/token',
  tokenSentVia: 'header',
  authorizePath: '/index.php/apps/oauth2/authorize',
  identityPath: '/ocs/v2.php/cloud/user?format=json',
  scope: 'openid',
  addAutopublishFields: {
    forLoggedInUser: ['services.nextcloud'],
    forOtherUsers: ['services.nextcloud.name']
  }
};
var Nextcloud = new CustomOAuth('nextcloud', config);

var fillServerURL = _.debounce(Meteor.bindEnvironment(function () {
  var nextcloudURL = settings.get('Accounts_OAuth_Nextcloud_URL');

  if (!nextcloudURL) {
    if (nextcloudURL === undefined) {
      return fillServerURL();
    }

    return;
  }

  config.serverURL = nextcloudURL.trim().replace(/\/*$/, '');
  return Nextcloud.configure(config);
}), Meteor.isServer ? 1000 : 100);

Meteor.startup(function () {
  if (Meteor.isServer) {
    settings.get('Accounts_OAuth_Nextcloud_URL', function () {
      return fillServerURL();
    });
  } else {
    Tracker.autorun(function () {
      return fillServerURL();
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/nextcloud/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommand-asciiarts":{"lib":{"gimme.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/lib/gimme.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 1);

/*
 * Gimme is a named function that will replace /gimme commands
 * @param {Object} message - The message object
 */
function Gimme(command, params, item) {
  if (command === 'gimme') {
    var msg = item;
    msg.msg = "\u0F3C \u3064 \u25D5_\u25D5 \u0F3D\u3064 " + params;
    Meteor.call('sendMessage', msg);
  }
}

slashCommands.add('gimme', Gimme, {
  description: 'Slash_Gimme_Description',
  params: 'your_message_optional'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"lenny.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/lib/lenny.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 1);

/*
 * Lenny is a named function that will replace /lenny commands
 * @param {Object} message - The message object
 */
function LennyFace(command, params, item) {
  if (command === 'lennyface') {
    var msg = item;
    msg.msg = params + " ( \u0361\xB0 \u035C\u0296 \u0361\xB0)";
    Meteor.call('sendMessage', msg);
  }
}

slashCommands.add('lennyface', LennyFace, {
  description: 'Slash_LennyFace_Description',
  params: 'your_message_optional'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"shrug.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/lib/shrug.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 1);

/*
 * Shrug is a named function that will replace /shrug commands
 * @param {Object} message - The message object
 */
function Shrug(command, params, item) {
  if (command === 'shrug') {
    var msg = item;
    msg.msg = params + " \xAF\\_(\u30C4)_/\xAF";
    Meteor.call('sendMessage', msg);
  }
}

slashCommands.add('shrug', Shrug, {
  description: 'Slash_Shrug_Description',
  params: 'your_message_optional'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tableflip.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/lib/tableflip.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 1);

/*
 * Tableflip is a named function that will replace /Tableflip commands
 * @param {Object} message - The message object
 */
function Tableflip(command, params, item) {
  if (command === 'tableflip') {
    var msg = item;
    msg.msg = params + " (\u256F\xB0\u25A1\xB0\uFF09\u256F\uFE35 \u253B\u2501\u253B";
    Meteor.call('sendMessage', msg);
  }
}

slashCommands.add('tableflip', Tableflip, {
  description: 'Slash_Tableflip_Description',
  params: 'your_message_optional'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"unflip.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/lib/unflip.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 1);

/*
 * Unflip is a named function that will replace /unflip commands
 * @param {Object} message - The message object
 */
function Unflip(command, params, item) {
  if (command === 'unflip') {
    var msg = item;
    msg.msg = params + " \u252C\u2500\u252C \u30CE( \u309C-\u309C\u30CE)";
    Meteor.call('sendMessage', msg);
  }
}

slashCommands.add('unflip', Unflip, {
  description: 'Slash_TableUnflip_Description',
  params: 'your_message_optional'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommand-asciiarts/client/index.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/gimme");
module.link("../lib/lenny");
module.link("../lib/shrug");
module.link("../lib/tableflip");
module.link("../lib/unflip");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-topic":{"lib":{"topic.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-topic/lib/topic.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 1);
var ChatRoom;
module.link("../../models", {
  ChatRoom: function (v) {
    ChatRoom = v;
  }
}, 2);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);
var hasPermission;
module.link("../../authorization", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 4);

function Topic(command, params, item) {
  if (command === 'topic') {
    if (Meteor.isClient && hasPermission('edit-room', item.rid) || Meteor.isServer && hasPermission(Meteor.userId(), 'edit-room', item.rid)) {
      Meteor.call('saveRoomSettings', item.rid, 'roomTopic', params, function (err) {
        if (err) {
          if (Meteor.isClient) {
            var _require = require('../../../client/lib/utils/handleError'),
                handleError = _require.handleError;

            return handleError(err);
          }

          throw err;
        }

        if (Meteor.isClient) {
          callbacks.run('roomTopicChanged', ChatRoom.findOne(item.rid));
        }
      });
    }
  }
}

slashCommands.add('topic', Topic, {
  description: 'Slash_Topic_Description',
  params: 'Slash_Topic_Params',
  permission: 'edit-room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-topic/client/index.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/topic");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"wordpress":{"lib":{"common.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/wordpress/lib/common.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration: function (v) {
    ServiceConfiguration = v;
  }
}, 2);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 3);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth: function (v) {
    CustomOAuth = v;
  }
}, 5);
var config = {
  serverURL: '',
  identityPath: '/oauth/me',
  addAutopublishFields: {
    forLoggedInUser: ['services.wordpress'],
    forOtherUsers: ['services.wordpress.user_login']
  },
  accessTokenParam: 'access_token'
};
var WordPress = new CustomOAuth('wordpress', config);

var fillSettings = _.debounce(Meteor.bindEnvironment(function () {
  config.serverURL = settings.get('API_Wordpress_URL');

  if (!config.serverURL) {
    if (config.serverURL === undefined) {
      return fillSettings();
    }

    return;
  }

  delete config.identityPath;
  delete config.identityTokenSentVia;
  delete config.authorizePath;
  delete config.tokenPath;
  delete config.scope;
  var serverType = settings.get('Accounts_OAuth_Wordpress_server_type');

  switch (serverType) {
    case 'custom':
      if (settings.get('Accounts_OAuth_Wordpress_identity_path')) {
        config.identityPath = settings.get('Accounts_OAuth_Wordpress_identity_path');
      }

      if (settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via')) {
        config.identityTokenSentVia = settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via');
      }

      if (settings.get('Accounts_OAuth_Wordpress_token_path')) {
        config.tokenPath = settings.get('Accounts_OAuth_Wordpress_token_path');
      }

      if (settings.get('Accounts_OAuth_Wordpress_authorize_path')) {
        config.authorizePath = settings.get('Accounts_OAuth_Wordpress_authorize_path');
      }

      if (settings.get('Accounts_OAuth_Wordpress_scope')) {
        config.scope = settings.get('Accounts_OAuth_Wordpress_scope');
      }

      break;

    case 'wordpress-com':
      config.identityPath = 'https://public-api.wordpress.com/rest/v1/me';
      config.identityTokenSentVia = 'header';
      config.authorizePath = 'https://public-api.wordpress.com/oauth2/authorize';
      config.tokenPath = 'https://public-api.wordpress.com/oauth2/token';
      config.scope = 'auth';
      break;

    default:
      config.identityPath = '/oauth/me';
      break;
  }

  var result = WordPress.configure(config);

  if (Meteor.isServer) {
    var enabled = settings.get('Accounts_OAuth_Wordpress');

    if (enabled) {
      ServiceConfiguration.configurations.upsert({
        service: 'wordpress'
      }, {
        $set: config
      });
    } else {
      ServiceConfiguration.configurations.remove({
        service: 'wordpress'
      });
    }
  }

  return result;
}), Meteor.isServer ? 1000 : 100);

if (Meteor.isServer) {
  Meteor.startup(function () {
    return settings.watchByRegex(/(API\_Wordpress\_URL)?(Accounts\_OAuth\_Wordpress\_)?/, function () {
      return fillSettings();
    });
  });
} else {
  Meteor.startup(function () {
    return Tracker.autorun(function () {
      return fillSettings();
    });
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/wordpress/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../lib/common");
module.link("./wordpress-login-button.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"wordpress-login-button.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/wordpress/client/wordpress-login-button.css                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"theme":{"client":{"vendor":{"fontello":{"css":{"fontello.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/theme/client/vendor/fontello/css/fontello.css                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"photoswipe.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/theme/client/vendor/photoswipe.css                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"imports":{"components":{"emojiPicker.css":[
  "meteor/modules"
]}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/theme/client/index.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("toastr/build/toastr.min.css");
module.link("./main.css");
module.link("./vendor/photoswipe.css");
module.link("./vendor/fontello/css/fontello.css");
module.link("./rocketchat.font.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.font.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/theme/client/rocketchat.font.css                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"main.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/theme/client/main.css                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"e2e":{"client":{"stylesheets":{"e2e.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/stylesheets/e2e.css                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"E2ERoomState.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/E2ERoomState.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  E2ERoomState: function () {
    return E2ERoomState;
  }
});
var E2ERoomState;

(function (E2ERoomState) {
  E2ERoomState["NO_PASSWORD_SET"] = "NO_PASSWORD_SET";
  E2ERoomState["NOT_STARTED"] = "NOT_STARTED";
  E2ERoomState["DISABLED"] = "DISABLED";
  E2ERoomState["HANDSHAKE"] = "HANDSHAKE";
  E2ERoomState["ESTABLISHING"] = "ESTABLISHING";
  E2ERoomState["CREATING_KEYS"] = "CREATING_KEYS";
  E2ERoomState["WAITING_KEYS"] = "WAITING_KEYS";
  E2ERoomState["KEYS_RECEIVED"] = "KEYS_RECEIVED";
  E2ERoomState["READY"] = "READY";
  E2ERoomState["ERROR"] = "ERROR";
})(E2ERoomState || module.runSetters(E2ERoomState = {}, ["E2ERoomState"]));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"events.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/events.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 0);
var e2e;
module.link("./rocketchat.e2e", {
  e2e: function (v) {
    e2e = v;
  }
}, 1);
Accounts.onLogout(function () {
  e2e.stopClient();
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"helper.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/helper.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _typeof;

module.link("@babel/runtime/helpers/typeof", {
  default: function (v) {
    _typeof = v;
  }
}, 1);
module.export({
  toString: function () {
    return toString;
  },
  toArrayBuffer: function () {
    return toArrayBuffer;
  },
  joinVectorAndEcryptedData: function () {
    return joinVectorAndEcryptedData;
  },
  splitVectorAndEcryptedData: function () {
    return splitVectorAndEcryptedData;
  },
  encryptRSA: function () {
    return encryptRSA;
  },
  encryptAES: function () {
    return encryptAES;
  },
  decryptRSA: function () {
    return decryptRSA;
  },
  decryptAES: function () {
    return decryptAES;
  },
  generateAESKey: function () {
    return generateAESKey;
  },
  generateRSAKey: function () {
    return generateRSAKey;
  },
  exportJWKKey: function () {
    return exportJWKKey;
  },
  importRSAKey: function () {
    return importRSAKey;
  },
  importAESKey: function () {
    return importAESKey;
  },
  importRawKey: function () {
    return importRawKey;
  },
  deriveKey: function () {
    return deriveKey;
  },
  readFileAsArrayBuffer: function () {
    return readFileAsArrayBuffer;
  },
  Deferred: function () {
    return Deferred;
  }
});
var ByteBuffer;
module.link("bytebuffer", {
  "default": function (v) {
    ByteBuffer = v;
  }
}, 0);
var StaticArrayBufferProto = new ArrayBuffer().__proto__;

function toString(thing) {
  if (typeof thing === 'string') {
    return thing;
  }

  return new ByteBuffer.wrap(thing).toString('binary');
}

function toArrayBuffer(thing) {
  if (thing === undefined) {
    return undefined;
  }

  if (thing === Object(thing)) {
    if (thing.__proto__ === StaticArrayBufferProto) {
      return thing;
    }
  }

  if (typeof thing !== 'string') {
    throw new Error("Tried to convert a non-string of type " + _typeof(thing) + " to an array buffer");
  }

  return new ByteBuffer.wrap(thing, 'binary').toArrayBuffer();
}

function joinVectorAndEcryptedData(vector, encryptedData) {
  var cipherText = new Uint8Array(encryptedData);
  var output = new Uint8Array(vector.length + cipherText.length);
  output.set(vector, 0);
  output.set(cipherText, vector.length);
  return output;
}

function splitVectorAndEcryptedData(cipherText) {
  var vector = cipherText.slice(0, 16);
  var encryptedData = cipherText.slice(16);
  return [vector, encryptedData];
}

function encryptRSA(key, data) {
  return _regeneratorRuntime.async(function () {
    function encryptRSA$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            return _context.abrupt("return", crypto.subtle.encrypt({
              name: 'RSA-OAEP'
            }, key, data));

          case 1:
          case "end":
            return _context.stop();
        }
      }
    }

    return encryptRSA$;
  }(), null, null, null, Promise);
}

function encryptAES(vector, key, data) {
  return _regeneratorRuntime.async(function () {
    function encryptAES$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            return _context2.abrupt("return", crypto.subtle.encrypt({
              name: 'AES-CBC',
              iv: vector
            }, key, data));

          case 1:
          case "end":
            return _context2.stop();
        }
      }
    }

    return encryptAES$;
  }(), null, null, null, Promise);
}

function decryptRSA(key, data) {
  return _regeneratorRuntime.async(function () {
    function decryptRSA$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            return _context3.abrupt("return", crypto.subtle.decrypt({
              name: 'RSA-OAEP'
            }, key, data));

          case 1:
          case "end":
            return _context3.stop();
        }
      }
    }

    return decryptRSA$;
  }(), null, null, null, Promise);
}

function decryptAES(vector, key, data) {
  return _regeneratorRuntime.async(function () {
    function decryptAES$(_context4) {
      while (1) {
        switch (_context4.prev = _context4.next) {
          case 0:
            return _context4.abrupt("return", crypto.subtle.decrypt({
              name: 'AES-CBC',
              iv: vector
            }, key, data));

          case 1:
          case "end":
            return _context4.stop();
        }
      }
    }

    return decryptAES$;
  }(), null, null, null, Promise);
}

function generateAESKey() {
  return _regeneratorRuntime.async(function () {
    function generateAESKey$(_context5) {
      while (1) {
        switch (_context5.prev = _context5.next) {
          case 0:
            return _context5.abrupt("return", crypto.subtle.generateKey({
              name: 'AES-CBC',
              length: 128
            }, true, ['encrypt', 'decrypt']));

          case 1:
          case "end":
            return _context5.stop();
        }
      }
    }

    return generateAESKey$;
  }(), null, null, null, Promise);
}

function generateRSAKey() {
  return _regeneratorRuntime.async(function () {
    function generateRSAKey$(_context6) {
      while (1) {
        switch (_context6.prev = _context6.next) {
          case 0:
            return _context6.abrupt("return", crypto.subtle.generateKey({
              name: 'RSA-OAEP',
              modulusLength: 2048,
              publicExponent: new Uint8Array([0x01, 0x00, 0x01]),
              hash: {
                name: 'SHA-256'
              }
            }, true, ['encrypt', 'decrypt']));

          case 1:
          case "end":
            return _context6.stop();
        }
      }
    }

    return generateRSAKey$;
  }(), null, null, null, Promise);
}

function exportJWKKey(key) {
  return _regeneratorRuntime.async(function () {
    function exportJWKKey$(_context7) {
      while (1) {
        switch (_context7.prev = _context7.next) {
          case 0:
            return _context7.abrupt("return", crypto.subtle.exportKey('jwk', key));

          case 1:
          case "end":
            return _context7.stop();
        }
      }
    }

    return exportJWKKey$;
  }(), null, null, null, Promise);
}

function importRSAKey(keyData) {
  var keyUsages,
      _args8 = arguments;
  return _regeneratorRuntime.async(function () {
    function importRSAKey$(_context8) {
      while (1) {
        switch (_context8.prev = _context8.next) {
          case 0:
            keyUsages = _args8.length > 1 && _args8[1] !== undefined ? _args8[1] : ['encrypt', 'decrypt'];
            return _context8.abrupt("return", crypto.subtle.importKey('jwk', keyData, {
              name: 'RSA-OAEP',
              modulusLength: 2048,
              publicExponent: new Uint8Array([0x01, 0x00, 0x01]),
              hash: {
                name: 'SHA-256'
              }
            }, true, keyUsages));

          case 2:
          case "end":
            return _context8.stop();
        }
      }
    }

    return importRSAKey$;
  }(), null, null, null, Promise);
}

function importAESKey(keyData) {
  var keyUsages,
      _args9 = arguments;
  return _regeneratorRuntime.async(function () {
    function importAESKey$(_context9) {
      while (1) {
        switch (_context9.prev = _context9.next) {
          case 0:
            keyUsages = _args9.length > 1 && _args9[1] !== undefined ? _args9[1] : ['encrypt', 'decrypt'];
            return _context9.abrupt("return", crypto.subtle.importKey('jwk', keyData, {
              name: 'AES-CBC'
            }, true, keyUsages));

          case 2:
          case "end":
            return _context9.stop();
        }
      }
    }

    return importAESKey$;
  }(), null, null, null, Promise);
}

function importRawKey(keyData) {
  var keyUsages,
      _args10 = arguments;
  return _regeneratorRuntime.async(function () {
    function importRawKey$(_context10) {
      while (1) {
        switch (_context10.prev = _context10.next) {
          case 0:
            keyUsages = _args10.length > 1 && _args10[1] !== undefined ? _args10[1] : ['deriveKey'];
            return _context10.abrupt("return", crypto.subtle.importKey('raw', keyData, {
              name: 'PBKDF2'
            }, false, keyUsages));

          case 2:
          case "end":
            return _context10.stop();
        }
      }
    }

    return importRawKey$;
  }(), null, null, null, Promise);
}

function deriveKey(salt, baseKey) {
  var keyUsages,
      iterations,
      hash,
      _args11 = arguments;
  return _regeneratorRuntime.async(function () {
    function deriveKey$(_context11) {
      while (1) {
        switch (_context11.prev = _context11.next) {
          case 0:
            keyUsages = _args11.length > 2 && _args11[2] !== undefined ? _args11[2] : ['encrypt', 'decrypt'];
            iterations = 1000;
            hash = 'SHA-256';
            return _context11.abrupt("return", crypto.subtle.deriveKey({
              name: 'PBKDF2',
              salt: salt,
              iterations: iterations,
              hash: hash
            }, baseKey, {
              name: 'AES-CBC',
              length: 256
            }, true, keyUsages));

          case 4:
          case "end":
            return _context11.stop();
        }
      }
    }

    return deriveKey$;
  }(), null, null, null, Promise);
}

function readFileAsArrayBuffer(file) {
  return _regeneratorRuntime.async(function () {
    function readFileAsArrayBuffer$(_context12) {
      while (1) {
        switch (_context12.prev = _context12.next) {
          case 0:
            return _context12.abrupt("return", new Promise(function (resolve, reject) {
              var reader = new FileReader();

              reader.onload = function (evt) {
                resolve(evt.target.result);
              };

              reader.onerror = function (evt) {
                reject(evt);
              };

              reader.readAsArrayBuffer(file);
            }));

          case 1:
          case "end":
            return _context12.stop();
        }
      }
    }

    return readFileAsArrayBuffer$;
  }(), null, null, null, Promise);
}

var Deferred = function () {
  function Deferred() {
    var _this = this;

    var p = new Promise(function (resolve, reject) {
      _this.resolve = resolve;
      _this.reject = reject;
    });
    p.resolve = this.resolve;
    p.reject = this.reject;
    return p;
  }

  return Deferred;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/index.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./stylesheets/e2e.css");
module.link("./rocketchat.e2e", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"logger.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/logger.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  log: function () {
    return log;
  },
  logError: function () {
    return logError;
  }
});
var getConfig;
module.link("../../../client/lib/utils/getConfig", {
  getConfig: function (v) {
    getConfig = v;
  }
}, 0);
var debug = undefined;

var isDebugEnabled = function () {
  if (debug === undefined) {
    debug = getConfig('debug') === 'true' || getConfig('debug-e2e') === 'true';
  }

  return debug;
};

var log = function (context) {
  var _console;

  for (var _len = arguments.length, msg = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    msg[_key - 1] = arguments[_key];
  }

  isDebugEnabled() && (_console = console).log.apply(_console, ["[" + context + "]"].concat(msg));
};

var logError = function (context) {
  var _console2;

  for (var _len2 = arguments.length, msg = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
    msg[_key2 - 1] = arguments[_key2];
  }

  isDebugEnabled() && (_console2 = console).error.apply(_console2, ["[" + context + "]"].concat(msg));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.e2e.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/rocketchat.e2e.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["_id"];

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 0);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 1);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 2);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 3);

var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 4);
module.export({
  e2e: function () {
    return e2e;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var EJSON;
module.link("meteor/ejson", {
  EJSON: function (v) {
    EJSON = v;
  }
}, 3);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 4);
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 5);
var E2ERoom;
module.link("./rocketchat.e2e.room", {
  E2ERoom: function (v) {
    E2ERoom = v;
  }
}, 6);
var toString, toArrayBuffer, joinVectorAndEcryptedData, splitVectorAndEcryptedData, encryptAES, decryptAES, generateRSAKey, exportJWKKey, importRSAKey, importRawKey, deriveKey;
module.link("./helper", {
  toString: function (v) {
    toString = v;
  },
  toArrayBuffer: function (v) {
    toArrayBuffer = v;
  },
  joinVectorAndEcryptedData: function (v) {
    joinVectorAndEcryptedData = v;
  },
  splitVectorAndEcryptedData: function (v) {
    splitVectorAndEcryptedData = v;
  },
  encryptAES: function (v) {
    encryptAES = v;
  },
  decryptAES: function (v) {
    decryptAES = v;
  },
  generateRSAKey: function (v) {
    generateRSAKey = v;
  },
  exportJWKKey: function (v) {
    exportJWKKey = v;
  },
  importRSAKey: function (v) {
    importRSAKey = v;
  },
  importRawKey: function (v) {
    importRawKey = v;
  },
  deriveKey: function (v) {
    deriveKey = v;
  }
}, 7);
var banners;
module.link("../../../client/lib/banners", {
  "*": function (v) {
    banners = v;
  }
}, 8);
var Rooms, Subscriptions, Messages;
module.link("../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  },
  Messages: function (v) {
    Messages = v;
  }
}, 9);
module.link("./events.js");
module.link("./tabbar");

var _log, logError;

module.link("./logger", {
  log: function (v) {
    _log = v;
  },
  logError: function (v) {
    logError = v;
  }
}, 10);
var waitUntilFind;
module.link("../../../client/lib/utils/waitUntilFind", {
  waitUntilFind: function (v) {
    waitUntilFind = v;
  }
}, 11);
var imperativeModal;
module.link("../../../client/lib/imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 12);
var SaveE2EPasswordModal;
module.link("../../../client/views/e2e/SaveE2EPasswordModal", {
  "default": function (v) {
    SaveE2EPasswordModal = v;
  }
}, 13);
var EnterE2EPasswordModal;
module.link("../../../client/views/e2e/EnterE2EPasswordModal", {
  "default": function (v) {
    EnterE2EPasswordModal = v;
  }
}, 14);
var call;
module.link("../../../client/lib/utils/call", {
  call: function (v) {
    call = v;
  }
}, 15);
var failedToDecodeKey = false;

var E2E = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(E2E, _Emitter);

  function E2E() {
    var _this;

    _this = _Emitter.call(this) || this;
    _this.started = false;
    _this.enabled = new ReactiveVar(false);
    _this._ready = new ReactiveVar(false);
    _this.instancesByRoomId = {};

    _this.on('ready', function () {
      _this._ready.set(true);

      _this.log('startClient -> Done');

      _this.log('decryptSubscriptions');

      _this.decryptSubscriptions();

      _this.log('decryptSubscriptions -> Done');
    });

    return _this;
  }

  var _proto = E2E.prototype;

  _proto.log = function () {
    function log() {
      for (var _len = arguments.length, msg = new Array(_len), _key = 0; _key < _len; _key++) {
        msg[_key] = arguments[_key];
      }

      _log.apply(void 0, ['E2E'].concat(msg));
    }

    return log;
  }();

  _proto.error = function () {
    function error() {
      for (var _len2 = arguments.length, msg = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        msg[_key2] = arguments[_key2];
      }

      logError.apply(void 0, ['E2E'].concat(msg));
    }

    return error;
  }();

  _proto.isEnabled = function () {
    function isEnabled() {
      return this.enabled.get();
    }

    return isEnabled;
  }();

  _proto.isReady = function () {
    function isReady() {
      return this.enabled.get() && this._ready.get();
    }

    return isReady;
  }();

  _proto.getInstanceByRoomId = function () {
    function getInstanceByRoomId(rid) {
      var room;
      return _regeneratorRuntime.async(function () {
        function getInstanceByRoomId$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return _regeneratorRuntime.awrap(waitUntilFind(function () {
                  return Rooms.findOne({
                    _id: rid
                  });
                }));

              case 2:
                room = _context.sent;

                if (!(room.t !== 'd' && room.t !== 'p')) {
                  _context.next = 5;
                  break;
                }

                return _context.abrupt("return", null);

              case 5:
                if (!(room.encrypted !== true && !room.e2eKeyId)) {
                  _context.next = 7;
                  break;
                }

                return _context.abrupt("return", null);

              case 7:
                if (!this.instancesByRoomId[rid]) {
                  this.instancesByRoomId[rid] = new E2ERoom(Meteor.userId(), rid, room.t);
                }

                return _context.abrupt("return", this.instancesByRoomId[rid]);

              case 9:
              case "end":
                return _context.stop();
            }
          }
        }

        return getInstanceByRoomId$;
      }(), null, this, null, Promise);
    }

    return getInstanceByRoomId;
  }();

  _proto.removeInstanceByRoomId = function () {
    function removeInstanceByRoomId(rid) {
      delete this.instancesByRoomId[rid];
    }

    return removeInstanceByRoomId;
  }();

  _proto.startClient = function () {
    function startClient() {
      var _this2 = this;

      var public_key, private_key, randomPassword, passwordRevealText;
      return _regeneratorRuntime.async(function () {
        function startClient$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                if (!this.started) {
                  _context2.next = 2;
                  break;
                }

                return _context2.abrupt("return");

              case 2:
                this.log('startClient -> STARTED');
                this.started = true;
                public_key = Meteor._localStorage.getItem('public_key');
                private_key = Meteor._localStorage.getItem('private_key');
                _context2.next = 8;
                return _regeneratorRuntime.awrap(this.loadKeysFromDB());

              case 8:
                if (!public_key && this.db_public_key) {
                  public_key = this.db_public_key;
                }

                if (!(!private_key && this.db_private_key)) {
                  _context2.next = 22;
                  break;
                }

                _context2.prev = 10;
                _context2.next = 13;
                return _regeneratorRuntime.awrap(this.decodePrivateKey(this.db_private_key));

              case 13:
                private_key = _context2.sent;
                _context2.next = 22;
                break;

              case 16:
                _context2.prev = 16;
                _context2.t0 = _context2["catch"](10);
                this.started = false;
                failedToDecodeKey = true;
                this.openAlert({
                  title: TAPi18n.__("Wasn't possible to decode your encryption key to be imported."),
                  html: '<div>Your encryption password seems wrong. Click here to try again.</div>',
                  modifiers: ['large', 'danger'],
                  closable: true,
                  icon: 'key',
                  action: function () {
                    _this2.startClient();

                    _this2.closeAlert();
                  }
                });
                return _context2.abrupt("return");

              case 22:
                if (!(public_key && private_key)) {
                  _context2.next = 27;
                  break;
                }

                _context2.next = 25;
                return _regeneratorRuntime.awrap(this.loadKeys({
                  public_key: public_key,
                  private_key: private_key
                }));

              case 25:
                _context2.next = 29;
                break;

              case 27:
                _context2.next = 29;
                return _regeneratorRuntime.awrap(this.createAndLoadKeys());

              case 29:
                if (!(!this.db_public_key || !this.db_private_key)) {
                  _context2.next = 40;
                  break;
                }

                _context2.t1 = _regeneratorRuntime;
                _context2.t2 = call;
                _context2.t3 = Meteor._localStorage.getItem('public_key');
                _context2.next = 35;
                return _regeneratorRuntime.awrap(this.encodePrivateKey(Meteor._localStorage.getItem('private_key'), this.createRandomPassword()));

              case 35:
                _context2.t4 = _context2.sent;
                _context2.t5 = {
                  public_key: _context2.t3,
                  private_key: _context2.t4
                };
                _context2.t6 = (0, _context2.t2)('e2e.setUserPublicAndPrivateKeys', _context2.t5);
                _context2.next = 40;
                return _context2.t1.awrap.call(_context2.t1, _context2.t6);

              case 40:
                randomPassword = Meteor._localStorage.getItem('e2e.randomPassword');

                if (randomPassword) {
                  passwordRevealText = TAPi18n.__('E2E_password_reveal_text', {
                    postProcess: 'sprintf',
                    sprintf: [randomPassword]
                  });
                  this.openAlert({
                    title: TAPi18n.__('Save_Your_Encryption_Password'),
                    html: TAPi18n.__('Click_here_to_view_and_copy_your_password'),
                    modifiers: ['large'],
                    closable: false,
                    icon: 'key',
                    action: function () {
                      imperativeModal.open({
                        component: SaveE2EPasswordModal,
                        props: {
                          passwordRevealText: passwordRevealText,
                          onClose: imperativeModal.close,
                          onCancel: function () {
                            _this2.closeAlert();

                            imperativeModal.close();
                          },
                          onConfirm: function () {
                            Meteor._localStorage.removeItem('e2e.randomPassword');

                            _this2.closeAlert();

                            imperativeModal.close();
                          }
                        }
                      });
                    }
                  });
                }

                this.emit('ready');

              case 43:
              case "end":
                return _context2.stop();
            }
          }
        }

        return startClient$;
      }(), null, this, [[10, 16]], Promise);
    }

    return startClient;
  }();

  _proto.stopClient = function () {
    function stopClient() {
      return _regeneratorRuntime.async(function () {
        function stopClient$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                this.log('-> Stop Client');
                this.closeAlert();

                Meteor._localStorage.removeItem('public_key');

                Meteor._localStorage.removeItem('private_key');

                this.instancesByRoomId = {};
                this.privateKey = null;
                this.enabled.set(false);

                this._ready.set(false);

                this.started = false;

              case 9:
              case "end":
                return _context3.stop();
            }
          }
        }

        return stopClient$;
      }(), null, this, null, Promise);
    }

    return stopClient;
  }();

  _proto.changePassword = function () {
    function changePassword(newPassword) {
      return _regeneratorRuntime.async(function () {
        function changePassword$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                _context4.t0 = _regeneratorRuntime;
                _context4.t1 = call;
                _context4.t2 = Meteor._localStorage.getItem('public_key');
                _context4.next = 5;
                return _regeneratorRuntime.awrap(this.encodePrivateKey(Meteor._localStorage.getItem('private_key'), newPassword));

              case 5:
                _context4.t3 = _context4.sent;
                _context4.t4 = {
                  public_key: _context4.t2,
                  private_key: _context4.t3
                };
                _context4.t5 = (0, _context4.t1)('e2e.setUserPublicAndPrivateKeys', _context4.t4);
                _context4.next = 10;
                return _context4.t0.awrap.call(_context4.t0, _context4.t5);

              case 10:
                if (Meteor._localStorage.getItem('e2e.randomPassword')) {
                  Meteor._localStorage.setItem('e2e.randomPassword', newPassword);
                }

              case 11:
              case "end":
                return _context4.stop();
            }
          }
        }

        return changePassword$;
      }(), null, this, null, Promise);
    }

    return changePassword;
  }();

  _proto.loadKeysFromDB = function () {
    function loadKeysFromDB() {
      var _await$call, public_key, private_key;

      return _regeneratorRuntime.async(function () {
        function loadKeysFromDB$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                _context5.prev = 0;
                _context5.next = 3;
                return _regeneratorRuntime.awrap(call('e2e.fetchMyKeys'));

              case 3:
                _await$call = _context5.sent;
                public_key = _await$call.public_key;
                private_key = _await$call.private_key;
                this.db_public_key = public_key;
                this.db_private_key = private_key;
                _context5.next = 13;
                break;

              case 10:
                _context5.prev = 10;
                _context5.t0 = _context5["catch"](0);
                return _context5.abrupt("return", this.error('Error fetching RSA keys: ', _context5.t0));

              case 13:
              case "end":
                return _context5.stop();
            }
          }
        }

        return loadKeysFromDB$;
      }(), null, this, [[0, 10]], Promise);
    }

    return loadKeysFromDB;
  }();

  _proto.loadKeys = function () {
    function loadKeys(_ref) {
      var public_key, private_key;
      return _regeneratorRuntime.async(function () {
        function loadKeys$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                public_key = _ref.public_key, private_key = _ref.private_key;

                Meteor._localStorage.setItem('public_key', public_key);

                _context6.prev = 2;
                _context6.next = 5;
                return _regeneratorRuntime.awrap(importRSAKey(EJSON.parse(private_key), ['decrypt']));

              case 5:
                this.privateKey = _context6.sent;

                Meteor._localStorage.setItem('private_key', private_key);

                _context6.next = 12;
                break;

              case 9:
                _context6.prev = 9;
                _context6.t0 = _context6["catch"](2);
                return _context6.abrupt("return", this.error('Error importing private key: ', _context6.t0));

              case 12:
              case "end":
                return _context6.stop();
            }
          }
        }

        return loadKeys$;
      }(), null, this, [[2, 9]], Promise);
    }

    return loadKeys;
  }();

  _proto.createAndLoadKeys = function () {
    function createAndLoadKeys() {
      var key, publicKey, privateKey;
      return _regeneratorRuntime.async(function () {
        function createAndLoadKeys$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                _context7.prev = 0;
                _context7.next = 3;
                return _regeneratorRuntime.awrap(generateRSAKey());

              case 3:
                key = _context7.sent;
                this.privateKey = key.privateKey;
                _context7.next = 10;
                break;

              case 7:
                _context7.prev = 7;
                _context7.t0 = _context7["catch"](0);
                return _context7.abrupt("return", this.error('Error generating key: ', _context7.t0));

              case 10:
                _context7.prev = 10;
                _context7.next = 13;
                return _regeneratorRuntime.awrap(exportJWKKey(key.publicKey));

              case 13:
                publicKey = _context7.sent;

                Meteor._localStorage.setItem('public_key', JSON.stringify(publicKey));

                _context7.next = 20;
                break;

              case 17:
                _context7.prev = 17;
                _context7.t1 = _context7["catch"](10);
                return _context7.abrupt("return", this.error('Error exporting public key: ', _context7.t1));

              case 20:
                _context7.prev = 20;
                _context7.next = 23;
                return _regeneratorRuntime.awrap(exportJWKKey(key.privateKey));

              case 23:
                privateKey = _context7.sent;

                Meteor._localStorage.setItem('private_key', JSON.stringify(privateKey));

                _context7.next = 30;
                break;

              case 27:
                _context7.prev = 27;
                _context7.t2 = _context7["catch"](20);
                return _context7.abrupt("return", this.error('Error exporting private key: ', _context7.t2));

              case 30:
                this.requestSubscriptionKeys();

              case 31:
              case "end":
                return _context7.stop();
            }
          }
        }

        return createAndLoadKeys$;
      }(), null, this, [[0, 7], [10, 17], [20, 27]], Promise);
    }

    return createAndLoadKeys;
  }();

  _proto.requestSubscriptionKeys = function () {
    function requestSubscriptionKeys() {
      return _regeneratorRuntime.async(function () {
        function requestSubscriptionKeys$(_context8) {
          while (1) {
            switch (_context8.prev = _context8.next) {
              case 0:
                call('e2e.requestSubscriptionKeys');

              case 1:
              case "end":
                return _context8.stop();
            }
          }
        }

        return requestSubscriptionKeys$;
      }(), null, null, null, Promise);
    }

    return requestSubscriptionKeys;
  }();

  _proto.createRandomPassword = function () {
    function createRandomPassword() {
      var randomPassword = (Random.id(3) + "-" + Random.id(3) + "-" + Random.id(3)).toLowerCase();

      Meteor._localStorage.setItem('e2e.randomPassword', randomPassword);

      return randomPassword;
    }

    return createRandomPassword;
  }();

  _proto.encodePrivateKey = function () {
    function encodePrivateKey(private_key, password) {
      var masterKey, vector, encodedPrivateKey;
      return _regeneratorRuntime.async(function () {
        function encodePrivateKey$(_context9) {
          while (1) {
            switch (_context9.prev = _context9.next) {
              case 0:
                _context9.next = 2;
                return _regeneratorRuntime.awrap(this.getMasterKey(password));

              case 2:
                masterKey = _context9.sent;
                vector = crypto.getRandomValues(new Uint8Array(16));
                _context9.prev = 4;
                _context9.next = 7;
                return _regeneratorRuntime.awrap(encryptAES(vector, masterKey, toArrayBuffer(private_key)));

              case 7:
                encodedPrivateKey = _context9.sent;
                return _context9.abrupt("return", EJSON.stringify(joinVectorAndEcryptedData(vector, encodedPrivateKey)));

              case 11:
                _context9.prev = 11;
                _context9.t0 = _context9["catch"](4);
                return _context9.abrupt("return", this.error('Error encrypting encodedPrivateKey: ', _context9.t0));

              case 14:
              case "end":
                return _context9.stop();
            }
          }
        }

        return encodePrivateKey$;
      }(), null, this, [[4, 11]], Promise);
    }

    return encodePrivateKey;
  }();

  _proto.getMasterKey = function () {
    function getMasterKey(password) {
      var baseKey;
      return _regeneratorRuntime.async(function () {
        function getMasterKey$(_context10) {
          while (1) {
            switch (_context10.prev = _context10.next) {
              case 0:
                if (password == null) {
                  alert('You should provide a password');
                } // First, create a PBKDF2 "key" containing the password


                _context10.prev = 1;
                _context10.next = 4;
                return _regeneratorRuntime.awrap(importRawKey(toArrayBuffer(password)));

              case 4:
                baseKey = _context10.sent;
                _context10.next = 10;
                break;

              case 7:
                _context10.prev = 7;
                _context10.t0 = _context10["catch"](1);
                return _context10.abrupt("return", this.error('Error creating a key based on user password: ', _context10.t0));

              case 10:
                _context10.prev = 10;
                _context10.next = 13;
                return _regeneratorRuntime.awrap(deriveKey(toArrayBuffer(Meteor.userId()), baseKey));

              case 13:
                return _context10.abrupt("return", _context10.sent);

              case 16:
                _context10.prev = 16;
                _context10.t1 = _context10["catch"](10);
                return _context10.abrupt("return", this.error('Error deriving baseKey: ', _context10.t1));

              case 19:
              case "end":
                return _context10.stop();
            }
          }
        }

        return getMasterKey$;
      }(), null, this, [[1, 7], [10, 16]], Promise);
    }

    return getMasterKey;
  }();

  _proto.requestPassword = function () {
    function requestPassword() {
      var _this3 = this;

      return _regeneratorRuntime.async(function () {
        function requestPassword$(_context11) {
          while (1) {
            switch (_context11.prev = _context11.next) {
              case 0:
                return _context11.abrupt("return", new Promise(function (resolve) {
                  var showModal = function () {
                    imperativeModal.open({
                      component: EnterE2EPasswordModal,
                      props: {
                        onClose: imperativeModal.close,
                        onCancel: function () {
                          failedToDecodeKey = false;

                          _this3.closeAlert();

                          imperativeModal.close();
                        },
                        onConfirm: function (password) {
                          resolve(password);

                          _this3.closeAlert();

                          imperativeModal.close();
                        }
                      }
                    });
                  };

                  var showAlert = function () {
                    _this3.openAlert({
                      title: TAPi18n.__('Enter_your_E2E_password'),
                      html: TAPi18n.__('Click_here_to_enter_your_encryption_password'),
                      modifiers: ['large'],
                      closable: false,
                      icon: 'key',
                      action: function () {
                        showModal();
                      }
                    });
                  };

                  if (failedToDecodeKey) {
                    showModal();
                  } else {
                    showAlert();
                  }
                }));

              case 1:
              case "end":
                return _context11.stop();
            }
          }
        }

        return requestPassword$;
      }(), null, null, null, Promise);
    }

    return requestPassword;
  }();

  _proto.decodePrivateKey = function () {
    function decodePrivateKey(private_key) {
      var password, masterKey, _splitVectorAndEcrypt, _splitVectorAndEcrypt2, vector, cipherText, privKey;

      return _regeneratorRuntime.async(function () {
        function decodePrivateKey$(_context12) {
          while (1) {
            switch (_context12.prev = _context12.next) {
              case 0:
                _context12.next = 2;
                return _regeneratorRuntime.awrap(this.requestPassword());

              case 2:
                password = _context12.sent;
                _context12.next = 5;
                return _regeneratorRuntime.awrap(this.getMasterKey(password));

              case 5:
                masterKey = _context12.sent;
                _splitVectorAndEcrypt = splitVectorAndEcryptedData(EJSON.parse(private_key)), _splitVectorAndEcrypt2 = _slicedToArray(_splitVectorAndEcrypt, 2), vector = _splitVectorAndEcrypt2[0], cipherText = _splitVectorAndEcrypt2[1];
                _context12.prev = 7;
                _context12.next = 10;
                return _regeneratorRuntime.awrap(decryptAES(vector, masterKey, cipherText));

              case 10:
                privKey = _context12.sent;
                return _context12.abrupt("return", toString(privKey));

              case 14:
                _context12.prev = 14;
                _context12.t0 = _context12["catch"](7);
                throw new Error('E2E -> Error decrypting private key');

              case 17:
              case "end":
                return _context12.stop();
            }
          }
        }

        return decodePrivateKey$;
      }(), null, this, [[7, 14]], Promise);
    }

    return decodePrivateKey;
  }();

  _proto.decryptMessage = function () {
    function decryptMessage(message) {
      var e2eRoom, data;
      return _regeneratorRuntime.async(function () {
        function decryptMessage$(_context13) {
          while (1) {
            switch (_context13.prev = _context13.next) {
              case 0:
                if (!(message.t !== 'e2e' || message.e2e === 'done')) {
                  _context13.next = 2;
                  break;
                }

                return _context13.abrupt("return", message);

              case 2:
                _context13.next = 4;
                return _regeneratorRuntime.awrap(this.getInstanceByRoomId(message.rid));

              case 4:
                e2eRoom = _context13.sent;

                if (e2eRoom) {
                  _context13.next = 7;
                  break;
                }

                return _context13.abrupt("return", message);

              case 7:
                _context13.next = 9;
                return _regeneratorRuntime.awrap(e2eRoom.decrypt(message.msg));

              case 9:
                data = _context13.sent;

                if (data) {
                  _context13.next = 12;
                  break;
                }

                return _context13.abrupt("return", message);

              case 12:
                return _context13.abrupt("return", _objectSpread(_objectSpread({}, message), {}, {
                  msg: data.text,
                  e2e: 'done'
                }));

              case 13:
              case "end":
                return _context13.stop();
            }
          }
        }

        return decryptMessage$;
      }(), null, this, null, Promise);
    }

    return decryptMessage;
  }();

  _proto.decryptPendingMessages = function () {
    function decryptPendingMessages() {
      var _this4 = this;

      return _regeneratorRuntime.async(function () {
        function decryptPendingMessages$(_context15) {
          while (1) {
            switch (_context15.prev = _context15.next) {
              case 0:
                return _context15.abrupt("return", Messages.find({
                  t: 'e2e',
                  e2e: 'pending'
                }).forEach(function () {
                  function _callee(_ref2) {
                    var _id, msg;

                    return _regeneratorRuntime.async(function () {
                      function _callee$(_context14) {
                        while (1) {
                          switch (_context14.prev = _context14.next) {
                            case 0:
                              _id = _ref2._id, msg = _objectWithoutProperties(_ref2, _excluded);
                              _context14.t0 = Messages.direct;
                              _context14.t1 = {
                                _id: _id
                              };
                              _context14.next = 5;
                              return _regeneratorRuntime.awrap(_this4.decryptMessage(msg));

                            case 5:
                              _context14.t2 = _context14.sent;

                              _context14.t0.update.call(_context14.t0, _context14.t1, _context14.t2);

                            case 7:
                            case "end":
                              return _context14.stop();
                          }
                        }
                      }

                      return _callee$;
                    }(), null, null, null, Promise);
                  }

                  return _callee;
                }()));

              case 1:
              case "end":
                return _context15.stop();
            }
          }
        }

        return decryptPendingMessages$;
      }(), null, null, null, Promise);
    }

    return decryptPendingMessages;
  }();

  _proto.decryptSubscription = function () {
    function decryptSubscription(rid) {
      var e2eRoom;
      return _regeneratorRuntime.async(function () {
        function decryptSubscription$(_context16) {
          while (1) {
            switch (_context16.prev = _context16.next) {
              case 0:
                _context16.next = 2;
                return _regeneratorRuntime.awrap(this.getInstanceByRoomId(rid));

              case 2:
                e2eRoom = _context16.sent;
                this.log('decryptSubscription ->', rid);
                e2eRoom === null || e2eRoom === void 0 ? void 0 : e2eRoom.decryptSubscription();

              case 5:
              case "end":
                return _context16.stop();
            }
          }
        }

        return decryptSubscription$;
      }(), null, this, null, Promise);
    }

    return decryptSubscription;
  }();

  _proto.decryptSubscriptions = function () {
    function decryptSubscriptions() {
      var _this5 = this;

      return _regeneratorRuntime.async(function () {
        function decryptSubscriptions$(_context17) {
          while (1) {
            switch (_context17.prev = _context17.next) {
              case 0:
                Subscriptions.find({
                  encrypted: true
                }).forEach(function (room) {
                  return _this5.decryptSubscription(room._id);
                });

              case 1:
              case "end":
                return _context17.stop();
            }
          }
        }

        return decryptSubscriptions$;
      }(), null, null, null, Promise);
    }

    return decryptSubscriptions;
  }();

  _proto.openAlert = function () {
    function openAlert(config) {
      banners.open(_objectSpread({
        id: 'e2e'
      }, config));
    }

    return openAlert;
  }();

  _proto.closeAlert = function () {
    function closeAlert() {
      banners.closeById('e2e');
    }

    return closeAlert;
  }();

  return E2E;
}(Emitter);

var e2e = new E2E();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.e2e.room.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/rocketchat.e2e.room.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["_id"];

var _permitedMutations;

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 2);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 3);

var _createClass;

module.link("@babel/runtime/helpers/createClass", {
  default: function (v) {
    _createClass = v;
  }
}, 4);

var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 5);
module.export({
  E2ERoom: function () {
    return E2ERoom;
  }
});

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var Base64;
module.link("meteor/base64", {
  Base64: function (v) {
    Base64 = v;
  }
}, 1);
var EJSON;
module.link("meteor/ejson", {
  EJSON: function (v) {
    EJSON = v;
  }
}, 2);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 3);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 4);
var TimeSync;
module.link("meteor/mizzao:timesync", {
  TimeSync: function (v) {
    TimeSync = v;
  }
}, 5);
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 6);
var e2e;
module.link("./rocketchat.e2e", {
  e2e: function (v) {
    e2e = v;
  }
}, 7);
var toString, toArrayBuffer, joinVectorAndEcryptedData, splitVectorAndEcryptedData, encryptRSA, encryptAES, decryptRSA, decryptAES, generateAESKey, exportJWKKey, importAESKey, importRSAKey, readFileAsArrayBuffer;
module.link("./helper", {
  toString: function (v) {
    toString = v;
  },
  toArrayBuffer: function (v) {
    toArrayBuffer = v;
  },
  joinVectorAndEcryptedData: function (v) {
    joinVectorAndEcryptedData = v;
  },
  splitVectorAndEcryptedData: function (v) {
    splitVectorAndEcryptedData = v;
  },
  encryptRSA: function (v) {
    encryptRSA = v;
  },
  encryptAES: function (v) {
    encryptAES = v;
  },
  decryptRSA: function (v) {
    decryptRSA = v;
  },
  decryptAES: function (v) {
    decryptAES = v;
  },
  generateAESKey: function (v) {
    generateAESKey = v;
  },
  exportJWKKey: function (v) {
    exportJWKKey = v;
  },
  importAESKey: function (v) {
    importAESKey = v;
  },
  importRSAKey: function (v) {
    importRSAKey = v;
  },
  readFileAsArrayBuffer: function (v) {
    readFileAsArrayBuffer = v;
  }
}, 8);
var Notifications;
module.link("../../notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 9);
var Rooms, Subscriptions, Messages;
module.link("../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  },
  Messages: function (v) {
    Messages = v;
  }
}, 10);
var roomTypes, RoomSettingsEnum;
module.link("../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  },
  RoomSettingsEnum: function (v) {
    RoomSettingsEnum = v;
  }
}, 11);

var _log, logError;

module.link("./logger", {
  log: function (v) {
    _log = v;
  },
  logError: function (v) {
    logError = v;
  }
}, 12);
var E2ERoomState;
module.link("./E2ERoomState", {
  E2ERoomState: function (v) {
    E2ERoomState = v;
  }
}, 13);
var call;
module.link("../../../client/lib/utils/call", {
  call: function (v) {
    call = v;
  }
}, 14);
var KEY_ID = Symbol('keyID');
var PAUSED = Symbol('PAUSED');
var permitedMutations = (_permitedMutations = {}, _permitedMutations[E2ERoomState.NOT_STARTED] = [E2ERoomState.ESTABLISHING, E2ERoomState.DISABLED, E2ERoomState.KEYS_RECEIVED], _permitedMutations[E2ERoomState.READY] = [E2ERoomState.DISABLED], _permitedMutations[E2ERoomState.ERROR] = [E2ERoomState.KEYS_RECEIVED, E2ERoomState.NOT_STARTED], _permitedMutations[E2ERoomState.WAITING_KEYS] = [E2ERoomState.KEYS_RECEIVED, E2ERoomState.ERROR, E2ERoomState.DISABLED], _permitedMutations[E2ERoomState.ESTABLISHING] = [E2ERoomState.READY, E2ERoomState.KEYS_RECEIVED, E2ERoomState.ERROR, E2ERoomState.DISABLED, E2ERoomState.WAITING_KEYS], _permitedMutations);

var filterMutation = function (currentState, nextState) {
  if (currentState === nextState) {
    return nextState === E2ERoomState.ERROR;
  }

  if (!(currentState in permitedMutations)) {
    return nextState;
  }

  if (permitedMutations[currentState].includes(nextState)) {
    return nextState;
  }

  return false;
};

var E2ERoom = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(E2ERoom, _Emitter);

  function E2ERoom(userId, roomId, t) {
    var _this;

    _this = _Emitter.call(this) || this;
    _this.state = undefined;
    _this[PAUSED] = undefined;
    _this.userId = userId;
    _this.roomId = roomId;
    _this.typeOfRoom = t;

    _this.once(E2ERoomState.READY, function () {
      return _this.decryptPendingMessages();
    });

    _this.once(E2ERoomState.READY, function () {
      return _this.decryptSubscription();
    });

    _this.on('STATE_CHANGED', function (prev) {
      if (_this.roomId === Session.get('openedRoom')) {
        _this.log("[PREV: " + prev + "]", 'State CHANGED');
      }
    });

    _this.on('STATE_CHANGED', function () {
      return _this.handshake();
    });

    _this.setState(E2ERoomState.NOT_STARTED);

    return _this;
  }

  var _proto = E2ERoom.prototype;

  _proto.log = function () {
    function log() {
      for (var _len = arguments.length, msg = new Array(_len), _key = 0; _key < _len; _key++) {
        msg[_key] = arguments[_key];
      }

      _log.apply(void 0, ["E2E ROOM { state: " + this.state + ", rid: " + this.roomId + " }"].concat(msg));
    }

    return log;
  }();

  _proto.error = function () {
    function error() {
      for (var _len2 = arguments.length, msg = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        msg[_key2] = arguments[_key2];
      }

      logError.apply(void 0, ["E2E ROOM { state: " + this.state + ", rid: " + this.roomId + " }"].concat(msg));
    }

    return error;
  }();

  _proto.setState = function () {
    function setState(requestedState) {
      var currentState = this.state;
      var nextState = filterMutation(currentState, requestedState);

      if (!nextState) {
        this.error("invalid state " + currentState + " -> " + requestedState);
        return;
      }

      this.state = nextState;
      this.log(currentState, '->', nextState);
      this.emit('STATE_CHANGED', currentState, nextState, this);
      this.emit(nextState, this);
    }

    return setState;
  }();

  _proto.isReady = function () {
    function isReady() {
      return this.state === E2ERoomState.READY;
    }

    return isReady;
  }();

  _proto.isDisabled = function () {
    function isDisabled() {
      return this.state === E2ERoomState.DISABLED;
    }

    return isDisabled;
  }();

  _proto.enable = function () {
    function enable() {
      if (this.state === E2ERoomState.READY) {
        return;
      }

      this.setState(E2ERoomState.READY);
    }

    return enable;
  }();

  _proto.disable = function () {
    function disable() {
      this.setState(E2ERoomState.DISABLED);
    }

    return disable;
  }();

  _proto.pause = function () {
    function pause() {
      this.log('PAUSED', this[PAUSED], '->', true);
      this[PAUSED] = true;
      this.emit('PAUSED', true);
    }

    return pause;
  }();

  _proto.resume = function () {
    function resume() {
      this.log('PAUSED', this[PAUSED], '->', false);
      this[PAUSED] = false;
      this.emit('PAUSED', false);
    }

    return resume;
  }();

  _proto.keyReceived = function () {
    function keyReceived() {
      this.setState(E2ERoomState.KEYS_RECEIVED);
    }

    return keyReceived;
  }();

  _proto.shouldConvertSentMessages = function () {
    function shouldConvertSentMessages() {
      var _this2 = this;

      return _regeneratorRuntime.async(function () {
        function shouldConvertSentMessages$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (!(!this.isReady() || this[PAUSED])) {
                  _context.next = 2;
                  break;
                }

                return _context.abrupt("return", false);

              case 2:
                if (!(this[PAUSED] === undefined)) {
                  _context.next = 4;
                  break;
                }

                return _context.abrupt("return", new Promise(function (resolve) {
                  _this2.once('PAUSED', resolve);
                }));

              case 4:
                return _context.abrupt("return", true);

              case 5:
              case "end":
                return _context.stop();
            }
          }
        }

        return shouldConvertSentMessages$;
      }(), null, this, null, Promise);
    }

    return shouldConvertSentMessages;
  }();

  _proto.shouldConvertReceivedMessages = function () {
    function shouldConvertReceivedMessages() {
      return this.isReady();
    }

    return shouldConvertReceivedMessages;
  }();

  _proto.isWaitingKeys = function () {
    function isWaitingKeys() {
      return this.state === E2ERoomState.WAITING_KEYS;
    }

    return isWaitingKeys;
  }();

  _proto.decryptSubscription = function () {
    function decryptSubscription() {
      var _subscription$lastMes;

      var subscription, data;
      return _regeneratorRuntime.async(function () {
        function decryptSubscription$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                subscription = Subscriptions.findOne({
                  rid: this.roomId
                });
                _context2.next = 3;
                return _regeneratorRuntime.awrap(((_subscription$lastMes = subscription.lastMessage) === null || _subscription$lastMes === void 0 ? void 0 : _subscription$lastMes.msg) && this.decrypt(subscription.lastMessage.msg));

              case 3:
                data = _context2.sent;

                if (data !== null && data !== void 0 && data.text) {
                  _context2.next = 7;
                  break;
                }

                this.log('decryptSubscriptions nothing to do');
                return _context2.abrupt("return");

              case 7:
                Subscriptions.direct.update({
                  _id: subscription._id
                }, {
                  $set: {
                    'lastMessage.msg': data.text,
                    'lastMessage.e2e': 'done'
                  }
                });
                this.log('decryptSubscriptions Done');

              case 9:
              case "end":
                return _context2.stop();
            }
          }
        }

        return decryptSubscription$;
      }(), null, this, null, Promise);
    }

    return decryptSubscription;
  }();

  _proto.decryptPendingMessages = function () {
    function decryptPendingMessages() {
      var _this3 = this;

      return _regeneratorRuntime.async(function () {
        function decryptPendingMessages$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                return _context4.abrupt("return", Messages.find({
                  rid: this.roomId,
                  t: 'e2e',
                  e2e: 'pending'
                }).forEach(function () {
                  function _callee(_ref) {
                    var _id, msg;

                    return _regeneratorRuntime.async(function () {
                      function _callee$(_context3) {
                        while (1) {
                          switch (_context3.prev = _context3.next) {
                            case 0:
                              _id = _ref._id, msg = _objectWithoutProperties(_ref, _excluded);
                              _context3.t0 = Messages.direct;
                              _context3.t1 = {
                                _id: _id
                              };
                              _context3.next = 5;
                              return _regeneratorRuntime.awrap(_this3.decryptMessage(msg));

                            case 5:
                              _context3.t2 = _context3.sent;

                              _context3.t0.update.call(_context3.t0, _context3.t1, _context3.t2);

                            case 7:
                            case "end":
                              return _context3.stop();
                          }
                        }
                      }

                      return _callee$;
                    }(), null, null, null, Promise);
                  }

                  return _callee;
                }()));

              case 1:
              case "end":
                return _context4.stop();
            }
          }
        }

        return decryptPendingMessages$;
      }(), null, this, null, Promise);
    }

    return decryptPendingMessages;
  }() // Initiates E2E Encryption
  ;

  _proto.handshake = function () {
    function handshake() {
      var groupKey, room;
      return _regeneratorRuntime.async(function () {
        function handshake$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                if (!(this.state !== E2ERoomState.KEYS_RECEIVED && this.state !== E2ERoomState.NOT_STARTED)) {
                  _context5.next = 2;
                  break;
                }

                return _context5.abrupt("return");

              case 2:
                this.setState(E2ERoomState.ESTABLISHING);
                _context5.prev = 3;
                groupKey = Subscriptions.findOne({
                  rid: this.roomId
                }).E2EKey;

                if (!groupKey) {
                  _context5.next = 10;
                  break;
                }

                _context5.next = 8;
                return _regeneratorRuntime.awrap(this.importGroupKey(groupKey));

              case 8:
                this.setState(E2ERoomState.READY);
                return _context5.abrupt("return");

              case 10:
                _context5.next = 17;
                break;

              case 12:
                _context5.prev = 12;
                _context5.t0 = _context5["catch"](3);
                this.setState(E2ERoomState.ERROR);
                this.error('Error fetching group key: ', _context5.t0);
                return _context5.abrupt("return");

              case 17:
                _context5.prev = 17;
                room = Rooms.findOne({
                  _id: this.roomId
                });

                if (room.e2eKeyId) {
                  _context5.next = 25;
                  break;
                }

                // TODO CHECK_PERMISSION
                this.setState(E2ERoomState.CREATING_KEYS);
                _context5.next = 23;
                return _regeneratorRuntime.awrap(this.createGroupKey());

              case 23:
                this.setState(E2ERoomState.READY);
                return _context5.abrupt("return");

              case 25:
                this.setState(E2ERoomState.WAITING_KEYS);
                this.log('Requesting room key');
                Notifications.notifyUsersOfRoom(this.roomId, 'e2ekeyRequest', this.roomId, room.e2eKeyId);
                _context5.next = 33;
                break;

              case 30:
                _context5.prev = 30;
                _context5.t1 = _context5["catch"](17);
                // this.error = error;
                this.setState(E2ERoomState.ERROR);

              case 33:
              case "end":
                return _context5.stop();
            }
          }
        }

        return handshake$;
      }(), null, this, [[3, 12], [17, 30]], Promise);
    }

    return handshake;
  }();

  _proto.isSupportedRoomType = function () {
    function isSupportedRoomType(type) {
      return roomTypes.getConfig(type).allowRoomSettingChange({}, RoomSettingsEnum.E2E);
    }

    return isSupportedRoomType;
  }();

  _proto.importGroupKey = function () {
    function importGroupKey(groupKey) {
      var decryptedKey, key;
      return _regeneratorRuntime.async(function () {
        function importGroupKey$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                this.log('Importing room key ->', this.roomId); // Get existing group key
                // const keyID = groupKey.slice(0, 12);

                groupKey = groupKey.slice(12);
                groupKey = Base64.decode(groupKey); // Decrypt obtained encrypted session key

                _context6.prev = 3;
                _context6.next = 6;
                return _regeneratorRuntime.awrap(decryptRSA(e2e.privateKey, groupKey));

              case 6:
                decryptedKey = _context6.sent;
                this.sessionKeyExportedString = toString(decryptedKey);
                _context6.next = 13;
                break;

              case 10:
                _context6.prev = 10;
                _context6.t0 = _context6["catch"](3);
                return _context6.abrupt("return", this.error('Error decrypting group key: ', _context6.t0));

              case 13:
                this.keyID = Base64.encode(this.sessionKeyExportedString).slice(0, 12); // Import session key for use.

                _context6.prev = 14;
                _context6.next = 17;
                return _regeneratorRuntime.awrap(importAESKey(JSON.parse(this.sessionKeyExportedString)));

              case 17:
                key = _context6.sent;
                // Key has been obtained. E2E is now in session.
                this.groupSessionKey = key;
                _context6.next = 24;
                break;

              case 21:
                _context6.prev = 21;
                _context6.t1 = _context6["catch"](14);
                return _context6.abrupt("return", this.error('Error importing group key: ', _context6.t1));

              case 24:
              case "end":
                return _context6.stop();
            }
          }
        }

        return importGroupKey$;
      }(), null, this, [[3, 10], [14, 21]], Promise);
    }

    return importGroupKey;
  }();

  _proto.createGroupKey = function () {
    function createGroupKey() {
      var sessionKeyExported;
      return _regeneratorRuntime.async(function () {
        function createGroupKey$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                this.log('Creating room key'); // Create group key

                _context7.prev = 1;
                _context7.next = 4;
                return _regeneratorRuntime.awrap(generateAESKey());

              case 4:
                this.groupSessionKey = _context7.sent;
                _context7.next = 11;
                break;

              case 7:
                _context7.prev = 7;
                _context7.t0 = _context7["catch"](1);
                console.error('Error generating group key: ', _context7.t0);
                throw _context7.t0;

              case 11:
                _context7.prev = 11;
                _context7.next = 14;
                return _regeneratorRuntime.awrap(exportJWKKey(this.groupSessionKey));

              case 14:
                sessionKeyExported = _context7.sent;
                this.sessionKeyExportedString = JSON.stringify(sessionKeyExported);
                this.keyID = Base64.encode(this.sessionKeyExportedString).slice(0, 12);
                _context7.next = 19;
                return _regeneratorRuntime.awrap(call('e2e.setRoomKeyID', this.roomId, this.keyID));

              case 19:
                _context7.next = 21;
                return _regeneratorRuntime.awrap(this.encryptKeyForOtherParticipants());

              case 21:
                _context7.next = 27;
                break;

              case 23:
                _context7.prev = 23;
                _context7.t1 = _context7["catch"](11);
                this.error('Error exporting group key: ', _context7.t1);
                throw _context7.t1;

              case 27:
              case "end":
                return _context7.stop();
            }
          }
        }

        return createGroupKey$;
      }(), null, this, [[1, 7], [11, 23]], Promise);
    }

    return createGroupKey;
  }();

  _proto.encryptKeyForOtherParticipants = function () {
    function encryptKeyForOtherParticipants() {
      var _this4 = this;

      var _await$call, users;

      return _regeneratorRuntime.async(function () {
        function encryptKeyForOtherParticipants$(_context8) {
          while (1) {
            switch (_context8.prev = _context8.next) {
              case 0:
                _context8.prev = 0;
                _context8.next = 3;
                return _regeneratorRuntime.awrap(call('e2e.getUsersOfRoomWithoutKey', this.roomId));

              case 3:
                _await$call = _context8.sent;
                users = _await$call.users;
                users.forEach(function (user) {
                  return _this4.encryptForParticipant(user);
                });
                _context8.next = 11;
                break;

              case 8:
                _context8.prev = 8;
                _context8.t0 = _context8["catch"](0);
                return _context8.abrupt("return", this.error('Error getting room users: ', _context8.t0));

              case 11:
              case "end":
                return _context8.stop();
            }
          }
        }

        return encryptKeyForOtherParticipants$;
      }(), null, this, [[0, 8]], Promise);
    }

    return encryptKeyForOtherParticipants;
  }();

  _proto.encryptForParticipant = function () {
    function encryptForParticipant(user) {
      var userKey, encryptedUserKey;
      return _regeneratorRuntime.async(function () {
        function encryptForParticipant$(_context9) {
          while (1) {
            switch (_context9.prev = _context9.next) {
              case 0:
                _context9.prev = 0;
                _context9.next = 3;
                return _regeneratorRuntime.awrap(importRSAKey(JSON.parse(user.e2e.public_key), ['encrypt']));

              case 3:
                userKey = _context9.sent;
                _context9.next = 9;
                break;

              case 6:
                _context9.prev = 6;
                _context9.t0 = _context9["catch"](0);
                return _context9.abrupt("return", this.error('Error importing user key: ', _context9.t0));

              case 9:
                _context9.prev = 9;
                _context9.next = 12;
                return _regeneratorRuntime.awrap(encryptRSA(userKey, toArrayBuffer(this.sessionKeyExportedString)));

              case 12:
                encryptedUserKey = _context9.sent;
                _context9.next = 15;
                return _regeneratorRuntime.awrap(call('e2e.updateGroupKey', this.roomId, user._id, this.keyID + Base64.encode(new Uint8Array(encryptedUserKey))));

              case 15:
                _context9.next = 20;
                break;

              case 17:
                _context9.prev = 17;
                _context9.t1 = _context9["catch"](9);
                return _context9.abrupt("return", this.error('Error encrypting user key: ', _context9.t1));

              case 20:
              case "end":
                return _context9.stop();
            }
          }
        }

        return encryptForParticipant$;
      }(), null, this, [[0, 6], [9, 17]], Promise);
    }

    return encryptForParticipant;
  }() // Encrypts files before upload. I/O is in arraybuffers.
  ;

  _proto.encryptFile = function () {
    function encryptFile(file) {
      var fileArrayBuffer, vector, result, output, encryptedFile;
      return _regeneratorRuntime.async(function () {
        function encryptFile$(_context10) {
          while (1) {
            switch (_context10.prev = _context10.next) {
              case 0:
                if (this.isSupportedRoomType(this.typeOfRoom)) {
                  _context10.next = 2;
                  break;
                }

                return _context10.abrupt("return");

              case 2:
                _context10.next = 4;
                return _regeneratorRuntime.awrap(readFileAsArrayBuffer(file));

              case 4:
                fileArrayBuffer = _context10.sent;
                vector = crypto.getRandomValues(new Uint8Array(16));
                _context10.prev = 6;
                _context10.next = 9;
                return _regeneratorRuntime.awrap(encryptAES(vector, this.groupSessionKey, fileArrayBuffer));

              case 9:
                result = _context10.sent;
                _context10.next = 15;
                break;

              case 12:
                _context10.prev = 12;
                _context10.t0 = _context10["catch"](6);
                return _context10.abrupt("return", this.error('Error encrypting group key: ', _context10.t0));

              case 15:
                output = joinVectorAndEcryptedData(vector, result);
                encryptedFile = new File([toArrayBuffer(EJSON.stringify(output))], file.name);
                return _context10.abrupt("return", encryptedFile);

              case 18:
              case "end":
                return _context10.stop();
            }
          }
        }

        return encryptFile$;
      }(), null, this, [[6, 12]], Promise);
    }

    return encryptFile;
  }() // Decrypt uploaded encrypted files. I/O is in arraybuffers.
  ;

  _proto.decryptFile = function () {
    function decryptFile(message) {
      var _splitVectorAndEcrypt, _splitVectorAndEcrypt2, vector, cipherText;

      return _regeneratorRuntime.async(function () {
        function decryptFile$(_context11) {
          while (1) {
            switch (_context11.prev = _context11.next) {
              case 0:
                if (!(message[0] !== '{')) {
                  _context11.next = 2;
                  break;
                }

                return _context11.abrupt("return");

              case 2:
                _splitVectorAndEcrypt = splitVectorAndEcryptedData(EJSON.parse(message)), _splitVectorAndEcrypt2 = _slicedToArray(_splitVectorAndEcrypt, 2), vector = _splitVectorAndEcrypt2[0], cipherText = _splitVectorAndEcrypt2[1];
                _context11.prev = 3;
                _context11.next = 6;
                return _regeneratorRuntime.awrap(decryptAES(vector, this.groupSessionKey, cipherText));

              case 6:
                return _context11.abrupt("return", _context11.sent);

              case 9:
                _context11.prev = 9;
                _context11.t0 = _context11["catch"](3);
                this.error('Error decrypting file: ', _context11.t0);
                return _context11.abrupt("return", false);

              case 13:
              case "end":
                return _context11.stop();
            }
          }
        }

        return decryptFile$;
      }(), null, this, [[3, 9]], Promise);
    }

    return decryptFile;
  }() // Encrypts messages
  ;

  _proto.encryptText = function () {
    function encryptText(data) {
      var vector, result;
      return _regeneratorRuntime.async(function () {
        function encryptText$(_context12) {
          while (1) {
            switch (_context12.prev = _context12.next) {
              case 0:
                if (!_.isObject(data)) {
                  data = new TextEncoder('UTF-8').encode(EJSON.stringify({
                    text: data,
                    ack: Random.id((Random.fraction() + 1) * 20)
                  }));
                }

                if (this.isSupportedRoomType(this.typeOfRoom)) {
                  _context12.next = 3;
                  break;
                }

                return _context12.abrupt("return", data);

              case 3:
                vector = crypto.getRandomValues(new Uint8Array(16));
                _context12.prev = 4;
                _context12.next = 7;
                return _regeneratorRuntime.awrap(encryptAES(vector, this.groupSessionKey, data));

              case 7:
                result = _context12.sent;
                _context12.next = 13;
                break;

              case 10:
                _context12.prev = 10;
                _context12.t0 = _context12["catch"](4);
                return _context12.abrupt("return", this.error('Error encrypting message: ', _context12.t0));

              case 13:
                return _context12.abrupt("return", this.keyID + Base64.encode(joinVectorAndEcryptedData(vector, result)));

              case 14:
              case "end":
                return _context12.stop();
            }
          }
        }

        return encryptText$;
      }(), null, this, [[4, 10]], Promise);
    }

    return encryptText;
  }() // Helper function for encryption of messages
  ;

  _proto.encrypt = function () {
    function encrypt(message) {
      var ts;

      if (isNaN(TimeSync.serverOffset())) {
        ts = new Date();
      } else {
        ts = new Date(Date.now() + TimeSync.serverOffset());
      }

      var data = new TextEncoder('UTF-8').encode(EJSON.stringify({
        _id: message._id,
        text: message.msg,
        userId: this.userId,
        ts: ts
      }));
      return this.encryptText(data);
    }

    return encrypt;
  }() // Decrypt messages
  ;

  _proto.decryptMessage = function () {
    function decryptMessage(message) {
      var data;
      return _regeneratorRuntime.async(function () {
        function decryptMessage$(_context13) {
          while (1) {
            switch (_context13.prev = _context13.next) {
              case 0:
                if (!(message.t !== 'e2e' || message.e2e === 'done')) {
                  _context13.next = 2;
                  break;
                }

                return _context13.abrupt("return", message);

              case 2:
                _context13.next = 4;
                return _regeneratorRuntime.awrap(this.decrypt(message.msg));

              case 4:
                data = _context13.sent;

                if (data !== null && data !== void 0 && data.text) {
                  _context13.next = 7;
                  break;
                }

                return _context13.abrupt("return", message);

              case 7:
                return _context13.abrupt("return", _objectSpread(_objectSpread({}, message), {}, {
                  msg: data.text,
                  e2e: 'done'
                }));

              case 8:
              case "end":
                return _context13.stop();
            }
          }
        }

        return decryptMessage$;
      }(), null, this, null, Promise);
    }

    return decryptMessage;
  }();

  _proto.decrypt = function () {
    function decrypt(message) {
      var keyID, _splitVectorAndEcrypt3, _splitVectorAndEcrypt4, vector, cipherText, result;

      return _regeneratorRuntime.async(function () {
        function decrypt$(_context14) {
          while (1) {
            switch (_context14.prev = _context14.next) {
              case 0:
                if (this.isSupportedRoomType(this.typeOfRoom)) {
                  _context14.next = 2;
                  break;
                }

                return _context14.abrupt("return", message);

              case 2:
                keyID = message.slice(0, 12);

                if (!(keyID !== this.keyID)) {
                  _context14.next = 5;
                  break;
                }

                return _context14.abrupt("return", message);

              case 5:
                message = message.slice(12);
                _splitVectorAndEcrypt3 = splitVectorAndEcryptedData(Base64.decode(message)), _splitVectorAndEcrypt4 = _slicedToArray(_splitVectorAndEcrypt3, 2), vector = _splitVectorAndEcrypt4[0], cipherText = _splitVectorAndEcrypt4[1];
                _context14.prev = 7;
                _context14.next = 10;
                return _regeneratorRuntime.awrap(decryptAES(vector, this.groupSessionKey, cipherText));

              case 10:
                result = _context14.sent;
                return _context14.abrupt("return", EJSON.parse(new TextDecoder('UTF-8').decode(new Uint8Array(result))));

              case 14:
                _context14.prev = 14;
                _context14.t0 = _context14["catch"](7);
                return _context14.abrupt("return", this.error('Error decrypting message: ', _context14.t0, message));

              case 17:
              case "end":
                return _context14.stop();
            }
          }
        }

        return decrypt$;
      }(), null, this, [[7, 14]], Promise);
    }

    return decrypt;
  }();

  _proto.provideKeyToUser = function () {
    function provideKeyToUser(keyId) {
      if (this.keyID !== keyId) {
        return;
      }

      this.encryptKeyForOtherParticipants();
    }

    return provideKeyToUser;
  }();

  _createClass(E2ERoom, [{
    key: "keyID",
    get: function () {
      return this[KEY_ID];
    },
    set: function (keyID) {
      this[KEY_ID] = keyID;
    }
  }]);

  return E2ERoom;
}(Emitter);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabbar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/e2e/client/tabbar.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMemo, useCallback;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  },
  useCallback: function (v) {
    useCallback = v;
  }
}, 0);
var useMutableCallback;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback: function (v) {
    useMutableCallback = v;
  }
}, 1);
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 2);
var useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 3);
var usePermission;
module.link("../../../client/contexts/AuthorizationContext", {
  usePermission: function (v) {
    usePermission = v;
  }
}, 4);
var useMethod;
module.link("../../../client/contexts/ServerContext", {
  useMethod: function (v) {
    useMethod = v;
  }
}, 5);
var useReactiveValue;
module.link("../../../client/hooks/useReactiveValue", {
  useReactiveValue: function (v) {
    useReactiveValue = v;
  }
}, 6);
var e2e;
module.link("./rocketchat.e2e", {
  e2e: function (v) {
    e2e = v;
  }
}, 7);
addAction('e2e', function (_ref) {
  var room = _ref.room;
  var e2eEnabled = useSetting('E2E_Enable');
  var e2eReady = useReactiveValue(useCallback(function () {
    return e2e.isReady();
  }, [])) || room.encrypted;
  var canToggleE2e = usePermission('toggle-room-e2e-encryption', room._id);
  var canEditRoom = usePermission('edit-room', room._id);
  var hasPermission = (room.t === 'd' || canEditRoom && canToggleE2e) && e2eReady;
  var toggleE2E = useMethod('saveRoomSettings');
  var action = useMutableCallback(function () {
    toggleE2E(room._id, 'encrypted', !room.encrypted);
  });
  var enabledOnRoom = !!room.encrypted;
  return useMemo(function () {
    return e2eEnabled && hasPermission ? {
      groups: ['direct', 'direct_multiple', 'group', 'team'],
      id: 'e2e',
      title: enabledOnRoom ? 'E2E_disable' : 'E2E_enable',
      icon: 'key',
      order: 13,
      action: action
    } : null;
  }, [action, e2eEnabled, enabledOnRoom, hasPermission]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"models":{"client":{"models":{"Avatars.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/Avatars.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  Avatars: function () {
    return Avatars;
  }
});
var Base;
module.link("./_Base", {
  Base: function (v) {
    Base = v;
  }
}, 0);

var Avatars = /*#__PURE__*/function (_Base) {
  _inheritsLoose(Avatars, _Base);

  function Avatars() {
    var _this;

    _this = _Base.call(this) || this;

    _this._initModel('avatars');

    return _this;
  }

  return Avatars;
}(Base);

module.exportDefault(new Avatars());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"CachedChannelList.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/CachedChannelList.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CachedChannelList: function () {
    return CachedChannelList;
  }
});
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
var CachedChannelList = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"CachedChatRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/CachedChatRoom.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CachedChatRoom: function () {
    return CachedChatRoom;
  }
});
var CachedCollection;
module.link("../../../ui-cached-collection", {
  CachedCollection: function (v) {
    CachedCollection = v;
  }
}, 0);
var CachedChatRoom = new CachedCollection({
  name: 'rooms'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"CachedChatSubscription.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/CachedChatSubscription.js                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CachedChatSubscription: function () {
    return CachedChatSubscription;
  }
});
var CachedCollection;
module.link("../../../ui-cached-collection", {
  CachedCollection: function (v) {
    CachedCollection = v;
  }
}, 0);
var CachedChatSubscription = new CachedCollection({
  name: 'subscriptions'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"CachedUserList.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/CachedUserList.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CachedUserList: function () {
    return CachedUserList;
  }
});
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
var CachedUserList = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ChatMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/ChatMessage.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ChatMessage: function () {
    return ChatMessage;
  }
});
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
var ChatMessage = new Mongo.Collection(null);

ChatMessage.setReactions = function (messageId, reactions) {
  return this.update({
    _id: messageId
  }, {
    $set: {
      reactions: reactions
    }
  });
};

ChatMessage.unsetReactions = function (messageId) {
  return this.update({
    _id: messageId
  }, {
    $unset: {
      reactions: 1
    }
  });
};

ChatMessage.findOneByRoomIdAndMessageId = function (rid, messageId, options) {
  var query = {
    rid: rid,
    _id: messageId
  };
  return this.findOne(query, options);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ChatPermissions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/ChatPermissions.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AuthzCachedCollection: function () {
    return AuthzCachedCollection;
  },
  ChatPermissions: function () {
    return ChatPermissions;
  }
});
var CachedCollection;
module.link("../../../ui-cached-collection", {
  CachedCollection: function (v) {
    CachedCollection = v;
  }
}, 0);
var AuthzCachedCollection = new CachedCollection({
  name: 'permissions',
  eventType: 'onLogged'
});
var ChatPermissions = AuthzCachedCollection.collection;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ChatRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/ChatRoom.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ChatRoom: function () {
    return ChatRoom;
  }
});
var CachedChatRoom;
module.link("./CachedChatRoom", {
  CachedChatRoom: function (v) {
    CachedChatRoom = v;
  }
}, 0);
var ChatRoom = CachedChatRoom.collection;

ChatRoom.setReactionsInLastMessage = function (roomId, lastMessage) {
  return this.update({
    _id: roomId
  }, {
    $set: {
      lastMessage: lastMessage
    }
  });
};

ChatRoom.unsetReactionsInLastMessage = function (roomId) {
  return this.update({
    _id: roomId
  }, {
    $unset: {
      lastMessage: {
        reactions: 1
      }
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ChatSubscription.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/ChatSubscription.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ChatSubscription: function () {
    return ChatSubscription;
  }
});
var CachedChatSubscription;
module.link("./CachedChatSubscription", {
  CachedChatSubscription: function (v) {
    CachedChatSubscription = v;
  }
}, 0);
var ChatSubscription = CachedChatSubscription.collection;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"CustomSounds.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/CustomSounds.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  CustomSounds: function () {
    return CustomSounds;
  }
});
var Base;
module.link("./_Base", {
  Base: function (v) {
    Base = v;
  }
}, 0);

var CustomSounds = /*#__PURE__*/function (_Base) {
  _inheritsLoose(CustomSounds, _Base);

  function CustomSounds() {
    var _this;

    _this = _Base.call(this) || this;

    _this._initModel('custom_sounds');

    return _this;
  }

  return CustomSounds;
}(Base);

module.exportDefault(new CustomSounds());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"EmojiCustom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/EmojiCustom.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  EmojiCustom: function () {
    return EmojiCustom;
  }
});
var Base;
module.link("./_Base", {
  Base: function (v) {
    Base = v;
  }
}, 0);

var EmojiCustom = /*#__PURE__*/function (_Base) {
  _inheritsLoose(EmojiCustom, _Base);

  function EmojiCustom() {
    var _this;

    _this = _Base.call(this) || this;

    _this._initModel('custom_emoji');

    return _this;
  } // find


  var _proto = EmojiCustom.prototype;

  _proto.findByNameOrAlias = function () {
    function findByNameOrAlias(name, options) {
      var query = {
        $or: [{
          name: name
        }, {
          aliases: name
        }]
      };
      return this.find(query, options);
    }

    return findByNameOrAlias;
  }();

  return EmojiCustom;
}(Base);

module.exportDefault(new EmojiCustom());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Roles.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/Roles.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Roles: function () {
    return Roles;
  }
});
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Models;
module.link("..", {
  "*": function (v) {
    Models = v;
  }
}, 2);
var Roles = Object.assign(new Mongo.Collection(null), {
  findUsersInRole: function (name, scope, options) {
    var role = this.findOne(name);
    var roleScope = role && role.scope || 'Users';
    var model = Models[roleScope];
    return model && model.findUsersInRoles && model.findUsersInRoles(name, scope, options);
  },
  isUserInRoles: function (userId, roles, scope) {
    var _this = this;

    roles = [].concat(roles);
    return roles.some(function (roleName) {
      var role = _this.findOne(roleName);

      var roleScope = role && role.scope || 'Users';
      var model = Models[roleScope];
      return model && model.isUserInRole && model.isUserInRole(userId, roleName, scope);
    });
  },
  ready: new ReactiveVar(false)
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomRoles.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/RoomRoles.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RoomRoles: function () {
    return RoomRoles;
  }
});
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
var RoomRoles = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Subscriptions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/Subscriptions.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Subscriptions: function () {
    return Subscriptions;
  }
});

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var mem;
module.link("mem", {
  "default": function (v) {
    mem = v;
  }
}, 1);
var Users;
module.link("..", {
  Users: function (v) {
    Users = v;
  }
}, 2);
var Subscriptions = {};
Object.assign(Subscriptions, {
  isUserInRole: mem(function (userId, roleName, roomId) {
    if (roomId == null) {
      return false;
    }

    var query = {
      rid: roomId
    };
    var subscription = this.findOne(query, {
      fields: {
        roles: 1
      }
    });
    return subscription && Array.isArray(subscription.roles) && subscription.roles.includes(roleName);
  }, {
    maxAge: 1000,
    cacheKey: JSON.stringify
  }),
  findUsersInRoles: mem(function (roles, scope, options) {
    roles = [].concat(roles);
    var query = {
      roles: {
        $in: roles
      }
    };

    if (scope) {
      query.rid = scope;
    }

    var subscriptions = this.find(query).fetch();

    var users = _.compact(_.map(subscriptions, function (subscription) {
      if (typeof subscription.u !== 'undefined' && typeof subscription.u._id !== 'undefined') {
        return subscription.u._id;
      }
    }));

    return Users.find({
      _id: {
        $in: users
      }
    }, options);
  }, {
    maxAge: 1000,
    cacheKey: JSON.stringify
  })
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Uploads.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/Uploads.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  Uploads: function () {
    return Uploads;
  }
});
var Base;
module.link("./_Base", {
  Base: function (v) {
    Base = v;
  }
}, 0);

var Uploads = /*#__PURE__*/function (_Base) {
  _inheritsLoose(Uploads, _Base);

  function Uploads() {
    var _this;

    _this = _Base.call(this) || this;

    _this._initModel('uploads');

    return _this;
  }

  return Uploads;
}(Base);

module.exportDefault(new Uploads());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserAndRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/UserAndRoom.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  UserAndRoom: function () {
    return UserAndRoom;
  }
});
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
var UserAndRoom = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserDataFiles.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/UserDataFiles.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  UserDataFiles: function () {
    return UserDataFiles;
  }
});
var Base;
module.link("./_Base", {
  Base: function (v) {
    Base = v;
  }
}, 0);

var UserDataFiles = /*#__PURE__*/function (_Base) {
  _inheritsLoose(UserDataFiles, _Base);

  function UserDataFiles() {
    var _this;

    _this = _Base.call(this) || this;

    _this._initModel('userDataFiles');

    return _this;
  }

  return UserDataFiles;
}(Base);

module.exportDefault(new UserDataFiles());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserRoles.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/UserRoles.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  UserRoles: function () {
    return UserRoles;
  }
});
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
var UserRoles = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Users.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/Users.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Users: function () {
    return Users;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 1);
var Users = {
  findOneById: function (userId) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var query = {
      _id: userId
    };
    return this.findOne(query, options);
  },
  isUserInRole: function (userId, roleName) {
    var user = this.findOneById(userId, {
      fields: {
        roles: 1
      }
    });
    return user && Array.isArray(user.roles) && user.roles.includes(roleName);
  },
  findUsersInRoles: function (roles, scope, options) {
    roles = [].concat(roles);
    var query = {
      roles: {
        $in: roles
      }
    };
    return this.find(query, options);
  }
};
// overwrite Meteor.users collection so records on it don't get erased whenever the client reconnects to websocket
Meteor.users = new Mongo.Collection(null);

Meteor.user = function () {
  return Meteor.users.findOne({
    _id: Meteor.userId()
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"WebdavAccounts.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/WebdavAccounts.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  WebdavAccounts: function () {
    return WebdavAccounts;
  }
});
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
var WebdavAccounts = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"_Base.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/models/_Base.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Base: function () {
    return Base;
  }
});
var check;
module.link("meteor/check", {
  check: function (v) {
    check = v;
  }
}, 0);
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 1);

var Base = /*#__PURE__*/function () {
  function Base() {}

  var _proto = Base.prototype;

  _proto._baseName = function () {
    function _baseName() {
      return 'rocketchat_';
    }

    return _baseName;
  }();

  _proto._initModel = function () {
    function _initModel(name) {
      check(name, String);
      this.model = new Mongo.Collection(this._baseName() + name);
      return this.model;
    }

    return _initModel;
  }();

  _proto.find = function () {
    function find() {
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      return this.model.find.apply(this.model, args);
    }

    return find;
  }();

  _proto.findOne = function () {
    function findOne() {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }

      return this.model.findOne.apply(this.model, args);
    }

    return findOne;
  }();

  _proto.insert = function () {
    function insert() {
      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
        args[_key3] = arguments[_key3];
      }

      return this.model.insert.apply(this.model, args);
    }

    return insert;
  }();

  _proto.update = function () {
    function update() {
      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
        args[_key4] = arguments[_key4];
      }

      return this.model.update.apply(this.model, args);
    }

    return update;
  }();

  _proto.upsert = function () {
    function upsert() {
      for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
        args[_key5] = arguments[_key5];
      }

      return this.model.upsert.apply(this.model, args);
    }

    return upsert;
  }();

  _proto.remove = function () {
    function remove() {
      for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {
        args[_key6] = arguments[_key6];
      }

      return this.model.remove.apply(this.model, args);
    }

    return remove;
  }();

  _proto.allow = function () {
    function allow() {
      for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {
        args[_key7] = arguments[_key7];
      }

      return this.model.allow.apply(this.model, args);
    }

    return allow;
  }();

  _proto.deny = function () {
    function deny() {
      for (var _len8 = arguments.length, args = new Array(_len8), _key8 = 0; _key8 < _len8; _key8++) {
        args[_key8] = arguments[_key8];
      }

      return this.model.deny.apply(this.model, args);
    }

    return deny;
  }();

  _proto.ensureIndex = function () {
    function ensureIndex() {}

    return ensureIndex;
  }();

  _proto.dropIndex = function () {
    function dropIndex() {}

    return dropIndex;
  }();

  _proto.tryEnsureIndex = function () {
    function tryEnsureIndex() {}

    return tryEnsureIndex;
  }();

  _proto.tryDropIndex = function () {
    function tryDropIndex() {}

    return tryDropIndex;
  }();

  return Base;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Base: function () {
    return Base;
  },
  Avatars: function () {
    return Avatars;
  },
  Uploads: function () {
    return Uploads;
  },
  UserDataFiles: function () {
    return UserDataFiles;
  },
  Roles: function () {
    return Roles;
  },
  Subscriptions: function () {
    return Subscriptions;
  },
  Users: function () {
    return Users;
  },
  Messages: function () {
    return Messages;
  },
  CachedChannelList: function () {
    return CachedChannelList;
  },
  CachedChatRoom: function () {
    return CachedChatRoom;
  },
  CachedChatSubscription: function () {
    return CachedChatSubscription;
  },
  CachedUserList: function () {
    return CachedUserList;
  },
  ChatRoom: function () {
    return ChatRoom;
  },
  RoomRoles: function () {
    return RoomRoles;
  },
  UserAndRoom: function () {
    return UserAndRoom;
  },
  UserRoles: function () {
    return UserRoles;
  },
  AuthzCachedCollection: function () {
    return AuthzCachedCollection;
  },
  ChatPermissions: function () {
    return ChatPermissions;
  },
  ChatMessage: function () {
    return ChatMessage;
  },
  ChatSubscription: function () {
    return ChatSubscription;
  },
  Rooms: function () {
    return Rooms;
  },
  CustomSounds: function () {
    return CustomSounds;
  },
  EmojiCustom: function () {
    return EmojiCustom;
  },
  WebdavAccounts: function () {
    return WebdavAccounts;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 1);
var Base;
module.link("./models/_Base", {
  Base: function (v) {
    Base = v;
  }
}, 2);
var Avatars;
module.link("./models/Avatars", {
  "default": function (v) {
    Avatars = v;
  }
}, 3);
var Uploads;
module.link("./models/Uploads", {
  "default": function (v) {
    Uploads = v;
  }
}, 4);
var UserDataFiles;
module.link("./models/UserDataFiles", {
  "default": function (v) {
    UserDataFiles = v;
  }
}, 5);
var Roles;
module.link("./models/Roles", {
  Roles: function (v) {
    Roles = v;
  }
}, 6);
var subscriptions;
module.link("./models/Subscriptions", {
  Subscriptions: function (v) {
    subscriptions = v;
  }
}, 7);
var users;
module.link("./models/Users", {
  Users: function (v) {
    users = v;
  }
}, 8);
var CachedChannelList;
module.link("./models/CachedChannelList", {
  CachedChannelList: function (v) {
    CachedChannelList = v;
  }
}, 9);
var CachedChatRoom;
module.link("./models/CachedChatRoom", {
  CachedChatRoom: function (v) {
    CachedChatRoom = v;
  }
}, 10);
var CachedChatSubscription;
module.link("./models/CachedChatSubscription", {
  CachedChatSubscription: function (v) {
    CachedChatSubscription = v;
  }
}, 11);
var CachedUserList;
module.link("./models/CachedUserList", {
  CachedUserList: function (v) {
    CachedUserList = v;
  }
}, 12);
var ChatRoom;
module.link("./models/ChatRoom", {
  ChatRoom: function (v) {
    ChatRoom = v;
  }
}, 13);
var ChatSubscription;
module.link("./models/ChatSubscription", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 14);
var ChatMessage;
module.link("./models/ChatMessage", {
  ChatMessage: function (v) {
    ChatMessage = v;
  }
}, 15);
var RoomRoles;
module.link("./models/RoomRoles", {
  RoomRoles: function (v) {
    RoomRoles = v;
  }
}, 16);
var UserAndRoom;
module.link("./models/UserAndRoom", {
  UserAndRoom: function (v) {
    UserAndRoom = v;
  }
}, 17);
var UserRoles;
module.link("./models/UserRoles", {
  UserRoles: function (v) {
    UserRoles = v;
  }
}, 18);
var AuthzCachedCollection, ChatPermissions;
module.link("./models/ChatPermissions", {
  AuthzCachedCollection: function (v) {
    AuthzCachedCollection = v;
  },
  ChatPermissions: function (v) {
    ChatPermissions = v;
  }
}, 19);
var WebdavAccounts;
module.link("./models/WebdavAccounts", {
  WebdavAccounts: function (v) {
    WebdavAccounts = v;
  }
}, 20);
var CustomSounds;
module.link("./models/CustomSounds", {
  "default": function (v) {
    CustomSounds = v;
  }
}, 21);
var EmojiCustom;
module.link("./models/EmojiCustom", {
  "default": function (v) {
    EmojiCustom = v;
  }
}, 22);

var Users = _.extend({}, users, Meteor.users);

var Subscriptions = _.extend({}, subscriptions, ChatSubscription);

var Messages = _.extend({}, ChatMessage);

var Rooms = _.extend({}, ChatRoom);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/models/index.js                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/index.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/index.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"otr":{"client":{"stylesheets":{"otr.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/otr/client/stylesheets/otr.css                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/otr/client/index.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./stylesheets/otr.css");
module.link("./rocketchat.otr.room");
module.link("./rocketchat.otr");
module.link("./tabBar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.otr.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/otr/client/rocketchat.otr.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  OTR: function () {
    return OTR;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var Subscriptions;
module.link("../../models", {
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 3);
var Notifications;
module.link("../../notifications", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 4);
var t;
module.link("../../utils", {
  t: function (v) {
    t = v;
  }
}, 5);
var onClientMessageReceived;
module.link("../../../client/lib/onClientMessageReceived", {
  onClientMessageReceived: function (v) {
    onClientMessageReceived = v;
  }
}, 6);
var onClientBeforeSendMessage;
module.link("../../../client/lib/onClientBeforeSendMessage", {
  onClientBeforeSendMessage: function (v) {
    onClientBeforeSendMessage = v;
  }
}, 7);

var OTRClass = /*#__PURE__*/function () {
  function OTRClass() {
    this.enabled = new ReactiveVar(false);
    this.instancesByRoomId = {};
    this.crypto = null;
  }

  var _proto = OTRClass.prototype;

  _proto.isEnabled = function () {
    function isEnabled() {
      return this.enabled.get();
    }

    return isEnabled;
  }();

  _proto.getInstanceByRoomId = function () {
    function getInstanceByRoomId(roomId) {
      if (!this.enabled.get()) {
        return;
      }

      if (this.instancesByRoomId[roomId]) {
        return this.instancesByRoomId[roomId];
      }

      var subscription = Subscriptions.findOne({
        rid: roomId
      });

      if (!subscription || subscription.t !== 'd') {
        return;
      }

      this.instancesByRoomId[roomId] = new OTR.Room(Meteor.userId(), roomId); // eslint-disable-line no-use-before-define

      return this.instancesByRoomId[roomId];
    }

    return getInstanceByRoomId;
  }();

  return OTRClass;
}();

var OTR = new OTRClass();
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (Meteor.userId()) {
      Notifications.onUser('otr', function (type, data) {
        if (!data.roomId || !data.userId || data.userId === Meteor.userId()) {
          return;
        }

        OTR.getInstanceByRoomId(data.roomId).onUserStream(type, data);
      });
    }
  });
  onClientBeforeSendMessage.use(function (message) {
    if (message.rid && OTR.getInstanceByRoomId(message.rid) && OTR.getInstanceByRoomId(message.rid).established.get()) {
      return OTR.getInstanceByRoomId(message.rid).encrypt(message).then(function (msg) {
        message.msg = msg;
        message.t = 'otr';
        return message;
      });
    }

    return Promise.resolve(message);
  });
  onClientMessageReceived.use(function (message) {
    if (message.rid && OTR.getInstanceByRoomId(message.rid) && OTR.getInstanceByRoomId(message.rid).established.get()) {
      if (message.notification) {
        message.msg = t('Encrypted_message');
        return Promise.resolve(message);
      }

      var otrRoom = OTR.getInstanceByRoomId(message.rid);
      return otrRoom.decrypt(message.msg).then(function (data) {
        var _id = data._id,
            text = data.text,
            ack = data.ack;
        message._id = _id;
        message.msg = text;

        if (data.ts) {
          message.ts = data.ts;
        }

        if (message.otrAck) {
          return otrRoom.decrypt(message.otrAck).then(function (data) {
            if (ack === data.text) {
              message.t = 'otr-ack';
            }

            return message;
          });
        }

        if (data.userId !== Meteor.userId()) {
          return otrRoom.encryptText(ack).then(function (ack) {
            Meteor.call('updateOTRAck', message._id, ack);
            return message;
          });
        }

        return message;
      });
    }

    if (message.t === 'otr') {
      message.msg = '';
    }

    return Promise.resolve(message);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rocketchat.otr.room.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/otr/client/rocketchat.otr.room.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 2);
var EJSON;
module.link("meteor/ejson", {
  EJSON: function (v) {
    EJSON = v;
  }
}, 3);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 4);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 5);
var TimeSync;
module.link("meteor/mizzao:timesync", {
  TimeSync: function (v) {
    TimeSync = v;
  }
}, 6);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 7);
var OTR;
module.link("./rocketchat.otr", {
  OTR: function (v) {
    OTR = v;
  }
}, 8);
var Notifications;
module.link("../../notifications", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 9);
var getUidDirectMessage;
module.link("../../../client/lib/utils/getUidDirectMessage", {
  getUidDirectMessage: function (v) {
    getUidDirectMessage = v;
  }
}, 10);
var Presence;
module.link("../../../client/lib/presence", {
  Presence: function (v) {
    Presence = v;
  }
}, 11);
var goToRoomById;
module.link("../../../client/lib/utils/goToRoomById", {
  goToRoomById: function (v) {
    goToRoomById = v;
  }
}, 12);
var imperativeModal;
module.link("../../../client/lib/imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 13);
var GenericModal;
module.link("../../../client/components/GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 14);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 15);

OTR.Room = /*#__PURE__*/function () {
  function _class(userId, roomId) {
    this.userId = userId;
    this.roomId = roomId;
    this.peerId = getUidDirectMessage(roomId);
    this.established = new ReactiveVar(false);
    this.establishing = new ReactiveVar(false);
    this.userOnlineComputation = null;
    this.keyPair = null;
    this.exportedPublicKey = null;
    this.sessionKey = null;
  }

  var _proto = _class.prototype;

  _proto.handshake = function () {
    function handshake(refresh) {
      var _this = this;

      this.establishing.set(true);
      this.firstPeer = true;
      this.generateKeyPair().then(function () {
        Notifications.notifyUser(_this.peerId, 'otr', 'handshake', {
          roomId: _this.roomId,
          userId: _this.userId,
          publicKey: EJSON.stringify(_this.exportedPublicKey),
          refresh: refresh
        });
      });
    }

    return handshake;
  }();

  _proto.acknowledge = function () {
    function acknowledge() {
      Notifications.notifyUser(this.peerId, 'otr', 'acknowledge', {
        roomId: this.roomId,
        userId: this.userId,
        publicKey: EJSON.stringify(this.exportedPublicKey)
      });
    }

    return acknowledge;
  }();

  _proto.deny = function () {
    function deny() {
      this.reset();
      Notifications.notifyUser(this.peerId, 'otr', 'deny', {
        roomId: this.roomId,
        userId: this.userId
      });
    }

    return deny;
  }();

  _proto.end = function () {
    function end() {
      this.reset();
      Notifications.notifyUser(this.peerId, 'otr', 'end', {
        roomId: this.roomId,
        userId: this.userId
      });
    }

    return end;
  }();

  _proto.reset = function () {
    function reset() {
      this.establishing.set(false);
      this.established.set(false);
      this.keyPair = null;
      this.exportedPublicKey = null;
      this.sessionKey = null;
      Meteor.call('deleteOldOTRMessages', this.roomId);
    }

    return reset;
  }();

  _proto.generateKeyPair = function () {
    function generateKeyPair() {
      var _this2 = this;

      if (this.userOnlineComputation) {
        this.userOnlineComputation.stop();
      }

      this.userOnlineComputation = Tracker.autorun(function () {
        var $room = $("#chat-window-" + _this2.roomId);
        var $title = $('.rc-header__title', $room);

        if (_this2.established.get()) {
          if ($room.length && $title.length && !$('.otr-icon', $title).length) {
            $title.prepend("<i class='otr-icon icon-key'></i>");
          }
        } else if ($title.length) {
          $('.otr-icon', $title).remove();
        }
      }); // Generate an ephemeral key pair.

      return OTR.crypto.generateKey({
        name: 'ECDH',
        namedCurve: 'P-256'
      }, false, ['deriveKey', 'deriveBits']).then(function (keyPair) {
        _this2.keyPair = keyPair;
        return OTR.crypto.exportKey('jwk', keyPair.publicKey);
      }).then(function (exportedPublicKey) {
        _this2.exportedPublicKey = exportedPublicKey; // Once we have generated new keys, it's safe to delete old messages

        Meteor.call('deleteOldOTRMessages', _this2.roomId);
      }).catch(function (e) {
        dispatchToastMessage({
          type: 'error',
          message: e
        });
      });
    }

    return generateKeyPair;
  }();

  _proto.importPublicKey = function () {
    function importPublicKey(publicKey) {
      var _this3 = this;

      return OTR.crypto.importKey('jwk', EJSON.parse(publicKey), {
        name: 'ECDH',
        namedCurve: 'P-256'
      }, false, []).then(function (peerPublicKey) {
        return OTR.crypto.deriveBits({
          name: 'ECDH',
          namedCurve: 'P-256',
          "public": peerPublicKey
        }, _this3.keyPair.privateKey, 256);
      }).then(function (bits) {
        return OTR.crypto.digest({
          name: 'SHA-256'
        }, bits);
      }).then(function (hashedBits) {
        // We truncate the hash to 128 bits.
        var sessionKeyData = new Uint8Array(hashedBits).slice(0, 16);
        return OTR.crypto.importKey('raw', sessionKeyData, {
          name: 'AES-GCM'
        }, false, ['encrypt', 'decrypt']);
      }).then(function (sessionKey) {
        // Session key available.
        _this3.sessionKey = sessionKey;
      });
    }

    return importPublicKey;
  }();

  _proto.encryptText = function () {
    function encryptText(data) {
      if (!_.isObject(data)) {
        data = new TextEncoder('UTF-8').encode(EJSON.stringify({
          text: data,
          ack: Random.id((Random.fraction() + 1) * 20)
        }));
      }

      var iv = crypto.getRandomValues(new Uint8Array(12));
      return OTR.crypto.encrypt({
        name: 'AES-GCM',
        iv: iv
      }, this.sessionKey, data).then(function (cipherText) {
        cipherText = new Uint8Array(cipherText);
        var output = new Uint8Array(iv.length + cipherText.length);
        output.set(iv, 0);
        output.set(cipherText, iv.length);
        return EJSON.stringify(output);
      }).catch(function () {
        throw new Meteor.Error('encryption-error', 'Encryption error.');
      });
    }

    return encryptText;
  }();

  _proto.encrypt = function () {
    function encrypt(message) {
      var ts;

      if (isNaN(TimeSync.serverOffset())) {
        ts = new Date();
      } else {
        ts = new Date(Date.now() + TimeSync.serverOffset());
      }

      var data = new TextEncoder('UTF-8').encode(EJSON.stringify({
        _id: message._id,
        text: message.msg,
        userId: this.userId,
        ack: Random.id((Random.fraction() + 1) * 20),
        ts: ts
      }));
      var enc = this.encryptText(data);
      return enc;
    }

    return encrypt;
  }();

  _proto.decrypt = function () {
    function decrypt(message) {
      var cipherText = EJSON.parse(message);
      var iv = cipherText.slice(0, 12);
      cipherText = cipherText.slice(12);
      return OTR.crypto.decrypt({
        name: 'AES-GCM',
        iv: iv
      }, this.sessionKey, cipherText).then(function (data) {
        data = EJSON.parse(new TextDecoder('UTF-8').decode(new Uint8Array(data)));
        return data;
      }).catch(function (e) {
        dispatchToastMessage({
          type: 'error',
          message: e
        });
        return message;
      });
    }

    return decrypt;
  }();

  _proto.onUserStream = function () {
    function onUserStream(type, data) {
      var _this4 = this;

      switch (type) {
        case 'handshake':
          var timeout = null;

          var establishConnection = function () {
            _this4.establishing.set(true);

            Meteor.clearTimeout(timeout);

            _this4.generateKeyPair().then(function () {
              _this4.importPublicKey(data.publicKey).then(function () {
                _this4.firstPeer = false;
                goToRoomById(data.roomId);
                Meteor.defer(function () {
                  _this4.established.set(true);

                  _this4.acknowledge();
                });
              });
            });
          };

          (function () {
            function _callee() {
              var _await$Presence$get, username;

              return _regeneratorRuntime.async(function () {
                function _callee$(_context) {
                  while (1) {
                    switch (_context.prev = _context.next) {
                      case 0:
                        _context.next = 2;
                        return _regeneratorRuntime.awrap(Presence.get(data.userId));

                      case 2:
                        _await$Presence$get = _context.sent;
                        username = _await$Presence$get.username;

                        if (data.refresh && _this4.established.get()) {
                          _this4.reset();

                          establishConnection();
                        } else {
                          if (_this4.established.get()) {
                            _this4.reset();
                          }

                          imperativeModal.open({
                            component: GenericModal,
                            props: {
                              variant: 'warning',
                              title: TAPi18n.__('OTR'),
                              children: TAPi18n.__('Username_wants_to_start_otr_Do_you_want_to_accept', {
                                username: username
                              }),
                              confirmText: TAPi18n.__('Yes'),
                              cancelText: TAPi18n.__('No'),
                              onClose: function () {
                                return imperativeModal.close;
                              },
                              onCancel: function () {
                                Meteor.clearTimeout(timeout);

                                _this4.deny();

                                imperativeModal.close();
                              },
                              onConfirm: function () {
                                establishConnection();
                                imperativeModal.close();
                              }
                            }
                          });
                        }

                        timeout = Meteor.setTimeout(function () {
                          _this4.establishing.set(false);

                          imperativeModal.close();
                        }, 10000);

                      case 6:
                      case "end":
                        return _context.stop();
                    }
                  }
                }

                return _callee$;
              }(), null, null, null, Promise);
            }

            return _callee;
          })()();
          break;

        case 'acknowledge':
          this.importPublicKey(data.publicKey).then(function () {
            _this4.established.set(true);
          });
          break;

        case 'deny':
          (function () {
            function _callee2() {
              var _await$Presence$get2, username;

              return _regeneratorRuntime.async(function () {
                function _callee2$(_context2) {
                  while (1) {
                    switch (_context2.prev = _context2.next) {
                      case 0:
                        _context2.next = 2;
                        return _regeneratorRuntime.awrap(Presence.get(_this4.peerId));

                      case 2:
                        _await$Presence$get2 = _context2.sent;
                        username = _await$Presence$get2.username;

                        if (_this4.establishing.get()) {
                          _this4.reset();

                          imperativeModal.open({
                            component: GenericModal,
                            props: {
                              variant: 'warning',
                              title: TAPi18n.__('OTR'),
                              children: TAPi18n.__('Username_denied_the_OTR_session', {
                                username: username
                              }),
                              onClose: imperativeModal.close,
                              onConfirm: imperativeModal.close
                            }
                          });
                        }

                      case 5:
                      case "end":
                        return _context2.stop();
                    }
                  }
                }

                return _callee2$;
              }(), null, null, null, Promise);
            }

            return _callee2;
          })()();
          break;

        case 'end':
          (function () {
            function _callee3() {
              var _await$Presence$get3, username;

              return _regeneratorRuntime.async(function () {
                function _callee3$(_context3) {
                  while (1) {
                    switch (_context3.prev = _context3.next) {
                      case 0:
                        _context3.next = 2;
                        return _regeneratorRuntime.awrap(Presence.get(_this4.peerId));

                      case 2:
                        _await$Presence$get3 = _context3.sent;
                        username = _await$Presence$get3.username;

                        if (_this4.established.get()) {
                          _this4.reset();

                          imperativeModal.open({
                            component: GenericModal,
                            props: {
                              variant: 'warning',
                              title: TAPi18n.__('OTR'),
                              children: TAPi18n.__('Username_ended_the_OTR_session', {
                                username: username
                              }),
                              confirmText: TAPi18n.__('Ok'),
                              onClose: imperativeModal.close,
                              onConfirm: imperativeModal.close
                            }
                          });
                        }

                      case 5:
                      case "end":
                        return _context3.stop();
                    }
                  }
                }

                return _callee3$;
              }(), null, null, null, Promise);
            }

            return _callee3;
          })()();
          break;
      }
    }

    return onUserStream;
  }();

  return _class;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/otr/client/tabBar.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMemo, lazy, useEffect;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  },
  lazy: function (v) {
    lazy = v;
  },
  useEffect: function (v) {
    useEffect = v;
  }
}, 0);
var OTR;
module.link("./rocketchat.otr", {
  OTR: function (v) {
    OTR = v;
  }
}, 1);
var useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 2);
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 3);
var template = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../../../client/views/room/contextualBar/OTR');
});
addAction('otr', function () {
  var enabled = useSetting('OTR_Enable');
  var shouldAddAction = enabled && window.crypto;
  useEffect(function () {
    if (shouldAddAction) {
      OTR.crypto = window.crypto.subtle;
      OTR.enabled.set(true);
    } else {
      OTR.enabled.set(false);
    }
  }, [shouldAddAction]);
  return useMemo(function () {
    return shouldAddAction ? {
      groups: ['direct'],
      id: 'otr',
      title: 'OTR',
      icon: 'shredder',
      template: template,
      order: 13,
      full: true
    } : null;
  }, [shouldAddAction]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"reactions":{"client":{"methods":{"setReaction.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/reactions/client/methods/setReaction.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 1);
var Messages, Rooms, Subscriptions;
module.link("../../../models", {
  Messages: function (v) {
    Messages = v;
  },
  Rooms: function (v) {
    Rooms = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 2);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);
var emoji;
module.link("../../../emoji", {
  emoji: function (v) {
    emoji = v;
  }
}, 4);
var roomTypes;
module.link("../../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 5);
Meteor.methods({
  setReaction: function (reaction, messageId) {
    if (!Meteor.userId()) {
      throw new Meteor.Error(203, 'User_logged_out');
    }

    var user = Meteor.user();
    var message = Messages.findOne({
      _id: messageId
    });
    var room = Rooms.findOne({
      _id: message.rid
    });

    if (message.private) {
      return false;
    }

    if (!emoji.list[reaction]) {
      return false;
    }

    if (roomTypes.readOnly(room._id, user._id)) {
      return false;
    }

    if (!Subscriptions.findOne({
      rid: message.rid
    })) {
      return false;
    }

    if (message.reactions && message.reactions[reaction] && message.reactions[reaction].usernames.indexOf(user.username) !== -1) {
      message.reactions[reaction].usernames.splice(message.reactions[reaction].usernames.indexOf(user.username), 1);

      if (message.reactions[reaction].usernames.length === 0) {
        delete message.reactions[reaction];
      }

      if (_.isEmpty(message.reactions)) {
        delete message.reactions;
        Messages.unsetReactions(messageId);
        callbacks.run('unsetReaction', messageId, reaction);
      } else {
        Messages.setReactions(messageId, message.reactions);
        callbacks.run('setReaction', messageId, reaction);
      }
    } else {
      if (!message.reactions) {
        message.reactions = {};
      }

      if (!message.reactions[reaction]) {
        message.reactions[reaction] = {
          usernames: []
        };
      }

      message.reactions[reaction].usernames.push(user.username);
      Messages.setReactions(messageId, message.reactions);
      callbacks.run('setReaction', messageId, reaction);
    }
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"stylesheets":{"reaction.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/reactions/client/stylesheets/reaction.css                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/reactions/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./init");
module.link("./methods/setReaction");
module.link("./stylesheets/reaction.css");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"init.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/reactions/client/init.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  EmojiEvents: function () {
    return EmojiEvents;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 1);
var roomTypes;
module.link("../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 2);
var Rooms, Subscriptions;
module.link("../../models", {
  Rooms: function (v) {
    Rooms = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 3);
var MessageAction;
module.link("../../ui-utils", {
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 4);
var messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 5);
var EmojiPicker;
module.link("../../emoji", {
  EmojiPicker: function (v) {
    EmojiPicker = v;
  }
}, 6);
var tooltip;
module.link("../../ui/client/components/tooltip", {
  tooltip: function (v) {
    tooltip = v;
  }
}, 7);
var EmojiEvents = {
  'click .add-reaction': function (event) {
    event.preventDefault();
    event.stopPropagation();
    var data = Blaze.getData(event.currentTarget);

    var _messageArgs = messageArgs(data),
        _messageArgs$msg = _messageArgs.msg,
        rid = _messageArgs$msg.rid,
        mid = _messageArgs$msg._id,
        isPrivate = _messageArgs$msg.private;

    var user = Meteor.user();
    var room = Rooms.findOne({
      _id: rid
    });

    if (!room) {
      return false;
    }

    if (!Subscriptions.findOne({
      rid: rid
    })) {
      return false;
    }

    if (isPrivate) {
      return false;
    }

    if (roomTypes.readOnly(room._id, user._id) && !room.reactWhenReadOnly) {
      return false;
    }

    EmojiPicker.open(event.currentTarget, function (emoji) {
      Meteor.call('setReaction', ":" + emoji + ":", mid);
    });
  },
  'click .reactions > li:not(.add-reaction)': function (event) {
    event.preventDefault();
    var data = Blaze.getData(event.currentTarget);

    var _messageArgs2 = messageArgs(data),
        mid = _messageArgs2.msg._id;

    Meteor.call('setReaction', $(event.currentTarget).attr('data-emoji'), mid, function () {
      tooltip.hide();
    });
  },
  'mouseenter .reactions > li:not(.add-reaction)': function (event) {
    event.stopPropagation();
    tooltip.showElement($(event.currentTarget).find('.people').get(0), event.currentTarget);
  },
  'mouseleave .reactions > li:not(.add-reaction)': function (event) {
    event.stopPropagation();
    tooltip.hide();
  }
};
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'reaction-message',
    icon: 'add-reaction',
    label: 'Add_Reaction',
    context: ['message', 'message-mobile', 'threads'],
    action: function (event) {
      event.stopPropagation();

      var _messageArgs3 = messageArgs(this),
          msg = _messageArgs3.msg;

      EmojiPicker.open(event.currentTarget, function (emoji) {
        return Meteor.call('setReaction', ":" + emoji + ":", msg._id);
      });
    },
    condition: function (_ref) {
      var message = _ref.msg,
          user = _ref.u,
          room = _ref.room,
          subscription = _ref.subscription;

      if (!room) {
        return false;
      }

      if (!subscription) {
        return false;
      }

      if (message.private) {
        return false;
      }

      if (roomTypes.readOnly(room._id, user._id) && !room.reactWhenReadOnly) {
        return false;
      }

      var isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return true;
    },
    order: -2,
    group: ['message', 'menu']
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ui-cached-collection":{"client":{"models":{"CachedCollection.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-cached-collection/client/models/CachedCollection.js                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["_id"],
    _excluded2 = ["_id"];

var _this2 = this;

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 2);

var _assertThisInitialized;

module.link("@babel/runtime/helpers/assertThisInitialized", {
  default: function (v) {
    _assertThisInitialized = v;
  }
}, 3);

var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 4);

var _createClass;

module.link("@babel/runtime/helpers/createClass", {
  default: function (v) {
    _createClass = v;
  }
}, 5);

var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 6);
module.export({
  CachedCollectionManager: function () {
    return CachedCollectionManager;
  },
  CachedCollection: function () {
    return CachedCollection;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var check;
module.link("meteor/check", {
  check: function (v) {
    check = v;
  }
}, 1);
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 2);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 3);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 4);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 5);
var localforage;
module.link("localforage", {
  "default": function (v) {
    localforage = v;
  }
}, 6);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 7);
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 8);
var callbacks;
module.link("../../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 9);
var Notifications;
module.link("../../../notifications/client/lib/Notifications", {
  "default": function (v) {
    Notifications = v;
  }
}, 10);
var getConfig;
module.link("../../../../client/lib/utils/getConfig", {
  getConfig: function (v) {
    getConfig = v;
  }
}, 11);
var call;
module.link("../../../../client/lib/utils/call", {
  call: function (v) {
    call = v;
  }
}, 12);

var wrap = function (fn) {
  return function () {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    return new Promise(function (resolve, reject) {
      fn.apply(void 0, args.concat([function (err, result) {
        if (err) {
          return reject(err);
        }

        return resolve(result);
      }]));
    });
  };
};

var localforageGetItem = wrap(localforage.getItem);

var CachedCollectionManagerClass = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(CachedCollectionManagerClass, _Emitter);

  function CachedCollectionManagerClass() {
    var _this;

    _this = _Emitter.call(this) || this;
    _this.items = [];
    _this._syncEnabled = false;
    _this.logged = false;
    var _Accounts = Accounts,
        _unstoreLoginToken = _Accounts._unstoreLoginToken;

    Accounts._unstoreLoginToken = function () {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }

      _unstoreLoginToken.apply(Accounts, args);

      _this.clearAllCacheOnLogout();
    }; // Wait 1s to start or the code will run before the connection and
    // on first connection the `reconnect` callbacks will run


    Tracker.autorun(function () {
      var WAITING_FIRST_CONNECTION = 0,
          WAITING_FIRST_DISCONNECTION = 1,
          LISTENING_RECONNECTIONS = 2;
      _this.step = _this.step || WAITING_FIRST_CONNECTION;

      var _Meteor$status = Meteor.status(),
          connected = _Meteor$status.connected;

      switch (_this.step) {
        case WAITING_FIRST_CONNECTION:
          return !connected || _this.step++;

        case WAITING_FIRST_DISCONNECTION:
          return connected || _this.step++;

        case LISTENING_RECONNECTIONS:
          return connected && _this.emit('reconnect');
      }
    });
    Tracker.autorun(function () {
      var uid = Meteor.userId();
      _this.logged = uid !== null;

      if (_this.logged) {
        _this.emit('login', uid);
      }
    });
    return _this;
  }

  var _proto = CachedCollectionManagerClass.prototype;

  _proto.register = function () {
    function register(cachedCollection) {
      this.items.push(cachedCollection);
    }

    return register;
  }();

  _proto.clearAllCache = function () {
    function clearAllCache() {
      for (var _iterator = _createForOfIteratorHelperLoose(this.items), _step; !(_step = _iterator()).done;) {
        var item = _step.value;
        item.clearCache();
      }
    }

    return clearAllCache;
  }();

  _proto.clearAllCacheOnLogout = function () {
    function clearAllCacheOnLogout() {
      for (var _iterator2 = _createForOfIteratorHelperLoose(this.items), _step2; !(_step2 = _iterator2()).done;) {
        var item = _step2.value;
        item.clearCacheOnLogout();
      }
    }

    return clearAllCacheOnLogout;
  }();

  _proto.countQueries = function () {
    function countQueries() {
      for (var _iterator3 = _createForOfIteratorHelperLoose(this.items), _step3; !(_step3 = _iterator3()).done;) {
        var item = _step3.value;
        item.countQueries();
      }
    }

    return countQueries;
  }();

  _proto.onReconnect = function () {
    function onReconnect(cb) {
      this.on('reconnect', cb);
    }

    return onReconnect;
  }();

  _proto.onLogin = function () {
    function onLogin(cb) {
      this.on('login', cb);

      if (this.logged) {
        cb();
      }
    }

    return onLogin;
  }();

  _createClass(CachedCollectionManagerClass, [{
    key: "syncEnabled",
    get: function () {
      return this._syncEnabled;
    },
    set: function (value) {
      check(value, Boolean);
      this._syncEnabled = value;
    }
  }]);

  return CachedCollectionManagerClass;
}(Emitter);

var CachedCollectionManager = new CachedCollectionManagerClass();

var debug = function (name) {
  return [getConfig("debugCachedCollection-" + name), getConfig('debugCachedCollection'), getConfig('debug')].includes('true');
};

var nullLog = function () {};

var log = function () {
  var _console;

  for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
    args[_key3] = arguments[_key3];
  }

  return (_console = console).log.apply(_console, ["CachedCollection " + _this2.name + " =>"].concat(args));
};

var CachedCollection = /*#__PURE__*/function (_Emitter2) {
  _inheritsLoose(CachedCollection, _Emitter2);

  function CachedCollection(_ref) {
    var _this3;

    var _ref$collection = _ref.collection,
        collection = _ref$collection === void 0 ? new Mongo.Collection(null) : _ref$collection,
        name = _ref.name,
        _ref$methodName = _ref.methodName,
        methodName = _ref$methodName === void 0 ? name + "/get" : _ref$methodName,
        _ref$syncMethodName = _ref.syncMethodName,
        syncMethodName = _ref$syncMethodName === void 0 ? name + "/get" : _ref$syncMethodName,
        _ref$eventName = _ref.eventName,
        eventName = _ref$eventName === void 0 ? name + "-changed" : _ref$eventName,
        _ref$eventType = _ref.eventType,
        eventType = _ref$eventType === void 0 ? 'onUser' : _ref$eventType,
        _ref$userRelated = _ref.userRelated,
        userRelated = _ref$userRelated === void 0 ? true : _ref$userRelated,
        _ref$listenChangesFor = _ref.listenChangesForLoggedUsersOnly,
        listenChangesForLoggedUsersOnly = _ref$listenChangesFor === void 0 ? false : _ref$listenChangesFor,
        _ref$useSync = _ref.useSync,
        useSync = _ref$useSync === void 0 ? true : _ref$useSync,
        _ref$version = _ref.version,
        version = _ref$version === void 0 ? 16 : _ref$version,
        _ref$maxCacheTime = _ref.maxCacheTime,
        maxCacheTime = _ref$maxCacheTime === void 0 ? 60 * 60 * 24 * 30 : _ref$maxCacheTime,
        _ref$onSyncData = _ref.onSyncData,
        onSyncData = _ref$onSyncData === void 0 ? function
      /* action, record */
    () {} : _ref$onSyncData;
    _this3 = _Emitter2.call(this) || this;
    _this3.save = _.debounce(function () {
      _this3.log('saving cache');

      var data = _this3.collection.find().fetch();

      localforage.setItem(_this3.name, {
        updatedAt: _this3.updatedAt,
        version: _this3.version,
        token: _this3.getToken(),
        records: data
      });

      _this3.log('saving cache (done)');
    }, 1000);
    _this3.collection = collection;
    _this3.ready = new ReactiveVar(false);
    _this3.name = name;
    _this3.methodName = methodName;
    _this3.syncMethodName = syncMethodName;
    _this3.eventName = eventName;
    _this3.eventType = eventType;
    _this3.useSync = useSync;
    _this3.listenChangesForLoggedUsersOnly = listenChangesForLoggedUsersOnly;
    _this3.version = version;
    _this3.userRelated = userRelated;
    _this3.updatedAt = new Date(0);
    _this3.maxCacheTime = maxCacheTime;
    _this3.onSyncData = onSyncData;
    _this3.log = debug(name) ? log : nullLog;
    CachedCollectionManager.register(_assertThisInitialized(_this3));

    if (!userRelated) {
      _this3.init();

      return _assertThisInitialized(_this3);
    }

    CachedCollectionManager.onLogin(function () {
      _this3.init();
    });
    return _this3;
  }

  var _proto2 = CachedCollection.prototype;

  _proto2.countQueries = function () {
    function countQueries() {
      this.log(Object.keys(this.collection._collection.queries).length + " queries");
    }

    return countQueries;
  }();

  _proto2.getToken = function () {
    function getToken() {
      if (this.userRelated === false) {
        return undefined;
      }

      return Accounts._storedLoginToken();
    }

    return getToken;
  }();

  _proto2.loadFromCache = function () {
    function loadFromCache() {
      var _this4 = this;

      var data;
      return _regeneratorRuntime.async(function () {
        function loadFromCache$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return _regeneratorRuntime.awrap(localforageGetItem(this.name));

              case 2:
                data = _context.sent;

                if (data) {
                  _context.next = 5;
                  break;
                }

                return _context.abrupt("return", false);

              case 5:
                if (!(data.version < this.version || data.token !== this.getToken())) {
                  _context.next = 7;
                  break;
                }

                return _context.abrupt("return", false);

              case 7:
                if (!(data.records.length <= 0)) {
                  _context.next = 9;
                  break;
                }

                return _context.abrupt("return", false);

              case 9:
                if (!(new Date() - data.updatedAt >= 1000 * this.maxCacheTime)) {
                  _context.next = 11;
                  break;
                }

                return _context.abrupt("return", false);

              case 11:
                this.log(data.records.length + " records loaded from cache");
                data.records.forEach(function (record) {
                  callbacks.run("cachedCollection-loadFromCache-" + _this4.name, record); // this.collection.direct.insert(record);

                  if (!record._updatedAt) {
                    return;
                  }

                  var _updatedAt = new Date(record._updatedAt);

                  record._updatedAt = _updatedAt;

                  if (record.lastMessage && typeof record.lastMessage._updatedAt === 'string') {
                    record.lastMessage._updatedAt = new Date(record.lastMessage._updatedAt);
                  }

                  if (_updatedAt > _this4.updatedAt) {
                    _this4.updatedAt = _updatedAt;
                  }
                });
                this.collection._collection._docs._map = new Map(data.records.map(function (record) {
                  return [record._id, record];
                }));
                this.updatedAt = data.updatedAt || this.updatedAt;
                Object.values(this.collection._collection.queries).forEach(function (query) {
                  return _this4.collection._collection._recomputeResults(query);
                });
                return _context.abrupt("return", true);

              case 17:
              case "end":
                return _context.stop();
            }
          }
        }

        return loadFromCache$;
      }(), null, this, null, Promise);
    }

    return loadFromCache;
  }();

  _proto2.loadFromServer = function () {
    function loadFromServer() {
      var _this5 = this;

      var startTime, lastTime, data;
      return _regeneratorRuntime.async(function () {
        function loadFromServer$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                startTime = new Date();
                lastTime = this.updatedAt;
                _context2.next = 4;
                return _regeneratorRuntime.awrap(call(this.methodName));

              case 4:
                data = _context2.sent;
                this.log(data.length + " records loaded from server");
                data.forEach(function (record) {
                  callbacks.run("cachedCollection-loadFromServer-" + _this5.name, record, 'changed');

                  _this5.collection.direct.upsert({
                    _id: record._id
                  }, _.omit(record, '_id'));

                  _this5.onSyncData('changed', record);

                  if (record._updatedAt && record._updatedAt > _this5.updatedAt) {
                    _this5.updatedAt = record._updatedAt;
                  }
                });
                this.updatedAt = this.updatedAt === lastTime ? startTime : this.updatedAt;

              case 8:
              case "end":
                return _context2.stop();
            }
          }
        }

        return loadFromServer$;
      }(), null, this, null, Promise);
    }

    return loadFromServer;
  }();

  _proto2.loadFromServerAndPopulate = function () {
    function loadFromServerAndPopulate() {
      return _regeneratorRuntime.async(function () {
        function loadFromServerAndPopulate$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                _context3.next = 2;
                return _regeneratorRuntime.awrap(this.loadFromServer());

              case 2:
                this.save();

              case 3:
              case "end":
                return _context3.stop();
            }
          }
        }

        return loadFromServerAndPopulate$;
      }(), null, this, null, Promise);
    }

    return loadFromServerAndPopulate;
  }();

  _proto2.clearCacheOnLogout = function () {
    function clearCacheOnLogout() {
      if (this.userRelated === true) {
        this.clearCache();
      }
    }

    return clearCacheOnLogout;
  }();

  _proto2.clearCache = function () {
    function clearCache() {
      this.log('clearing cache');
      localforage.removeItem(this.name);
      this.collection.remove({});
    }

    return clearCache;
  }();

  _proto2.removeRoomFromCacheWhenUserLeaves = function () {
    function removeRoomFromCacheWhenUserLeaves(roomId, ChatRoom, CachedChatRoom) {
      ChatRoom.remove(roomId);
      CachedChatRoom.save();
    }

    return removeRoomFromCacheWhenUserLeaves;
  }();

  _proto2.setupListener = function () {
    function setupListener(eventType, eventName) {
      var _this6 = this;

      var _await$module$dynamic, RoomManager, _await$module$dynamic2, ChatRoom, CachedChatRoom;

      return _regeneratorRuntime.async(function () {
        function setupListener$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                _context4.next = 2;
                return _regeneratorRuntime.awrap(module.dynamicImport('../../../ui-utils'));

              case 2:
                _await$module$dynamic = _context4.sent;
                RoomManager = _await$module$dynamic.RoomManager;
                _context4.next = 6;
                return _regeneratorRuntime.awrap(module.dynamicImport('../../../models'));

              case 6:
                _await$module$dynamic2 = _context4.sent;
                ChatRoom = _await$module$dynamic2.ChatRoom;
                CachedChatRoom = _await$module$dynamic2.CachedChatRoom;
                Notifications[eventType || this.eventType](eventName || this.eventName, function (t, record) {
                  _this6.log('record received', t, record);

                  callbacks.run("cachedCollection-received-" + _this6.name, record, t);

                  if (t === 'removed') {
                    var room;

                    if (_this6.eventName === 'subscriptions-changed') {
                      room = ChatRoom.findOne(record.rid);

                      if (room) {
                        _this6.removeRoomFromCacheWhenUserLeaves(room._id, ChatRoom, CachedChatRoom);
                      }
                    } else {
                      room = _this6.collection.findOne({
                        _id: record._id
                      });
                    }

                    if (room) {
                      room.name && RoomManager.close(room.t + room.name);
                      !room.name && RoomManager.close(room.t + room._id);
                    }

                    _this6.collection.remove(record._id);
                  } else {
                    var _id = record._id,
                        recordData = _objectWithoutProperties(record, _excluded);

                    _this6.collection.direct.upsert({
                      _id: _id
                    }, recordData);
                  }

                  _this6.save();
                });

              case 10:
              case "end":
                return _context4.stop();
            }
          }
        }

        return setupListener$;
      }(), null, this, null, Promise);
    }

    return setupListener;
  }();

  _proto2.trySync = function () {
    function trySync() {
      var _this7 = this;

      var delay = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;
      clearTimeout(this.tm); // Wait for an empty queue to load data again and sync

      this.tm = setTimeout(function () {
        function _callee() {
          return _regeneratorRuntime.async(function () {
            function _callee$(_context5) {
              while (1) {
                switch (_context5.prev = _context5.next) {
                  case 0:
                    _context5.next = 2;
                    return _regeneratorRuntime.awrap(_this7.sync());

                  case 2:
                    if (_context5.sent) {
                      _context5.next = 4;
                      break;
                    }

                    return _context5.abrupt("return", _this7.trySync(delay));

                  case 4:
                    _this7.save();

                  case 5:
                  case "end":
                    return _context5.stop();
                }
              }
            }

            return _callee$;
          }(), null, null, null, Promise);
        }

        return _callee;
      }(), delay);
    }

    return trySync;
  }();

  _proto2.sync = function () {
    function sync() {
      var startTime, lastTime, data, changes, _changes, _changes2, _iterator4, _step4, record, action, actionTime, _id, recordData;

      return _regeneratorRuntime.async(function () {
        function sync$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                if (!(!this.updatedAt || this.updatedAt.valueOf() === 0 || Meteor.connection._outstandingMethodBlocks.length !== 0)) {
                  _context6.next = 2;
                  break;
                }

                return _context6.abrupt("return", false);

              case 2:
                startTime = new Date();
                lastTime = this.updatedAt;
                this.log("syncing from " + this.updatedAt);
                _context6.next = 7;
                return _regeneratorRuntime.awrap(call(this.syncMethodName, this.updatedAt));

              case 7:
                data = _context6.sent;
                changes = [];

                if (data.update && data.update.length > 0) {
                  this.log(data.update.length + " records updated in sync");

                  (_changes = changes).push.apply(_changes, _toConsumableArray(data.update));
                }

                if (data.remove && data.remove.length > 0) {
                  this.log(data.remove.length + " records removed in sync");

                  (_changes2 = changes).push.apply(_changes2, _toConsumableArray(data.remove));
                }

                changes = changes.sort(function (a, b) {
                  var valueA = a._updatedAt || a._deletedAt;
                  var valueB = b._updatedAt || b._deletedAt;

                  if (valueA < valueB) {
                    return -1;
                  }

                  if (valueA > valueB) {
                    return 1;
                  }

                  return 0;
                });

                for (_iterator4 = _createForOfIteratorHelperLoose(changes); !(_step4 = _iterator4()).done;) {
                  record = _step4.value;
                  action = record._deletedAt ? 'removed' : 'changed';
                  callbacks.run("cachedCollection-sync-" + this.name, record, action);
                  actionTime = record._deletedAt || record._updatedAt;
                  _id = record._id, recordData = _objectWithoutProperties(record, _excluded2);

                  if (record._deletedAt) {
                    this.collection.direct.remove({
                      _id: _id
                    });
                  } else {
                    this.collection.direct.upsert({
                      _id: _id
                    }, recordData);
                  }

                  if (actionTime > this.updatedAt) {
                    this.updatedAt = actionTime;
                  }

                  this.onSyncData(action, record);
                }

                this.updatedAt = this.updatedAt === lastTime ? startTime : this.updatedAt;
                return _context6.abrupt("return", true);

              case 15:
              case "end":
                return _context6.stop();
            }
          }
        }

        return sync$;
      }(), null, this, null, Promise);
    }

    return sync;
  }();

  _proto2.init = function () {
    function init() {
      var _this8 = this;

      return _regeneratorRuntime.async(function () {
        function init$(_context8) {
          while (1) {
            switch (_context8.prev = _context8.next) {
              case 0:
                this.ready.set(false);
                _context8.next = 3;
                return _regeneratorRuntime.awrap(this.loadFromCache());

              case 3:
                if (!_context8.sent) {
                  _context8.next = 7;
                  break;
                }

                this.trySync();
                _context8.next = 9;
                break;

              case 7:
                _context8.next = 9;
                return _regeneratorRuntime.awrap(this.loadFromServerAndPopulate());

              case 9:
                this.ready.set(true);
                CachedCollectionManager.onReconnect(function () {
                  _this8.trySync();
                });

                if (this.userRelated) {
                  _context8.next = 13;
                  break;
                }

                return _context8.abrupt("return", this.setupListener());

              case 13:
                CachedCollectionManager.onLogin(function () {
                  function _callee2() {
                    return _regeneratorRuntime.async(function () {
                      function _callee2$(_context7) {
                        while (1) {
                          switch (_context7.prev = _context7.next) {
                            case 0:
                              _this8.setupListener();

                            case 1:
                            case "end":
                              return _context7.stop();
                          }
                        }
                      }

                      return _callee2$;
                    }(), null, null, null, Promise);
                  }

                  return _callee2;
                }());

              case 14:
              case "end":
                return _context8.stop();
            }
          }
        }

        return init$;
      }(), null, this, null, Promise);
    }

    return init;
  }();

  return CachedCollection;
}(Emitter);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-cached-collection/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./models/CachedCollection", {
  CachedCollection: "CachedCollection",
  CachedCollectionManager: "CachedCollectionManager"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/ui-cached-collection/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client/index", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"2fa":{"client":{"TOTPCrowd.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPCrowd.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
module.link("../../crowd/client/index");
var reportError;
module.link("../../../client/lib/2fa/utils", {
  reportError: function (v) {
    reportError = v;
  }
}, 2);
var overrideLoginMethod;
module.link("../../../client/lib/2fa/overrideLoginMethod", {
  overrideLoginMethod: function (v) {
    overrideLoginMethod = v;
  }
}, 3);

Meteor.loginWithCrowdAndTOTP = function (username, password, code, callback) {
  var loginRequest = {
    crowd: true,
    username: username,
    crowdPassword: password
  };
  Accounts.callLoginMethod({
    methodArguments: [{
      totp: {
        login: loginRequest,
        code: code
      }
    }],
    userCallback: function (error) {
      if (error) {
        reportError(error, callback);
      } else {
        callback && callback();
      }
    }
  });
};

var _Meteor = Meteor,
    loginWithCrowd = _Meteor.loginWithCrowd;

Meteor.loginWithCrowd = function (username, password, callback) {
  overrideLoginMethod(loginWithCrowd, [username, password], callback, Meteor.loginWithCrowdAndTOTP);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TOTPGoogle.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPGoogle.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
var Google;
module.link("meteor/google-oauth", {
  Google: function (v) {
    Google = v;
  }
}, 2);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 3);
var overrideLoginMethod;
module.link("../../../client/lib/2fa/overrideLoginMethod", {
  overrideLoginMethod: function (v) {
    overrideLoginMethod = v;
  }
}, 4);

var loginWithGoogleAndTOTP = function (options, code, callback) {
  // support a callback without options
  if (!callback && typeof options === 'function') {
    callback = options;
    options = null;
  }

  if (Meteor.isCordova && Google.signIn) {
    // After 20 April 2017, Google OAuth login will no longer work from
    // a WebView, so Cordova apps must use Google Sign-In instead.
    // https://github.com/meteor/meteor/issues/8253
    Google.signIn(options, callback);
    return;
  } // Use Google's domain-specific login page if we want to restrict creation to
  // a particular email domain. (Don't use it if restrictCreationByEmailDomain
  // is a function.) Note that all this does is change Google's UI ---
  // accounts-base/accounts_server.js still checks server-side that the server
  // has the proper email address after the OAuth conversation.


  if (typeof Accounts._options.restrictCreationByEmailDomain === 'string') {
    options = _.extend({}, options || {});
    options.loginUrlParameters = _.extend({}, options.loginUrlParameters || {});
    options.loginUrlParameters.hd = Accounts._options.restrictCreationByEmailDomain;
  }

  var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(callback, code);
  Google.requestCredential(options, credentialRequestCompleteCallback);
};

var _Meteor = Meteor,
    loginWithGoogle = _Meteor.loginWithGoogle;

Meteor.loginWithGoogle = function (options, cb) {
  overrideLoginMethod(loginWithGoogle, [options], cb, loginWithGoogleAndTOTP);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TOTPLDAP.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPLDAP.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
module.link("../../../client/startup/ldap");
var reportError;
module.link("../../../client/lib/2fa/utils", {
  reportError: function (v) {
    reportError = v;
  }
}, 2);
var overrideLoginMethod;
module.link("../../../client/lib/2fa/overrideLoginMethod", {
  overrideLoginMethod: function (v) {
    overrideLoginMethod = v;
  }
}, 3);

Meteor.loginWithLDAPAndTOTP = function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  // Pull username and password
  var username = args.shift();
  var ldapPass = args.shift(); // Check if last argument is a function. if it is, pop it off and set callback to it

  var callback = typeof args[args.length - 1] === 'function' ? args.pop() : null; // The last argument before the callback is the totp code

  var code = args.pop(); // if args still holds options item, grab it

  var ldapOptions = args.length > 0 ? args.shift() : {}; // Set up loginRequest object

  var loginRequest = {
    ldap: true,
    username: username,
    ldapPass: ldapPass,
    ldapOptions: ldapOptions
  };
  Accounts.callLoginMethod({
    methodArguments: [{
      totp: {
        login: loginRequest,
        code: code
      }
    }],
    userCallback: function (error) {
      if (error) {
        reportError(error, callback);
      } else {
        callback && callback();
      }
    }
  });
};

var _Meteor = Meteor,
    loginWithLDAP = _Meteor.loginWithLDAP;

Meteor.loginWithLDAP = function () {
  for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
    args[_key2] = arguments[_key2];
  }

  var callback = typeof args[args.length - 1] === 'function' ? args.pop() : null;
  overrideLoginMethod(loginWithLDAP, args, callback, Meteor.loginWithLDAPAndTOTP, args[0]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TOTPOAuth.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPOAuth.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _this = this;

var capitalize;
module.link("@rocket.chat/string-helpers", {
  capitalize: function (v) {
    capitalize = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 2);
var Facebook;
module.link("meteor/facebook-oauth", {
  Facebook: function (v) {
    Facebook = v;
  }
}, 3);
var Github;
module.link("meteor/github-oauth", {
  Github: function (v) {
    Github = v;
  }
}, 4);
var Twitter;
module.link("meteor/twitter-oauth", {
  Twitter: function (v) {
    Twitter = v;
  }
}, 5);
var MeteorDeveloperAccounts;
module.link("meteor/meteor-developer-oauth", {
  MeteorDeveloperAccounts: function (v) {
    MeteorDeveloperAccounts = v;
  }
}, 6);
var Linkedin;
module.link("meteor/pauli:linkedin-oauth", {
  Linkedin: function (v) {
    Linkedin = v;
  }
}, 7);
var OAuth;
module.link("meteor/oauth", {
  OAuth: function (v) {
    OAuth = v;
  }
}, 8);
var process2faReturn;
module.link("../../../client/lib/2fa/process2faReturn", {
  process2faReturn: function (v) {
    process2faReturn = v;
  }
}, 9);
var CustomOAuth;
module.link("../../custom-oauth", {
  CustomOAuth: function (v) {
    CustomOAuth = v;
  }
}, 10);
var convertError;
module.link("../../../client/lib/2fa/utils", {
  convertError: function (v) {
    convertError = v;
  }
}, 11);
var overrideLoginMethod;
module.link("../../../client/lib/2fa/overrideLoginMethod", {
  overrideLoginMethod: function (v) {
    overrideLoginMethod = v;
  }
}, 12);
var lastCredentialToken = null;
var lastCredentialSecret = null;

Accounts.oauth.tryLoginAfterPopupClosed = function (credentialToken, callback, totpCode) {
  var credentialSecret = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
  credentialSecret = credentialSecret || OAuth._retrieveCredentialSecret(credentialToken) || null;
  var methodArgument = {
    oauth: {
      credentialToken: credentialToken,
      credentialSecret: credentialSecret
    }
  };
  lastCredentialToken = credentialToken;
  lastCredentialSecret = credentialSecret;

  if (totpCode && typeof totpCode === 'string') {
    methodArgument.totp = {
      code: totpCode
    };
  }

  Accounts.callLoginMethod({
    methodArguments: [methodArgument],
    userCallback: callback && function (err) {
      callback(convertError(err));
    }
  });
};

Accounts.oauth.credentialRequestCompleteHandler = function (callback, totpCode) {
  return function (credentialTokenOrError) {
    if (credentialTokenOrError && credentialTokenOrError instanceof Error) {
      callback && callback(credentialTokenOrError);
    } else {
      Accounts.oauth.tryLoginAfterPopupClosed(credentialTokenOrError, callback, totpCode);
    }
  };
};

var createOAuthTotpLoginMethod = function (credentialProvider) {
  return function (options, code, callback) {
    // support a callback without options
    if (!callback && typeof options === 'function') {
      callback = options;
      options = null;
    }

    if (lastCredentialToken && lastCredentialSecret) {
      Accounts.oauth.tryLoginAfterPopupClosed(lastCredentialToken, callback, code, lastCredentialSecret);
    } else {
      var provider = credentialProvider && credentialProvider() || _this;

      var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(callback, code);
      provider.requestCredential(options, credentialRequestCompleteCallback);
    }

    lastCredentialToken = null;
    lastCredentialSecret = null;
  };
};

var loginWithOAuthTokenAndTOTP = createOAuthTotpLoginMethod();
var loginWithFacebookAndTOTP = createOAuthTotpLoginMethod(function () {
  return Facebook;
});
var _Meteor = Meteor,
    loginWithFacebook = _Meteor.loginWithFacebook;

Meteor.loginWithFacebook = function (options, cb) {
  overrideLoginMethod(loginWithFacebook, [options], cb, loginWithFacebookAndTOTP);
};

var loginWithGithubAndTOTP = createOAuthTotpLoginMethod(function () {
  return Github;
});
var _Meteor2 = Meteor,
    loginWithGithub = _Meteor2.loginWithGithub;

Meteor.loginWithGithub = function (options, cb) {
  overrideLoginMethod(loginWithGithub, [options], cb, loginWithGithubAndTOTP);
};

var loginWithMeteorDeveloperAccountAndTOTP = createOAuthTotpLoginMethod(function () {
  return MeteorDeveloperAccounts;
});
var _Meteor3 = Meteor,
    loginWithMeteorDeveloperAccount = _Meteor3.loginWithMeteorDeveloperAccount;

Meteor.loginWithMeteorDeveloperAccount = function (options, cb) {
  overrideLoginMethod(loginWithMeteorDeveloperAccount, [options], cb, loginWithMeteorDeveloperAccountAndTOTP);
};

var loginWithTwitterAndTOTP = createOAuthTotpLoginMethod(function () {
  return Twitter;
});
var _Meteor4 = Meteor,
    loginWithTwitter = _Meteor4.loginWithTwitter;

Meteor.loginWithTwitter = function (options, cb) {
  overrideLoginMethod(loginWithTwitter, [options], cb, loginWithTwitterAndTOTP);
};

var loginWithLinkedinAndTOTP = createOAuthTotpLoginMethod(function () {
  return Linkedin;
});
var _Meteor5 = Meteor,
    loginWithLinkedin = _Meteor5.loginWithLinkedin;

Meteor.loginWithLinkedin = function (options, cb) {
  overrideLoginMethod(loginWithLinkedin, [options], cb, loginWithLinkedinAndTOTP);
};

Accounts.onPageLoadLogin(function (loginAttempt) {
  var _loginAttempt$error;

  if ((loginAttempt === null || loginAttempt === void 0 ? void 0 : (_loginAttempt$error = loginAttempt.error) === null || _loginAttempt$error === void 0 ? void 0 : _loginAttempt$error.error) !== 'totp-required') {
    return;
  }

  var methodArguments = loginAttempt.methodArguments;

  if (!(methodArguments !== null && methodArguments !== void 0 && methodArguments.length)) {
    return;
  }

  var oAuthArgs = methodArguments.find(function (arg) {
    return arg.oauth;
  });
  var _oAuthArgs$oauth = oAuthArgs.oauth,
      credentialToken = _oAuthArgs$oauth.credentialToken,
      credentialSecret = _oAuthArgs$oauth.credentialSecret;
  var cb = loginAttempt.userCallback;
  process2faReturn({
    error: loginAttempt.error,
    originalCallback: cb,
    onCode: function (code) {
      Accounts.oauth.tryLoginAfterPopupClosed(credentialToken, cb, code, credentialSecret);
    }
  });
});
var oldConfigureLogin = CustomOAuth.prototype.configureLogin;

CustomOAuth.prototype.configureLogin = function () {
  var loginWithService = "loginWith" + capitalize(String(this.name || ''));

  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  oldConfigureLogin.apply(this, args);
  var oldMethod = Meteor[loginWithService];

  Meteor[loginWithService] = function (options, cb) {
    overrideLoginMethod(oldMethod, [options], cb, loginWithOAuthTokenAndTOTP);
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TOTPPassword.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPPassword.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
var t;
module.link("../../utils", {
  t: function (v) {
    t = v;
  }
}, 2);
var process2faReturn;
module.link("../../../client/lib/2fa/process2faReturn", {
  process2faReturn: function (v) {
    process2faReturn = v;
  }
}, 3);
var isTotpInvalidError, reportError;
module.link("../../../client/lib/2fa/utils", {
  isTotpInvalidError: function (v) {
    isTotpInvalidError = v;
  },
  reportError: function (v) {
    reportError = v;
  }
}, 4);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 5);

Meteor.loginWithPasswordAndTOTP = function (selector, password, code, callback) {
  if (typeof selector === 'string') {
    if (selector.indexOf('@') === -1) {
      selector = {
        username: selector
      };
    } else {
      selector = {
        email: selector
      };
    }
  }

  Accounts.callLoginMethod({
    methodArguments: [{
      totp: {
        login: {
          user: selector,
          password: Accounts._hashPassword(password)
        },
        code: code
      }
    }],
    userCallback: function (error) {
      if (error) {
        reportError(error, callback);
      } else {
        callback && callback();
      }
    }
  });
};

var _Meteor = Meteor,
    loginWithPassword = _Meteor.loginWithPassword;

Meteor.loginWithPassword = function (email, password, cb) {
  loginWithPassword(email, password, function (error) {
    process2faReturn({
      error: error,
      originalCallback: cb,
      emailOrUsername: email,
      onCode: function (code) {
        Meteor.loginWithPasswordAndTOTP(email, password, code, function (error) {
          if (isTotpInvalidError(error)) {
            dispatchToastMessage({
              type: 'error',
              message: t('Invalid_two_factor_code')
            });
            cb();
            return;
          }

          cb(error);
        });
      }
    });
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TOTPSaml.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/TOTPSaml.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
module.link("../../meteor-accounts-saml/client/saml_client");
var reportError;
module.link("../../../client/lib/2fa/utils", {
  reportError: function (v) {
    reportError = v;
  }
}, 2);
var overrideLoginMethod;
module.link("../../../client/lib/2fa/overrideLoginMethod", {
  overrideLoginMethod: function (v) {
    overrideLoginMethod = v;
  }
}, 3);

Meteor.loginWithSamlTokenAndTOTP = function (credentialToken, code, callback) {
  Accounts.callLoginMethod({
    methodArguments: [{
      totp: {
        login: {
          saml: true,
          credentialToken: credentialToken
        },
        code: code
      }
    }],
    userCallback: function (error) {
      if (error) {
        reportError(error, callback);
      } else {
        callback && callback();
      }
    }
  });
};

var _Meteor = Meteor,
    loginWithSamlToken = _Meteor.loginWithSamlToken;

Meteor.loginWithSamlToken = function (options, callback) {
  overrideLoginMethod(loginWithSamlToken, [options], callback, Meteor.loginWithSamlTokenAndTOTP);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/index.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./TOTPPassword");
module.link("./TOTPOAuth");
module.link("./TOTPGoogle");
module.link("./TOTPSaml");
module.link("./TOTPLDAP");
module.link("./TOTPCrowd");
module.link("./overrideMeteorCall");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"overrideMeteorCall.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/2fa/client/overrideMeteorCall.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var t;
module.link("../../utils/client", {
  t: function (v) {
    t = v;
  }
}, 1);
var process2faReturn;
module.link("../../../client/lib/2fa/process2faReturn", {
  process2faReturn: function (v) {
    process2faReturn = v;
  }
}, 2);
var isTotpInvalidError;
module.link("../../../client/lib/2fa/utils", {
  isTotpInvalidError: function (v) {
    isTotpInvalidError = v;
  }
}, 3);
var dispatchToastMessage;
module.link("../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 4);
var _Meteor = Meteor,
    call = _Meteor.call;

var callWithTotp = function (methodName, args, callback) {
  return function (twoFactorCode, twoFactorMethod) {
    return call.apply(void 0, [methodName].concat(_toConsumableArray(args), [{
      twoFactorCode: twoFactorCode,
      twoFactorMethod: twoFactorMethod
    }, function (error, result) {
      if (isTotpInvalidError(error)) {
        error.toastrShowed = true;
        dispatchToastMessage({
          type: 'error',
          message: t('Invalid_two_factor_code')
        });
        callback(error);
        return;
      }

      callback(error, result);
    }]));
  };
};

var callWithoutTotp = function (methodName, args, callback) {
  return function () {
    return call.apply(void 0, [methodName].concat(_toConsumableArray(args), [function (error, result) {
      process2faReturn({
        error: error,
        result: result,
        onCode: callWithTotp(methodName, args, callback),
        originalCallback: callback,
        emailOrUsername: undefined
      });
    }]));
  };
};

Meteor.call = function (methodName) {
  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }

  var callback = args.length > 0 && typeof args[args.length - 1] === 'function' ? args.pop() : function () {
    return undefined;
  };
  return callWithoutTotp(methodName, args, callback)();
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"analytics":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/analytics/client/index.js                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./loadScript");
module.link("./trackEvents");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"loadScript.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/analytics/client/loadScript.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 2);
Template.body.onRendered(function () {
  this.autorun(function (c) {
    var piwikUrl = settings.get('PiwikAnalytics_enabled') && settings.get('PiwikAnalytics_url');
    var piwikSiteId = piwikUrl && settings.get('PiwikAnalytics_siteId');
    var piwikPrependDomain = piwikUrl && settings.get('PiwikAnalytics_prependDomain');
    var piwikCookieDomain = piwikUrl && settings.get('PiwikAnalytics_cookieDomain');
    var piwikDomains = piwikUrl && settings.get('PiwikAnalytics_domains');
    var piwikAdditionalTracker = piwikUrl && settings.get('PiwikAdditionalTrackers');
    var googleId = settings.get('GoogleAnalytics_enabled') && settings.get('GoogleAnalytics_ID');

    if (piwikSiteId || googleId) {
      c.stop();

      if (piwikSiteId) {
        window._paq = window._paq || [];

        if (Meteor.userId()) {
          window._paq.push(['setUserId', Meteor.userId()]);
        }

        window._paq.push(['trackPageView']);

        window._paq.push(['enableLinkTracking']);

        if (piwikPrependDomain) {
          window._paq.push(['setDocumentTitle', window.location.hostname + "/" + document.title]);
        }

        var upperLevelDomain = "*." + window.location.hostname.split('.').slice(1).join('.');

        if (piwikCookieDomain) {
          window._paq.push(['setCookieDomain', upperLevelDomain]);
        }

        if (piwikDomains) {
          // array
          var domainsArray = piwikDomains.split(/\n/);
          var domains = [];

          for (var i = 0; i < domainsArray.length; i++) {
            // only push domain if it contains a non whitespace character.
            if (/\S/.test(domainsArray[i])) {
              domains.push("*." + domainsArray[i].trim());
            }
          }

          window._paq.push(['setDomains', domains]);
        }

        (function () {
          try {
            if (/\S/.test(piwikAdditionalTracker)) {
              // piwikAdditionalTracker is not empty or whitespace only
              var addTrackers = JSON.parse(piwikAdditionalTracker);

              for (var _i = 0; _i < addTrackers.length; _i++) {
                var tracker = addTrackers[_i];

                window._paq.push(['addTracker', tracker.trackerURL + "js/", tracker.siteId]);
              }
            }
          } catch (e) {
            // parsing JSON faild
            console.log('Error while parsing JSON value of "piwikAdditionalTracker": ', e);
          }

          window._paq.push(['setTrackerUrl', piwikUrl + "js/"]);

          window._paq.push(['setSiteId', Number.parseInt(piwikSiteId)]);

          var d = document;
          var g = d.createElement('script');
          var s = d.getElementsByTagName('script')[0];
          g.type = 'text/javascript';
          g.async = true;
          g.defer = true;
          g.src = piwikUrl + "js/";
          s.parentNode.insertBefore(g, s);
        })();
      }

      if (googleId) {
        /*eslint-disable */
        (function (i, s, o, g, r, a, m) {
          i['GoogleAnalyticsObject'] = r;
          i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments);
          }, i[r].l = 1 * new Date();
          a = s.createElement(o), m = s.getElementsByTagName(o)[0];
          a.async = 1;
          a.src = g;
          m.parentNode.insertBefore(a, m);
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', googleId, 'auto');
        ga('send', 'pageview');
        /* eslint-enable */
      }
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"trackEvents.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/analytics/client/trackEvents.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 4);
var ChatRoom;
module.link("../../models", {
  ChatRoom: function (v) {
    ChatRoom = v;
  }
}, 5);

function trackEvent(category, action, label) {
  if (window._paq) {
    window._paq.push(['trackEvent', category, action, label]);
  }

  if (window.ga) {
    window.ga('send', 'event', category, action, label);
  }
}

if (!window._paq || window.ga) {
  // Trigger the trackPageView manually as the page views are only loaded when the loadScript.js code is executed
  FlowRouter.triggers.enter([function (route) {
    if (window._paq) {
      var http = location.protocol;
      var slashes = http.concat('//');
      var host = slashes.concat(window.location.hostname);

      window._paq.push(['setCustomUrl', host + route.path]);

      window._paq.push(['trackPageView']);
    }

    if (window.ga) {
      window.ga('send', 'pageview', route.path);
    }
  }]); // Login page has manual switches

  callbacks.add('loginPageStateChange', function (state) {
    trackEvent('Navigation', 'Login Page State Change', state);
  }, callbacks.priority.MEDIUM, 'analytics-login-state-change'); // Messsages

  callbacks.add('afterSaveMessage', function (message) {
    if ((window._paq || window.ga) && settings.get('Analytics_features_messages')) {
      var room = ChatRoom.findOne({
        _id: message.rid
      });
      trackEvent('Message', 'Send', room.name + " (" + room._id + ")");
    }
  }, 2000, 'trackEvents'); // Rooms

  callbacks.add('afterCreateChannel', function (owner, room) {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Create', room.name + " (" + room._id + ")");
    }
  }, callbacks.priority.MEDIUM, 'analytics-after-create-channel');
  callbacks.add('roomNameChanged', function (room) {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Changed Name', room.name + " (" + room._id + ")");
    }
  }, callbacks.priority.MEDIUM, 'analytics-room-name-changed');
  callbacks.add('roomTopicChanged', function (room) {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Changed Topic', room.name + " (" + room._id + ")");
    }
  }, callbacks.priority.MEDIUM, 'analytics-room-topic-changed');
  callbacks.add('roomAnnouncementChanged', function (room) {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Changed Announcement', room.name + " (" + room._id + ")");
    }
  }, callbacks.priority.MEDIUM, 'analytics-room-announcement-changed');
  callbacks.add('roomTypeChanged', function (room) {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Changed Room Type', room.name + " (" + room._id + ")");
    }
  }, callbacks.priority.MEDIUM, 'analytics-room-type-changed');
  callbacks.add('archiveRoom', function (room) {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Archived', room.name + " (" + room._id + ")");
    }
  }, callbacks.priority.MEDIUM, 'analytics-archive-room');
  callbacks.add('unarchiveRoom', function (room) {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Unarchived', room.name + " (" + room._id + ")");
    }
  }, callbacks.priority.MEDIUM, 'analytics-unarchive-room'); // Users
  // Track logins and associate user ids with piwik

  (function () {
    var oldUserId = null;
    Tracker.autorun(function () {
      var newUserId = Meteor.userId();

      if (oldUserId === null && newUserId) {
        if (window._paq && settings.get('Analytics_features_users')) {
          trackEvent('User', 'Login', newUserId);

          window._paq.push(['setUserId', newUserId]);
        }
      } else if (newUserId === null && oldUserId) {
        if (window._paq && settings.get('Analytics_features_users')) {
          trackEvent('User', 'Logout', oldUserId);
        }
      }

      oldUserId = Meteor.userId();
    });
  })();

  callbacks.add('userRegistered', function () {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Registered');
    }
  }, callbacks.priority.MEDIUM, 'piwik-user-resitered');
  callbacks.add('usernameSet', function () {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Username Set');
    }
  }, callbacks.priority.MEDIUM, 'piweik-username-set');
  callbacks.add('userPasswordReset', function () {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Reset Password');
    }
  }, callbacks.priority.MEDIUM, 'piwik-user-password-reset');
  callbacks.add('userConfirmationEmailRequested', function () {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Confirmation Email Requested');
    }
  }, callbacks.priority.MEDIUM, 'piwik-user-confirmation-email-requested');
  callbacks.add('userForgotPasswordEmailRequested', function () {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Forgot Password Email Requested');
    }
  }, callbacks.priority.MEDIUM, 'piwik-user-forgot-password-email-requested');
  callbacks.add('userStatusManuallySet', function (status) {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Status Manually Changed', status);
    }
  }, callbacks.priority.MEDIUM, 'analytics-user-status-manually-set');
  callbacks.add('userAvatarSet', function (service) {
    if (settings.get('Analytics_features_users')) {
      trackEvent('User', 'Avatar Changed', service);
    }
  }, callbacks.priority.MEDIUM, 'analytics-user-avatar-set');
  callbacks.add('roomAvatarChanged', function (room) {
    if (settings.get('Analytics_features_rooms')) {
      trackEvent('Room', 'Changed Avatar', room.name + " (" + room._id + ")");
    }
  }, callbacks.priority.MEDIUM, 'analytics-room-avatar-changed');
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"autolinker":{"client":{"client.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "meteor/meteor",
  "meteor/random",
  "autolinker",
  "@rocket.chat/string-helpers"
],"index.js":[
  "./client"
]}},"blockstack":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/blockstack/client/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration: function (v) {
    ServiceConfiguration = v;
  }
}, 1);
var check, Match;
module.link("meteor/check", {
  check: function (v) {
    check = v;
  },
  Match: function (v) {
    Match = v;
  }
}, 2);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 3);
module.link("./routes");

var handleError = function (error) {
  return error && Session.set('errorMessage', error.reason || 'Unknown error');
}; // TODO: allow serviceConfig.loginStyle == popup


Meteor.loginWithBlockstack = function (options) {
  var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : handleError;

  if (!options || !options.redirectURI) {
    options = ServiceConfiguration.configurations.findOne({
      service: 'blockstack'
    });
    options.blockstackIDHost = Meteor.Device.isDesktop() ? 'http://localhost:8888/auth' : 'https://blockstack.org/auth';
    options.scopes = ['store_write'];
  }

  try {
    check(options, Match.ObjectIncluding({
      blockstackIDHost: String,
      redirectURI: String,
      manifestURI: String
    }));
    module.dynamicImport('blockstack/dist/blockstack').then(function (_ref) {
      var redirectToSignIn = _ref.redirectToSignIn;
      return redirectToSignIn(options.redirectURI, options.manifestURI, options.scopes);
    });
  } catch (err) {
    callback.call(Meteor, err);
  }
};

var meteorLogout = Meteor.logout;

Meteor.logout = function () {
  var serviceConfig = ServiceConfiguration.configurations.findOne({
    service: 'blockstack'
  });
  var blockstackAuth = Session.get('blockstack_auth');

  if (serviceConfig && blockstackAuth) {
    Session.delete('blockstack_auth');
    module.dynamicImport('blockstack/dist/blockstack').then(function (_ref2) {
      var signUserOut = _ref2.signUserOut;
      return signUserOut(window.location.href);
    });
  }

  return meteorLogout.apply(void 0, arguments);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/blockstack/client/routes.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 2);

var blockstackLogin = function (authResponse) {
  var userData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  Accounts.callLoginMethod({
    methodArguments: [{
      blockstack: true,
      authResponse: authResponse,
      userData: userData
    }],
    userCallback: function () {
      FlowRouter.go('home');
    }
  });
};

FlowRouter.route('/_blockstack/validate', {
  name: 'blockstackValidate',
  action: function () {
    function _callee(params, queryParams) {
      var blockstack, userData;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return _regeneratorRuntime.awrap(module.dynamicImport('blockstack/dist/blockstack'));

              case 2:
                blockstack = _context.sent;

                if (!Meteor.userId()) {
                  _context.next = 6;
                  break;
                }

                console.log('Blockstack Auth requested when already logged in. Reloading.');
                return _context.abrupt("return", FlowRouter.go('home'));

              case 6:
                if (!(queryParams.authResponse == null)) {
                  _context.next = 8;
                  break;
                }

                throw new Meteor.Error('Blockstack: Auth request without response param.');

              case 8:
                if (blockstack.isUserSignedIn()) {
                  userData = blockstack.loadUserData();
                }

                if (!blockstack.isSignInPending()) {
                  _context.next = 13;
                  break;
                }

                _context.next = 12;
                return _regeneratorRuntime.awrap(blockstack.handlePendingSignIn());

              case 12:
                userData = _context.sent;

              case 13:
                blockstackLogin(queryParams.authResponse, userData);

              case 14:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }()
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"cas":{"client":{"cas_client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/cas/client/cas_client.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 2);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 3);

var openCenteredPopup = function (url, width, height) {
  var screenX = typeof window.screenX !== 'undefined' ? window.screenX : window.screenLeft;
  var screenY = typeof window.screenY !== 'undefined' ? window.screenY : window.screenTop;
  var outerWidth = typeof window.outerWidth !== 'undefined' ? window.outerWidth : document.body.clientWidth;
  var outerHeight = typeof window.outerHeight !== 'undefined' ? window.outerHeight : document.body.clientHeight - 22; // XXX what is the 22?
  // Use `outerWidth - width` and `outerHeight - height` for help in
  // positioning the popup centered relative to the current window

  var left = screenX + (outerWidth - width) / 2;
  var top = screenY + (outerHeight - height) / 2;
  var features = "width=" + width + ",height=" + height + ",left=" + left + ",top=" + top + ",scrollbars=yes";
  var newwindow = window.open(url, 'Login', features);

  if (newwindow.focus) {
    newwindow.focus();
  }

  return newwindow;
};

Meteor.loginWithCas = function (options, callback) {
  options = options || {};
  var credentialToken = Random.id();
  var login_url = settings.get('CAS_login_url');
  var popup_width = settings.get('CAS_popup_width');
  var popup_height = settings.get('CAS_popup_height');

  if (!login_url) {
    return;
  }

  var appUrl = Meteor.absoluteUrl().replace(/\/$/, '') + __meteor_runtime_config__.ROOT_URL_PATH_PREFIX; // check if the provided CAS URL already has some parameters


  var delim = login_url.split('?').length > 1 ? '&' : '?';
  var loginUrl = "" + login_url + delim + "service=" + appUrl + "/_cas/" + credentialToken;
  var popup = openCenteredPopup(loginUrl, popup_width || 800, popup_height || 600);
  var checkPopupOpen = setInterval(function () {
    var popupClosed;

    try {
      // Fix for #328 - added a second test criteria (popup.closed === undefined)
      // to humour this Android quirk:
      // http://code.google.com/p/android/issues/detail?id=21061
      popupClosed = popup.closed || popup.closed === undefined;
    } catch (e) {
      // For some unknown reason, IE9 (and others?) sometimes (when
      // the popup closes too quickly?) throws "SCRIPT16386: No such
      // interface supported" when trying to read 'popup.closed'. Try
      // again in 100ms.
      return;
    }

    if (popupClosed) {
      clearInterval(checkPopupOpen); // check auth on server.

      Accounts.callLoginMethod({
        methodArguments: [{
          cas: {
            credentialToken: credentialToken
          }
        }],
        userCallback: callback
      });
    }
  }, 100);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/cas/client/index.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./cas_client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"colors":{"client":{"client.js":[
  "./style.css"
],"index.js":[
  "./client"
],"style.css":[]}},"cors":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/cors/client/index.js                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 2);
Meteor.startup(function () {
  Tracker.autorun(function () {
    Meteor.absoluteUrl.defaultOptions.secure = Boolean(settings.get('Force_SSL'));
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"crowd":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/crowd/client/index.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./loginHelper");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"loginHelper.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/crowd/client/loginHelper.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);

Meteor.loginWithCrowd = function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  // Pull username and password
  var username = args.shift();
  var password = args.shift();
  var callback = args.shift();
  var loginRequest = {
    crowd: true,
    username: username,
    crowdPassword: password
  };
  Accounts.callLoginMethod({
    methodArguments: [loginRequest],
    userCallback: function (error) {
      if (callback) {
        if (error) {
          return callback(error);
        }

        return callback();
      }
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"custom":{"client":{"index.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"custom-oauth":{"client":{"custom_oauth_client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-oauth/client/custom_oauth_client.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CustomOAuth: function () {
    return CustomOAuth;
  }
});
var capitalize;
module.link("@rocket.chat/string-helpers", {
  capitalize: function (v) {
    capitalize = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Match;
module.link("meteor/check", {
  Match: function (v) {
    Match = v;
  }
}, 2);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 3);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 4);
var ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration: function (v) {
    ServiceConfiguration = v;
  }
}, 5);
var OAuth;
module.link("meteor/oauth", {
  OAuth: function (v) {
    OAuth = v;
  }
}, 6);
module.link("./swapSessionStorage");
var isURL;
module.link("../../utils/lib/isURL", {
  isURL: function (v) {
    isURL = v;
  }
}, 7);

var CustomOAuth = /*#__PURE__*/function () {
  function CustomOAuth(name, options) {
    this.name = name;

    if (!Match.test(this.name, String)) {
      throw new Meteor.Error('CustomOAuth: Name is required and must be String');
    }

    this.configure(options);
    Accounts.oauth.registerService(this.name);
    this.configureLogin();
  }

  var _proto = CustomOAuth.prototype;

  _proto.configure = function () {
    function configure(options) {
      if (!Match.test(options, Object)) {
        throw new Meteor.Error('CustomOAuth: Options is required and must be Object');
      }

      if (!Match.test(options.serverURL, String)) {
        throw new Meteor.Error('CustomOAuth: Options.serverURL is required and must be String');
      }

      if (!Match.test(options.authorizePath, String)) {
        options.authorizePath = '/oauth/authorize';
      }

      if (!Match.test(options.scope, String)) {
        options.scope = 'openid';
      }

      this.serverURL = options.serverURL;
      this.authorizePath = options.authorizePath;
      this.scope = options.scope;

      if (!isURL(this.authorizePath)) {
        this.authorizePath = this.serverURL + this.authorizePath;
      }
    }

    return configure;
  }();

  _proto.configureLogin = function () {
    function configureLogin() {
      var _this = this;

      var loginWithService = "loginWith" + capitalize(String(this.name || ''));

      Meteor[loginWithService] = function (options, callback) {
        // support a callback without options
        if (!callback && typeof options === 'function') {
          callback = options;
          options = null;
        }

        var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(callback);

        _this.requestCredential(options, credentialRequestCompleteCallback);
      };
    }

    return configureLogin;
  }();

  _proto.requestCredential = function () {
    function requestCredential(options, credentialRequestCompleteCallback) {
      // support both (options, callback) and (callback).
      if (!credentialRequestCompleteCallback && typeof options === 'function') {
        credentialRequestCompleteCallback = options;
        options = {};
      }

      var config = ServiceConfiguration.configurations.findOne({
        service: this.name
      });

      if (!config) {
        if (credentialRequestCompleteCallback) {
          credentialRequestCompleteCallback(new ServiceConfiguration.ConfigError());
        }

        return;
      }

      var credentialToken = Random.secret();

      var loginStyle = OAuth._loginStyle(this.name, config, options);

      var separator = this.authorizePath.indexOf('?') !== -1 ? '&' : '?';
      var loginUrl = "" + this.authorizePath + separator + "client_id=" + config.clientId + "&redirect_uri=" + encodeURIComponent(OAuth._redirectUri(this.name, config)) + "&response_type=code" + ("&state=" + encodeURIComponent(OAuth._stateParam(loginStyle, credentialToken, options.redirectUrl)) + "&scope=" + encodeURIComponent(this.scope));
      OAuth.launchLogin({
        loginService: this.name,
        loginStyle: loginStyle,
        loginUrl: loginUrl,
        credentialRequestCompleteCallback: credentialRequestCompleteCallback,
        credentialToken: credentialToken,
        popupOptions: {
          width: 900,
          height: 450
        }
      });
    }

    return requestCredential;
  }();

  return CustomOAuth;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"swapSessionStorage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-oauth/client/swapSessionStorage.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var OAuth;
module.link("meteor/oauth", {
  OAuth: function (v) {
    OAuth = v;
  }
}, 1);
var Reload;
module.link("meteor/reload", {
  Reload: function (v) {
    Reload = v;
  }
}, 2);

// TODO: This is a nasty workaround and should be removed as soon as possible
// Firefox is losing the sessionStorage data (v >= 79.0) after the redirect
if (navigator.userAgent.indexOf('Firefox') !== -1) {
  var KEY_NAME = 'Swapped_Storage_Workaround';

  OAuth.saveDataForRedirect = function (loginService, credentialToken) {
    Meteor._localStorage.setItem(KEY_NAME, JSON.stringify({
      loginService: loginService,
      credentialToken: credentialToken
    }));

    Reload._migrate(null, {
      immediateMigration: true
    });
  };

  OAuth.getDataAfterRedirect = function () {
    var migrationData = Meteor._localStorage.getItem(KEY_NAME);

    Meteor._localStorage.removeItem(KEY_NAME);

    try {
      migrationData = JSON.parse(migrationData);
    } catch (error) {
      migrationData = null;
    }

    if (!(migrationData && migrationData.credentialToken)) {
      return null;
    }

    var _migrationData = migrationData,
        credentialToken = _migrationData.credentialToken;
    var key = OAuth._storageTokenPrefix + credentialToken;
    var credentialSecret;

    try {
      credentialSecret = sessionStorage.getItem(key);
      sessionStorage.removeItem(key);
    } catch (e) {
      Meteor._debug('error retrieving credentialSecret', e);
    }

    return {
      loginService: migrationData.loginService,
      credentialToken: credentialToken,
      credentialSecret: credentialSecret
    };
  };
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/custom-oauth/index.js                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
!function (module1) {
  var Meteor;
  module1.link("meteor/meteor", {
    Meteor: function (v) {
      Meteor = v;
    }
  }, 0);

  if (Meteor.isClient) {
    module.exports = require('./client/custom_oauth_client.js');
  }

  if (Meteor.isServer) {
    module.exports = require('./server/custom_oauth_server.js');
  }
}.call(this, module);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"favico":{"client":{"favico.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/favico/client/favico.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Favico: function () {
    return Favico;
  }
});

var Favico = function (opt) {
  'use strict';

  opt = opt ? opt : {};
  var _def = {
    bgColor: '#d00',
    textColor: '#fff',
    fontFamily: 'sans-serif',
    //Arial,Verdana,Times New Roman,serif,sans-serif,...
    fontStyle: 'bold',
    //normal,italic,oblique,bold,bolder,lighter,100,200,300,400,500,600,700,800,900
    type: 'circle',
    position: 'down',
    // down, up, left, leftup (upleft)
    animation: 'slide',
    elementId: false,
    dataUrl: false,
    win: window
  };

  var _opt, _orig, _h, _w, _canvas, _context, _img, _ready, _lastBadge, _running, _readyCb, _stop, _browser, _animTimeout, _drawTimeout, _doc;

  _browser = {};
  _browser.ff = typeof InstallTrigger !== 'undefined';
  _browser.chrome = !!window.chrome;
  _browser.opera = !!window.opera || navigator.userAgent.indexOf('Opera') >= 0;
  _browser.ie =
  /*@cc_on!@*/
  false;
  _browser.safari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0;
  _browser.supported = _browser.chrome || _browser.ff || _browser.opera;
  var _queue = [];

  _readyCb = function () {};

  _ready = _stop = false;
  /**
   * Initialize favico
   */

  var init = function () {
    //merge initial options
    _opt = merge(_def, opt);
    _opt.bgColor = hexToRgb(_opt.bgColor);
    _opt.textColor = hexToRgb(_opt.textColor);
    _opt.position = _opt.position.toLowerCase();
    _opt.animation = animation.types['' + _opt.animation] ? _opt.animation : _def.animation;
    _doc = _opt.win.document;
    var isUp = _opt.position.indexOf('up') > -1;
    var isLeft = _opt.position.indexOf('left') > -1; //transform the animations

    if (isUp || isLeft) {
      for (var a in meteorBabelHelpers.sanitizeForInObject(animation.types)) {
        for (var i = 0; i < animation.types[a].length; i++) {
          var step = animation.types[a][i];

          if (isUp) {
            if (step.y < 0.6) {
              step.y = step.y - 0.4;
            } else {
              step.y = step.y - 2 * step.y + (1 - step.w);
            }
          }

          if (isLeft) {
            if (step.x < 0.6) {
              step.x = step.x - 0.4;
            } else {
              step.x = step.x - 2 * step.x + (1 - step.h);
            }
          }

          animation.types[a][i] = step;
        }
      }
    }

    _opt.type = type['' + _opt.type] ? _opt.type : _def.type;
    _orig = link.getIcons(); //create temp canvas

    _canvas = document.createElement('canvas'); //create temp image

    _img = document.createElement('img');
    var lastIcon = _orig[_orig.length - 1];

    if (lastIcon.hasAttribute('href')) {
      _img.setAttribute('crossOrigin', 'anonymous'); //get width/height


      _img.onload = function () {
        _h = _img.height > 0 ? _img.height : 32;
        _w = _img.width > 0 ? _img.width : 32;
        _canvas.height = _h;
        _canvas.width = _w;
        _context = _canvas.getContext('2d');
        icon.ready();
      };

      _img.setAttribute('src', lastIcon.getAttribute('href'));
    } else {
      _img.onload = function () {
        _h = 32;
        _w = 32;
        _img.height = _h;
        _img.width = _w;
        _canvas.height = _h;
        _canvas.width = _w;
        _context = _canvas.getContext('2d');
        icon.ready();
      };

      _img.setAttribute('src', '');
    }
  };
  /**
   * Icon namespace
   */


  var icon = {};
  /**
   * Icon is ready (reset icon) and start animation (if ther is any)
   */

  icon.ready = function () {
    _ready = true;
    icon.reset();

    _readyCb();
  };
  /**
   * Reset icon to default state
   */


  icon.reset = function () {
    //reset
    if (!_ready) {
      return;
    }

    _queue = [];
    _lastBadge = false;
    _running = false;

    _context.clearRect(0, 0, _w, _h);

    _context.drawImage(_img, 0, 0, _w, _h); //_stop=true;


    link.setIcon(_canvas); //webcam('stop');
    //video('stop');

    window.clearTimeout(_animTimeout);
    window.clearTimeout(_drawTimeout);
  };
  /**
   * Start animation
   */


  icon.start = function () {
    if (!_ready || _running) {
      return;
    }

    var finished = function () {
      _lastBadge = _queue[0];
      _running = false;

      if (_queue.length > 0) {
        _queue.shift();

        icon.start();
      }
    };

    if (_queue.length > 0) {
      _running = true;

      var run = function () {
        // apply options for this animation
        ['type', 'animation', 'bgColor', 'textColor', 'fontFamily', 'fontStyle'].forEach(function (a) {
          if (a in _queue[0].options) {
            _opt[a] = _queue[0].options[a];
          }
        });
        animation.run(_queue[0].options, function () {
          finished();
        }, false);
      };

      if (_lastBadge) {
        animation.run(_lastBadge.options, function () {
          run();
        }, true);
      } else {
        run();
      }
    }
  };
  /**
   * Badge types
   */


  var type = {};

  var options = function (opt) {
    opt.n = typeof opt.n === 'number' ? Math.abs(opt.n | 0) : opt.n;
    opt.x = _w * opt.x;
    opt.y = _h * opt.y;
    opt.w = _w * opt.w;
    opt.h = _h * opt.h;
    opt.len = ('' + opt.n).length;
    return opt;
  };
  /**
   * Generate circle
   * @param {Object} opt Badge options
   */


  type.circle = function (opt) {
    opt = options(opt);
    var more = false;

    if (opt.len === 2) {
      opt.x = opt.x - opt.w * 0.4;
      opt.w = opt.w * 1.4;
      more = true;
    } else if (opt.len >= 3) {
      opt.x = opt.x - opt.w * 0.65;
      opt.w = opt.w * 1.65;
      more = true;
    }

    _context.clearRect(0, 0, _w, _h);

    _context.drawImage(_img, 0, 0, _w, _h);

    _context.beginPath();

    _context.font = _opt.fontStyle + ' ' + Math.floor(opt.h * (opt.n > 99 ? 0.85 : 1)) + 'px ' + _opt.fontFamily;
    _context.textAlign = 'center';

    if (more) {
      _context.moveTo(opt.x + opt.w / 2, opt.y);

      _context.lineTo(opt.x + opt.w - opt.h / 2, opt.y);

      _context.quadraticCurveTo(opt.x + opt.w, opt.y, opt.x + opt.w, opt.y + opt.h / 2);

      _context.lineTo(opt.x + opt.w, opt.y + opt.h - opt.h / 2);

      _context.quadraticCurveTo(opt.x + opt.w, opt.y + opt.h, opt.x + opt.w - opt.h / 2, opt.y + opt.h);

      _context.lineTo(opt.x + opt.h / 2, opt.y + opt.h);

      _context.quadraticCurveTo(opt.x, opt.y + opt.h, opt.x, opt.y + opt.h - opt.h / 2);

      _context.lineTo(opt.x, opt.y + opt.h / 2);

      _context.quadraticCurveTo(opt.x, opt.y, opt.x + opt.h / 2, opt.y);
    } else {
      _context.arc(opt.x + opt.w / 2, opt.y + opt.h / 2, opt.h / 2, 0, 2 * Math.PI);
    }

    _context.fillStyle = 'rgba(' + _opt.bgColor.r + ',' + _opt.bgColor.g + ',' + _opt.bgColor.b + ',' + opt.o + ')';

    _context.fill();

    _context.closePath();

    _context.beginPath();

    _context.stroke();

    _context.fillStyle = 'rgba(' + _opt.textColor.r + ',' + _opt.textColor.g + ',' + _opt.textColor.b + ',' + opt.o + ')'; //_context.fillText((more) ? '9+' : opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));

    if (typeof opt.n === 'number' && opt.n > 999) {
      _context.fillText((opt.n > 9999 ? 9 : Math.floor(opt.n / 1000)) + 'k+', Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.2));
    } else {
      _context.fillText(opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));
    }

    _context.closePath();
  };
  /**
   * Generate rectangle
   * @param {Object} opt Badge options
   */


  type.rectangle = function (opt) {
    opt = options(opt);
    var more = false;

    if (opt.len === 2) {
      opt.x = opt.x - opt.w * 0.4;
      opt.w = opt.w * 1.4;
      more = true;
    } else if (opt.len >= 3) {
      opt.x = opt.x - opt.w * 0.65;
      opt.w = opt.w * 1.65;
      more = true;
    }

    _context.clearRect(0, 0, _w, _h);

    _context.drawImage(_img, 0, 0, _w, _h);

    _context.beginPath();

    _context.font = _opt.fontStyle + ' ' + Math.floor(opt.h * (opt.n > 99 ? 0.9 : 1)) + 'px ' + _opt.fontFamily;
    _context.textAlign = 'center';
    _context.fillStyle = 'rgba(' + _opt.bgColor.r + ',' + _opt.bgColor.g + ',' + _opt.bgColor.b + ',' + opt.o + ')';

    _context.fillRect(opt.x, opt.y, opt.w, opt.h);

    _context.fillStyle = 'rgba(' + _opt.textColor.r + ',' + _opt.textColor.g + ',' + _opt.textColor.b + ',' + opt.o + ')'; //_context.fillText((more) ? '9+' : opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));

    if (typeof opt.n === 'number' && opt.n > 999) {
      _context.fillText((opt.n > 9999 ? 9 : Math.floor(opt.n / 1000)) + 'k+', Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.2));
    } else {
      _context.fillText(opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));
    }

    _context.closePath();
  };
  /**
   * Set badge
   */


  var badge = function (number, opts) {
    opts = (typeof opts === 'string' ? {
      animation: opts
    } : opts) || {};

    _readyCb = function () {
      try {
        if (typeof number === 'number' ? number > 0 : number !== '') {
          var q = {
            type: 'badge',
            options: {
              n: number
            }
          };

          if ('animation' in opts && animation.types['' + opts.animation]) {
            q.options.animation = '' + opts.animation;
          }

          if ('type' in opts && type['' + opts.type]) {
            q.options.type = '' + opts.type;
          }

          ['bgColor', 'textColor'].forEach(function (o) {
            if (o in opts) {
              q.options[o] = hexToRgb(opts[o]);
            }
          });
          ['fontStyle', 'fontFamily'].forEach(function (o) {
            if (o in opts) {
              q.options[o] = opts[o];
            }
          });

          _queue.push(q);

          if (_queue.length > 100) {
            throw new Error('Too many badges requests in queue.');
          }

          icon.start();
        } else {
          icon.reset();
        }
      } catch (e) {
        throw new Error('Error setting badge. Message: ' + e.message);
      }
    };

    if (_ready) {
      _readyCb();
    }
  };
  /**
   * Set image as icon
   */


  var image = function (imageElement) {
    _readyCb = function () {
      try {
        var w = imageElement.width;
        var h = imageElement.height;
        var newImg = document.createElement('img');
        var ratio = w / _w < h / _h ? w / _w : h / _h;
        newImg.setAttribute('crossOrigin', 'anonymous');

        newImg.onload = function () {
          _context.clearRect(0, 0, _w, _h);

          _context.drawImage(newImg, 0, 0, _w, _h);

          link.setIcon(_canvas);
        };

        newImg.setAttribute('src', imageElement.getAttribute('src'));
        newImg.height = h / ratio;
        newImg.width = w / ratio;
      } catch (e) {
        throw new Error('Error setting image. Message: ' + e.message);
      }
    };

    if (_ready) {
      _readyCb();
    }
  };
  /**
   * Set video as icon
   */


  var video = function (videoElement) {
    _readyCb = function () {
      try {
        if (videoElement === 'stop') {
          _stop = true;
          icon.reset();
          _stop = false;
          return;
        } //var w = videoElement.width;
        //var h = videoElement.height;
        //var ratio = (w / _w < h / _h) ? (w / _w) : (h / _h);


        videoElement.addEventListener('play', function () {
          drawVideo(this);
        }, false);
      } catch (e) {
        throw new Error('Error setting video. Message: ' + e.message);
      }
    };

    if (_ready) {
      _readyCb();
    }
  };
  /**
   * Set video as icon
   */


  var webcam = function (action) {
    //UR
    if (!window.URL || !window.URL.createObjectURL) {
      window.URL = window.URL || {};

      window.URL.createObjectURL = function (obj) {
        return obj;
      };
    }

    if (_browser.supported) {
      var newVideo = false;
      navigator.getUserMedia = navigator.getUserMedia || navigator.oGetUserMedia || navigator.msGetUserMedia || navigator.mozGetUserMedia || navigator.webkitGetUserMedia;

      _readyCb = function () {
        try {
          if (action === 'stop') {
            _stop = true;
            icon.reset();
            _stop = false;
            return;
          }

          newVideo = document.createElement('video');
          newVideo.width = _w;
          newVideo.height = _h;
          navigator.getUserMedia({
            video: true,
            audio: false
          }, function (stream) {
            newVideo.src = URL.createObjectURL(stream);
            newVideo.play();
            drawVideo(newVideo);
          }, function () {});
        } catch (e) {
          throw new Error('Error setting webcam. Message: ' + e.message);
        }
      };

      if (_ready) {
        _readyCb();
      }
    }
  };
  /**
   * Draw video to context and repeat :)
   */


  function drawVideo(video) {
    if (video.paused || video.ended || _stop) {
      return false;
    } //nasty hack for FF webcam (Thanks to Julian Ćwirko, kontakt@redsunmedia.pl)


    try {
      _context.clearRect(0, 0, _w, _h);

      _context.drawImage(video, 0, 0, _w, _h);
    } catch (e) {}

    _drawTimeout = setTimeout(function () {
      drawVideo(video);
    }, animation.duration);
    link.setIcon(_canvas);
  }

  var link = {};
  /**
   * Get icons from HEAD tag or create a new <link> element
   */

  link.getIcons = function () {
    var elms = []; //get link element

    var getLinks = function () {
      var icons = [];

      var links = _doc.getElementsByTagName('head')[0].getElementsByTagName('link');

      for (var i = 0; i < links.length; i++) {
        if (/(^|\s)icon(\s|$)/i.test(links[i].getAttribute('rel'))) {
          icons.push(links[i]);
        }
      }

      return icons;
    };

    if (_opt.element) {
      elms = [_opt.element];
    } else if (_opt.elementId) {
      //if img element identified by elementId
      elms = [_doc.getElementById(_opt.elementId)];
      elms[0].setAttribute('href', elms[0].getAttribute('src'));
    } else {
      //if link element
      elms = getLinks();

      if (elms.length === 0) {
        elms = [_doc.createElement('link')];
        elms[0].setAttribute('rel', 'icon');

        _doc.getElementsByTagName('head')[0].appendChild(elms[0]);
      }
    }

    elms.forEach(function (item) {
      item.setAttribute('type', 'image/png');
    });
    return elms;
  };

  link.setIcon = function (canvas) {
    var url = canvas.toDataURL('image/png');

    if (_opt.dataUrl) {
      //if using custom exporter
      _opt.dataUrl(url);
    }

    if (_opt.element) {
      _opt.element.setAttribute('href', url);

      _opt.element.setAttribute('src', url);
    } else if (_opt.elementId) {
      //if is attached to element (image)
      var elm = _doc.getElementById(_opt.elementId);

      elm.setAttribute('href', url);
      elm.setAttribute('src', url);
    } else {
      //if is attached to fav icon
      if (_browser.ff || _browser.opera) {
        //for FF we need to "recreate" element, atach to dom and remove old <link>
        //var originalType = _orig.getAttribute('rel');
        var old = _orig[_orig.length - 1];

        var newIcon = _doc.createElement('link');

        _orig = [newIcon]; //_orig.setAttribute('rel', originalType);

        if (_browser.opera) {
          newIcon.setAttribute('rel', 'icon');
        }

        newIcon.setAttribute('rel', 'icon');
        newIcon.setAttribute('type', 'image/png');

        _doc.getElementsByTagName('head')[0].appendChild(newIcon);

        newIcon.setAttribute('href', url);

        if (old.parentNode) {
          old.parentNode.removeChild(old);
        }
      } else {
        _orig.forEach(function (icon) {
          icon.setAttribute('href', url);
        });
      }
    }
  }; //http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb#answer-5624139
  //HEX to RGB convertor


  function hexToRgb(hex) {
    var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
    hex = hex.replace(shorthandRegex, function (m, r, g, b) {
      return r + r + g + g + b + b;
    });
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
    } : false;
  }
  /**
   * Merge options
   */


  function merge(def, opt) {
    var mergedOpt = {};
    var attrname;

    for (attrname in meteorBabelHelpers.sanitizeForInObject(def)) {
      mergedOpt[attrname] = def[attrname];
    }

    for (attrname in meteorBabelHelpers.sanitizeForInObject(opt)) {
      mergedOpt[attrname] = opt[attrname];
    }

    return mergedOpt;
  }
  /**
   * Cross-browser page visibility shim
   * http://stackoverflow.com/questions/12536562/detect-whether-a-window-is-visible
   */


  function isPageHidden() {
    return _doc.hidden || _doc.msHidden || _doc.webkitHidden || _doc.mozHidden;
  }
  /**
   * @namespace animation
   */


  var animation = {};
  /**
   * Animation "frame" duration
   */

  animation.duration = 40;
  /**
   * Animation types (none,fade,pop,slide)
   */

  animation.types = {};
  animation.types.fade = [{
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.0
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.1
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.2
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.3
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.4
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.5
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.6
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.7
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.8
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 0.9
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 1.0
  }];
  animation.types.none = [{
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 1
  }];
  animation.types.pop = [{
    x: 1,
    y: 1,
    w: 0,
    h: 0,
    o: 1
  }, {
    x: 0.9,
    y: 0.9,
    w: 0.1,
    h: 0.1,
    o: 1
  }, {
    x: 0.8,
    y: 0.8,
    w: 0.2,
    h: 0.2,
    o: 1
  }, {
    x: 0.7,
    y: 0.7,
    w: 0.3,
    h: 0.3,
    o: 1
  }, {
    x: 0.6,
    y: 0.6,
    w: 0.4,
    h: 0.4,
    o: 1
  }, {
    x: 0.5,
    y: 0.5,
    w: 0.5,
    h: 0.5,
    o: 1
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 1
  }];
  animation.types.popFade = [{
    x: 0.75,
    y: 0.75,
    w: 0,
    h: 0,
    o: 0
  }, {
    x: 0.65,
    y: 0.65,
    w: 0.1,
    h: 0.1,
    o: 0.2
  }, {
    x: 0.6,
    y: 0.6,
    w: 0.2,
    h: 0.2,
    o: 0.4
  }, {
    x: 0.55,
    y: 0.55,
    w: 0.3,
    h: 0.3,
    o: 0.6
  }, {
    x: 0.50,
    y: 0.50,
    w: 0.4,
    h: 0.4,
    o: 0.8
  }, {
    x: 0.45,
    y: 0.45,
    w: 0.5,
    h: 0.5,
    o: 0.9
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 1
  }];
  animation.types.slide = [{
    x: 0.4,
    y: 1,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.9,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.9,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.8,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.7,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.6,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.5,
    w: 0.6,
    h: 0.6,
    o: 1
  }, {
    x: 0.4,
    y: 0.4,
    w: 0.6,
    h: 0.6,
    o: 1
  }];
  /**
   * Run animation
   * @param {Object} opt Animation options
   * @param {Object} cb Callabak after all steps are done
   * @param {Object} revert Reverse order? true|false
   * @param {Object} step Optional step number (frame bumber)
   */

  animation.run = function (opt, cb, revert, step) {
    var animationType = animation.types[isPageHidden() ? 'none' : _opt.animation];

    if (revert === true) {
      step = typeof step !== 'undefined' ? step : animationType.length - 1;
    } else {
      step = typeof step !== 'undefined' ? step : 0;
    }

    cb = cb ? cb : function () {};

    if (step < animationType.length && step >= 0) {
      type[_opt.type](merge(opt, animationType[step]));

      _animTimeout = setTimeout(function () {
        if (revert) {
          step = step - 1;
        } else {
          step = step + 1;
        }

        animation.run(opt, cb, revert, step);
      }, animation.duration);
      link.setIcon(_canvas);
    } else {
      cb();
      return;
    }
  }; //auto init


  init();
  return {
    badge: badge,
    video: video,
    image: image,
    webcam: webcam,
    reset: icon.reset,
    browser: {
      supported: _browser.supported
    }
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/favico/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  Favico: function () {
    return Favico;
  }
});
var Favico;
module.link("./favico", {
  Favico: function (v) {
    Favico = v;
  }
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/favico/index.js                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client/index", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"highlight-words":{"client":{"client.js":[
  "./helper"
],"helper.js":[
  "@rocket.chat/string-helpers"
],"index.js":[
  "./client"
]},"index.js":[
  "./client/index"
]},"iframe-login":{"client":{"iframe_client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/iframe-login/client/iframe_client.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 1);
var IframeLogin;
module.link("../../ui-utils", {
  IframeLogin: function (v) {
    IframeLogin = v;
  }
}, 2);
var iframeLogin = new IframeLogin();
var _Accounts = Accounts,
    _unstoreLoginToken = _Accounts._unstoreLoginToken;

Accounts._unstoreLoginToken = function () {
  iframeLogin.tryLogin();

  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  _unstoreLoginToken.apply(Accounts, args);
};

window.addEventListener('message', function (e) {
  if (!_.isObject(e.data)) {
    return;
  }

  switch (e.data.event) {
    case 'try-iframe-login':
      iframeLogin.tryLogin(function (error) {
        if (error) {
          e.source.postMessage({
            event: 'login-error',
            response: error.message
          }, e.origin);
        }
      });
      break;

    case 'login-with-token':
      iframeLogin.loginWithToken(e.data, function (error) {
        if (error) {
          e.source.postMessage({
            event: 'login-error',
            response: error.message
          }, e.origin);
        }
      });
      break;
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/iframe-login/client/index.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./iframe_client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"issuelinks":{"client":{"client.js":[],"index.js":[
  "./client"
]}},"katex":{"client":{"index.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "meteor/random",
  "katex",
  "@rocket.chat/string-helpers",
  "katex/dist/katex.min.css",
  "./style.css"
],"style.css":[]}},"logger":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/logger/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./logger");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"logger.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/logger/client/logger.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 1);
var getConfig;
module.link("../../../client/lib/utils/getConfig", {
  getConfig: function (v) {
    getConfig = v;
  }
}, 2);
Template.log = !!(getConfig('debug') || getConfig('debug-template'));

if (Template.log) {
  Template.logMatch = /.*/;

  Template.enableLogs = function (log) {
    Template.logMatch = /.*/;

    if (log === false) {
      Template.log = false;
      return false;
    }

    Template.log = true;

    if (log instanceof RegExp) {
      Template.logMatch = log;
      return log;
    }
  };

  var wrapHelpersAndEvents = function (original, prefix, color) {
    return function (dict) {
      var template = this;

      var fn1 = function (name, fn) {
        if (fn instanceof Function) {
          dict[name] = function () {
            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
              args[_key] = arguments[_key];
            }

            var result = fn.apply(this, args);

            if (Template.log === true) {
              var completeName = prefix + ":" + template.viewName.replace('Template.', '') + "." + name;

              if (Template.logMatch.test(completeName)) {
                console.log("%c" + completeName, "color: " + color, {
                  args: args,
                  scope: this,
                  result: result
                });
              }
            }

            return result;
          };

          return dict[name];
        }
      };

      _.each(name, function (fn, name) {
        fn1(name, fn);
      });

      return original.call(template, dict);
    };
  };

  Template.prototype.helpers = wrapHelpersAndEvents(Template.prototype.helpers, 'helper', 'blue');
  Template.prototype.events = wrapHelpersAndEvents(Template.prototype.events, 'event', 'green');

  var wrapLifeCycle = function (original, prefix, color) {
    return function (fn) {
      var template = this;

      if (fn instanceof Function) {
        var wrap = function () {
          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
            args[_key2] = arguments[_key2];
          }

          var result = fn.apply(this, args);

          if (Template.log === true) {
            var completeName = prefix + ":" + template.viewName.replace('Template.', '') + "." + name;

            if (Template.logMatch.test(completeName)) {
              console.log("%c" + completeName, "color: " + color + "; font-weight: bold", {
                args: args,
                scope: this,
                result: result
              });
            }
          }

          return result;
        };

        return original.call(template, wrap);
      }

      return original.call(template, fn);
    };
  };

  Template.prototype.onCreated = wrapLifeCycle(Template.prototype.onCreated, 'onCreated', 'blue');
  Template.prototype.onRendered = wrapLifeCycle(Template.prototype.onRendered, 'onRendered', 'green');
  Template.prototype.onDestroyed = wrapLifeCycle(Template.prototype.onDestroyed, 'onDestroyed', 'red');
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"mail-messages":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mail-messages/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./startup");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"startup.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/mail-messages/client/startup.js                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var hasAllPermission;
module.link("../../authorization", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  }
}, 0);
var registerAdminSidebarItem;
module.link("../../../client/views/admin", {
  registerAdminSidebarItem: function (v) {
    registerAdminSidebarItem = v;
  }
}, 1);
registerAdminSidebarItem({
  href: 'admin-mailer',
  i18nLabel: 'Mailer',
  icon: 'mail',
  permissionGranted: function () {
    return hasAllPermission('access-mailer');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"message-attachments":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-attachments/client/index.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./renderField", {
  registerFieldTemplate: "registerFieldTemplate"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"renderField.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-attachments/client/renderField.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  registerFieldTemplate: function () {
    return registerFieldTemplate;
  }
});

function registerFieldTemplate() {
  console.warn('registerFieldTemplate DEPRECATED');
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"message-mark-as-unread":{"client":{"actionButton.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-mark-as-unread/client/actionButton.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 1);
var RoomManager, MessageAction;
module.link("../../ui-utils", {
  RoomManager: function (v) {
    RoomManager = v;
  },
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 2);
var messageArgs;
module.link("../../ui-utils/client/lib/messageArgs", {
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 3);
var ChatSubscription;
module.link("../../models", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 4);
var roomTypes;
module.link("../../utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 5);
var handleError;
module.link("../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 6);
Meteor.startup(function () {
  MessageAction.addButton({
    id: 'mark-message-as-unread',
    icon: 'flag',
    label: 'Mark_unread',
    context: ['message', 'message-mobile', 'threads'],
    action: function () {
      var _messageArgs = messageArgs(this),
          message = _messageArgs.msg;

      return Meteor.call('unreadMessages', message, function (error) {
        if (error) {
          return handleError(error);
        }

        var subscription = ChatSubscription.findOne({
          rid: message.rid
        });

        if (subscription == null) {
          return;
        }

        RoomManager.close(subscription.t + subscription.name);
        return FlowRouter.go('home');
      });
    },
    condition: function (_ref) {
      var msg = _ref.msg,
          u = _ref.u,
          room = _ref.room;
      var isLivechatRoom = roomTypes.isLivechatRoom(room.t);

      if (isLivechatRoom) {
        return false;
      }

      return msg.u._id !== u._id;
    },
    order: 10,
    group: 'menu'
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/message-mark-as-unread/client/index.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./actionButton");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"meteor-accounts-saml":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-accounts-saml/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./saml_client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"saml_client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/meteor-accounts-saml/client/saml_client.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 1);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 2);
var ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration: function (v) {
    ServiceConfiguration = v;
  }
}, 3);

if (!Accounts.saml) {
  Accounts.saml = {};
} // Override the standard logout behaviour.
//
// If we find a samlProvider, and we are using single
// logout we will initiate logout from rocketchat via saml.
// If not using single logout, we just do the standard logout.
// This can be overridden by a configured logout behaviour.
//
// TODO: This may need some work as it is not clear if we are really
// logging out of the idp when doing the standard logout.


var MeteorLogout = Meteor.logout;
var logoutBehaviour = {
  TERMINATE_SAML: 'SAML',
  ONLY_RC: 'Local'
};

Meteor.logout = function () {
  var samlService = ServiceConfiguration.configurations.findOne({
    service: 'saml'
  });

  if (samlService) {
    var provider = samlService.clientConfig && samlService.clientConfig.provider;

    if (provider) {
      if (samlService.logoutBehaviour == null || samlService.logoutBehaviour === logoutBehaviour.TERMINATE_SAML) {
        if (samlService.idpSLORedirectURL) {
          console.info('SAML session terminated via SLO');
          return Meteor.logoutWithSaml({
            provider: provider
          });
        }
      }

      if (samlService.logoutBehaviour === logoutBehaviour.ONLY_RC) {
        console.info('SAML session not terminated, only the Rocket.Chat session is going to be killed');
      }
    }
  }

  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  return MeteorLogout.apply(Meteor, args);
};

Meteor.loginWithSaml = function (options
/* , callback*/
) {
  options = options || {};
  var credentialToken = "id-" + Random.id();
  options.credentialToken = credentialToken;
  window.location.href = "_saml/authorize/" + options.provider + "/" + options.credentialToken;
};

Meteor.logoutWithSaml = function (options
/* , callback*/
) {
  // Accounts.saml.idpInitiatedSLO(options, callback);
  Meteor.call('samlLogout', options.provider, function (err, result) {
    if (err || !result) {
      MeteorLogout.apply(Meteor);
      return;
    } // Remove the userId from the client to prevent calls to the server while the logout is processed.
    // If the logout fails, the userId will be reloaded on the resume call


    Meteor._localStorage.removeItem(Accounts.USER_ID_KEY); // A nasty bounce: 'result' has the SAML LogoutRequest but we need a proper 302 to redirected from the server.


    window.location.replace(Meteor.absoluteUrl("_saml/sloRedirect/" + options.provider + "/?redirect=" + encodeURIComponent(result)));
  });
};

Meteor.loginWithSamlToken = function (token, userCallback) {
  Accounts.callLoginMethod({
    methodArguments: [{
      saml: true,
      credentialToken: token
    }],
    userCallback: userCallback
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"nrr":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/nrr/client/index.js                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./nrr");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"nrr.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/nrr/client/nrr.js                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 2);
var HTML;
module.link("meteor/htmljs", {
  HTML: function (v) {
    HTML = v;
  }
}, 3);
var Spacebars;
module.link("meteor/spacebars", {
  Spacebars: function (v) {
    Spacebars = v;
  }
}, 4);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 5);

var makeCursorReactive = function (obj) {
  if (obj instanceof Meteor.Collection.Cursor) {
    return obj._depend({
      added: true,
      removed: true,
      changed: true
    });
  }
};

var toHTMLWithDataNonReactive = function (content, data) {
  makeCursorReactive(data);

  if (data instanceof Spacebars.kw && Object.keys(data.hash).length > 0) {
    Object.entries(data.hash).forEach(function (_ref) {
      var _ref2 = _slicedToArray(_ref, 2),
          value = _ref2[1];

      return makeCursorReactive(value);
    });
    return Tracker.nonreactive(function () {
      return Blaze.toHTMLWithData(content, data.hash);
    });
  }

  return Tracker.nonreactive(function () {
    return Blaze.toHTMLWithData(content, data);
  });
};

var renderNonReactive = function (templateName, data) {
  var _this$parentView$data = this.parentView.dataVar.get(),
      _arguments = _this$parentView$data._arguments;

  var _arguments2 = _slicedToArray(_arguments, 2);

  templateName = _arguments2[0];
  data = _arguments2[1];
  return Tracker.nonreactive(function () {
    console.warn('Nrr template is deprecated');
    var view = new Blaze.View('nrr', function () {
      return HTML.Raw(toHTMLWithDataNonReactive(Template[templateName], data));
    });
    view.onViewReady(function () {
      var onViewReady = Template[templateName].onViewReady;
      return onViewReady && onViewReady.call(view, data);
    });

    view._onViewRendered(function () {
      var onViewRendered = Template[templateName].onViewRendered;
      return onViewRendered && onViewRendered.call(view, data);
    });

    return view;
  });
};

Template.nrr = new Blaze.Template('nrr', renderNonReactive);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"push-notifications":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/push-notifications/client/index.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./tabBar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/push-notifications/client/tabBar.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var lazy, useMemo;
module.link("react", {
  lazy: function (v) {
    lazy = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var useUserSubscription;
module.link("../../../client/contexts/UserContext", {
  useUserSubscription: function (v) {
    useUserSubscription = v;
  }
}, 1);
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 2);
addAction('push-notifications', function (_ref) {
  var room = _ref.room;
  var subscription = useUserSubscription(room === null || room === void 0 ? void 0 : room._id);
  return useMemo(function () {
    return subscription ? {
      groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
      id: 'push-notifications',
      title: 'Notifications_Preferences',
      icon: 'bell',
      template: /*#__PURE__*/lazy(function () {
        return module.dynamicImport('../../../client/views/room/contextualBar/NotificationPreferences');
      }),
      order: 8
    } : null;
  }, [subscription]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slackbridge":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slackbridge/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./slackbridge_import.client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"slackbridge_import.client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slackbridge/client/slackbridge_import.client.js                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 0);
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 1);
settings.onload('SlackBridge_Enabled', function (key, value) {
  if (value) {
    slashCommands.add('slackbridge-import', null, {
      description: 'Import_old_messages_from_slackbridge'
    });
  } else {
    delete slashCommands.commands['slackbridge-import'];
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-archiveroom":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-archiveroom/client/client.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 0);
slashCommands.add('archive', null, {
  description: 'Archive',
  params: '#channel',
  permission: 'archive-room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-archiveroom/client/index.js                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-create":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-create/client/client.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 0);
slashCommands.add('create', null, {
  description: 'Create_A_New_Channel',
  params: '#channel',
  permission: ['create-c', 'create-p']
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-create/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-hide":{"client":{"hide.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-hide/client/hide.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 0);
slashCommands.add('hide', undefined, {
  description: 'Hide_room',
  params: '#room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-hide/client/index.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./hide");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-invite":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-invite/client/client.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 0);
slashCommands.add('invite', undefined, {
  description: 'Invite_user_to_join_channel',
  params: '@username',
  permission: 'add-user-to-joined-room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-invite/client/index.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-inviteall":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-inviteall/client/client.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 0);
slashCommands.add('invite-all-to', undefined, {
  description: 'Invite_user_to_join_channel_all_to',
  params: '#room',
  permission: ['add-user-to-joined-room', 'add-user-to-any-c-room', 'add-user-to-any-p-room']
});
slashCommands.add('invite-all-from', undefined, {
  description: 'Invite_user_to_join_channel_all_from',
  params: '#room',
  permission: 'add-user-to-joined-room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-inviteall/client/index.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-join":{"client":{"client.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-join/client/client.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var slashCommands;
module.link("../../utils/lib/slashCommand", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 0);
slashCommands.add('join', undefined, {
  description: 'Join_the_given_channel',
  params: '#channel',
  permission: 'view-c-room'
}, undefined, false, undefined, function (err, _result, params) {
  if (err.error === 'error-user-already-in-room') {
    params.cmd = 'open';
    params.msg.msg = params.msg.msg.replace('join', 'open');
    return slashCommands.run('open', params.params, params.msg, undefined);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-join/client/index.ts                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-kick":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-kick/client/client.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 0);
slashCommands.add('kick', function (command, params) {
  var username = params.trim();

  if (username === '') {
    return;
  }

  return username.replace('@', '');
}, {
  description: 'Remove_someone_from_room',
  params: '@username',
  permission: 'remove-user'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-kick/client/index.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-open":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-open/client/client.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Match;
module.link("meteor/check", {
  Match: function (v) {
    Match = v;
  }
}, 1);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 2);
var slashCommands, roomTypes;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  },
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 3);
var ChatSubscription, Subscriptions;
module.link("../../models", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 4);

function Open(command, params
/* , item*/
) {
  var dict = {
    '#': ['c', 'p'],
    '@': ['d']
  };

  if (command !== 'open' || !Match.test(params, String)) {
    return;
  }

  var room = params.trim();
  var type = dict[room[0]];
  room = room.replace(/#|@/, '');
  var query = {
    name: room
  };

  if (type) {
    query.t = {
      $in: type
    };
  }

  var subscription = ChatSubscription.findOne(query);

  if (subscription) {
    roomTypes.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);
  }

  if (type && type.indexOf('d') === -1) {
    return;
  }

  return Meteor.call('createDirectMessage', room, function (err) {
    if (err) {
      return;
    }

    var subscription = Subscriptions.findOne(query);
    roomTypes.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);
  });
}

slashCommands.add('open', Open, {
  description: 'Opens_a_channel_group_or_direct_message',
  params: 'room_name',
  clientOnly: true,
  permission: ['view-c-room', 'view-c-room', 'view-d-room', 'view-joined-room', 'create-d']
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-open/client/index.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"slashcommands-unarchiveroom":{"client":{"client.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-unarchiveroom/client/client.js                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var slashCommands;
module.link("../../utils", {
  slashCommands: function (v) {
    slashCommands = v;
  }
}, 0);
slashCommands.add('unarchive', null, {
  description: 'Unarchive',
  params: '#channel',
  permission: 'unarchive-room'
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/slashcommands-unarchiveroom/client/index.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"version-check":{"client":{"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/version-check/client/index.js                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 2);
var banners;
module.link("../../../client/lib/banners", {
  "*": function (v) {
    banners = v;
  }
}, 3);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var user = Meteor.user();

    if (user && Object.keys(user.banners || {}).length > 0) {
      var _TAPi18n;

      var firstBanner = Object.values(user.banners).filter(function (b) {
        return b.read !== true;
      }).sort(function (a, b) {
        return b.priority - a.priority;
      })[0];

      if (!firstBanner) {
        return;
      }

      firstBanner.textArguments = firstBanner.textArguments || [];
      banners.open({
        id: firstBanner.id,
        title: TAPi18n.__(firstBanner.title),
        text: (_TAPi18n = TAPi18n).__.apply(_TAPi18n, [firstBanner.text].concat(_toConsumableArray(firstBanner.textArguments))),
        modifiers: firstBanner.modifiers,
        action: function () {
          if (firstBanner.link) {
            window.open(firstBanner.link, '_system');
          }
        },
        onClose: function () {
          Meteor.call('banner/dismiss', {
            id: firstBanner.id
          });
        }
      });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"webrtc":{"client":{"WebRTCClass.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/WebRTCClass.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);

var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 2);
module.export({
  WebRTC: function () {
    return WebRTC;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 3);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 4);
var ChromeScreenShare;
module.link("./screenShare", {
  ChromeScreenShare: function (v) {
    ChromeScreenShare = v;
  }
}, 5);
var t;
module.link("../../utils", {
  t: function (v) {
    t = v;
  }
}, 6);
var Notifications;
module.link("../../notifications", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 7);
var settings;
module.link("../../settings", {
  settings: function (v) {
    settings = v;
  }
}, 8);
var modal;
module.link("../../ui-utils", {
  modal: function (v) {
    modal = v;
  }
}, 9);
var ChatSubscription;
module.link("../../models", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 10);
var WEB_RTC_EVENTS;
module.link("..", {
  WEB_RTC_EVENTS: function (v) {
    WEB_RTC_EVENTS = v;
  }
}, 11);
var goToRoomById;
module.link("../../../client/lib/utils/goToRoomById", {
  goToRoomById: function (v) {
    goToRoomById = v;
  }
}, 12);

var WebRTCTransportClass = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(WebRTCTransportClass, _Emitter);

  function WebRTCTransportClass(webrtcInstance) {
    var _this;

    _this = _Emitter.call(this) || this;
    _this.debug = false;
    _this.webrtcInstance = webrtcInstance;
    Notifications.onRoom(_this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, function (type, data) {
      _this.log('WebRTCTransportClass - onRoom', type, data);

      _this.emit(type, data);
    });
    return _this;
  }

  var _proto = WebRTCTransportClass.prototype;

  _proto.log = function () {
    function log() {
      if (this.debug === true) {
        var _console;

        (_console = console).log.apply(_console, arguments);
      }
    }

    return log;
  }();

  _proto.onUserStream = function () {
    function onUserStream(type, data) {
      if (data.room !== this.webrtcInstance.room) {
        return;
      }

      this.log('WebRTCTransportClass - onUser', type, data);
      this.emit(type, data);
    }

    return onUserStream;
  }();

  _proto.startCall = function () {
    function startCall(data) {
      this.log('WebRTCTransportClass - startCall', this.webrtcInstance.room, this.webrtcInstance.selfId);
      Notifications.notifyUsersOfRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.CALL, {
        from: this.webrtcInstance.selfId,
        room: this.webrtcInstance.room,
        media: data.media,
        monitor: data.monitor
      });
    }

    return startCall;
  }();

  _proto.joinCall = function () {
    function joinCall(data) {
      this.log('WebRTCTransportClass - joinCall', this.webrtcInstance.room, this.webrtcInstance.selfId);

      if (data.monitor === true) {
        Notifications.notifyUser(data.to, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.JOIN, {
          from: this.webrtcInstance.selfId,
          room: this.webrtcInstance.room,
          media: data.media,
          monitor: data.monitor
        });
      } else {
        Notifications.notifyUsersOfRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.JOIN, {
          from: this.webrtcInstance.selfId,
          room: this.webrtcInstance.room,
          media: data.media,
          monitor: data.monitor
        });
      }
    }

    return joinCall;
  }();

  _proto.sendCandidate = function () {
    function sendCandidate(data) {
      data.from = this.webrtcInstance.selfId;
      data.room = this.webrtcInstance.room;
      this.log('WebRTCTransportClass - sendCandidate', data);
      Notifications.notifyUser(data.to, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.CANDIDATE, data);
    }

    return sendCandidate;
  }();

  _proto.sendDescription = function () {
    function sendDescription(data) {
      data.from = this.webrtcInstance.selfId;
      data.room = this.webrtcInstance.room;
      this.log('WebRTCTransportClass - sendDescription', data);
      Notifications.notifyUser(data.to, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.DESCRIPTION, data);
    }

    return sendDescription;
  }();

  _proto.sendStatus = function () {
    function sendStatus(data) {
      this.log('WebRTCTransportClass - sendStatus', data, this.webrtcInstance.room);
      data.from = this.webrtcInstance.selfId;
      Notifications.notifyRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.STATUS, data);
    }

    return sendStatus;
  }();

  _proto.onRemoteCall = function () {
    function onRemoteCall(fn) {
      return this.on(WEB_RTC_EVENTS.CALL, fn);
    }

    return onRemoteCall;
  }();

  _proto.onRemoteJoin = function () {
    function onRemoteJoin(fn) {
      return this.on(WEB_RTC_EVENTS.JOIN, fn);
    }

    return onRemoteJoin;
  }();

  _proto.onRemoteCandidate = function () {
    function onRemoteCandidate(fn) {
      return this.on(WEB_RTC_EVENTS.CANDIDATE, fn);
    }

    return onRemoteCandidate;
  }();

  _proto.onRemoteDescription = function () {
    function onRemoteDescription(fn) {
      return this.on(WEB_RTC_EVENTS.DESCRIPTION, fn);
    }

    return onRemoteDescription;
  }();

  _proto.onRemoteStatus = function () {
    function onRemoteStatus(fn) {
      return this.on(WEB_RTC_EVENTS.STATUS, fn);
    }

    return onRemoteStatus;
  }();

  return WebRTCTransportClass;
}(Emitter);

var WebRTCClass = /*#__PURE__*/function () {
  /*
   		@param seldId {String}
   		@param room {String}
    */
  function WebRTCClass(selfId, room) {
    var _this2 = this;

    var autoAccept = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

    this.resetCallInProgress = function () {
      _this2.callInProgress.set(false);
    };

    this.stopPeerConnection = function (id) {
      var peerConnection = _this2.peerConnections[id];

      if (peerConnection == null) {
        return;
      }

      delete _this2.peerConnections[id];
      peerConnection.close();

      _this2.updateRemoteItems();
    };

    this.config = {
      iceServers: []
    };
    this.debug = false;
    this.TransportClass = WebRTCTransportClass;
    this.selfId = selfId;
    this.room = room;
    var servers = settings.get('WebRTC_Servers');

    if (servers && servers.trim() !== '') {
      servers = servers.replace(/\s/g, '');
      servers = servers.split(',');
      servers.forEach(function (server) {
        server = server.split('@');
        var serverConfig = {
          urls: server.pop()
        };

        if (server.length === 1) {
          server = server[0].split(':');
          serverConfig.username = decodeURIComponent(server[0]);
          serverConfig.credential = decodeURIComponent(server[1]);
        }

        _this2.config.iceServers.push(serverConfig);
      });
    }

    this.peerConnections = {};
    this.remoteItems = new ReactiveVar([]);
    this.remoteItemsById = new ReactiveVar({});
    this.callInProgress = new ReactiveVar(false);
    this.audioEnabled = new ReactiveVar(false);
    this.videoEnabled = new ReactiveVar(false);
    this.overlayEnabled = new ReactiveVar(false);
    this.screenShareEnabled = new ReactiveVar(false);
    this.localUrl = new ReactiveVar();
    this.active = false;
    this.remoteMonitoring = false;
    this.monitor = false;
    this.autoAccept = autoAccept;
    this.navigator = undefined;
    var userAgent = navigator.userAgent.toLocaleLowerCase();

    if (userAgent.indexOf('electron') !== -1) {
      this.navigator = 'electron';
    } else if (userAgent.indexOf('chrome') !== -1) {
      this.navigator = 'chrome';
    } else if (userAgent.indexOf('firefox') !== -1) {
      this.navigator = 'firefox';
    } else if (userAgent.indexOf('safari') !== -1) {
      this.navigator = 'safari';
    }

    this.screenShareAvailable = ['chrome', 'firefox', 'electron'].includes(this.navigator);
    this.media = {
      video: true,
      audio: true
    };
    this.transport = new this.TransportClass(this);
    this.transport.onRemoteCall(this.onRemoteCall.bind(this));
    this.transport.onRemoteJoin(this.onRemoteJoin.bind(this));
    this.transport.onRemoteCandidate(this.onRemoteCandidate.bind(this));
    this.transport.onRemoteDescription(this.onRemoteDescription.bind(this));
    this.transport.onRemoteStatus(this.onRemoteStatus.bind(this));
    Meteor.setInterval(this.checkPeerConnections.bind(this), 1000); // Meteor.setInterval(this.broadcastStatus.bind(@), 1000);
  }

  var _proto2 = WebRTCClass.prototype;

  _proto2.onUserStream = function () {
    function onUserStream() {
      var _this$transport;

      return (_this$transport = this.transport).onUserStream.apply(_this$transport, arguments);
    }

    return onUserStream;
  }();

  _proto2.log = function () {
    function log() {
      if (this.debug === true) {
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        console.log.apply(console, args);
      }
    }

    return log;
  }();

  _proto2.onError = function () {
    function onError() {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }

      console.error.apply(console, args);
    }

    return onError;
  }();

  _proto2.checkPeerConnections = function () {
    function checkPeerConnections() {
      var _this3 = this;

      var peerConnections = this.peerConnections;
      var date = Date.now();
      Object.entries(peerConnections).some(function (_ref) {
        var _ref2 = _slicedToArray(_ref, 2),
            id = _ref2[0],
            peerConnection = _ref2[1];

        if (!['connected', 'completed'].includes(peerConnection.iceConnectionState) && peerConnection.createdAt + 5000 < date) {
          _this3.stopPeerConnection(id);

          return true;
        }

        return false;
      });
    }

    return checkPeerConnections;
  }();

  _proto2.updateRemoteItems = function () {
    function updateRemoteItems() {
      var items = [];
      var itemsById = {};
      var peerConnections = this.peerConnections;
      Object.entries(peerConnections).forEach(function (_ref3) {
        var _ref4 = _slicedToArray(_ref3, 2),
            id = _ref4[0],
            peerConnection = _ref4[1];

        peerConnection.getRemoteStreams().forEach(function (remoteStream) {
          var item = {
            id: id,
            url: remoteStream,
            state: peerConnection.iceConnectionState
          };

          switch (peerConnection.iceConnectionState) {
            case 'checking':
              item.stateText = 'Connecting...';
              break;

            case 'connected':
            case 'completed':
              item.stateText = 'Connected';
              item.connected = true;
              break;

            case 'disconnected':
              item.stateText = 'Disconnected';
              break;

            case 'failed':
              item.stateText = 'Failed';
              break;

            case 'closed':
              item.stateText = 'Closed';
          }

          items.push(item);
          itemsById[id] = item;
        });
      });
      this.remoteItems.set(items);
      this.remoteItemsById.set(itemsById);
    }

    return updateRemoteItems;
  }();

  _proto2.broadcastStatus = function () {
    function broadcastStatus() {
      if (this.active !== true || this.monitor === true || this.remoteMonitoring === true) {
        return;
      }

      var remoteConnections = [];
      var peerConnections = this.peerConnections;
      Object.keys(peerConnections).entries(function (_ref5) {
        var _ref6 = _slicedToArray(_ref5, 2),
            id = _ref6[0],
            media = _ref6[1].remoteMedia;

        remoteConnections.push({
          id: id,
          media: media
        });
      });
      this.transport.sendStatus({
        media: this.media,
        remoteConnections: remoteConnections
      });
    }

    return broadcastStatus;
  }()
  /*
   		@param data {Object}
   			from {String}
   			media {Object}
   			remoteConnections {Array[Object]}
   				id {String}
   				media {Object}
    */
  ;

  _proto2.onRemoteStatus = function () {
    function onRemoteStatus(data) {
      var _this4 = this;

      // this.log(onRemoteStatus, arguments);
      this.callInProgress.set(true);
      Meteor.clearTimeout(this.callInProgressTimeout);
      this.callInProgressTimeout = Meteor.setTimeout(this.resetCallInProgress, 2000);

      if (this.active !== true) {
        return;
      }

      var remoteConnections = [{
        id: data.from,
        media: data.media
      }].concat(_toConsumableArray(data.remoteConnections));
      remoteConnections.forEach(function (remoteConnection) {
        if (remoteConnection.id !== _this4.selfId && _this4.peerConnections[remoteConnection.id] == null) {
          _this4.log('reconnecting with', remoteConnection.id);

          _this4.onRemoteJoin({
            from: remoteConnection.id,
            media: remoteConnection.media
          });
        }
      });
    }

    return onRemoteStatus;
  }()
  /*
   		@param id {String}
    */
  ;

  _proto2.getPeerConnection = function () {
    function getPeerConnection(id) {
      var _this5 = this;

      if (this.peerConnections[id] != null) {
        return this.peerConnections[id];
      }

      var peerConnection = new RTCPeerConnection(this.config);
      peerConnection.createdAt = Date.now();
      peerConnection.remoteMedia = {};
      this.peerConnections[id] = peerConnection;
      var eventNames = ['icecandidate', 'addstream', 'removestream', 'iceconnectionstatechange', 'datachannel', 'identityresult', 'idpassertionerror', 'idpvalidationerror', 'negotiationneeded', 'peeridentity', 'signalingstatechange'];
      eventNames.forEach(function (eventName) {
        peerConnection.addEventListener(eventName, function (e) {
          _this5.log(id, e.type, e);
        });
      });
      peerConnection.addEventListener('icecandidate', function (e) {
        if (e.candidate == null) {
          return;
        }

        _this5.transport.sendCandidate({
          to: id,
          candidate: {
            candidate: e.candidate.candidate,
            sdpMLineIndex: e.candidate.sdpMLineIndex,
            sdpMid: e.candidate.sdpMid
          }
        });
      });
      peerConnection.addEventListener('addstream', function () {
        _this5.updateRemoteItems();
      });
      peerConnection.addEventListener('removestream', function () {
        _this5.updateRemoteItems();
      });
      peerConnection.addEventListener('iceconnectionstatechange', function () {
        if ((peerConnection.iceConnectionState === 'disconnected' || peerConnection.iceConnectionState === 'closed') && peerConnection === _this5.peerConnections[id]) {
          _this5.stopPeerConnection(id);

          Meteor.setTimeout(function () {
            if (Object.keys(_this5.peerConnections).length === 0) {
              _this5.stop();
            }
          }, 3000);
        }

        _this5.updateRemoteItems();
      });
      return peerConnection;
    }

    return getPeerConnection;
  }();

  _proto2._getUserMedia = function () {
    function _getUserMedia(media, onSuccess, onError) {
      var _this6 = this;

      var onSuccessLocal = function (stream) {
        if (AudioContext && stream.getAudioTracks().length > 0) {
          var audioContext = new AudioContext();
          var source = audioContext.createMediaStreamSource(stream);
          var volume = audioContext.createGain();
          source.connect(volume);
          var peer = audioContext.createMediaStreamDestination();
          volume.connect(peer);
          volume.gain.value = 0.6;
          stream.removeTrack(stream.getAudioTracks()[0]);
          stream.addTrack(peer.stream.getAudioTracks()[0]);
          stream.volume = volume;
          _this6.audioContext = audioContext;
        }

        onSuccess(stream);
      };

      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        return navigator.mediaDevices.getUserMedia(media).then(onSuccessLocal).catch(onError);
      }

      navigator.getUserMedia(media, onSuccessLocal, onError);
    }

    return _getUserMedia;
  }();

  _proto2.getUserMedia = function () {
    function getUserMedia(media, onSuccess) {
      var _this7 = this;

      var onError = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.onError;

      if (media.desktop !== true) {
        this._getUserMedia(media, onSuccess, onError);

        return;
      }

      if (this.screenShareAvailable !== true) {
        console.log('Screen share is not avaliable');
        return;
      }

      var getScreen = function (audioStream) {
        var refresh = function () {
          modal.open({
            type: 'warning',
            title: TAPi18n.__('Refresh_your_page_after_install_to_enable_screen_sharing')
          });
        };

        var isChromeExtensionInstalled = _this7.navigator === 'chrome' && ChromeScreenShare.installed;
        var isFirefoxExtensionInstalled = _this7.navigator === 'firefox' && window.rocketchatscreenshare != null;

        if (!isChromeExtensionInstalled && !isFirefoxExtensionInstalled) {
          modal.open({
            type: 'warning',
            title: TAPi18n.__('Screen_Share'),
            text: TAPi18n.__('You_need_install_an_extension_to_allow_screen_sharing'),
            html: true,
            showCancelButton: true,
            confirmButtonText: TAPi18n.__('Install_Extension'),
            cancelButtonText: TAPi18n.__('Cancel')
          }, function (isConfirm) {
            if (isConfirm) {
              if (_this7.navigator === 'chrome') {
                var url = 'https://chrome.google.com/webstore/detail/rocketchat-screen-share/nocfbnnmjnndkbipkabodnheejiegccf';

                try {
                  chrome.webstore.install(url, refresh, function () {
                    window.open(url);
                    refresh();
                  });
                } catch (_error) {
                  console.log(_error);
                  window.open(url);
                  refresh();
                }
              } else if (_this7.navigator === 'firefox') {
                window.open('https://addons.mozilla.org/en-GB/firefox/addon/rocketchat-screen-share/');
                refresh();
              }
            }
          });
          return onError(false);
        }

        var getScreenSuccess = function (stream) {
          if (audioStream != null) {
            stream.addTrack(audioStream.getAudioTracks()[0]);
          }

          onSuccess(stream);
        };

        if (_this7.navigator === 'firefox') {
          media = {
            audio: media.audio,
            video: {
              mozMediaSource: 'window',
              mediaSource: 'window'
            }
          };

          _this7._getUserMedia(media, getScreenSuccess, onError);
        } else {
          ChromeScreenShare.getSourceId(_this7.navigator, function (id) {
            media = {
              audio: false,
              video: {
                mandatory: {
                  chromeMediaSource: 'desktop',
                  chromeMediaSourceId: id,
                  maxWidth: 1280,
                  maxHeight: 720
                }
              }
            };

            _this7._getUserMedia(media, getScreenSuccess, onError);
          });
        }
      };

      if (this.navigator === 'firefox' || media.audio == null || media.audio === false) {
        getScreen();
      } else {
        var getAudioSuccess = function (audioStream) {
          getScreen(audioStream);
        };

        var getAudioError = function () {
          getScreen();
        };

        this._getUserMedia({
          audio: media.audio
        }, getAudioSuccess, getAudioError);
      }
    }

    return getUserMedia;
  }()
  /*
   		@param callback {Function}
    */
  ;

  _proto2.getLocalUserMedia = function () {
    function getLocalUserMedia(callback) {
      var _this8 = this;

      for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
        args[_key3 - 1] = arguments[_key3];
      }

      this.log('getLocalUserMedia', [callback].concat(args));

      if (this.localStream != null) {
        return callback(null, this.localStream);
      }

      var onSuccess = function (stream) {
        _this8.localStream = stream;
        !_this8.audioEnabled.get() && _this8.disableAudio();
        !_this8.videoEnabled.get() && _this8.disableVideo();

        _this8.localUrl.set(stream);

        var peerConnections = _this8.peerConnections;
        Object.entries(peerConnections).forEach(function (_ref7) {
          var _ref8 = _slicedToArray(_ref7, 2),
              peerConnection = _ref8[1];

          return peerConnection.addStream(stream);
        });
        document.querySelector('video#localVideo').srcObject = stream;
        callback(null, _this8.localStream);
      };

      var onError = function (error) {
        callback(false);

        _this8.onError(error);
      };

      this.getUserMedia(this.media, onSuccess, onError);
    }

    return getLocalUserMedia;
  }()
  /*
   		@param id {String}
    */
  ;

  _proto2.stopAllPeerConnections = function () {
    function stopAllPeerConnections() {
      var peerConnections = this.peerConnections;
      Object.keys(peerConnections).forEach(this.stopPeerConnection);
      window.audioContext && window.audioContext.close();
    }

    return stopAllPeerConnections;
  }();

  _proto2.setAudioEnabled = function () {
    function setAudioEnabled() {
      var enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      if (this.localStream != null) {
        this.localStream.getAudioTracks().forEach(function (audio) {
          audio.enabled = enabled;
        });
        this.audioEnabled.set(enabled);
      }
    }

    return setAudioEnabled;
  }();

  _proto2.disableAudio = function () {
    function disableAudio() {
      this.setAudioEnabled(false);
    }

    return disableAudio;
  }();

  _proto2.enableAudio = function () {
    function enableAudio() {
      this.setAudioEnabled(true);
    }

    return enableAudio;
  }();

  _proto2.toggleAudio = function () {
    function toggleAudio() {
      if (this.audioEnabled.get()) {
        return this.disableAudio();
      }

      return this.enableAudio();
    }

    return toggleAudio;
  }();

  _proto2.setVideoEnabled = function () {
    function setVideoEnabled() {
      var enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      if (this.localStream != null) {
        this.localStream.getVideoTracks().forEach(function (video) {
          video.enabled = enabled;
        });
        this.videoEnabled.set(enabled);
      }
    }

    return setVideoEnabled;
  }();

  _proto2.disableScreenShare = function () {
    function disableScreenShare() {
      this.setScreenShareEnabled(false);
    }

    return disableScreenShare;
  }();

  _proto2.enableScreenShare = function () {
    function enableScreenShare() {
      this.setScreenShareEnabled(true);
    }

    return enableScreenShare;
  }();

  _proto2.setScreenShareEnabled = function () {
    function setScreenShareEnabled() {
      var _this9 = this;

      var enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      if (this.localStream != null) {
        this.media.desktop = enabled;
        delete this.localStream;
        this.getLocalUserMedia(function (err) {
          if (err != null) {
            return;
          }

          _this9.screenShareEnabled.set(enabled);

          _this9.stopAllPeerConnections();

          _this9.joinCall();
        });
      }
    }

    return setScreenShareEnabled;
  }();

  _proto2.disableVideo = function () {
    function disableVideo() {
      this.setVideoEnabled(false);
    }

    return disableVideo;
  }();

  _proto2.enableVideo = function () {
    function enableVideo() {
      this.setVideoEnabled(true);
    }

    return enableVideo;
  }();

  _proto2.toggleVideo = function () {
    function toggleVideo() {
      if (this.videoEnabled.get()) {
        return this.disableVideo();
      }

      return this.enableVideo();
    }

    return toggleVideo;
  }();

  _proto2.stop = function () {
    function stop() {
      this.active = false;
      this.monitor = false;
      this.remoteMonitoring = false;

      if (this.localStream != null && typeof this.localStream !== 'undefined') {
        this.localStream.getTracks().forEach(function (track) {
          return track.stop();
        });
      }

      this.localUrl.set(undefined);
      delete this.localStream;
      this.stopAllPeerConnections();
    }

    return stop;
  }()
  /*
   		@param media {Object}
   			audio {Boolean}
   			video {Boolean}
    */
  ;

  _proto2.startCall = function () {
    function startCall() {
      var _this10 = this;

      var media = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {
        args[_key4 - 1] = arguments[_key4];
      }

      this.log('startCall', [media].concat(args));
      this.media = media;
      this.getLocalUserMedia(function () {
        _this10.active = true;

        _this10.transport.startCall({
          media: _this10.media
        });
      });
    }

    return startCall;
  }();

  _proto2.startCallAsMonitor = function () {
    function startCallAsMonitor() {
      var media = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      for (var _len5 = arguments.length, args = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {
        args[_key5 - 1] = arguments[_key5];
      }

      this.log('startCallAsMonitor', [media].concat(args));
      this.media = media;
      this.active = true;
      this.monitor = true;
      this.transport.startCall({
        media: this.media,
        monitor: true
      });
    }

    return startCallAsMonitor;
  }()
  /*
   		@param data {Object}
   			from {String}
   			monitor {Boolean}
   			media {Object}
   				audio {Boolean}
   				video {Boolean}
    */
  ;

  _proto2.onRemoteCall = function () {
    function onRemoteCall(data) {
      var _this11 = this;

      if (this.autoAccept === true) {
        Meteor.defer(function () {
          _this11.joinCall({
            to: data.from,
            monitor: data.monitor,
            media: data.media
          });
        });
        return;
      }

      var user = Meteor.users.findOne(data.from);
      var fromUsername = undefined;

      if (user && user.username) {
        fromUsername = user.username;
      }

      var subscription = ChatSubscription.findOne({
        rid: data.room
      });
      var icon;
      var title;

      if (data.monitor === true) {
        icon = 'eye';
        title = t('WebRTC_monitor_call_from_%s', fromUsername);
      } else if (subscription && subscription.t === 'd') {
        if (data.media && data.media.video) {
          icon = 'videocam';
          title = t('WebRTC_direct_video_call_from_%s', fromUsername);
        } else {
          icon = 'phone';
          title = t('WebRTC_direct_audio_call_from_%s', fromUsername);
        }
      } else if (data.media && data.media.video) {
        icon = 'videocam';
        title = t('WebRTC_group_video_call_from_%s', subscription.name);
      } else {
        icon = 'phone';
        title = t('WebRTC_group_audio_call_from_%s', subscription.name);
      }

      modal.open({
        title: "<i class='icon-" + icon + " alert-icon success-color'></i>" + title,
        text: t('Do_you_want_to_accept'),
        html: true,
        showCancelButton: true,
        confirmButtonText: t('Yes'),
        cancelButtonText: t('No')
      }, function (isConfirm) {
        if (isConfirm) {
          goToRoomById(data.room);
          return _this11.joinCall({
            to: data.from,
            monitor: data.monitor,
            media: data.media
          });
        }

        _this11.stop();
      });
    }

    return onRemoteCall;
  }()
  /*
   		@param data {Object}
   			to {String}
   			monitor {Boolean}
   			media {Object}
   				audio {Boolean}
   				video {Boolean}
   				desktop {Boolean}
    */
  ;

  _proto2.joinCall = function () {
    function joinCall() {
      var _this12 = this;

      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      data.media = this.media;

      for (var _len6 = arguments.length, args = new Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {
        args[_key6 - 1] = arguments[_key6];
      }

      this.log('joinCall', [data].concat(args));
      this.getLocalUserMedia(function () {
        _this12.remoteMonitoring = data.monitor;
        _this12.active = true;

        _this12.transport.joinCall(data);
      });
    }

    return joinCall;
  }();

  _proto2.onRemoteJoin = function () {
    function onRemoteJoin(data) {
      var _this13 = this;

      if (this.active !== true) {
        return;
      }

      for (var _len7 = arguments.length, args = new Array(_len7 > 1 ? _len7 - 1 : 0), _key7 = 1; _key7 < _len7; _key7++) {
        args[_key7 - 1] = arguments[_key7];
      }

      this.log('onRemoteJoin', [data].concat(args));
      var peerConnection = this.getPeerConnection(data.from); // needsRefresh = false
      // if peerConnection.iceConnectionState isnt 'new'
      // needsAudio = data.media.audio is true and peerConnection.remoteMedia.audio isnt true
      // needsVideo = data.media.video is true and peerConnection.remoteMedia.video isnt true
      // needsRefresh = needsAudio or needsVideo or data.media.desktop isnt peerConnection.remoteMedia.desktop
      // # if peerConnection.signalingState is "have-local-offer" or needsRefresh

      if (peerConnection.signalingState !== 'checking') {
        this.stopPeerConnection(data.from);
        peerConnection = this.getPeerConnection(data.from);
      }

      if (peerConnection.iceConnectionState !== 'new') {
        return;
      }

      peerConnection.remoteMedia = data.media;

      if (this.localStream) {
        peerConnection.addStream(this.localStream);
      }

      var onOffer = function (offer) {
        var onLocalDescription = function () {
          _this13.transport.sendDescription({
            to: data.from,
            type: 'offer',
            ts: peerConnection.createdAt,
            media: _this13.media,
            description: {
              sdp: offer.sdp,
              type: offer.type
            }
          });
        };

        peerConnection.setLocalDescription(new RTCSessionDescription(offer), onLocalDescription, _this13.onError);
      };

      if (data.monitor === true) {
        peerConnection.createOffer(onOffer, this.onError, {
          mandatory: {
            OfferToReceiveAudio: data.media.audio,
            OfferToReceiveVideo: data.media.video
          }
        });
      } else {
        peerConnection.createOffer(onOffer, this.onError);
      }
    }

    return onRemoteJoin;
  }();

  _proto2.onRemoteOffer = function () {
    function onRemoteOffer(data) {
      var _this14 = this;

      if (this.active !== true) {
        return;
      }

      for (var _len8 = arguments.length, args = new Array(_len8 > 1 ? _len8 - 1 : 0), _key8 = 1; _key8 < _len8; _key8++) {
        args[_key8 - 1] = arguments[_key8];
      }

      this.log('onRemoteOffer', [data].concat(args));
      var peerConnection = this.getPeerConnection(data.from);

      if (['have-local-offer', 'stable'].includes(peerConnection.signalingState) && peerConnection.createdAt < data.ts) {
        this.stopPeerConnection(data.from);
        peerConnection = this.getPeerConnection(data.from);
      }

      if (peerConnection.iceConnectionState !== 'new') {
        return;
      }

      peerConnection.setRemoteDescription(new RTCSessionDescription(data.description));

      try {
        if (this.localStream) {
          peerConnection.addStream(this.localStream);
        }
      } catch (error) {
        console.log(error);
      }

      var onAnswer = function (answer) {
        var onLocalDescription = function () {
          _this14.transport.sendDescription({
            to: data.from,
            type: 'answer',
            ts: peerConnection.createdAt,
            description: {
              sdp: answer.sdp,
              type: answer.type
            }
          });
        };

        peerConnection.setLocalDescription(new RTCSessionDescription(answer), onLocalDescription, _this14.onError);
      };

      peerConnection.createAnswer(onAnswer, this.onError);
    }

    return onRemoteOffer;
  }()
  /*
   		@param data {Object}
   			to {String}
   			from {String}
   			candidate {RTCIceCandidate JSON encoded}
    */
  ;

  _proto2.onRemoteCandidate = function () {
    function onRemoteCandidate(data) {
      var _this$remoteItems$get;

      if (this.active !== true) {
        return;
      }

      if (data.to !== this.selfId) {
        return;
      }

      for (var _len9 = arguments.length, args = new Array(_len9 > 1 ? _len9 - 1 : 0), _key9 = 1; _key9 < _len9; _key9++) {
        args[_key9 - 1] = arguments[_key9];
      }

      this.log('onRemoteCandidate', [data].concat(args));
      var peerConnection = this.getPeerConnection(data.from);

      if (peerConnection.iceConnectionState !== 'closed' && peerConnection.iceConnectionState !== 'failed' && peerConnection.iceConnectionState !== 'disconnected' && peerConnection.iceConnectionState !== 'completed') {
        peerConnection.addIceCandidate(new RTCIceCandidate(data.candidate));
      }

      document.querySelector('video#remoteVideo').srcObject = (_this$remoteItems$get = this.remoteItems.get()[0]) === null || _this$remoteItems$get === void 0 ? void 0 : _this$remoteItems$get.url;
    }

    return onRemoteCandidate;
  }()
  /*
   		@param data {Object}
   			to {String}
   			from {String}
   			type {String} [offer, answer]
   			description {RTCSessionDescription JSON encoded}
   			ts {Integer}
   			media {Object}
   				audio {Boolean}
   				video {Boolean}
   				desktop {Boolean}
    */
  ;

  _proto2.onRemoteDescription = function () {
    function onRemoteDescription(data) {
      if (this.active !== true) {
        return;
      }

      if (data.to !== this.selfId) {
        return;
      }

      for (var _len10 = arguments.length, args = new Array(_len10 > 1 ? _len10 - 1 : 0), _key10 = 1; _key10 < _len10; _key10++) {
        args[_key10 - 1] = arguments[_key10];
      }

      this.log('onRemoteDescription', [data].concat(args));
      var peerConnection = this.getPeerConnection(data.from);

      if (data.type === 'offer') {
        peerConnection.remoteMedia = data.media;
        this.onRemoteOffer({
          from: data.from,
          ts: data.ts,
          description: data.description
        });
      } else {
        peerConnection.setRemoteDescription(new RTCSessionDescription(data.description));
      }
    }

    return onRemoteDescription;
  }();

  return WebRTCClass;
}();

var WebRTC = new ( /*#__PURE__*/function () {
  function _class() {
    this.instancesByRoomId = {};
  }

  var _proto3 = _class.prototype;

  _proto3.getInstanceByRoomId = function () {
    function getInstanceByRoomId(rid) {
      var visitorId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      var enabled = false;

      if (!visitorId) {
        var subscription = ChatSubscription.findOne({
          rid: rid
        });

        if (!subscription) {
          return;
        }

        switch (subscription.t) {
          case 'd':
            enabled = settings.get('WebRTC_Enable_Direct');
            break;

          case 'p':
            enabled = settings.get('WebRTC_Enable_Private');
            break;

          case 'c':
            enabled = settings.get('WebRTC_Enable_Channel');
            break;

          case 'l':
            enabled = settings.get('Omnichannel_call_provider') === 'WebRTC';
        }
      } else {
        enabled = settings.get('Omnichannel_call_provider') === 'WebRTC';
      }

      enabled = enabled && settings.get('WebRTC_Enabled');

      if (enabled === false) {
        return;
      }

      if (this.instancesByRoomId[rid] == null) {
        var uid = Meteor.userId();
        var autoAccept = false;

        if (visitorId) {
          uid = visitorId;
          autoAccept = true;
        }

        this.instancesByRoomId[rid] = new WebRTCClass(uid, rid, autoAccept);
      }

      return this.instancesByRoomId[rid];
    }

    return getInstanceByRoomId;
  }();

  return _class;
}())();
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (Meteor.userId()) {
      Notifications.onUser(WEB_RTC_EVENTS.WEB_RTC, function (type, data) {
        if (data.room == null) {
          return;
        }

        var webrtc = WebRTC.getInstanceByRoomId(data.room);
        webrtc.onUserStream(type, data);
      });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"actionLink.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/actionLink.tsx                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 0);
var toastr;
module.link("toastr", {
  "default": function (v) {
    toastr = v;
  }
}, 1);
var actionLinks;
module.link("../../action-links/client", {
  actionLinks: function (v) {
    actionLinks = v;
  }
}, 2);
var APIClient;
module.link("../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 3);
var Rooms;
module.link("../../models/client", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 4);
var Notifications;
module.link("../../notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 5);
actionLinks.register('joinLivechatWebRTCCall', function (message) {
  var _Rooms$findOne = Rooms.findOne({
    _id: message.rid
  }),
      callStatus = _Rooms$findOne.callStatus,
      _id = _Rooms$findOne._id;

  if (callStatus === 'declined' || callStatus === 'ended') {
    toastr.info(TAPi18n.__('Call_Already_Ended'));
    return;
  }

  window.open("/meet/" + _id, _id);
});
actionLinks.register('endLivechatWebRTCCall', function () {
  function _callee(message) {
    var _Rooms$findOne2, callStatus, _id;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _Rooms$findOne2 = Rooms.findOne({
                _id: message.rid
              }), callStatus = _Rooms$findOne2.callStatus, _id = _Rooms$findOne2._id;

              if (!(callStatus === 'declined' || callStatus === 'ended')) {
                _context.next = 4;
                break;
              }

              toastr.info(TAPi18n.__('Call_Already_Ended'));
              return _context.abrupt("return");

            case 4:
              _context.next = 6;
              return _regeneratorRuntime.awrap(APIClient.v1.put("livechat/webrtc.call/" + message._id, {}, {
                rid: _id,
                status: 'ended'
              }));

            case 6:
              Notifications.notifyRoom(_id, 'webrtc', 'callStatus', {
                callStatus: 'ended'
              });

            case 7:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"adapter.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/adapter.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
window.RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;
window.RTCSessionDescription = window.RTCSessionDescription || window.mozRTCSessionDescription || window.webkitRTCSessionDescription;
window.RTCIceCandidate = window.RTCIceCandidate || window.mozRTCIceCandidate || window.webkitRTCIceCandidate;
window.RTCSessionDescription = window.RTCSessionDescription || window.mozRTCSessionDescription || window.webkitRTCSessionDescription;
window.AudioContext = window.AudioContext || window.mozAudioContext || window.webkitAudioContext;
navigator.getUserMedia = navigator.getUserMedia || navigator.mozGetUserMedia || navigator.webkitGetUserMedia;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/index.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./adapter");
module.link("./tabBar");
module.link("./actionLink");
module.link("./WebRTCClass", {
  "*": "*"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"screenShare.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/screenShare.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ChromeScreenShare: function () {
    return ChromeScreenShare;
  }
});
var fireGlobalEvent;
module.link("../../../client/lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 0);
var ChromeScreenShare = {
  callbacks: {},
  installed: false,
  init: function () {
    var _this = this;

    this.callbacks['get-RocketChatScreenSharingExtensionVersion'] = function (version) {
      if (version) {
        _this.installed = true;
      }
    };

    window.postMessage('get-RocketChatScreenSharingExtensionVersion', '*');
  },
  getSourceId: function (navigator, callback) {
    if (callback == null) {
      throw new Error('"callback" parameter is mandatory.');
    }

    this.callbacks.getSourceId = callback;

    if (navigator === 'electron') {
      return fireGlobalEvent('get-sourceId', '*');
    }

    return window.postMessage('get-sourceId', '*');
  }
};
ChromeScreenShare.init();
window.addEventListener('message', function (e) {
  if (e.origin !== window.location.origin) {
    return;
  }

  if (e.data === 'PermissionDeniedError') {
    if (ChromeScreenShare.callbacks.getSourceId != null) {
      return ChromeScreenShare.callbacks.getSourceId('PermissionDeniedError');
    }

    throw new Error('PermissionDeniedError');
  }

  if (e.data.version != null) {
    ChromeScreenShare.callbacks['get-RocketChatScreenSharingExtensionVersion'] && ChromeScreenShare.callbacks['get-RocketChatScreenSharingExtensionVersion'](e.data.version);
  } else if (e.data.sourceId != null) {
    return typeof ChromeScreenShare.callbacks.getSourceId === 'function' && ChromeScreenShare.callbacks.getSourceId(e.data.sourceId);
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/client/tabBar.tsx                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var useMemo, useCallback;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  },
  useCallback: function (v) {
    useCallback = v;
  }
}, 0);
var useSetting;
module.link("../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 1);
var addAction;
module.link("../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 2);
var APIClient;
module.link("../../utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 3);
addAction('webRTCVideo', function (_ref) {
  var room = _ref.room;
  var enabled = useSetting('WebRTC_Enabled') && useSetting('Omnichannel_call_provider') === 'WebRTC' && room.servedBy;
  var handleClick = useCallback(function () {
    function _callee() {
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (!(!room.callStatus || room.callStatus === 'declined' || room.callStatus === 'ended')) {
                  _context.next = 3;
                  break;
                }

                _context.next = 3;
                return _regeneratorRuntime.awrap(APIClient.v1.get('livechat/webrtc.call', {
                  rid: room._id
                }));

              case 3:
                window.open("/meet/" + room._id, room._id);

              case 4:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }(), [room._id, room.callStatus]);
  return useMemo(function () {
    return enabled ? {
      groups: ['live'],
      id: 'webRTCVideo',
      title: 'WebRTC_Call',
      icon: 'phone',
      action: handleClick,
      full: true,
      order: 4
    } : null;
  }, [enabled, handleClick]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// app/webrtc/index.js                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  WEB_RTC_EVENTS: function () {
    return WEB_RTC_EVENTS;
  }
});
var WEB_RTC_EVENTS = {
  WEB_RTC: 'webrtc',
  STATUS: 'status',
  CALL: 'call',
  JOIN: 'join',
  CANDIDATE: 'candidate',
  DESCRIPTION: 'description'
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ee":{"app":{"livechat-enterprise":{"client":{"views":{"app":{"customTemplates":{"visitorEditCustomFieldsForm.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/visitorEditCustomFieldsForm.html                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.visitorEditCustomFieldsForm.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.visitorEditCustomFieldsForm.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/template.visitorEditCustomFieldsForm.js                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("visitorEditCustomFieldsForm");
Template["visitorEditCustomFieldsForm"] = new Template("Template.visitorEditCustomFieldsForm", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("showPriorities"));
  }, function() {
    return [ "\n\t\t", HTML.DIV({
      class: "form-group"
    }, "\n\t\t\t", HTML.LABEL({
      class: "rc-input__label"
    }, "\n\t\t\t\t", HTML.DIV({
      class: "rc-input__title"
    }, Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Priority");
    })), "\n\t\t\t\t", HTML.DIV({
      class: "rc-select"
    }, "\n\t\t\t\t\t", HTML.SELECT({
      name: "priorityId",
      id: "prioritySelect",
      class: "rc-select__element customFormField"
    }, HTML.Raw('\n\t\t\t\t\t\t<option value=""></option>\n\t\t\t\t\t\t'), Blaze.Each(function() {
      return Spacebars.call(view.lookup("availablePriorities"));
    }, function() {
      return [ "\n\t\t\t\t\t\t\t", HTML.OPTION({
        class: "rc-select__option",
        value: function() {
          return Spacebars.mustache(view.lookup("_id"));
        },
        selected: function() {
          return Spacebars.mustache(view.lookup("$eq"), view.lookup("priorityId"), view.lookup("_id"));
        }
      }, Blaze.View("lookup:name", function() {
        return Spacebars.mustache(view.lookup("name"));
      })), "\n\t\t\t\t\t\t" ];
    }), "\n\t\t\t\t\t"), "\n\t\t\t\t\t", Blaze._TemplateWith(function() {
      return {
        block: Spacebars.call("rc-select__arrow"),
        icon: Spacebars.call("arrow-down")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("icon"));
    }), "\n\t\t\t\t"), "\n\t\t\t"), "\n\t\t"), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"visitorInfoCustomForm.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/visitorInfoCustomForm.html                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.visitorInfoCustomForm.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.visitorInfoCustomForm.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/template.visitorInfoCustomForm.js                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("visitorInfoCustomForm");
Template["visitorInfoCustomForm"] = new Template("Template.visitorInfoCustomForm", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("priority"));
  }, function() {
    return HTML.LI(HTML.STRONG(Blaze.View("lookup:_", function() {
      return Spacebars.mustache(view.lookup("_"), "Priority");
    })), ": ", Blaze.View("lookup:priority.name", function() {
      return Spacebars.mustache(Spacebars.dot(view.lookup("priority"), "name"));
    }), " ");
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"visitorEditCustomFieldsForm.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/visitorEditCustomFieldsForm.js                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var APIClient;
module.link("../../../../../../../app/utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 2);
module.link("./visitorEditCustomFieldsForm.html");
Template.visitorEditCustomFieldsForm.helpers({
  availablePriorities: function () {
    return Template.instance().priorities.get();
  },
  priorityId: function () {
    return Template.instance().roomPriority.get();
  },
  showPriorities: function () {
    return Template.instance().priorities.get().length > 0;
  }
});
Template.visitorEditCustomFieldsForm.onCreated(function () {
  function _callee() {
    var priorityId, _await$APIClient$v1$g, priorities;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              this.priorities = new ReactiveVar([]);
              this.roomPriority = new ReactiveVar(null);
              priorityId = this.data.priorityId;

              if (priorityId) {
                this.roomPriority.set(priorityId);
              }

              _context.next = 6;
              return _regeneratorRuntime.awrap(APIClient.v1.get('livechat/priorities.list'));

            case 6:
              _await$APIClient$v1$g = _context.sent;
              priorities = _await$APIClient$v1$g.priorities;
              this.priorities.set(priorities);

            case 9:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, this, null, Promise);
  }

  return _callee;
}());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"visitorInfoCustomForm.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/customTemplates/visitorInfoCustomForm.js                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
var APIClient;
module.link("../../../../../../../app/utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 2);
module.link("./visitorInfoCustomForm.html");
Template.visitorInfoCustomForm.helpers({
  priority: function () {
    return Template.instance().priority.get();
  }
});
Template.visitorInfoCustomForm.onCreated(function () {
  var _this = this;

  this.priority = new ReactiveVar(null);
  this.autorun(function () {
    function _callee() {
      var _this$data$get, _this$data$get$priori, priorityId, priority;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                // To make this template reactive we expect a ReactiveVar through the data property,
                // because the parent form may not be rerender, only the dynamic template data
                _this$data$get = _this.data.get(), _this$data$get$priori = _this$data$get.priorityId, priorityId = _this$data$get$priori === void 0 ? null : _this$data$get$priori;

                if (!priorityId) {
                  _context.next = 5;
                  break;
                }

                _context.next = 4;
                return _regeneratorRuntime.awrap(APIClient.v1.get("livechat/priorities.getOne?priorityId=" + priorityId));

              case 4:
                priority = _context.sent;

              case 5:
                _this.priority.set(priority);

              case 6:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }());
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"registerCustomTemplates.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/app/registerCustomTemplates.js                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var addCustomFormTemplate;
module.link("../../../../../../app/livechat/client/views/app/customTemplates/register", {
  addCustomFormTemplate: function (v) {
    addCustomFormTemplate = v;
  }
}, 0);
module.link("./customTemplates/visitorEditCustomFieldsForm");
module.link("./customTemplates/visitorInfoCustomForm");
addCustomFormTemplate('livechatDepartmentForm', 'livechatDepartmentCustomFieldsForm');
addCustomFormTemplate('livechatVisitorEditForm', 'visitorEditCustomFieldsForm');
addCustomFormTemplate('livechatVisitorInfo', 'visitorInfoCustomForm');
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"business-hours":{"Multiple.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/business-hours/Multiple.ts                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  MultipleBusinessHoursBehavior: function () {
    return MultipleBusinessHoursBehavior;
  }
});
var LivechatBusinessHourTypes;
module.link("../../../../../../definition/ILivechatBusinessHour", {
  LivechatBusinessHourTypes: function (v) {
    LivechatBusinessHourTypes = v;
  }
}, 0);

var MultipleBusinessHoursBehavior = /*#__PURE__*/function () {
  function MultipleBusinessHoursBehavior() {}

  var _proto = MultipleBusinessHoursBehavior.prototype;

  _proto.getView = function () {
    function getView() {
      return 'livechatBusinessHours';
    }

    return getView;
  }();

  _proto.showCustomTemplate = function () {
    function showCustomTemplate(businessHourData) {
      return !businessHourData._id || businessHourData.type !== LivechatBusinessHourTypes.DEFAULT;
    }

    return showCustomTemplate;
  }();

  _proto.showTimezoneTemplate = function () {
    function showTimezoneTemplate() {
      return true;
    }

    return showTimezoneTemplate;
  }();

  _proto.showBackButton = function () {
    function showBackButton() {
      return true;
    }

    return showBackButton;
  }();

  return MultipleBusinessHoursBehavior;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"livechatSideNavItems.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/views/livechatSideNavItems.js                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var registerOmnichannelSidebarItem;
module.link("../../../../../client/views/omnichannel/sidebarItems", {
  registerOmnichannelSidebarItem: function (v) {
    registerOmnichannelSidebarItem = v;
  }
}, 0);
var hasPermission;
module.link("../../../../../app/authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 1);
registerOmnichannelSidebarItem({
  href: 'omnichannel-monitors',
  i18nLabel: 'Livechat_Monitors',
  permissionGranted: function () {
    return hasPermission('manage-livechat-monitors');
  }
});
registerOmnichannelSidebarItem({
  href: 'omnichannel/units',
  i18nLabel: 'Units',
  permissionGranted: function () {
    return hasPermission('manage-livechat-units');
  }
});
registerOmnichannelSidebarItem({
  href: 'omnichannel-canned-responses',
  i18nLabel: 'Canned_Responses',
  permissionGranted: function () {
    return hasPermission('manage-livechat-canned-responses');
  }
});
registerOmnichannelSidebarItem({
  href: 'omnichannel/tags',
  i18nLabel: 'Tags',
  permissionGranted: function () {
    return hasPermission('manage-livechat-tags');
  }
});
registerOmnichannelSidebarItem({
  href: 'omnichannel/priorities',
  i18nLabel: 'Priorities',
  permissionGranted: function () {
    return hasPermission('manage-livechat-priorities');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"components":{"modals":{"PlaceChatOnHoldModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext"
]}},"SingleBusinessHour.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/SingleBusinessHour.ts                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  EESingleBusinessHourBehaviour: function () {
    return EESingleBusinessHourBehaviour;
  }
});
var SingleBusinessHourBehavior;
module.link("../../../../app/livechat/client/views/app/business-hours/Single", {
  SingleBusinessHourBehavior: function (v) {
    SingleBusinessHourBehavior = v;
  }
}, 0);

var EESingleBusinessHourBehaviour = /*#__PURE__*/function (_SingleBusinessHourBe) {
  _inheritsLoose(EESingleBusinessHourBehaviour, _SingleBusinessHourBe);

  function EESingleBusinessHourBehaviour() {
    return _SingleBusinessHourBe.apply(this, arguments) || this;
  }

  var _proto = EESingleBusinessHourBehaviour.prototype;

  _proto.showTimezoneTemplate = function () {
    function showTimezoneTemplate() {
      return true;
    }

    return showTimezoneTemplate;
  }();

  return EESingleBusinessHourBehaviour;
}(SingleBusinessHourBehavior);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/index.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var hasLicense;
module.link("../../license/client", {
  hasLicense: function (v) {
    hasLicense = v;
  }
}, 0);
module.link("../lib/messageTypes");
module.link("./route");
module.link("./startup");
hasLicense('livechat-enterprise').then(function (enabled) {
  if (!enabled) {
    return;
  }

  require('./views/app/registerCustomTemplates');

  require('./views/livechatSideNavItems');

  require('./views/business-hours/Multiple');

  require('../lib/QuickActions/defaultActions');

  require('./messageTypes');
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageTypes.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/messageTypes.ts                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 0);
var MessageTypes;
module.link("../../../../app/ui-utils/client", {
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 1);
MessageTypes.registerType({
  id: 'livechat_transfer_history_fallback',
  system: true,
  message: 'New_chat_transfer_fallback',
  data: function (message) {
    if (!message.transferData) {
      return;
    }

    var from = message.transferData.prevDepartment;
    var to = message.transferData.department.name;
    return {
      fallback: TAPi18n.__('Livechat_transfer_failed_fallback', {
        from: from,
        to: to
      })
    };
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"route.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/route.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var AccountBox;
module.link("../../../../app/ui-utils", {
  AccountBox: function (v) {
    AccountBox = v;
  }
}, 0);
var livechatManagerRoutes, load;
module.link("../../../../app/livechat/client/route", {
  livechatManagerRoutes: function (v) {
    livechatManagerRoutes = v;
  },
  load: function (v) {
    load = v;
  }
}, 1);
AccountBox.addRoute({
  name: 'livechat-tag-edit',
  path: '/tags/:_id/edit',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Edit_Tag',
  pageTemplate: 'livechatTagForm'
}, livechatManagerRoutes);
AccountBox.addRoute({
  name: 'livechat-tag-new',
  path: '/tags/new',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'New_Tag',
  pageTemplate: 'livechatTagForm'
}, livechatManagerRoutes);
AccountBox.addRoute({
  name: 'livechat-priority-edit',
  path: '/priorities/:_id/edit',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Edit_Priority',
  pageTemplate: 'livechatPriorityForm'
}, livechatManagerRoutes);
AccountBox.addRoute({
  name: 'livechat-priority-new',
  path: '/priorities/new',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'New_Priority',
  pageTemplate: 'livechatPriorityForm'
}, livechatManagerRoutes);
AccountBox.addRoute({
  name: 'livechat-business-hour-edit',
  path: '/business-hours/:_id/:type/edit',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'Edit_Business_Hour',
  pageTemplate: 'livechatBusinessHoursForm'
}, livechatManagerRoutes, load);
AccountBox.addRoute({
  name: 'livechat-business-hour-new',
  path: '/business-hours/new',
  sideNav: 'omnichannelFlex',
  i18nPageTitle: 'New_Business_Hour',
  pageTemplate: 'livechatBusinessHoursForm'
}, livechatManagerRoutes, load);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"startup.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/client/startup.ts                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var MultipleBusinessHoursBehavior;
module.link("./views/business-hours/Multiple", {
  MultipleBusinessHoursBehavior: function (v) {
    MultipleBusinessHoursBehavior = v;
  }
}, 1);
var settings;
module.link("../../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var businessHourManager;
module.link("../../../../app/livechat/client/views/app/business-hours/BusinessHours", {
  businessHourManager: function (v) {
    businessHourManager = v;
  }
}, 3);
var EESingleBusinessHourBehaviour;
module.link("./SingleBusinessHour", {
  EESingleBusinessHourBehaviour: function (v) {
    EESingleBusinessHourBehaviour = v;
  }
}, 4);
var hasLicense;
module.link("../../license/client", {
  hasLicense: function (v) {
    hasLicense = v;
  }
}, 5);
var businessHours = {
  Multiple: new MultipleBusinessHoursBehavior(),
  Single: new EESingleBusinessHourBehaviour()
};
Meteor.startup(function () {
  settings.onload('Livechat_business_hour_type', function () {
    function _callee(_, value) {
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return _regeneratorRuntime.awrap(hasLicense('livechat-enterprise'));

              case 2:
                if (!_context.sent) {
                  _context.next = 4;
                  break;
                }

                businessHourManager.registerBusinessHourBehavior(businessHours[value]);

              case 4:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }());
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"QuickActions":{"defaultActions.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/lib/QuickActions/defaultActions.ts                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var addAction, QuickActionsEnum;
module.link("../../../../../client/views/room/lib/QuickActions", {
  addAction: function (v) {
    addAction = v;
  },
  QuickActionsEnum: function (v) {
    QuickActionsEnum = v;
  }
}, 0);
addAction(QuickActionsEnum.OnHoldChat, {
  groups: ['live'],
  id: QuickActionsEnum.OnHoldChat,
  title: 'Omnichannel_onHold_Chat',
  icon: 'pause-unfilled',
  order: 4
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"messageTypes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/livechat-enterprise/lib/messageTypes.js                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 0);
var MessageTypes;
module.link("../../../../app/ui-utils", {
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 1);
MessageTypes.registerType({
  id: 'livechat_priority_history',
  system: true,
  message: 'New_chat_priority',
  data: function (message) {
    if (!message.priorityData) {
      return;
    }

    var _message$priorityData = message.priorityData,
        username = _message$priorityData.definedBy.username,
        _message$priorityData2 = _message$priorityData.priority;
    _message$priorityData2 = _message$priorityData2 === void 0 ? {} : _message$priorityData2;
    var _message$priorityData3 = _message$priorityData2.name,
        name = _message$priorityData3 === void 0 ? null : _message$priorityData3;
    return {
      user: username,
      priority: name || TAPi18n.__('Without_priority')
    };
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"auditing":{"client":{"templates":{"audit":{"audit.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/templates/audit/audit.html                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.audit.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.audit.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/templates/audit/template.audit.js                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("audit");
Template["audit"] = new Template("Template.audit", (function() {
  var view = this;
  return Blaze.If(function() {
    return Spacebars.call(view.lookup("isLoading"));
  }, function() {
    return [ "\n\t\t", Blaze._TemplateWith(function() {
      return {
        class: Spacebars.call("loading-animation--primary")
      };
    }, function() {
      return Spacebars.include(view.lookupTemplate("loading"));
    }), "\n\t" ];
  }, function() {
    return [ "\n\t\t", Blaze.If(function() {
      return Spacebars.call(view.lookup("hasResults"));
    }, function() {
      return [ "\n\t\t\t", HTML.UL({
        "aria-live": "polite"
      }, "\n\t\t\t\t", Spacebars.With(function() {
        return Spacebars.call(view.lookup("messageContext"));
      }, function() {
        return [ "\n\t\t\t\t\t", Blaze.Each(function() {
          return {
            _sequence: Spacebars.call(view.lookup("messages")),
            _variable: "msg"
          };
        }, function() {
          return [ "\n\t\t\t\t\t\t", Blaze._TemplateWith(function() {
            return Spacebars.dataMustache(view.lookup("nrrargs"), "message", Spacebars.kw({
              shouldCollapseReplies: true,
              msg: view.lookup("msg"),
              room: view.lookup("room"),
              subscription: view.lookup("subscription"),
              settings: view.lookup("settings"),
              u: view.lookup("u")
            }));
          }, function() {
            return Spacebars.include(view.lookupTemplate("nrr"));
          }), "\n\t\t\t\t\t" ];
        }), "\n\t\t\t\t" ];
      }), "\n\t\t\t"), "\n\t\t" ];
    }, function() {
      return [ "\n\t\t\t", Blaze._TemplateWith(function() {
        return {
          class: Spacebars.call("rc-audit-empty")
        };
      }, function() {
        return Spacebars.include(view.lookupTemplate("roomSearchEmpty"));
      }), "\n\t\t" ];
    }), "\n\t" ];
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"audit.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/templates/audit/audit.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 2);
var hasAllPermission;
module.link("../../../../../../app/authorization/client", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  }
}, 3);
var messageContext;
module.link("../../../../../../app/ui-utils/client/lib/messageContext", {
  messageContext: function (v) {
    messageContext = v;
  }
}, 4);
var call;
module.link("../../utils.js", {
  call: function (v) {
    call = v;
  }
}, 5);
module.link("./audit.html");

var loadMessages = function () {
  function _callee(_ref) {
    var rid, users, startDate, _ref$endDate, endDate, msg, type, visitor, agent, messages;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              rid = _ref.rid, users = _ref.users, startDate = _ref.startDate, _ref$endDate = _ref.endDate, endDate = _ref$endDate === void 0 ? new Date() : _ref$endDate, msg = _ref.msg, type = _ref.type, visitor = _ref.visitor, agent = _ref.agent;
              this.messages = this.messages || new ReactiveVar([]);
              this.loading = this.loading || new ReactiveVar(true);
              _context.prev = 3;
              this.loading.set(true);

              if (!(type === 'l')) {
                _context.next = 11;
                break;
              }

              _context.next = 8;
              return _regeneratorRuntime.awrap(call('auditGetOmnichannelMessages', {
                rid: rid,
                users: users,
                startDate: startDate,
                endDate: endDate,
                msg: msg,
                type: type,
                visitor: visitor,
                agent: agent
              }));

            case 8:
              _context.t0 = _context.sent;
              _context.next = 14;
              break;

            case 11:
              _context.next = 13;
              return _regeneratorRuntime.awrap(call('auditGetMessages', {
                rid: rid,
                users: users,
                startDate: startDate,
                endDate: endDate,
                msg: msg,
                type: type,
                visitor: visitor,
                agent: agent
              }));

            case 13:
              _context.t0 = _context.sent;

            case 14:
              messages = _context.t0;
              this.messagesContext.set(_objectSpread(_objectSpread({}, messageContext({
                rid: rid
              })), {}, {
                messages: messages
              }));
              _context.next = 21;
              break;

            case 18:
              _context.prev = 18;
              _context.t1 = _context["catch"](3);
              this.messagesContext.set({});

            case 21:
              _context.prev = 21;
              this.loading.set(false);
              return _context.finish(21);

            case 24:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, this, [[3, 18, 21, 24]], Promise);
  }

  return _callee;
}();

Template.audit.helpers({
  isLoading: function () {
    return Template.instance().loading.get();
  },
  messageContext: function () {
    return Template.instance().messagesContext.get();
  },
  hasResults: function () {
    return Template.instance().hasResults.get();
  }
});
Template.audit.onCreated(function () {
  function _callee2() {
    var _this = this;

    var _this$data, visitor, agent, users, rid;

    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              this.messagesContext = new ReactiveVar({});
              this.loading = new ReactiveVar(false);
              this.hasResults = new ReactiveVar(false);

              if (hasAllPermission('can-audit')) {
                _context2.next = 5;
                break;
              }

              return _context2.abrupt("return", FlowRouter.go('/home'));

            case 5:
              this.autorun(function () {
                var messagesContext = _this.messagesContext.get();

                _this.hasResults.set(messagesContext && messagesContext.messages && messagesContext.messages.length > 0);
              });
              this.loadMessages = loadMessages.bind(this);
              _this$data = this.data, visitor = _this$data.visitor, agent = _this$data.agent, users = _this$data.users, rid = _this$data.rid;

              if (!(rid || users.length || agent || visitor)) {
                _context2.next = 11;
                break;
              }

              _context2.next = 11;
              return _regeneratorRuntime.awrap(this.loadMessages(this.data));

            case 11:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, this, null, Promise);
  }

  return _callee2;
}());
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/templates/index.js                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./audit/audit.js");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/index.css                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/index.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var hasLicense;
module.link("../../license/client", {
  hasLicense: function (v) {
    hasLicense = v;
  }
}, 0);
var AccountBox;
module.link("../../../../app/ui-utils/client", {
  AccountBox: function (v) {
    AccountBox = v;
  }
}, 1);
var hasAllPermission;
module.link("../../../../app/authorization/client", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  }
}, 2);
hasLicense('auditing').then(function (enabled) {
  if (!enabled) {
    return;
  }

  require('./templates');

  require('./index.css');

  AccountBox.addItem({
    href: 'audit-home',
    name: 'Message_auditing',
    icon: 'document-eye',
    condition: function () {
      return hasAllPermission('can-audit');
    }
  });
  AccountBox.addItem({
    href: 'audit-log',
    name: 'Message_auditing_log',
    icon: 'document-eye',
    condition: function () {
      return hasAllPermission('can-audit-log');
    }
  });
}).catch(function (error) {
  console.error('Error checking license.', error);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"utils.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/auditing/client/utils.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
module.export({
  convertDate: function () {
    return convertDate;
  },
  scrollTo: function () {
    return scrollTo;
  }
});
module.link("../../../../client/lib/utils/callWithErrorHandling", {
  callWithErrorHandling: "call"
}, 0);

var convertDate = function (date) {
  var _date$split = date.split('-'),
      _date$split2 = _slicedToArray(_date$split, 3),
      y = _date$split2[0],
      m = _date$split2[1],
      d = _date$split2[2];

  return new Date(y, m - 1, d);
};

var scrollTo = function () {
  function scrollTo(element, to, duration) {
    if (duration <= 0) {
      return;
    }

    var difference = to - element.scrollTop;
    var perTick = difference / duration * 10;
    setTimeout(function () {
      element.scrollTop += perTick;

      if (element.scrollTop === to) {
        return;
      }

      scrollTo(element, to, duration - 10);
    }, 10);
  }

  return scrollTo;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"canned-responses":{"client":{"views":{"popup":{"messagePopupCannedResponse.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/popup/messagePopupCannedResponse.html                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.messagePopupCannedResponse.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.messagePopupCannedResponse.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/popup/template.messagePopupCannedResponse.js                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("messagePopupCannedResponse");
Template["messagePopupCannedResponse"] = new Template("Template.messagePopupCannedResponse", (function() {
  var view = this;
  return HTML.DIV({
    class: "popup-canned-response"
  }, "\n\t\t", HTML.DIV({
    class: "popup-canned-response-format"
  }, HTML.STRONG("!", Blaze.View("lookup:shortcut", function() {
    return Spacebars.mustache(view.lookup("shortcut"));
  }))), "\n\t\t", HTML.DIV({
    class: "popup-canned-response-description"
  }, Blaze.View("lookup:text", function() {
    return Spacebars.mustache(view.lookup("text"));
  })), "\n\t");
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"addMessagePopupCannedResponse.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/popup/addMessagePopupCannedResponse.js                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var CannedResponse;
module.link("../../collections/CannedResponse", {
  CannedResponse: function (v) {
    CannedResponse = v;
  }
}, 2);
var addMessagePopup, removeMessagePopup;
module.link("../../../../../../app/ui-message/client/popup/customMessagePopups", {
  addMessagePopup: function (v) {
    addMessagePopup = v;
  },
  removeMessagePopup: function (v) {
    removeMessagePopup = v;
  }
}, 3);
var t;
module.link("../../../../../../app/utils", {
  t: function (v) {
    t = v;
  }
}, 4);
var settings;
module.link("../../../../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 5);
Tracker.autorun(function () {
  var templateFunc = function (template) {
    return {
      title: t('Canned_Responses'),
      collection: CannedResponse,
      trigger: '!',
      prefix: '',
      suffix: ' ',
      triggerAnywhere: true,
      template: 'messagePopupCannedResponse',
      rid: template.data.rid,
      getInput: template.data.getInput,
      textFilterDelay: 500,
      getFilter: function (collection, filter) {
        var exp = new RegExp(filter, 'i');
        var records = collection.find({
          shortcut: exp
        }, {
          reactive: 1,
          limit: 12,
          sort: {
            shortcut: -1
          }
        }).fetch();
        return records;
      },
      getValue: function (_id, collection, records) {
        var record = _.findWhere(records, {
          _id: _id
        });

        return record && record.text;
      }
    };
  };

  var settingValue = settings.get('Canned_Responses_Enable');

  if (settingValue) {
    addMessagePopup(templateFunc, 'cannedResponses');
  } else {
    removeMessagePopup('cannedResponses');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"tabbar":{"cannedResponses.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/cannedResponses.html                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.cannedResponses.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.cannedResponses.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/template.cannedResponses.js                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("cannedResponses");
Template["cannedResponses"] = new Template("Template.cannedResponses", (function() {
  var view = this;
  return Blaze._TemplateWith(function() {
    return "view-canned-responses";
  }, function() {
    return Spacebars.include(view.lookupTemplate("requiresPermission"), function() {
      return [ "\n\t\t", Blaze.If(function() {
        return Spacebars.call(view.lookup("isDetailScreen"));
      }, function() {
        return [ "\n\t\t\t", Spacebars.With(function() {
          return Spacebars.call(view.lookup("cannedResponse"));
        }, function() {
          return [ "\n\t\t\t\t", HTML.UL({
            class: "canned-response-list"
          }, "\n\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("isExistingResponse"));
          }, function() {
            return [ "\n\t\t\t\t\t\t", HTML.LI("\n\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-form-wrapper"
            }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-creator-data"
            }, HTML.Raw('\n\t\t\t\t\t\t\t\t\t<div class="canned-response-label">Created by</div>\n\t\t\t\t\t\t\t\t\t'), HTML.DIV({
              class: "canned-response-created-by canned-response-info"
            }, Blaze.View("lookup:createdByString", function() {
              return Spacebars.mustache(view.lookup("createdByString"));
            })), "\n\t\t\t\t\t\t\t\t"), "\n\n\t\t\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(view.lookup("canDeleteResponse"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
                class: "canned-response-delete-button"
              }, "\n\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
                return {
                  block: Spacebars.call("rc-header__icon"),
                  icon: Spacebars.call("trash")
                };
              }, function() {
                return Spacebars.include(view.lookupTemplate("icon"));
              }), "\n\t\t\t\t\t\t\t\t\t\t", HTML.A({
                href: "#",
                class: "delete-canned-response",
                "data-id": function() {
                  return Spacebars.mustache(view.lookup("_id"));
                }
              }, Blaze.View("lookup:_", function() {
                return Spacebars.mustache(view.lookup("_"), "Delete");
              })), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
          }), "\n\n\t\t\t\t\t", HTML.LI("\n\t\t\t\t\t\t", HTML.DIV({
            class: "canned-response-form-wrapper"
          }, "\n\t\t\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("canModifyResponse"));
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", HTML.FIELDSET("\n\t\t\t\t\t\t\t\t\t", HTML.INPUT({
              type: "hidden",
              name: "id",
              value: function() {
                return Spacebars.mustache(view.lookup("_id"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input"
            }, "\n\t\t\t\t\t\t\t\t\t\t", HTML.LABEL({
              class: "rc-input__label"
            }, "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input__title"
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Shortcut");
            })), "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input__wrapper"
            }, HTML.Raw('\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="rc-input__icon canned-response-shortcut-prefix">!</div>\n\t\t\t\t\t\t\t\t\t\t\t\t'), HTML.INPUT({
              class: "rc-input__element",
              type: "text",
              name: "shortcut",
              autocomplete: "off",
              value: function() {
                return Spacebars.mustache(view.lookup("shortcut"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input"
            }, "\n\t\t\t\t\t\t\t\t\t\t", HTML.LABEL({
              class: "rc-input__label"
            }, "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input__title"
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Text");
            })), "\n\t\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-input__wrapper"
            }, "\n\t\t\t\t\t\t\t\t\t\t\t\t", HTML.TEXTAREA({
              class: "rc-input__element",
              name: "text",
              rows: "8",
              style: "height: auto",
              value: function() {
                return Spacebars.mustache(view.lookup("text"));
              }
            }), "\n\t\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t"), "\n\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "rc-button__group"
            }, "\n\t\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
              class: "rc-button rc-button--primary save-canned-response-btn"
            }, HTML.SPAN(Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Save");
            }))), "\n\t\t\t\t\t\t\t\t\t\t", HTML.BUTTON({
              class: "rc-button rc-button--secondary cancel-canned-response-btn"
            }, HTML.SPAN(Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Cancel");
            }))), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }, function() {
            return [ "\n\t\t\t\t\t\t\t\t", HTML.DIV("\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-shortcut-preview"
            }, "! ", Blaze.View("lookup:shortcut", function() {
              return Spacebars.mustache(view.lookup("shortcut"));
            })), "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-text-preview"
            }, Blaze.View("lookup:text", function() {
              return Spacebars.mustache(view.lookup("text"));
            })), "\n\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t" ];
          }), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
        }), "\n\n\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("isUserContext"));
        }, function() {
          return [ "\n\t\t\t\t", HTML.DIV({
            class: "rc-button__group canned-response-buttons"
          }, "\n\t\t\t\t\t", Blaze.If(function() {
            return Spacebars.call(view.lookup("isExistingResponse"));
          }, function() {
            return [ "\n\t\t\t\t\t\t", HTML.A({
              href: "#",
              class: "rc-button rc-button--primary use-canned-response-btn"
            }, Blaze.View("lookup:_", function() {
              return Spacebars.mustache(view.lookup("_"), "Use_this_response");
            })), "\n\t\t\t\t\t\t", Blaze.If(function() {
              return Spacebars.call(view.lookup("isPreviewMode"));
            }, function() {
              return [ "\n\t\t\t\t\t\t\t", HTML.BUTTON({
                class: "rc-button rc-button--secondary cancel-canned-response-btn"
              }, HTML.SPAN(Blaze.View("lookup:_", function() {
                return Spacebars.mustache(view.lookup("_"), "Cancel");
              }))), "\n\t\t\t\t\t\t" ];
            }), "\n\t\t\t\t\t" ];
          }), "\n\t\t\t\t"), "\n\t\t\t" ];
        }), "\n\t\t" ];
      }, function() {
        return [ "\n\n\t\t\t", Blaze.If(function() {
          return Spacebars.call(view.lookup("hasNoCannedResponses"));
        }, function() {
          return [ "\n\t\t\t\t", HTML.H2({
            class: "thread-empty"
          }, Blaze.View("lookup:_", function() {
            return Spacebars.mustache(view.lookup("_"), "No_Canned_Responses");
          })), "\n\t\t\t" ];
        }, function() {
          return [ "\n\t\t\t\t", HTML.DIV({
            class: "canned-response-list-wrapper"
          }, "\n\t\t\t\t\t", HTML.UL({
            class: "canned-response-list"
          }, "\n\n\t\t\t\t\t\t", HTML.LI({
            class: "canned-response-search-item"
          }, "\n\t\t\t\t\t\t\t", HTML.DIV({
            class: "canned-response-wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__wrapper"
          }, "\n\t\t\t\t\t\t\t\t\t\t", HTML.DIV({
            class: "rc-input__icon"
          }, "\n\t\t\t\t\t\t\t\t\t\t\t", Blaze._TemplateWith(function() {
            return {
              block: Spacebars.call("rc-input__icon-svg"),
              icon: Spacebars.call("magnifier")
            };
          }, function() {
            return Spacebars.include(view.lookupTemplate("icon"));
          }), "\n\t\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t\t\t\t", HTML.INPUT({
            type: "text",
            class: "rc-input__element js-search",
            name: "response-search",
            id: "response-search",
            placeholder: function() {
              return Spacebars.mustache(view.lookup("_"), "Search");
            },
            autocomplete: "off",
            value: function() {
              return Spacebars.mustache(view.lookup("searchText"));
            }
          }), "\n\t\t\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\n\t\t\t\t\t", Blaze.Each(function() {
            return Spacebars.call(view.lookup("cannedResponses"));
          }, function() {
            return [ "\n\t\t\t\t\t\t", HTML.LI({
              "data-id": function() {
                return Spacebars.mustache(view.lookup("_id"));
              },
              class: "canned-response"
            }, "\n\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-wrapper"
            }, "\n\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-shortcut"
            }, Blaze.View("lookup:shortcut", function() {
              return Spacebars.mustache(view.lookup("shortcut"));
            })), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-text"
            }, Blaze.View("lookup:text", function() {
              return Spacebars.mustache(view.lookup("text"));
            })), "\n\t\t\t\t\t\t\t\t", HTML.DIV({
              class: "canned-response-scope"
            }, Blaze.View("lookup:scope", function() {
              return Spacebars.mustache(view.lookup("scope"));
            })), "\n\t\t\t\t\t\t\t"), "\n\t\t\t\t\t\t"), "\n\t\t\t\t\t" ];
          }), "\n\n\t\t\t\t\t"), "\n\t\t\t\t"), "\n\t\t\t" ];
        }), "\n\n\t\t\t", HTML.DIV({
          class: "rc-button__group canned-response-buttons"
        }, "\n\t\t\t\t", HTML.A({
          href: "#",
          class: "rc-button rc-button--primary new-canned-response-btn"
        }, Blaze.View("lookup:_", function() {
          return Spacebars.mustache(view.lookup("_"), "New_Canned_Response");
        })), "\n\t\t\t"), "\n\t\t" ];
      }), "\n\n\t" ];
    });
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"departmentCannedResponses.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/departmentCannedResponses.html                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.departmentCannedResponses.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.departmentCannedResponses.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/template.departmentCannedResponses.js                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.__checkName("departmentCannedResponses");
Template["departmentCannedResponses"] = new Template("Template.departmentCannedResponses", (function() {
  var view = this;
  return Blaze._TemplateWith(function() {
    return {
      context: Spacebars.call("department"),
      departmentId: Spacebars.call(view.lookup("departmentId"))
    };
  }, function() {
    return Spacebars.include(view.lookupTemplate("cannedResponses"));
  });
}));

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"cannedResponses.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/cannedResponses.js                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 2);
var CannedResponse;
module.link("../../collections/CannedResponse", {
  CannedResponse: function (v) {
    CannedResponse = v;
  }
}, 3);
var t;
module.link("../../../../../../app/utils", {
  t: function (v) {
    t = v;
  }
}, 4);
var chatMessages;
module.link("../../../../../../app/ui/client", {
  chatMessages: function (v) {
    chatMessages = v;
  }
}, 5);
var handleError;
module.link("../../../../../../client/lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 6);
var dispatchToastMessage;
module.link("../../../../../../client/lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 7);
module.link("./cannedResponses.html");
Template.cannedResponses.helpers({
  cannedResponses: function () {
    var searchText = Template.instance().searchText.get().toLocaleLowerCase();
    var query = {};

    if (Template.instance().context.get() === 'department') {
      query = {
        scope: 'department',
        departmentId: Template.instance().departmentId
      };
    }

    if (searchText) {
      var regex = new RegExp(searchText, 'i');
      query.$or = [{
        shortcut: {
          $regex: regex
        }
      }, {
        text: {
          $regex: regex
        }
      }];
    }

    return CannedResponse.find(query);
  },
  hasNoCannedResponses: function () {
    return CannedResponse.find().count() === 0;
  },
  isDetailScreen: function () {
    return ['edit', 'new', 'view'].includes(Template.instance().action.get());
  },
  isNewResponse: function () {
    return Template.instance().action.get() === 'new';
  },
  isExistingResponse: function () {
    return ['edit', 'view'].includes(Template.instance().action.get());
  },
  isUserContext: function () {
    return Template.instance().context.get() === 'user';
  },
  searchText: function () {
    return Template.instance().searchText.get();
  },
  isDepartmentContext: function () {
    return Template.instance().context.get() === 'department';
  },
  cannedResponse: function () {
    return Template.instance().cannedResponse.get();
  },
  canDeleteResponse: function () {
    var action = Template.instance().action.get();

    if (action !== 'edit') {
      return false;
    }

    var response = Template.instance().cannedResponse.get();
    var context = Template.instance().context.get();
    return response.scope === context;
  },
  canModifyResponse: function () {
    var action = Template.instance().action.get();

    if (action === 'new') {
      return true;
    }

    var response = Template.instance().cannedResponse.get();
    var context = Template.instance().context.get();
    return response.scope === context;
  },
  createdByString: function () {
    var username = this.createdBy;
    var me = Meteor.users.findOne(Meteor.userId());

    if (me.username === username) {
      return t('Me');
    }

    return username;
  },
  isPreviewMode: function () {
    return Template.instance().action.get() === 'view';
  }
});
Template.cannedResponses.events({
  'click .new-canned-response-btn': function (e, instance) {
    e.preventDefault();
    e.stopPropagation();
    instance.cannedResponse.set({
      shortcut: '',
      text: ''
    });
    instance.action.set('new');
  },
  'click .canned-response': function (e, instance) {
    e.preventDefault();
    e.stopPropagation();
    var _id = this._id;
    var cannedResponse = CannedResponse.findOne({
      _id: _id
    });

    if (!cannedResponse) {
      dispatchToastMessage({
        type: 'success',
        message: t('Invalid Canned Response')
      });
    }

    instance.cannedResponse.set(cannedResponse);
    var canEdit = instance.context.get() === cannedResponse.scope;
    instance.action.set(canEdit ? 'edit' : 'view');
  },
  'click .delete-canned-response': function (e, instance) {
    e.preventDefault();
    e.stopPropagation();

    var _id = instance.$('input[name=id]').val();

    Meteor.call('removeCannedResponse', _id, function (error) {
      if (error) {
        return handleError(error);
      }

      dispatchToastMessage({
        type: 'success',
        message: t('Canned_Response_Removed')
      });
      instance.action.set(null);
    });
  },
  'click .cancel-canned-response-btn': function (e, instance) {
    e.preventDefault();
    e.stopPropagation();
    instance.action.set(null);
  },
  'click .use-canned-response-btn': function (e, instance) {
    e.preventDefault();
    e.stopPropagation();

    var _Template$currentData = Template.currentData(),
        rid = _Template$currentData.rid;

    if (!rid) {
      return;
    }

    var object = instance.cannedResponse.get();
    var input = chatMessages[rid].input;
    var text = object.text;

    if (document.selection) {
      input.focus();
      var sel = document.selection.createRange();
      sel.text = text;
      return;
    }

    if (input.selectionStart || input.selectionStart === 0) {
      var startPos = input.selectionStart;
      var endPos = input.selectionEnd;
      var prefix = input.value.substring(0, startPos);
      var suffix = input.value.substring(endPos, input.value.length);
      input.value = "" + prefix + text + suffix;
      input.selectionStart = startPos + text.length;
      input.selectionEnd = startPos + text.length;
      input.focus();
      instance.action.set(null);
      return;
    }

    input.value += text;
  },
  'click .save-canned-response-btn': function (e, instance) {
    e.preventDefault();
    e.stopPropagation();

    var _id = instance.$('input[name=id]').val();

    var shortcut = instance.$('input[name=shortcut]').val();
    var text = instance.$('textarea[name=text]').val();
    var responseData = {
      shortcut: shortcut,
      text: text
    };
    var context = instance.context.get();

    if (context === 'department') {
      if (!instance.departmentId) {
        dispatchToastMessage({
          type: 'error',
          message: t('Invalid_Department')
        });
        return;
      }

      responseData.scope = 'department';
      responseData.departmentId = instance.departmentId;
    } else {
      responseData.scope = 'user';
    }

    Meteor.call('saveCannedResponse', _id, responseData, function (error
    /* , result*/
    ) {
      if (error) {
        return handleError(error);
      }

      dispatchToastMessage({
        type: 'success',
        message: t('Saved')
      });
      instance.action.set(null);
    });
  },
  'keyup .js-search': function (event, instance) {
    instance.searchText.set(event.currentTarget.value || '');
  }
});
Template.cannedResponses.onCreated(function () {
  this.action = new ReactiveVar();
  this.context = new ReactiveVar();
  this.cannedResponse = new ReactiveVar();
  this.searchText = new ReactiveVar('');
  this.departmentId = null;

  if (this.data && this.data.context) {
    this.context.set(this.data.context);

    if (this.data.context === 'department') {
      this.departmentId = this.data.departmentId;
    }
  } else {
    this.context.set('user');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"departmentCannedResponses.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/tabbar/departmentCannedResponses.js                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 1);
module.link("./departmentCannedResponses.html");
Template.departmentCannedResponses.helpers({
  departmentId: function () {
    return FlowRouter.getParam('_id');
  }
});
Template.departmentCannedResponses.events({});
Template.departmentCannedResponses.onCreated(function () {});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"icons.html":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/icons.html                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./template.icons.js", { "*": "*+" });

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"template.icons.js":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/views/template.icons.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //

Template.body.addContent((function() {
  var view = this;
  return HTML.SVG({
    xmlns: "http://www.w3.org/2000/svg",
    "xmlns:xlink": "http://www.w3.org/1999/xlink",
    style: "display:none"
  }, "\n\t    ", HTML.SYMBOL({
    id: "icon-canned-response",
    viewBox: "0 0 25 23",
    "xml:space": "preserve"
  }, "\n\t        ", HTML.PATH({
    d: "M12.6889524,19.36425 C17.769052,19.381125 19.3479714,18.5475 19.8178072,18.00975 C19.7026071,17.941125 19.560301,17.866875 19.4496186,17.8095 C18.7347001,17.43375 17.055263,16.552875 17.9090992,14.723625 C17.996064,14.5155 18.1090053,14.273625 18.223076,14.028375 C18.5517352,13.3275 18.8623238,12.66375 18.8623238,12 C18.8623238,7.93875 15.5384614,4.634625 11.4533746,4.634625 C7.36828776,4.634625 4.04442532,7.93875 4.04442532,12 C4.04442532,16.267125 7.59304095,19.36425 12.4822698,19.36425 L12.6889524,19.36425 Z M20.2176194,16.363875 C20.8015259,16.669875 22.0145155,17.306625 21.4577149,18.483375 C20.4039725,20.712 16.1404385,21 12.9137056,21 L12.6810465,21 L12.4822698,20.998875 C6.64094579,20.998875 2.4,17.214375 2.4,12 C2.4,7.0365 6.46136913,3 11.4533746,3 C16.44538,3 20.5078785,7.0365 20.5078785,12 C20.5078785,13.026 20.0866075,13.926 19.7139012,14.719125 C19.6099952,14.941875 19.5072186,15.162375 19.4157362,15.3795 C19.2553595,15.726 19.2067948,15.83175 20.2176194,16.363875 Z M10.5,7.66036163 C10.5,7.20154045 10.9029437,6.8295924 11.4,6.8295924 C11.8970563,6.8295924 12.3,7.20154045 12.3,7.66036163 L12.18,11.9988232 C12.18,12.4576443 11.8970563,12.8295924 11.4,12.8295924 C10.9029437,12.8295924 10.62,12.4576443 10.62,11.9988232 L10.5,7.66036163 Z M11.4,16.08 C10.7372583,16.08 10.2,15.5427417 10.2,14.88 C10.2,14.2172583 10.7372583,13.68 11.4,13.68 C12.0627417,13.68 12.6,14.2172583 12.6,14.88 C12.6,15.5427417 12.0627417,16.08 11.4,16.08 Z",
    id: "path-1"
  }), "\n\t    "), "\n\t");
}));
Meteor.startup(Template.body.renderToDocument);

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"collections":{"CannedResponse.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/collections/CannedResponse.js                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  CannedResponse: function () {
    return CannedResponse;
  }
});
var Mongo;
module.link("meteor/mongo", {
  Mongo: function (v) {
    Mongo = v;
  }
}, 0);
var CannedResponse = new Mongo.Collection(null);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"startup":{"responses.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/startup/responses.js                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var hasPermission;
module.link("../../../../../app/authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 2);
var settings;
module.link("../../../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var APIClient;
module.link("../../../../../app/utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 4);
var CannedResponse;
module.link("../collections/CannedResponse", {
  CannedResponse: function (v) {
    CannedResponse = v;
  }
}, 5);
var cannedResponsesStreamer;
module.link("../streamer", {
  cannedResponsesStreamer: function (v) {
    cannedResponsesStreamer = v;
  }
}, 6);
var events = {
  changed: function (response) {
    delete response.type;
    CannedResponse.upsert({
      _id: response._id
    }, response);
  },
  removed: function (response) {
    return CannedResponse.remove({
      _id: response._id
    });
  }
};
Meteor.startup(function () {
  Tracker.autorun(function () {
    function _callee(c) {
      var _await$APIClient$v1$g, responses;

      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (Meteor.userId()) {
                  _context.next = 2;
                  break;
                }

                return _context.abrupt("return");

              case 2:
                if (settings.get('Canned_Responses_Enable')) {
                  _context.next = 4;
                  break;
                }

                return _context.abrupt("return");

              case 4:
                if (hasPermission('view-canned-responses')) {
                  _context.next = 6;
                  break;
                }

                return _context.abrupt("return");

              case 6:
                _context.prev = 6;
                cannedResponsesStreamer.on('canned-responses', function (response, options) {
                  var _ref = options || {},
                      agentsId = _ref.agentsId;

                  if (Array.isArray(agentsId) && !agentsId.includes(Meteor.userId())) {
                    return;
                  }

                  events[response.type](response);
                });
                _context.next = 10;
                return _regeneratorRuntime.awrap(APIClient.v1.get('canned-responses.get'));

              case 10:
                _await$APIClient$v1$g = _context.sent;
                responses = _await$APIClient$v1$g.responses;
                responses.forEach(function (response) {
                  return CannedResponse.insert(response);
                });
                c.stop();
                _context.next = 19;
                break;

              case 16:
                _context.prev = 16;
                _context.t0 = _context["catch"](6);
                console.log(_context.t0);

              case 19:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, [[6, 16]], Promise);
    }

    return _callee;
  }());
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"stylesheets":{"cannedResponses.css":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/stylesheets/cannedResponses.css                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
// These styles have already been applied to the document.

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/index.js                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./tabBar");
module.link("./startup/responses");
module.link("./stylesheets/cannedResponses.css");
module.link("./views/icons.html");
module.link("./views/tabbar/cannedResponses");
module.link("./views/tabbar/departmentCannedResponses");
module.link("./views/popup/addMessagePopupCannedResponse");
module.link("./views/popup/messagePopupCannedResponse.html");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"streamer.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/streamer.js                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  cannedResponsesStreamer: function () {
    return cannedResponsesStreamer;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var cannedResponsesStreamer = new Meteor.Streamer('canned-responses');
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/canned-responses/client/tabBar.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var lazy, useMemo;
module.link("react", {
  lazy: function (v) {
    lazy = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var useHasLicense;
module.link("../../../client/hooks/useHasLicense", {
  useHasLicense: function (v) {
    useHasLicense = v;
  }
}, 1);
var useSetting;
module.link("../../../../client/contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 2);
var addAction;
module.link("../../../../client/views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 3);
addAction('canned-responses', function () {
  var hasLicense = useHasLicense('canned-responses');
  var enabled = useSetting('Canned_Responses_Enable');
  return useMemo(function () {
    return hasLicense && enabled ? {
      groups: ['live'],
      id: 'canned-responses',
      title: 'Canned_Responses',
      icon: 'canned-response',
      template: /*#__PURE__*/lazy(function () {
        return module.dynamicImport('../../../client/omnichannel/components/contextualBar/CannedResponse');
      }),
      order: 0
    } : null;
  }, [hasLicense, enabled]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"authorization":{"lib":{"addRoleRestrictions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/authorization/lib/addRoleRestrictions.js                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  addRoleRestrictions: function () {
    return addRoleRestrictions;
  }
});
var AuthorizationUtils;
module.link("../../../../app/authorization/lib/AuthorizationUtils", {
  AuthorizationUtils: function (v) {
    AuthorizationUtils = v;
  }
}, 0);
var guestPermissions;
module.link("./guestPermissions", {
  guestPermissions: function (v) {
    guestPermissions = v;
  }
}, 1);

var addRoleRestrictions = function () {
  AuthorizationUtils.addRolePermissionWhiteList('guest', guestPermissions);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"guestPermissions.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/authorization/lib/guestPermissions.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  guestPermissions: function () {
    return guestPermissions;
  }
});
var guestPermissions = ['view-d-room', 'view-joined-room', 'view-p-room', 'start-discussion'];
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"client":{"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/authorization/client/index.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var addRoleRestrictions;
module.link("../lib/addRoleRestrictions", {
  addRoleRestrictions: function (v) {
    addRoleRestrictions = v;
  }
}, 1);
Meteor.startup(function () {
  Meteor.call('license:isEnterprise', function (err, result) {
    if (err) {
      throw err;
    }

    if (result) {
      addRoleRestrictions();
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"ecdh":{"client":{"ClientSession.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/inheritsLoose",
  "../Session"
]},"Session.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/createClass",
  "sodium-plus"
]},"license":{"client":{"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/app/license/client/index.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  hasLicense: function () {
    return hasLicense;
  }
});
var fetchFeatures;
module.link("../../../client/lib/fetchFeatures", {
  fetchFeatures: function (v) {
    fetchFeatures = v;
  }
}, 0);
var queryClient;
module.link("../../../../client/lib/queryClient", {
  queryClient: function (v) {
    queryClient = v;
  }
}, 1);
var allModules = queryClient.fetchQuery({
  queryKey: ['ee.features'],
  queryFn: fetchFeatures
}).then(function (features) {
  return new Set(features);
}).catch(function (e) {
  console.error('Error getting modules', e);
  return Promise.reject(e);
});

function hasLicense(feature) {
  var features;
  return _regeneratorRuntime.async(function () {
    function hasLicense$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.prev = 0;
            _context.next = 3;
            return _regeneratorRuntime.awrap(allModules);

          case 3:
            features = _context.sent;
            return _context.abrupt("return", features.has(feature));

          case 7:
            _context.prev = 7;
            _context.t0 = _context["catch"](0);
            return _context.abrupt("return", false);

          case 10:
          case "end":
            return _context.stop();
        }
      }
    }

    return hasLicense$;
  }(), null, null, [[0, 7]], Promise);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}}},"client":{"lib":{"fetchFeatures.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/lib/fetchFeatures.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  fetchFeatures: function () {
    return fetchFeatures;
  }
});
var CachedCollectionManager;
module.link("../../../app/ui-cached-collection/client", {
  CachedCollectionManager: function (v) {
    CachedCollectionManager = v;
  }
}, 0);
var call;
module.link("../../../client/lib/utils/call", {
  call: function (v) {
    call = v;
  }
}, 1);

var fetchFeatures = function () {
  return new Promise(function (resolve, reject) {
    CachedCollectionManager.onLogin(function () {
      call('license:getModules').then(resolve, reject);
    });
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getFromRestApi.ts":[
  "@babel/runtime/regenerator",
  "../../../app/utils/client/lib/RestApiClient"
],"onToggledFeature.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/lib/onToggledFeature.ts                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onToggledFeature: function () {
    return onToggledFeature;
  }
});
var QueryObserver;
module.link("react-query", {
  QueryObserver: function (v) {
    QueryObserver = v;
  }
}, 0);
var queryClient;
module.link("../../../client/lib/queryClient", {
  queryClient: function (v) {
    queryClient = v;
  }
}, 1);
var fetchFeatures;
module.link("./fetchFeatures", {
  fetchFeatures: function (v) {
    fetchFeatures = v;
  }
}, 2);

var onToggledFeature = function (feature, _ref) {
  var up = _ref.up,
      down = _ref.down;
  var observer = new QueryObserver(queryClient, {
    queryKey: ['ee.features'],
    queryFn: fetchFeatures
  });
  var enabled = false;
  return observer.subscribe(function (result) {
    if (!result.isSuccess) {
      return;
    }

    var features = result.data;
    var hasFeature = features.includes(feature);

    if (!enabled && hasFeature) {
      up === null || up === void 0 ? void 0 : up();
      enabled = true;
    }

    if (enabled && !hasFeature) {
      down === null || down === void 0 ? void 0 : down();
      enabled = false;
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"omnichannel":{"components":{"CannedResponse":{"modals":{"CreateCannedResponse":{"CreateCannedResponseModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../../client/contexts/TranslationContext",
  "../../../../cannedResponses/components/cannedResponseForm"
],"PreviewText.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../../client/components/MarkdownText"
],"SharingOptions.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../../client/contexts/TranslationContext"
],"index.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/typeof",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../../../../client/contexts/AuthorizationContext",
  "../../../../../../../client/contexts/ModalContext",
  "../../../../../../../client/contexts/ServerContext",
  "../../../../../../../client/contexts/ToastMessagesContext",
  "../../../../../../../client/contexts/TranslationContext",
  "../../../../../../../client/hooks/useForm",
  "./CreateCannedResponseModal"
]},"index.ts":[
  "./CreateCannedResponse"
]},"MarkdownTextEditor":{"InsertPlaceholderDropdown.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext"
],"index.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../app/emoji/client",
  "../../../../../../client/components/Backdrop",
  "../../../../../../client/contexts/UserContext",
  "../TextEditor",
  "./InsertPlaceholderDropdown"
]},"TextEditor":{"IconButton.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"TextButton.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext"
],"Textarea.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Toolbox.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./IconButton",
  "./TextButton"
],"index.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./Textarea",
  "./Toolbox"
]}},"contextualBar":{"CannedResponse":{"CannedResponse.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/components/VerticalBar",
  "../../../../../../client/contexts/TranslationContext",
  "../../../hooks/useScopeDict"
],"CannedResponseList.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../../../client/components/ScrollableContentWrapper",
  "../../../../../../client/components/VerticalBar",
  "../../../../../../client/contexts/TranslationContext",
  "../../../../../../client/views/room/providers/ToolboxProvider",
  "./Item",
  "./WrapCannedResponse"
],"Item.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "../../../hooks/useScopeDict"
],"WrapCannedResponse.tsx":[
  "react",
  "../../../../../../client/contexts/AuthorizationContext",
  "../../../../../../client/contexts/ModalContext",
  "../../CannedResponse/modals",
  "./CannedResponse"
],"index.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/ui",
  "../../../../../../client/contexts/ModalContext",
  "../../../../../../client/contexts/RouterContext",
  "../../../../../../client/hooks/lists/useRecordList",
  "../../../../../../client/lib/asyncState",
  "../../../../../../client/views/room/contexts/RoomContext",
  "../../../hooks/useCannedResponseFilterOptions",
  "../../../hooks/useCannedResponseList",
  "../../CannedResponse/modals",
  "./CannedResponseList"
]}}},"cannedResponses":{"components":{"cannedResponseForm.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../client/components/AutoCompleteDepartment",
  "../../../../../client/components/Omnichannel/Tags",
  "../../../../../client/contexts/TranslationContext",
  "../../components/CannedResponse/MarkdownTextEditor",
  "../../components/CannedResponse/modals/CreateCannedResponse/PreviewText",
  "../../components/CannedResponse/modals/CreateCannedResponse/SharingOptions"
]},"CannedResponseEdit.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/typeof",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/Page",
  "../../../../client/contexts/AuthorizationContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useForm",
  "./components/cannedResponseForm"
],"CannedResponseEditWithData.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./CannedResponseEdit",
  "./CannedResponseEditWithDepartmentData"
],"CannedResponseEditWithDepartmentData.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./CannedResponseEdit"
],"CannedResponseFilter.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/AutoCompleteAgent",
  "../../../../client/contexts/TranslationContext"
],"CannedResponseNew.tsx":[
  "react",
  "./CannedResponseEdit"
],"CannedResponsesPage.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericTable",
  "../../../../client/components/GenericTable/NoResults",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext"
],"CannedResponsesRoute.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericTable",
  "../../../../client/components/NotAuthorizedPage",
  "../../../../client/components/PageSkeleton",
  "../../../../client/components/avatar/UserAvatar",
  "../../../../client/contexts/AuthorizationContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useEndpointData",
  "../../../../client/hooks/useForm",
  "../../../../client/hooks/useFormatDateAndTime",
  "../../../../client/lib/asyncState",
  "./CannedResponseEditWithData",
  "./CannedResponseFilter",
  "./CannedResponseNew",
  "./CannedResponsesPage",
  "./RemoveCannedResponseButton"
],"RemoveCannedResponseButton.tsx":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericModal",
  "../../../../client/contexts/ModalContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext"
]},"additionalForms":{"BusinessHoursMultiple.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/AutoCompleteDepartmentMultiple",
  "../../../../client/contexts/TranslationContext"
],"BusinessHoursMultipleContainer.js":[
  "react",
  "../../../../client/hooks/useForm",
  "./BusinessHoursMultiple"
],"BusinessHoursTimeZone.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useForm",
  "../../../../client/hooks/useTimezoneNameList"
],"ContactManager.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/UserAutoComplete",
  "../../../../client/contexts/TranslationContext"
],"CustomFieldsAdditionalForm.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext"
],"CustomFieldsAdditionalFormContainer.js":[
  "react",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useForm",
  "./CustomFieldsAdditionalForm"
],"DepartmentBusinessHours.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useEndpointData"
],"DepartmentForwarding.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/Omnichannel/hooks/useDepartmentsList",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/lists/useRecordList",
  "../../../../client/hooks/useAsyncState"
],"EeNumberInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext"
],"EeTextAreaInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext"
],"EeTextInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext"
],"MaxChatsPerAgent.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext"
],"MaxChatsPerAgentContainer.js":[
  "react",
  "../../../../client/hooks/useForm",
  "./MaxChatsPerAgent"
],"MaxChatsPerAgentDisplay.js":[
  "react",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/views/room/contextualBar/UserInfo"
],"PrioritiesSelect.js":[
  "@rocket.chat/fuselage",
  "react"
],"register.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/omnichannel/additionalForms/register.js                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMemo, lazy;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  },
  lazy: function (v) {
    lazy = v;
  }
}, 0);
var registerForm;
module.link("../../../../client/views/omnichannel/additionalForms", {
  registerForm: function (v) {
    registerForm = v;
  }
}, 1);
var hasLicense;
module.link("../../../app/license/client", {
  hasLicense: function (v) {
    hasLicense = v;
  }
}, 2);
hasLicense('livechat-enterprise').then(function (enabled) {
  if (!enabled) {
    return;
  }

  registerForm({
    useCustomFieldsAdditionalForm: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./CustomFieldsAdditionalFormContainer');
        });
      }, []);
    }
  });
  registerForm({
    useMaxChatsPerAgent: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./MaxChatsPerAgentContainer');
        });
      }, []);
    }
  });
  registerForm({
    useMaxChatsPerAgentDisplay: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./MaxChatsPerAgentDisplay');
        });
      }, []);
    }
  });
  registerForm({
    useEeNumberInput: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./EeNumberInput');
        });
      }, []);
    }
  });
  registerForm({
    useEeTextAreaInput: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./EeTextAreaInput');
        });
      }, []);
    }
  });
  registerForm({
    useEeTextInput: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./EeTextInput');
        });
      }, []);
    }
  });
  registerForm({
    useBusinessHoursMultiple: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./BusinessHoursMultipleContainer');
        });
      }, []);
    }
  });
  registerForm({
    useBusinessHoursTimeZone: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./BusinessHoursTimeZone');
        });
      }, []);
    }
  });
  registerForm({
    useContactManager: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./ContactManager');
        });
      }, []);
    }
  });
  registerForm({
    useCurrentChatTags: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('../tags/CurrentChatTags');
        });
      }, []);
    }
  });
  registerForm({
    useDepartmentBusinessHours: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./DepartmentBusinessHours');
        });
      }, []);
    }
  });
  registerForm({
    useDepartmentForwarding: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./DepartmentForwarding');
        });
      }, []);
    }
  });
  registerForm({
    usePrioritiesSelect: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('./PrioritiesSelect');
        });
      }, []);
    }
  });
  registerForm({
    useSelectForwardDepartment: function () {
      return useMemo(function () {
        return /*#__PURE__*/lazy(function () {
          return module.dynamicImport('../../../../client/components/AutoCompleteDepartment');
        });
      }, []);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"hooks":{"useCannedResponseFilterOptions.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/TranslationContext"
],"useCannedResponseList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../client/contexts/ServerContext",
  "../../../../client/hooks/lists/useScrollableRecordList",
  "../../../../client/hooks/useComponentDidUpdate",
  "../../../../client/lib/lists/CannedResponseList"
],"useScopeDict.ts":[
  "../../../../client/contexts/TranslationContext"
]},"monitors":{"MonitorsPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/Page",
  "../../../../client/components/UserAutoComplete",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./MonitorsTable"
],"MonitorsPageContainer.js":[
  "react",
  "../../../../client/components/NotAuthorizedPage",
  "../../../../client/components/PageSkeleton",
  "../../hooks/useHasLicense",
  "./MonitorsPage"
],"MonitorsRow.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericModal",
  "../../../../client/contexts/ModalContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext"
],"MonitorsTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../client/components/FilterByText",
  "../../../../client/components/GenericTable",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useResizeInlineBreakpoint",
  "./MonitorsRow"
]},"priorities":{"PrioritiesPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/FilterByText",
  "../../../../client/components/GenericTable",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext"
],"PrioritiesRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericTable",
  "../../../../client/components/NotAuthorizedPage",
  "../../../../client/components/VerticalBar",
  "../../../../client/contexts/AuthorizationContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useEndpointData",
  "./PrioritiesPage",
  "./PriorityEditWithData",
  "./PriorityNew",
  "./RemovePriorityButton"
],"PriorityEdit.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/VerticalBar",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useForm"
],"PriorityEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./PriorityEdit"
],"PriorityNew.js":[
  "react",
  "./PriorityEdit"
],"RemovePriorityButton.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericModal",
  "../../../../client/contexts/ModalContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext"
]},"tags":{"AutoCompleteTagsMultiple.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/lists/useRecordList",
  "../../../../client/hooks/useAsyncState",
  "../../hooks/useTagsList"
],"CurrentChatTags.tsx":[
  "react",
  "./AutoCompleteTagsMultiple"
],"RemoveTagButton.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericModal",
  "../../../../client/contexts/ModalContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext"
],"TagEdit.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/AutoCompleteDepartmentMultiple",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useForm"
],"TagEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./TagEdit",
  "./TagEditWithDepartmentData"
],"TagEditWithDepartmentData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./TagEdit"
],"TagsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/FilterByText",
  "../../../../client/components/GenericTable",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext"
],"TagsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericTable",
  "../../../../client/components/NotAuthorizedPage",
  "../../../../client/contexts/AuthorizationContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useEndpointData",
  "./RemoveTagButton",
  "./TagEditWithData",
  "./TagsPage"
]},"units":{"RemoveUnitButton.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericModal",
  "../../../../client/contexts/ModalContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext"
],"UnitEdit.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/ServerContext",
  "../../../../client/contexts/ToastMessagesContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/lists/useRecordList",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useForm",
  "../../../../client/views/hooks/useDepartmentsByUnitsList",
  "../../../../client/views/hooks/useMonitorsList"
],"UnitEditWithData.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/Skeleton",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useAsyncState",
  "../../../../client/hooks/useEndpointData",
  "./UnitEdit"
],"UnitsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/FilterByText",
  "../../../../client/components/GenericTable",
  "../../../../client/components/Page",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext"
],"UnitsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../client/components/GenericTable",
  "../../../../client/components/NotAuthorizedPage",
  "../../../../client/contexts/AuthorizationContext",
  "../../../../client/contexts/RouterContext",
  "../../../../client/contexts/TranslationContext",
  "../../../../client/hooks/useEndpointData",
  "./RemoveUnitButton",
  "./UnitEditWithData",
  "./UnitsPage"
]},"BusinessHoursRow.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../client/contexts/RouterContext",
  "../../../client/contexts/TranslationContext",
  "./RemoveBusinessHourButton"
],"BusinessHoursTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../client/components/FilterByText",
  "../../../client/components/GenericTable",
  "../../../client/contexts/TranslationContext",
  "../../../client/hooks/useResizeInlineBreakpoint",
  "./BusinessHoursRow"
],"BusinessHoursTableContainer.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../client/contexts/TranslationContext",
  "../../../client/hooks/useAsyncState",
  "../../../client/hooks/useEndpointData",
  "./BusinessHoursTable"
],"ContactManagerInfo.js":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../../client/components/UserCard",
  "../../../client/components/UserStatus",
  "../../../client/components/avatar/UserAvatar",
  "../../../client/hooks/useAsyncState",
  "../../../client/hooks/useEndpointData"
],"RemoveBusinessHourButton.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../client/components/GenericModal",
  "../../../client/contexts/ModalContext",
  "../../../client/contexts/ServerContext",
  "../../../client/contexts/ToastMessagesContext",
  "../../../client/contexts/TranslationContext"
],"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/omnichannel/index.js                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./additionalForms/register");
module.link("./routes");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/omnichannel/routes.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var registerOmnichannelRoute;
module.link("../../../client/views/omnichannel/routes", {
  registerOmnichannelRoute: function (v) {
    registerOmnichannelRoute = v;
  }
}, 0);
registerOmnichannelRoute('/monitors', {
  name: 'omnichannel-monitors',
  lazyRouteComponent: function () {
    return module.dynamicImport('./monitors/MonitorsPageContainer');
  }
});
registerOmnichannelRoute('/priorities/:context?/:id?', {
  name: 'omnichannel-priorities',
  lazyRouteComponent: function () {
    return module.dynamicImport('./priorities/PrioritiesRoute');
  }
});
registerOmnichannelRoute('/canned-responses/:context?/:id?', {
  name: 'omnichannel-canned-responses',
  lazyRouteComponent: function () {
    return module.dynamicImport('./cannedResponses/CannedResponsesRoute');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"views":{"admin":{"engagementDashboard":{"channels":{"ChannelsTab.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "moment",
  "react",
  "../../../../../../client/components/data/Growth",
  "../../../../../../client/contexts/TranslationContext",
  "../Section",
  "../data/DownloadDataButton",
  "../data/PeriodSelector",
  "../data/usePeriodSelectorState",
  "./useChannelsList"
],"useChannelsList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
]},"data":{"DownloadDataButton.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/ToastMessagesContext",
  "../../../../../../client/contexts/TranslationContext",
  "../../../../../../client/lib/download"
],"LegendSymbol.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"PeriodSelector.tsx":[
  "@babel/runtime/helpers/toConsumableArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "./periods"
],"periods.ts":[
  "moment"
],"usePeriodLabel.ts":[
  "@babel/runtime/helpers/toConsumableArray",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "./periods"
],"usePeriodSelectorState.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "react"
]},"messages":{"MessagesPerChannelSection.tsx":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@nivo/pie",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "../Section",
  "../data/DownloadDataButton",
  "../data/LegendSymbol",
  "../data/PeriodSelector",
  "../data/usePeriodSelectorState",
  "./useMessageOrigins",
  "./useTopFivePopularChannels"
],"MessagesSentSection.tsx":[
  "@babel/runtime/helpers/createForOfIteratorHelperLoose",
  "@babel/runtime/helpers/slicedToArray",
  "@nivo/bar",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors.json",
  "moment",
  "react",
  "../../../../../../client/components/data/CounterSet",
  "../../../../../../client/contexts/TranslationContext",
  "../Section",
  "../data/DownloadDataButton",
  "../data/PeriodSelector",
  "../data/usePeriodLabel",
  "../data/usePeriodSelectorState",
  "./useMessagesSent"
],"MessagesTab.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./MessagesPerChannelSection",
  "./MessagesSentSection"
],"useMessageOrigins.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
],"useMessagesSent.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
],"useTopFivePopularChannels.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
]},"users":{"ActiveUsersSection.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@nivo/line",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors.json",
  "moment",
  "react",
  "../../../../../../client/components/data/CounterSet",
  "../../../../../../client/contexts/TranslationContext",
  "../../../../../../client/hooks/useFormatDate",
  "../Section",
  "../data/DownloadDataButton",
  "../data/LegendSymbol",
  "./useActiveUsers"
],"BusiestChatTimesSection.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "../Section",
  "./ContentForDays",
  "./ContentForHours"
],"ContentForDays.tsx":[
  "@nivo/bar",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "moment",
  "react",
  "./useWeeklyChatActivity"
],"ContentForHours.tsx":[
  "@babel/runtime/helpers/createForOfIteratorHelperLoose",
  "@nivo/bar",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-tokens/colors.json",
  "moment",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "./useHourlyChatActivity"
],"NewUsersSection.tsx":[
  "@babel/runtime/helpers/createForOfIteratorHelperLoose",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@nivo/bar",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-tokens/colors.json",
  "moment",
  "react",
  "../../../../../../client/components/data/CounterSet",
  "../../../../../../client/contexts/TranslationContext",
  "../../../../../../client/hooks/useFormatDate",
  "../Section",
  "../data/DownloadDataButton",
  "../data/PeriodSelector",
  "../data/usePeriodLabel",
  "../data/usePeriodSelectorState",
  "./useNewUsers"
],"UsersByTimeOfTheDaySection.tsx":[
  "@babel/runtime/helpers/createForOfIteratorHelperLoose",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@nivo/heatmap",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors.json",
  "moment",
  "react",
  "../../../../../../client/contexts/TranslationContext",
  "../Section",
  "../data/DownloadDataButton",
  "../data/PeriodSelector",
  "../data/usePeriodSelectorState",
  "./useUsersByTimeOfTheDay"
],"UsersTab.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "./ActiveUsersSection",
  "./BusiestChatTimesSection",
  "./NewUsersSection",
  "./UsersByTimeOfTheDaySection"
],"useActiveUsers.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "moment",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
],"useHourlyChatActivity.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "moment",
  "react-query",
  "../../../../lib/getFromRestApi"
],"useNewUsers.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
],"useUsersByTimeOfTheDay.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "react-query",
  "../../../../lib/getFromRestApi",
  "../data/periods"
],"useWeeklyChatActivity.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "moment",
  "react-query",
  "../../../../lib/getFromRestApi"
]},"EngagementDashboardPage.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../client/components/Page",
  "../../../../../client/contexts/TranslationContext",
  "./channels/ChannelsTab",
  "./messages/MessagesTab",
  "./users/UsersTab"
],"EngagementDashboardRoute.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../../client/components/NotAuthorizedPage",
  "../../../../../client/contexts/AuthorizationContext",
  "../../../../../client/contexts/RouterContext",
  "./EngagementDashboardPage"
],"Section.tsx":[
  "@rocket.chat/fuselage",
  "react"
]},"users":{"SeatsCapUsage":{"SeatsCapUsage.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../client/contexts/TranslationContext"
],"index.ts":[
  "./SeatsCapUsage"
]},"CloseToSeatsCapModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../client/components/ExternalLink",
  "../../../../../client/contexts/TranslationContext",
  "./SeatsCapUsage"
],"ReachedSeatsCapModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../client/components/ExternalLink",
  "../../../../../client/contexts/TranslationContext",
  "./SeatsCapUsage"
],"UserPageHeaderContentWithSeatsCap.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../client/components/ExternalLink",
  "../../../../../client/contexts/ModalContext",
  "../../../../../client/contexts/RouterContext",
  "../../../../../client/contexts/TranslationContext",
  "./CloseToSeatsCapModal",
  "./ReachedSeatsCapModal",
  "./SeatsCapUsage",
  "./useRequestSeatsLink"
],"useRequestSeatsLink.ts":[
  "../../../../../client/contexts/ServerContext"
],"useSeatsCap.ts":[
  "../../../../../client/hooks/useEndpointData"
]},"info":{"SeatsCard.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../../client/components/Card",
  "../../../../../client/components/ExternalLink",
  "../../../../../client/contexts/TranslationContext",
  "../../../../../client/views/admin/info/UsagePieGraph",
  "../users/useRequestSeatsLink",
  "../users/useSeatsCap"
]}}},"audit":{"RoomAutoComplete":{"Avatar.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/avatar/RoomAvatar"
],"RoomAutoComplete.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/hooks/useEndpointData",
  "./Avatar"
],"index.ts":[
  "./RoomAutoComplete"
]},"Tabs":{"ChannelTab.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/contexts/TranslationContext",
  "../RoomAutoComplete"
],"DirectTab.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/UserAutoCompleteMultiple",
  "../../../../client/contexts/TranslationContext"
],"UsersTab.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/UserAutoCompleteMultiple",
  "../../../../client/contexts/TranslationContext"
],"VisitorsTab.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../client/components/AutoCompleteAgent",
  "../../../../client/contexts/TranslationContext",
  "../VisitorAutoComplete"
]},"AuditLogPage.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../client/components/Page",
  "../../../client/contexts/TranslationContext",
  "../../../client/hooks/useMethodData",
  "./AuditLogTable",
  "./DateRangePicker"
],"AuditLogTable.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "../../../client/components/GenericTable",
  "../../../client/contexts/TranslationContext",
  "../../../client/hooks/useFormatDate",
  "../../../client/hooks/useFormatDateAndTime",
  "./UserRow"
],"AuditPage.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../client/contexts/TranslationContext",
  "../../../client/hooks/useForm",
  "./AuditPageBase"
],"AuditPageBase.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../client/components/Page",
  "../../../client/contexts/TranslationContext",
  "./DateRangePicker",
  "./Result",
  "./Tabs/ChannelTab",
  "./Tabs/DirectTab",
  "./Tabs/UsersTab",
  "./Tabs/VisitorsTab"
],"DateRangePicker.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../client/contexts/TranslationContext"
],"FilterDisplay.js":[
  "@rocket.chat/fuselage",
  "react"
],"Result.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/blaze",
  "meteor/templating",
  "react",
  "../../app/auditing/client/templates/audit/audit.html"
],"UserRow.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../client/components/avatar/UserAvatar",
  "../../../client/contexts/TranslationContext",
  "./FilterDisplay"
],"VisitorAutoComplete.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../client/hooks/useEndpointData"
]},"hooks":{"useHasLicense.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/hooks/useHasLicense.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
module.export({
  useHasLicense: function () {
    return useHasLicense;
  }
});
var useState, useEffect;
module.link("react", {
  useState: function (v) {
    useState = v;
  },
  useEffect: function (v) {
    useEffect = v;
  }
}, 0);
var hasLicense;
module.link("../../app/license/client", {
  hasLicense: function (v) {
    hasLicense = v;
  }
}, 1);

var useHasLicense = function (licenseName) {
  var _useState = useState('loading'),
      _useState2 = _slicedToArray(_useState, 2),
      license = _useState2[0],
      setLicense = _useState2[1];

  useEffect(function () {
    hasLicense(licenseName).then(function (enabled) {
      if (enabled) {
        return setLicense(true);
      }

      setLicense(false);
    });
  }, [licenseName]);
  return license;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useTagsList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../client/contexts/ServerContext",
  "../../../client/hooks/lists/useScrollableRecordList",
  "../../../client/hooks/useComponentDidUpdate",
  "../../../client/lib/lists/RecordList"
]},"startup":{"engagementDashboard.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/startup/engagementDashboard.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var hasAllPermission;
module.link("../../../app/authorization/client", {
  hasAllPermission: function (v) {
    hasAllPermission = v;
  }
}, 1);
var registerAdminRoute, registerAdminSidebarItem, unregisterAdminSidebarItem;
module.link("../../../client/views/admin", {
  registerAdminRoute: function (v) {
    registerAdminRoute = v;
  },
  registerAdminSidebarItem: function (v) {
    registerAdminSidebarItem = v;
  },
  unregisterAdminSidebarItem: function (v) {
    unregisterAdminSidebarItem = v;
  }
}, 2);
var onToggledFeature;
module.link("../lib/onToggledFeature", {
  onToggledFeature: function (v) {
    onToggledFeature = v;
  }
}, 3);

var _registerAdminRoute = registerAdminRoute('/engagement-dashboard/:tab?', {
  name: 'engagement-dashboard',
  lazyRouteComponent: function () {
    return module.dynamicImport('../views/admin/engagementDashboard/EngagementDashboardRoute');
  },
  ready: false
}),
    _registerAdminRoute2 = _slicedToArray(_registerAdminRoute, 2),
    registerRoute = _registerAdminRoute2[0],
    unregisterRoute = _registerAdminRoute2[1];

onToggledFeature('engagement-dashboard', {
  up: function () {
    return Meteor.startup(function () {
      registerAdminSidebarItem({
        href: '/admin/engagement-dashboard',
        i18nLabel: 'Engagement Dashboard',
        icon: 'file-keynote',
        permissionGranted: function () {
          return hasAllPermission('view-engagement-dashboard');
        }
      });
      registerRoute();
    });
  },
  down: function () {
    return Meteor.startup(function () {
      unregisterAdminSidebarItem('Engagement Dashboard');
      unregisterRoute();
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/startup/index.ts                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./engagementDashboard");
module.link("./routes");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/startup/routes.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var appLayout;
module.link("../../../client/lib/appLayout", {
  appLayout: function (v) {
    appLayout = v;
  }
}, 1);
FlowRouter.route('/audit', {
  name: 'audit-home',
  action: function () {
    appLayout.renderMainLayout({
      center: 'auditPage'
    });
  }
});
FlowRouter.route('/audit-log', {
  name: 'audit-log',
  action: function () {
    appLayout.renderMainLayout({
      center: 'auditLogPage'
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ecdh.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/ecdh.ts                                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var APIClient;
module.link("../../app/utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 1);
var resolveSession;
var sessionPromise = new Promise(function (resolve) {
  resolveSession = resolve;
});

function init(session) {
  Meteor.connection._stream.allowConnection();

  var _didMessage = Meteor.connection._stream.socket._didMessage.bind(Meteor.connection._stream.socket);

  var send = Meteor.connection._stream.socket.send.bind(Meteor.connection._stream.socket);

  Meteor.connection._stream.socket._didMessage = function () {
    function _callee(data) {
      var decryptedData;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return _regeneratorRuntime.awrap(session.decrypt(data));

              case 2:
                decryptedData = _context.sent;
                decryptedData.split('\n').forEach(function (d) {
                  return _didMessage(d);
                });

              case 4:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }();

  Meteor.connection._stream.socket.send = function () {
    function _callee2(data) {
      return _regeneratorRuntime.async(function () {
        function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                _context2.t0 = send;
                _context2.next = 3;
                return _regeneratorRuntime.awrap(session.encrypt(data));

              case 3:
                _context2.t1 = _context2.sent;
                (0, _context2.t0)(_context2.t1);

              case 5:
              case "end":
                return _context2.stop();
            }
          }
        }

        return _callee2$;
      }(), null, null, null, Promise);
    }

    return _callee2;
  }();
}

function initEncryptedSession() {
  var _await$module$dynamic, ClientSession, session, clientPublicKey, response, data;

  return _regeneratorRuntime.async(function () {
    function initEncryptedSession$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            if (window.ECDH_Enabled) {
              _context3.next = 3;
              break;
            }

            Meteor.connection._stream.allowConnection();

            return _context3.abrupt("return", resolveSession());

          case 3:
            _context3.next = 5;
            return _regeneratorRuntime.awrap(module.dynamicImport('../app/ecdh/client/ClientSession'));

          case 5:
            _await$module$dynamic = _context3.sent;
            ClientSession = _await$module$dynamic.ClientSession;
            session = new ClientSession();
            _context3.next = 10;
            return _regeneratorRuntime.awrap(session.init());

          case 10:
            clientPublicKey = _context3.sent;
            _context3.prev = 11;
            _context3.next = 14;
            return _regeneratorRuntime.awrap(fetch('/api/ecdh_proxy/initEncryptedSession', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                clientPublicKey: clientPublicKey
              })
            }));

          case 14:
            response = _context3.sent;

            if (!(response.status !== 200)) {
              _context3.next = 18;
              break;
            }

            resolveSession();
            return _context3.abrupt("return", Meteor.connection._stream.allowConnection());

          case 18:
            _context3.next = 20;
            return _regeneratorRuntime.awrap(response.json());

          case 20:
            data = _context3.sent;

            if (!(data.success === false)) {
              _context3.next = 24;
              break;
            }

            resolveSession();
            return _context3.abrupt("return", Meteor.connection._stream.allowConnection());

          case 24:
            _context3.next = 26;
            return _regeneratorRuntime.awrap(session.setServerKey(data.publicKeyString));

          case 26:
            resolveSession(session);
            init(session);
            _context3.next = 35;
            break;

          case 30:
            _context3.prev = 30;
            _context3.t0 = _context3["catch"](11);
            console.log(_context3.t0);
            resolveSession();

            Meteor.connection._stream.allowConnection();

          case 35:
          case "end":
            return _context3.stop();
        }
      }
    }

    return initEncryptedSession$;
  }(), null, null, [[11, 30]], Promise);
}

initEncryptedSession();

var _jqueryCall = APIClient._jqueryCall.bind(APIClient);

APIClient._jqueryCall = function () {
  function _callee3(method, endpoint, params, body) {
    var headers,
        session,
        result,
        decrypted,
        parsed,
        _args4 = arguments;
    return _regeneratorRuntime.async(function () {
      function _callee3$(_context4) {
        while (1) {
          switch (_context4.prev = _context4.next) {
            case 0:
              headers = _args4.length > 4 && _args4[4] !== undefined ? _args4[4] : {};
              _context4.next = 3;
              return _regeneratorRuntime.awrap(sessionPromise);

            case 3:
              session = _context4.sent;

              if (session) {
                _context4.next = 6;
                break;
              }

              return _context4.abrupt("return", _jqueryCall(method, endpoint, params, body, headers));

            case 6:
              _context4.next = 8;
              return _regeneratorRuntime.awrap(_jqueryCall(method, endpoint, params, body, headers, 'text'));

            case 8:
              result = _context4.sent;
              _context4.next = 11;
              return _regeneratorRuntime.awrap(session.decrypt(result));

            case 11:
              decrypted = _context4.sent;
              parsed = JSON.parse(decrypted);
              return _context4.abrupt("return", parsed);

            case 14:
            case "end":
              return _context4.stop();
          }
        }
      }

      return _callee3$;
    }(), null, null, null, Promise);
  }

  return _callee3;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// ee/client/index.ts                                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../app/auditing/client");
module.link("../app/authorization/client");
module.link("../app/canned-responses/client");
module.link("../app/license/client");
module.link("../app/livechat-enterprise/client");
module.link("./omnichannel");
module.link("./startup");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"client":{"views":{"room":{"contextualBar":{"Call":{"Jitsi":{"lib":{"Jitsi.js":[
  "@babel/runtime/helpers/slicedToArray",
  "postis"
],"JitsiBridge.js":[
  "@babel/runtime/helpers/inheritsLoose",
  "@rocket.chat/emitter",
  "./Jitsi"
]},"components":{"CallModal.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../contexts/TranslationContext"
]},"CallJitsi.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext"
],"CallJitsiWithData.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/memo",
  "react",
  "../../../../../../app/videobridge/constants",
  "../../../../../contexts/ConnectionStatusContext",
  "../../../../../contexts/ModalContext",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/SettingsContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../contexts/UserContext",
  "../../../contexts/RoomContext",
  "../../../providers/ToolboxProvider",
  "./CallJitsi",
  "./components/CallModal",
  "./lib/JitsiBridge"
],"index.ts":[
  "./CallJitsiWithData"
]},"BBB":{"CallBBB.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext"
],"D.tsx":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/ui-utils/client",
  "../../../../../contexts/AuthorizationContext",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/SettingsContext",
  "../../../contexts/RoomContext",
  "../../../providers/ToolboxProvider",
  "./CallBBB"
],"index.ts":[
  "./D"
]}},"RoomFiles":{"lib":{"getDifference.js":[]},"components":{"FileItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../../hooks/useFormatDateAndTime",
  "./FileItemIcon",
  "./MenuItem"
],"FileItemIcon.js":[
  "react"
],"MenuItem.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../app/utils/client",
  "../../../../../contexts/TranslationContext",
  "../../../../../lib/download"
]},"hooks":{"useFilesList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/lists/useScrollableMessageList",
  "../../../../../hooks/lists/useStreamUpdatesForMessageList",
  "../../../../../hooks/useComponentDidUpdate",
  "../../../../../lib/lists/FilesList",
  "../../../../../lib/utils/getConfig"
],"useMessageDeletionIsAllowed.js":[
  "react",
  "../../../../../contexts/AuthorizationContext",
  "../../../../../contexts/SettingsContext",
  "../lib/getDifference"
]},"RoomFiles.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../components/ScrollableContentWrapper",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "./Row"
],"RoomFilesWithData.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/ModalContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../contexts/UserContext",
  "../../../../hooks/lists/useRecordList",
  "../../../../hooks/useAsyncState",
  "../../providers/ToolboxProvider",
  "./RoomFiles",
  "./hooks/useFilesList",
  "./hooks/useMessageDeletionIsAllowed"
],"Row.js":[
  "react",
  "./components/FileItem"
],"index.ts":[
  "./RoomFilesWithData"
]},"RoomMembers":{"List":{"components":{"MemberItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../components/UserStatus",
  "../../../../../../components/avatar/UserAvatar",
  "../../../../../../hooks/usePreventProgation",
  "./UserActions"
],"UserActions.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../hooks/useActionSpread",
  "../../../../hooks/useUserInfoActions"
]},"DefaultRow.js":[
  "react",
  "./components/MemberItem"
],"RoomMembers.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../../components/ScrollableContentWrapper",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext",
  "./DefaultRow"
],"RoomMembersWithData.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../contexts/AuthorizationContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/lists/useRecordList",
  "../../../../../hooks/useAsyncState",
  "../../../../hooks/useMembersList",
  "../../../providers/ToolboxProvider",
  "../../UserInfo",
  "../AddUsers",
  "../InviteUsers",
  "./RoomMembers"
]},"AddUsers":{"AddUsers.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/UserAutoCompleteMultiple",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext"
],"AddUsersWithData.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useForm",
  "../../../providers/ToolboxProvider",
  "./AddUsers"
],"index.ts":[
  "./AddUsersWithData"
]},"EditInvite":{"EditInvite.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext"
],"EditInviteWithData.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../providers/ToolboxProvider",
  "./EditInvite"
],"index.ts":[
  "./EditInviteWithData"
]},"InviteUsers":{"InviteUsers.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useClipboardWithToast"
],"WrappedInviteUsers.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useFormatDateAndTime",
  "../../../providers/ToolboxProvider",
  "../EditInvite",
  "./InviteUsers"
],"index.ts":[
  "./WrappedInviteUsers"
]},"index.ts":[
  "./List/RoomMembersWithData"
]},"Discussions":{"components":{"Message.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/RawText",
  "../../../../../components/avatar/UserAvatar",
  "../../../components/MessageTemplate"
]},"DiscussionList.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../components/ScrollableContentWrapper",
  "../../../../components/VerticalBar",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext",
  "../../../../lib/utils/goToRoomById",
  "./Row",
  "./withData"
],"Row.js":[
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useTimeAgo",
  "../../../../lib/clickableItem",
  "./components/Message",
  "./mapProps",
  "./normalizeThreadMessage"
],"index.ts":[
  "./DiscussionList"
],"mapProps.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react"
],"normalizeThreadMessage.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/string-helpers",
  "../../../../lib/utils/renderMessageBody"
],"useDiscussionsList.ts":[
  "@babel/runtime/regenerator",
  "react",
  "../../../../contexts/ServerContext",
  "../../../../hooks/lists/useScrollableMessageList",
  "../../../../hooks/lists/useStreamUpdatesForMessageList",
  "../../../../lib/lists/DiscussionsList",
  "../../../../lib/utils/getConfig"
],"withData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/UserContext",
  "../../../../hooks/lists/useRecordList",
  "../../../../hooks/useAsyncState",
  "../../hooks/useUserRoom",
  "../../providers/ToolboxProvider",
  "./useDiscussionsList"
]},"Info":{"ChannelToTeamModal":{"ChannelToTeamModal.js":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "./StepOne",
  "./StepTwo"
],"StepOne.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../../../teams/contextualBar/TeamAutocomplete"
],"StepTwo.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext"
]},"EditRoomInfo":{"EditChannel.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/e2e/client/rocketchat.e2e",
  "../../../../../../app/lib/lib/MessageTypes",
  "../../../../../../app/utils/client",
  "../../../../../components/GenericModal",
  "../../../../../components/RawText",
  "../../../../../components/VerticalBar",
  "../../../../../components/avatar/RoomAvatarEditor",
  "../../../../../contexts/AuthorizationContext",
  "../../../../../contexts/ModalContext",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/SettingsContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useEndpointActionExperimental",
  "../../../../../hooks/useForm"
],"EditChannelWithData.js":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../hooks/useUserRoom",
  "../../../providers/ToolboxProvider",
  "./EditChannel"
],"index.ts":[
  "./EditChannelWithData"
]},"RoomInfo":{"RoomInfo.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/MarkdownText",
  "../../../../../components/VerticalBar",
  "../../../../../components/avatar/RoomAvatar",
  "../../../../../contexts/TranslationContext",
  "../../../../InfoPanel",
  "../../../../InfoPanel/RetentionPolicyCallout",
  "../../../../hooks/useActionSpread"
],"RoomInfoWithData.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/ui-utils/client/lib/RoomManager",
  "../../../../../../app/utils/client",
  "../../../../../components/GenericModal",
  "../../../../../contexts/AuthorizationContext",
  "../../../../../contexts/ModalContext",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/SettingsContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/useEndpointActionExperimental",
  "../../../../admin/apps/WarningModal",
  "../../../providers/ToolboxProvider",
  "../ChannelToTeamModal/ChannelToTeamModal",
  "./RoomInfo"
],"index.ts":[
  "./RoomInfoWithData"
]},"index.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "./EditRoomInfo",
  "./RoomInfo"
]},"NotificationPreferences":{"components":{"NotificationByDevice.js":[
  "@rocket.chat/fuselage",
  "react"
],"NotificationToogle.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react"
],"Preferences.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
]},"NotificationPreferences.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "./components/NotificationByDevice",
  "./components/NotificationToogle",
  "./components/Preferences"
],"NotificationPreferencesWithData.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/CustomSoundContext",
  "../../../../contexts/TranslationContext",
  "../../../../contexts/UserContext",
  "../../../../hooks/useEndpointActionExperimental",
  "../../../../hooks/useForm",
  "../../providers/ToolboxProvider",
  "./NotificationPreferences"
],"index.ts":[
  "./NotificationPreferencesWithData"
]},"Threads":{"components":{"Message.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/Message/Metrics",
  "../../../../../components/Message/NotificationStatus",
  "../../../../../components/Message/helpers/followSyle",
  "../../../../../components/RawText",
  "../../../../../components/avatar/UserAvatar",
  "../../../components/MessageTemplate"
]},"Row.tsx":[
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useTimeAgo",
  "../../../../lib/clickableItem",
  "../../../../lib/utils/callWithErrorHandling",
  "./components/Message",
  "./mapProps",
  "./normalizeThreadMessage"
],"ThreadList.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../components/ScrollableContentWrapper",
  "../../../../components/VerticalBar",
  "../../../../contexts/RouterContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext",
  "../../providers/ToolboxProvider",
  "../../threads/ThreadComponent",
  "./Row",
  "./withData"
],"index.ts":[
  "./ThreadList"
],"mapProps.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react"
],"normalizeThreadMessage.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/string-helpers",
  "../../../../lib/utils/renderMessageBody"
],"useThreadsList.ts":[
  "@babel/runtime/regenerator",
  "react",
  "../../../../contexts/ServerContext",
  "../../../../hooks/lists/useScrollableMessageList",
  "../../../../hooks/lists/useStreamUpdatesForMessageList",
  "../../../../lib/lists/ThreadsList",
  "../../../../lib/utils/getConfig"
],"withData.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/UserContext",
  "../../../../hooks/lists/useRecordList",
  "../../../../hooks/useAsyncState",
  "../../hooks/useUserRoom",
  "../../providers/ToolboxProvider",
  "./useThreadsList"
]},"UserInfo":{"UserWebRTC":{"UserWebRTC.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "./UserWebRTCRemote",
  "./UserWebRTCVideo"
],"UserWebRTCButtons.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext"
],"UserWebRTCRemote.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "./UserWebRTCVideo"
],"UserWebRTCVideo.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react"
],"UserWebRTCWithData.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors.json",
  "react",
  "react-dom",
  "../../../../../components/VerticalBar",
  "../../../../../lib/utils/createAnchor",
  "../../../hooks/useWebRTC",
  "./UserWebRTC",
  "./UserWebRTCButtons"
],"index.ts":[
  "./UserWebRTCWithData"
]},"actions":{"UserActions.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "..",
  "../../../../hooks/useActionSpread",
  "../../../hooks/useUserInfoActions"
]},"Action.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"Avatar.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../components/avatar/UserAvatar"
],"UserInfo.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/MarkdownText",
  "../../../../components/UTCClock",
  "../../../../components/UserCard",
  "../../../../components/VerticalBar",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useTimeAgo",
  "../../../InfoPanel",
  "./Avatar"
],"UserInfoWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../lib/getUserEmailAddress",
  "../../../../components/Skeleton",
  "../../../../components/UserCard",
  "../../../../components/UserStatus",
  "../../../../components/VerticalBar",
  "../../../../contexts/AuthorizationContext",
  "../../../../contexts/SessionContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "../../../../lib/utils/getUserEmailVerified",
  "../../hooks/useWebRTC",
  "./UserInfo",
  "./UserWebRTC",
  "./actions/UserActions"
],"Username.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../components/UserCard"
],"index.js":[
  "react",
  "../../../InfoPanel",
  "./Action",
  "./Avatar",
  "./UserInfoWithData",
  "./Username"
]},"Apps":{"Apps.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../../../../app/utils/lib/getURL",
  "../../../../components/VerticalBar",
  "../../../blocks/ModalBlock"
],"AppsWithData.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/apps-engine/definition/uikit/UIKitIncomingInteractionContainer",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../../../../app/ui-message/client/ActionManager",
  "../../providers/ToolboxProvider",
  "./Apps"
],"index.ts":[
  "./AppsWithData"
]},"AutoTranslate":{"AutoTranslate.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext"
],"AutoTranslateWithData.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../contexts/UserContext",
  "../../../../hooks/useEndpointActionExperimental",
  "../../../../hooks/useEndpointData",
  "../../providers/ToolboxProvider",
  "./AutoTranslate"
],"index.ts":[
  "./AutoTranslateWithData"
]},"ExportMessages":{"ExportMessages.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "../../providers/ToolboxProvider",
  "./FileExport",
  "./MailExportForm"
],"FileExport.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useForm"
],"MailExportForm.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../../lib/emailValidator",
  "../../../../components/UserAutoCompleteMultiple",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useForm",
  "../../hooks/useUserRoom"
],"index.ts":[
  "./ExportMessages"
]},"KeyboardShortcuts":{"KeyboardShortcuts.js":[
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "./ShortcutSection"
],"KeyboardShortcutsWithClose.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "./KeyboardShortcuts"
],"ShortcutSection.js":[
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./KeyboardShortcutsWithClose"
]},"OTR":{"OTR.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext"
],"OTRModal.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext"
],"OTRWithData.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/otr/client/rocketchat.otr",
  "../../../../contexts/ModalContext",
  "../../../../hooks/usePresence",
  "../../../../hooks/useReactiveValue",
  "./OTR",
  "./OTRModal"
],"index.ts":[
  "./OTRWithData"
]},"PruneMessages":{"DateTimeRow.js":[
  "@rocket.chat/fuselage",
  "react"
],"PruneMessages.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/UserAutoCompleteMultiple",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "./DateTimeRow"
],"PruneMessagesWithData.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "moment",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/ModalContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../contexts/UserContext",
  "../../../../hooks/useForm",
  "./PruneMessages"
],"index.ts":[
  "./PruneMessagesWithData"
]}},"lib":{"QuickActions":{"QuickActionsContext.tsx":[
  "react",
  ".",
  "./defaultActions"
],"defaultActions.ts":[
  "."
],"index.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/lib/QuickActions/index.tsx                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  listen: function () {
    return listen;
  },
  addAction: function () {
    return addAction;
  },
  deleteAction: function () {
    return deleteAction;
  },
  actions: function () {
    return actions;
  },
  QuickActionsEnum: function () {
    return QuickActionsEnum;
  }
});
var generator;
module.link("../Toolbox/generator", {
  generator: function (v) {
    generator = v;
  }
}, 0);

var _generator = generator(),
    listen = _generator.listen,
    addAction = _generator.add,
    deleteAction = _generator.remove,
    actions = _generator.store;

var QuickActionsEnum;

(function (QuickActionsEnum) {
  QuickActionsEnum["MoveQueue"] = "rocket-move-to-queue";
  QuickActionsEnum["ChatForward"] = "rocket-chat-forward";
  QuickActionsEnum["Transcript"] = "rocket-transcript";
  QuickActionsEnum["CloseChat"] = "rocket-close-chat";
  QuickActionsEnum["OnHoldChat"] = "rocket-on-hold-chat";
})(QuickActionsEnum || module.runSetters(QuickActionsEnum = {}, ["QuickActionsEnum"]));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"Toolbox":{"IframeButtons.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/lib/Toolbox/IframeButtons.tsx                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  listen: function () {
    return listen;
  },
  add: function () {
    return add;
  },
  remove: function () {
    return remove;
  },
  store: function () {
    return store;
  }
});
var generator;
module.link("./generator", {
  generator: function (v) {
    generator = v;
  }
}, 0);

var _generator = generator(),
    listen = _generator.listen,
    add = _generator.add,
    remove = _generator.remove,
    store = _generator.store;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ToolboxContext.tsx":[
  "react",
  ".",
  "./defaultActions"
],"defaultActions.ts":[
  "react",
  ".",
  "../../../../contexts/AuthorizationContext"
],"generator.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/lib/Toolbox/generator.tsx                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  generator: function () {
    return generator;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);

var generator = function () {
  function generator(name) {
    var store = new Map();
    var emitter = new Emitter();

    var add = function (id, action) {
      store.set(id, action);
      emitter.emit('change', store);
      return store;
    };

    var remove = function (id) {
      var result = store.delete(id);
      emitter.emit('change', store);
      return result;
    };

    var listen = function (handler) {
      return emitter.on('change', handler);
    };

    return Object.freeze({
      store: store,
      add: add,
      remove: remove,
      listen: listen,
      name: name
    });
  }

  return generator;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/lib/Toolbox/index.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  listen: function () {
    return listen;
  },
  addAction: function () {
    return addAction;
  },
  deleteAction: function () {
    return deleteAction;
  },
  actions: function () {
    return actions;
  }
});
var generator;
module.link("./generator", {
  generator: function (v) {
    generator = v;
  }
}, 0);

var _generator = generator(),
    listen = _generator.listen,
    addAction = _generator.add,
    deleteAction = _generator.remove,
    actions = _generator.store;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"Header":{"Omnichannel":{"QuickActions":{"hooks":{"useQuickActions.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "meteor/kadira:flow-router",
  "meteor/session",
  "react",
  "../../../../../../../app/ui-utils/client",
  "../../../../../../../ee/app/livechat-enterprise/client/components/modals/PlaceChatOnHoldModal",
  "../../../../../../components/Omnichannel/modals/CloseChatModal",
  "../../../../../../components/Omnichannel/modals/CloseChatModalData",
  "../../../../../../components/Omnichannel/modals/ForwardChatModal",
  "../../../../../../components/Omnichannel/modals/ReturnChatQueueModal",
  "../../../../../../components/Omnichannel/modals/TranscriptModal",
  "../../../../../../contexts/AuthorizationContext",
  "../../../../../../contexts/ModalContext",
  "../../../../../../contexts/OmnichannelContext",
  "../../../../../../contexts/ServerContext",
  "../../../../../../contexts/SettingsContext",
  "../../../../../../contexts/ToastMessagesContext",
  "../../../../../../contexts/TranslationContext",
  "../../../../../../contexts/UserContext",
  "../../../../../../lib/utils/handleError",
  "../../../../lib/QuickActions",
  "../../../../lib/QuickActions/QuickActionsContext"
]},"QuickActions.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/Header",
  "../../../../../contexts/TranslationContext",
  "./hooks/useQuickActions"
],"index.ts":[
  "./QuickActions"
]},"BackButton.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/Header",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext"
],"OmnichannelRoomHeader.tsx":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../components/BurgerMenu",
  "../../../../components/Header",
  "../../../../contexts/LayoutContext",
  "../../../../contexts/RouterContext",
  "../../contexts/RoomContext",
  "../../lib/Toolbox/ToolboxContext",
  "../RoomHeader",
  "./BackButton",
  "./QuickActions",
  "./QuickActions/hooks/useQuickActions"
]},"ToolBox":{"ToolBox.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/Header",
  "../../../../contexts/LayoutContext",
  "../../../../contexts/TranslationContext",
  "../../lib/Toolbox/ToolboxContext",
  "../../providers/ToolboxProvider"
],"index.ts":[
  "./ToolBox"
]},"icons":{"Encrypted.js":[
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../components/Header",
  "../../../../contexts/ServerContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext"
],"Favorite.js":[
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../components/Header",
  "../../../../contexts/ServerContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext"
],"Translate.tsx":[
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../components/Header",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext"
]},"DirectRoomHeader.js":[
  "react",
  "../../../contexts/UserContext",
  "../../../hooks/usePresence",
  "./RoomHeader"
],"Header.js":[
  "react",
  "../../../components/BurgerMenu",
  "../../../components/Header",
  "../../../contexts/LayoutContext",
  "./DirectRoomHeader",
  "./Omnichannel/OmnichannelRoomHeader",
  "./RoomHeader"
],"HeaderIconWithRoom.js":[
  "react",
  "../../../../definition/IRoom",
  "../../../components/Header",
  "../../../components/RoomIcon/OmnichannelRoomIcon",
  "../../../hooks/useRoomIcon"
],"ParentRoom.js":[
  "react",
  "../../../../app/utils/client",
  "../../../components/Header",
  "../../../hooks/useRoomIcon"
],"ParentRoomWithData.js":[
  "react",
  "../../../contexts/UserContext",
  "./ParentRoom",
  "./ParentRoomWithEndpointData"
],"ParentRoomWithEndpointData.js":[
  "@babel/runtime/regenerator",
  "react",
  "../../../components/Header",
  "../../../contexts/ServerContext",
  "../../../hooks/useAsyncState",
  "./ParentRoom"
],"ParentTeam.js":[
  "react",
  "../../../../definition/ITeam",
  "../../../components/Header",
  "../../../contexts/UserContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../../../lib/utils/goToRoomById"
],"RoomHeader.tsx":[
  "react",
  "../../../components/Header",
  "../../../components/MarkdownText",
  "../../../components/avatar/RoomAvatar",
  "./ParentRoomWithData",
  "./ParentTeam",
  "./RoomTitle",
  "./ToolBox",
  "./icons/Encrypted",
  "./icons/Favorite",
  "./icons/Translate"
],"RoomTitle.tsx":[
  "react",
  "../../../components/Header",
  "./HeaderIconWithRoom"
],"index.ts":[
  "./Header"
]},"components":{"RoomTemplate":{"slots":{"Aside.tsx":[
  "react"
],"Body.tsx":[
  "react"
],"Footer.tsx":[
  "react"
],"Header.tsx":[
  "react"
]},"RoomTemplate.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "react-keyed-flatten-children",
  "../../../../components/VerticalBar/VerticalBar",
  "./slots/Aside",
  "./slots/Body",
  "./slots/Footer",
  "./slots/Header"
]},"MessageTemplate":{"BodyClamp.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "./isIterable"
],"Container.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"Header.js":[
  "@rocket.chat/fuselage",
  "react"
],"Message.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./isIterable"
],"Timestamp.js":[
  "@rocket.chat/fuselage",
  "react"
],"Username.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./Container",
  "./Header",
  "./Username",
  "./Timestamp",
  "./Message",
  "./BodyClamp"
],"isIterable.js":[]},"BlazeTemplate.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "meteor/blaze",
  "meteor/templating",
  "react"
],"VerticalBarOldActions.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/TranslationContext",
  "../providers/ToolboxProvider",
  "./BlazeTemplate"
]},"Room":{"RoomNotFound":{"RoomNotFound.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/BurgerMenu",
  "../../../../components/Header",
  "../../../../contexts/LayoutContext",
  "../../../../contexts/TranslationContext",
  "../../components/RoomTemplate/RoomTemplate"
],"index.ts":[
  "./RoomNotFound"
]},"Aside.js":[
  "react"
],"Body.js":[
  "react"
],"Footer.js":[
  "react"
],"LazyComponent.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/VerticalBar"
],"Room.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/ErrorBoundary",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../Header",
  "../components/BlazeTemplate",
  "../components/RoomTemplate/RoomTemplate",
  "../components/VerticalBarOldActions",
  "../contexts/RoomContext",
  "../contextualBar/Apps",
  "../hooks/useAppsContextualBar",
  "../providers/ToolboxProvider",
  "./Aside",
  "./Body",
  "./Footer",
  "./LazyComponent"
],"RoomWithData.js":[
  "react",
  "../../../lib/RoomManager",
  "../providers/RoomProvider",
  "./Room"
],"Skeleton.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Header",
  "../../../components/VerticalBar/VerticalBarSkeleton",
  "../components/RoomTemplate/RoomTemplate"
],"index.ts":[
  "./RoomWithData"
]},"modals":{"FileUploadModal":{"FilePreview.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/FilePreview.tsx                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  FilePreviewType: function () {
    return FilePreviewType;
  }
});
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 0);
var isIE11;
module.link("../../../../lib/utils/isIE11", {
  isIE11: function (v) {
    isIE11 = v;
  }
}, 1);
var GenericPreview;
module.link("./GenericPreview", {
  "default": function (v) {
    GenericPreview = v;
  }
}, 2);
var MediaPreview;
module.link("./MediaPreview", {
  "default": function (v) {
    MediaPreview = v;
  }
}, 3);
var FilePreviewType;

(function (FilePreviewType) {
  FilePreviewType["IMAGE"] = "image";
  FilePreviewType["AUDIO"] = "audio";
  FilePreviewType["VIDEO"] = "video";
})(FilePreviewType || module.runSetters(FilePreviewType = {}, ["FilePreviewType"]));

var getFileType = function (fileType) {
  if (!fileType) {
    return;
  }

  for (var _i = 0, _Object$values = Object.values(FilePreviewType); _i < _Object$values.length; _i++) {
    var type = _Object$values[_i];

    if (fileType.indexOf(type) > -1) {
      return type;
    }
  }
};

var shouldShowMediaPreview = function (file, fileType) {
  if (!fileType) {
    return false;
  }

  if (isIE11) {
    return false;
  } // Avoid preview if file size bigger than 10mb


  if (file.size > 10000000) {
    return false;
  }

  if (!Object.values(FilePreviewType).includes(fileType)) {
    return false;
  }

  return true;
};

var FilePreview = function (_ref) {
  var file = _ref.file;
  var fileType = getFileType(file.type);

  if (shouldShowMediaPreview(file, fileType)) {
    return /*#__PURE__*/React.createElement(MediaPreview, {
      file: file,
      fileType: fileType
    });
  }

  return /*#__PURE__*/React.createElement(GenericPreview, {
    file: file
  });
};

module.exportDefault(FilePreview);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"FileUploadModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/FileUploadModal.tsx                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Modal, Box, Field, FieldGroup, TextInput, ButtonGroup, Button;
module.link("@rocket.chat/fuselage", {
  Modal: function (v) {
    Modal = v;
  },
  Box: function (v) {
    Box = v;
  },
  Field: function (v) {
    Field = v;
  },
  FieldGroup: function (v) {
    FieldGroup = v;
  },
  TextInput: function (v) {
    TextInput = v;
  },
  ButtonGroup: function (v) {
    ButtonGroup = v;
  },
  Button: function (v) {
    Button = v;
  }
}, 0);
var useAutoFocus;
module.link("@rocket.chat/fuselage-hooks", {
  useAutoFocus: function (v) {
    useAutoFocus = v;
  }
}, 1);
var React, memo, useState, useEffect;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  memo: function (v) {
    memo = v;
  },
  useState: function (v) {
    useState = v;
  },
  useEffect: function (v) {
    useEffect = v;
  }
}, 2);
var useToastMessageDispatch;
module.link("../../../../contexts/ToastMessagesContext", {
  useToastMessageDispatch: function (v) {
    useToastMessageDispatch = v;
  }
}, 3);
var useTranslation;
module.link("../../../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 4);
var FilePreview;
module.link("./FilePreview", {
  "default": function (v) {
    FilePreview = v;
  }
}, 5);

var FileUploadModal = function (_ref) {
  var onClose = _ref.onClose,
      file = _ref.file,
      fileName = _ref.fileName,
      onSubmit = _ref.onSubmit,
      invalidContentType = _ref.invalidContentType;

  var _useState = useState(fileName),
      _useState2 = _slicedToArray(_useState, 2),
      name = _useState2[0],
      setName = _useState2[1];

  var _useState3 = useState(''),
      _useState4 = _slicedToArray(_useState3, 2),
      description = _useState4[0],
      setDescription = _useState4[1];

  var t = useTranslation();
  var dispatchToastMessage = useToastMessageDispatch();
  var ref = useAutoFocus();

  var handleName = function (e) {
    setName(e.currentTarget.value);
  };

  var handleDescription = function (e) {
    setDescription(e.currentTarget.value);
  };

  var handleSubmit = function (e) {
    e.preventDefault();

    if (!name) {
      return dispatchToastMessage({
        type: 'error',
        message: t('error-the-field-is-required', {
          field: t('Name')
        })
      });
    }

    onSubmit(name, description);
  };

  useEffect(function () {
    if (invalidContentType) {
      dispatchToastMessage({
        type: 'error',
        message: t('FileUpload_MediaType_NotAccepted__type__', {
          type: file.type
        })
      });
      onClose();
      return;
    }

    if (file.size === 0) {
      dispatchToastMessage({
        type: 'error',
        message: t('FileUpload_File_Empty')
      });
      onClose();
    }
  }, [file, dispatchToastMessage, invalidContentType, t, onClose]);
  return /*#__PURE__*/React.createElement(Modal, null, /*#__PURE__*/React.createElement(Box, {
    is: "form",
    display: "flex",
    flexDirection: "column",
    height: "100%",
    onSubmit: handleSubmit
  }, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, null, t('FileUpload')), /*#__PURE__*/React.createElement(Modal.Close, {
    onClick: onClose
  })), /*#__PURE__*/React.createElement(Modal.Content, {
    overflow: "hidden"
  }, /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    maxHeight: "x360",
    w: "full",
    justifyContent: "center",
    alignContent: "center",
    mbe: "x16"
  }, /*#__PURE__*/React.createElement(FilePreview, {
    file: file
  })), /*#__PURE__*/React.createElement(FieldGroup, null, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Upload_file_name')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {
    value: name,
    onChange: handleName
  })), !name && /*#__PURE__*/React.createElement(Field.Error, null, t('error-the-field-is-required', {
    field: t('Name')
  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Upload_file_description')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {
    value: description,
    onChange: handleDescription,
    placeholder: t('Description'),
    ref: ref
  }))))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(ButtonGroup, {
    align: "end"
  }, /*#__PURE__*/React.createElement(Button, {
    ghost: true,
    onClick: onClose
  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {
    primary: true,
    type: "submit",
    disabled: !name
  }, t('Send'))))));
};

module.exportDefault( /*#__PURE__*/memo(FileUploadModal));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"GenericPreview.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/GenericPreview.tsx                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Box, Icon;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  Icon: function (v) {
    Icon = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);
var formatBytes;
module.link("../../../../lib/utils/formatBytes", {
  formatBytes: function (v) {
    formatBytes = v;
  }
}, 2);

var GenericPreview = function (_ref) {
  var file = _ref.file;
  return /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    alignItems: "center",
    w: "full",
    fontScale: "h4"
  }, /*#__PURE__*/React.createElement(Icon, {
    name: "file",
    size: "x24",
    mis: -2,
    mie: 4
  }), file.name + " - " + formatBytes(file.size, 2));
};

module.exportDefault(GenericPreview);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ImagePreview.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/ImagePreview.tsx                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 0);
var React, useState;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useState: function (v) {
    useState = v;
  }
}, 1);
var GenericPreview;
module.link("./GenericPreview", {
  "default": function (v) {
    GenericPreview = v;
  }
}, 2);
var PreviewSkeleton;
module.link("./PreviewSkeleton", {
  "default": function (v) {
    PreviewSkeleton = v;
  }
}, 3);

var ImagePreview = function (_ref) {
  var url = _ref.url,
      file = _ref.file;

  var _useState = useState(false),
      _useState2 = _slicedToArray(_useState, 2),
      error = _useState2[0],
      setError = _useState2[1];

  var _useState3 = useState(true),
      _useState4 = _slicedToArray(_useState3, 2),
      loading = _useState4[0],
      setLoading = _useState4[1];

  var handleLoad = function () {
    return setLoading(false);
  };

  var handleError = function () {
    setLoading(false);
    setError(true);
  };

  if (error) {
    return /*#__PURE__*/React.createElement(GenericPreview, {
      file: file
    });
  }

  return /*#__PURE__*/React.createElement(React.Fragment, null, loading && /*#__PURE__*/React.createElement(PreviewSkeleton, null), /*#__PURE__*/React.createElement(Box, {
    is: "img",
    src: url,
    maxWidth: "full",
    style: {
      objectFit: 'contain'
    },
    onLoad: handleLoad,
    onError: handleError,
    display: loading ? 'none' : 'initial'
  }));
};

module.exportDefault(ImagePreview);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"MediaPreview.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/MediaPreview.tsx                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Box, Icon;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  Icon: function (v) {
    Icon = v;
  }
}, 0);
var React, useEffect, useState, memo;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useEffect: function (v) {
    useEffect = v;
  },
  useState: function (v) {
    useState = v;
  },
  memo: function (v) {
    memo = v;
  }
}, 1);
var useTranslation;
module.link("../../../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 2);
var FilePreviewType;
module.link("./FilePreview", {
  FilePreviewType: function (v) {
    FilePreviewType = v;
  }
}, 3);
var ImagePreview;
module.link("./ImagePreview", {
  "default": function (v) {
    ImagePreview = v;
  }
}, 4);
var PreviewSkeleton;
module.link("./PreviewSkeleton", {
  "default": function (v) {
    PreviewSkeleton = v;
  }
}, 5);

var readFileAsDataURL = function (file, callback) {
  var reader = new FileReader();

  reader.onload = function (e) {
    var _e$target;

    return callback((e === null || e === void 0 ? void 0 : (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.result) || null);
  };

  return reader.readAsDataURL(file);
};

var useFileAsDataURL = function (file) {
  var _useState = useState(false),
      _useState2 = _slicedToArray(_useState, 2),
      loaded = _useState2[0],
      setLoaded = _useState2[1];

  var _useState3 = useState(null),
      _useState4 = _slicedToArray(_useState3, 2),
      url = _useState4[0],
      setUrl = _useState4[1];

  useEffect(function () {
    setLoaded(false);
    readFileAsDataURL(file, function (url) {
      setUrl(url);
      setLoaded(true);
    });
  }, [file]);
  return [loaded, url];
};

var MediaPreview = function (_ref) {
  var file = _ref.file,
      fileType = _ref.fileType;

  var _useFileAsDataURL = useFileAsDataURL(file),
      _useFileAsDataURL2 = _slicedToArray(_useFileAsDataURL, 2),
      loaded = _useFileAsDataURL2[0],
      url = _useFileAsDataURL2[1];

  var t = useTranslation();

  if (!loaded) {
    return /*#__PURE__*/React.createElement(PreviewSkeleton, null);
  }

  if (typeof url !== 'string') {
    return /*#__PURE__*/React.createElement(Box, {
      display: "flex",
      alignItems: "center",
      w: "full"
    }, /*#__PURE__*/React.createElement(Icon, {
      name: "image",
      size: "x24",
      mie: "x4"
    }), t('FileUpload_Cannot_preview_file'));
  }

  if (fileType === FilePreviewType.IMAGE) {
    return /*#__PURE__*/React.createElement(ImagePreview, {
      url: url,
      file: file
    });
  }

  if (fileType === FilePreviewType.VIDEO) {
    return /*#__PURE__*/React.createElement(Box, {
      is: "video",
      w: "full",
      controls: true
    }, /*#__PURE__*/React.createElement("source", {
      src: url,
      type: file.type
    }), t('Browser_does_not_support_video_element'));
  }

  if (fileType === FilePreviewType.AUDIO) {
    return /*#__PURE__*/React.createElement(Box, {
      is: "audio",
      w: "full",
      controls: true
    }, /*#__PURE__*/React.createElement("source", {
      src: url,
      type: file.type
    }), t('Browser_does_not_support_audio_element'));
  }

  throw new Error('Wrong props provided for MediaPreview');
};

module.exportDefault( /*#__PURE__*/memo(MediaPreview));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"PreviewSkeleton.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/PreviewSkeleton.tsx                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Skeleton;
module.link("@rocket.chat/fuselage", {
  Skeleton: function (v) {
    Skeleton = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var PreviewSkeleton = function () {
  return /*#__PURE__*/React.createElement(Skeleton, {
    variant: "rect",
    w: "full",
    h: "x200"
  });
};

module.exportDefault(PreviewSkeleton);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/FileUploadModal/index.ts                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./FileUploadModal", {
  "default": "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ReactionListModal":{"ReactionListModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReactionListModal/ReactionListModal.tsx                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMutableCallback;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback: function (v) {
    useMutableCallback = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);
var openUserCard;
module.link("../../../../../app/ui/client/lib/UserCard", {
  openUserCard: function (v) {
    openUserCard = v;
  }
}, 2);
var GenericModal;
module.link("../../../../components/GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 3);
var useTranslation;
module.link("../../../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 4);
var Reactions;
module.link("./Reactions", {
  "default": function (v) {
    Reactions = v;
  }
}, 5);

var ReactionList = function (_ref) {
  var rid = _ref.rid,
      reactions = _ref.reactions,
      tabBar = _ref.tabBar,
      onClose = _ref.onClose;
  var t = useTranslation();
  var onClick = useMutableCallback(function (e) {
    var username = e.currentTarget.dataset.username;

    if (!username) {
      return;
    }

    openUserCard({
      username: username,
      rid: rid,
      target: e.currentTarget,
      open: function (e) {
        e.preventDefault();
        onClose();
        tabBar.openUserInfo(username);
      }
    });
  });
  return /*#__PURE__*/React.createElement(GenericModal, {
    variant: "info",
    title: t('Users_reacted'),
    onClose: onClose,
    onConfirm: onClose
  }, /*#__PURE__*/React.createElement(Reactions, {
    reactions: reactions,
    onClick: onClick
  }));
};

module.exportDefault(ReactionList);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ReactionUserTag.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReactionListModal/ReactionUserTag.tsx                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Box, Tag;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  Tag: function (v) {
    Tag = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var ReactionUserTag = function (_ref) {
  var username = _ref.username,
      onClick = _ref.onClick,
      displayName = _ref.displayName;
  return /*#__PURE__*/React.createElement(Box, {
    mie: "x4",
    mbe: "x4",
    "data-username": username,
    onClick: onClick,
    key: displayName
  }, /*#__PURE__*/React.createElement(Tag, {
    variant: "secondary"
  }, displayName));
};

module.exportDefault(ReactionUserTag);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Reactions.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReactionListModal/Reactions.tsx                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);
var Emoji;
module.link("../../../../components/Emoji", {
  "default": function (v) {
    Emoji = v;
  }
}, 2);
var useSetting;
module.link("../../../../contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 3);
var ReactionUserTag;
module.link("./ReactionUserTag", {
  "default": function (v) {
    ReactionUserTag = v;
  }
}, 4);

var Reactions = function (_ref) {
  var reactions = _ref.reactions,
      onClick = _ref.onClick;
  var useRealName = useSetting('UI_Use_Real_Name');
  return /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    flexDirection: "column"
  }, Object.entries(reactions).map(function (_ref2) {
    var _ref3 = _slicedToArray(_ref2, 2),
        reaction = _ref3[0],
        _ref3$ = _ref3[1],
        _ref3$$names = _ref3$.names,
        names = _ref3$$names === void 0 ? [] : _ref3$$names,
        usernames = _ref3$.usernames;

    return /*#__PURE__*/React.createElement(Box, {
      key: reaction,
      display: "flex",
      alignItems: "center",
      flexDirection: "row",
      overflowX: "hidden",
      mb: "x8"
    }, /*#__PURE__*/React.createElement(Emoji, {
      emojiHandle: reaction
    }), /*#__PURE__*/React.createElement(Box, {
      display: "flex",
      flexWrap: "wrap",
      paddingBlock: "x4",
      mis: "x4"
    }, usernames.map(function (username, i) {
      return /*#__PURE__*/React.createElement(ReactionUserTag, {
        key: username,
        displayName: useRealName ? names[i] || username : username,
        username: username,
        onClick: onClick
      });
    })));
  }));
};

module.exportDefault(Reactions);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReactionListModal/index.ts                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./ReactionListModal", {
  "default": "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"ReadReceiptsModal":{"ReadReceiptRow.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReadReceiptsModal/ReadReceiptRow.tsx                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _templateObject;

var _taggedTemplateLiteralLoose;

module.link("@babel/runtime/helpers/taggedTemplateLiteralLoose", {
  default: function (v) {
    _taggedTemplateLiteralLoose = v;
  }
}, 0);
var css;
module.link("@rocket.chat/css-in-js", {
  css: function (v) {
    css = v;
  }
}, 0);
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 1);
var colors;
module.link("@rocket.chat/fuselage-tokens/colors", {
  "default": function (v) {
    colors = v;
  }
}, 2);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 3);
var UserAvatar;
module.link("../../../../components/avatar/UserAvatar", {
  "default": function (v) {
    UserAvatar = v;
  }
}, 4);
var useFormatDateAndTime;
module.link("../../../../hooks/useFormatDateAndTime", {
  useFormatDateAndTime: function (v) {
    useFormatDateAndTime = v;
  }
}, 5);
var useUserDisplayName;
module.link("../../../../hooks/useUserDisplayName", {
  useUserDisplayName: function (v) {
    useUserDisplayName = v;
  }
}, 6);
var hoverStyle = css(_templateObject || (_templateObject = _taggedTemplateLiteralLoose(["\n\t&:hover {\n\t\tbackground-color: ", ";\n\t}\n"])), colors.n400);

var ReadReceiptRow = function (_ref) {
  var user = _ref.user,
      ts = _ref.ts;
  var displayName = useUserDisplayName(user);
  var formatDateAndTime = useFormatDateAndTime();
  return /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    flexDirection: "row",
    justifyContent: "space-between",
    alignItems: "center",
    p: "x4",
    pi: "x32",
    mi: "neg-x32",
    className: hoverStyle
  }, /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(UserAvatar, {
    username: user.username || '',
    size: "x24"
  }), /*#__PURE__*/React.createElement(Box, {
    is: "span",
    mis: "x8"
  }, displayName)), /*#__PURE__*/React.createElement(Box, {
    is: "span",
    fontScale: "c1",
    color: "info"
  }, formatDateAndTime(ts)));
};

module.exportDefault(ReadReceiptRow);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ReadReceiptsModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReadReceiptsModal/ReadReceiptsModal.tsx                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var Skeleton;
module.link("@rocket.chat/fuselage", {
  Skeleton: function (v) {
    Skeleton = v;
  }
}, 0);
var React, useMemo, useEffect;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useMemo: function (v) {
    useMemo = v;
  },
  useEffect: function (v) {
    useEffect = v;
  }
}, 1);
var GenericModal;
module.link("../../../../components/GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 2);
var useToastMessageDispatch;
module.link("../../../../contexts/ToastMessagesContext", {
  useToastMessageDispatch: function (v) {
    useToastMessageDispatch = v;
  }
}, 3);
var useTranslation;
module.link("../../../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 4);
var useMethodData;
module.link("../../../../hooks/useMethodData", {
  useMethodData: function (v) {
    useMethodData = v;
  }
}, 5);
var AsyncStatePhase;
module.link("../../../../lib/asyncState", {
  AsyncStatePhase: function (v) {
    AsyncStatePhase = v;
  }
}, 6);
var ReadReceiptRow;
module.link("./ReadReceiptRow", {
  "default": function (v) {
    ReadReceiptRow = v;
  }
}, 7);

var ReadReceiptsModal = function (_ref) {
  var messageId = _ref.messageId,
      onClose = _ref.onClose;
  var t = useTranslation();
  var dispatchToastMessage = useToastMessageDispatch();

  var _useMethodData = useMethodData('getReadReceipts', useMemo(function () {
    return [{
      messageId: messageId
    }];
  }, [messageId])),
      phase = _useMethodData.phase,
      value = _useMethodData.value,
      error = _useMethodData.error;

  useEffect(function () {
    if (error) {
      dispatchToastMessage({
        type: 'error',
        message: error
      });
      onClose();
    }
  }, [error, dispatchToastMessage, t, onClose]);

  if (phase === AsyncStatePhase.LOADING || !value || error) {
    return /*#__PURE__*/React.createElement(GenericModal, {
      title: t('Read_by'),
      onConfirm: onClose,
      onClose: onClose
    }, /*#__PURE__*/React.createElement(Skeleton, {
      type: "rect",
      w: "full",
      h: "x120"
    }));
  }

  return /*#__PURE__*/React.createElement(GenericModal, {
    title: t('Read_by'),
    onConfirm: onClose,
    onClose: onClose
  }, value.length < 1 && t('No_results_found'), value.map(function (receipt) {
    return /*#__PURE__*/React.createElement(ReadReceiptRow, _extends({}, receipt, {
      key: receipt._id
    }));
  }));
};

module.exportDefault(ReadReceiptsModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/room/modals/ReadReceiptsModal/index.ts                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./ReadReceiptsModal", {
  "default": "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"Announcement":{"Announcement.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/MarkdownText",
  "../../../contexts/ModalContext",
  "./AnnouncementComponent",
  "./AnnouncementModal"
],"AnnouncementComponent.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react"
],"AnnouncementModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/MarkdownText",
  "../../../contexts/TranslationContext"
],"index.tsx":[
  "./Announcement"
]},"UserCard":{"index.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Backdrop",
  "../../../components/LocalTime",
  "../../../components/UserCard",
  "../../../components/UserStatus",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../../hooks/useActionSpread",
  "../hooks/useUserInfoActions"
]},"contexts":{"RoomContext.ts":[
  "react",
  "../../../../definition/IRoom"
]},"hooks":{"useAppsContextualBar.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../app/apps/client/orchestrator",
  "../../../../app/ui-message/client/ActionManager",
  "../../../contexts/RouterContext",
  "../contexts/RoomContext"
],"useUserInfoActions.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/string-helpers",
  "react",
  "../../../../app/models/client",
  "../../../../app/utils/client",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useEndpointActionExperimental",
  "../../../hooks/useReactiveValue",
  "../../teams/contextualBar/members/RemoveUsersModal",
  "./useUserRoom",
  "./useWebRTC"
],"useUserRoom.js":[
  "react",
  "../../../../app/models/client",
  "../../../hooks/useReactiveValue"
],"useWebRTC.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../app/webrtc/client"
]},"providers":{"RoomProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../../app/ui",
  "../../../../app/utils/client",
  "../../../contexts/UserContext",
  "../../../lib/RoomManager",
  "../../../lib/asyncState",
  "../Room/Skeleton",
  "../contexts/RoomContext",
  "./ToolboxProvider"
],"ToolboxProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/SessionContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/UserContext",
  "../lib/Toolbox/ToolboxContext",
  "./VirtualAction"
],"VirtualAction.tsx":[
  "react"
]},"threads":{"ThreadComponent.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "meteor/blaze",
  "meteor/templating",
  "meteor/tracker",
  "react",
  "../../../../app/models/client",
  "../../../../app/threads/client/lib/normalizeThreadTitle",
  "../../../../app/utils/client",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/UserContext",
  "../../../lib/utils/mapMessageFromApi",
  "../providers/ToolboxProvider",
  "./ThreadSkeleton",
  "./ThreadView"
],"ThreadSkeleton.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar"
],"ThreadView.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/TranslationContext",
  "../../../providers/LayoutProvider"
]},"webdav":{"AddWebdavAccountModal.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "react-hook-form",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
]},"MemberListRouter.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "../../contexts/UserContext",
  "./contexts/RoomContext",
  "./contextualBar/RoomMembers",
  "./contextualBar/UserInfo",
  "./providers/ToolboxProvider"
]},"admin":{"apps":{"lib":{"getManifestFromZippedApp.ts":[
  "@babel/runtime/regenerator",
  "fflate"
]},"components":{"CategoryDropDown.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react",
  "./CategoryDropDownAnchor",
  "./CategoryDropDownList",
  "./CategoryDropDownListWrapper"
],"CategoryDropDownAnchor.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"CategoryDropDownList.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"CategoryDropDownListWrapper.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react"
],"TagList.tsx":[
  "@rocket.chat/fuselage",
  "react"
]},"helpers":{"filterAppByCategories.ts":[],"filterAppByText.ts":[]},"hooks":{"useAppInfo.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/regenerator",
  "react",
  "../../../../../app/apps/client/orchestrator",
  "../AppsContext",
  "../helpers"
],"useCategories.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../../app/apps/client/orchestrator",
  "../../../../contexts/TranslationContext",
  "../helpers",
  "./useCategoryFlatList",
  "./useCategoryToggle"
],"useCategoryFlatList.ts":[
  "react"
],"useCategoryToggle.ts":[
  "@babel/runtime/helpers/toConsumableArray",
  "react"
],"useFilteredApps.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../../../lib/asyncState",
  "../helpers/filterAppByCategories",
  "../helpers/filterAppByText"
]},"APIsDisplay.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "./helpers"
],"AppDetailsPage.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/apps/client/orchestrator",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./APIsDisplay",
  "./AppDetailsPageContent",
  "./LoadingDetails",
  "./SettingsDisplay",
  "./helpers",
  "./hooks/useAppInfo"
],"AppDetailsPageContent.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/ExternalLink",
  "../../../components/avatar/AppAvatar",
  "../../../contexts/TranslationContext",
  "./AppMenu",
  "./AppStatus",
  "./PriceDisplay"
],"AppInstallPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/apps/client/orchestrator",
  "../../../components/Page",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFileInput",
  "../../../hooks/useForm",
  "./AppPermissionsReviewModal",
  "./AppUpdateModal",
  "./helpers",
  "./lib/getManifestFromZippedApp"
],"AppLogsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime",
  "./LogItem",
  "./LogsLoading"
],"AppMenu.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "./CloudLoginModal",
  "./IframeModal",
  "./WarningModal",
  "./helpers"
],"AppPermissionsReviewModal.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"AppRow.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/avatar/AppAvatar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./AppMenu",
  "./AppStatus"
],"AppSetting.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/MarkdownText",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../settings/MemoizedSetting"
],"AppSettingsAssembler.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/string-helpers",
  "react",
  "./AppSetting"
],"AppStatus.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/apps/client/orchestrator",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "./AppPermissionsReviewModal",
  "./CloudLoginModal",
  "./IframeModal",
  "./helpers"
],"AppUpdateModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"AppsContext.tsx":[
  "react",
  "../../../lib/asyncState"
],"AppsPage.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "./AppsTable"
],"AppsProvider.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/createForOfIteratorHelperLoose",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/apps/client/communication",
  "../../../../app/apps/client/orchestrator",
  "../../../lib/asyncState",
  "./AppsContext",
  "./helpers"
],"AppsRoute.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/PageSkeleton",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "./AppDetailsPage",
  "./AppInstallPage",
  "./AppLogsPage",
  "./AppsPage",
  "./AppsProvider"
],"AppsTable.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/GenericTable/hooks/usePagination",
  "../../../components/GenericTable/hooks/useSort",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useResizeInlineBreakpoint",
  "../../../lib/asyncState",
  "./AppRow",
  "./AppsContext",
  "./MarketplaceRow",
  "./components/CategoryDropDown",
  "./components/TagList",
  "./hooks/useCategories",
  "./hooks/useFilteredApps"
],"AppsWhatIsIt.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/apps/client",
  "../../../components/ExternalLink",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext"
],"CloudLoginModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext"
],"IframeModal.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"LoadingDetails.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"LogEntry.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useHighlightedCode"
],"LogItem.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "./LogEntry"
],"LogsLoading.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"MarketplaceRow.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/avatar/AppAvatar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./AppMenu",
  "./AppStatus",
  "./PriceDisplay"
],"PriceDisplay.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "./helpers"
],"SettingsDisplay.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./AppSettingsAssembler"
],"WarningModal.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"helpers.js":[
  "@rocket.chat/apps-engine/definition/AppStatus",
  "semver",
  "../../../../app/apps/lib/misc/Utilities",
  "../../../../app/utils/client",
  "../../../lib/toast"
]},"info":{"FederationCard":{"components":{"FederationModal":{"DNSRecordItem.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../Section",
  "../SectionStatusIcon"
],"DNSRecords.tsx":[
  "@rocket.chat/fuselage",
  "lodash",
  "react",
  "../../../../../../contexts/TranslationContext",
  "../Section",
  "./DNSRecordItem",
  "./DNSText",
  "./Types"
],"DNSText.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"FederationModal.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "psl",
  "react",
  "../../../../../../contexts/SettingsContext",
  "../../../../../../contexts/TranslationContext",
  "../../../../../../hooks/useForm",
  "./DNSRecords",
  "./InviteUsers",
  "./Types"
],"InviteUsers.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../contexts/RouterContext",
  "../../../../../../contexts/TranslationContext"
],"Types.ts":[],"index.ts":[
  "./FederationModal"
]},"CardHeader.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Section.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/Card",
  "./SectionStatusIcon"
],"SectionStatusIcon.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./Section"
],"index.ts":[
  "./CardHeader",
  "./Section"
]},"FederationCard.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/Card",
  "../../../../contexts/ModalContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/TranslationContext",
  "../../../../providers/SettingsProvider",
  "./components",
  "./components/FederationModal",
  "./components/Section"
],"index.ts":[
  "./FederationCard"
]},"DeploymentCard.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Card",
  "../../../contexts/ModalContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime",
  "./InstancesModal"
],"DescriptionList.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./DescriptionListEntry"
],"DescriptionListEntry.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"Feature.js":[
  "@rocket.chat/fuselage",
  "react"
],"InformationPage.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../ee/client/views/admin/info/SeatsCard",
  "../../../components/Card",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./DeploymentCard",
  "./FederationCard",
  "./LicenseCard",
  "./UsageCard"
],"InformationRoute.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../lib/download",
  "./InformationPage"
],"InstancesModal.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime",
  "./DescriptionList"
],"LicenseCard.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Card",
  "../../../components/PlanTag",
  "../../../contexts/ModalContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./Feature",
  "./OfflineLicenseModal"
],"OfflineLicenseModal.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointActionExperimental"
],"TextSeparator.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/DotLeader"
],"UsageCard.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../ee/client/hooks/useHasLicense",
  "../../../components/Card",
  "../../../components/UserStatus",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatMemorySize",
  "./TextSeparator"
],"UsagePieGraph.tsx":[
  "@nivo/pie",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../hooks/useLocalePercentage"
]},"integrations":{"edit":{"EditIncomingWebhook.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/ModalContext",
  "../../../../contexts/RouterContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointAction",
  "../../../../hooks/useForm",
  "../IncomingWebhookForm"
],"EditIncomingWebhookWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./EditIncomingWebhook"
],"EditIntegrationsPage.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/Page",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "./EditIncomingWebhookWithData",
  "./EditOutgoingWebhookWithData"
],"EditOutgoingWebhook.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/ModalContext",
  "../../../../contexts/RouterContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointAction",
  "../../../../hooks/useForm",
  "../OutgoiongWebhookForm",
  "../helpers/triggerWords"
],"EditOutgoingWebhookWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./EditOutgoingWebhook"
],"HistoryContent.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "./HistoryItem"
],"HistoryItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/integrations/lib/rocketchat",
  "../../../../contexts/ServerContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useFormatDateAndTime",
  "../../../../hooks/useHighlightedCode"
],"OutgoingWebhookHistoryPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/integrations/client/streamer",
  "../../../../components/Page",
  "../../../../contexts/RouterContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./HistoryContent"
]},"helpers":{"triggerWords.ts":[]},"new":{"NewBot.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext"
],"NewIncomingWebhook.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointAction",
  "../../../../hooks/useForm",
  "../IncomingWebhookForm"
],"NewIntegrationsPage.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/Page",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "./NewIncomingWebhook",
  "./NewOutgoingWebhook"
],"NewOutgoingWebhook.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointAction",
  "../../../../hooks/useForm",
  "../OutgoiongWebhookForm",
  "../helpers/triggerWords"
],"NewZapier.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext"
]},"FilterByTypeAndText.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"IncomingWebhookForm.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useHighlightedCode",
  "./exampleIncomingData"
],"IntegrationRow.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../hooks/useFormatDateAndTime"
],"IntegrationsPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./IntegrationsTable",
  "./new/NewBot",
  "./new/NewZapier"
],"IntegrationsRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "./IntegrationsPage",
  "./edit/EditIntegrationsPage",
  "./edit/OutgoingWebhookHistoryPage",
  "./new/NewIntegrationsPage"
],"IntegrationsTable.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./FilterByTypeAndText",
  "./IntegrationRow"
],"OutgoiongWebhookForm.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/integrations/lib/rocketchat",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "../../../hooks/useHighlightedCode",
  "./exampleIncomingData"
],"exampleIncomingData.js":[
  "@babel/runtime/helpers/objectSpread2",
  "react"
]},"permissions":{"hooks":{"usePermissionsAndRoles.ts":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/authorization/client/lib/ChatPermissions",
  "../../../../../app/authorization/lib",
  "../../../../../app/models/client",
  "../../../../hooks/useReactiveValue"
]},"EditRolePage.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./RoleForm"
],"EditRolePageContainer.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "./EditRolePage",
  "./useRole"
],"FilterComponent.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"NewRolePage.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./RoleForm"
],"PermissionRow.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/authorization/lib",
  "../../../contexts/ToastMessagesContext",
  "./RoleCell"
],"PermissionsContextBar.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./EditRolePageContainer",
  "./NewRolePage"
],"PermissionsRouter.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "./PermissionsTable",
  "./UsersInRolePageContainer"
],"PermissionsTable.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/Page",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "./FilterComponent",
  "./PermissionRow",
  "./PermissionsContextBar",
  "./RoleHeader",
  "./hooks/usePermissionsAndRoles"
],"RoleCell.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/authorization/lib"
],"RoleForm.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"RoleHeader.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable"
],"UserRow.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../lib/getUserEmailAddress",
  "../../../components/avatar/UserAvatar"
],"UsersInRolePage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../components/RoomAutoComplete",
  "../../../components/UserAutoComplete",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./UsersInRoleTableContainer"
],"UsersInRolePageContainer.js":[
  "react",
  "../../../contexts/RouterContext",
  "./UsersInRolePage",
  "./useRole"
],"UsersInRoleTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../components/GenericTable",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./UserRow"
],"UsersInRoleTableContainer.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../hooks/useEndpointData",
  "./UsersInRoleTable"
],"useRole.js":[
  "react",
  "../../../../app/models/client",
  "../../../hooks/useReactiveValue"
]},"settings":{"groups":{"AssetsGroupPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/EditableSettingsContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../GroupPage",
  "../Section"
],"GenericGroupPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../contexts/EditableSettingsContext",
  "../GroupPage",
  "../Section"
],"LDAPGroupPage.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/EditableSettingsContext",
  "../../../../contexts/ModalContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "./TabbedGroupPage"
],"OAuthGroupPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "underscore.string",
  "../../../../contexts/EditableSettingsContext",
  "../../../../contexts/ModalContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../GroupPage",
  "../Section"
],"TabbedGroupPage.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/EditableSettingsContext",
  "../../../../contexts/TranslationContext",
  "../GroupPage",
  "../Section",
  "./GenericGroupPage"
]},"inputs":{"ActionSettingInput.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext"
],"AssetSettingInput.css":[],"AssetSettingInput.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "meteor/random",
  "react",
  "../../../../contexts/ServerContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "./AssetSettingInput.css"
],"BooleanSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
],"CodeMirror.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react"
],"CodeSettingInput.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../contexts/TranslationContext",
  "../ResetSettingButton",
  "./CodeMirror"
],"ColorSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../ResetSettingButton"
],"FontSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
],"GenericSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
],"IntSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
],"LanguageSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../ResetSettingButton"
],"MultiSelectSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../ResetSettingButton"
],"PasswordSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
],"RelativeUrlSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/ServerContext",
  "../ResetSettingButton"
],"RoomPickSettingInput.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@rocket.chat/fuselage",
  "meteor/blaze",
  "meteor/templating",
  "react",
  "../ResetSettingButton"
],"SelectSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../ResetSettingButton"
],"SelectTimezoneSettingInput.js":[
  "@rocket.chat/fuselage",
  "moment-timezone",
  "react",
  "../ResetSettingButton"
],"StringSettingInput.js":[
  "@rocket.chat/fuselage",
  "react",
  "../ResetSettingButton"
]},"GroupPage.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/EditableSettingsContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "./GroupPageSkeleton"
],"GroupPageSkeleton.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./Section"
],"GroupSelector.tsx":[
  "react",
  "../../../contexts/SettingsContext",
  "./GroupPage",
  "./groups/AssetsGroupPage",
  "./groups/LDAPGroupPage",
  "./groups/OAuthGroupPage",
  "./groups/TabbedGroupPage"
],"MemoizedSetting.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./inputs/ActionSettingInput",
  "./inputs/AssetSettingInput",
  "./inputs/BooleanSettingInput",
  "./inputs/CodeSettingInput",
  "./inputs/ColorSettingInput",
  "./inputs/FontSettingInput",
  "./inputs/GenericSettingInput",
  "./inputs/IntSettingInput",
  "./inputs/LanguageSettingInput",
  "./inputs/MultiSelectSettingInput",
  "./inputs/PasswordSettingInput",
  "./inputs/RelativeUrlSettingInput",
  "./inputs/RoomPickSettingInput",
  "./inputs/SelectSettingInput",
  "./inputs/SelectTimezoneSettingInput",
  "./inputs/StringSettingInput"
],"ResetSettingButton.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"Section.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/EditableSettingsContext",
  "../../../contexts/TranslationContext",
  "./SectionSkeleton",
  "./Setting"
],"SectionSkeleton.js":[
  "@rocket.chat/fuselage",
  "react",
  "./Setting"
],"Setting.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/MarkdownText",
  "../../../contexts/EditableSettingsContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "./MemoizedSetting",
  "./SettingSkeleton"
],"SettingSkeleton.js":[
  "@rocket.chat/fuselage",
  "react"
],"SettingsRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/RouterContext",
  "../../../contexts/SettingsContext",
  "../../../providers/EditableSettingsProvider",
  "./GroupSelector"
]},"cloud":{"CloudPage.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./ConnectToCloudSection",
  "./ManualWorkspaceRegistrationModal",
  "./TroubleshootingSection",
  "./WhatIsItSection",
  "./WorkspaceLoginSection",
  "./WorkspaceRegistrationSection",
  "./constants"
],"CloudRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./CloudPage"
],"ConnectToCloudSection.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Subtitle",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"CopyStep.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "clipboard",
  "react",
  "../../../components/MarkdownText",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./constants"
],"ManualWorkspaceRegistrationModal.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "./CopyStep",
  "./PasteStep"
],"PasteStep.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"TroubleshootingSection.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Subtitle",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./constants"
],"WhatIsItSection.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Subtitle",
  "../../../contexts/TranslationContext"
],"WorkspaceLoginSection.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"WorkspaceRegistrationSection.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"constants.js":[]},"customEmoji":{"AddCustomEmoji.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointUpload",
  "../../../hooks/useFileInput"
],"CustomEmoji.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/GenericTable/hooks/usePagination",
  "../../../components/GenericTable/hooks/useSort",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../../../lib/asyncState"
],"CustomEmojiRoute.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./AddCustomEmoji",
  "./CustomEmoji",
  "./EditCustomEmojiWithData"
],"EditCustomEmoji.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction",
  "../../../hooks/useEndpointUpload",
  "../../../hooks/useFileInput"
],"EditCustomEmojiWithData.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditCustomEmoji"
]},"customSounds":{"AddCustomSound.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFileInput",
  "./lib"
],"AdminSounds.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../contexts/CustomSoundContext",
  "../../../contexts/TranslationContext"
],"AdminSoundsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./AddCustomSound",
  "./AdminSounds",
  "./EditCustomSound"
],"EditCustomSound.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditSound"
],"EditSound.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFileInput",
  "./lib"
],"lib.js":[]},"customUserStatus":{"AddCustomUserStatus.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"CustomUserStatus.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/MarkdownText",
  "../../../contexts/TranslationContext"
],"CustomUserStatusRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./AddCustomUserStatus",
  "./CustomUserStatus",
  "./EditCustomUserStatusWithData"
],"EditCustomUserStatus.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"EditCustomUserStatusWithData.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditCustomUserStatus"
]},"emailInbox":{"EmailInboxEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EmailInboxForm",
  "./Skeleton"
],"EmailInboxForm.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../lib/emailValidator",
  "../../../components/AutoCompleteDepartment",
  "../../../components/GenericModal",
  "../../../components/Page",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useComponentDidUpdate",
  "../../../hooks/useForm"
],"EmailInboxPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./EmailInboxEditWithData",
  "./EmailInboxForm",
  "./EmailInboxTable"
],"EmailInboxRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./EmailInboxPage"
],"EmailInboxTable.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./SendTestButton"
],"SendTestButton.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"Skeleton.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
]},"federationDashboard":{"FederationDashboardPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./OverviewSection",
  "./ServersSection"
],"FederationDashboardRoute.tsx":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./FederationDashboardPage"
],"OverviewSection.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/data/CounterSet",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/usePolledMethodData"
],"ServersSection.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../hooks/useAsyncState",
  "../../../hooks/usePolledMethodData"
]},"import":{"ImportHistoryPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/importer/lib/ImporterProgressStep",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./ImportOperationSummary"
],"ImportOperationSummary.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/importer/lib/ImporterProgressStep",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime",
  "./ImportOperationSummarySkeleton"
],"ImportOperationSummarySkeleton.js":[
  "@rocket.chat/fuselage",
  "react"
],"ImportProgressPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "react",
  "underscore.string",
  "../../../../app/importer/lib/ImporterProgressStep",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./useErrorHandler"
],"ImportRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./ImportHistoryPage",
  "./ImportProgressPage",
  "./NewImportPage",
  "./PrepareImportPage"
],"NewImportPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/importer/client/index",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatMemorySize",
  "./useErrorHandler"
],"PrepareChannels.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"PrepareImportPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "react",
  "underscore.string",
  "../../../../app/importer/lib/ImporterProgressStep",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "./PrepareChannels",
  "./PrepareUsers",
  "./useErrorHandler"
],"PrepareUsers.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"useErrorHandler.js":[
  "@rocket.chat/fuselage-hooks",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
]},"invites":{"InviteRow.tsx":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime",
  "../../../hooks/useTimeFromNow"
],"InvitesPage.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../components/GenericTable",
  "../../../components/Page",
  "../../../contexts/ModalContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../../../lib/asyncState",
  "./InviteRow"
],"InvitesRoute.tsx":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./InvitesPage"
]},"mailer":{"Mailer.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../lib/emailValidator",
  "../../../../lib/utils/isJSON",
  "../../../components/Page",
  "../../../contexts/TranslationContext"
],"MailerRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./Mailer"
]},"oauthApps":{"EditOauthApp.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"EditOauthAppWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditOauthApp"
],"OAuthAddApp.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"OAuthAppsPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./EditOauthAppWithData",
  "./OAuthAddApp",
  "./OAuthAppsTable"
],"OAuthAppsRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./OAuthAppsPage"
],"OAuthAppsTable.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../../../hooks/useFormatDateAndTime"
]},"rooms":{"EditRoom.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/utils/client",
  "../../../components/GenericModal",
  "../../../components/VerticalBar",
  "../../../components/avatar/RoomAvatarEditor",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointActionExperimental",
  "../../../hooks/useForm"
],"EditRoomContextBar.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./EditRoomWithData"
],"EditRoomWithData.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditRoom"
],"FilterByTypeAndText.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"RoomsPage.js":[
  "react",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./EditRoomContextBar",
  "./RoomsTable"
],"RoomsRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./RoomsPage"
],"RoomsTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/utils/client",
  "../../../components/GenericTable",
  "../../../components/avatar/RoomAvatar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../../../lib/asyncState",
  "./FilterByTypeAndText"
]},"sidebar":{"AdminSidebar.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/toConsumableArray",
  "react",
  "../../../../app/ui-utils/client",
  "../../../components/PlanTag",
  "../../../components/Sidebar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../lib/utils/isLayoutEmbedded",
  "../../../providers/SettingsProvider",
  "./AdminSidebarPages",
  "./AdminSidebarSettings"
],"AdminSidebarPages.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "use-subscription",
  "../../../components/Sidebar",
  "../sidebarItems"
],"AdminSidebarSettings.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Sidebar",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext"
]},"users":{"AddUser.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction",
  "../../../hooks/useEndpointData",
  "../../../hooks/useForm",
  "./UserForm"
],"EditUser.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/avatar/UserAvatarEditor",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction",
  "../../../hooks/useEndpointUpload",
  "../../../hooks/useForm",
  "./UserForm"
],"EditUserWithData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Skeleton",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditUser"
],"InviteUsers.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../lib/emailValidator",
  "../../../components/VerticalBar",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"UserForm.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../lib/emailValidator",
  "../../../components/CustomFieldsForm",
  "../../../components/VerticalBar",
  "../../../contexts/TranslationContext"
],"UserInfo.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../lib/getUserEmailAddress",
  "../../../components/Skeleton",
  "../../../components/UserCard",
  "../../../components/UserStatus",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../../../lib/utils/getUserEmailVerified",
  "../../room/contextualBar/UserInfo/UserInfo",
  "./UserInfoActions"
],"UserInfoActions.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/ConfirmOwnerChangeWarningModal",
  "../../../components/GenericModal",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../hooks/useActionSpread",
  "../../room/contextualBar/UserInfo"
],"UserPageHeaderContent.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext"
],"UserRow.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/string-helpers",
  "react",
  "../../../components/avatar/UserAvatar",
  "../../../contexts/TranslationContext"
],"UsersPage.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../ee/client/views/admin/users/UserPageHeaderContentWithSeatsCap",
  "../../../../ee/client/views/admin/users/useSeatsCap",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./AddUser",
  "./EditUserWithData",
  "./InviteUsers",
  "./UserInfo",
  "./UserPageHeaderContent",
  "./UsersTable"
],"UsersRoute.js":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./UsersPage"
],"UsersTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./UserRow"
]},"viewLogs":{"ServerLogs.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./ansispan"
],"ViewLogsPage.tsx":[
  "react",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./ServerLogs"
],"ViewLogsRoute.tsx":[
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "./ViewLogsPage"
],"ansispan.ts":[
  "@babel/runtime/helpers/slicedToArray"
]},"AdministrationLayout.tsx":[
  "react",
  "../../../app/ui-utils/client"
],"AdministrationRouter.js":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../components/PageSkeleton",
  "../../contexts/RouterContext",
  "../../providers/SettingsProvider",
  "./AdministrationLayout"
],"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/admin/index.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./routes", {
  registerAdminRoute: "registerAdminRoute"
}, 0);
module.link("./sidebarItems", {
  registerAdminSidebarItem: "registerAdminSidebarItem",
  unregisterSidebarItem: "unregisterAdminSidebarItem"
}, 1);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/admin/routes.js                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  registerAdminRoute: function () {
    return registerAdminRoute;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var appLayout;
module.link("../../lib/appLayout", {
  appLayout: function (v) {
    appLayout = v;
  }
}, 1);
var createRouteGroup;
module.link("../../lib/createRouteGroup", {
  createRouteGroup: function (v) {
    createRouteGroup = v;
  }
}, 2);
var registerAdminRoute = createRouteGroup('admin', '/admin', function () {
  return module.dynamicImport('./AdministrationRouter');
});
registerAdminRoute('/custom-sounds/:context?/:id?', {
  name: 'custom-sounds',
  lazyRouteComponent: function () {
    return module.dynamicImport('./customSounds/AdminSoundsRoute');
  }
});
registerAdminRoute('/apps/what-is-it', {
  name: 'admin-apps-disabled',
  lazyRouteComponent: function () {
    return module.dynamicImport('./apps/AppsWhatIsIt');
  }
});
registerAdminRoute('/marketplace/:context?/:id?/:version?', {
  name: 'admin-marketplace',
  lazyRouteComponent: function () {
    return module.dynamicImport('./apps/AppsRoute');
  }
});
registerAdminRoute('/apps/:context?/:id?/:version?', {
  name: 'admin-apps',
  lazyRouteComponent: function () {
    return module.dynamicImport('./apps/AppsRoute');
  }
});
registerAdminRoute('/apps/:context?/:id?/:version?', {
  name: 'admin-apps',
  lazyRouteComponent: function () {
    return module.dynamicImport('./apps/AppsRoute');
  }
});
registerAdminRoute('/info', {
  name: 'admin-info',
  lazyRouteComponent: function () {
    return module.dynamicImport('./info/InformationRoute');
  }
});
registerAdminRoute('/import', {
  name: 'admin-import',
  lazyRouteComponent: function () {
    return module.dynamicImport('./import/ImportRoute');
  },
  props: {
    page: 'history'
  }
});
registerAdminRoute('/import/new/:importerKey?', {
  name: 'admin-import-new',
  lazyRouteComponent: function () {
    return module.dynamicImport('./import/ImportRoute');
  },
  props: {
    page: 'new'
  }
});
registerAdminRoute('/import/prepare', {
  name: 'admin-import-prepare',
  lazyRouteComponent: function () {
    return module.dynamicImport('./import/ImportRoute');
  },
  props: {
    page: 'prepare'
  }
});
registerAdminRoute('/import/progress', {
  name: 'admin-import-progress',
  lazyRouteComponent: function () {
    return module.dynamicImport('./import/ImportRoute');
  },
  props: {
    page: 'progress'
  }
});
registerAdminRoute('/mailer', {
  name: 'admin-mailer',
  lazyRouteComponent: function () {
    return module.dynamicImport('./mailer/MailerRoute');
  }
});
registerAdminRoute('/oauth-apps/:context?/:id?', {
  name: 'admin-oauth-apps',
  lazyRouteComponent: function () {
    return module.dynamicImport('./oauthApps/OAuthAppsRoute');
  }
});
registerAdminRoute('/integrations/:context?/:type?/:id?', {
  name: 'admin-integrations',
  lazyRouteComponent: function () {
    return module.dynamicImport('./integrations/IntegrationsRoute');
  }
});
registerAdminRoute('/custom-user-status/:context?/:id?', {
  name: 'custom-user-status',
  lazyRouteComponent: function () {
    return module.dynamicImport('./customUserStatus/CustomUserStatusRoute');
  }
});
registerAdminRoute('/emoji-custom/:context?/:id?', {
  name: 'emoji-custom',
  lazyRouteComponent: function () {
    return module.dynamicImport('./customEmoji/CustomEmojiRoute');
  }
});
registerAdminRoute('/users/:context?/:id?', {
  name: 'admin-users',
  lazyRouteComponent: function () {
    return module.dynamicImport('./users/UsersRoute');
  }
});
registerAdminRoute('/rooms/:context?/:id?', {
  name: 'admin-rooms',
  lazyRouteComponent: function () {
    return module.dynamicImport('./rooms/RoomsRoute');
  }
});
registerAdminRoute('/invites', {
  name: 'invites',
  lazyRouteComponent: function () {
    return module.dynamicImport('./invites/InvitesRoute');
  }
});
registerAdminRoute('/cloud/:page?', {
  name: 'cloud',
  lazyRouteComponent: function () {
    return module.dynamicImport('./cloud/CloudRoute');
  }
});
registerAdminRoute('/view-logs', {
  name: 'admin-view-logs',
  lazyRouteComponent: function () {
    return module.dynamicImport('./viewLogs/ViewLogsRoute');
  }
});
registerAdminRoute('/federation-dashboard', {
  name: 'federation-dashboard',
  lazyRouteComponent: function () {
    return module.dynamicImport('./federationDashboard/FederationDashboardRoute');
  }
});
registerAdminRoute('/permissions/:context?/:_id?', {
  name: 'admin-permissions',
  lazyRouteComponent: function () {
    return module.dynamicImport('./permissions/PermissionsRouter');
  }
});
registerAdminRoute('/email-inboxes/:context?/:_id?', {
  name: 'admin-email-inboxes',
  lazyRouteComponent: function () {
    return module.dynamicImport('./emailInbox/EmailInboxRoute');
  }
});
Meteor.startup(function () {
  registerAdminRoute('/:group+', {
    name: 'admin',
    lazyRouteComponent: function () {
      return module.dynamicImport('./settings/SettingsRoute');
    }
  });
});
registerAdminRoute('/chatpal', {
  name: 'chatpal-admin',
  action: function () {
    appLayout.renderMainLayout({
      center: 'ChatpalAdmin'
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"sidebarItems.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/admin/sidebarItems.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  registerAdminSidebarItem: function () {
    return registerAdminSidebarItem;
  },
  unregisterSidebarItem: function () {
    return unregisterSidebarItem;
  },
  itemsSubscription: function () {
    return itemsSubscription;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var hasPermission, hasRole;
module.link("../../../app/authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  },
  hasRole: function (v) {
    hasRole = v;
  }
}, 1);
var createSidebarItems;
module.link("../../lib/createSidebarItems", {
  createSidebarItems: function (v) {
    createSidebarItems = v;
  }
}, 2);

var _createSidebarItems = createSidebarItems([{
  href: 'admin-info',
  i18nLabel: 'Info',
  icon: 'info-circled',
  permissionGranted: function () {
    return hasPermission('view-statistics');
  }
}, {
  href: 'admin-import',
  i18nLabel: 'Import',
  icon: 'import',
  permissionGranted: function () {
    return hasPermission('run-import');
  }
}, {
  href: 'admin-users',
  i18nLabel: 'Users',
  icon: 'team',
  permissionGranted: function () {
    return hasPermission('view-user-administration');
  }
}, {
  href: 'admin-rooms',
  i18nLabel: 'Rooms',
  icon: 'hashtag',
  permissionGranted: function () {
    return hasPermission('view-room-administration');
  }
}, {
  href: 'invites',
  i18nLabel: 'Invites',
  icon: 'user-plus',
  permissionGranted: function () {
    return hasPermission('create-invite-links');
  }
}, {
  icon: 'cloud-plus',
  href: 'cloud',
  i18nLabel: 'Connectivity_Services',
  permissionGranted: function () {
    return hasPermission('manage-cloud');
  }
}, {
  href: 'admin-view-logs',
  i18nLabel: 'View_Logs',
  icon: 'post',
  permissionGranted: function () {
    return hasPermission('view-logs');
  }
}, {
  href: 'custom-sounds',
  i18nLabel: 'Custom_Sounds',
  icon: 'volume',
  permissionGranted: function () {
    return hasPermission(['manage-sounds']);
  }
}, {
  icon: 'discover',
  href: 'federation-dashboard',
  i18nLabel: 'Federation Dashboard',
  permissionGranted: function () {
    return hasRole(Meteor.userId(), 'admin');
  }
}, {
  icon: 'cube',
  href: 'admin-marketplace',
  i18nLabel: 'Apps',
  permissionGranted: function () {
    return hasPermission(['manage-apps']);
  }
}, {
  icon: 'mail',
  href: 'admin-email-inboxes',
  i18nLabel: 'Email_Inboxes',
  tag: 'Alpha',
  permissionGranted: function () {
    return hasPermission(['manage-email-inbox']);
  }
}]),
    registerAdminSidebarItem = _createSidebarItems.registerSidebarItem,
    unregisterSidebarItem = _createSidebarItems.unregisterSidebarItem,
    itemsSubscription = _createSidebarItems.itemsSubscription;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"omnichannel":{"directory":{"chats":{"contextualBar":{"AgentField.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/UserCard",
  "../../../../../components/UserStatus",
  "../../../../../components/avatar/UserAvatar",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"ChatInfo.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "moment",
  "react",
  "../../../../../../app/authorization/client",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../hooks/useFormatDateAndTime",
  "../../../../../hooks/useFormatDuration",
  "../../../../room/contexts/RoomContext",
  "../../../components/CustomField",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "./AgentField",
  "./ContactField",
  "./DepartmentField",
  "./PriorityField",
  "./SourceField",
  "./VisitorClientInfo"
],"ChatInfoDirectory.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "moment",
  "react",
  "../../../../../../app/authorization/client",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../hooks/useFormatDateAndTime",
  "../../../../../hooks/useFormatDuration",
  "../../../components/CustomField",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "./AgentField",
  "./ContactField",
  "./DepartmentField",
  "./PriorityField",
  "./VisitorClientInfo"
],"ChatsContextualBar.js":[
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/TranslationContext",
  "../../../../room/providers/ToolboxProvider",
  "./ChatInfo",
  "./RoomEditWithData"
],"ContactField.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../../app/utils/client",
  "../../../../../components/UserCard",
  "../../../../../components/UserStatus",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../lib/asyncState",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"DepartmentField.js":[
  "react",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"PriorityField.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../lib/asyncState",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"RoomEdit.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../../../../app/authorization/client",
  "../../../../../components/CustomFieldsForm",
  "../../../../../components/Omnichannel/Tags",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../../../../hooks/useForm",
  "../../../additionalForms",
  "../../Skeleton"
],"RoomEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../Skeleton",
  "./VisitorData"
],"SourceField.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/RoomIcon/OmnichannelRoomIcon",
  "../../../../../contexts/TranslationContext",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label"
],"VisitorClientInfo.js":[
  "react",
  "ua-parser-js",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../lib/asyncState",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"VisitorData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../Skeleton",
  "./RoomEdit"
]},"Chat.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../app/ui-utils/client/lib/openRoom",
  "../../../room/Room"
],"ChatTab.js":[
  "react",
  "../../../../components/NotAuthorizedPage",
  "../../../../contexts/AuthorizationContext",
  "./ChatTable"
],"ChatTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "moment",
  "react",
  "../../../../components/FilterByText",
  "../../../../components/GenericTable",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointData"
]},"contacts":{"contextualBar":{"ContactEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../Skeleton",
  "./ContactNewEdit"
],"ContactInfo.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/authorization/client",
  "../../../../../../ee/client/omnichannel/ContactManagerInfo",
  "../../../../../components/UserCard/UserCard",
  "../../../../../components/UserStatus",
  "../../../../../components/VerticalBar",
  "../../../../../components/avatar/UserAvatar",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "../../../../../hooks/useFormatDate",
  "../../../components/CustomField",
  "../../../components/Field",
  "../../../components/Info",
  "../../../components/Label",
  "../../Skeleton"
],"ContactNewEdit.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../../../../app/authorization/client",
  "../../../../../../lib/emailValidator",
  "../../../../../components/CustomFieldsForm",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useComponentDidUpdate",
  "../../../../../hooks/useEndpointData",
  "../../../../../hooks/useForm",
  "../../../../../lib/utils/createToken",
  "../../../additionalForms",
  "../../Skeleton"
],"ContactsContextualBar.tsx":[
  "react",
  "../../../../../components/VerticalBar",
  "../../../../../contexts/RouterContext",
  "../../../../../contexts/TranslationContext",
  "../../../../room/contexts/RoomContext",
  "../../../../room/providers/ToolboxProvider",
  "./ContactEditWithData",
  "./ContactInfo"
]},"ContactTab.js":[
  "react",
  "../../../../components/NotAuthorizedPage",
  "../../../../contexts/AuthorizationContext",
  "./ContactTable"
],"ContactTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/FilterByText",
  "../../../../components/GenericTable",
  "../../../../contexts/RouterContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointData",
  "../../../../hooks/useFormatDate"
]},"ChatsContextualBar.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./Skeleton",
  "./chats/Chat",
  "./chats/contextualBar/ChatInfoDirectory",
  "./chats/contextualBar/RoomEditWithData"
],"ContactContextualBar.js":[
  "react",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./contacts/contextualBar/ContactEditWithData",
  "./contacts/contextualBar/ContactInfo",
  "./contacts/contextualBar/ContactNewEdit"
],"ContextualBar.js":[
  "react",
  "../../../contexts/RouterContext",
  "./ChatsContextualBar",
  "./ContactContextualBar"
],"OmnichannelDirectoryPage.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./ContextualBar",
  "./chats/ChatTab",
  "./contacts/ContactTab"
],"Skeleton.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
]},"queueList":{"hooks":{"useQuery.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "react"
]},"QueueListFilter.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/AutoCompleteAgent",
  "../../../components/AutoCompleteDepartment",
  "../../../contexts/TranslationContext"
],"QueueListPage.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/GenericTable",
  "../../../components/Page",
  "./QueueListFilter"
],"index.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/avatar/UserAvatar",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./QueueListPage",
  "./hooks/useQuery"
]},"realTimeMonitoring":{"charts":{"AgentStatusChart.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./useUpdateChartData"
],"Chart.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"ChatDurationChart.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../../app/utils/lib/timeConverter",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./getMomentChartLabelsAndData",
  "./getMomentCurrentLabel",
  "./useUpdateChartData"
],"ChatsChart.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./useUpdateChartData"
],"ChatsPerAgentChart.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./useUpdateChartData"
],"ChatsPerDepartmentChart.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./useUpdateChartData"
],"ResponseTimesChart.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../../app/livechat/client/lib/chartHandler",
  "../../../../../app/utils/lib/timeConverter",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "./Chart",
  "./getMomentChartLabelsAndData",
  "./getMomentCurrentLabel",
  "./useUpdateChartData"
],"getMomentChartLabelsAndData.js":[
  "moment"
],"getMomentCurrentLabel.js":[
  "moment"
],"useUpdateChartData.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage-hooks",
  "../../../../../app/livechat/client/lib/chartHandler"
]},"counter":{"CounterContainer.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "./CounterItem",
  "./CounterRow"
],"CounterItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"CounterRow.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "react-keyed-flatten-children"
]},"overviews":{"AgentsOverview.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../hooks/useEndpointData",
  "../counter/CounterContainer"
],"ChatsOverview.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../hooks/useEndpointData",
  "../counter/CounterContainer"
],"ConversationOverview.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../hooks/useEndpointData",
  "../counter/CounterContainer"
],"ProductivityOverview.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../hooks/useEndpointData",
  "../counter/CounterContainer"
]},"RealTimeMonitoringPage.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/AutoCompleteDepartment",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "../../../lib/utils/getDateRange",
  "../components/Label",
  "./charts/AgentStatusChart",
  "./charts/ChatDurationChart",
  "./charts/ChatsChart",
  "./charts/ChatsPerAgentChart",
  "./charts/ChatsPerDepartmentChart",
  "./charts/ResponseTimesChart",
  "./overviews/AgentsOverview",
  "./overviews/ChatsOverview",
  "./overviews/ConversationOverview",
  "./overviews/ProductivityOverview"
]},"agents":{"AddAgent.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/UserAutoComplete",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
],"AgentEdit.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../../lib/getUserEmailAddress",
  "../../../components/VerticalBar",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "../../room/contextualBar/UserInfo",
  "../additionalForms"
],"AgentEditWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Skeleton",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./AgentEdit"
],"AgentInfo.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "use-subscription",
  "../../../components/Skeleton",
  "../../../components/UserStatus",
  "../../../components/VerticalBar",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../../room/contextualBar/UserInfo",
  "../additionalForms",
  "./AgentInfoAction"
],"AgentInfoAction.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"AgentInfoActions.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction",
  "./AgentInfo"
],"AgentsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/Page",
  "./AddAgent"
],"AgentsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/NotAuthorizedPage",
  "../../../components/VerticalBar",
  "../../../components/avatar/UserAvatar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./AgentEditWithData",
  "./AgentInfo",
  "./AgentInfoActions",
  "./AgentsPage",
  "./RemoveAgentButton"
],"RemoveAgentButton.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
]},"analytics":{"AgentOverview.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext"
],"AnalyticsPage.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/AutoCompleteDepartment",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./AgentOverview",
  "./DateRangePicker",
  "./InterchangeableChart",
  "./Overview"
],"DateRangePicker.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "moment",
  "react",
  "../../../contexts/TranslationContext"
],"InterchangeableChart.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/livechat/client/lib/chartHandler",
  "../../../../app/utils/lib/timeConverter",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../realTimeMonitoring/charts/Chart"
],"Overview.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../realTimeMonitoring/counter/CounterItem",
  "../realTimeMonitoring/counter/CounterRow"
]},"appearance":{"AppearanceForm.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"AppearancePage.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./AppearanceForm"
],"AppearancePageContainer.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./AppearancePage"
]},"businessHours":{"BusinessHoursForm.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "./TimeRangeFieldsAssembler"
],"BusinessHoursFormContainer.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../../app/livechat/client/views/app/business-hours/BusinessHours",
  "../../../hooks/useForm",
  "../../../hooks/useReactiveValue",
  "../additionalForms",
  "./BusinessHoursForm"
],"BusinessHoursPage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext"
],"BusinessHoursRouter.js":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/livechat/client/views/app/business-hours/BusinessHours",
  "../../../contexts/RouterContext",
  "../../../hooks/useReactiveValue",
  "./BusinessHoursPage",
  "./EditBusinessHoursPage",
  "./NewBusinessHoursPage"
],"EditBusinessHoursPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./BusinessHoursFormContainer",
  "./BusinessHoursRouter",
  "./mapBusinessHoursForm"
],"NewBusinessHoursPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./BusinessHoursForm",
  "./BusinessHoursFormContainer",
  "./mapBusinessHoursForm"
],"TimeRangeFieldsAssembler.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext",
  "./BusinessHoursForm",
  "./TimeRangeInput"
],"TimeRangeInput.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"mapBusinessHoursForm.js":[]},"components":{"CustomField.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../directory/Skeleton",
  "./Field",
  "./Info",
  "./Label"
],"Field.js":[
  "@rocket.chat/fuselage",
  "react"
],"Info.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "react",
  "../../../components/UserCard"
],"Label.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
]},"currentChats":{"CurrentChatsPage.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/GenericTable",
  "../../../components/Page",
  "./FilterByText"
],"CurrentChatsRoute.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/kadira:flow-router",
  "moment",
  "react",
  "../../../components/GenericTable",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./CurrentChatsPage",
  "./RemoveChatButton"
],"FilterByText.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "moment",
  "react",
  "use-subscription",
  "../../../components/AutoCompleteAgent",
  "../../../components/AutoCompleteDepartment",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../additionalForms",
  "./Label",
  "./RemoveAllClosed"
],"Label.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"RemoveAllClosed.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/TranslationContext"
],"RemoveChatButton.tsx":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
]},"customFields":{"CustomFieldsForm.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"CustomFieldsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext"
],"CustomFieldsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./CustomFieldsPage",
  "./EditCustomFieldsPageContainer",
  "./NewCustomFieldsPage",
  "./RemoveCustomFieldButton"
],"EditCustomFieldsPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "../additionalForms",
  "./CustomFieldsForm"
],"EditCustomFieldsPageContainer.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditCustomFieldsPage"
],"NewCustomFieldsPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "../additionalForms",
  "./CustomFieldsForm"
],"RemoveCustomFieldButton.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
]},"departments":{"AddAgent.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/AutoCompleteAgent",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
],"AgentRow.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/avatar/UserAvatar",
  "./Count",
  "./Order",
  "./RemoveAgentButton"
],"Count.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"DepartmentsAgentsTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/TranslationContext",
  "./AddAgent",
  "./AgentRow"
],"DepartmentsPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/Page",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext"
],"DepartmentsRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/NotAuthorizedPage",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./DepartmentsPage",
  "./EditDepartmentWithData",
  "./RemoveDepartmentButton"
],"EditDepartment.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../../../lib/emailValidator",
  "../../../components/Page",
  "../../../components/RoomAutoComplete/hooks/useRoomsList",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/lists/useRecordList",
  "../../../hooks/useComponentDidUpdate",
  "../../../hooks/useForm",
  "../../../lib/asyncState",
  "../additionalForms",
  "./DepartmentsAgentsTable"
],"EditDepartmentWithAllowedForwardData.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Skeleton",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditDepartment"
],"EditDepartmentWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Skeleton",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditDepartment",
  "./EditDepartmentWithAllowedForwardData"
],"Order.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext"
],"RemoveAgentButton.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"RemoveDepartmentButton.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
]},"facebook":{"FacebookPage.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "./PageToggleAssembler"
],"FacebookPageContainer.tsx":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useMethodData",
  "./FacebookPage"
],"PageToggle.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react"
],"PageToggleAssembler.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./PageToggle"
]},"installation":{"Installation.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../components/RawText",
  "../../../components/TextCopy",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "./Wrapper"
],"Wrapper.js":[
  "@rocket.chat/fuselage",
  "react"
]},"managers":{"AddManager.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/UserAutoComplete",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
],"ManagersPage.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../components/FilterByText",
  "../../../components/GenericTable",
  "../../../components/Page",
  "./AddManager"
],"ManagersRoute.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericTable",
  "../../../components/NotAuthorizedPage",
  "../../../components/avatar/UserAvatar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./ManagersPage",
  "./RemoveManagerButton"
],"RemoveManagerButton.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointAction"
]},"sidebar":{"OmnichannelSidebar.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "use-subscription",
  "../../../../app/ui-utils/client",
  "../../../components/Sidebar",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "../../../lib/utils/isLayoutEmbedded",
  "../../../providers/SettingsProvider",
  "../sidebarItems"
]},"triggers":{"EditTriggerPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./TriggersForm"
],"EditTriggerPageContainer.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/PageSkeleton",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./EditTriggerPage"
],"NewTriggerPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm",
  "./TriggersForm"
],"TriggersForm.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useComponentDidUpdate"
],"TriggersPage.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/VerticalBar",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/TranslationContext",
  "./EditTriggerPageContainer",
  "./NewTriggerPage",
  "./TriggersTableContainer"
],"TriggersRow.js":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/ModalContext",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext"
],"TriggersTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/TranslationContext",
  "../../../hooks/useResizeInlineBreakpoint",
  "./TriggersRow"
],"TriggersTableContainer.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./TriggersTable"
]},"webhooks":{"WebhooksPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/ExternalLink",
  "../../../components/Page",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useForm"
],"WebhooksPageContainer.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../components/PageSkeleton",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "./WebhooksPage"
]},"OmnichannelRouter.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../app/ui-utils/client",
  "../../components/PageSkeleton",
  "../../contexts/RouterContext"
],"additionalForms.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/omnichannel/additionalForms.js                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
module.export({
  registerForm: function () {
    return registerForm;
  },
  unregisterForm: function () {
    return unregisterForm;
  },
  formsSubscription: function () {
    return formsSubscription;
  }
});

var createFormSubscription = function () {
  var forms = {};

  var updateCb = function () {};

  var formsSubscription = {
    subscribe: function (cb) {
      updateCb = cb;
      return function () {
        updateCb = function () {};
      };
    },
    getCurrentValue: function () {
      return forms;
    }
  };

  var registerForm = function (newForm) {
    forms = _objectSpread(_objectSpread({}, forms), newForm);
    updateCb();
  };

  var unregisterForm = function (form) {
    delete forms[form];
    updateCb();
  };

  return {
    registerForm: registerForm,
    unregisterForm: unregisterForm,
    formsSubscription: formsSubscription
  };
};

var _createFormSubscripti = createFormSubscription(),
    registerForm = _createFormSubscripti.registerForm,
    unregisterForm = _createFormSubscripti.unregisterForm,
    formsSubscription = _createFormSubscripti.formsSubscription;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/omnichannel/routes.js                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  registerOmnichannelRoute: function () {
    return registerOmnichannelRoute;
  }
});
var createRouteGroup;
module.link("../../lib/createRouteGroup", {
  createRouteGroup: function (v) {
    createRouteGroup = v;
  }
}, 0);
var registerOmnichannelRoute = createRouteGroup('omnichannel', '/omnichannel', function () {
  return module.dynamicImport('./OmnichannelRouter');
});
registerOmnichannelRoute('/installation', {
  name: 'omnichannel-installation',
  lazyRouteComponent: function () {
    return module.dynamicImport('./installation/Installation');
  }
});
registerOmnichannelRoute('/managers', {
  name: 'omnichannel-managers',
  lazyRouteComponent: function () {
    return module.dynamicImport('./managers/ManagersRoute');
  }
});
registerOmnichannelRoute('/agents/:context?/:id?', {
  name: 'omnichannel-agents',
  lazyRouteComponent: function () {
    return module.dynamicImport('./agents/AgentsRoute');
  }
});
registerOmnichannelRoute('/webhooks', {
  name: 'omnichannel-webhooks',
  lazyRouteComponent: function () {
    return module.dynamicImport('./webhooks/WebhooksPageContainer');
  }
});
registerOmnichannelRoute('/customfields/:context?/:id?', {
  name: 'omnichannel-customfields',
  lazyRouteComponent: function () {
    return module.dynamicImport('./customFields/CustomFieldsRoute');
  }
});
registerOmnichannelRoute('/appearance', {
  name: 'omnichannel-appearance',
  lazyRouteComponent: function () {
    return module.dynamicImport('./appearance/AppearancePageContainer');
  }
});
registerOmnichannelRoute('/businessHours/:context?/:type?/:id?', {
  name: 'omnichannel-businessHours',
  lazyRouteComponent: function () {
    return module.dynamicImport('./businessHours/BusinessHoursRouter');
  }
});
registerOmnichannelRoute('/units/:context?/:id?', {
  name: 'omnichannel-units',
  lazyRouteComponent: function () {
    return module.dynamicImport('../../../ee/client/omnichannel/units/UnitsRoute');
  }
});
registerOmnichannelRoute('/tags/:context?/:id?', {
  name: 'omnichannel-tags',
  lazyRouteComponent: function () {
    return module.dynamicImport('../../../ee/client/omnichannel/tags/TagsRoute');
  }
});
registerOmnichannelRoute('/priorities/:context?/:id?', {
  name: 'omnichannel-priorities',
  lazyRouteComponent: function () {
    return module.dynamicImport('../../../ee/client/omnichannel/priorities/PrioritiesRoute');
  }
});
registerOmnichannelRoute('/triggers/:context?/:id?', {
  name: 'omnichannel-triggers',
  lazyRouteComponent: function () {
    return module.dynamicImport('./triggers/TriggersPage');
  }
});
registerOmnichannelRoute('/facebook', {
  name: 'omnichannel-facebook',
  lazyRouteComponent: function () {
    return module.dynamicImport('./facebook/FacebookPageContainer');
  }
});
registerOmnichannelRoute('/current', {
  name: 'omnichannel-current-chats',
  lazyRouteComponent: function () {
    return module.dynamicImport('./currentChats/CurrentChatsRoute');
  }
});
registerOmnichannelRoute('/departments/:context?/:id?/:tab?', {
  name: 'omnichannel-departments',
  lazyRouteComponent: function () {
    return module.dynamicImport('./departments/DepartmentsRoute');
  }
});
registerOmnichannelRoute('/realtime-monitoring', {
  name: 'omnichannel-realTime',
  lazyRouteComponent: function () {
    return module.dynamicImport('./realTimeMonitoring/RealTimeMonitoringPage');
  }
});
registerOmnichannelRoute('/analytics', {
  name: 'omnichannel-analytics',
  lazyRouteComponent: function () {
    return module.dynamicImport('./analytics/AnalyticsPage');
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"sidebarItems.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/omnichannel/sidebarItems.js                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  registerOmnichannelSidebarItem: function () {
    return registerOmnichannelSidebarItem;
  },
  unregisterSidebarItem: function () {
    return unregisterSidebarItem;
  },
  itemsSubscription: function () {
    return itemsSubscription;
  }
});
var hasPermission;
module.link("../../../app/authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 0);
var createSidebarItems;
module.link("../../lib/createSidebarItems", {
  createSidebarItems: function (v) {
    createSidebarItems = v;
  }
}, 1);

var _createSidebarItems = createSidebarItems([{
  href: 'omnichannel/current',
  i18nLabel: 'Current_Chats',
  permissionGranted: function () {
    return hasPermission('view-livechat-current-chats');
  }
}, {
  href: 'omnichannel-analytics',
  i18nLabel: 'Analytics',
  permissionGranted: function () {
    return hasPermission('view-livechat-analytics');
  }
}, {
  href: 'omnichannel-realTime',
  i18nLabel: 'Real_Time_Monitoring',
  permissionGranted: function () {
    return hasPermission('view-livechat-real-time-monitoring');
  }
}, {
  href: 'omnichannel/managers',
  i18nLabel: 'Managers',
  permissionGranted: function () {
    return hasPermission('manage-livechat-managers');
  }
}, {
  href: 'omnichannel/agents',
  i18nLabel: 'Agents',
  permissionGranted: function () {
    return hasPermission('manage-livechat-agents');
  }
}, {
  href: 'omnichannel/departments',
  i18nLabel: 'Departments',
  permissionGranted: function () {
    return hasPermission('view-livechat-departments');
  }
}, {
  href: 'omnichannel-customfields',
  i18nLabel: 'Custom_Fields',
  permissionGranted: function () {
    return hasPermission('view-livechat-customfields');
  }
}, {
  href: 'omnichannel-triggers',
  i18nLabel: 'Livechat_Triggers',
  permissionGranted: function () {
    return hasPermission('view-livechat-triggers');
  }
}, {
  href: 'omnichannel-installation',
  i18nLabel: 'Livechat_Installation',
  permissionGranted: function () {
    return hasPermission('view-livechat-installation');
  }
}, {
  href: 'omnichannel-appearance',
  i18nLabel: 'Livechat_Appearance',
  permissionGranted: function () {
    return hasPermission('view-livechat-appearance');
  }
}, {
  href: 'omnichannel-webhooks',
  i18nLabel: 'Webhooks',
  permissionGranted: function () {
    return hasPermission('view-livechat-webhooks');
  }
}, {
  href: 'omnichannel-facebook',
  i18nLabel: 'Facebook Messenger',
  permissionGranted: function () {
    return hasPermission('view-livechat-facebook');
  }
}, {
  href: 'omnichannel-businessHours',
  i18nLabel: 'Business_Hours',
  permissionGranted: function () {
    return hasPermission('view-livechat-business-hours');
  }
}]),
    registerOmnichannelSidebarItem = _createSidebarItems.registerSidebarItem,
    unregisterSidebarItem = _createSidebarItems.unregisterSidebarItem,
    itemsSubscription = _createSidebarItems.itemsSubscription;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"teams":{"contextualBar":{"channels":{"AddExistingModal":{"AddExistingModal.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/ToastMessagesContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useForm",
  "./RoomsInput"
],"RoomsInput.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../../app/utils/client",
  "../../../../../components/avatar/RoomAvatar",
  "../../../../../hooks/useEndpointData"
],"index.ts":[
  "./AddExistingModal"
]},"ConfirmationModal":{"ConfirmationModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../contexts/TranslationContext"
],"index.ts":[
  "./ConfirmationModal"
]},"hooks":{"useTeamsChannelList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../../contexts/ServerContext",
  "../../../../../hooks/lists/useScrollableRecordList",
  "../../../../../hooks/useComponentDidUpdate",
  "../../../../../lib/lists/RecordList",
  "../../../../../lib/utils/getConfig",
  "../../../../../lib/utils/mapMessageFromApi"
]},"BaseTeamsChannels.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../../../components/ScrollableContentWrapper",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "./Row"
],"RoomActions.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../contexts/AuthorizationContext",
  "../../../../contexts/ModalContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useEndpointActionExperimental",
  "./ConfirmationModal"
],"Row.js":[
  "react",
  "./TeamsChannelItem"
],"TeamsChannelItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../components/avatar/RoomAvatar",
  "../../../../contexts/AuthorizationContext",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/usePreventProgation",
  "./RoomActions"
],"TeamsChannels.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../contexts/AuthorizationContext",
  "../../../../contexts/ModalContext",
  "../../../../hooks/lists/useRecordList",
  "../../../../lib/asyncState",
  "../../../../sidebar/header/CreateChannelWithData",
  "../../../room/contextualBar/Info",
  "../../../room/providers/ToolboxProvider",
  "./AddExistingModal",
  "./BaseTeamsChannels",
  "./hooks/useTeamsChannelList"
],"index.ts":[
  "./TeamsChannels"
],"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/teams/contextualBar/channels/tabBar.ts                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var lazy;
module.link("react", {
  lazy: function (v) {
    lazy = v;
  }
}, 0);
var addAction;
module.link("../../../room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
addAction('team-channels', {
  groups: ['team'],
  id: 'team-channels',
  anonymous: true,
  full: true,
  title: 'Team_Channels',
  icon: 'hash',
  template: /*#__PURE__*/lazy(function () {
    return module.dynamicImport('./index');
  }),
  order: 2
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"info":{"Delete":{"ChannelDeletionTable.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericTable",
  "../../../../../contexts/TranslationContext",
  "./ChannelRow"
],"ChannelRow.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../hooks/useRoomIcon"
],"DeleteTeamModal.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "."
],"StepOne.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "./ChannelDeletionTable"
],"StepTwo.js":[
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../RoomLinkList"
],"index.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../hooks/useEndpointData",
  "./DeleteTeamModal",
  "./StepOne",
  "./StepTwo"
]},"Leave":{"LeaveTeamModal.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "."
],"StepOne.js":[
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../../ChannelDesertionTable"
],"StepTwo.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext"
],"index.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/ServerContext",
  "../../../../../contexts/TranslationContext",
  "../../../../../contexts/UserContext",
  "../../../../../hooks/useAsyncState",
  "../../../../../lib/asyncState",
  "./LeaveTeamModal",
  "./StepOne",
  "./StepTwo"
]},"TeamsInfo.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/VerticalBar",
  "../../../../components/avatar/RoomAvatar",
  "../../../../contexts/TranslationContext",
  "../../../InfoPanel",
  "../../../InfoPanel/RetentionPolicyCallout",
  "../../../hooks/useActionSpread"
],"TeamsInfoWithData.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../components/GenericModal",
  "../../../../components/MarkdownText",
  "../../../../contexts/AuthorizationContext",
  "../../../../contexts/ModalContext",
  "../../../../contexts/RouterContext",
  "../../../../contexts/ServerContext",
  "../../../../contexts/SettingsContext",
  "../../../../contexts/ToastMessagesContext",
  "../../../../contexts/TranslationContext",
  "../../../../contexts/UserContext",
  "../../../../hooks/useDontAskAgain",
  "../../../../hooks/useEndpointActionExperimental",
  "../../../room/providers/ToolboxProvider",
  "../../ConvertToChannelModal",
  "./Delete",
  "./Leave",
  "./TeamsInfo"
],"index.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../components/VerticalBar",
  "../../../../contexts/TranslationContext",
  "../../../../hooks/useAsyncState",
  "../../../../hooks/useEndpointData",
  "../../../room/contextualBar/Info/EditRoomInfo",
  "./TeamsInfoWithData"
],"tabBar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/teams/contextualBar/info/tabBar.ts                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var lazy;
module.link("react", {
  lazy: function (v) {
    lazy = v;
  }
}, 0);
var addAction;
module.link("../../../room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 1);
addAction('team-info', {
  groups: ['team'],
  id: 'team-info',
  anonymous: true,
  full: true,
  title: 'Teams_Info',
  icon: 'info-circled',
  template: /*#__PURE__*/lazy(function () {
    return module.dynamicImport('./index.js');
  }),
  order: 1
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"members":{"RemoveUsersModal":{"BaseRemoveUsersModal.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../contexts/AuthorizationContext",
  "./RemoveUsersFirstStep",
  "./RemoveUsersSecondStep"
],"RemoveUsersFirstStep.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../../ChannelDesertionTable"
],"RemoveUsersModal.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext",
  "../../../../../hooks/useEndpointData",
  "../../../../../lib/asyncState",
  "./BaseRemoveUsersModal"
],"RemoveUsersSecondStep.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../../components/GenericModal",
  "../../../../../contexts/TranslationContext"
],"index.ts":[
  "./RemoveUsersModal"
]}},"TeamAutocomplete":{"Avatar.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/avatar/RoomAvatar"
],"TeamAutocomplete.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../../hooks/useEndpointData",
  "./Avatar"
],"index.ts":[
  "./TeamAutocomplete"
]},"ChannelRow.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../hooks/useRoomIcon"
],"RoomLinkList.js":[
  "react",
  "../../../../app/utils/client"
]},"ConvertToChannelModal":{"ModalSteps":{"FirstStep.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/TranslationContext",
  "../../ChannelDesertionTable"
],"SecondStep.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../components/GenericModal",
  "../../../../contexts/TranslationContext"
]},"BaseConvertToChannelModal.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "./ModalSteps/FirstStep",
  "./ModalSteps/SecondStep"
],"ConvertToChannelModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericModal",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "../../../lib/asyncState",
  "./BaseConvertToChannelModal"
],"index.ts":[
  "./ConvertToChannelModal"
]},"CreateTeamModal":{"CreateTeamModal.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointActionExperimental",
  "../../../hooks/useForm",
  "../../../lib/utils/goToRoomById",
  "./TeamNameInput",
  "./UsersInput"
],"TeamNameInput.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"UsersInput.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../components/avatar/UserAvatar",
  "../../../hooks/useEndpointData"
],"index.ts":[
  "./CreateTeamModal"
]},"ChannelDesertionTable.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../components/GenericTable",
  "../../contexts/TranslationContext",
  "../../hooks/useFormatDateAndTime",
  "./contextualBar/ChannelRow"
],"index.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/teams/index.js                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./contextualBar/channels/tabBar");
module.link("./contextualBar/info/tabBar");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"account":{"preferences":{"AccountPreferencesPage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/Page",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./PreferencesGlobalSection",
  "./PreferencesHighlightsSection",
  "./PreferencesLocalizationSection",
  "./PreferencesMessagesSection",
  "./PreferencesMyDataSection",
  "./PreferencesNotificationsSection",
  "./PreferencesSoundSection",
  "./PreferencesUserPresenceSection"
],"MyDataModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"PreferencesGlobalSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesHighlightsSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesLocalizationSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesMessagesSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesMyDataSection.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "./MyDataModal"
],"PreferencesNotificationsSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/ui",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesSoundSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../../app/custom-sounds/client",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"PreferencesUserPresenceSection.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
]},"security":{"AccountSecurityPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../components/NotAuthorizedPage",
  "../../../components/Page",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "./EndToEnd",
  "./TwoFactorEmail",
  "./TwoFactorTOTP"
],"BackupCodesModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/TextCopy",
  "../../../contexts/TranslationContext"
],"EndToEnd.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "react",
  "../../../../app/e2e/client/rocketchat.e2e",
  "../../../../lib/callbacks",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm"
],"TwoFactorEmail.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useEndpointAction"
],"TwoFactorTOTP.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "yaqrcode",
  "../../../components/TextCopy",
  "../../../components/TwoFactorModal/TwoFactorTotpModal",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm",
  "./BackupCodesModal"
]},"tokens":{"AccountTokensPage.js":[
  "react",
  "../../../components/Page",
  "../../../contexts/TranslationContext",
  "../../../hooks/useEndpointData",
  "./AccountTokensTable",
  "./AddToken"
],"AccountTokensRow.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFormatDateAndTime"
],"AccountTokensTable.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../components/GenericTable",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useResizeInlineBreakpoint",
  "./AccountTokensRow",
  "./InfoModal"
],"AddToken.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/ModalContext",
  "../../../contexts/ServerContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useForm",
  "./InfoModal"
],"InfoModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
]},"AccountIntegrationsPage.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../app/models/client",
  "../../components/Page",
  "../../contexts/ServerContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext",
  "../../hooks/useForm",
  "../../hooks/useReactiveValue"
],"AccountProfileForm.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../lib/emailValidator",
  "../../../lib/getUserEmailAddress",
  "../../components/CustomFieldsForm",
  "../../components/UserStatus",
  "../../components/UserStatusMenu",
  "../../components/avatar/UserAvatarEditor",
  "../../contexts/ServerContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext"
],"AccountProfilePage.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "meteor/sha",
  "react",
  "../../../lib/getUserEmailAddress",
  "../../components/ConfirmOwnerChangeWarningModal",
  "../../components/Page",
  "../../contexts/ModalContext",
  "../../contexts/ServerContext",
  "../../contexts/SettingsContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../../hooks/useForm",
  "../../hooks/useUpdateAvatar",
  "./AccountProfileForm",
  "./ActionConfirmModal"
],"AccountRoute.js":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../app/ui-utils/client",
  "../../components/NotAuthorizedPage",
  "../../contexts/AuthorizationContext",
  "../../contexts/RouterContext",
  "../../contexts/SettingsContext",
  "./AccountIntegrationsPage",
  "./AccountProfilePage",
  "./preferences/AccountPreferencesPage",
  "./security/AccountSecurityPage",
  "./tokens/AccountTokensPage",
  "./sidebarItems"
],"AccountSidebar.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/toArray",
  "react",
  "use-subscription",
  "../../../app/ui-utils/client",
  "../../components/Sidebar",
  "../../contexts/RouterContext",
  "../../contexts/TranslationContext",
  "../../lib/utils/isLayoutEmbedded",
  "../../providers/SettingsProvider",
  "./sidebarItems"
],"ActionConfirmModal.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../components/GenericModal",
  "../../contexts/TranslationContext"
],"sidebarItems.js":[
  "../../../app/authorization/client",
  "../../../app/settings/client",
  "../../lib/createSidebarItems"
]},"login":{"AppleOauth":{"AppleOauthButton.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "meteor/accounts-base",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext"
]},"LoginLayout":{"Footer.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "meteor/meteor",
  "react",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../lib/utils/filterLanguage"
],"Header.tsx":[
  "react",
  "./useAssetPath"
],"LoginLayout.tsx":[
  "react",
  "./Footer",
  "./Header",
  "./useAssetPath"
],"index.ts":[
  "./LoginLayout"
],"useAssetPath.ts":[
  "../../../contexts/SettingsContext"
]},"ResetPassword":{"ResetPassword.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../../../hooks/useMethodData",
  "../LoginLayout"
]}},"root":{"MainLayout":{"AuthenticationCheck.tsx":[
  "react",
  "../../../contexts/SessionContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/UserContext",
  "./LoginPage",
  "./UsernameCheck"
],"LayoutWithSidebar.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../contexts/LayoutContext",
  "../../../contexts/RouterContext",
  "../../../contexts/SettingsContext",
  "../../../hooks/useReactiveValue",
  "../BlazeTemplate"
],"LoginPage.tsx":[
  "react",
  "../BlazeTemplate",
  "./useIframeLogin"
],"MainLayout.tsx":[
  "react",
  "../BlazeTemplate",
  "./AuthenticationCheck",
  "./Preload"
],"PasswordChangeCheck.tsx":[
  "react",
  "../../../contexts/UserContext",
  "./TwoFactorAuthSetupCheck"
],"Preload.tsx":[
  "react",
  "../../../../app/models/client",
  "../../../../app/settings/client",
  "../../../../app/ui-cached-collection",
  "../../../../app/ui-utils/client",
  "../../../contexts/UserContext",
  "../../../hooks/useReactiveVar",
  "../../../lib/userData",
  "../PageLoading"
],"TwoFactorAuthSetupCheck.tsx":[
  "react",
  "../../../../app/models/client",
  "../../../contexts/LayoutContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/UserContext",
  "../../../hooks/useReactiveValue",
  "./LayoutWithSidebar"
],"UsernameCheck.tsx":[
  "react",
  "../../../../app/models/client",
  "../../../contexts/SettingsContext",
  "../../../contexts/UserContext",
  "../../../hooks/useReactiveValue",
  "../BlazeTemplate",
  "./PasswordChangeCheck",
  "./useCustomScript",
  "./useViewportScrolling"
],"index.ts":[
  "./MainLayout"
],"useCustomScript.ts":[
  "react",
  "../../../lib/utils/fireGlobalEvent"
],"useIframeLogin.ts":[
  "../../../../app/ui-utils/client",
  "../../../hooks/useReactiveValue"
],"useViewportScrolling.ts":[
  "react"
]},"AppLayout.tsx":[
  "react",
  "use-subscription",
  "../../lib/appLayout",
  "../../lib/portals/blazePortals",
  "./PageLoading",
  "./useTooltipHandling"
],"AppRoot.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/root/AppRoot.tsx                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var React, lazy, Suspense;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  lazy: function (v) {
    lazy = v;
  },
  Suspense: function (v) {
    Suspense = v;
  }
}, 0);
var QueryClientProvider;
module.link("react-query", {
  QueryClientProvider: function (v) {
    QueryClientProvider = v;
  }
}, 1);
var OmnichannelRoomIconProvider;
module.link("../../components/RoomIcon/OmnichannelRoomIcon/provider/OmnichannelRoomIconProvider", {
  OmnichannelRoomIconProvider: function (v) {
    OmnichannelRoomIconProvider = v;
  }
}, 2);
var queryClient;
module.link("../../lib/queryClient", {
  queryClient: function (v) {
    queryClient = v;
  }
}, 3);
var PageLoading;
module.link("./PageLoading", {
  "default": function (v) {
    PageLoading = v;
  }
}, 4);
var ConnectionStatusBar = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../../components/connectionStatus/ConnectionStatusBar');
});
var MeteorProvider = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../../providers/MeteorProvider');
});
var BannerRegion = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../banners/BannerRegion');
});
var AppLayout = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('./AppLayout');
});
var PortalsWrapper = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('./PortalsWrapper');
});

var AppRoot = function () {
  return /*#__PURE__*/React.createElement(Suspense, {
    fallback: /*#__PURE__*/React.createElement(PageLoading, null)
  }, /*#__PURE__*/React.createElement(MeteorProvider, null, /*#__PURE__*/React.createElement(QueryClientProvider, {
    client: queryClient
  }, /*#__PURE__*/React.createElement(OmnichannelRoomIconProvider, null, /*#__PURE__*/React.createElement(ConnectionStatusBar, null), /*#__PURE__*/React.createElement(BannerRegion, null), /*#__PURE__*/React.createElement(AppLayout, null), /*#__PURE__*/React.createElement(PortalsWrapper, null)))));
};

module.exportDefault(AppRoot);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"BlazeTemplate.tsx":[
  "meteor/blaze",
  "meteor/reactive-dict",
  "meteor/templating",
  "react"
],"CMSPage.tsx":[
  "react",
  "../../contexts/RouterContext",
  "../../contexts/SettingsContext"
],"PageLoading.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/root/PageLoading.tsx                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 0);

var PageLoading = function () {
  return /*#__PURE__*/React.createElement("div", {
    className: "page-loading"
  }, /*#__PURE__*/React.createElement("div", {
    className: "loading-animation"
  }, /*#__PURE__*/React.createElement("div", {
    className: "bounce bounce1"
  }), /*#__PURE__*/React.createElement("div", {
    className: "bounce bounce2"
  }), /*#__PURE__*/React.createElement("div", {
    className: "bounce bounce3"
  })));
};

module.exportDefault(PageLoading);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"PortalWrapper.ts":[
  "@babel/runtime/helpers/inheritsLoose",
  "react"
],"PortalsWrapper.tsx":[
  "react",
  "use-subscription",
  "../../lib/portals/portalsSubscription",
  "./PortalWrapper"
],"useTooltipHandling.ts":[
  "react",
  "../../../app/ui/client/components/tooltip",
  "../../contexts/UserContext",
  "../../lib/utils/domEvents"
]},"setupWizard":{"contexts":{"SetupWizardContext.tsx":[
  "@babel/runtime/regenerator",
  "react"
]},"hooks":{"useBodyPosition.ts":[
  "react"
],"useParameters.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../contexts/ServerContext"
],"useRouteLock.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/RouterContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/UserContext"
],"useStepRouting.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../contexts/RouterContext",
  "../../../contexts/UserContext"
]},"providers":{"OnboardingI18nProvider.tsx":[
  "i18next",
  "i18next-http-backend",
  "react",
  "react-i18next",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../root/PageLoading"
],"SetupWizardProvider.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "meteor/meteor",
  "react",
  "../../../../lib/callbacks",
  "../../../../lib/emailValidator",
  "../../../contexts/ServerContext",
  "../../../contexts/SessionContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../../../contexts/UserContext",
  "../contexts/SetupWizardContext",
  "../hooks/useParameters",
  "../hooks/useStepRouting"
]},"steps":{"AdminInfoStep.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/onboarding-ui",
  "react",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../contexts/SetupWizardContext"
],"CloudAccountConfirmation.tsx":[
  "@babel/runtime/regenerator",
  "@rocket.chat/onboarding-ui",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../contexts/SetupWizardContext"
],"OrganizationInfoStep.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/onboarding-ui",
  "react",
  "../../../contexts/TranslationContext",
  "../contexts/SetupWizardContext"
],"RegisterServerStep.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/onboarding-ui",
  "react",
  "../contexts/SetupWizardContext"
],"StandaloneServerStep.tsx":[
  "@babel/runtime/regenerator",
  "@rocket.chat/onboarding-ui",
  "react",
  "../../../contexts/SettingsContext",
  "../../../contexts/ToastMessagesContext",
  "../../../contexts/TranslationContext",
  "../contexts/SetupWizardContext"
]},"SetupWizardPage.tsx":[
  "react",
  "./contexts/SetupWizardContext",
  "./steps/AdminInfoStep",
  "./steps/CloudAccountConfirmation",
  "./steps/OrganizationInfoStep",
  "./steps/RegisterServerStep",
  "./steps/StandaloneServerStep"
],"SetupWizardRoute.tsx":[
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/onboarding-ui",
  "react",
  "./SetupWizardPage",
  "./hooks/useBodyPosition",
  "./hooks/useRouteLock",
  "./providers/OnboardingI18nProvider",
  "./providers/SetupWizardProvider"
]},"InfoPanel":{"Action.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"ActionGroup.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./Section"
],"Avatar.tsx":[
  "react",
  "./Section"
],"Field.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"InfoPanel.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Label.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"RetentionPolicyCallout.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/TranslationContext",
  "../../hooks/useFormattedRelativeTime"
],"Section.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Text.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react"
],"Title.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./Action",
  "./ActionGroup",
  "./Avatar",
  "./Field",
  "./InfoPanel",
  "./Label",
  "./Section",
  "./Text",
  "./Title"
]},"banners":{"BannerRegion.tsx":[
  "react",
  "use-subscription",
  "../../lib/banners",
  "./LegacyBanner",
  "./UiKitBanner"
],"LegacyBanner.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../lib/banners"
],"UiKitBanner.tsx":[
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../UIKit/hooks/useUIKitHandleAction",
  "../../UIKit/hooks/useUIKitHandleClose",
  "../../UIKit/hooks/useUIKitStateManager",
  "../../components/MarkdownText",
  "../../lib/banners"
]},"blocks":{"ConnectedModalBlock.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/apps-engine/definition/uikit/UIKitIncomingInteractionContainer",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../../app/ui-message/client/ActionManager",
  "./ModalBlock",
  "./textParsers"
],"MessageBlock.js":[
  "@rocket.chat/apps-engine/definition/uikit/UIKitIncomingInteractionContainer",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../../app/ui-message/client/ActionManager",
  "../../components/Message/hooks/useBlockRendered",
  "../../lib/utils/renderMessageBody",
  "./textParsers"
],"ModalBlock.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../../app/utils/lib/getURL",
  "./textParsers"
],"textParsers.js":[
  "@rocket.chat/fuselage-ui-kit",
  "react",
  "../../lib/utils/renderMessageBody"
]},"directory":{"ChannelsTab.js":[
  "react",
  "../../components/NotAuthorizedPage",
  "../../contexts/AuthorizationContext",
  "./ChannelsTable"
],"ChannelsTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../app/utils/client",
  "../../components/FilterByText",
  "../../components/GenericTable",
  "../../components/MarkdownText",
  "../../contexts/RouterContext",
  "../../contexts/TranslationContext",
  "../../hooks/useEndpointData",
  "../../hooks/useFormatDate",
  "./RoomTags",
  "./hooks"
],"DirectoryPage.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../components/Page",
  "../../contexts/RouterContext",
  "../../contexts/SettingsContext",
  "../../contexts/TranslationContext",
  "./ChannelsTab",
  "./TeamsTab",
  "./UserTab"
],"RoomTags.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/TranslationContext"
],"TeamsTab.js":[
  "react",
  "../../components/NotAuthorizedPage",
  "../../contexts/AuthorizationContext",
  "./TeamsTable"
],"TeamsTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../app/utils/client",
  "../../components/FilterByText",
  "../../components/GenericTable",
  "../../components/MarkdownText",
  "../../contexts/RouterContext",
  "../../contexts/TranslationContext",
  "../../hooks/useEndpointData",
  "../../hooks/useFormatDate",
  "./RoomTags",
  "./hooks"
],"UserTab.js":[
  "react",
  "../../components/NotAuthorizedPage",
  "../../contexts/AuthorizationContext",
  "./UserTable"
],"UserTable.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../components/FilterByText",
  "../../components/GenericTable",
  "../../components/MarkdownText",
  "../../components/avatar/UserAvatar",
  "../../contexts/AuthorizationContext",
  "../../contexts/RouterContext",
  "../../contexts/TranslationContext",
  "../../hooks/useEndpointData",
  "../../hooks/useFormatDate",
  "./hooks"
],"hooks.js":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "react"
]},"e2e":{"EnterE2EPasswordModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/e2e/EnterE2EPasswordModal.tsx                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Box, PasswordInput, Field, FieldGroup;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  PasswordInput: function (v) {
    PasswordInput = v;
  },
  Field: function (v) {
    Field = v;
  },
  FieldGroup: function (v) {
    FieldGroup = v;
  }
}, 0);
var useMutableCallback;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback: function (v) {
    useMutableCallback = v;
  }
}, 1);
var React, useState, useCallback;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useState: function (v) {
    useState = v;
  },
  useCallback: function (v) {
    useCallback = v;
  }
}, 2);
var GenericModal;
module.link("../../components/GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 3);
var useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 4);

var EnterE2EPasswordModal = function (_ref) {
  var onConfirm = _ref.onConfirm,
      onClose = _ref.onClose,
      onCancel = _ref.onCancel;
  var t = useTranslation();

  var _useState = useState(''),
      _useState2 = _slicedToArray(_useState, 2),
      password = _useState2[0],
      setPassword = _useState2[1];

  var _useState3 = useState(),
      _useState4 = _slicedToArray(_useState3, 2),
      passwordError = _useState4[0],
      setPasswordError = _useState4[1];

  var handleChange = useCallback(function (e) {
    e.target.value !== '' && setPasswordError(undefined);
    setPassword(e.currentTarget.value);
  }, [setPassword]);
  var handleConfirm = useMutableCallback(function () {
    if (password === '') {
      setPasswordError(t('Invalid_pass'));
      return;
    }

    return onConfirm(password);
  });
  return /*#__PURE__*/React.createElement(GenericModal, {
    variant: "warning",
    title: t('Enter_E2E_password'),
    cancelText: t('Do_It_Later'),
    confirmText: t('Decode_Key'),
    onConfirm: handleConfirm,
    onClose: onClose,
    onCancel: onCancel
  }, /*#__PURE__*/React.createElement(Box, {
    dangerouslySetInnerHTML: {
      __html: t('E2E_password_request_text')
    }
  }), /*#__PURE__*/React.createElement(FieldGroup, {
    mbs: "x24",
    w: "full"
  }, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(PasswordInput, {
    error: passwordError,
    value: password,
    onChange: handleChange,
    placeholder: t('New_Password_Placeholder')
  })), /*#__PURE__*/React.createElement(Field.Error, null, passwordError))));
};

module.exportDefault(EnterE2EPasswordModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"SaveE2EPasswordModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/views/e2e/SaveE2EPasswordModal.tsx                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);
var GenericModal;
module.link("../../components/GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 2);
var useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 3);

var SaveE2EPasswordModal = function (_ref) {
  var passwordRevealText = _ref.passwordRevealText,
      onClose = _ref.onClose,
      onCancel = _ref.onCancel,
      onConfirm = _ref.onConfirm;
  var t = useTranslation();
  return /*#__PURE__*/React.createElement(GenericModal, {
    onClose: onClose,
    onCancel: onCancel,
    onConfirm: onConfirm,
    cancelText: t('Do_It_Later'),
    confirmText: t('I_Saved_My_Password'),
    variant: "warning",
    title: t('Save_Your_Encryption_Password')
  }, /*#__PURE__*/React.createElement(Box, {
    dangerouslySetInnerHTML: {
      __html: passwordRevealText
    }
  }));
};

module.exportDefault(SaveE2EPasswordModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"hooks":{"useActionSpread.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "react"
],"useDepartmentsByUnitsList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../contexts/ServerContext",
  "../../hooks/lists/useScrollableRecordList",
  "../../hooks/useComponentDidUpdate",
  "../../lib/lists/RecordList"
],"useImperativeModal.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../lib/imperativeModal"
],"useMembersList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../contexts/ServerContext",
  "../../hooks/lists/useScrollableRecordList",
  "../../hooks/useComponentDidUpdate",
  "../../lib/lists/RecordList",
  "../../lib/utils/getConfig"
],"useMonitorsList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../contexts/ServerContext",
  "../../hooks/lists/useScrollableRecordList",
  "../../hooks/useComponentDidUpdate",
  "../../lib/lists/RecordList"
]},"invite":{"InvitePage.tsx":[
  "@babel/runtime/regenerator",
  "react",
  "react-query",
  "../../../app/utils/client",
  "../../contexts/RouterContext",
  "../../contexts/SessionContext",
  "../../contexts/SettingsContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../root/PageLoading"
],"SecretURLPage.tsx":[
  "@babel/runtime/regenerator",
  "react",
  "react-query",
  "../../../app/ui",
  "../../contexts/RouterContext",
  "../../contexts/SessionContext",
  "../../contexts/SettingsContext",
  "../../contexts/TranslationContext",
  "../../lib/utils/call",
  "../root/PageLoading"
]},"location":{"MapView.tsx":[
  "react",
  "../../contexts/SettingsContext",
  "./MapViewFallback",
  "./MapViewImage",
  "./useAsyncImage"
],"MapViewFallback.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../components/ExternalLink",
  "../../contexts/TranslationContext"
],"MapViewImage.tsx":[
  "react",
  "../../components/ExternalLink",
  "../../contexts/TranslationContext"
],"MessageLocation.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "./MapView"
],"useAsyncImage.ts":[
  "react",
  "../../hooks/useAsyncState"
]},"mailer":{"MailerUnsubscriptionPage.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/RouterContext",
  "../../contexts/ServerContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext",
  "../../hooks/useAsyncState"
]},"meet":{"CallPage.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "moment",
  "react",
  "../../../app/notifications/client",
  "../../../app/webrtc/client",
  "../../../app/webrtc/index",
  "../../components/avatar/UserAvatar",
  "../../contexts/TranslationContext",
  "./OngoingCallDuration",
  "./styles.css"
],"MeetPage.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "meteor/meteor",
  "react",
  "../../../app/utils/client",
  "../../components/avatar/UserAvatar",
  "../../contexts/RouterContext",
  "../notFound/NotFoundPage",
  "../root/PageLoading",
  "./CallPage",
  "./styles.css"
],"OngoingCallDuration.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react"
],"styles.css":[]},"notFound":{"NotFoundPage.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/RouterContext",
  "../../contexts/TranslationContext"
]}},"components":{"RoomIcon":{"OmnichannelRoomIcon":{"lib":{"OmnichannelRoomIcon.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomIcon/OmnichannelRoomIcon/lib/OmnichannelRoomIcon.ts                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);
var DOMPurify;
module.link("dompurify", {
  "default": function (v) {
    DOMPurify = v;
  }
}, 1);
var APIClient;
module.link("../../../../../app/utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 2);
var OmnichannelRoomIcon = new ( /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(_class2, _Emitter);

  function _class2() {
    var _this;

    _this = _Emitter.call(this) || this;
    _this.icons = new Map();
    return _this;
  }

  var _proto = _class2.prototype;

  _proto.get = function () {
    function get(appId, icon) {
      var _this2 = this;

      if (!appId || !icon) {
        return;
      }

      if (this.icons.has(appId + "-" + icon)) {
        return appId + "-" + icon;
      }

      APIClient.get("apps/public/" + appId + "/get-sidebar-icon", {
        icon: icon
      }).then(function (response) {
        _this2.icons.set(appId + "-" + icon, DOMPurify.sanitize(response, {
          FORBID_ATTR: ['id'],
          NAMESPACE: 'http://www.w3.org/2000/svg',
          USE_PROFILES: {
            svg: true,
            svgFilters: true
          }
        }).replace("<svg", "<symbol id=\"" + appId + "-" + icon + "\"").replace("</svg>", '</symbol>'));

        _this2.emit('change');

        _this2.emit(appId + "-" + icon);
      });
    }

    return get;
  }();

  return _class2;
}(Emitter))();
module.exportDefault(OmnichannelRoomIcon);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"context":{"OmnichannelRoomIconContext.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomIcon/OmnichannelRoomIcon/context/OmnichannelRoomIconContext.tsx                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  OmnichannelRoomIconContext: function () {
    return OmnichannelRoomIconContext;
  },
  useOmnichannelRoomIcon: function () {
    return useOmnichannelRoomIcon;
  }
});
var createContext, useMemo, useContext;
module.link("react", {
  createContext: function (v) {
    createContext = v;
  },
  useMemo: function (v) {
    useMemo = v;
  },
  useContext: function (v) {
    useContext = v;
  }
}, 0);
var useSubscription;
module.link("use-subscription", {
  useSubscription: function (v) {
    useSubscription = v;
  }
}, 1);
var AsyncStatePhase;
module.link("../../../../lib/asyncState/AsyncStatePhase", {
  AsyncStatePhase: function (v) {
    AsyncStatePhase = v;
  }
}, 2);
var OmnichannelRoomIconContext = /*#__PURE__*/createContext({
  queryIcon: function () {
    return {
      getCurrentValue: function () {
        return {
          phase: AsyncStatePhase.LOADING,
          value: undefined,
          error: undefined
        };
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  }
});

var useOmnichannelRoomIcon = function (app, icon) {
  var _useContext = useContext(OmnichannelRoomIconContext),
      queryIcon = _useContext.queryIcon;

  return useSubscription(useMemo(function () {
    return queryIcon(app, icon);
  }, [app, queryIcon, icon]));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"provider":{"OmnichannelRoomIconProvider.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomIcon/OmnichannelRoomIcon/provider/OmnichannelRoomIconProvider.tsx                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  OmnichannelRoomIconProvider: function () {
    return OmnichannelRoomIconProvider;
  }
});
var React, useMemo;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var createPortal;
module.link("react-dom", {
  createPortal: function (v) {
    createPortal = v;
  }
}, 1);
var useSubscription;
module.link("use-subscription", {
  useSubscription: function (v) {
    useSubscription = v;
  }
}, 2);
var AsyncStatePhase;
module.link("../../../../lib/asyncState/AsyncStatePhase", {
  AsyncStatePhase: function (v) {
    AsyncStatePhase = v;
  }
}, 3);
var OmnichannelRoomIconContext;
module.link("../context/OmnichannelRoomIconContext", {
  OmnichannelRoomIconContext: function (v) {
    OmnichannelRoomIconContext = v;
  }
}, 4);
var OmnichannelRoomIcon;
module.link("../lib/OmnichannelRoomIcon", {
  "default": function (v) {
    OmnichannelRoomIcon = v;
  }
}, 5);

var OmnichannelRoomIconProvider = function (_ref) {
  var children = _ref.children;
  var svgIcons = useSubscription(useMemo(function () {
    return {
      getCurrentValue: function () {
        return Array.from(OmnichannelRoomIcon.icons.values());
      },
      subscribe: function (callback) {
        return OmnichannelRoomIcon.on('change', callback);
      }
    };
  }, []));
  return /*#__PURE__*/React.createElement(OmnichannelRoomIconContext.Provider, {
    value: useMemo(function () {
      return {
        queryIcon: function (app, iconName) {
          return {
            getCurrentValue: function () {
              var icon = OmnichannelRoomIcon.get(app, iconName);

              if (!icon) {
                return {
                  phase: AsyncStatePhase.LOADING,
                  value: undefined,
                  error: undefined
                };
              }

              return {
                phase: AsyncStatePhase.RESOLVED,
                value: icon,
                error: undefined
              };
            },
            subscribe: function (callback) {
              return OmnichannelRoomIcon.on(app + "-" + iconName, callback);
            }
          };
        }
      };
    }, [])
  }, /*#__PURE__*/createPortal( /*#__PURE__*/React.createElement("svg", {
    xmlns: "http://www.w3.org/2000/svg",
    xmlnsXlink: "http://www.w3.org/1999/xlink",
    style: {
      display: 'none'
    },
    dangerouslySetInnerHTML: {
      __html: svgIcons.join('')
    }
  }), document.body, 'custom-icons'), children);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"OmnichannelAppSourceRoomIcon.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../lib/asyncState/AsyncStatePhase",
  "./context/OmnichannelRoomIconContext"
],"OmnichannelCoreSourceRoomIcon.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"OmnichannelRoomIcon.tsx":[
  "react",
  "../../../../definition/IRoom",
  "./OmnichannelAppSourceRoomIcon",
  "./OmnichannelCoreSourceRoomIcon"
],"index.tsx":[
  "./OmnichannelRoomIcon"
]},"RoomIcon.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../definition/IRoom",
  "../UserStatus",
  "./OmnichannelRoomIcon"
],"index.tsx":[
  "./RoomIcon"
]},"Message":{"Attachments":{"Attachment":{"Action.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Attachment.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../context/AttachmentContext"
],"Author.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"AuthorAvatar.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"AuthorName.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Block.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./Attachment"
],"Collapse.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../contexts/TranslationContext",
  "./Action"
],"Content.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Details.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Download.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../contexts/TranslationContext",
  "./Action"
],"Inner.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Row.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Size.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../../../hooks/useFormatMemorySize",
  "./Title"
],"Text.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Thumb.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Title.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"TitleLink.tsx":[
  "react",
  "./Title"
],"index.tsx":[
  "../components/Image",
  "./Attachment",
  "./Author",
  "./AuthorAvatar",
  "./AuthorName",
  "./Block",
  "./Collapse",
  "./Content",
  "./Details",
  "./Download",
  "./Inner",
  "./Row",
  "./Size",
  "./Text",
  "./Thumb",
  "./Title",
  "./TitleLink"
]},"FieldsAttachment":{"Field.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"ShortField.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./Field"
],"index.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./Field",
  "./ShortField"
]},"Files":{"AudioAttachment.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../MarkdownText",
  "../Attachment",
  "../context/AttachmentContext",
  "../hooks/useCollapse"
],"GenericFileAttachment.tsx":[
  "react",
  "../../../MarkdownText",
  "../Attachment",
  "../context/AttachmentContext"
],"ImageAttachment.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../MarkdownText",
  "../Attachment",
  "../components/Image",
  "../context/AttachmentContext",
  "../hooks/useCollapse",
  "../hooks/useLoadImage"
],"VideoAttachment.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../MarkdownText",
  "../Attachment",
  "../context/AttachmentContext",
  "../hooks/useCollapse"
],"index.tsx":[
  "react",
  "../../../../../definition/IMessage/MessageAttachment/Files/AudioAttachmentProps",
  "../../../../../definition/IMessage/MessageAttachment/Files/ImageAttachmentProps",
  "../../../../../definition/IMessage/MessageAttachment/Files/VideoAttachmentProps",
  "./AudioAttachment",
  "./GenericFileAttachment",
  "./ImageAttachment",
  "./VideoAttachment"
]},"components":{"Image.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../context/AttachmentContext",
  "./ImageBox",
  "./Load",
  "./Retry"
],"ImageBox.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Load.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../contexts/TranslationContext",
  "./ImageBox"
],"Retry.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../../../contexts/TranslationContext",
  "./ImageBox"
]},"context":{"AttachmentContext.tsx":[
  "react"
]},"hooks":{"useCollapse.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../Attachment",
  "../context/AttachmentContext"
],"useLoadImage.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../context/AttachmentContext"
]},"providers":{"AttachmentProvider.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../../app/utils/client",
  "../../../../contexts/LayoutContext",
  "../../../../contexts/UserContext",
  "../context/AttachmentContext"
]},"ActionAttachtment.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Attachments.tsx":[
  "react",
  "../hooks/useBlockRendered",
  "./Item"
],"DefaultAttachment.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../definition/IMessage/MessageAttachment/MessageAttachmentAction",
  "../../MarkdownText",
  "./ActionAttachtment",
  "./Attachment",
  "./FieldsAttachment",
  "./hooks/useCollapse"
],"Item.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "../../../../definition/IMessage/MessageAttachment/Files/FileAttachmentProps",
  "../../../../definition/IMessage/MessageAttachment/MessageQuoteAttachment",
  "./DefaultAttachment",
  "./Files",
  "./QuoteAttachment"
],"QuoteAttachment.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  ".",
  "../../../hooks/useTimeAgo",
  "../../MarkdownText",
  "./Attachment"
],"index.tsx":[
  "./Attachments"
]},"Actions":{"Action.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"Actions.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../Metrics/Content",
  "./Action"
],"index.tsx":[
  "./Actions"
]},"Body":{"BigEmoji.tsx":[
  "react",
  "../../Emoji"
],"Body.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./BigEmoji",
  "./Code",
  "./Heading",
  "./OrderedList",
  "./Paragraph",
  "./Quote",
  "./TaskList",
  "./UnorderedList"
],"Bold.tsx":[
  "react",
  "./Italic",
  "./Link",
  "./Strike"
],"Code.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../../app/markdown/lib/hljs",
  "./CodeLine"
],"CodeLine.tsx":[
  "react"
],"Heading.tsx":[
  "react"
],"Image.tsx":[
  "react"
],"Inline.tsx":[
  "react",
  "../../Emoji",
  "./Bold",
  "./Image",
  "./InlineCode",
  "./Italic",
  "./Link",
  "./Mention",
  "./Plain",
  "./Strike"
],"InlineCode.tsx":[
  "react"
],"Italic.tsx":[
  "react",
  "./Bold",
  "./Link",
  "./Strike"
],"Link.tsx":[
  "react",
  "../../../lib/baseURI",
  "./Bold",
  "./Italic",
  "./Strike"
],"Mention.tsx":[
  "react",
  "../../../contexts/UserContext"
],"OrderedList.tsx":[
  "react",
  "./Inline"
],"Paragraph.tsx":[
  "react",
  "./Inline"
],"Plain.tsx":[
  "react"
],"Quote.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "./Paragraph"
],"Strike.tsx":[
  "react",
  "./Bold",
  "./Italic",
  "./Link"
],"TaskList.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./Inline"
],"UnorderedList.tsx":[
  "react",
  "./Inline"
],"index.ts":[
  "./Body"
]},"Metrics":{"Broadcast.tsx":[
  "react",
  "../../../contexts/TranslationContext",
  "../hooks/useBlockRendered",
  "./Content",
  "./Reply"
],"Content.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"ContentItem.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Discussion.tsx":[
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useTimeAgo",
  "../hooks/useBlockRendered",
  "./Content",
  "./Reply",
  "./index"
],"Metrics.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./ContentItem"
],"MetricsFollowing.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"MetricsItem.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"MetricsItemIcon.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"MetricsItemLabel.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Reply.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./ContentItem"
],"Thread.tsx":[
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useTimeAgo",
  "../NotificationStatus",
  "../helpers/followSyle",
  "../hooks/useBlockRendered",
  "./Content",
  "./Reply",
  "./index"
],"index.tsx":[
  "./Metrics",
  "./MetricsFollowing",
  "./MetricsItem",
  "./MetricsItemIcon",
  "./MetricsItemLabel"
]},"NotificationStatus":{"All.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "./NotificationStatus"
],"Me.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "./NotificationStatus"
],"NotificationStatus.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"Unread.js":[
  "@babel/runtime/helpers/extends",
  "react",
  "./NotificationStatus"
],"index.ts":[
  "./All",
  "./Me",
  "./Unread"
]},"helpers":{"followSyle.js":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js"
]},"hooks":{"useBlockRendered.js":[
  "react"
]}},"Omnichannel":{"modals":{"ModalSeparator":{"ModalSeparator.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "./style.css"
],"index.ts":[
  "./ModalSeparator"
],"style.css":[]},"CloseChatModal.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/useComponentDidUpdate",
  "../../../hooks/useForm",
  "../../GenericModal",
  "../Tags"
],"CloseChatModalData.js":[
  "react",
  "../../../hooks/useAsyncState",
  "../../../hooks/useEndpointData",
  "../Skeleton",
  "./CloseChatModal"
],"ForwardChatModal.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/lists/useRecordList",
  "../../../hooks/useAsyncState",
  "../../../hooks/useForm",
  "../../UserAutoComplete",
  "../hooks/useDepartmentsList",
  "./ModalSeparator"
],"ReturnChatQueueModal.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext"
],"TranscriptModal.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useComponentDidUpdate",
  "../../../hooks/useForm"
]},"hooks":{"useAgentsList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/lists/useScrollableRecordList",
  "../../../hooks/useComponentDidUpdate",
  "../../../lib/lists/RecordList"
],"useDepartmentsList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../contexts/ServerContext",
  "../../../contexts/TranslationContext",
  "../../../hooks/lists/useScrollableRecordList",
  "../../../hooks/useComponentDidUpdate",
  "../../../lib/lists/RecordList"
]},"Skeleton.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Tags.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "use-subscription",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext",
  "../../hooks/useAsyncState",
  "../../hooks/useEndpointData",
  "../../views/omnichannel/additionalForms",
  "./Skeleton"
]},"GenericTable":{"V2":{"GenericTable.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../../ScrollableContentWrapper"
],"GenericTableBody.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"GenericTableCell.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"GenericTableHeader.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./GenericTableRow"
],"GenericTableHeaderCell.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../SortIcon"
],"GenericTableLoadingRow.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"GenericTableLoadingTable.tsx":[
  "react",
  "./GenericTableLoadingRow"
],"GenericTableRow.tsx":[
  "@rocket.chat/fuselage",
  "react"
]},"hooks":{"useCurrent.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "react"
],"useItemsPerPage.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "react"
],"useItemsPerPageLabel.ts":[
  "react",
  "../../../contexts/TranslationContext"
],"usePagination.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "./useCurrent",
  "./useItemsPerPage",
  "./useItemsPerPageLabel",
  "./useShowingResultsLabel"
],"useShowingResultsLabel.ts":[
  "react",
  "../../../contexts/TranslationContext"
],"useSort.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "react"
]},"GenericTable.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-keyed-flatten-children",
  "../../contexts/TranslationContext",
  "./V2/GenericTable",
  "./V2/GenericTableBody",
  "./V2/GenericTableHeader",
  "./V2/GenericTableLoadingTable",
  "./hooks/usePagination"
],"HeaderCell.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./SortIcon"
],"NoResults.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"SortIcon.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./GenericTable",
  "./HeaderCell",
  "./V2/GenericTable",
  "./V2/GenericTableBody",
  "./V2/GenericTableCell",
  "./V2/GenericTableHeader",
  "./V2/GenericTableHeaderCell",
  "./V2/GenericTableLoadingRow",
  "./V2/GenericTableLoadingTable",
  "./V2/GenericTableRow"
]},"RoomAutoComplete":{"hooks":{"useRoomsList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../../contexts/ServerContext",
  "../../../hooks/lists/useScrollableRecordList",
  "../../../hooks/useComponentDidUpdate",
  "../../../lib/lists/RecordList"
]},"Avatar.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomAutoComplete/Avatar.js                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["value", "type", "avatarETag"];

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);
var Options;
module.link("@rocket.chat/fuselage", {
  Options: function (v) {
    Options = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);
var RoomAvatar;
module.link("../avatar/RoomAvatar", {
  "default": function (v) {
    RoomAvatar = v;
  }
}, 2);

var Avatar = function (_ref) {
  var value = _ref.value,
      type = _ref.type,
      avatarETag = _ref.avatarETag,
      props = _objectWithoutProperties(_ref, _excluded);

  return /*#__PURE__*/React.createElement(RoomAvatar, _extends({
    size: Options.AvatarSize,
    room: {
      type: type,
      _id: value,
      avatarETag: avatarETag
    }
  }, props));
};

module.exportDefault(Avatar);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomAutoComplete.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomAutoComplete/RoomAutoComplete.js                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["value", "label"];

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 2);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 3);
var AutoComplete, Option, Box;
module.link("@rocket.chat/fuselage", {
  AutoComplete: function (v) {
    AutoComplete = v;
  },
  Option: function (v) {
    Option = v;
  },
  Box: function (v) {
    Box = v;
  }
}, 0);
var React, memo, useMemo, useState;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  memo: function (v) {
    memo = v;
  },
  useMemo: function (v) {
    useMemo = v;
  },
  useState: function (v) {
    useState = v;
  }
}, 1);
var useEndpointData;
module.link("../../hooks/useEndpointData", {
  useEndpointData: function (v) {
    useEndpointData = v;
  }
}, 2);
var RoomAvatar;
module.link("../avatar/RoomAvatar", {
  "default": function (v) {
    RoomAvatar = v;
  }
}, 3);
var Avatar;
module.link("./Avatar", {
  "default": function (v) {
    Avatar = v;
  }
}, 4);

var query = function () {
  var term = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  return {
    selector: JSON.stringify({
      name: term
    })
  };
};

var RoomAutoComplete = function (props) {
  var _useState = useState(''),
      _useState2 = _slicedToArray(_useState, 2),
      filter = _useState2[0],
      setFilter = _useState2[1];

  var _useEndpointData = useEndpointData('rooms.autocomplete.channelAndPrivate', useMemo(function () {
    return query(filter);
  }, [filter])),
      data = _useEndpointData.value;

  var options = useMemo(function () {
    return data && data.items.map(function (_ref) {
      var name = _ref.name,
          _id = _ref._id,
          avatarETag = _ref.avatarETag,
          t = _ref.t;
      return {
        value: _id,
        label: {
          name: name,
          avatarETag: avatarETag,
          type: t
        }
      };
    }) || [];
  }, [data]);
  return /*#__PURE__*/React.createElement(AutoComplete, _extends({}, props, {
    filter: filter,
    setFilter: setFilter,
    renderSelected: function (_ref2) {
      var value = _ref2.value,
          label = _ref2.label;
      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Box, {
        margin: "none",
        mi: "x2"
      }, /*#__PURE__*/React.createElement(RoomAvatar, {
        size: "x20",
        room: _objectSpread({
          type: (label === null || label === void 0 ? void 0 : label.type) || 'c',
          _id: value
        }, label)
      }), ' '), /*#__PURE__*/React.createElement(Box, {
        margin: "none",
        mi: "x2"
      }, label === null || label === void 0 ? void 0 : label.name));
    },
    renderItem: function (_ref3) {
      var value = _ref3.value,
          label = _ref3.label,
          props = _objectWithoutProperties(_ref3, _excluded);

      return /*#__PURE__*/React.createElement(Option, _extends({
        key: value
      }, props, {
        label: label.name,
        avatar: /*#__PURE__*/React.createElement(Avatar, _extends({
          value: value
        }, label))
      }));
    },
    options: options
  }));
};

module.exportDefault( /*#__PURE__*/memo(RoomAutoComplete));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/RoomAutoComplete/index.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./RoomAutoComplete", {
  "default": "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"avatar":{"UserAvatarEditor":{"UserAvatarEditor.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/TranslationContext",
  "../../../hooks/useFileInput",
  "../UserAvatar",
  "./UserAvatarSuggestions"
],"UserAvatarSuggestions.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./UserAvatarEditor"
]},"AppAvatar.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./BaseAvatar"
],"BaseAvatar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/avatar/BaseAvatar.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["size"];

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 2);
var Avatar, Skeleton;
module.link("@rocket.chat/fuselage", {
  Avatar: function (v) {
    Avatar = v;
  },
  Skeleton: function (v) {
    Skeleton = v;
  }
}, 0);
var React, useState;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useState: function (v) {
    useState = v;
  }
}, 1);

var BaseAvatar = function (_ref) {
  var size = _ref.size,
      props = _objectWithoutProperties(_ref, _excluded);

  var _useState = useState(false),
      _useState2 = _slicedToArray(_useState, 2),
      error = _useState2[0],
      setError = _useState2[1];

  if (error) {
    return /*#__PURE__*/React.createElement(Skeleton, _extends({
      variant: "rect"
    }, props));
  }

  return /*#__PURE__*/React.createElement(Avatar, _extends({
    onError: setError,
    size: size
  }, props));
};

module.exportDefault(BaseAvatar);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomAvatar.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/avatar/RoomAvatar.js                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["room"],
    _excluded2 = ["url"];

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);
var React, memo;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  memo: function (v) {
    memo = v;
  }
}, 0);
var useRoomAvatarPath;
module.link("../../contexts/AvatarUrlContext", {
  useRoomAvatarPath: function (v) {
    useRoomAvatarPath = v;
  }
}, 1);
var BaseAvatar;
module.link("./BaseAvatar", {
  "default": function (v) {
    BaseAvatar = v;
  }
}, 2);

function RoomAvatar(_ref) {
  var room = _ref.room,
      rest = _objectWithoutProperties(_ref, _excluded);

  var getRoomPathAvatar = useRoomAvatarPath();

  var _rest$url = rest.url,
      url = _rest$url === void 0 ? getRoomPathAvatar(room) : _rest$url,
      props = _objectWithoutProperties(rest, _excluded2);

  return /*#__PURE__*/React.createElement(BaseAvatar, _extends({
    url: url
  }, props));
}

module.exportDefault( /*#__PURE__*/memo(RoomAvatar));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"RoomAvatarEditor.js":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../app/utils/lib/getAvatarURL",
  "../../contexts/TranslationContext",
  "../../hooks/useFileInput",
  "./RoomAvatar"
],"UserAvatar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/avatar/UserAvatar.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["username", "etag"],
    _excluded2 = ["url"];

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);
var React, memo;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  memo: function (v) {
    memo = v;
  }
}, 0);
var useUserAvatarPath;
module.link("../../contexts/AvatarUrlContext", {
  useUserAvatarPath: function (v) {
    useUserAvatarPath = v;
  }
}, 1);
var BaseAvatar;
module.link("./BaseAvatar", {
  "default": function (v) {
    BaseAvatar = v;
  }
}, 2);

var UserAvatar = function (_ref) {
  var username = _ref.username,
      etag = _ref.etag,
      rest = _objectWithoutProperties(_ref, _excluded);

  var getUserAvatarPath = useUserAvatarPath();

  var _rest$url = rest.url,
      url = _rest$url === void 0 ? getUserAvatarPath(username, etag) : _rest$url,
      props = _objectWithoutProperties(rest, _excluded2);

  return /*#__PURE__*/React.createElement(BaseAvatar, _extends({
    url: url,
    title: username
  }, props));
};

module.exportDefault( /*#__PURE__*/memo(UserAvatar));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"BurgerMenu":{"BurgerBadge.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react"
],"BurgerIcon.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "./Line",
  "./Wrapper"
],"BurgerMenu.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../contexts/LayoutContext",
  "../../contexts/SessionContext",
  "../../hooks/useEmbeddedLayout",
  "./BurgerMenuButton"
],"BurgerMenuButton.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/TranslationContext",
  "./BurgerBadge",
  "./BurgerIcon"
],"Line.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react"
],"Wrapper.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./BurgerMenu"
]},"Card":{"Body.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Card.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"CardDivider.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"CardIcon.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Col.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"ColSection.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"ColTitle.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Footer.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Title.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./Body",
  "./Card",
  "./CardDivider",
  "./CardIcon",
  "./Col",
  "./ColSection",
  "./ColTitle",
  "./Footer",
  "./Title"
]},"CreateDiscussion":{"CreateDiscussion.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/CreateDiscussion/CreateDiscussion.tsx                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 2);
var Modal, Field, FieldGroup, ToggleSwitch, TextInput, TextAreaInput, ButtonGroup, Button, Icon, Box;
module.link("@rocket.chat/fuselage", {
  Modal: function (v) {
    Modal = v;
  },
  Field: function (v) {
    Field = v;
  },
  FieldGroup: function (v) {
    FieldGroup = v;
  },
  ToggleSwitch: function (v) {
    ToggleSwitch = v;
  },
  TextInput: function (v) {
    TextInput = v;
  },
  TextAreaInput: function (v) {
    TextAreaInput = v;
  },
  ButtonGroup: function (v) {
    ButtonGroup = v;
  },
  Button: function (v) {
    Button = v;
  },
  Icon: function (v) {
    Icon = v;
  },
  Box: function (v) {
    Box = v;
  }
}, 0);
var useMutableCallback;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback: function (v) {
    useMutableCallback = v;
  }
}, 1);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 2);
var useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 3);
var useEndpointActionExperimental;
module.link("../../hooks/useEndpointActionExperimental", {
  useEndpointActionExperimental: function (v) {
    useEndpointActionExperimental = v;
  }
}, 4);
var useForm;
module.link("../../hooks/useForm", {
  useForm: function (v) {
    useForm = v;
  }
}, 5);
var goToRoomById;
module.link("../../lib/utils/goToRoomById", {
  goToRoomById: function (v) {
    goToRoomById = v;
  }
}, 6);
var RoomAutoComplete;
module.link("../RoomAutoComplete", {
  "default": function (v) {
    RoomAutoComplete = v;
  }
}, 7);
var UserAutoCompleteMultiple;
module.link("../UserAutoCompleteMultiple", {
  "default": function (v) {
    UserAutoCompleteMultiple = v;
  }
}, 8);
var DefaultParentRoomField;
module.link("./DefaultParentRoomField", {
  "default": function (v) {
    DefaultParentRoomField = v;
  }
}, 9);

var CreateDiscussion = function (_ref) {
  var onClose = _ref.onClose,
      defaultParentRoom = _ref.defaultParentRoom,
      parentMessageId = _ref.parentMessageId,
      nameSuggestion = _ref.nameSuggestion;
  var t = useTranslation();

  var _useForm = useForm({
    name: nameSuggestion || '',
    parentRoom: '',
    encrypted: false,
    usernames: [],
    firstMessage: ''
  }),
      values = _useForm.values,
      handlers = _useForm.handlers;

  var name = values.name,
      parentRoom = values.parentRoom,
      encrypted = values.encrypted,
      usernames = values.usernames,
      firstMessage = values.firstMessage;
  var handleName = handlers.handleName,
      handleParentRoom = handlers.handleParentRoom,
      handleEncrypted = handlers.handleEncrypted,
      handleUsernames = handlers.handleUsernames,
      handleFirstMessage = handlers.handleFirstMessage;
  var canCreate = (parentRoom || defaultParentRoom) && name;
  var createDiscussion = useEndpointActionExperimental('POST', 'rooms.createDiscussion');
  var create = useMutableCallback(function () {
    function _callee() {
      var result;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.prev = 0;
                _context.next = 3;
                return _regeneratorRuntime.awrap(createDiscussion(_objectSpread({
                  prid: defaultParentRoom || parentRoom,
                  // eslint-disable-next-line @typescript-eslint/camelcase
                  t_name: name,
                  users: usernames,
                  reply: encrypted ? undefined : firstMessage
                }, parentMessageId && {
                  pmid: parentMessageId
                })));

              case 3:
                result = _context.sent;
                goToRoomById(result.discussion._id);
                onClose();
                _context.next = 11;
                break;

              case 8:
                _context.prev = 8;
                _context.t0 = _context["catch"](0);
                console.warn(_context.t0);

              case 11:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, [[0, 8]], Promise);
    }

    return _callee;
  }());
  var onChangeUsers = useMutableCallback(function (value, action) {
    if (!action) {
      if (usernames.includes(value)) {
        return;
      }

      return handleUsernames([].concat(_toConsumableArray(usernames), [value]));
    }

    handleUsernames(usernames.filter(function (current) {
      return current !== value;
    }));
  });
  return /*#__PURE__*/React.createElement(Modal, null, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, null, t('Discussion_title')), /*#__PURE__*/React.createElement(Modal.Close, {
    onClick: onClose
  })), /*#__PURE__*/React.createElement(Modal.Content, null, /*#__PURE__*/React.createElement(FieldGroup, null, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Description, null, t('Discussion_description'))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_target_channel')), /*#__PURE__*/React.createElement(Field.Row, null, defaultParentRoom && /*#__PURE__*/React.createElement(DefaultParentRoomField, {
    defaultParentRoom: defaultParentRoom
  }), !defaultParentRoom && /*#__PURE__*/React.createElement(RoomAutoComplete, {
    value: parentRoom,
    onChange: handleParentRoom,
    placeholder: t('Discussion_target_channel_description'),
    disabled: defaultParentRoom
  }))), /*#__PURE__*/React.createElement(Field, {
    display: "flex",
    alignItems: "center",
    flexDirection: "row",
    justifyContent: "spaceBetween",
    flexGrow: 1
  }, /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    flexDirection: "column",
    width: "full"
  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Encrypted'))), /*#__PURE__*/React.createElement(ToggleSwitch, {
    checked: encrypted,
    onChange: handleEncrypted
  })), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_name')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {
    value: name,
    onChange: handleName,
    addon: /*#__PURE__*/React.createElement(Icon, {
      name: "baloons",
      size: "x20"
    }),
    placeholder: t('New_discussion_name')
  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Invite_Users')), /*#__PURE__*/React.createElement(Field.Row, {
    w: "full",
    display: "flex",
    flexDirection: "column",
    alignItems: "stretch"
  }, /*#__PURE__*/React.createElement(UserAutoCompleteMultiple, {
    value: usernames,
    onChange: onChangeUsers,
    placeholder: t('Username_Placeholder')
  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_first_message_title')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextAreaInput, {
    value: firstMessage,
    onChange: handleFirstMessage,
    placeholder: t('New_discussion_first_message'),
    rows: 5,
    disabled: encrypted
  })), encrypted && /*#__PURE__*/React.createElement(Field.Description, null, t('Discussion_first_message_disabled_due_to_e2e'))))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(ButtonGroup, {
    align: "end"
  }, /*#__PURE__*/React.createElement(Button, {
    onClick: onClose
  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {
    primary: true,
    disabled: !canCreate,
    onClick: create
  }, t('Create')))));
};

module.exportDefault(CreateDiscussion);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"DefaultParentRoomField.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/CreateDiscussion/DefaultParentRoomField.tsx                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Skeleton, TextInput, Callout;
module.link("@rocket.chat/fuselage", {
  Skeleton: function (v) {
    Skeleton = v;
  },
  TextInput: function (v) {
    TextInput = v;
  },
  Callout: function (v) {
    Callout = v;
  }
}, 0);
var React, useMemo;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 1);
var roomTypes;
module.link("../../../app/utils/client/lib/roomTypes", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 2);
var useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 3);
var AsyncStatePhase;
module.link("../../hooks/useAsyncState", {
  AsyncStatePhase: function (v) {
    AsyncStatePhase = v;
  }
}, 4);
var useEndpointData;
module.link("../../hooks/useEndpointData", {
  useEndpointData: function (v) {
    useEndpointData = v;
  }
}, 5);

var DefaultParentRoomField = function (_ref) {
  var defaultParentRoom = _ref.defaultParentRoom;
  var t = useTranslation();

  var _useEndpointData = useEndpointData('rooms.info', useMemo(function () {
    return {
      roomId: defaultParentRoom
    };
  }, [defaultParentRoom])),
      value = _useEndpointData.value,
      phase = _useEndpointData.phase;

  if (phase === AsyncStatePhase.LOADING) {
    return /*#__PURE__*/React.createElement(Skeleton, {
      width: "full"
    });
  }

  if (!value || !value.room) {
    return /*#__PURE__*/React.createElement(Callout, {
      type: 'danger'
    }, t('Error'));
  }

  return /*#__PURE__*/React.createElement(TextInput, {
    value: roomTypes.getRoomName(value.room.t, value.room),
    disabled: true,
    onChange: function () {
      return '';
    }
  });
};

module.exportDefault(DefaultParentRoomField);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":[
  "./CreateDiscussion"
]},"Header":{"Avatar.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Avatar.tsx                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 0);
var Button;
module.link("./Button", {
  "default": function (v) {
    Button = v;
  }
}, 1);

var Avatar = function (props) {
  return /*#__PURE__*/React.createElement(Button, _extends({
    width: "x36"
  }, props));
};

module.exportDefault(Avatar);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Button.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Button.tsx                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var Button = function (props) {
  return /*#__PURE__*/React.createElement(Box, _extends({
    mi: "x4",
    display: "flex",
    alignItems: "center"
  }, props));
};

module.exportDefault(Button);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Content.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Content.tsx                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var Content = function (props) {
  return /*#__PURE__*/React.createElement(Box, _extends({
    flexGrow: 1,
    width: 1,
    flexShrink: 1,
    mi: "x4",
    display: "flex",
    justifyContent: "center",
    flexDirection: "column"
  }, props));
};

module.exportDefault(Content);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Header.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Header.tsx                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);
var useLayout;
module.link("../../contexts/LayoutContext", {
  useLayout: function (v) {
    useLayout = v;
  }
}, 2);
var HeaderDivider;
module.link("./HeaderDivider", {
  "default": function (v) {
    HeaderDivider = v;
  }
}, 3);

var Header = function (props) {
  var _useLayout = useLayout(),
      isMobile = _useLayout.isMobile;

  return /*#__PURE__*/React.createElement(Box, {
    "rcx-room-header": true,
    is: "header",
    height: "x64",
    display: "flex",
    justifyContent: "center",
    flexDirection: "column",
    overflow: "hidden",
    flexShrink: 0
  }, /*#__PURE__*/React.createElement(Box, _extends({
    height: "x64",
    mi: "neg-x4",
    pi: isMobile ? 'x12' : 'x24',
    display: "flex",
    flexGrow: 1,
    justifyContent: "center",
    alignItems: "center",
    overflow: "hidden",
    flexDirection: "row"
  }, props)), /*#__PURE__*/React.createElement(HeaderDivider, null));
};

module.exportDefault(Header);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderDivider.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderDivider.tsx                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Divider;
module.link("@rocket.chat/fuselage", {
  Divider: function (v) {
    Divider = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var HeaderDivider = function () {
  return /*#__PURE__*/React.createElement(Divider, {
    mbs: -2,
    mbe: 0
  });
};

module.exportDefault(HeaderDivider);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderIcon.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderIcon.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Box, Icon;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  Icon: function (v) {
    Icon = v;
  }
}, 0);
var React, isValidElement;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  isValidElement: function (v) {
    isValidElement = v;
  }
}, 1);

var HeaderIcon = function (_ref) {
  var icon = _ref.icon;
  return icon && /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    flexShrink: 0,
    alignItems: "center",
    size: 18,
    overflow: "hidden",
    justifyContent: "center"
  }, /*#__PURE__*/isValidElement(icon) ? icon : /*#__PURE__*/React.createElement(Icon, {
    color: "info",
    size: "x18",
    name: icon.name
  }));
};

module.exportDefault(HeaderIcon);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderLink.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderLink.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _templateObject;

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);

var _taggedTemplateLiteralLoose;

module.link("@babel/runtime/helpers/taggedTemplateLiteralLoose", {
  default: function (v) {
    _taggedTemplateLiteralLoose = v;
  }
}, 1);
var css;
module.link("@rocket.chat/css-in-js", {
  css: function (v) {
    css = v;
  }
}, 0);
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 1);
var colors;
module.link("@rocket.chat/fuselage-tokens/colors", {
  "default": function (v) {
    colors = v;
  }
}, 2);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 3);

var HeaderLink = function (props) {
  return /*#__PURE__*/React.createElement(Box, _extends({
    is: "a"
  }, props, {
    withTruncatedText: true,
    className: [css(_templateObject || (_templateObject = _taggedTemplateLiteralLoose(["\n\t\t\t\tcolor: ", " !important;\n\t\t\t\t&:hover,\n\t\t\t\t&:focus {\n\t\t\t\t\tcolor: ", " !important;\n\t\t\t\t}\n\t\t\t\t&:visited {\n\t\t\t\t\tcolor: ", ";\n\t\t\t\t}\n\t\t\t"])), colors.n700, colors.n800, colors.n800)].filter(Boolean)
  }));
};

module.exportDefault(HeaderLink);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderTag.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderTag.tsx                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["children"];

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 0);
var Box, Tag;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  Tag: function (v) {
    Tag = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var HeaderTag = function (_ref) {
  var children = _ref.children,
      props = _objectWithoutProperties(_ref, _excluded);

  return /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    minWidth: "65px",
    mi: "x4"
  }, /*#__PURE__*/React.createElement(Tag, props, /*#__PURE__*/React.createElement(Box, {
    alignItems: "center",
    fontScale: "c2",
    display: "flex",
    minWidth: 0
  }, children)));
};

module.exportDefault(HeaderTag);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderTagIcon.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderTagIcon.tsx                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var Box, Icon;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  Icon: function (v) {
    Icon = v;
  }
}, 0);
var colors;
module.link("@rocket.chat/fuselage-tokens/colors", {
  "default": function (v) {
    colors = v;
  }
}, 1);
var React, isValidElement;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  isValidElement: function (v) {
    isValidElement = v;
  }
}, 2);

var HeaderTagIcon = function (_ref) {
  var icon = _ref.icon;
  return icon ? /*#__PURE__*/React.createElement(Box, {
    w: "x16",
    mie: "x2",
    display: "inline-flex",
    justifyContent: "center"
  }, /*#__PURE__*/isValidElement(icon) ? icon : /*#__PURE__*/React.createElement(Icon, _extends({
    size: "x16",
    color: colors.n700
  }, icon))) : null;
};

module.exportDefault(HeaderTagIcon);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"HeaderTagSkeleton.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/HeaderTagSkeleton.tsx                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Skeleton;
module.link("@rocket.chat/fuselage", {
  Skeleton: function (v) {
    Skeleton = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var HeaderTagSkeleton = function () {
  return /*#__PURE__*/React.createElement(Skeleton, {
    width: "x48"
  });
};

module.exportDefault(HeaderTagSkeleton);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Row.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Row.tsx                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var Row = function (props) {
  return /*#__PURE__*/React.createElement(Box, _extends({
    alignItems: "center",
    flexShrink: 1,
    flexGrow: 1,
    display: "flex"
  }, props));
};

module.exportDefault(Row);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"State.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/State.tsx                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var Icon, ActionButton;
module.link("@rocket.chat/fuselage", {
  Icon: function (v) {
    Icon = v;
  },
  ActionButton: function (v) {
    ActionButton = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var State = function (props) {
  return props.onClick ? /*#__PURE__*/React.createElement(ActionButton, _extends({
    ghost: true,
    mini: true
  }, props)) : /*#__PURE__*/React.createElement(Icon, _extends({
    size: 16,
    name: props.icon
  }, props));
};

module.exportDefault(State);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Subtitle.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Subtitle.tsx                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var Subtitle = function (props) {
  return /*#__PURE__*/React.createElement(Box, _extends({
    color: "hint",
    fontScale: "p2",
    withTruncatedText: true
  }, props));
};

module.exportDefault(Subtitle);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"Title.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/Title.tsx                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var Title = function (props) {
  return /*#__PURE__*/React.createElement(Box, _extends({
    color: "default",
    mi: "x4",
    fontScale: "h4",
    withTruncatedText: true
  }, props));
};

module.exportDefault(Title);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ToolBox.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/ToolBox.tsx                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);
var ButtonGroup;
module.link("@rocket.chat/fuselage", {
  ButtonGroup: function (v) {
    ButtonGroup = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var ToolBox = function (props) {
  return /*#__PURE__*/React.createElement(ButtonGroup, _extends({
    mi: "x4",
    medium: true
  }, props));
};

module.exportDefault(ToolBox);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ToolBoxAction.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/ToolBoxAction.tsx                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["id", "icon", "color", "title", "action", "className", "index"];

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);
var ActionButton;
module.link("@rocket.chat/fuselage", {
  ActionButton: function (v) {
    ActionButton = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);

var ToolBoxAction = function (_ref) {
  var id = _ref.id,
      icon = _ref.icon,
      color = _ref.color,
      title = _ref.title,
      action = _ref.action,
      className = _ref.className,
      index = _ref.index,
      props = _objectWithoutProperties(_ref, _excluded);

  return /*#__PURE__*/React.createElement(ActionButton, _extends({
    className: className,
    onClick: action,
    title: title,
    "data-toolbox": index,
    key: id,
    icon: icon,
    position: "relative",
    ghost: true,
    tiny: true,
    overflow: "visible",
    color: !!color && color
  }, props));
};

module.exportDefault(ToolBoxAction);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ToolBoxActionBadge.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/ToolBoxActionBadge.tsx                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _templateObject;

var _taggedTemplateLiteralLoose;

module.link("@babel/runtime/helpers/taggedTemplateLiteralLoose", {
  default: function (v) {
    _taggedTemplateLiteralLoose = v;
  }
}, 0);
var css;
module.link("@rocket.chat/css-in-js", {
  css: function (v) {
    css = v;
  }
}, 0);
var Box, Badge;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  Badge: function (v) {
    Badge = v;
  }
}, 1);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 2);

var ToolBoxActionBadge = function (props) {
  return /*#__PURE__*/React.createElement(Box, {
    position: "absolute",
    className: css(_templateObject || (_templateObject = _taggedTemplateLiteralLoose(["\n\t\t\ttop: 0;\n\t\t\tright: 0;\n\t\t\ttransform: translate(30%, -30%);\n\t\t"])))
  }, /*#__PURE__*/React.createElement(Badge, props));
};

module.exportDefault(ToolBoxActionBadge);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Header/index.ts                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Avatar;
module.link("./Avatar", {
  "default": function (v) {
    Avatar = v;
  }
}, 0);
var Button;
module.link("./Button", {
  "default": function (v) {
    Button = v;
  }
}, 1);
var Content;
module.link("./Content", {
  "default": function (v) {
    Content = v;
  }
}, 2);
var Header;
module.link("./Header", {
  "default": function (v) {
    Header = v;
  }
}, 3);
var HeaderDivider;
module.link("./HeaderDivider", {
  "default": function (v) {
    HeaderDivider = v;
  }
}, 4);
var HeaderIcon;
module.link("./HeaderIcon", {
  "default": function (v) {
    HeaderIcon = v;
  }
}, 5);
var HeaderLink;
module.link("./HeaderLink", {
  "default": function (v) {
    HeaderLink = v;
  }
}, 6);
var HeaderTag;
module.link("./HeaderTag", {
  "default": function (v) {
    HeaderTag = v;
  }
}, 7);
var HeaderTagIcon;
module.link("./HeaderTagIcon", {
  "default": function (v) {
    HeaderTagIcon = v;
  }
}, 8);
var HeaderTagSkeleton;
module.link("./HeaderTagSkeleton", {
  "default": function (v) {
    HeaderTagSkeleton = v;
  }
}, 9);
var Row;
module.link("./Row", {
  "default": function (v) {
    Row = v;
  }
}, 10);
var State;
module.link("./State", {
  "default": function (v) {
    State = v;
  }
}, 11);
var Subtitle;
module.link("./Subtitle", {
  "default": function (v) {
    Subtitle = v;
  }
}, 12);
var Title;
module.link("./Title", {
  "default": function (v) {
    Title = v;
  }
}, 13);
var ToolBox;
module.link("./ToolBox", {
  "default": function (v) {
    ToolBox = v;
  }
}, 14);
var ToolBoxAction;
module.link("./ToolBoxAction", {
  "default": function (v) {
    ToolBoxAction = v;
  }
}, 15);
var ToolBoxActionBadge;
module.link("./ToolBoxActionBadge", {
  "default": function (v) {
    ToolBoxActionBadge = v;
  }
}, 16);
module.exportDefault(Object.assign(Header, {
  Button: Button,
  State: State,
  Avatar: Avatar,
  Content: Object.assign(Content, {
    Row: Row
  }),
  Title: Title,
  Subtitle: Subtitle,
  ToolBox: ToolBox,
  ToolBoxAction: Object.assign(ToolBoxAction, {
    Badge: ToolBoxActionBadge
  }),
  Divider: HeaderDivider,
  Icon: HeaderIcon,
  Link: HeaderLink,
  Tag: Object.assign(HeaderTag, {
    Icon: HeaderTagIcon,
    Skeleton: HeaderTagSkeleton
  }),
  Badge: ToolBoxActionBadge
}));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"Page":{"Page.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "./PageContext"
],"PageContent.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"PageContext.ts":[
  "react"
],"PageHeader.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/LayoutContext",
  "../BurgerMenu",
  "../Header",
  "./PageContext"
],"PageScrollableContent.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../ScrollableContentWrapper"
],"PageScrollableContentWithShadow.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "./PageContext",
  "./PageScrollableContent"
],"index.ts":[
  "./Page",
  "./PageContent",
  "./PageHeader",
  "./PageScrollableContent",
  "./PageScrollableContentWithShadow"
]},"Sidebar":{"Content.js":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../ScrollableContentWrapper"
],"GenericItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react"
],"Header.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"ItemsAssembler.js":[
  "react",
  "../../contexts/TranslationContext",
  "./Sidebar"
],"ListItem.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"NavigationItem.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/RouterContext",
  "./Sidebar"
],"Sidebar.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./Content",
  "./GenericItem",
  "./Header",
  "./ItemsAssembler",
  "./ListItem",
  "./NavigationItem",
  "./Sidebar"
]},"SortList":{"GroupingList.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/ServerContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../Sidebar/ListItem"
],"SortList.js":[
  "@rocket.chat/fuselage",
  "react",
  "./GroupingList",
  "./SortModeList",
  "./ViewModeList"
],"SortModeList.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/ServerContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../Sidebar/ListItem"
],"ViewModeList.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/ServerContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../Sidebar/ListItem"
],"index.ts":[
  "./SortList"
]},"TwoFactorModal":{"TwoFactorEmailModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/TwoFactorModal/TwoFactorEmailModal.tsx                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);
var Box, TextInput, Icon;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  TextInput: function (v) {
    TextInput = v;
  },
  Icon: function (v) {
    Icon = v;
  }
}, 0);
var useAutoFocus;
module.link("@rocket.chat/fuselage-hooks", {
  useAutoFocus: function (v) {
    useAutoFocus = v;
  }
}, 1);
var React, useState;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useState: function (v) {
    useState = v;
  }
}, 2);
var useEndpoint;
module.link("../../contexts/ServerContext", {
  useEndpoint: function (v) {
    useEndpoint = v;
  }
}, 3);
var useToastMessageDispatch;
module.link("../../contexts/ToastMessagesContext", {
  useToastMessageDispatch: function (v) {
    useToastMessageDispatch = v;
  }
}, 4);
var useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 5);
var GenericModal;
module.link("../GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 6);
var Method;
module.link("./TwoFactorModal", {
  Method: function (v) {
    Method = v;
  }
}, 7);

var TwoFactorEmailModal = function (_ref) {
  var onConfirm = _ref.onConfirm,
      onClose = _ref.onClose,
      emailOrUsername = _ref.emailOrUsername;
  var dispatchToastMessage = useToastMessageDispatch();
  var t = useTranslation();

  var _useState = useState(''),
      _useState2 = _slicedToArray(_useState, 2),
      code = _useState2[0],
      setCode = _useState2[1];

  var ref = useAutoFocus();
  var sendEmailCode = useEndpoint('POST', 'users.2fa.sendEmailCode');

  var onClickResendCode = function () {
    function _callee() {
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.prev = 0;
                _context.next = 3;
                return _regeneratorRuntime.awrap(sendEmailCode({
                  emailOrUsername: emailOrUsername
                }));

              case 3:
                dispatchToastMessage({
                  type: 'success',
                  message: t('Email_sent')
                });
                _context.next = 9;
                break;

              case 6:
                _context.prev = 6;
                _context.t0 = _context["catch"](0);
                dispatchToastMessage({
                  type: 'error',
                  message: t('error-email-send-failed', {
                    message: _context.t0
                  })
                });

              case 9:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, [[0, 6]], Promise);
    }

    return _callee;
  }();

  var onConfirmEmailCode = function () {
    onConfirm(code, Method.EMAIL);
  };

  var onChange = function (_ref2) {
    var currentTarget = _ref2.currentTarget;
    setCode(currentTarget.value);
  };

  return /*#__PURE__*/React.createElement(GenericModal, {
    onConfirm: onConfirmEmailCode,
    onCancel: onClose,
    confirmText: t('Verify'),
    title: t('Two-factor_authentication_email'),
    onClose: onClose,
    variant: "warning",
    icon: /*#__PURE__*/React.createElement(Icon, {
      size: "x20",
      name: "info",
      color: "default"
    }),
    confirmDisabled: !code
  }, /*#__PURE__*/React.createElement(Box, {
    mbe: "x16"
  }, t('Verify_your_email_for_the_code_we_sent')), /*#__PURE__*/React.createElement(Box, {
    mbe: "x4",
    display: "flex",
    justifyContent: "stretch"
  }, /*#__PURE__*/React.createElement(TextInput, {
    ref: ref,
    value: code,
    onChange: onChange,
    placeholder: t('Enter_authentication_code')
  })), /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    justifyContent: "end",
    is: "a",
    onClick: onClickResendCode
  }, t('Cloud_resend_email')));
};

module.exportDefault(TwoFactorEmailModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TwoFactorModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/TwoFactorModal/TwoFactorModal.tsx                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["onConfirm", "onClose"];

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 0);
module.export({
  Method: function () {
    return Method;
  }
});
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 0);
var TwoFactorEmail;
module.link("./TwoFactorEmailModal", {
  "default": function (v) {
    TwoFactorEmail = v;
  }
}, 1);
var TwoFactorPassword;
module.link("./TwoFactorPasswordModal", {
  "default": function (v) {
    TwoFactorPassword = v;
  }
}, 2);
var TwoFactorTotp;
module.link("./TwoFactorTotpModal", {
  "default": function (v) {
    TwoFactorTotp = v;
  }
}, 3);
var Method;

(function (Method) {
  Method["TOTP"] = "totp";
  Method["EMAIL"] = "email";
  Method["PASSWORD"] = "password";
})(Method || module.runSetters(Method = {}, ["Method"]));

var TwoFactorModal = function (_ref) {
  var onConfirm = _ref.onConfirm,
      onClose = _ref.onClose,
      props = _objectWithoutProperties(_ref, _excluded);

  if (props.method === Method.TOTP) {
    return /*#__PURE__*/React.createElement(TwoFactorTotp, {
      onConfirm: onConfirm,
      onClose: onClose
    });
  }

  if (props.method === Method.EMAIL) {
    var emailOrUsername = props.emailOrUsername;
    return /*#__PURE__*/React.createElement(TwoFactorEmail, {
      onConfirm: onConfirm,
      onClose: onClose,
      emailOrUsername: emailOrUsername
    });
  }

  if (props.method === Method.PASSWORD) {
    return /*#__PURE__*/React.createElement(TwoFactorPassword, {
      onConfirm: onConfirm,
      onClose: onClose
    });
  }

  throw new Error('Invalid Two Factor method');
};

module.exportDefault(TwoFactorModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TwoFactorPasswordModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/TwoFactorModal/TwoFactorPasswordModal.tsx                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Box, PasswordInput, Icon;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  PasswordInput: function (v) {
    PasswordInput = v;
  },
  Icon: function (v) {
    Icon = v;
  }
}, 0);
var useAutoFocus;
module.link("@rocket.chat/fuselage-hooks", {
  useAutoFocus: function (v) {
    useAutoFocus = v;
  }
}, 1);
var React, useState;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useState: function (v) {
    useState = v;
  }
}, 2);
var useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 3);
var GenericModal;
module.link("../GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 4);
var Method;
module.link("./TwoFactorModal", {
  Method: function (v) {
    Method = v;
  }
}, 5);

var TwoFactorPasswordModal = function (_ref) {
  var onConfirm = _ref.onConfirm,
      onClose = _ref.onClose;
  var t = useTranslation();

  var _useState = useState(''),
      _useState2 = _slicedToArray(_useState, 2),
      code = _useState2[0],
      setCode = _useState2[1];

  var ref = useAutoFocus();

  var onConfirmTotpCode = function () {
    onConfirm(code, Method.PASSWORD);
  };

  var onChange = function (_ref2) {
    var currentTarget = _ref2.currentTarget;
    setCode(currentTarget.value);
  };

  return /*#__PURE__*/React.createElement(GenericModal, {
    onConfirm: onConfirmTotpCode,
    onCancel: onClose,
    confirmText: t('Verify'),
    title: t('Please_enter_your_password'),
    onClose: onClose,
    variant: "warning",
    icon: /*#__PURE__*/React.createElement(Icon, {
      size: "x20",
      name: "info",
      color: "default"
    }),
    confirmDisabled: !code
  }, /*#__PURE__*/React.createElement(Box, {
    mbe: "x16"
  }, t('For_your_security_you_must_enter_your_current_password_to_continue')), /*#__PURE__*/React.createElement(Box, {
    mbe: "x16",
    display: "flex",
    justifyContent: "stretch"
  }, /*#__PURE__*/React.createElement(PasswordInput, {
    ref: ref,
    value: code,
    onChange: onChange,
    placeholder: t('Password')
  })));
};

module.exportDefault(TwoFactorPasswordModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TwoFactorTotpModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/TwoFactorModal/TwoFactorTotpModal.tsx                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
var Box, TextInput, Icon;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  TextInput: function (v) {
    TextInput = v;
  },
  Icon: function (v) {
    Icon = v;
  }
}, 0);
var useAutoFocus;
module.link("@rocket.chat/fuselage-hooks", {
  useAutoFocus: function (v) {
    useAutoFocus = v;
  }
}, 1);
var React, useState;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useState: function (v) {
    useState = v;
  }
}, 2);
var useTranslation;
module.link("../../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 3);
var GenericModal;
module.link("../GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 4);
var Method;
module.link("./TwoFactorModal", {
  Method: function (v) {
    Method = v;
  }
}, 5);

var TwoFactorTotpModal = function (_ref) {
  var onConfirm = _ref.onConfirm,
      onClose = _ref.onClose;
  var t = useTranslation();

  var _useState = useState(''),
      _useState2 = _slicedToArray(_useState, 2),
      code = _useState2[0],
      setCode = _useState2[1];

  var ref = useAutoFocus();

  var onConfirmTotpCode = function () {
    onConfirm(code, Method.TOTP);
  };

  var onChange = function (_ref2) {
    var currentTarget = _ref2.currentTarget;
    setCode(currentTarget.value);
  };

  return /*#__PURE__*/React.createElement(GenericModal, {
    onConfirm: onConfirmTotpCode,
    onCancel: onClose,
    confirmText: t('Verify'),
    title: t('Two Factor Authentication'),
    onClose: onClose,
    variant: "warning",
    icon: /*#__PURE__*/React.createElement(Icon, {
      size: "x20",
      name: "info",
      color: "default"
    }),
    confirmDisabled: !code
  }, /*#__PURE__*/React.createElement(Box, {
    mbe: "x16"
  }, t('Open_your_authentication_app_and_enter_the_code')), /*#__PURE__*/React.createElement(Box, {
    mbe: "x16",
    display: "flex",
    justifyContent: "stretch"
  }, /*#__PURE__*/React.createElement(TextInput, {
    ref: ref,
    value: code,
    onChange: onChange,
    placeholder: t('Enter_authentication_code')
  })));
};

module.exportDefault(TwoFactorTotpModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/TwoFactorModal/index.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./TwoFactorModal", {
  "default": "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"UserAutoComplete":{"Avatar.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../avatar/UserAvatar"
],"UserAutoComplete.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../hooks/useEndpointData",
  "../avatar/UserAvatar",
  "./Avatar"
],"index.js":[
  "./UserAutoComplete"
]},"UserAutoCompleteMultiple":{"UserAutoCompleteMultiple.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/UserAutoCompleteMultiple/UserAutoCompleteMultiple.js                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["value", "label"];

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 0);

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 1);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 2);
var AutoComplete, Box, Option, Chip;
module.link("@rocket.chat/fuselage", {
  AutoComplete: function (v) {
    AutoComplete = v;
  },
  Box: function (v) {
    Box = v;
  },
  Option: function (v) {
    Option = v;
  },
  Chip: function (v) {
    Chip = v;
  }
}, 0);
var useMutableCallback, useDebouncedValue;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback: function (v) {
    useMutableCallback = v;
  },
  useDebouncedValue: function (v) {
    useDebouncedValue = v;
  }
}, 1);
var React, memo, useMemo, useState;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  memo: function (v) {
    memo = v;
  },
  useMemo: function (v) {
    useMemo = v;
  },
  useState: function (v) {
    useState = v;
  }
}, 2);
var useEndpointData;
module.link("../../hooks/useEndpointData", {
  useEndpointData: function (v) {
    useEndpointData = v;
  }
}, 3);
var UserAvatar;
module.link("../avatar/UserAvatar", {
  "default": function (v) {
    UserAvatar = v;
  }
}, 4);

var query = function () {
  var term = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  return {
    selector: JSON.stringify({
      term: term
    })
  };
};

var UserAutoCompleteMultiple = function (props) {
  var _useState = useState(''),
      _useState2 = _slicedToArray(_useState, 2),
      filter = _useState2[0],
      setFilter = _useState2[1];

  var debouncedFilter = useDebouncedValue(filter, 1000);

  var _useEndpointData = useEndpointData('users.autocomplete', useMemo(function () {
    return query(debouncedFilter);
  }, [debouncedFilter])),
      data = _useEndpointData.value;

  var options = useMemo(function () {
    return data && data.items.map(function (user) {
      return {
        value: user.username,
        label: user.name
      };
    }) || [];
  }, [data]);
  var onClickRemove = useMutableCallback(function (e) {
    e.stopPropagation();
    e.preventDefault();
    props.onChange(e.currentTarget.value, 'remove');
  });
  return /*#__PURE__*/React.createElement(AutoComplete, _extends({}, props, {
    filter: filter,
    setFilter: setFilter,
    renderSelected: function (_ref) {
      var selected = _ref.value;
      return selected === null || selected === void 0 ? void 0 : selected.map(function (value) {
        return /*#__PURE__*/React.createElement(Chip, _extends({
          key: value
        }, props, {
          height: "x20",
          value: value,
          onClick: onClickRemove,
          mie: "x4"
        }), /*#__PURE__*/React.createElement(UserAvatar, {
          size: "x20",
          username: value
        }), /*#__PURE__*/React.createElement(Box, {
          is: "span",
          margin: "none",
          mis: "x4"
        }, value));
      });
    },
    renderItem: function (_ref2) {
      var value = _ref2.value,
          label = _ref2.label,
          props = _objectWithoutProperties(_ref2, _excluded);

      return /*#__PURE__*/React.createElement(Option, _extends({
        key: value
      }, props), /*#__PURE__*/React.createElement(Option.Avatar, null, /*#__PURE__*/React.createElement(UserAvatar, {
        username: value,
        size: "x20"
      })), /*#__PURE__*/React.createElement(Option.Content, null, label, " ", /*#__PURE__*/React.createElement(Option.Description, null, "(", value, ")")));
    },
    options: options
  }));
};

module.exportDefault( /*#__PURE__*/memo(UserAutoCompleteMultiple));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/UserAutoCompleteMultiple/index.ts                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./UserAutoCompleteMultiple", {
  "default": "default"
}, 0);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"UserCard":{"Action.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"Info.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Role.js":[
  "@rocket.chat/fuselage",
  "react"
],"Roles.js":[
  "react",
  "./Info"
],"UserCard.js":[
  "@rocket.chat/fuselage",
  "react",
  "../MarkdownText",
  "../UserStatus",
  "../avatar/UserAvatar",
  "./Info",
  "./Roles",
  "./UserCardContainer",
  "./Username"
],"UserCardContainer.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Username.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../UserStatus"
],"index.ts":[
  "./Action",
  "./Info",
  "./Role",
  "./Roles",
  "./UserCard",
  "./Username"
]},"UserStatus":{"Away.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./UserStatus"
],"Busy.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./UserStatus"
],"Loading.tsx":[
  "react",
  "./UserStatus"
],"Offline.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./UserStatus"
],"Online.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./UserStatus"
],"ReactiveUserStatus.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../hooks/usePresence",
  "./UserStatus"
],"UserStatus.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/TranslationContext"
],"index.ts":[
  "./UserStatus",
  "./Busy",
  "./Away",
  "./Online",
  "./Offline",
  "./Loading",
  "./ReactiveUserStatus"
]},"VerticalBar":{"VerticalBar.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../../providers/LayoutProvider"
],"VerticalBarAction.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarActionBack.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "./VerticalBarAction"
],"VerticalBarActions.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarButton.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarClose.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "../../contexts/TranslationContext",
  "./VerticalBarAction"
],"VerticalBarContent.tsx":[
  "@babel/runtime/helpers/extends",
  "react",
  "../Page"
],"VerticalBarFooter.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarHeader.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarIcon.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarInnerContent.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"VerticalBarScrollableContent.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../Page"
],"VerticalBarSkeleton.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "./VerticalBar",
  "./VerticalBarHeader"
],"VerticalBarText.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"index.ts":[
  "./VerticalBar",
  "./VerticalBarAction",
  "./VerticalBarActionBack",
  "./VerticalBarActions",
  "./VerticalBarButton",
  "./VerticalBarClose",
  "./VerticalBarContent",
  "./VerticalBarFooter",
  "./VerticalBarHeader",
  "./VerticalBarIcon",
  "./VerticalBarInnerContent",
  "./VerticalBarScrollableContent",
  "./VerticalBarSkeleton",
  "./VerticalBarText"
]},"connectionStatus":{"ConnectionStatusBar.css":[],"ConnectionStatusBar.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/ConnectionStatusContext",
  "../../contexts/TranslationContext",
  "./ConnectionStatusBar.css"
]},"data":{"Counter.js":[
  "@rocket.chat/fuselage",
  "react",
  "./Growth"
],"CounterSet.js":[
  "@rocket.chat/fuselage",
  "react",
  "./Counter"
],"Growth.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "./NegativeGrowthSymbol",
  "./PositiveGrowthSymbol"
],"NegativeGrowthSymbol.js":[
  "@babel/runtime/helpers/extends",
  "react"
],"PositiveGrowthSymbol.js":[
  "@babel/runtime/helpers/extends",
  "react"
]},"AutoCompleteAgent.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../hooks/lists/useRecordList",
  "../lib/asyncState",
  "./Omnichannel/hooks/useAgentsList"
],"AutoCompleteDepartment.js":[
  "@babel/runtime/helpers/typeof",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../contexts/TranslationContext",
  "../hooks/lists/useRecordList",
  "../hooks/useAsyncState",
  "./Omnichannel/hooks/useDepartmentsList"
],"AutoCompleteDepartmentMultiple.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../contexts/TranslationContext",
  "../hooks/lists/useRecordList",
  "../hooks/useAsyncState",
  "./Omnichannel/hooks/useDepartmentsList"
],"Backdrop.tsx":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"ConfirmOwnerChangeWarningModal.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../contexts/TranslationContext",
  "./GenericModal",
  "./RawText"
],"CustomFieldsForm.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/string-helpers",
  "react",
  "../contexts/SettingsContext",
  "../contexts/TranslationContext",
  "../hooks/useComponentDidUpdate",
  "../hooks/useForm"
],"DotLeader.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"Emoji.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/Emoji.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 0);
var renderEmoji;
module.link("../lib/utils/renderEmoji", {
  renderEmoji: function (v) {
    renderEmoji = v;
  }
}, 1);

function Emoji(_ref) {
  var emojiHandle = _ref.emojiHandle,
      _ref$className = _ref.className,
      className = _ref$className === void 0 ? undefined : _ref$className;
  var markup = {
    __html: "" + renderEmoji(emojiHandle)
  };
  return /*#__PURE__*/React.createElement("span", {
    className: className,
    dangerouslySetInnerHTML: markup
  });
}

module.exportDefault(Emoji);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ErrorBoundary.tsx":[
  "@babel/runtime/helpers/inheritsLoose",
  "react"
],"ExternalLink.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react"
],"FilterByText.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../contexts/TranslationContext"
],"GenericModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/GenericModal.tsx                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["variant", "children", "cancelText", "confirmText", "title", "icon", "onCancel", "onClose", "onConfirm", "dontAskAgain", "confirmDisabled"];

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);
module.export({
  GenericModalDoNotAskAgain: function () {
    return GenericModalDoNotAskAgain;
  }
});
var Box, Button, ButtonGroup, Icon, Modal;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  Button: function (v) {
    Button = v;
  },
  ButtonGroup: function (v) {
    ButtonGroup = v;
  },
  Icon: function (v) {
    Icon = v;
  },
  Modal: function (v) {
    Modal = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);
var useTranslation;
module.link("../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 2);
var withDoNotAskAgain;
module.link("./withDoNotAskAgain", {
  withDoNotAskAgain: function (v) {
    withDoNotAskAgain = v;
  }
}, 3);
var iconMap = {
  danger: 'modal-warning',
  warning: 'modal-warning',
  info: 'info',
  success: 'check'
};

var getButtonProps = function (variant) {
  switch (variant) {
    case 'danger':
      return {
        primary: true,
        danger: true
      };

    case 'warning':
      return {
        primary: true
      };

    default:
      return {};
  }
};

var renderIcon = function (icon, variant) {
  if (icon === null) {
    return null;
  }

  if (icon === undefined) {
    return /*#__PURE__*/React.createElement(Icon, {
      color: variant,
      name: iconMap[variant],
      size: 24
    });
  }

  if (typeof icon === 'string') {
    return /*#__PURE__*/React.createElement(Icon, {
      color: variant,
      name: icon,
      size: 24
    });
  }

  return icon;
};

var GenericModal = function (_ref) {
  var _ref$variant = _ref.variant,
      variant = _ref$variant === void 0 ? 'info' : _ref$variant,
      children = _ref.children,
      cancelText = _ref.cancelText,
      confirmText = _ref.confirmText,
      title = _ref.title,
      icon = _ref.icon,
      onCancel = _ref.onCancel,
      _ref$onClose = _ref.onClose,
      onClose = _ref$onClose === void 0 ? onCancel : _ref$onClose,
      onConfirm = _ref.onConfirm,
      dontAskAgain = _ref.dontAskAgain,
      confirmDisabled = _ref.confirmDisabled,
      props = _objectWithoutProperties(_ref, _excluded);

  var t = useTranslation();
  return /*#__PURE__*/React.createElement(Modal, props, /*#__PURE__*/React.createElement(Modal.Header, null, renderIcon(icon, variant), /*#__PURE__*/React.createElement(Modal.Title, null, title !== null && title !== void 0 ? title : t('Are_you_sure')), /*#__PURE__*/React.createElement(Modal.Close, {
    onClick: onClose
  })), /*#__PURE__*/React.createElement(Modal.Content, {
    fontScale: "p2"
  }, children), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(Box, {
    display: "flex",
    flexDirection: "row",
    justifyContent: "space-between",
    alignItems: "center"
  }, dontAskAgain, /*#__PURE__*/React.createElement(ButtonGroup, {
    align: "end",
    flexGrow: 1,
    maxWidth: "full"
  }, onCancel && /*#__PURE__*/React.createElement(Button, {
    ghost: true,
    onClick: onCancel
  }, cancelText !== null && cancelText !== void 0 ? cancelText : t('Cancel')), /*#__PURE__*/React.createElement(Button, _extends({}, getButtonProps(variant), {
    onClick: onConfirm,
    disabled: confirmDisabled
  }), confirmText !== null && confirmText !== void 0 ? confirmText : t('Ok'))))));
};

var GenericModalDoNotAskAgain = withDoNotAskAgain(GenericModal);
module.exportDefault(GenericModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"LocalTime.tsx":[
  "react",
  "../contexts/TranslationContext",
  "../hooks/useUTCClock"
],"MarkdownText.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "dompurify",
  "marked",
  "react",
  "../lib/utils/renderMessageEmoji"
],"ModalPortal.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "react-dom"
],"NotAuthorizedPage.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "../contexts/TranslationContext",
  "./Page"
],"PageSkeleton.tsx":[
  "@rocket.chat/fuselage",
  "react",
  "./Page"
],"PlanTag.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../contexts/ServerContext"
],"RawText.js":[
  "react"
],"RoomForeword.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../app/models/client",
  "../../app/utils/client",
  "../contexts/TranslationContext",
  "../contexts/UserContext",
  "../hooks/useReactiveValue"
],"ScrollableContentWrapper.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "rc-scrollbars",
  "react"
],"Skeleton.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"Subtitle.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react"
],"TextCopy.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../contexts/ToastMessagesContext",
  "../contexts/TranslationContext"
],"TooltipComponent.tsx":[
  "@rocket.chat/fuselage",
  "react"
],"UTCClock.tsx":[
  "react",
  "../hooks/useUTCClock"
],"UrlChangeModal.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/UrlChangeModal.tsx                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Box;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);
var useTranslation;
module.link("../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 2);
var GenericModal;
module.link("./GenericModal", {
  "default": function (v) {
    GenericModal = v;
  }
}, 3);

var UrlChangeModal = function (_ref) {
  var onConfirm = _ref.onConfirm,
      siteUrl = _ref.siteUrl,
      currentUrl = _ref.currentUrl,
      onClose = _ref.onClose;
  var t = useTranslation();
  return /*#__PURE__*/React.createElement(GenericModal, {
    variant: "warning",
    title: t('Warning'),
    onConfirm: onConfirm,
    onClose: onClose,
    onCancel: onClose,
    confirmText: t('Yes')
  }, /*#__PURE__*/React.createElement(Box, {
    is: "p",
    mbe: "x16",
    dangerouslySetInnerHTML: {
      __html: t('The_setting_s_is_configured_to_s_and_you_are_accessing_from_s', t('Site_Url'), siteUrl, currentUrl)
    }
  }), /*#__PURE__*/React.createElement("p", {
    dangerouslySetInnerHTML: {
      __html: t('Do_you_want_to_change_to_s_question', currentUrl)
    }
  }));
};

module.exportDefault(UrlChangeModal);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserStatusMenu.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "react",
  "../contexts/SettingsContext",
  "../contexts/TranslationContext",
  "./UserStatus"
],"withDoNotAskAgain.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/components/withDoNotAskAgain.tsx                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["onConfirm", "dontAskAgain"];

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _extends;

module.link("@babel/runtime/helpers/extends", {
  default: function (v) {
    _extends = v;
  }
}, 1);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 2);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 3);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 4);
module.export({
  withDoNotAskAgain: function () {
    return withDoNotAskAgain;
  }
});
var Box, CheckBox;
module.link("@rocket.chat/fuselage", {
  Box: function (v) {
    Box = v;
  },
  CheckBox: function (v) {
    CheckBox = v;
  }
}, 0);
var React, useState;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  useState: function (v) {
    useState = v;
  }
}, 1);
var useMethod;
module.link("../contexts/ServerContext", {
  useMethod: function (v) {
    useMethod = v;
  }
}, 2);
var useTranslation;
module.link("../contexts/TranslationContext", {
  useTranslation: function (v) {
    useTranslation = v;
  }
}, 3);
var useUserPreference;
module.link("../contexts/UserContext", {
  useUserPreference: function (v) {
    useUserPreference = v;
  }
}, 4);

function withDoNotAskAgain(Component) {
  var _ref2, _Component$displayNam;

  var WrappedComponent = function (_ref) {
    var onConfirm = _ref.onConfirm,
        dontAskAgain = _ref.dontAskAgain,
        props = _objectWithoutProperties(_ref, _excluded);

    var t = useTranslation();
    var dontAskAgainList = useUserPreference('dontAskAgainList');
    var action = dontAskAgain.action,
        label = dontAskAgain.label;
    var saveFn = useMethod('saveUserPreferences');

    var _useState = useState(false),
        _useState2 = _slicedToArray(_useState, 2),
        state = _useState2[0],
        setState = _useState2[1];

    var handleConfirm = function () {
      function _callee() {
        return _regeneratorRuntime.async(function () {
          function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  _context.prev = 0;

                  if (!state) {
                    _context.next = 4;
                    break;
                  }

                  _context.next = 4;
                  return _regeneratorRuntime.awrap(saveFn({
                    dontAskAgainList: [].concat(_toConsumableArray(dontAskAgainList || []), [{
                      action: action,
                      label: label
                    }])
                  }));

                case 4:
                  _context.next = 6;
                  return _regeneratorRuntime.awrap(onConfirm());

                case 6:
                  _context.next = 11;
                  break;

                case 8:
                  _context.prev = 8;
                  _context.t0 = _context["catch"](0);
                  console.error(_context.t0);

                case 11:
                case "end":
                  return _context.stop();
              }
            }
          }

          return _callee$;
        }(), null, null, [[0, 8]], Promise);
      }

      return _callee;
    }();

    var onChange = function () {
      setState(!state);
    };

    return /*#__PURE__*/React.createElement(Component, _extends({}, props, {
      dontAskAgain: /*#__PURE__*/React.createElement(Box, {
        display: "flex",
        flexDirection: "row"
      }, /*#__PURE__*/React.createElement(CheckBox, {
        checked: state,
        onChange: onChange,
        mie: "x4",
        name: "dont_ask_again"
      }), /*#__PURE__*/React.createElement("label", {
        htmlFor: "dont_ask_again"
      }, t('Dont_ask_me_again'))),
      onConfirm: handleConfirm
    }));
  };

  WrappedComponent.displayName = "withDoNotAskAgain(" + ((_ref2 = (_Component$displayNam = Component.displayName) !== null && _Component$displayNam !== void 0 ? _Component$displayNam : Component.name) !== null && _ref2 !== void 0 ? _ref2 : 'Component') + ")";
  return WrappedComponent;
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lib":{"2fa":{"overrideLoginMethod.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/2fa/overrideLoginMethod.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);
module.export({
  overrideLoginMethod: function () {
    return overrideLoginMethod;
  }
});
var t;
module.link("../../../app/utils/client", {
  t: function (v) {
    t = v;
  }
}, 0);
var dispatchToastMessage;
module.link("../toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 1);
var process2faReturn;
module.link("./process2faReturn", {
  process2faReturn: function (v) {
    process2faReturn = v;
  }
}, 2);
var isTotpInvalidError, isTotpRequiredError;
module.link("./utils", {
  isTotpInvalidError: function (v) {
    isTotpInvalidError = v;
  },
  isTotpRequiredError: function (v) {
    isTotpRequiredError = v;
  }
}, 3);

var overrideLoginMethod = function (loginMethod, loginArgs, callback, loginMethodTOTP, emailOrUsername) {
  loginMethod.call.apply(loginMethod, [null].concat(_toConsumableArray(loginArgs), [function (error, result) {
    if (!isTotpRequiredError(error)) {
      callback(error);
      return;
    }

    process2faReturn({
      error: error,
      result: result,
      emailOrUsername: emailOrUsername,
      originalCallback: callback,
      onCode: function (code) {
        loginMethodTOTP === null || loginMethodTOTP === void 0 ? void 0 : loginMethodTOTP.call.apply(loginMethodTOTP, [null].concat(_toConsumableArray(loginArgs), [code, function (error) {
          if (isTotpInvalidError(error)) {
            dispatchToastMessage({
              type: 'error',
              message: t('Invalid_two_factor_code')
            });
            callback(null);
            return;
          }

          callback(error);
        }]));
      }
    });
  }]));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"process2faReturn.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/2fa/process2faReturn.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _typeof;

module.link("@babel/runtime/helpers/typeof", {
  default: function (v) {
    _typeof = v;
  }
}, 1);
module.export({
  process2faReturn: function () {
    return process2faReturn;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var SHA256;
module.link("meteor/sha", {
  SHA256: function (v) {
    SHA256 = v;
  }
}, 1);
var TwoFactorModal;
module.link("../../components/TwoFactorModal", {
  "default": function (v) {
    TwoFactorModal = v;
  }
}, 2);
var imperativeModal;
module.link("../imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 3);
var isTotpRequiredError;
module.link("./utils", {
  isTotpRequiredError: function (v) {
    isTotpRequiredError = v;
  }
}, 4);
var twoFactorMethods = ['totp', 'email', 'password'];

var isTwoFactorMethod = function (method) {
  return twoFactorMethods.includes(method);
};

var hasRequiredTwoFactorMethod = function (error) {
  var details = error.details;
  return _typeof(details) === 'object' && details !== null && typeof details.method === 'string' && isTwoFactorMethod(details.method);
};

function assertModalProps(props) {
  if (props.method === 'email' && typeof props.emailOrUsername !== 'string') {
    throw new Error('Invalid Two Factor method');
  }
}

function process2faReturn(_ref) {
  var _Meteor$user;

  var error = _ref.error,
      result = _ref.result,
      originalCallback = _ref.originalCallback,
      onCode = _ref.onCode,
      emailOrUsername = _ref.emailOrUsername;

  if (!isTotpRequiredError(error) || !hasRequiredTwoFactorMethod(error)) {
    originalCallback(error, result);
    return;
  }

  var props = {
    method: error.details.method,
    emailOrUsername: emailOrUsername !== null && emailOrUsername !== void 0 ? emailOrUsername : (_Meteor$user = Meteor.user()) === null || _Meteor$user === void 0 ? void 0 : _Meteor$user.username
  };
  assertModalProps(props);
  imperativeModal.open({
    component: TwoFactorModal,
    props: _objectSpread(_objectSpread({}, props), {}, {
      onConfirm: function (code, method) {
        imperativeModal.close();
        onCode(method === 'password' ? SHA256(code) : code, method);
      },
      onClose: function () {
        imperativeModal.close();
        originalCallback(new Meteor.Error('totp-canceled'));
      }
    })
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"utils.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/2fa/utils.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _typeof;

module.link("@babel/runtime/helpers/typeof", {
  default: function (v) {
    _typeof = v;
  }
}, 0);
module.export({
  isTotpRequiredError: function () {
    return isTotpRequiredError;
  },
  isTotpInvalidError: function () {
    return isTotpInvalidError;
  },
  isLoginCancelledError: function () {
    return isLoginCancelledError;
  },
  reportError: function () {
    return reportError;
  },
  convertError: function () {
    return convertError;
  }
});
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);

var isTotpRequiredError = function (error) {
  return _typeof(error) === 'object' && ((error === null || error === void 0 ? void 0 : error.error) === 'totp-required' || (error === null || error === void 0 ? void 0 : error.errorType) === 'totp-required');
};

var isTotpInvalidError = function (error) {
  return (error === null || error === void 0 ? void 0 : error.error) === 'totp-invalid' || (error === null || error === void 0 ? void 0 : error.errorType) === 'totp-invalid';
};

var isLoginCancelledError = function (error) {
  return error instanceof Meteor.Error && error.error === Accounts.LoginCancelledError.numericError;
};

var reportError = function (error, callback) {
  if (callback) {
    callback(error);
    return;
  }

  throw error;
};

var convertError = function (error) {
  if (isLoginCancelledError(error)) {
    return new Accounts.LoginCancelledError(error.reason);
  }

  return error;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"asyncState":{"AsyncState.ts":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/asyncState/AsyncState.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"AsyncStatePhase.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/asyncState/AsyncStatePhase.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AsyncStatePhase: function () {
    return AsyncStatePhase;
  }
});
var AsyncStatePhase;

(function (AsyncStatePhase) {
  AsyncStatePhase["LOADING"] = "loading";
  AsyncStatePhase["RESOLVED"] = "resolved";
  AsyncStatePhase["REJECTED"] = "rejected";
  AsyncStatePhase["UPDATING"] = "updating";
})(AsyncStatePhase || module.runSetters(AsyncStatePhase = {}, ["AsyncStatePhase"]));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"functions.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/asyncState/functions.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  loading: function () {
    return loading;
  },
  updating: function () {
    return updating;
  },
  resolved: function () {
    return resolved;
  },
  rejected: function () {
    return rejected;
  },
  reload: function () {
    return reload;
  },
  update: function () {
    return update;
  },
  resolve: function () {
    return resolve;
  },
  reject: function () {
    return reject;
  },
  value: function () {
    return value;
  },
  error: function () {
    return error;
  }
});
var AsyncStatePhase;
module.link("./AsyncStatePhase", {
  AsyncStatePhase: function (v) {
    AsyncStatePhase = v;
  }
}, 0);

var loading = function () {
  return {
    phase: AsyncStatePhase.LOADING,
    value: undefined,
    error: undefined
  };
};

var updating = function (value) {
  return {
    phase: AsyncStatePhase.UPDATING,
    value: value,
    error: undefined
  };
};

var resolved = function (value) {
  return {
    phase: AsyncStatePhase.RESOLVED,
    value: value,
    error: undefined
  };
};

var rejected = function (error) {
  return {
    phase: AsyncStatePhase.REJECTED,
    value: undefined,
    error: error
  };
};

var reload = function (prevState) {
  switch (prevState.phase) {
    case AsyncStatePhase.LOADING:
      return prevState;

    case AsyncStatePhase.UPDATING:
    case AsyncStatePhase.RESOLVED:
      return {
        phase: AsyncStatePhase.LOADING,
        value: prevState.value,
        error: undefined
      };

    case AsyncStatePhase.REJECTED:
      return {
        phase: AsyncStatePhase.LOADING,
        value: undefined,
        error: prevState.error
      };
  }
};

var update = function (prevState) {
  switch (prevState.phase) {
    case AsyncStatePhase.LOADING:
    case AsyncStatePhase.UPDATING:
      return prevState;

    case AsyncStatePhase.RESOLVED:
      return {
        phase: AsyncStatePhase.UPDATING,
        value: prevState.value,
        error: undefined
      };

    case AsyncStatePhase.REJECTED:
      return {
        phase: AsyncStatePhase.LOADING,
        value: undefined,
        error: prevState.error
      };
  }
};

var resolve = function (prevState, value) {
  switch (prevState.phase) {
    case AsyncStatePhase.LOADING:
    case AsyncStatePhase.UPDATING:
      return {
        phase: AsyncStatePhase.RESOLVED,
        value: value,
        error: undefined
      };

    case AsyncStatePhase.RESOLVED:
    case AsyncStatePhase.REJECTED:
      return prevState;
  }
};

var reject = function (prevState, error) {
  switch (prevState.phase) {
    case AsyncStatePhase.LOADING:
    case AsyncStatePhase.UPDATING:
      return {
        phase: AsyncStatePhase.REJECTED,
        value: undefined,
        error: error
      };

    case AsyncStatePhase.RESOLVED:
    case AsyncStatePhase.REJECTED:
      return prevState;
  }
};

var value = function (state) {
  return state.value;
};

var error = function (state) {
  return state.error;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/asyncState/index.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./AsyncState", {
  AsyncState: "AsyncState"
}, 0);
module.link("./AsyncStatePhase", {
  AsyncStatePhase: "AsyncStatePhase"
}, 1);
module.link("./functions", {
  "*": "asyncState"
}, 2);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"lists":{"CannedResponseList.ts":[
  "@babel/runtime/helpers/createClass",
  "@babel/runtime/helpers/inheritsLoose",
  "./RecordList"
],"DiscussionsList.ts":[
  "@babel/runtime/helpers/createClass",
  "@babel/runtime/helpers/inheritsLoose",
  "@rocket.chat/string-helpers",
  "./MessageList"
],"FilesList.ts":[
  "@babel/runtime/helpers/createClass",
  "@babel/runtime/helpers/inheritsLoose",
  "./MessageList"
],"MessageList.ts":[
  "@babel/runtime/helpers/inheritsLoose",
  "./RecordList"
],"RecordList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/createForOfIteratorHelperLoose",
  "@babel/runtime/helpers/createClass",
  "@babel/runtime/helpers/assertThisInitialized",
  "@babel/runtime/helpers/inheritsLoose",
  "@babel/runtime/helpers/classPrivateFieldLooseBase",
  "@babel/runtime/helpers/classPrivateFieldLooseKey",
  "@rocket.chat/emitter",
  "../asyncState"
],"ThreadsList.ts":[
  "@babel/runtime/helpers/createClass",
  "@babel/runtime/helpers/inheritsLoose",
  "@rocket.chat/string-helpers",
  "./MessageList"
]},"minimongo":{"bson.ts":[
  "@babel/runtime/helpers/toConsumableArray",
  "./types"
],"comparisons.ts":[
  "@babel/runtime/helpers/typeof"
],"index.ts":[
  "./query",
  "./sort",
  "./types"
],"lookups.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/typeof",
  "./comparisons"
],"query.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/createForOfIteratorHelperLoose",
  "@babel/runtime/helpers/typeof",
  "./bson",
  "./comparisons",
  "./lookups"
],"sort.ts":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "./bson",
  "./comparisons",
  "./lookups"
],"types.ts":[]},"portals":{"blazePortals.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/blazePortals.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 1);
module.export({
  blazePortals: function () {
    return blazePortals;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 1);

var BlazePortalsSubscriptions = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(BlazePortalsSubscriptions, _Emitter);

  function BlazePortalsSubscriptions() {
    var _this;

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _Emitter.call.apply(_Emitter, [this].concat(args)) || this;
    _this.map = new Map();

    _this.getCurrentValue = function () {
      return Array.from(_this.map.values());
    };

    _this.subscribe = function (callback) {
      return _this.on('update', callback);
    };

    _this.register = function (template, node) {
      var entry = _this.map.get(template);

      if (!entry) {
        _this.map.set(template, {
          key: Random.id(),
          node: node
        });

        _this.emit('update');

        return;
      }

      if (entry.node === node) {
        return;
      }

      _this.map.set(template, _objectSpread(_objectSpread({}, entry), {}, {
        node: node
      }));

      _this.emit('update');
    };

    _this.unregister = function (template) {
      if (_this.map.delete(template)) {
        _this.emit('update');
      }
    };

    return _this;
  }

  return BlazePortalsSubscriptions;
}(Emitter);

var blazePortals = new BlazePortalsSubscriptions();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createEphemeralPortal.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/createEphemeralPortal.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createEphemeralPortal: function () {
    return createEphemeralPortal;
  }
});
var createLazyPortal;
module.link("./createLazyPortal", {
  createLazyPortal: function (v) {
    createLazyPortal = v;
  }
}, 0);
var registerPortal;
module.link("./portalsSubscription", {
  registerPortal: function (v) {
    registerPortal = v;
  }
}, 1);

var createEphemeralPortal = function (factory, propsFn, container) {
  var portal = createLazyPortal(factory, propsFn, container);
  return registerPortal(container, portal);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createLazyElement.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/createLazyElement.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
module.export({
  createLazyElement: function () {
    return createLazyElement;
  }
});
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 0);
var createElement, lazy, useEffect, useState, Suspense;
module.link("react", {
  createElement: function (v) {
    createElement = v;
  },
  lazy: function (v) {
    lazy = v;
  },
  useEffect: function (v) {
    useEffect = v;
  },
  useState: function (v) {
    useState = v;
  },
  Suspense: function (v) {
    Suspense = v;
  }
}, 1);

var createLazyElement = function (factory, getProps) {
  var LazyComponent = /*#__PURE__*/lazy(factory);

  if (!getProps) {
    return /*#__PURE__*/createElement(LazyComponent);
  }

  var WrappedComponent = function () {
    var _useState = useState(function () {
      return Tracker.nonreactive(getProps);
    }),
        _useState2 = _slicedToArray(_useState, 2),
        props = _useState2[0],
        setProps = _useState2[1];

    useEffect(function () {
      var computation = Tracker.autorun(function () {
        setProps(getProps());
      });
      return function () {
        computation.stop();
      };
    }, []);
    return /*#__PURE__*/createElement(Suspense, {
      fallback: null
    }, /*#__PURE__*/createElement(LazyComponent, props));
  };

  return /*#__PURE__*/createElement(WrappedComponent);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createLazyPortal.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/createLazyPortal.ts                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createLazyPortal: function () {
    return createLazyPortal;
  }
});
var createPortal;
module.link("react-dom", {
  createPortal: function (v) {
    createPortal = v;
  }
}, 0);
var createLazyElement;
module.link("./createLazyElement", {
  createLazyElement: function (v) {
    createLazyElement = v;
  }
}, 1);

var createLazyPortal = function (factory, getProps, container) {
  return /*#__PURE__*/createPortal(createLazyElement(factory, getProps), container);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createTemplateForComponent.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/createTemplateForComponent.ts                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
module.export({
  createTemplateForComponent: function () {
    return createTemplateForComponent;
  }
});
var Blaze;
module.link("meteor/blaze", {
  Blaze: function (v) {
    Blaze = v;
  }
}, 0);
var HTML;
module.link("meteor/htmljs", {
  HTML: function (v) {
    HTML = v;
  }
}, 1);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 2);
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 3);
var blazePortals;
module.link("./blazePortals", {
  blazePortals: function (v) {
    blazePortals = v;
  }
}, 4);
var createLazyPortal;
module.link("./createLazyPortal", {
  createLazyPortal: function (v) {
    createLazyPortal = v;
  }
}, 5);

var createTemplateForComponent = function (name, factory) {
  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {
    renderContainerView: function () {
      return HTML.DIV();
    }
  };

  if (Template[name]) {
    return name;
  }

  var renderFunction = 'renderContainerView' in options && options.renderContainerView || 'attachment' in options && options.attachment === 'at-parent' && function () {
    return HTML.Comment('anchor');
  } || function () {
    return HTML.DIV();
  };

  var template = new Blaze.Template(name, renderFunction);
  template.onRendered(function () {
    var props = new ReactiveVar(this.data);
    this.autorun(function () {
      props.set(_objectSpread(_objectSpread({}, 'props' in options && typeof options.props === 'function' && options.props()), Template.currentData()));
    });
    var container = 'renderContainerView' in options && this.firstNode || 'attachment' in options && options.attachment === 'at-parent' && this.firstNode.parentElement || null;

    if (!container) {
      return;
    }

    var portal = createLazyPortal(factory, function () {
      return props.get();
    }, container);
    blazePortals.register(this, portal);
  });
  template.onDestroyed(function () {
    blazePortals.unregister(this);
  });
  Template[name] = template;
  return name;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"portalsSubscription.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/portals/portalsSubscription.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  portalsSubscription: function () {
    return portalsSubscription;
  },
  unregisterPortal: function () {
    return unregisterPortal;
  },
  registerPortal: function () {
    return registerPortal;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 1);

var createPortalsSubscription = function () {
  var portalsMap = new Map();
  var emitter = new Emitter();
  return {
    getCurrentValue: function () {
      return Array.from(portalsMap.values());
    },
    subscribe: function (callback) {
      return emitter.on('update', callback);
    },
    "delete": function (key) {
      portalsMap.delete(key);
      emitter.emit('update');
    },
    set: function (key, portal) {
      portalsMap.set(key, {
        portal: portal,
        key: Random.id()
      });
      emitter.emit('update');
    },
    has: function (key) {
      return portalsMap.has(key);
    }
  };
};

var portalsSubscription = createPortalsSubscription();

var unregisterPortal = function (key) {
  portalsSubscription.delete(key);
};

var registerPortal = function (key, portal) {
  portalsSubscription.set(key, portal);
  return function () {
    unregisterPortal(key);
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"settings":{"PrivateSettingsCachedCollection.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/inheritsLoose",
  "../../../app/notifications/client",
  "../../../app/ui-cached-collection/client"
],"PublicSettingsCachedCollection.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/settings/PublicSettingsCachedCollection.ts                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  PublicSettingsCachedCollection: function () {
    return PublicSettingsCachedCollection;
  }
});
var CachedCollection;
module.link("../../../app/ui-cached-collection/client", {
  CachedCollection: function (v) {
    CachedCollection = v;
  }
}, 0);

var PublicSettingsCachedCollection = /*#__PURE__*/function (_CachedCollection) {
  _inheritsLoose(PublicSettingsCachedCollection, _CachedCollection);

  function PublicSettingsCachedCollection() {
    return _CachedCollection.call(this, {
      name: 'public-settings',
      eventType: 'onAll',
      userRelated: false,
      listenChangesForLoggedUsersOnly: true
    }) || this;
  }

  PublicSettingsCachedCollection.get = function () {
    function get() {
      if (!PublicSettingsCachedCollection.instance) {
        PublicSettingsCachedCollection.instance = new PublicSettingsCachedCollection();
      }

      return PublicSettingsCachedCollection.instance;
    }

    return get;
  }();

  return PublicSettingsCachedCollection;
}(CachedCollection);

PublicSettingsCachedCollection.instance = void 0;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"utils":{"applyCustomTranslations.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/applyCustomTranslations.ts                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);
module.export({
  applyCustomTranslations: function () {
    return applyCustomTranslations;
  }
});
var TAPi18n, TAPi18next;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  },
  TAPi18next: function (v) {
    TAPi18next = v;
  }
}, 0);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 1);

var applyCustomTranslations = function () {
  var customTranslations = settings.get('Custom_Translations');

  if (!customTranslations) {
    return;
  }

  try {
    var parsedCustomTranslations = JSON.parse(customTranslations);

    for (var _i = 0, _Object$entries = Object.entries(parsedCustomTranslations); _i < _Object$entries.length; _i++) {
      var _ref = _Object$entries[_i];

      var _ref2 = _slicedToArray(_ref, 2);

      var lang = _ref2[0];
      var translations = _ref2[1];
      TAPi18next.addResourceBundle(lang, 'project', translations);
    }

    TAPi18n._language_changed_tracker.changed();
  } catch (e) {
    console.error('Invalid setting Custom_Translations', e);
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"call.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/call.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  call: function () {
    return call;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);

var call = function (method) {
  for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    params[_key - 1] = arguments[_key];
  }

  return new Promise(function (resolve, reject) {
    var _Meteor;

    (_Meteor = Meteor).call.apply(_Meteor, [method].concat(params, [function (error, result) {
      if (error) {
        reject(error);
        return;
      }

      resolve(result);
    }]));
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"callWithErrorHandling.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/callWithErrorHandling.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  callWithErrorHandling: function () {
    return callWithErrorHandling;
  }
});
var call;
module.link("./call", {
  call: function (v) {
    call = v;
  }
}, 0);
var handleError;
module.link("./handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 1);

var callWithErrorHandling = function () {
  function _callee(method) {
    var _len,
        params,
        _key,
        _args = arguments;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.prev = 0;

              for (_len = _args.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
                params[_key - 1] = _args[_key];
              }

              _context.next = 4;
              return _regeneratorRuntime.awrap(call.apply(void 0, [method].concat(params)));

            case 4:
              return _context.abrupt("return", _context.sent);

            case 7:
              _context.prev = 7;
              _context.t0 = _context["catch"](0);
              handleError(_context.t0);
              throw _context.t0;

            case 11:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, [[0, 7]], Promise);
  }

  return _callee;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"canDeleteMessage.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/canDeleteMessage.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  canDeleteMessage: function () {
    return canDeleteMessage;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 1);
var hasPermission;
module.link("../../../app/authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 2);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);

var canDeleteMessage = function (_ref) {
  var rid = _ref.rid,
      ts = _ref.ts,
      uid = _ref.uid;
  var userId = Meteor.userId();
  var forceDelete = hasPermission('force-delete-message', rid);

  if (forceDelete) {
    return true;
  }

  var isDeleteAllowed = settings.get('Message_AllowDeleting');

  if (!isDeleteAllowed) {
    return false;
  }

  var allowed = hasPermission('delete-message', rid);
  var deleteOwn = allowed || uid === userId && hasPermission('delete-own-message');

  if (!allowed && !deleteOwn) {
    return false;
  }

  var blockDeleteInMinutes = settings.get('Message_AllowDeleting_BlockDeleteInMinutes');

  if (blockDeleteInMinutes && blockDeleteInMinutes !== 0) {
    if (!ts) {
      return false;
    }

    var msgTs = moment(ts);
    var now = moment();
    return now.diff(msgTs, 'minutes') < blockDeleteInMinutes;
  }

  return true;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createAnchor.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/createAnchor.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createAnchor: function () {
    return createAnchor;
  }
});

var createAnchor = function (id) {
  var target = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document.body;
  var div = document.createElement('div');
  div.id = id;
  target.appendChild(div);
  return div;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createToken.ts":[],"domEvents.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/domEvents.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  delegate: function () {
    return delegate;
  },
  triggerClick: function () {
    return triggerClick;
  }
});

var delegate = function (_ref) {
  var _ref$parent = _ref.parent,
      parent = _ref$parent === void 0 ? document : _ref$parent,
      eventName = _ref.eventName,
      elementSelector = _ref.elementSelector,
      listener = _ref.listener;

  var effectiveListener = function (e) {
    // loop parent nodes from the target to the delegation node
    for (var target = e.target; target && target instanceof Element && target !== this; target = target.parentNode) {
      if (target.matches(elementSelector)) {
        listener.call(target, e, target);
        break;
      }
    }
  };

  parent.addEventListener(eventName, effectiveListener, false);
  return function () {
    parent.removeEventListener(eventName, effectiveListener, false);
  };
};

var triggerClick = function (target) {
  var clickEvent = document.createEvent('HTMLEvents');
  clickEvent.initEvent('click', true, false);
  target === null || target === void 0 ? void 0 : target.dispatchEvent(clickEvent);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"filterLanguage.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/filterLanguage.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  filterLanguage: function () {
    return filterLanguage;
  }
});

var filterLanguage = function (language) {
  // Fix browsers having all-lowercase language settings eg. pt-br, en-us
  var regex = /([a-z]{2,3})-([a-z]{2,4})/;
  var matches = regex.exec(language);

  if (matches) {
    return matches[1] + "-" + matches[2].toUpperCase();
  }

  return language;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"fireGlobalEvent.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/fireGlobalEvent.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  fireGlobalEvent: function () {
    return fireGlobalEvent;
  }
});
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 0);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 1);

var fireGlobalEvent = function (eventName, detail) {
  window.dispatchEvent(new CustomEvent(eventName, {
    detail: detail
  }));
  Tracker.autorun(function (computation) {
    var enabled = settings.get('Iframe_Integration_send_enable');

    if (enabled === undefined) {
      return;
    }

    computation.stop();

    if (enabled) {
      parent.postMessage({
        eventName: eventName,
        data: detail
      }, settings.get('Iframe_Integration_send_target_origin'));
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"formatBytes.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/formatBytes.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  formatBytes: function () {
    return formatBytes;
  }
});

var formatBytes = function (bytes, decimals) {
  if (bytes === 0) {
    return '0 Bytes';
  }

  var k = 1024;
  var dm = decimals || 0;
  var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];
  var i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + " " + sizes[i];
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"formatDate.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/formatDate.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  formatDate: function () {
    return formatDate;
  }
});
var mem;
module.link("mem", {
  "default": function (v) {
    mem = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 2);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var formatDate = mem(function (time) {
  var messageDateFormat = Tracker.nonreactive(function () {
    return settings.get('Message_DateFormat');
  });
  return moment(time).format(messageDateFormat);
}, {
  maxAge: 5000
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"formatDateAndTime.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/formatDateAndTime.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  formatDateAndTime: function () {
    return formatDateAndTime;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 2);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var getUserPreference;
module.link("../../../app/utils/lib/getUserPreference", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 4);

var formatDateAndTime = function (time) {
  var clockMode = Tracker.nonreactive(function () {
    return getUserPreference(Meteor.userId(), 'clockMode', false);
  });
  var messageTimeAndDateFormat = Tracker.nonreactive(function () {
    return settings.get('Message_TimeAndDateFormat');
  });

  switch (clockMode) {
    case 1:
      return moment(time).format('MMMM D, Y h:mm A');

    case 2:
      return moment(time).format('MMMM D, Y H:mm');

    default:
      return moment(time).format(messageTimeAndDateFormat);
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"formatTime.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/formatTime.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  formatTime: function () {
    return formatTime;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 2);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var getUserPreference;
module.link("../../../app/utils/lib/getUserPreference", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 4);
var dayFormat = ['h:mm A', 'H:mm'];

var formatTime = function (time) {
  var clockMode = Tracker.nonreactive(function () {
    return getUserPreference(Meteor.userId(), 'clockMode', false);
  });
  var messageTimeFormat = Tracker.nonreactive(function () {
    return settings.get('Message_TimeFormat');
  });
  var sameDay = dayFormat[clockMode - 1] || messageTimeFormat;

  switch (clockMode) {
    case 1:
    case 2:
      return moment(time).format(sameDay);

    default:
      return moment(time).format(messageTimeFormat);
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getAvatarAsPng.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/getAvatarAsPng.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getAvatarAsPng: function () {
    return getAvatarAsPng;
  }
});
var getUserAvatarURL;
module.link("../../../app/utils/lib/getUserAvatarURL", {
  getUserAvatarURL: function (v) {
    getUserAvatarURL = v;
  }
}, 0);

var getAvatarAsPng = function (username, cb) {
  var image = new Image();

  var onLoad = function () {
    var canvas = document.createElement('canvas');
    canvas.width = image.width;
    canvas.height = image.height;
    var context = canvas.getContext('2d');

    if (!context) {
      throw new Error('failed to get canvas context');
    }

    context.drawImage(image, 0, 0);

    try {
      return cb(canvas.toDataURL('image/png'));
    } catch (e) {
      return cb('');
    }
  };

  var onError = function () {
    return cb('');
  };

  image.onload = onLoad;
  image.onerror = onError;
  image.src = getUserAvatarURL(username);
  return onError;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getConfig.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/getConfig.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getConfig: function () {
    return getConfig;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);

var getConfig = function (key) {
  var searchParams = new URLSearchParams(window.location.search);
  return searchParams.get(key) || Meteor._localStorage.getItem("rc-config-" + key);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getDateRange.ts":[
  "moment"
],"getUidDirectMessage.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/getUidDirectMessage.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getUidDirectMessage: function () {
    return getUidDirectMessage;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Rooms;
module.link("../../../app/models/client", {
  Rooms: function (v) {
    Rooms = v;
  }
}, 1);

var getUidDirectMessage = function (rid) {
  var userId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Meteor.userId();
  var room = Rooms.findOne({
    _id: rid
  }, {
    fields: {
      uids: 1
    }
  });

  if (!room || !room.uids || room.uids.length > 2) {
    return undefined;
  }

  return room.uids.filter(function (uid) {
    return uid !== userId;
  })[0];
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getUserEmailVerified.ts":[],"goToRoomById.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/goToRoomById.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);
module.export({
  goToRoomById: function () {
    return goToRoomById;
  }
});
var memoize;
module.link("@rocket.chat/memo", {
  memoize: function (v) {
    memoize = v;
  }
}, 0);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 1);
var ChatSubscription;
module.link("../../../app/models/client", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 2);
var roomTypes;
module.link("../../../app/utils/client", {
  roomTypes: function (v) {
    roomTypes = v;
  }
}, 3);
var callWithErrorHandling;
module.link("./callWithErrorHandling", {
  callWithErrorHandling: function (v) {
    callWithErrorHandling = v;
  }
}, 4);
var getRoomById = memoize(function (rid) {
  return callWithErrorHandling('getRoomById', rid);
});

var goToRoomById = function () {
  function _callee(rid) {
    var subscription, room;
    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              if (rid) {
                _context.next = 2;
                break;
              }

              return _context.abrupt("return");

            case 2:
              subscription = ChatSubscription.findOne({
                rid: rid
              });

              if (!subscription) {
                _context.next = 6;
                break;
              }

              roomTypes.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);
              return _context.abrupt("return");

            case 6:
              _context.next = 8;
              return _regeneratorRuntime.awrap(getRoomById(rid));

            case 8:
              room = _context.sent;
              roomTypes.openRouteLink(room.t, _objectSpread({
                rid: room._id
              }, room), FlowRouter.current().queryParams);

            case 10:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"handleError.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/handleError.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 0);

var _typeof;

module.link("@babel/runtime/helpers/typeof", {
  default: function (v) {
    _typeof = v;
  }
}, 1);
module.export({
  handleError: function () {
    return handleError;
  }
});
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 0);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 1);
var toastr;
module.link("toastr", {
  "default": function (v) {
    toastr = v;
  }
}, 2);

var hasXHR = function (error) {
  return 'xhr' in error;
};

var hasDetails = function (error) {
  return 'details' in error && _typeof(error.details) === 'object';
};

var hasToastrShowed = function (error) {
  return 'toastrShowed' in error && error.toastrShowed === true;
};

var hasError = function (error) {
  return 'error' in error && typeof error.error === 'string';
};

var hasMessage = function (error) {
  return 'error' in error && typeof error.message === 'string';
};

var hasErrorTitle = function (details) {
  return 'errorTitle' in details && typeof details === 'string';
};

var handleError = function (error) {
  var useToastr = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

  if (hasXHR(error) && error.xhr.responseJSON) {
    return handleError(error.xhr.responseJSON, useToastr);
  }

  var message = hasError(error) && error.error || hasMessage(error) && error.message || undefined;
  var details = hasDetails(error) ? error.details : {};

  if (useToastr) {
    if (hasToastrShowed(error)) {
      return;
    }

    return toastr.error(TAPi18n.__(message, Object.fromEntries(Object.entries(details).map(function (_ref) {
      var _ref2 = _slicedToArray(_ref, 2),
          key = _ref2[0],
          value = _ref2[1];

      return [key, escapeHTML(TAPi18n.__(value))];
    }))), hasErrorTitle(details) ? TAPi18n.__(details.errorTitle) : undefined);
  }

  return escapeHTML(TAPi18n.__(message, Object.fromEntries(Object.entries(details).map(function (_ref3) {
    var _ref4 = _slicedToArray(_ref3, 2),
        key = _ref4[0],
        value = _ref4[1];

    return [key, TAPi18n.__(value)];
  }))));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"isIE11.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/isIE11.ts                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isIE11: function () {
    return isIE11;
  }
});

var isIE11 = function () {
  var userAgent = window.navigator.userAgent;
  var msieIdx = userAgent.indexOf('MSIE');

  if (msieIdx > 0) {
    return parseInt(userAgent.substring(msieIdx + 5, userAgent.indexOf('.', msieIdx))) === 11;
  } // If MSIE detection fails, check the Trident engine version


  if (navigator.userAgent.match(/Trident\/7\./)) {
    return true;
  }

  return false;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"isIOsDevice.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/isIOsDevice.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isIOsDevice: function () {
    return isIOsDevice;
  }
});
var isIOsDevice = !!navigator.platform.match(/iPhone|iPod|iPad/);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"isLayoutEmbedded.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/isLayoutEmbedded.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isLayoutEmbedded: function () {
    return isLayoutEmbedded;
  }
});
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);

var isLayoutEmbedded = function () {
  return FlowRouter.getQueryParam('layout') === 'embedded';
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"isRTL.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/isRTL.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isRTL: function () {
    return isRTL;
  }
});
// http://stackoverflow.com/a/14824756
var ltrChars = "A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF\u2C00-\uFB1C\uFDFE-\uFE6F\uFEFD-\uFFFF";
var rtlChars = "\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC";
var rtlRegExp = new RegExp("^[^" + ltrChars + "]*[" + rtlChars + "]");

var isRTL = function (text) {
  return rtlRegExp.test(text);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"keyCodes.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/keyCodes.ts                                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  keyCodes: function () {
    return keyCodes;
  }
});
var keyCodes = {
  TAB: 9,
  CARRIAGE_RETURN: 10,
  NEW_LINE: 13,
  SHIFT: 16,
  CONTROL: 17,
  ALT: 18,
  PAUSE_BREAK: 19,
  CAPS_LOCK: 20,
  ESCAPE: 27,
  PAGE_DOWN: 33,
  PAGE_UP: 34,
  END: 35,
  HOME: 36,
  ARROW_LEFT: 37,
  ARROW_UP: 38,
  ARROW_RIGHT: 39,
  ARROW_DOWN: 40,
  INSERT: 45,
  SUPER: 91,
  MENU: 93,
  F1: 112,
  F2: 113,
  F3: 114,
  F4: 115,
  F5: 116,
  F6: 117,
  F7: 118,
  F8: 119,
  F9: 120,
  F10: 121,
  F11: 122,
  F12: 123,
  NUM_LOCK: 144,
  SCROLL_LOCK: 145
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"mapMessageFromApi.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties"
],"prependReplies.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/prependReplies.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  prependReplies: function () {
    return prependReplies;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Rooms, Users;
module.link("../../../app/models/client", {
  Rooms: function (v) {
    Rooms = v;
  },
  Users: function (v) {
    Users = v;
  }
}, 1);
var MessageAction;
module.link("../../../app/ui-utils/client/lib/MessageAction", {
  MessageAction: function (v) {
    MessageAction = v;
  }
}, 2);

var prependReplies = function () {
  function _callee2(msg) {
    var replies,
        mention,
        _Users$findOne,
        username,
        chunks,
        _args2 = arguments;

    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              replies = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : [];
              mention = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : false;
              _Users$findOne = Users.findOne({
                _id: Meteor.userId()
              }, {
                fields: {
                  username: 1
                }
              }), username = _Users$findOne.username;
              _context2.next = 5;
              return _regeneratorRuntime.awrap(Promise.all(replies.map(function () {
                function _callee(_ref) {
                  var _id, rid, u, permalink, room, chunk;

                  return _regeneratorRuntime.async(function () {
                    function _callee$(_context) {
                      while (1) {
                        switch (_context.prev = _context.next) {
                          case 0:
                            _id = _ref._id, rid = _ref.rid, u = _ref.u;
                            _context.next = 3;
                            return _regeneratorRuntime.awrap(MessageAction.getPermaLink(_id));

                          case 3:
                            permalink = _context.sent;
                            room = Rooms.findOne(rid, {
                              fields: {
                                t: 1
                              }
                            });
                            chunk = "[ ](" + permalink + ")";

                            if ((room === null || room === void 0 ? void 0 : room.t) === 'd' && u.username !== username && mention) {
                              chunk += " @" + u.username;
                            }

                            return _context.abrupt("return", chunk);

                          case 8:
                          case "end":
                            return _context.stop();
                        }
                      }
                    }

                    return _callee$;
                  }(), null, null, null, Promise);
                }

                return _callee;
              }())));

            case 5:
              chunks = _context2.sent;
              chunks.push(msg);
              return _context2.abrupt("return", chunks.join(' '));

            case 8:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"renderEmoji.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/renderEmoji.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  renderEmoji: function () {
    return renderEmoji;
  }
});
var emoji;
module.link("../../../app/emoji/lib/rocketchat", {
  emoji: function (v) {
    emoji = v;
  }
}, 0);
var emojiList = emoji.list;
var emojiPackages = emoji.packages;

var renderEmoji = function (emojiName) {
  var _emojiList$emojiName;

  var emojiPackageName = (_emojiList$emojiName = emojiList[emojiName]) === null || _emojiList$emojiName === void 0 ? void 0 : _emojiList$emojiName.emojiPackage;

  if (emojiPackageName) {
    var emojiPackage = emojiPackages[emojiPackageName];
    return emojiPackage.render(emojiName);
  }

  return undefined;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"renderMessageBody.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/renderMessageBody.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  renderMessageBody: function () {
    return renderMessageBody;
  }
});
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 0);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 1);

var renderMessageBody = function (message) {
  var _message$msg;

  message.html = (_message$msg = message.msg) !== null && _message$msg !== void 0 && _message$msg.trim() ? escapeHTML(message.msg.trim()) : '';

  var _callbacks$run = callbacks.run('renderMessage', message),
      tokens = _callbacks$run.tokens,
      html = _callbacks$run.html;

  return (Array.isArray(tokens) ? tokens.reverse() : []).reduce(function (html, _ref) {
    var token = _ref.token,
        text = _ref.text;
    return html.replace(token, function () {
      return text;
    });
  }, html !== null && html !== void 0 ? html : '');
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"renderMessageEmoji.ts":[
  "../../../app/emoji/client/emojiParser.js"
],"timeAgo.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/timeAgo.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  timeAgo: function () {
    return timeAgo;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 2);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var t;
module.link("../../../app/utils/client", {
  t: function (v) {
    t = v;
  }
}, 4);
var getUserPreference;
module.link("../../../app/utils/lib/getUserPreference", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 5);
var dayFormat = ['h:mm A', 'H:mm'];

var timeAgo = function (date) {
  var clockMode = Tracker.nonreactive(function () {
    return getUserPreference(Meteor.userId(), 'clockMode', false);
  });
  var messageTimeFormat = Tracker.nonreactive(function () {
    return settings.get('Message_TimeFormat');
  });
  var sameDay = dayFormat[clockMode - 1] || messageTimeFormat;
  return moment(date).calendar(null, {
    lastDay: "[" + t('yesterday') + "]",
    sameDay: sameDay,
    lastWeek: 'dddd',
    sameElse: function (now) {
      var diff = Math.ceil(this.diff(now, 'years', true));
      return diff < 0 ? 'MMM D YYYY' : 'MMM D';
    }
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"waitUntilFind.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/utils/waitUntilFind.ts                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  waitUntilFind: function () {
    return waitUntilFind;
  }
});
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 0);

var waitUntilFind = function (fn) {
  return new Promise(function (resolve) {
    Tracker.autorun(function (c) {
      var result = fn();

      if (result === undefined) {
        return;
      }

      c.stop();
      resolve(result);
    });
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"RoomManager.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/RoomManager.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["resolve", "update"];

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);

var _createClass;

module.link("@babel/runtime/helpers/createClass", {
  default: function (v) {
    _createClass = v;
  }
}, 2);

var _assertThisInitialized;

module.link("@babel/runtime/helpers/assertThisInitialized", {
  default: function (v) {
    _assertThisInitialized = v;
  }
}, 3);

var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 4);
module.export({
  RoomStore: function () {
    return RoomStore;
  },
  RoomManager: function () {
    return RoomManager;
  },
  useHandleRoom: function () {
    return useHandleRoom;
  },
  useVisitedRooms: function () {
    return useVisitedRooms;
  },
  useOpenedRoom: function () {
    return useOpenedRoom;
  },
  useRoomStore: function () {
    return useRoomStore;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);
var useEffect, useMemo;
module.link("react", {
  useEffect: function (v) {
    useEffect = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 1);
var useSubscription;
module.link("use-subscription", {
  useSubscription: function (v) {
    useSubscription = v;
  }
}, 2);
var useUserId, useUserRoom, useUserSubscription;
module.link("../contexts/UserContext", {
  useUserId: function (v) {
    useUserId = v;
  },
  useUserRoom: function (v) {
    useUserRoom = v;
  },
  useUserSubscription: function (v) {
    useUserSubscription = v;
  }
}, 3);
var useAsyncState;
module.link("../hooks/useAsyncState", {
  useAsyncState: function (v) {
    useAsyncState = v;
  }
}, 4);
var getConfig;
module.link("./utils/getConfig", {
  getConfig: function (v) {
    getConfig = v;
  }
}, 5);
var debug = !!(getConfig('debug') || getConfig('debug-RoomStore'));

var RoomStore = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(RoomStore, _Emitter);

  function RoomStore(rid) {
    var _this;

    _this = _Emitter.call(this) || this;
    _this.rid = void 0;
    _this.lastTime = void 0;
    _this.scroll = void 0;
    _this.lm = void 0;
    _this.atBottom = true;
    _this.rid = rid;
    debug && _this.on('changed', function () {
      return console.log("RoomStore " + _this.rid + " changed", _assertThisInitialized(_this));
    });
    return _this;
  }

  var _proto = RoomStore.prototype;

  _proto.update = function () {
    function update(_ref) {
      var scroll = _ref.scroll,
          lastTime = _ref.lastTime,
          atBottom = _ref.atBottom;

      if (scroll !== undefined) {
        this.scroll = scroll;
      }

      if (lastTime !== undefined) {
        this.lastTime = lastTime;
      }

      if (atBottom !== undefined) {
        this.atBottom = atBottom;
      }

      if (scroll || lastTime) {
        this.emit('changed');
      }
    }

    return update;
  }();

  return RoomStore;
}(Emitter);

var debugRoomManager = !!(getConfig('debug') || getConfig('debug-RoomManager'));
var RoomManager = new ( /*#__PURE__*/function (_Emitter2) {
  _inheritsLoose(RoomManager, _Emitter2);

  function RoomManager() {
    var _this2;

    _this2 = _Emitter2.call(this) || this;
    _this2.rid = void 0;
    _this2.lastRid = void 0;
    _this2.rooms = new Map();
    debugRoomManager && _this2.on('opened', function (rid) {
      console.log('room opened ->', rid);
    });
    debugRoomManager && _this2.on('back', function (rid) {
      console.log('room moved to back ->', rid);
    });
    debugRoomManager && _this2.on('closed', function (rid) {
      console.log('room close ->', rid);
    });
    return _this2;
  }

  var _proto2 = RoomManager.prototype;

  _proto2.visitedRooms = function () {
    function visitedRooms() {
      return _toConsumableArray(this.rooms.keys());
    }

    return visitedRooms;
  }();

  _proto2.back = function () {
    function back(rid) {
      if (rid === this.rid) {
        this.lastRid = rid;
        this.rid = undefined;
        this.emit('back', rid);
        this.emit('changed', this.rid);
      }
    }

    return back;
  }();

  _proto2.close = function () {
    function close(rid) {
      if (!this.rooms.has(rid)) {
        this.rooms.delete(rid);
        this.emit('closed', rid);
      }

      this.emit('changed', this.rid);
    }

    return close;
  }();

  _proto2.open = function () {
    function open(rid) {
      if (rid === this.rid) {
        return;
      }

      this.back(rid);

      if (!this.rooms.has(rid)) {
        this.rooms.set(rid, new RoomStore(rid));
      }

      this.rid = rid;
      this.emit('opened', this.rid);
      this.emit('changed', this.rid);
    }

    return open;
  }();

  _proto2.getStore = function () {
    function getStore(rid) {
      return this.rooms.get(rid);
    }

    return getStore;
  }();

  _createClass(RoomManager, [{
    key: "lastOpened",
    get: function () {
      return this.lastRid;
    }
  }, {
    key: "opened",
    get: function () {
      return this.rid;
    }
  }]);

  return RoomManager;
}(Emitter))();
var subscribeVisitedRooms = {
  getCurrentValue: function () {
    return RoomManager.visitedRooms();
  },
  subscribe: function (callback) {
    return RoomManager.on('changed', callback);
  }
};
var subscribeOpenedRoom = {
  getCurrentValue: function () {
    return RoomManager.opened;
  },
  subscribe: function (callback) {
    return RoomManager.on('opened', callback);
  }
};
var fields = {};

var useHandleRoom = function (rid) {
  var _useAsyncState = useAsyncState(),
      resolve = _useAsyncState.resolve,
      update = _useAsyncState.update,
      state = _objectWithoutProperties(_useAsyncState, _excluded);

  var uid = useUserId();
  var subscription = useUserSubscription(rid, fields);

  var _room = useUserRoom(rid, fields);

  var room = uid ? subscription || _room : _room;
  useEffect(function () {
    if (room) {
      update();
      resolve(room);
    }
  }, [resolve, update, room]);
  return state;
};

var useVisitedRooms = function () {
  return useSubscription(subscribeVisitedRooms);
};

var useOpenedRoom = function () {
  return useSubscription(subscribeOpenedRoom);
};

var useRoomStore = function (rid) {
  var subscribeStore = useMemo(function () {
    return {
      getCurrentValue: function () {
        return RoomManager.getStore(rid);
      },
      subscribe: function (callback) {
        return RoomManager.on('changed', callback);
      }
    };
  }, [rid]);
  var store = useSubscription(subscribeStore);

  if (!store) {
    throw new Error('Something wrong');
  }

  return store;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"appLayout.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/appLayout.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  appLayout: function () {
    return appLayout;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);
var createElement, lazy;
module.link("react", {
  createElement: function (v) {
    createElement = v;
  },
  lazy: function (v) {
    lazy = v;
  }
}, 1);
var MainLayout = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../views/root/MainLayout');
});

var AppLayoutSubscription = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(AppLayoutSubscription, _Emitter);

  function AppLayoutSubscription() {
    var _this;

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _Emitter.call.apply(_Emitter, [this].concat(args)) || this;
    _this.descriptor = null;

    _this.getCurrentValue = function () {
      return _this.descriptor;
    };

    _this.subscribe = function (callback) {
      return _this.on('update', callback);
    };

    return _this;
  }

  var _proto = AppLayoutSubscription.prototype;

  _proto.setCurrentValue = function () {
    function setCurrentValue(descriptor) {
      this.descriptor = descriptor;
      this.emit('update');
    }

    return setCurrentValue;
  }();

  _proto.renderMainLayout = function () {
    function renderMainLayout() {
      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      this.setCurrentValue( /*#__PURE__*/createElement(MainLayout, props));
    }

    return renderMainLayout;
  }();

  _proto.render = function () {
    function render(element) {
      this.setCurrentValue(element);
    }

    return render;
  }();

  return AppLayoutSubscription;
}(Emitter);

var appLayout = new AppLayoutSubscription();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"banners.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/banners.ts                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isLegacyPayload: function () {
    return isLegacyPayload;
  },
  firstSubscription: function () {
    return firstSubscription;
  },
  open: function () {
    return open;
  },
  closeById: function () {
    return closeById;
  },
  close: function () {
    return close;
  },
  clear: function () {
    return clear;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);

var isLegacyPayload = function (payload) {
  return !('blocks' in payload);
};

var queue = [];
var emitter = new Emitter();
var firstSubscription = {
  getCurrentValue: function () {
    var _queue$;

    return (_queue$ = queue[0]) !== null && _queue$ !== void 0 ? _queue$ : null;
  },
  subscribe: function (callback) {
    return emitter.on('update-first', callback);
  }
};

var open = function (payload) {
  var index = queue.findIndex(function (_payload) {
    if (isLegacyPayload(_payload)) {
      return _payload.id === payload.id;
    }

    return _payload.viewId === payload.viewId;
  });

  if (index === -1) {
    index = queue.length;
  }

  queue[index] = payload;
  emitter.emit('update');

  if (index === 0) {
    emitter.emit('update-first');
  }
};

var closeById = function (id) {
  var index = queue.findIndex(function (banner) {
    if (!isLegacyPayload(banner)) {
      return banner.viewId === id;
    }

    return banner.id === id;
  });

  if (index < 0) {
    return;
  }

  queue.splice(index, 1);
  emitter.emit('update');
  index === 0 && emitter.emit('update-first');
};

var close = function () {
  queue.shift();
  emitter.emit('update');
  emitter.emit('update-first');
};

var clear = function () {
  queue.splice(0, queue.length);
  emitter.emit('update');
  emitter.emit('update-first');
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"baseURI.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/baseURI.ts                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  baseURI: function () {
    return baseURI;
  }
});

var baseURI = function () {
  if (document.baseURI) {
    return document.baseURI;
  } // Should be exactly one tag:
  //   https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base


  var base = document.getElementsByTagName('base'); // Return location from BASE tag.

  if (base.length > 0) {
    return base[0].href;
  } // Else use implementation of documentURI:
  //   http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-baseURI


  return document.URL;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"clickableItem.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage-tokens/colors",
  "react"
],"createRouteGroup.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/createRouteGroup.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["lazyRouteComponent", "props", "ready"];

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 2);
module.export({
  createRouteGroup: function () {
    return createRouteGroup;
  }
});
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var createElement, lazy;
module.link("react", {
  createElement: function (v) {
    createElement = v;
  },
  lazy: function (v) {
    lazy = v;
  }
}, 3);
var appLayout;
module.link("./appLayout", {
  appLayout: function (v) {
    appLayout = v;
  }
}, 4);
var createTemplateForComponent;
module.link("./portals/createTemplateForComponent", {
  createTemplateForComponent: function (v) {
    createTemplateForComponent = v;
  }
}, 5);

var registerLazyComponentRoute = function (routeGroup, importRouter, path, _ref) {
  var _rest$triggersEnter, _rest$triggersExit;

  var lazyRouteComponent = _ref.lazyRouteComponent,
      props = _ref.props,
      _ref$ready = _ref.ready,
      ready = _ref$ready === void 0 ? true : _ref$ready,
      rest = _objectWithoutProperties(_ref, _excluded);

  var enabled = new ReactiveVar(ready ? true : undefined);
  var computation;

  var handleEnter = function (_context, _redirect, stop) {
    var _enabled = Tracker.nonreactive(function () {
      return enabled.get();
    });

    if (_enabled === false) {
      stop();
      return;
    }

    computation = Tracker.autorun(function () {
      var _enabled = enabled.get();

      if (_enabled === false) {
        FlowRouter.go('/');
      }
    });
  };

  var handleExit = function () {
    var _computation;

    (_computation = computation) === null || _computation === void 0 ? void 0 : _computation.stop();
  };

  var RouteComponent = /*#__PURE__*/lazy(lazyRouteComponent);

  var renderRoute = function () {
    return /*#__PURE__*/createElement(RouteComponent, props);
  };

  routeGroup.route(path, _objectSpread(_objectSpread({}, rest), {}, {
    triggersEnter: [handleEnter].concat(_toConsumableArray((_rest$triggersEnter = rest.triggersEnter) !== null && _rest$triggersEnter !== void 0 ? _rest$triggersEnter : [])),
    triggersExit: [handleExit].concat(_toConsumableArray((_rest$triggersExit = rest.triggersExit) !== null && _rest$triggersExit !== void 0 ? _rest$triggersExit : [])),
    action: function () {
      var center = createTemplateForComponent(Tracker.nonreactive(function () {
        return FlowRouter.getRouteName();
      }), importRouter, {
        attachment: 'at-parent',
        props: function () {
          return {
            renderRoute: renderRoute
          };
        }
      });
      appLayout.renderMainLayout({
        center: center
      });
    }
  }));
  return [function () {
    return enabled.set(true);
  }, function () {
    return enabled.set(false);
  }];
};

var createRouteGroup = function (name, prefix, importRouter) {
  var routeGroup = FlowRouter.group({
    name: name,
    prefix: prefix
  });

  function registerRoute(path, options) {
    if ('lazyRouteComponent' in options) {
      return registerLazyComponentRoute(routeGroup, importRouter, path, options);
    }

    routeGroup.route(path, options);
  }

  registerRoute('/', {
    name: name + "-index",
    action: function () {
      var center = createTemplateForComponent(name + "-index", importRouter, {
        attachment: 'at-parent'
      });
      appLayout.renderMainLayout({
        center: center
      });
    }
  });
  return registerRoute;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"createSidebarItems.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/createSidebarItems.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createSidebarItems: function () {
    return createSidebarItems;
  }
});

var createSidebarItems = function () {
  var initialItems = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var items = initialItems;

  var updateCb = function () {
    return undefined;
  };

  var itemsSubscription = {
    subscribe: function (cb) {
      updateCb = cb;
      return function () {
        updateCb = function () {
          return undefined;
        };
      };
    },
    getCurrentValue: function () {
      return items;
    }
  };

  var registerSidebarItem = function (item) {
    items.push(item);
    updateCb();
  };

  var unregisterSidebarItem = function (i18nLabel) {
    var index = items.findIndex(function (item) {
      return item.i18nLabel === i18nLabel;
    });
    delete items[index];
    updateCb();
  };

  return {
    registerSidebarItem: registerSidebarItem,
    unregisterSidebarItem: unregisterSidebarItem,
    itemsSubscription: itemsSubscription
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"download.ts":[
  "@babel/runtime/helpers/objectWithoutProperties"
],"getLocalePercentage.ts":[],"getUserDisplayName.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/getUserDisplayName.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getUserDisplayName: function () {
    return getUserDisplayName;
  }
});

var getUserDisplayName = function (name, username, useRealName) {
  return useRealName ? name || username : username;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"imperativeModal.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/imperativeModal.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  imperativeModal: function () {
    return imperativeModal;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);

var ImperativeModalEmmiter = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(ImperativeModalEmmiter, _Emitter);

  function ImperativeModalEmmiter() {
    var _this;

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _Emitter.call.apply(_Emitter, [this].concat(args)) || this;

    _this.open = function (descriptor) {
      // There are some TS shenanigans causing errors if this is not asserted
      // Since this method is for internal use only, it's ok to use this here
      // This will not affect prop types inference when using the method.
      _this.update(descriptor);
    };

    _this.close = function () {
      _this.update(null);
    };

    return _this;
  }

  var _proto = ImperativeModalEmmiter.prototype;

  _proto.update = function () {
    function update(descriptor) {
      this.emit('update', descriptor);
    }

    return update;
  }();

  return ImperativeModalEmmiter;
}(Emitter);

var imperativeModal = new ImperativeModalEmmiter();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"meteorCallWrapper.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/meteorCallWrapper.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
var DDPCommon;
module.link("meteor/ddp-common", {
  DDPCommon: function (v) {
    DDPCommon = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var APIClient;
module.link("../../app/utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 3);
var bypassMethods = ['setUserStatus', 'logout'];

function shouldBypass(_ref) {
  var _params$;

  var method = _ref.method,
      params = _ref.params;

  if (method === 'login' && (_params$ = params[0]) !== null && _params$ !== void 0 && _params$.resume) {
    return true;
  }

  if (method.startsWith('UserPresence:') || bypassMethods.includes(method)) {
    return true;
  }

  if (method.startsWith('stream-')) {
    return true;
  }

  return false;
}

function wrapMeteorDDPCalls() {
  var _send = Meteor.connection._send;

  Meteor.connection._send = function () {
    function _DDPSendOverREST(message) {
      if (message.msg !== 'method' || shouldBypass(message)) {
        return _send.call(Meteor.connection, message);
      }

      var endpoint = Tracker.nonreactive(function () {
        return !Meteor.userId() ? 'method.callAnon' : 'method.call';
      });
      var restParams = {
        message: DDPCommon.stringifyDDP(_objectSpread({}, message))
      };

      var processResult = function (_message) {
        Meteor.connection._livedata_data({
          msg: 'updated',
          methods: [message.id]
        });

        Meteor.connection.onMessage(_message);
      };

      APIClient.v1.post(endpoint + "/" + encodeURIComponent(message.method.replace(/\//g, ':')), restParams).then(function (_ref2) {
        var _message = _ref2.message;
        processResult(_message);

        if (message.method === 'login') {
          var _parsedMessage$result;

          var parsedMessage = DDPCommon.parseDDP(_message);

          if ((_parsedMessage$result = parsedMessage.result) !== null && _parsedMessage$result !== void 0 && _parsedMessage$result.token) {
            Meteor.loginWithToken(parsedMessage.result.token);
          }
        }
      }).catch(function (error) {
        console.error(error);
      });
    }

    return _DDPSendOverREST;
  }();
}

window.USE_REST_FOR_DDP_CALLS && wrapMeteorDDPCalls();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"onClientBeforeSendMessage.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/onClientBeforeSendMessage.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onClientBeforeSendMessage: function () {
    return onClientBeforeSendMessage;
  }
});
var createAsyncTransformChain;
module.link("../../lib/transforms", {
  createAsyncTransformChain: function (v) {
    createAsyncTransformChain = v;
  }
}, 0);
var onClientBeforeSendMessage = createAsyncTransformChain();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"onClientMessageReceived.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/onClientMessageReceived.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  onClientMessageReceived: function () {
    return onClientMessageReceived;
  }
});
var createAsyncTransformChain;
module.link("../../lib/transforms", {
  createAsyncTransformChain: function (v) {
    createAsyncTransformChain = v;
  }
}, 0);
var onClientMessageReceived = createAsyncTransformChain();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"presence.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/presence.ts                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 2);
module.export({
  STATUS_MAP: function () {
    return STATUS_MAP;
  },
  Presence: function () {
    return Presence;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var APIClient;
module.link("../../app/utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 2);
var UserStatus;
module.link("../../definition/UserStatus", {
  UserStatus: function (v) {
    UserStatus = v;
  }
}, 3);
var STATUS_MAP = [UserStatus.OFFLINE, UserStatus.ONLINE, UserStatus.AWAY, UserStatus.BUSY];
var emitter = new Emitter();
var store = new Map();

var isUid = function (eventType) {
  return Boolean(eventType) && typeof eventType === 'string' && !['reset', 'restart', 'remove'].includes(eventType);
};

var uids = new Set();

var update = function (update) {
  if (update !== null && update !== void 0 && update._id) {
    store.set(update._id, update);
    uids.delete(update._id);
  }
};

var notify = function (presence) {
  if (presence._id) {
    update(presence);
    emitter.emit(presence._id, presence);
  }
};

var getPresence = function () {
  var timer;
  var deletedUids = new Set();

  var fetch = function () {
    var delay = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 500;
    timer && clearTimeout(timer);
    timer = setTimeout(function () {
      function _callee() {
        var currentUids, ids, removed, params, _await$APIClient$v1$g, users;

        return _regeneratorRuntime.async(function () {
          function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  currentUids = new Set(uids);
                  uids.clear();
                  ids = Array.from(currentUids);
                  removed = Array.from(deletedUids);
                  Meteor.subscribe('stream-user-presence', '', _objectSpread(_objectSpread({}, ids.length > 0 && {
                    added: Array.from(currentUids)
                  }), removed.length && {
                    removed: Array.from(deletedUids)
                  }));
                  deletedUids.clear();

                  if (!(ids.length === 0)) {
                    _context.next = 8;
                    break;
                  }

                  return _context.abrupt("return");

                case 8:
                  _context.prev = 8;
                  params = {
                    ids: _toConsumableArray(currentUids)
                  };
                  _context.next = 12;
                  return _regeneratorRuntime.awrap(APIClient.v1.get('users.presence', params));

                case 12:
                  _await$APIClient$v1$g = _context.sent;
                  users = _await$APIClient$v1$g.users;
                  users.forEach(function (user) {
                    if (!store.has(user._id)) {
                      notify(user);
                    }

                    currentUids.delete(user._id);
                  });
                  currentUids.forEach(function (uid) {
                    notify({
                      _id: uid,
                      status: UserStatus.OFFLINE
                    });
                  });
                  currentUids.clear();
                  _context.next = 22;
                  break;

                case 19:
                  _context.prev = 19;
                  _context.t0 = _context["catch"](8);
                  fetch(delay + delay);

                case 22:
                  _context.prev = 22;
                  currentUids.forEach(function (item) {
                    return uids.add(item);
                  });
                  return _context.finish(22);

                case 25:
                case "end":
                  return _context.stop();
              }
            }
          }

          return _callee$;
        }(), null, null, [[8, 19, 22, 25]], Promise);
      }

      return _callee;
    }(), delay);
  };

  var get = function (uid) {
    uids.add(uid);
    fetch();
  };

  var stop = function (uid) {
    deletedUids.add(uid);
    fetch();
  };

  emitter.on('remove', function (uid) {
    if (emitter.has(uid)) {
      return;
    }

    store.delete(uid);
    stop(uid);
  });
  emitter.on('reset', function () {
    emitter.events().filter(isUid).forEach(function (uid) {
      emitter.emit(uid, undefined);
    });
    emitter.once('restart', function () {
      emitter.events().filter(isUid).forEach(get);
    });
  });
  return get;
}();

var listen = function (uid, handler) {
  if (!uid) {
    return;
  }

  emitter.on(uid, handler);
  var user = store.has(uid) && store.get(uid);

  if (user) {
    return;
  }

  getPresence(uid);
};

var stop = function (uid, handler) {
  setTimeout(function () {
    emitter.off(uid, handler);
    emitter.emit('remove', uid);
  }, 5000);
};

var reset = function () {
  store.clear();
  emitter.emit('reset');
};

var restart = function () {
  emitter.emit('restart');
};

var get = function () {
  function _callee2(uid) {
    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              return _context2.abrupt("return", new Promise(function (resolve) {
                var user = store.has(uid) && store.get(uid);

                if (user) {
                  return resolve(user);
                }

                var callback = function (args) {
                  resolve(args);
                  stop(uid, callback);
                };

                listen(uid, callback);
              }));

            case 1:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();

var Presence = {
  listen: listen,
  stop: stop,
  reset: reset,
  restart: restart,
  notify: notify,
  store: store,
  get: get
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"queryClient.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/queryClient.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  queryClient: function () {
    return queryClient;
  }
});
var QueryClient;
module.link("react-query", {
  QueryClient: function (v) {
    QueryClient = v;
  }
}, 0);
var queryClient = new QueryClient();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"toast.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/toast.ts                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  dispatchToastMessage: function () {
    return dispatchToastMessage;
  },
  subscribeToToastMessages: function () {
    return subscribeToToastMessages;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);
var emitter = new Emitter();

var dispatchToastMessage = function (payload) {
  // TODO: buffer it if there is no subscriber
  emitter.emit('notify', payload);
};

var subscribeToToastMessages = function (callback) {
  return emitter.on('notify', callback);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userData.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/lib/userData.ts                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["type", "id"];

var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 2);
module.export({
  isSyncReady: function () {
    return isSyncReady;
  },
  synchronizeUserData: function () {
    return synchronizeUserData;
  },
  removeLocalUserData: function () {
    return removeLocalUserData;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var Users;
module.link("../../app/models/client", {
  Users: function (v) {
    Users = v;
  }
}, 2);
var Notifications;
module.link("../../app/notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 3);
var APIClient;
module.link("../../app/utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 4);
var isSyncReady = new ReactiveVar(false);

var updateUser = function (userData) {
  var user = Users.findOne({
    _id: userData._id
  });

  if (!user || !user._updatedAt || user._updatedAt.getTime() < userData._updatedAt.getTime()) {
    Meteor.users.upsert({
      _id: userData._id
    }, userData);
    return;
  } // delete data already on user's collection as those are newer


  Object.keys(user).forEach(function (key) {
    delete userData[key];
  });
  Meteor.users.update({
    _id: user._id
  }, {
    $set: userData
  });
};

var cancel;

var synchronizeUserData = function () {
  function _callee(uid) {
    var _cancel;

    var userData;
    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              if (uid) {
                _context.next = 2;
                break;
              }

              return _context.abrupt("return");

            case 2:
              // Remove data from any other user that we may have retained
              Meteor.users.remove({
                _id: {
                  $ne: uid
                }
              });
              (_cancel = cancel) === null || _cancel === void 0 ? void 0 : _cancel();
              _context.next = 6;
              return _regeneratorRuntime.awrap(Notifications.onUser('userData', function (data) {
                switch (data.type) {
                  case 'inserted':
                    // eslint-disable-next-line @typescript-eslint/no-unused-vars
                    var type = data.type,
                        id = data.id,
                        user = _objectWithoutProperties(data, _excluded);

                    Meteor.users.insert(user);
                    break;

                  case 'updated':
                    Meteor.users.upsert({
                      _id: uid
                    }, {
                      $set: data.diff,
                      $unset: data.unset
                    });
                    break;

                  case 'removed':
                    Meteor.users.remove({
                      _id: uid
                    });
                    break;
                }
              }));

            case 6:
              cancel = _context.sent;
              _context.next = 9;
              return _regeneratorRuntime.awrap(APIClient.v1.get('me'));

            case 9:
              userData = _context.sent;

              if (userData) {
                updateUser(_objectSpread(_objectSpread({}, userData), {}, {
                  createdAt: new Date(userData.createdAt),
                  _updatedAt: new Date(userData._updatedAt)
                }));
              }

              isSyncReady.set(true);
              return _context.abrupt("return", userData);

            case 13:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}();

var removeLocalUserData = function () {
  return Meteor.users.remove({});
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"sidebar":{"header":{"actions":{"CreateRoom.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "react-dom",
  "../../../contexts/AuthorizationContext",
  "../hooks/useDropdownVisibility",
  "./CreateRoomList"
],"CreateRoomList.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../../app/ui-utils/client",
  "../../../components/CreateDiscussion",
  "../../../components/Sidebar/ListItem",
  "../../../contexts/AuthorizationContext",
  "../../../contexts/ModalContext",
  "../../../contexts/SettingsContext",
  "../../../contexts/TranslationContext",
  "../../../views/teams/CreateTeamModal",
  "../CreateChannelWithData",
  "../CreateDirectMessage"
],"Directory.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/LayoutContext",
  "../../../contexts/RouterContext"
],"Home.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../contexts/LayoutContext",
  "../../../contexts/RouterContext",
  "../../../contexts/SettingsContext"
],"Login.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "../../../contexts/SessionContext",
  "../../../contexts/TranslationContext"
],"Search.tsx":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "tinykeys",
  "../../search/SearchList"
],"Sort.js":[
  "@babel/runtime/helpers/extends",
  "@rocket.chat/fuselage",
  "react",
  "react-dom",
  "../../../components/SortList",
  "../hooks/useDropdownVisibility"
]},"hooks":{"useDropdownVisibility.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react"
]},"CreateChannel.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../components/UserAutoCompleteMultiple",
  "../../contexts/ServerContext",
  "../../contexts/SettingsContext",
  "../../contexts/TranslationContext"
],"CreateChannelWithData.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/toConsumableArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../contexts/AuthorizationContext",
  "../../contexts/SettingsContext",
  "../../hooks/useEndpointActionExperimental",
  "../../hooks/useForm",
  "../../lib/utils/goToRoomById",
  "./CreateChannel"
],"CreateDirectMessage.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../components/UserAutoCompleteMultiple",
  "../../contexts/TranslationContext",
  "../../hooks/useEndpointActionExperimental",
  "../../lib/utils/goToRoomById"
],"EditStatusModal.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../components/UserStatus",
  "../../components/UserStatusMenu",
  "../../contexts/ServerContext",
  "../../contexts/SettingsContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext"
],"UserAvatarButton.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "react",
  "react-dom",
  "../../components/UserStatus",
  "../../components/avatar/UserAvatar",
  "../../contexts/UserContext",
  "./UserDropdown",
  "./hooks/useDropdownVisibility"
],"UserDropdown.tsx":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "meteor/kadira:flow-router",
  "react",
  "../../../app/ui-utils/client",
  "../../../app/user-status/client",
  "../../../definition/UserStatus",
  "../../../lib/callbacks",
  "../../components/MarkdownText",
  "../../components/UserStatus",
  "../../components/avatar/UserAvatar",
  "../../contexts/AuthorizationContext",
  "../../contexts/LayoutContext",
  "../../contexts/RouterContext",
  "../../contexts/SettingsContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../../hooks/useReactiveValue",
  "../../hooks/useUserDisplayName",
  "../../lib/imperativeModal",
  "./EditStatusModal"
],"index.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../hooks/useSidebarPaletteColor",
  "./UserAvatarButton",
  "./actions/CreateRoom",
  "./actions/Directory",
  "./actions/Home",
  "./actions/Login",
  "./actions/Search",
  "./actions/Sort"
]},"Item":{"Condensed.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react"
],"Extended.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../hooks/useTimeAgo"
],"Medium.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react"
]},"RoomList":{"RoomList.js":[
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "react-virtuoso",
  "../../contexts/SessionContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../hooks/useAvatarTemplate",
  "../hooks/usePreventDefault",
  "../hooks/useRoomList",
  "../hooks/useShortcutOpenMenu",
  "../hooks/useSidebarPaletteColor",
  "../hooks/useTemplateByViewMode",
  "./Row",
  "./ScrollerWithCustomProps"
],"Row.js":[
  "@rocket.chat/fuselage",
  "react",
  "../sections/Omnichannel",
  "./SideBarItemTemplateWithData"
],"ScrollerWithCustomProps.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../components/ScrollableContentWrapper"
],"SideBarItemTemplateWithData.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../app/utils/client",
  "../../components/RoomIcon",
  "../../contexts/LayoutContext",
  "../RoomMenu",
  "./normalizeSidebarMessage"
],"index.ts":[
  "./RoomList"
],"normalizeSidebarMessage.js":[
  "@rocket.chat/string-helpers",
  "../../../app/markdown/lib/markdown"
]},"footer":{"SidebarFooter.tsx":[
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-tokens/colors.json",
  "react",
  "../../../app/settings/client"
],"index.ts":[
  "./SidebarFooter"
]},"hooks":{"useAvatarTemplate.js":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../components/avatar/RoomAvatar",
  "../../contexts/UserContext"
],"usePreventDefault.js":[
  "react"
],"useQueryOptions.js":[
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../contexts/SettingsContext",
  "../../contexts/UserContext"
],"useRoomList.ts":[
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../contexts/OmnichannelContext",
  "../../contexts/SettingsContext",
  "../../contexts/UserContext",
  "./useQueryOptions"
],"useShortcutOpenMenu.js":[
  "react",
  "tinykeys"
],"useSidebarPaletteColor.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-tokens/colors",
  "react",
  "../../contexts/SettingsContext",
  "../../lib/utils/isIE11"
],"useTemplateByViewMode.js":[
  "react",
  "../../contexts/UserContext",
  "../Item/Condensed",
  "../Item/Extended",
  "../Item/Medium"
]},"search":{"Row.js":[
  "react",
  "../RoomList/SideBarItemTemplateWithData",
  "./UserItem"
],"ScrollerWithCustomProps.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../components/ScrollableContentWrapper"
],"SearchList.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/taggedTemplateLiteralLoose",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/toConsumableArray",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/css-in-js",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "@rocket.chat/string-helpers",
  "meteor/meteor",
  "react",
  "react-virtuoso",
  "tinykeys",
  "../../contexts/SettingsContext",
  "../../contexts/TranslationContext",
  "../../contexts/UserContext",
  "../../hooks/useAsyncState",
  "../../hooks/useMethodData",
  "../hooks/useAvatarTemplate",
  "../hooks/useTemplateByViewMode",
  "./Row",
  "./ScrollerWithCustomProps"
],"UserItem.js":[
  "@rocket.chat/fuselage",
  "react",
  "../../../app/utils/client",
  "../../components/UserStatus"
]},"sections":{"Omnichannel.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../app/authorization/client",
  "../../contexts/LayoutContext",
  "../../contexts/OmnichannelContext",
  "../../contexts/RouterContext",
  "../../contexts/ServerContext",
  "../../contexts/ToastMessagesContext",
  "../../contexts/TranslationContext"
]},"RoomMenu.js":[
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/regenerator",
  "@rocket.chat/fuselage",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../app/ui-utils/client/lib/RoomManager",
  "../../app/utils/client",
  "../components/GenericModal",
  "../contexts/AuthorizationContext",
  "../contexts/ModalContext",
  "../contexts/RouterContext",
  "../contexts/ServerContext",
  "../contexts/SettingsContext",
  "../contexts/ToastMessagesContext",
  "../contexts/TranslationContext",
  "../contexts/UserContext",
  "../hooks/useDontAskAgain",
  "../views/admin/apps/WarningModal"
]},"UIKit":{"hooks":{"useUIKitHandleAction.tsx":[
  "@babel/runtime/regenerator",
  "@rocket.chat/apps-engine/definition/uikit/UIKitIncomingInteractionContainer",
  "@rocket.chat/fuselage-hooks",
  "../../../app/ui-message/client/ActionManager"
],"useUIKitHandleClose.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@rocket.chat/fuselage-hooks",
  "../../../app/ui-message/client/ActionManager",
  "../../contexts/ToastMessagesContext"
],"useUIKitStateManager.tsx":[
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/extends",
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../../app/ui-message/client/ActionManager",
  "../../../definition/UIKit"
]}},"contexts":{"ServerContext":{"ServerContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/ServerContext/ServerContext.ts                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  ServerContext: function () {
    return ServerContext;
  },
  useServerInformation: function () {
    return useServerInformation;
  },
  useAbsoluteUrl: function () {
    return useAbsoluteUrl;
  },
  useMethod: function () {
    return useMethod;
  },
  useEndpoint: function () {
    return useEndpoint;
  },
  useUpload: function () {
    return useUpload;
  },
  useStream: function () {
    return useStream;
  }
});
var createContext, useCallback, useContext, useMemo;
module.link("react", {
  createContext: function (v) {
    createContext = v;
  },
  useCallback: function (v) {
    useCallback = v;
  },
  useContext: function (v) {
    useContext = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var ServerContext = /*#__PURE__*/createContext({
  info: undefined,
  absoluteUrl: function (path) {
    return path;
  },
  callEndpoint: function () {
    throw new Error('not implemented');
  },
  uploadToEndpoint: function () {
    function _callee() {
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                return _context.abrupt("return", undefined);

              case 1:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }(),
  getStream: function () {
    return function () {
      return function () {
        return undefined;
      };
    };
  }
});

var useServerInformation = function () {
  var _useContext = useContext(ServerContext),
      info = _useContext.info;

  if (!info) {
    throw new Error('useServerInformation: no info available');
  }

  return info;
};

var useAbsoluteUrl = function () {
  return useContext(ServerContext).absoluteUrl;
};

var useMethod = function (methodName) {
  var _useContext2 = useContext(ServerContext),
      callMethod = _useContext2.callMethod;

  return useCallback(function () {
    if (!callMethod) {
      throw new Error("cannot use useMethod(" + methodName + ") hook without a wrapping ServerContext");
    }

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    return callMethod.apply(void 0, [methodName].concat(args));
  }, [callMethod, methodName]);
};

var useEndpoint = function (method, path) {
  var _useContext3 = useContext(ServerContext),
      callEndpoint = _useContext3.callEndpoint;

  return useCallback(function (params) {
    return callEndpoint(method, path, params);
  }, [callEndpoint, path, method]);
};

var useUpload = function (endpoint) {
  var _useContext4 = useContext(ServerContext),
      uploadToEndpoint = _useContext4.uploadToEndpoint;

  return useCallback(function (params, formData) {
    return uploadToEndpoint(endpoint, params, formData);
  }, [endpoint, uploadToEndpoint]);
};

var useStream = function (streamName, options) {
  var _useContext5 = useContext(ServerContext),
      getStream = _useContext5.getStream;

  return useMemo(function () {
    return getStream(streamName, options);
  }, [getStream, streamName, options]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/ServerContext/index.ts                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./ServerContext", {
  "*": "*"
}, 0);
module.link("./methods", {
  "*": "*"
}, 1);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"methods.ts":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/ServerContext/methods.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"AuthorizationContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/AuthorizationContext.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _inheritsLoose;

module.link("@babel/runtime/helpers/inheritsLoose", {
  default: function (v) {
    _inheritsLoose = v;
  }
}, 0);
module.export({
  RoleStore: function () {
    return RoleStore;
  },
  AuthorizationContext: function () {
    return AuthorizationContext;
  },
  usePermission: function () {
    return usePermission;
  },
  useAtLeastOnePermission: function () {
    return useAtLeastOnePermission;
  },
  useAllPermissions: function () {
    return useAllPermissions;
  },
  useRolesDescription: function () {
    return useRolesDescription;
  },
  useRole: function () {
    return useRole;
  }
});
var Emitter;
module.link("@rocket.chat/emitter", {
  Emitter: function (v) {
    Emitter = v;
  }
}, 0);
var createContext, useContext, useMemo, useCallback;
module.link("react", {
  createContext: function (v) {
    createContext = v;
  },
  useContext: function (v) {
    useContext = v;
  },
  useMemo: function (v) {
    useMemo = v;
  },
  useCallback: function (v) {
    useCallback = v;
  }
}, 1);
var useSubscription;
module.link("use-subscription", {
  useSubscription: function (v) {
    useSubscription = v;
  }
}, 2);

var RoleStore = /*#__PURE__*/function (_Emitter) {
  _inheritsLoose(RoleStore, _Emitter);

  function RoleStore() {
    var _this;

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _Emitter.call.apply(_Emitter, [this].concat(args)) || this;
    _this.roles = {};
    return _this;
  }

  return RoleStore;
}(Emitter);

var AuthorizationContext = /*#__PURE__*/createContext({
  queryPermission: function () {
    return {
      getCurrentValue: function () {
        return false;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  queryAtLeastOnePermission: function () {
    return {
      getCurrentValue: function () {
        return false;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  queryAllPermissions: function () {
    return {
      getCurrentValue: function () {
        return false;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  queryRole: function () {
    return {
      getCurrentValue: function () {
        return false;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  roleStore: new RoleStore()
});

var usePermission = function (permission, scope) {
  var _useContext = useContext(AuthorizationContext),
      queryPermission = _useContext.queryPermission;

  var subscription = useMemo(function () {
    return queryPermission(permission, scope);
  }, [queryPermission, permission, scope]);
  return useSubscription(subscription);
};

var useAtLeastOnePermission = function (permissions, scope) {
  var _useContext2 = useContext(AuthorizationContext),
      queryAtLeastOnePermission = _useContext2.queryAtLeastOnePermission;

  var subscription = useMemo(function () {
    return queryAtLeastOnePermission(permissions, scope);
  }, [queryAtLeastOnePermission, permissions, scope]);
  return useSubscription(subscription);
};

var useAllPermissions = function (permissions, scope) {
  var _useContext3 = useContext(AuthorizationContext),
      queryAllPermissions = _useContext3.queryAllPermissions;

  var subscription = useMemo(function () {
    return queryAllPermissions(permissions, scope);
  }, [queryAllPermissions, permissions, scope]);
  return useSubscription(subscription);
};

var useRolesDescription = function () {
  var _useContext4 = useContext(AuthorizationContext),
      roleStore = _useContext4.roleStore;

  var subscription = useMemo(function () {
    return {
      getCurrentValue: function () {
        return roleStore.roles;
      },
      subscribe: function (callback) {
        roleStore.on('change', callback);
        return function () {
          roleStore.off('change', callback);
        };
      }
    };
  }, [roleStore]);
  var roles = useSubscription(subscription);
  return useCallback(function (values) {
    return values.map(function (role) {
      return roles[role] && roles[role].description || role;
    });
  }, [roles]);
};

var useRole = function (role) {
  var _useContext5 = useContext(AuthorizationContext),
      queryRole = _useContext5.queryRole;

  var subscription = useMemo(function () {
    return queryRole(role);
  }, [queryRole, role]);
  return useSubscription(subscription);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"AvatarUrlContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/AvatarUrlContext.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  AvatarUrlContext: function () {
    return AvatarUrlContext;
  },
  useRoomAvatarPath: function () {
    return useRoomAvatarPath;
  },
  useUserAvatarPath: function () {
    return useUserAvatarPath;
  }
});
var createContext, useContext;
module.link("react", {
  createContext: function (v) {
    createContext = v;
  },
  useContext: function (v) {
    useContext = v;
  }
}, 0);
var dummy = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQYV2Oora39DwAFaQJ3y3rKeAAAAABJRU5ErkJggg==';
var AvatarUrlContextValueDefault = {
  getUserPathAvatar: function () {
    return dummy;
  },
  getRoomPathAvatar: function () {
    return dummy;
  }
};
var AvatarUrlContext = /*#__PURE__*/createContext(AvatarUrlContextValueDefault);

var useRoomAvatarPath = function () {
  return useContext(AvatarUrlContext).getRoomPathAvatar;
};

var useUserAvatarPath = function () {
  return useContext(AvatarUrlContext).getUserPathAvatar;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ConnectionStatusContext.ts":[
  "react"
],"CustomSoundContext.ts":[
  "react"
],"EditableSettingsContext.ts":[
  "react",
  "use-subscription"
],"LayoutContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/LayoutContext.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  LayoutContext: function () {
    return LayoutContext;
  },
  useLayout: function () {
    return useLayout;
  }
});
var createContext, useContext;
module.link("react", {
  createContext: function (v) {
    createContext = v;
  },
  useContext: function (v) {
    useContext = v;
  }
}, 0);
var LayoutContext = /*#__PURE__*/createContext({
  isEmbedded: false,
  showTopNavbarEmbeddedLayout: false,
  isMobile: false,
  sidebar: {},
  size: {
    sidebar: '380px',
    contextualBar: '380px'
  },
  contextualBarPosition: 'relative',
  contextualBarExpanded: false
});

var useLayout = function () {
  return useContext(LayoutContext);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ModalContext.ts":[
  "react",
  "../../app/ui-utils/client"
],"OmnichannelContext.ts":[
  "react"
],"RouterContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/RouterContext.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  RouterContext: function () {
    return RouterContext;
  },
  useRoute: function () {
    return useRoute;
  },
  useRoutePath: function () {
    return useRoutePath;
  },
  useRouteUrl: function () {
    return useRouteUrl;
  },
  useRouteParameter: function () {
    return useRouteParameter;
  },
  useQueryStringParameter: function () {
    return useQueryStringParameter;
  },
  useCurrentRoute: function () {
    return useCurrentRoute;
  }
});
var createContext, useContext, useMemo;
module.link("react", {
  createContext: function (v) {
    createContext = v;
  },
  useContext: function (v) {
    useContext = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var useSubscription;
module.link("use-subscription", {
  useSubscription: function (v) {
    useSubscription = v;
  }
}, 1);
var RouterContext = /*#__PURE__*/createContext({
  queryRoutePath: function () {
    return {
      getCurrentValue: function () {
        return undefined;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  queryRouteUrl: function () {
    return {
      getCurrentValue: function () {
        return undefined;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  pushRoute: function () {
    return undefined;
  },
  replaceRoute: function () {
    return undefined;
  },
  queryRouteParameter: function () {
    return {
      getCurrentValue: function () {
        return undefined;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  queryQueryStringParameter: function () {
    return {
      getCurrentValue: function () {
        return undefined;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  queryCurrentRoute: function () {
    return {
      getCurrentValue: function () {
        return [undefined, {}, {}, undefined];
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  }
});

var useRoute = function (name) {
  var _useContext = useContext(RouterContext),
      queryRoutePath = _useContext.queryRoutePath,
      queryRouteUrl = _useContext.queryRouteUrl,
      pushRoute = _useContext.pushRoute,
      replaceRoute = _useContext.replaceRoute;

  return useMemo(function () {
    return {
      getPath: function (parameters, queryStringParameters) {
        return queryRoutePath(name, parameters, queryStringParameters).getCurrentValue();
      },
      getUrl: function (parameters, queryStringParameters) {
        return queryRouteUrl(name, parameters, queryStringParameters).getCurrentValue();
      },
      push: function (parameters, queryStringParameters) {
        return pushRoute(name, parameters, queryStringParameters);
      },
      replace: function (parameters, queryStringParameters) {
        return replaceRoute(name, parameters, queryStringParameters);
      }
    };
  }, [queryRoutePath, queryRouteUrl, name, pushRoute, replaceRoute]);
};

var useRoutePath = function (name, parameters, queryStringParameters) {
  var _useContext2 = useContext(RouterContext),
      queryRoutePath = _useContext2.queryRoutePath;

  return useSubscription(useMemo(function () {
    return queryRoutePath(name, parameters, queryStringParameters);
  }, [queryRoutePath, name, parameters, queryStringParameters]));
};

var useRouteUrl = function (name, parameters, queryStringParameters) {
  var _useContext3 = useContext(RouterContext),
      queryRouteUrl = _useContext3.queryRouteUrl;

  return useSubscription(useMemo(function () {
    return queryRouteUrl(name, parameters, queryStringParameters);
  }, [queryRouteUrl, name, parameters, queryStringParameters]));
};

var useRouteParameter = function (name) {
  var _useContext4 = useContext(RouterContext),
      queryRouteParameter = _useContext4.queryRouteParameter;

  return useSubscription(useMemo(function () {
    return queryRouteParameter(name);
  }, [queryRouteParameter, name]));
};

var useQueryStringParameter = function (name) {
  var _useContext5 = useContext(RouterContext),
      queryQueryStringParameter = _useContext5.queryQueryStringParameter;

  return useSubscription(useMemo(function () {
    return queryQueryStringParameter(name);
  }, [queryQueryStringParameter, name]));
};

var useCurrentRoute = function () {
  var _useContext6 = useContext(RouterContext),
      queryCurrentRoute = _useContext6.queryCurrentRoute;

  return useSubscription(useMemo(function () {
    return queryCurrentRoute();
  }, [queryCurrentRoute]));
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"SessionContext.ts":[
  "react",
  "use-subscription"
],"SettingsContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/SettingsContext.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  SettingsContext: function () {
    return SettingsContext;
  },
  useIsPrivilegedSettingsContext: function () {
    return useIsPrivilegedSettingsContext;
  },
  useIsSettingsContextLoading: function () {
    return useIsSettingsContextLoading;
  },
  useSettingStructure: function () {
    return useSettingStructure;
  },
  useSetting: function () {
    return useSetting;
  },
  useSettings: function () {
    return useSettings;
  },
  useSettingsDispatch: function () {
    return useSettingsDispatch;
  },
  useSettingSetValue: function () {
    return useSettingSetValue;
  }
});
var createContext, useCallback, useContext, useMemo;
module.link("react", {
  createContext: function (v) {
    createContext = v;
  },
  useCallback: function (v) {
    useCallback = v;
  },
  useContext: function (v) {
    useContext = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 0);
var useSubscription;
module.link("use-subscription", {
  useSubscription: function (v) {
    useSubscription = v;
  }
}, 1);
var SettingsContext = /*#__PURE__*/createContext({
  hasPrivateAccess: false,
  isLoading: false,
  querySetting: function () {
    return {
      getCurrentValue: function () {
        return undefined;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  querySettings: function () {
    return {
      getCurrentValue: function () {
        return [];
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  dispatch: function () {
    function _callee() {
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                return _context.abrupt("return", undefined);

              case 1:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }()
});

var useIsPrivilegedSettingsContext = function () {
  return useContext(SettingsContext).hasPrivateAccess;
};

var useIsSettingsContextLoading = function () {
  return useContext(SettingsContext).isLoading;
};

var useSettingStructure = function (_id) {
  var _useContext = useContext(SettingsContext),
      querySetting = _useContext.querySetting;

  var subscription = useMemo(function () {
    return querySetting(_id);
  }, [querySetting, _id]);
  return useSubscription(subscription);
};

var useSetting = function (_id) {
  var _useSettingStructure;

  return (_useSettingStructure = useSettingStructure(_id)) === null || _useSettingStructure === void 0 ? void 0 : _useSettingStructure.value;
};

var useSettings = function (query) {
  var _useContext2 = useContext(SettingsContext),
      querySettings = _useContext2.querySettings;

  var subscription = useMemo(function () {
    return querySettings(query !== null && query !== void 0 ? query : {});
  }, [querySettings, query]);
  return useSubscription(subscription);
};

var useSettingsDispatch = function () {
  return useContext(SettingsContext).dispatch;
};

var useSettingSetValue = function (_id) {
  var dispatch = useSettingsDispatch();
  return useCallback(function (value) {
    return dispatch([{
      _id: _id,
      value: value
    }]);
  }, [dispatch, _id]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"SidebarContext.ts":[
  "react"
],"ToastMessagesContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/ToastMessagesContext.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  ToastMessagesContext: function () {
    return ToastMessagesContext;
  },
  useToastMessageDispatch: function () {
    return useToastMessageDispatch;
  }
});
var createContext, useContext;
module.link("react", {
  createContext: function (v) {
    createContext = v;
  },
  useContext: function (v) {
    useContext = v;
  }
}, 0);
var ToastMessagesContext = /*#__PURE__*/createContext({
  dispatch: function () {
    return undefined;
  }
});

var useToastMessageDispatch = function () {
  return useContext(ToastMessagesContext).dispatch;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"TranslationContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/TranslationContext.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  TranslationContext: function () {
    return TranslationContext;
  },
  useLanguages: function () {
    return useLanguages;
  },
  useLanguage: function () {
    return useLanguage;
  },
  useLoadLanguage: function () {
    return useLoadLanguage;
  },
  useTranslation: function () {
    return useTranslation;
  }
});
var createContext, useContext;
module.link("react", {
  createContext: function (v) {
    createContext = v;
  },
  useContext: function (v) {
    useContext = v;
  }
}, 0);
var TranslationContext = /*#__PURE__*/createContext({
  languages: [{
    name: 'Default',
    en: 'Default',
    key: ''
  }],
  language: '',
  loadLanguage: function () {
    function _callee() {
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                return _context.abrupt("return", undefined);

              case 1:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }(),
  translate: Object.assign(function (key) {
    return key;
  }, {
    has: function () {
      return true;
    }
  })
});

var useLanguages = function () {
  return useContext(TranslationContext).languages;
};

var useLanguage = function () {
  return useContext(TranslationContext).language;
};

var useLoadLanguage = function () {
  return useContext(TranslationContext).loadLanguage;
};

var useTranslation = function () {
  return useContext(TranslationContext).translate;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserContext.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/contexts/UserContext.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  UserContext: function () {
    return UserContext;
  },
  useUserId: function () {
    return useUserId;
  },
  useUser: function () {
    return useUser;
  },
  useLoginWithPassword: function () {
    return useLoginWithPassword;
  },
  useLogout: function () {
    return useLogout;
  },
  useUserPreference: function () {
    return useUserPreference;
  },
  useUserSubscription: function () {
    return useUserSubscription;
  },
  useUserRoom: function () {
    return useUserRoom;
  },
  useUserSubscriptions: function () {
    return useUserSubscriptions;
  },
  useUserSubscriptionByName: function () {
    return useUserSubscriptionByName;
  }
});
var useMutableCallback;
module.link("@rocket.chat/fuselage-hooks", {
  useMutableCallback: function (v) {
    useMutableCallback = v;
  }
}, 0);
var createContext, useContext, useMemo;
module.link("react", {
  createContext: function (v) {
    createContext = v;
  },
  useContext: function (v) {
    useContext = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 1);
var useSubscription;
module.link("use-subscription", {
  useSubscription: function (v) {
    useSubscription = v;
  }
}, 2);
var useRoute;
module.link("./RouterContext", {
  useRoute: function (v) {
    useRoute = v;
  }
}, 3);
var UserContext = /*#__PURE__*/createContext({
  userId: null,
  user: null,
  loginWithPassword: function () {
    function _callee() {
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                return _context.abrupt("return", undefined);

              case 1:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }(),
  logout: function () {
    return Promise.resolve();
  },
  queryPreference: function () {
    return {
      getCurrentValue: function () {
        return undefined;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  querySubscription: function () {
    return {
      getCurrentValue: function () {
        return undefined;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  queryRoom: function () {
    return {
      getCurrentValue: function () {
        return undefined;
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  },
  querySubscriptions: function () {
    return {
      getCurrentValue: function () {
        return [];
      },
      subscribe: function () {
        return function () {
          return undefined;
        };
      }
    };
  }
});

var useUserId = function () {
  return useContext(UserContext).userId;
};

var useUser = function () {
  return useContext(UserContext).user;
};

var useLoginWithPassword = function () {
  return useContext(UserContext).loginWithPassword;
};

var useLogout = function () {
  var router = useRoute('home');

  var _useContext = useContext(UserContext),
      logout = _useContext.logout;

  var handleLogout = useMutableCallback(function () {
    logout();
    router.push({});
  });
  return handleLogout;
};

var useUserPreference = function (key, defaultValue) {
  var _useContext2 = useContext(UserContext),
      queryPreference = _useContext2.queryPreference;

  var subscription = useMemo(function () {
    return queryPreference(key, defaultValue);
  }, [queryPreference, key, defaultValue]);
  return useSubscription(subscription);
};

var useUserSubscription = function (rid, fields) {
  var _useContext3 = useContext(UserContext),
      querySubscription = _useContext3.querySubscription;

  var subscription = useMemo(function () {
    return querySubscription({
      rid: rid
    }, fields);
  }, [querySubscription, rid, fields]);
  return useSubscription(subscription);
};

var useUserRoom = function (rid, fields) {
  var _useContext4 = useContext(UserContext),
      queryRoom = _useContext4.queryRoom;

  var subscription = useMemo(function () {
    return queryRoom({
      _id: rid
    }, fields);
  }, [queryRoom, rid, fields]);
  return useSubscription(subscription);
};

var useUserSubscriptions = function (query, options) {
  var _useContext5 = useContext(UserContext),
      querySubscriptions = _useContext5.querySubscriptions;

  var subscription = useMemo(function () {
    return querySubscriptions(query, options);
  }, [querySubscriptions, query, options]);
  return useSubscription(subscription);
};

var useUserSubscriptionByName = function (name, fields, sort) {
  var _useContext6 = useContext(UserContext),
      querySubscription = _useContext6.querySubscription;

  var subscription = useMemo(function () {
    return querySubscription({
      name: name
    }, fields, sort);
  }, [querySubscription, name, fields, sort]);
  return useSubscription(subscription);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"hooks":{"lists":{"useRecordList.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "react"
],"useScrollableMessageList.ts":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../../lib/utils/mapMessageFromApi",
  "./useScrollableRecordList"
],"useScrollableRecordList.ts":[
  "react",
  "../../lib/asyncState"
],"useStreamUpdatesForMessageList.ts":[
  "react",
  "../../contexts/ServerContext",
  "../../lib/minimongo"
]},"useAsyncState.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useAsyncState.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);
module.export({
  useAsyncState: function () {
    return useAsyncState;
  },
  AsyncStatePhase: function () {
    return AsyncStatePhase;
  },
  AsyncState: function () {
    return AsyncState;
  }
});
var useSafely;
module.link("@rocket.chat/fuselage-hooks", {
  useSafely: function (v) {
    useSafely = v;
  }
}, 0);
var useCallback, useMemo, useState;
module.link("react", {
  useCallback: function (v) {
    useCallback = v;
  },
  useMemo: function (v) {
    useMemo = v;
  },
  useState: function (v) {
    useState = v;
  }
}, 1);
var AsyncStatePhase, AsyncState, asyncState;
module.link("../lib/asyncState", {
  AsyncStatePhase: function (v) {
    AsyncStatePhase = v;
  },
  AsyncState: function (v) {
    AsyncState = v;
  },
  asyncState: function (v) {
    asyncState = v;
  }
}, 2);

var useAsyncState = function (initialValue) {
  var _useSafely = useSafely(useState(function () {
    if (typeof initialValue === 'undefined') {
      return asyncState.loading();
    }

    return asyncState.resolved(typeof initialValue === 'function' ? initialValue() : initialValue);
  })),
      _useSafely2 = _slicedToArray(_useSafely, 2),
      state = _useSafely2[0],
      setState = _useSafely2[1];

  var resolve = useCallback(function (value) {
    setState(function (state) {
      if (typeof value === 'function') {
        return asyncState.resolve(state, value(state.value));
      }

      return asyncState.resolve(state, value);
    });
  }, [setState]);
  var reject = useCallback(function (error) {
    setState(function (state) {
      return asyncState.reject(state, error);
    });
  }, [setState]);
  var update = useCallback(function () {
    setState(function (state) {
      return asyncState.update(state);
    });
  }, [setState]);
  var reset = useCallback(function () {
    setState(function (state) {
      return asyncState.reload(state);
    });
  }, [setState]);
  return useMemo(function () {
    return _objectSpread(_objectSpread({}, state), {}, {
      resolve: resolve,
      reject: reject,
      reset: reset,
      update: update
    });
  }, [state, resolve, reject, reset, update]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useClipboardWithToast.js":[
  "@rocket.chat/fuselage-hooks",
  "../contexts/ToastMessagesContext",
  "../contexts/TranslationContext"
],"useComponentDidUpdate.js":[
  "react"
],"useDontAskAgain.ts":[
  "../contexts/UserContext"
],"useEmbeddedLayout.js":[
  "../contexts/RouterContext"
],"useEndpointAction.ts":[
  "@babel/runtime/regenerator",
  "react",
  "../contexts/ServerContext",
  "../contexts/ToastMessagesContext"
],"useEndpointActionExperimental.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useEndpointActionExperimental.ts                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
module.export({
  useEndpointActionExperimental: function () {
    return useEndpointActionExperimental;
  }
});
var useCallback;
module.link("react", {
  useCallback: function (v) {
    useCallback = v;
  }
}, 0);
var useEndpoint;
module.link("../contexts/ServerContext", {
  useEndpoint: function (v) {
    useEndpoint = v;
  }
}, 1);
var useToastMessageDispatch;
module.link("../contexts/ToastMessagesContext", {
  useToastMessageDispatch: function (v) {
    useToastMessageDispatch = v;
  }
}, 2);

var useEndpointActionExperimental = function (method, path, successMessage) {
  var sendData = useEndpoint(method, path);
  var dispatchToastMessage = useToastMessageDispatch();
  return useCallback(function () {
    function _callee(params) {
      var data;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.prev = 0;
                _context.next = 3;
                return _regeneratorRuntime.awrap(sendData(params));

              case 3:
                data = _context.sent;

                if (successMessage) {
                  dispatchToastMessage({
                    type: 'success',
                    message: successMessage
                  });
                }

                return _context.abrupt("return", data);

              case 8:
                _context.prev = 8;
                _context.t0 = _context["catch"](0);
                dispatchToastMessage({
                  type: 'error',
                  message: _context.t0
                }); // return { success: false };

                throw _context.t0;

              case 12:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, [[0, 8]], Promise);
    }

    return _callee;
  }(), [dispatchToastMessage, sendData, successMessage]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useEndpointData.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useEndpointData.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["resolve", "reject", "reset"];

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 1);
module.export({
  useEndpointData: function () {
    return useEndpointData;
  }
});
var useCallback, useEffect;
module.link("react", {
  useCallback: function (v) {
    useCallback = v;
  },
  useEffect: function (v) {
    useEffect = v;
  }
}, 0);
var useEndpoint;
module.link("../contexts/ServerContext", {
  useEndpoint: function (v) {
    useEndpoint = v;
  }
}, 1);
var useToastMessageDispatch;
module.link("../contexts/ToastMessagesContext", {
  useToastMessageDispatch: function (v) {
    useToastMessageDispatch = v;
  }
}, 2);
var useAsyncState;
module.link("./useAsyncState", {
  useAsyncState: function (v) {
    useAsyncState = v;
  }
}, 3);

var useEndpointData = function (endpoint) {
  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;
  var initialValue = arguments.length > 2 ? arguments[2] : undefined;

  var _useAsyncState = useAsyncState(initialValue),
      resolve = _useAsyncState.resolve,
      reject = _useAsyncState.reject,
      reset = _useAsyncState.reset,
      state = _objectWithoutProperties(_useAsyncState, _excluded);

  var dispatchToastMessage = useToastMessageDispatch();
  var getData = useEndpoint('GET', endpoint);
  var fetchData = useCallback(function () {
    reset();
    getData(params).then(resolve).catch(function (error) {
      console.error(error);
      dispatchToastMessage({
        type: 'error',
        message: error
      });
      reject(error);
    });
  }, [reset, getData, params, resolve, dispatchToastMessage, reject]);
  useEffect(function () {
    fetchData();
  }, [fetchData]);
  return _objectSpread(_objectSpread({}, state), {}, {
    reload: fetchData
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useEndpointUpload.js":[
  "@babel/runtime/regenerator",
  "react",
  "../contexts/ServerContext",
  "../contexts/ToastMessagesContext"
],"useFileInput.js":[
  "@rocket.chat/fuselage-hooks",
  "react"
],"useForm.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useForm.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _typeof;

module.link("@babel/runtime/helpers/typeof", {
  default: function (v) {
    _typeof = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 2);
module.export({
  useForm: function () {
    return useForm;
  }
});
var capitalize;
module.link("@rocket.chat/string-helpers", {
  capitalize: function (v) {
    capitalize = v;
  }
}, 0);
var useCallback, useReducer, useMemo;
module.link("react", {
  useCallback: function (v) {
    useCallback = v;
  },
  useReducer: function (v) {
    useReducer = v;
  },
  useMemo: function (v) {
    useMemo = v;
  }
}, 1);

var reduceForm = function (state, action) {
  return action(state);
};

var initForm = function (initialValues) {
  var fields = [];

  for (var _i = 0, _Object$entries = Object.entries(initialValues); _i < _Object$entries.length; _i++) {
    var _ref = _Object$entries[_i];

    var _ref2 = _slicedToArray(_ref, 2);

    var fieldName = _ref2[0];
    var initialValue = _ref2[1];
    fields.push({
      name: fieldName,
      currentValue: initialValue,
      initialValue: initialValue,
      changed: false
    });
  }

  return {
    fields: fields,
    values: _objectSpread({}, initialValues),
    hasUnsavedChanges: false
  };
};

var valueChanged = function (fieldName, newValue) {
  return function (state) {
    var _objectSpread2;

    var fields = state.fields;
    var field = fields.find(function (_ref3) {
      var name = _ref3.name;
      return name === fieldName;
    });

    if (!field || field.currentValue === newValue) {
      return state;
    }

    var newField = _objectSpread(_objectSpread({}, field), {}, {
      currentValue: newValue,
      changed: JSON.stringify(newValue) !== JSON.stringify(field.initialValue)
    });

    fields = state.fields.map(function (field) {
      if (field.name === fieldName) {
        return newField;
      }

      return field;
    });
    return _objectSpread(_objectSpread({}, state), {}, {
      fields: fields,
      values: _objectSpread(_objectSpread({}, state.values), {}, (_objectSpread2 = {}, _objectSpread2[newField.name] = newField.currentValue, _objectSpread2)),
      hasUnsavedChanges: newField.changed || fields.some(function (field) {
        return field.changed;
      })
    });
  };
};

var formCommitted = function () {
  return function (state) {
    return _objectSpread(_objectSpread({}, state), {}, {
      fields: state.fields.map(function (field) {
        return _objectSpread(_objectSpread({}, field), {}, {
          initialValue: field.currentValue,
          changed: false
        });
      }),
      hasUnsavedChanges: false
    });
  };
};

var formReset = function () {
  return function (state) {
    return _objectSpread(_objectSpread({}, state), {}, {
      fields: state.fields.map(function (field) {
        return _objectSpread(_objectSpread({}, field), {}, {
          currentValue: field.initialValue,
          changed: false
        });
      }),
      values: state.fields.reduce(function (values, field) {
        var _objectSpread3;

        return _objectSpread(_objectSpread({}, values), {}, (_objectSpread3 = {}, _objectSpread3[field.name] = field.initialValue, _objectSpread3));
      }, {}),
      hasUnsavedChanges: false
    });
  };
};

var isChangeEvent = function (x) {
  return (_typeof(x) === 'object' || typeof x === 'function') && typeof (x === null || x === void 0 ? void 0 : x.currentTarget) !== 'undefined';
};

var getValue = function (eventOrValue) {
  if (!isChangeEvent(eventOrValue)) {
    return eventOrValue;
  }

  var target = eventOrValue.currentTarget;

  if (target instanceof HTMLTextAreaElement) {
    return target.value;
  }

  if (target instanceof HTMLSelectElement) {
    return target.value;
  }

  if (!(target instanceof HTMLInputElement)) {
    return undefined;
  }

  if (target.type === 'checkbox' || target.type === 'radio') {
    return target.checked;
  }

  return target.value;
};
/**
 * @deprecated prefer react-hook-form's `useForm`
 */


var useForm = function (initialValues) {
  var onChange = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {
    return undefined;
  };

  var _useReducer = useReducer(reduceForm, initialValues, initForm),
      _useReducer2 = _slicedToArray(_useReducer, 2),
      state = _useReducer2[0],
      dispatch = _useReducer2[1];

  var commit = useCallback(function () {
    dispatch(formCommitted());
  }, []);
  var reset = useCallback(function () {
    dispatch(formReset());
  }, []);
  var handlers = useMemo(function () {
    return state.fields.reduce(function (handlers, _ref4) {
      var _objectSpread4;

      var name = _ref4.name,
          initialValue = _ref4.initialValue;
      return _objectSpread(_objectSpread({}, handlers), {}, (_objectSpread4 = {}, _objectSpread4["handle" + capitalize(name)] = function (eventOrValue) {
        var newValue = getValue(eventOrValue);
        dispatch(valueChanged(name, newValue));
        onChange({
          initialValue: initialValue,
          value: newValue,
          key: name,
          values: state.values
        });
      }, _objectSpread4));
    }, {});
  }, [onChange, state.fields, state.values]);
  return {
    handlers: handlers,
    values: state.values,
    hasUnsavedChanges: state.hasUnsavedChanges,
    commit: commit,
    reset: reset
  };
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useFormatDate.js":[
  "moment",
  "react",
  "../contexts/SettingsContext"
],"useFormatDateAndTime.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useFormatDateAndTime.js                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  useFormatDateAndTime: function () {
    return useFormatDateAndTime;
  }
});
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 0);
var useCallback;
module.link("react", {
  useCallback: function (v) {
    useCallback = v;
  }
}, 1);
var useSetting;
module.link("../contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 2);
var useUserPreference;
module.link("../contexts/UserContext", {
  useUserPreference: function (v) {
    useUserPreference = v;
  }
}, 3);

var useFormatDateAndTime = function () {
  var clockMode = useUserPreference('clockMode', false);
  var format = useSetting('Message_TimeAndDateFormat');
  return useCallback(function (time) {
    switch (clockMode) {
      case 1:
        return moment(time).format('MMMM D, Y h:mm A');

      case 2:
        return moment(time).format('MMMM D, Y H:mm');

      default:
        return moment(time).format(format);
    }
  }, [clockMode, format]);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useFormatDuration.js":[
  "react",
  "../contexts/TranslationContext"
],"useFormatMemorySize.js":[
  "underscore.string"
],"useFormatTime.ts":[
  "moment",
  "react",
  "../contexts/SettingsContext",
  "../contexts/UserContext"
],"useFormattedRelativeTime.ts":[
  "moment",
  "react"
],"useHighlightedCode.js":[
  "highlight.js",
  "react"
],"useLocalePercentage.ts":[
  "../contexts/TranslationContext",
  "../lib/getLocalePercentage"
],"useMethodData.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useMethodData.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _excluded = ["resolve", "reject", "reset"];

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);

var _objectWithoutProperties;

module.link("@babel/runtime/helpers/objectWithoutProperties", {
  default: function (v) {
    _objectWithoutProperties = v;
  }
}, 2);
module.export({
  useMethodData: function () {
    return useMethodData;
  }
});
var useCallback, useEffect;
module.link("react", {
  useCallback: function (v) {
    useCallback = v;
  },
  useEffect: function (v) {
    useEffect = v;
  }
}, 0);
var useMethod;
module.link("../contexts/ServerContext", {
  useMethod: function (v) {
    useMethod = v;
  }
}, 1);
var useToastMessageDispatch;
module.link("../contexts/ToastMessagesContext", {
  useToastMessageDispatch: function (v) {
    useToastMessageDispatch = v;
  }
}, 2);
var useAsyncState;
module.link("./useAsyncState", {
  useAsyncState: function (v) {
    useAsyncState = v;
  }
}, 3);
var defaultArgs = [];

var useMethodData = function (methodName) {
  var args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultArgs;
  var initialValue = arguments.length > 2 ? arguments[2] : undefined;

  var _useAsyncState = useAsyncState(initialValue),
      resolve = _useAsyncState.resolve,
      reject = _useAsyncState.reject,
      reset = _useAsyncState.reset,
      state = _objectWithoutProperties(_useAsyncState, _excluded);

  var dispatchToastMessage = useToastMessageDispatch();
  var getData = useMethod(methodName);
  var fetchData = useCallback(function () {
    reset();
    getData.apply(void 0, _toConsumableArray(args)).then(resolve).catch(function (error) {
      console.error(error);
      dispatchToastMessage({
        type: 'error',
        message: error
      });
      reject(error);
    });
  }, [reset, getData, args, resolve, dispatchToastMessage, reject]);
  useEffect(function () {
    fetchData();
  }, [fetchData]);
  return _objectSpread(_objectSpread({}, state), {}, {
    reload: fetchData
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"usePolledMethodData.ts":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "./useMethodData"
],"usePresence.ts":[
  "react",
  "use-subscription",
  "../lib/presence"
],"usePreventProgation.ts":[
  "@rocket.chat/fuselage-hooks"
],"useReactiveValue.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useReactiveValue.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  useReactiveValue: function () {
    return useReactiveValue;
  }
});
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 0);
var useMemo;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  }
}, 1);
var useSubscription;
module.link("use-subscription", {
  useSubscription: function (v) {
    useSubscription = v;
  }
}, 2);

var useReactiveValue = function (computeCurrentValue) {
  var subscription = useMemo(function () {
    var callbacks = new Set();
    var currentValue;
    var computation = Tracker.autorun(function () {
      currentValue = computeCurrentValue();
      callbacks.forEach(function (callback) {
        callback();
      });
    });
    return {
      getCurrentValue: function () {
        return currentValue;
      },
      subscribe: function (callback) {
        callbacks.add(callback);
        return function () {
          callbacks.delete(callback);

          if (callbacks.size === 0) {
            computation.stop();
          }
        };
      }
    };
  }, [computeCurrentValue]);
  return useSubscription(subscription);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"useReactiveVar.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "meteor/tracker",
  "react"
],"useResizeInlineBreakpoint.js":[
  "@babel/runtime/helpers/toConsumableArray",
  "@rocket.chat/fuselage-hooks",
  "react"
],"useRoomIcon.tsx":[
  "react",
  "../../definition/IRoom",
  "../components/UserStatus"
],"useTimeAgo.js":[
  "moment",
  "react"
],"useTimeFromNow.ts":[
  "moment",
  "react"
],"useTimezoneNameList.js":[
  "moment-timezone",
  "react"
],"useTimezoneTime.ts":[
  "@babel/runtime/helpers/slicedToArray",
  "moment",
  "react",
  "./useFormatTime"
],"useUTCClock.ts":[
  "./useTimezoneTime"
],"useUpdateAvatar.js":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "react",
  "../contexts/ServerContext",
  "../contexts/ToastMessagesContext",
  "../contexts/TranslationContext",
  "./useEndpointAction",
  "./useEndpointUpload"
],"useUserDisplayName.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/hooks/useUserDisplayName.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  useUserDisplayName: function () {
    return useUserDisplayName;
  }
});
var useSetting;
module.link("../contexts/SettingsContext", {
  useSetting: function (v) {
    useSetting = v;
  }
}, 0);
var getUserDisplayName;
module.link("../lib/getUserDisplayName", {
  getUserDisplayName: function (v) {
    getUserDisplayName = v;
  }
}, 1);

var useUserDisplayName = function (_ref) {
  var name = _ref.name,
      username = _ref.username;
  var useRealName = useSetting('UI_Use_Real_Name');
  return getUserDisplayName(name, username, !!useRealName);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"startup":{"afterLogoutCleanUp":{"customScriptOnLogout.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/afterLogoutCleanUp/customScriptOnLogout.ts                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 1);
var fireGlobalEvent;
module.link("../../lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 2);
Meteor.startup(function () {
  callbacks.add('afterLogoutCleanUp', function () {
    return fireGlobalEvent('Custom_Script_On_Logout');
  }, callbacks.priority.LOW, 'custom-script-on-logout');
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/afterLogoutCleanUp/index.ts                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./customScriptOnLogout");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"contextualBar":{"exportMessages.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/contextualBar/exportMessages.ts                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var useMemo, lazy;
module.link("react", {
  useMemo: function (v) {
    useMemo = v;
  },
  lazy: function (v) {
    lazy = v;
  }
}, 0);
var usePermission;
module.link("../../contexts/AuthorizationContext", {
  usePermission: function (v) {
    usePermission = v;
  }
}, 1);
var addAction;
module.link("../../views/room/lib/Toolbox", {
  addAction: function (v) {
    addAction = v;
  }
}, 2);
addAction('export-messages', function (_ref) {
  var room = _ref.room;
  var hasPermission = usePermission('mail-messages', room._id);
  return useMemo(function () {
    return hasPermission ? {
      groups: ['channel', 'group', 'direct', 'direct_multiple', 'team'],
      id: 'export-messages',
      anonymous: true,
      title: 'Export_Messages',
      icon: 'mail',
      template: /*#__PURE__*/lazy(function () {
        return module.dynamicImport('../../views/room/contextualBar/ExportMessages');
      }),
      full: true,
      order: 12
    } : null;
  }, [hasPermission]);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/contextualBar/index.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./exportMessages");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"notifications":{"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/notifications/index.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./konchatNotifications");
module.link("./updateAvatar");
module.link("./usersNameChanged");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"konchatNotifications.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/notifications/konchatNotifications.ts                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var CachedChatSubscription;
module.link("../../../app/models/client", {
  CachedChatSubscription: function (v) {
    CachedChatSubscription = v;
  }
}, 4);
var Notifications;
module.link("../../../app/notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 5);
var readMessage;
module.link("../../../app/ui-utils/client", {
  readMessage: function (v) {
    readMessage = v;
  }
}, 6);
var KonchatNotification;
module.link("../../../app/ui/client", {
  KonchatNotification: function (v) {
    KonchatNotification = v;
  }
}, 7);
var getUserPreference;
module.link("../../../app/utils/client", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 8);
var fireGlobalEvent;
module.link("../../lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 9);
var isLayoutEmbedded;
module.link("../../lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded: function (v) {
    isLayoutEmbedded = v;
  }
}, 10);

var notifyNewRoom = function (sub) {
  if (Session.equals("user_" + Meteor.userId() + "_status", 'busy')) {
    return;
  }

  if ((!FlowRouter.getParam('name') || FlowRouter.getParam('name') !== sub.name) && !sub.ls && sub.alert === true) {
    KonchatNotification.newRoom(sub.rid);
  }
};

function notifyNewMessageAudio(rid) {
  var openedRoomId = Session.get('openedRoom'); // This logic is duplicated in /client/startup/unread.coffee.

  var hasFocus = readMessage.isEnable();
  var messageIsInOpenedRoom = openedRoomId === rid;
  var muteFocusedConversations = getUserPreference(Meteor.userId(), 'muteFocusedConversations');

  if (isLayoutEmbedded()) {
    if (!hasFocus && messageIsInOpenedRoom) {
      // Play a notification sound
      KonchatNotification.newMessage(rid);
    }
  } else if (!hasFocus || !messageIsInOpenedRoom || !muteFocusedConversations) {
    // Play a notification sound
    KonchatNotification.newMessage(rid);
  }
}

Meteor.startup(function () {
  Tracker.autorun(function () {
    if (!Meteor.userId()) {
      return;
    }

    Notifications.onUser('notification', function (notification) {
      var openedRoomId = undefined;

      if (['channel', 'group', 'direct'].includes(FlowRouter.getRouteName())) {
        openedRoomId = Session.get('openedRoom');
      } // This logic is duplicated in /client/startup/unread.coffee.


      var hasFocus = readMessage.isEnable();
      var messageIsInOpenedRoom = openedRoomId === notification.payload.rid;
      fireGlobalEvent('notification', {
        notification: notification,
        fromOpenedRoom: messageIsInOpenedRoom,
        hasFocus: hasFocus
      });

      if (isLayoutEmbedded()) {
        if (!hasFocus && messageIsInOpenedRoom) {
          // Show a notification.
          KonchatNotification.showDesktop(notification);
        }
      } else if (!hasFocus || !messageIsInOpenedRoom) {
        // Show a notification.
        KonchatNotification.showDesktop(notification);
      }

      notifyNewMessageAudio(notification.payload.rid);
    });

    CachedChatSubscription.onSyncData = function (action, sub) {
      if (action !== 'removed') {
        notifyNewRoom(sub);
      }
    };

    Notifications.onUser('subscriptions-changed', function (_action, sub) {
      notifyNewRoom(sub);
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"updateAvatar.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/notifications/updateAvatar.ts                                                                        //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Notifications;
module.link("../../../app/notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 1);
Meteor.startup(function () {
  Notifications.onLogged('updateAvatar', function (data) {
    var username = data.username,
        etag = data.etag;
    username && Meteor.users.update({
      username: username
    }, {
      $set: {
        avatarETag: etag
      }
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"usersNameChanged.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/notifications/usersNameChanged.ts                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Messages, RoomRoles, Subscriptions;
module.link("../../../app/models/client", {
  Messages: function (v) {
    Messages = v;
  },
  RoomRoles: function (v) {
    RoomRoles = v;
  },
  Subscriptions: function (v) {
    Subscriptions = v;
  }
}, 1);
var Notifications;
module.link("../../../app/notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 2);
Meteor.startup(function () {
  Notifications.onLogged('Users:NameChanged', function (_ref) {
    var _id = _ref._id,
        name = _ref.name,
        username = _ref.username;
    Messages.update({
      'u._id': _id
    }, {
      $set: {
        'u.username': username,
        'u.name': name
      }
    }, {
      multi: true
    });
    Messages.update({
      mentions: {
        $elemMatch: {
          _id: _id
        }
      }
    }, {
      $set: {
        'mentions.$.username': username,
        'mentions.$.name': name
      }
    }, {
      multi: true
    });
    Subscriptions.update({
      name: username,
      t: 'd'
    }, {
      $set: {
        fname: name
      }
    });
    RoomRoles.update({
      'u._id': _id
    }, {
      $set: {
        'u.name': name
      }
    }, {
      multi: true
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"renderMessage":{"autolinker.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/autolinker.ts                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var isEnabled = settings.get('AutoLinker') === true;

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'autolinker');
      return;
    }

    var options = {
      stripPrefix: settings.get('AutoLinker_StripPrefix'),
      urls: {
        schemeMatches: settings.get('AutoLinker_Urls_Scheme'),
        wwwMatches: settings.get('AutoLinker_Urls_www'),
        tldMatches: settings.get('AutoLinker_Urls_TLD')
      },
      email: settings.get('AutoLinker_Email'),
      phone: settings.get('AutoLinker_Phone')
    };
    module.dynamicImport('../../../app/autolinker/client').then(function (_ref) {
      var createAutolinkerMessageRenderer = _ref.createAutolinkerMessageRenderer;
      var renderMessage = createAutolinkerMessageRenderer(options);
      callbacks.remove('renderMessage', 'autolinker');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.MEDIUM, 'autolinker');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"autotranslate.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/autotranslate.ts                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var hasPermission;
module.link("../../../app/authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 2);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 4);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var isEnabled = settings.get('AutoTranslate_Enabled') && hasPermission('auto-translate');

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'autotranslate');
      return;
    }

    module.dynamicImport('../../../app/autotranslate/client').then(function (_ref) {
      var createAutoTranslateMessageRenderer = _ref.createAutoTranslateMessageRenderer;
      var renderMessage = createAutoTranslateMessageRenderer();
      callbacks.remove('renderMessage', 'autotranslate');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.HIGH - 3, 'autotranslate');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emoji.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/emoji.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var getUserPreference;
module.link("../../../app/utils/client", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 2);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var isEnabled = getUserPreference(Meteor.userId(), 'useEmojis');

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'emoji');
      return;
    }

    module.dynamicImport('../../../app/emoji/client').then(function (_ref) {
      var createEmojiMessageRenderer = _ref.createEmojiMessageRenderer;
      var renderMessage = createEmojiMessageRenderer();
      callbacks.remove('renderMessage', 'emoji');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.LOW, 'emoji');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hexcolor.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/hexcolor.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var isEnabled = settings.get('HexColorPreview_Enabled') === true;

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'hexcolor');
      return;
    }

    module.dynamicImport('../../../app/colors/client').then(function (_ref) {
      var createHexColorPreviewMessageRenderer = _ref.createHexColorPreviewMessageRenderer;
      var renderMessage = createHexColorPreviewMessageRenderer();
      callbacks.remove('renderMessage', 'hexcolor');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.MEDIUM, 'hexcolor');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"highlightWords.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/highlightWords.ts                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var getUserPreference;
module.link("../../../app/utils/client", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 2);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var _highlights$some;

    var highlights = getUserPreference(Meteor.userId(), 'highlights');
    var isEnabled = (_highlights$some = highlights === null || highlights === void 0 ? void 0 : highlights.some(function (highlight) {
      return highlight === null || highlight === void 0 ? void 0 : highlight.trim();
    })) !== null && _highlights$some !== void 0 ? _highlights$some : false;

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'highlight-words');
      return;
    }

    var options = {
      wordsToHighlight: highlights === null || highlights === void 0 ? void 0 : highlights.filter(function (highlight) {
        return highlight === null || highlight === void 0 ? void 0 : highlight.trim();
      })
    };
    module.dynamicImport('../../../app/highlight-words').then(function (_ref) {
      var createHighlightWordsMessageRenderer = _ref.createHighlightWordsMessageRenderer;
      var renderMessage = createHighlightWordsMessageRenderer(options);
      callbacks.remove('renderMessage', 'highlight-words');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.MEDIUM + 1, 'highlight-words');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/index.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./autolinker");
module.link("./autotranslate");
module.link("./emoji");
module.link("./hexcolor");
module.link("./highlightWords");
module.link("./issuelink");
module.link("./katex");
module.link("./markdown");
module.link("./mentionsMessage");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"issuelink.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/issuelink.ts                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var isEnabled = settings.get('IssueLinks_Enabled');

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'issuelink');
      return;
    }

    var options = {
      template: settings.get('IssueLinks_Template')
    };
    module.dynamicImport('../../../app/issuelinks/client').then(function (_ref) {
      var createIssueLinksMessageRenderer = _ref.createIssueLinksMessageRenderer;
      var renderMessage = createIssueLinksMessageRenderer(options);
      callbacks.remove('renderMessage', 'issuelink');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.MEDIUM, 'issuelink');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"katex.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/katex.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var isEnabled = settings.get('Katex_Enabled');

    if (!isEnabled) {
      callbacks.remove('renderMessage', 'katex');
      return;
    }

    var options = {
      dollarSyntax: settings.get('Katex_Dollar_Syntax'),
      parenthesisSyntax: settings.get('Katex_Parenthesis_Syntax')
    };
    module.dynamicImport('../../../app/katex/client').then(function (_ref) {
      var createKatexMessageRendering = _ref.createKatexMessageRendering;
      var renderMessage = createKatexMessageRendering(options);
      callbacks.remove('renderMessage', 'katex');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.HIGH + 1, 'katex');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"markdown.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/markdown.ts                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 3);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var options = {
      parser: settings.get('Markdown_Parser'),
      supportSchemesForLink: settings.get('Markdown_SupportSchemesForLink'),
      headers: settings.get('Markdown_Headers'),
      rootUrl: Meteor.absoluteUrl(),
      marked: {
        gfm: settings.get('Markdown_Marked_GFM'),
        tables: settings.get('Markdown_Marked_Tables'),
        breaks: settings.get('Markdown_Marked_Breaks'),
        pedantic: settings.get('Markdown_Marked_Pedantic'),
        smartLists: settings.get('Markdown_Marked_SmartLists'),
        smartypants: settings.get('Markdown_Marked_Smartypants')
      }
    };
    module.dynamicImport('../../../app/markdown/client').then(function (_ref) {
      var createMarkdownMessageRenderer = _ref.createMarkdownMessageRenderer;
      var renderMessage = createMarkdownMessageRenderer(options);
      callbacks.remove('renderMessage', 'markdown');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.HIGH, 'markdown');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"mentionsMessage.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderMessage/mentionsMessage.ts                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var Users;
module.link("../../../app/models/client", {
  Users: function (v) {
    Users = v;
  }
}, 2);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 4);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var uid = Meteor.userId();
    var options = {
      me: uid && (Users.findOne(uid, {
        fields: {
          username: 1
        }
      }) || {}).username,
      pattern: settings.get('UTF8_User_Names_Validation'),
      useRealName: settings.get('UI_Use_Real_Name')
    };
    module.dynamicImport('../../../app/mentions/client').then(function (_ref) {
      var createMentionsMessageRenderer = _ref.createMentionsMessageRenderer;
      var renderMessage = createMentionsMessageRenderer(options);
      callbacks.remove('renderMessage', 'mentions-message');
      callbacks.add('renderMessage', renderMessage, callbacks.priority.MEDIUM, 'mentions-message');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"renderNotification":{"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderNotification/index.ts                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./markdown");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"markdown.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/renderNotification/markdown.ts                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 1);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 2);
Meteor.startup(function () {
  var options = {
    supportSchemesForLink: settings.get('Markdown_SupportSchemesForLink')
  };
  module.dynamicImport('../../../app/markdown/client').then(function (_ref) {
    var createMarkdownNotificationRenderer = _ref.createMarkdownNotificationRenderer;
    var renderNotification = createMarkdownNotificationRenderer(options);
    callbacks.remove('renderNotification', 'filter-markdown');
    callbacks.add('renderNotification', renderNotification, callbacks.priority.HIGH, 'filter-markdown');
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"streamMessage":{"autotranslate.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/streamMessage/autotranslate.ts                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var hasPermission;
module.link("../../../app/authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 2);
var settings;
module.link("../../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var callbacks;
module.link("../../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 4);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var isEnabled = settings.get('AutoTranslate_Enabled') && hasPermission('auto-translate');

    if (!isEnabled) {
      callbacks.remove('streamMessage', 'autotranslate-stream');
      return;
    }

    module.dynamicImport('../../../app/autotranslate/client').then(function (_ref) {
      var createAutoTranslateMessageStreamHandler = _ref.createAutoTranslateMessageStreamHandler;
      var streamMessage = createAutoTranslateMessageStreamHandler();
      callbacks.remove('streamMessage', 'autotranslate-stream');
      callbacks.add('streamMessage', streamMessage, callbacks.priority.HIGH - 3, 'autotranslate-stream');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/streamMessage/index.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./autotranslate");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"UserDeleted.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/UserDeleted.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ChatMessage;
module.link("../../app/models/client", {
  ChatMessage: function (v) {
    ChatMessage = v;
  }
}, 1);
var Notifications;
module.link("../../app/notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 2);
Meteor.startup(function () {
  Notifications.onLogged('Users:Deleted', function (_ref) {
    var userId = _ref.userId;
    ChatMessage.remove({
      'u._id': userId
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"absoluteUrl.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/absoluteUrl.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var baseURI;
module.link("../lib/baseURI", {
  baseURI: function (v) {
    baseURI = v;
  }
}, 1);
Meteor.absoluteUrl.defaultOptions.rootUrl = baseURI;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"appRoot.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/appRoot.tsx                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var React;
module.link("react", {
  "default": function (v) {
    React = v;
  }
}, 1);
var render;
module.link("react-dom", {
  render: function (v) {
    render = v;
  }
}, 2);
var AppRoot;
module.link("../views/root/AppRoot", {
  "default": function (v) {
    AppRoot = v;
  }
}, 3);

var createContainer = function () {
  var container = document.getElementById('react-root');

  if (!container) {
    throw new Error('could not find the element #react-root on DOM tree');
  }

  document.body.insertBefore(container, document.body.firstChild);
  return container;
};

Meteor.startup(function () {
  var container = createContainer();
  render( /*#__PURE__*/React.createElement(AppRoot, null), container);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"banners.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/banners.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 1);

var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 2);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var Notifications;
module.link("../../app/notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 2);
var APIClient;
module.link("../../app/utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 3);
var BannerPlatform;
module.link("../../definition/IBanner", {
  BannerPlatform: function (v) {
    BannerPlatform = v;
  }
}, 4);
var banners;
module.link("../lib/banners", {
  "*": function (v) {
    banners = v;
  }
}, 5);

var fetchInitialBanners = function () {
  function _callee() {
    var response, _iterator, _step, banner;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return _regeneratorRuntime.awrap(APIClient.get('v1/banners', {
                platform: BannerPlatform.Web
              }));

            case 2:
              response = _context.sent;

              for (_iterator = _createForOfIteratorHelperLoose(response.banners); !(_step = _iterator()).done;) {
                banner = _step.value;
                banners.open(_objectSpread(_objectSpread({}, banner.view), {}, {
                  viewId: banner.view.viewId || banner._id
                }));
              }

            case 4:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}();

var handleBanner = function () {
  function _callee2(event) {
    var response, _iterator2, _step2, banner;

    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              _context2.next = 2;
              return _regeneratorRuntime.awrap(APIClient.get("v1/banners/" + event.bannerId, {
                platform: BannerPlatform.Web
              }));

            case 2:
              response = _context2.sent;

              if (response.banners.length) {
                _context2.next = 5;
                break;
              }

              return _context2.abrupt("return", banners.closeById(event.bannerId));

            case 5:
              for (_iterator2 = _createForOfIteratorHelperLoose(response.banners); !(_step2 = _iterator2()).done;) {
                banner = _step2.value;
                banners.open(_objectSpread(_objectSpread({}, banner.view), {}, {
                  viewId: banner.view.viewId || banner._id
                }));
              }

            case 6:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}();

var watchBanners = function () {
  fetchInitialBanners();
  Notifications.onLogged('banner-changed', handleBanner);
  return function () {
    Notifications.unLogged(handleBanner);
    banners.clear();
  };
};

Meteor.startup(function () {
  var unwatchBanners;
  Tracker.autorun(function () {
    var _unwatchBanners;

    (_unwatchBanners = unwatchBanners) === null || _unwatchBanners === void 0 ? void 0 : _unwatchBanners();

    if (!Meteor.userId()) {
      return;
    }

    unwatchBanners = Tracker.nonreactive(watchBanners);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"callbacks.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/callbacks.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var performance;
module.link("universal-perf-hooks", {
  performance: function (v) {
    performance = v;
  }
}, 0);
var callbacks;
module.link("../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 1);
var getConfig;
module.link("../lib/utils/getConfig", {
  getConfig: function (v) {
    getConfig = v;
  }
}, 2);

if ([getConfig('debug'), getConfig('timed-callbacks')].includes('true')) {
  callbacks.setMetricsTrackers({
    trackCallback: function (_ref) {
      var hook = _ref.hook,
          id = _ref.id,
          stack = _ref.stack;
      var start = performance.now();
      return function () {
        var _stack$split, _stack$split$, _stack$split$$match;

        var end = performance.now();
        console.log(String(end - start), hook, id, stack === null || stack === void 0 ? void 0 : (_stack$split = stack.split('\n')) === null || _stack$split === void 0 ? void 0 : (_stack$split$ = _stack$split[2]) === null || _stack$split$ === void 0 ? void 0 : (_stack$split$$match = _stack$split$.match(/\(.+\)/)) === null || _stack$split$$match === void 0 ? void 0 : _stack$split$$match[0]);
      };
    },
    trackHook: function (_ref2) {
      var hook = _ref2.hook;
      var start = performance.now();
      return function () {
        var end = performance.now();
        console.log(hook + ":", end - start);
      };
    }
  });
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"customOAuth.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/customOAuth.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ServiceConfiguration;
module.link("meteor/service-configuration", {
  ServiceConfiguration: function (v) {
    ServiceConfiguration = v;
  }
}, 1);
var CustomOAuth;
module.link("../../app/custom-oauth/client/custom_oauth_client", {
  CustomOAuth: function (v) {
    CustomOAuth = v;
  }
}, 2);
var isOauthCustomConfiguration;
module.link("../../definition/rest/v1/settings", {
  isOauthCustomConfiguration: function (v) {
    isOauthCustomConfiguration = v;
  }
}, 3);
Meteor.startup(function () {
  ServiceConfiguration.configurations.find({
    custom: true
  }).observe({
    added: function (record) {
      if (!isOauthCustomConfiguration(record)) {
        return;
      }

      new CustomOAuth(record.service, {
        serverURL: record.serverURL,
        authorizePath: record.authorizePath,
        scope: record.scope
      });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"customTranslations.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/customTranslations.ts                                                                                //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 1);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var applyCustomTranslations;
module.link("../lib/utils/applyCustomTranslations", {
  applyCustomTranslations: function (v) {
    applyCustomTranslations = v;
  }
}, 4);
Meteor.startup(function () {
  Tracker.autorun(function () {
    // Re apply translations if tap language was changed
    Session.get(TAPi18n._loaded_lang_session_key);
    applyCustomTranslations();
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"e2e.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/e2e.ts                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var e2e;
module.link("../../app/e2e/client/rocketchat.e2e", {
  e2e: function (v) {
    e2e = v;
  }
}, 3);
var Subscriptions, Rooms;
module.link("../../app/models/client", {
  Subscriptions: function (v) {
    Subscriptions = v;
  },
  Rooms: function (v) {
    Rooms = v;
  }
}, 4);
var Notifications;
module.link("../../app/notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 5);
var settings;
module.link("../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 6);
var onClientBeforeSendMessage;
module.link("../lib/onClientBeforeSendMessage", {
  onClientBeforeSendMessage: function (v) {
    onClientBeforeSendMessage = v;
  }
}, 7);
var onClientMessageReceived;
module.link("../lib/onClientMessageReceived", {
  onClientMessageReceived: function (v) {
    onClientMessageReceived = v;
  }
}, 8);
var isLayoutEmbedded;
module.link("../lib/utils/isLayoutEmbedded", {
  isLayoutEmbedded: function (v) {
    isLayoutEmbedded = v;
  }
}, 9);
var waitUntilFind;
module.link("../lib/utils/waitUntilFind", {
  waitUntilFind: function (v) {
    waitUntilFind = v;
  }
}, 10);

var handle = function () {
  function _callee(roomId, keyId) {
    var e2eRoom;
    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return _regeneratorRuntime.awrap(e2e.getInstanceByRoomId(roomId));

            case 2:
              e2eRoom = _context.sent;

              if (e2eRoom) {
                _context.next = 5;
                break;
              }

              return _context.abrupt("return");

            case 5:
              e2eRoom.provideKeyToUser(keyId);

            case 6:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}();

Meteor.startup(function () {
  Tracker.autorun(function () {
    if (!Meteor.userId()) {
      return;
    }

    var adminEmbedded = isLayoutEmbedded() && FlowRouter.current().path.startsWith('/admin');

    if (!adminEmbedded && settings.get('E2E_Enable') && window.crypto) {
      e2e.startClient();
      e2e.enabled.set(true);
    } else {
      e2e.enabled.set(false);
      e2e.closeAlert();
    }
  });
  var observable = null;
  var offClientMessageReceived;
  var offClientBeforeSendMessage;
  Tracker.autorun(function () {
    if (!e2e.isReady()) {
      var _offClientMessageRece, _observable, _offClientBeforeSendM;

      (_offClientMessageRece = offClientMessageReceived) === null || _offClientMessageRece === void 0 ? void 0 : _offClientMessageRece();
      Notifications.unUser('e2ekeyRequest', handle);
      (_observable = observable) === null || _observable === void 0 ? void 0 : _observable.stop();
      (_offClientBeforeSendM = offClientBeforeSendMessage) === null || _offClientBeforeSendM === void 0 ? void 0 : _offClientBeforeSendM();
      return;
    }

    Notifications.onUser('e2ekeyRequest', handle);
    observable = Subscriptions.find().observe({
      changed: function () {
        function _callee2(doc) {
          var e2eRoom;
          return _regeneratorRuntime.async(function () {
            function _callee2$(_context2) {
              while (1) {
                switch (_context2.prev = _context2.next) {
                  case 0:
                    if (!(!doc.encrypted && !doc.E2EKey)) {
                      _context2.next = 3;
                      break;
                    }

                    e2e.removeInstanceByRoomId(doc.rid);
                    return _context2.abrupt("return");

                  case 3:
                    _context2.next = 5;
                    return _regeneratorRuntime.awrap(e2e.getInstanceByRoomId(doc.rid));

                  case 5:
                    e2eRoom = _context2.sent;

                    if (e2eRoom) {
                      _context2.next = 8;
                      break;
                    }

                    return _context2.abrupt("return");

                  case 8:
                    doc.encrypted ? e2eRoom.resume() : e2eRoom.pause(); // Cover private groups and direct messages

                    if (e2eRoom.isSupportedRoomType(doc.t)) {
                      _context2.next = 12;
                      break;
                    }

                    e2eRoom.disable();
                    return _context2.abrupt("return");

                  case 12:
                    if (!(doc.E2EKey && e2eRoom.isWaitingKeys())) {
                      _context2.next = 15;
                      break;
                    }

                    e2eRoom.keyReceived();
                    return _context2.abrupt("return");

                  case 15:
                    if (e2eRoom.isReady()) {
                      _context2.next = 17;
                      break;
                    }

                    return _context2.abrupt("return");

                  case 17:
                    e2eRoom.decryptSubscription();

                  case 18:
                  case "end":
                    return _context2.stop();
                }
              }
            }

            return _callee2$;
          }(), null, null, null, Promise);
        }

        return _callee2;
      }(),
      added: function () {
        function _callee3(doc) {
          return _regeneratorRuntime.async(function () {
            function _callee3$(_context3) {
              while (1) {
                switch (_context3.prev = _context3.next) {
                  case 0:
                    if (!(!doc.encrypted && !doc.E2EKey)) {
                      _context3.next = 2;
                      break;
                    }

                    return _context3.abrupt("return");

                  case 2:
                    return _context3.abrupt("return", e2e.getInstanceByRoomId(doc.rid));

                  case 3:
                  case "end":
                    return _context3.stop();
                }
              }
            }

            return _callee3$;
          }(), null, null, null, Promise);
        }

        return _callee3;
      }(),
      removed: function (doc) {
        e2e.removeInstanceByRoomId(doc.rid);
      }
    });
    offClientMessageReceived = onClientMessageReceived.use(function () {
      function _callee4(msg) {
        var e2eRoom;
        return _regeneratorRuntime.async(function () {
          function _callee4$(_context4) {
            while (1) {
              switch (_context4.prev = _context4.next) {
                case 0:
                  _context4.next = 2;
                  return _regeneratorRuntime.awrap(e2e.getInstanceByRoomId(msg.rid));

                case 2:
                  e2eRoom = _context4.sent;

                  if (!(!e2eRoom || !e2eRoom.shouldConvertReceivedMessages())) {
                    _context4.next = 5;
                    break;
                  }

                  return _context4.abrupt("return", msg);

                case 5:
                  return _context4.abrupt("return", e2e.decryptMessage(msg));

                case 6:
                case "end":
                  return _context4.stop();
              }
            }
          }

          return _callee4$;
        }(), null, null, null, Promise);
      }

      return _callee4;
    }()); // Encrypt messages before sending

    offClientBeforeSendMessage = onClientBeforeSendMessage.use(function () {
      function _callee5(message) {
        var e2eRoom, subscription, msg;
        return _regeneratorRuntime.async(function () {
          function _callee5$(_context5) {
            while (1) {
              switch (_context5.prev = _context5.next) {
                case 0:
                  _context5.next = 2;
                  return _regeneratorRuntime.awrap(e2e.getInstanceByRoomId(message.rid));

                case 2:
                  e2eRoom = _context5.sent;

                  if (e2eRoom) {
                    _context5.next = 5;
                    break;
                  }

                  return _context5.abrupt("return", message);

                case 5:
                  _context5.next = 7;
                  return _regeneratorRuntime.awrap(waitUntilFind(function () {
                    return Rooms.findOne({
                      _id: message.rid
                    });
                  }));

                case 7:
                  subscription = _context5.sent;
                  subscription.encrypted ? e2eRoom.resume() : e2eRoom.pause();
                  _context5.next = 11;
                  return _regeneratorRuntime.awrap(e2eRoom.shouldConvertSentMessages());

                case 11:
                  if (_context5.sent) {
                    _context5.next = 13;
                    break;
                  }

                  return _context5.abrupt("return", message);

                case 13:
                  _context5.next = 15;
                  return _regeneratorRuntime.awrap(e2eRoom.encrypt(message));

                case 15:
                  msg = _context5.sent;
                  message.msg = msg;
                  message.t = 'e2e';
                  message.e2e = 'pending';
                  return _context5.abrupt("return", message);

                case 20:
                case "end":
                  return _context5.stop();
              }
            }
          }

          return _callee5$;
        }(), null, null, null, Promise);
      }

      return _callee5;
    }());
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emailVerification.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/emailVerification.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 1);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var settings;
module.link("../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var dispatchToastMessage;
module.link("../lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 5);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var _user$emails;

    var user = Meteor.user();

    if (user !== null && user !== void 0 && (_user$emails = user.emails) !== null && _user$emails !== void 0 && _user$emails[0] && user.emails[0].verified !== true && settings.get('Accounts_EmailVerification') === true && !Session.get('Accounts_EmailVerification_Warning')) {
      dispatchToastMessage({
        type: 'warning',
        message: TAPi18n.__('You_have_not_verified_your_email')
      });
      Session.set('Accounts_EmailVerification_Warning', true);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"i18n.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/i18n.ts                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ReactiveVar;
module.link("meteor/reactive-var", {
  ReactiveVar: function (v) {
    ReactiveVar = v;
  }
}, 1);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 2);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 3);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 4);
var Users;
module.link("../../app/models/client", {
  Users: function (v) {
    Users = v;
  }
}, 5);
var settings;
module.link("../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 6);
var isRtl;
module.link("../../app/utils/client", {
  isRtl: function (v) {
    isRtl = v;
  }
}, 7);
var filterLanguage;
module.link("../lib/utils/filterLanguage", {
  filterLanguage: function (v) {
    filterLanguage = v;
  }
}, 8);
var currentLanguage = new ReactiveVar(null);
Meteor.startup(function () {
  // eslint-disable-next-line @typescript-eslint/camelcase
  TAPi18n.conf.i18n_files_route = Meteor._relativeToSiteRootUrl('/tap-i18n');
  currentLanguage.set(Meteor._localStorage.getItem('userLanguage'));
  var availableLanguages = TAPi18n.getLanguages();

  var getBrowserLanguage = function () {
    var _window$navigator$use;

    return filterLanguage((_window$navigator$use = window.navigator.userLanguage) !== null && _window$navigator$use !== void 0 ? _window$navigator$use : window.navigator.language);
  };

  var loadMomentLocale = function (language) {
    return new Promise(function (resolve, reject) {
      if (moment.locales().includes(language.toLowerCase())) {
        resolve(language);
        return;
      }

      Meteor.call('loadLocale', language, function (error, localeSrc) {
        if (error) {
          reject(error);
          return;
        }

        Function(localeSrc).call({
          moment: moment
        });
        resolve(language);
      });
    });
  };

  var applyLanguage = function () {
    var language = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'en';
    language = filterLanguage(language);

    if (!availableLanguages[language]) {
      language = language.split('-').shift();
    }

    if (!language) {
      return;
    }

    document.documentElement.classList[isRtl(language) ? 'add' : 'remove']('rtl');
    document.documentElement.setAttribute('dir', isRtl(language) ? 'rtl' : 'ltr');
    document.documentElement.lang = language;
    TAPi18n.setLanguage(language);
    loadMomentLocale(language).then(function (locale) {
      return moment.locale(locale);
    }).catch(function (error) {
      moment.locale('en');
      console.error('Error loading moment locale:', error);
    });
  };

  var setLanguage = function (language) {
    var lang = filterLanguage(language);
    currentLanguage.set(lang);

    Meteor._localStorage.setItem('userLanguage', lang);
  };

  window.setLanguage = setLanguage;

  var defaultUserLanguage = function () {
    return settings.get('Language') || getBrowserLanguage() || 'en';
  };

  window.defaultUserLanguage = defaultUserLanguage;
  Tracker.autorun(function () {
    var user = Users.findOne(Meteor.userId(), {
      fields: {
        language: 1
      }
    });
    setLanguage((user === null || user === void 0 ? void 0 : user.language) || defaultUserLanguage());
  });
  Tracker.autorun(function () {
    var language = currentLanguage.get();

    if (language) {
      applyLanguage(language);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/index.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./absoluteUrl");
module.link("./afterLogoutCleanUp");
module.link("./appRoot");
module.link("./banners");
module.link("./callbacks");
module.link("./contextualBar");
module.link("./customOAuth");
module.link("./customTranslations");
module.link("./e2e");
module.link("./emailVerification");
module.link("./i18n");
module.link("./ldap");
module.link("./loginViaQuery");
module.link("./messageTypes");
module.link("./notifications");
module.link("./oauth");
module.link("./readReceipt");
module.link("./renderMessage");
module.link("./renderNotification");
module.link("./roomObserve");
module.link("./rootUrlChange");
module.link("./routes");
module.link("./setupWizard");
module.link("./slashCommands");
module.link("./startup");
module.link("./streamMessage");
module.link("./theme");
module.link("./unread");
module.link("./UserDeleted");
module.link("./userRoles");
module.link("./userSetUtcOffset");
module.link("./usersObserve");
module.link("./userStatusManuallySet");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ldap.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/ldap.ts                                                                                              //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);

Meteor.loginWithLDAP = function (username, password, callback) {
  Accounts.callLoginMethod({
    methodArguments: [{
      ldap: true,
      username: username,
      ldapPass: password,
      ldapOptions: {}
    }],
    userCallback: callback
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"loginViaQuery.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/loginViaQuery.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
Meteor.startup(function () {
  Tracker.afterFlush(function () {
    var resumeToken = FlowRouter.getQueryParam('resumeToken');

    if (!resumeToken) {
      return;
    }

    Meteor.loginWithToken(resumeToken, function () {
      if (FlowRouter.getRouteName()) {
        FlowRouter.setQueryParams({
          resumeToken: null,
          userId: null
        });
        return;
      }

      FlowRouter.go('/home');
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"messageTypes.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/messageTypes.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var escapeHTML;
module.link("@rocket.chat/string-helpers", {
  escapeHTML: function (v) {
    escapeHTML = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var MessageTypes;
module.link("../../app/ui-utils/client", {
  MessageTypes: function (v) {
    MessageTypes = v;
  }
}, 2);
var t;
module.link("../../app/utils/client", {
  t: function (v) {
    t = v;
  }
}, 3);
Meteor.startup(function () {
  MessageTypes.registerType({
    id: 'room_changed_privacy',
    system: true,
    message: 'room_changed_privacy',
    data: function (message) {
      return {
        // eslint-disable-next-line @typescript-eslint/camelcase
        user_by: message.u && message.u.username,
        // eslint-disable-next-line @typescript-eslint/camelcase
        room_type: t(message.msg)
      };
    }
  });
  MessageTypes.registerType({
    id: 'room_changed_topic',
    system: true,
    message: 'room_changed_topic',
    data: function (message) {
      return {
        // eslint-disable-next-line @typescript-eslint/camelcase
        user_by: message.u && message.u.username,
        // eslint-disable-next-line @typescript-eslint/camelcase
        room_topic: escapeHTML(message.msg || "(" + t('None').toLowerCase() + ")")
      };
    }
  });
  MessageTypes.registerType({
    id: 'room_changed_avatar',
    system: true,
    message: 'room_changed_avatar',
    data: function (message) {
      return {
        // eslint-disable-next-line @typescript-eslint/camelcase
        user_by: message.u && message.u.username
      };
    }
  });
  MessageTypes.registerType({
    id: 'room_changed_announcement',
    system: true,
    message: 'room_changed_announcement',
    data: function (message) {
      return {
        // eslint-disable-next-line @typescript-eslint/camelcase
        user_by: message.u && message.u.username,
        // eslint-disable-next-line @typescript-eslint/camelcase
        room_announcement: escapeHTML(message.msg || "(" + t('None').toLowerCase() + ")")
      };
    }
  });
  MessageTypes.registerType({
    id: 'room_changed_description',
    system: true,
    message: 'room_changed_description',
    data: function (message) {
      return {
        // eslint-disable-next-line @typescript-eslint/camelcase
        user_by: message.u && message.u.username,
        // eslint-disable-next-line @typescript-eslint/camelcase
        room_description: escapeHTML(message.msg || "(" + t('None').toLowerCase() + ")")
      };
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"oauth.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/oauth.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var OAuth;
module.link("meteor/oauth", {
  OAuth: function (v) {
    OAuth = v;
  }
}, 1);
// OAuth._retrieveCredentialSecret is a meteor method modified to also check the global localStorage
// This was necessary because of the "Forget User Session on Window Close" setting.
// The setting changes Meteor._localStorage to use the browser's session storage instead, but that doesn't happen on the Oauth's popup code.
Meteor.startup(function () {
  var meteorOAuthRetrieveCredentialSecret = OAuth._retrieveCredentialSecret;

  OAuth._retrieveCredentialSecret = function (credentialToken) {
    var secret = meteorOAuthRetrieveCredentialSecret.call(OAuth, credentialToken);

    if (!secret) {
      var localStorageKey = "" + OAuth._storageTokenPrefix + credentialToken;
      secret = localStorage.getItem(localStorageKey);
      localStorage.removeItem(localStorageKey);
    }

    return secret;
  };
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"readReceipt.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/readReceipt.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var settings;
module.link("../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 2);
var MessageAction, messageArgs;
module.link("../../app/ui-utils/client", {
  MessageAction: function (v) {
    MessageAction = v;
  },
  messageArgs: function (v) {
    messageArgs = v;
  }
}, 3);
var imperativeModal;
module.link("../lib/imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 4);
var ReadReceiptsModal;
module.link("../views/room/modals/ReadReceiptsModal", {
  "default": function (v) {
    ReadReceiptsModal = v;
  }
}, 5);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var enabled = settings.get('Message_Read_Receipt_Store_Users');

    if (!enabled) {
      return MessageAction.removeButton('receipt-detail');
    }

    MessageAction.addButton({
      id: 'receipt-detail',
      icon: 'info-circled',
      label: 'Info',
      context: ['starred', 'message', 'message-mobile', 'threads'],
      action: function () {
        var _messageArgs = messageArgs(this),
            message = _messageArgs.msg;

        imperativeModal.open({
          component: ReadReceiptsModal,
          props: {
            messageId: message._id,
            onClose: imperativeModal.close
          }
        });
      },
      order: 10,
      group: 'menu'
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"roomObserve.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/roomObserve.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var ChatRoom;
module.link("../../app/models/client", {
  ChatRoom: function (v) {
    ChatRoom = v;
  }
}, 2);
Meteor.startup(function () {
  ChatRoom.find().observe({
    added: function (data) {
      Session.set("roomData" + data._id, data);
    },
    changed: function (data) {
      Session.set("roomData" + data._id, data);
    },
    removed: function (data) {
      Session.set("roomData" + data._id, undefined);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"rootUrlChange.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/rootUrlChange.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var hasRole;
module.link("../../app/authorization/client", {
  hasRole: function (v) {
    hasRole = v;
  }
}, 2);
var Roles;
module.link("../../app/models/client", {
  Roles: function (v) {
    Roles = v;
  }
}, 3);
var settings;
module.link("../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 4);
var t;
module.link("../../app/utils/client", {
  t: function (v) {
    t = v;
  }
}, 5);
var UrlChangeModal;
module.link("../components/UrlChangeModal", {
  "default": function (v) {
    UrlChangeModal = v;
  }
}, 6);
var imperativeModal;
module.link("../lib/imperativeModal", {
  imperativeModal: function (v) {
    imperativeModal = v;
  }
}, 7);
var dispatchToastMessage;
module.link("../lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 8);
var isSyncReady;
module.link("../lib/userData", {
  isSyncReady: function (v) {
    isSyncReady = v;
  }
}, 9);
Meteor.startup(function () {
  Tracker.autorun(function (c) {
    if (!Meteor.userId()) {
      return;
    }

    if (!Roles.ready.get() || !isSyncReady.get()) {
      return;
    }

    if (hasRole(Meteor.userId(), 'admin') === false) {
      return c.stop();
    }

    var siteUrl = settings.get('Site_Url');

    if (!siteUrl) {
      return;
    }

    var currentUrl = location.origin + window.__meteor_runtime_config__.ROOT_URL_PATH_PREFIX;

    if (window.__meteor_runtime_config__.ROOT_URL.replace(/\/$/, '') !== currentUrl) {
      var confirm = function () {
        imperativeModal.close();
        Meteor.call('saveSetting', 'Site_Url', currentUrl, function () {
          dispatchToastMessage({
            type: 'success',
            message: t('Saved')
          });
        });
      };

      imperativeModal.open({
        component: UrlChangeModal,
        props: {
          onConfirm: confirm,
          siteUrl: siteUrl,
          currentUrl: currentUrl,
          onClose: imperativeModal.close
        }
      });
    }

    var documentDomain = settings.get('Document_Domain');

    if (documentDomain) {
      window.document.domain = documentDomain;
    }

    return c.stop();
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"routes.tsx":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/routes.tsx                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 0);
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 2);
var TAPi18n;
module.link("meteor/rocketchat:tap-i18n", {
  TAPi18n: function (v) {
    TAPi18n = v;
  }
}, 3);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 4);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 5);
var React, lazy;
module.link("react", {
  "default": function (v) {
    React = v;
  },
  lazy: function (v) {
    lazy = v;
  }
}, 6);
var toastr;
module.link("toastr", {
  "default": function (v) {
    toastr = v;
  }
}, 7);
var KonchatNotification;
module.link("../../app/ui/client", {
  KonchatNotification: function (v) {
    KonchatNotification = v;
  }
}, 8);
var APIClient;
module.link("../../app/utils/client", {
  APIClient: function (v) {
    APIClient = v;
  }
}, 9);
var appLayout;
module.link("../lib/appLayout", {
  appLayout: function (v) {
    appLayout = v;
  }
}, 10);
var createTemplateForComponent;
module.link("../lib/portals/createTemplateForComponent", {
  createTemplateForComponent: function (v) {
    createTemplateForComponent = v;
  }
}, 11);
var dispatchToastMessage;
module.link("../lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 12);
var handleError;
module.link("../lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 13);
var InvitePage = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../views/invite/InvitePage');
});
var SecretURLPage = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../views/invite/SecretURLPage');
});
var CMSPage = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../views/root/CMSPage');
});
var ResetPasswordPage = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../views/login/ResetPassword/ResetPassword');
});
var SetupWizardRoute = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../views/setupWizard/SetupWizardRoute');
});
var MailerUnsubscriptionPage = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../views/mailer/MailerUnsubscriptionPage');
});
var NotFoundPage = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../views/notFound/NotFoundPage');
});
var MeetPage = /*#__PURE__*/lazy(function () {
  return module.dynamicImport('../views/meet/MeetPage');
});
FlowRouter.wait();
FlowRouter.route('/', {
  name: 'index',
  action: function () {
    appLayout.renderMainLayout({
      center: 'loading'
    });

    if (!Meteor.userId()) {
      return FlowRouter.go('home');
    }

    Tracker.autorun(function (c) {
      if (FlowRouter.subsReady() === true) {
        Meteor.defer(function () {
          var user = Meteor.user();

          if (user !== null && user !== void 0 && user.defaultRoom) {
            var room = user.defaultRoom.split('/');
            FlowRouter.go(room[0], {
              name: room[1]
            }, FlowRouter.current().queryParams);
          } else {
            FlowRouter.go('home');
          }
        });
        c.stop();
      }
    });
  }
});
FlowRouter.route('/login', {
  name: 'login',
  action: function () {
    FlowRouter.go('home');
  }
});
FlowRouter.route('/meet/:rid', {
  name: 'meet',
  action: function () {
    function _callee(_params, queryParams) {
      var visitor;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (!((queryParams === null || queryParams === void 0 ? void 0 : queryParams.token) !== undefined)) {
                  _context.next = 9;
                  break;
                }

                _context.next = 3;
                return _regeneratorRuntime.awrap(APIClient.v1.get("livechat/visitor/" + (queryParams === null || queryParams === void 0 ? void 0 : queryParams.token)));

              case 3:
                visitor = _context.sent;

                if (!(visitor !== null && visitor !== void 0 && visitor.visitor)) {
                  _context.next = 7;
                  break;
                }

                appLayout.render( /*#__PURE__*/React.createElement(MeetPage, null));
                return _context.abrupt("return");

              case 7:
                toastr.error(TAPi18n.__('Visitor_does_not_exist'));
                return _context.abrupt("return");

              case 9:
                if (Meteor.userId()) {
                  _context.next = 12;
                  break;
                }

                FlowRouter.go('home');
                return _context.abrupt("return");

              case 12:
                appLayout.render( /*#__PURE__*/React.createElement(MeetPage, null));

              case 13:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }()
});
FlowRouter.route('/home', {
  name: 'home',
  action: function (_params, queryParams) {
    KonchatNotification.getDesktopPermission();

    if ((queryParams === null || queryParams === void 0 ? void 0 : queryParams.saml_idp_credentialToken) !== undefined) {
      var token = queryParams.saml_idp_credentialToken;
      FlowRouter.setQueryParams({
        // eslint-disable-next-line @typescript-eslint/camelcase
        saml_idp_credentialToken: null
      });
      Meteor.loginWithSamlToken(token, function (error) {
        if (error) {
          if (error.reason) {
            dispatchToastMessage({
              type: 'error',
              message: error.reason
            });
          } else {
            handleError(error);
          }
        }

        appLayout.renderMainLayout({
          center: 'home'
        });
      });
      return;
    }

    appLayout.renderMainLayout({
      center: 'home'
    });
  }
});
FlowRouter.route('/directory/:tab?', {
  name: 'directory',
  action: function () {
    var DirectoryPage = createTemplateForComponent('DirectoryPage', function () {
      return module.dynamicImport('../views/directory/DirectoryPage');
    }, {
      attachment: 'at-parent'
    });
    appLayout.renderMainLayout({
      center: DirectoryPage
    });
  }
});
FlowRouter.route('/omnichannel-directory/:page?/:bar?/:id?/:tab?/:context?', {
  name: 'omnichannel-directory',
  action: function () {
    var OmnichannelDirectoryPage = createTemplateForComponent('OmnichannelDirectoryPage', function () {
      return module.dynamicImport('../views/omnichannel/directory/OmnichannelDirectoryPage');
    }, {
      attachment: 'at-parent'
    });
    appLayout.renderMainLayout({
      center: OmnichannelDirectoryPage
    });
  }
});
FlowRouter.route('/livechat-queue', {
  name: 'livechat-queue',
  action: function () {
    var OmnichannelQueueList = createTemplateForComponent('QueueList', function () {
      return module.dynamicImport('../views/omnichannel/queueList');
    }, {
      attachment: 'at-parent'
    });
    appLayout.renderMainLayout({
      center: OmnichannelQueueList
    });
  }
});
FlowRouter.route('/account/:group?', {
  name: 'account',
  action: function () {
    var AccountRoute = createTemplateForComponent('AccountRoute', function () {
      return module.dynamicImport('../views/account/AccountRoute');
    }, {
      attachment: 'at-parent'
    });
    appLayout.renderMainLayout({
      center: AccountRoute
    });
  }
});
FlowRouter.route('/terms-of-service', {
  name: 'terms-of-service',
  action: function () {
    appLayout.render( /*#__PURE__*/React.createElement(CMSPage, {
      page: "Layout_Terms_of_Service"
    }));
  }
});
FlowRouter.route('/privacy-policy', {
  name: 'privacy-policy',
  action: function () {
    appLayout.render( /*#__PURE__*/React.createElement(CMSPage, {
      page: "Layout_Privacy_Policy"
    }));
  }
});
FlowRouter.route('/legal-notice', {
  name: 'legal-notice',
  action: function () {
    appLayout.render( /*#__PURE__*/React.createElement(CMSPage, {
      page: "Layout_Legal_Notice"
    }));
  }
});
FlowRouter.route('/room-not-found/:type/:name', {
  name: 'room-not-found',
  action: function () {
    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
        type = _ref.type,
        name = _ref.name;

    Session.set('roomNotFound', {
      type: type,
      name: name
    });
    appLayout.renderMainLayout({
      center: 'roomNotFound'
    });
  }
});
FlowRouter.route('/register/:hash', {
  name: 'register-secret-url',
  action: function () {
    appLayout.render( /*#__PURE__*/React.createElement(SecretURLPage, null));
  }
});
FlowRouter.route('/invite/:hash', {
  name: 'invite',
  action: function () {
    appLayout.render( /*#__PURE__*/React.createElement(InvitePage, null));
  }
});
FlowRouter.route('/setup-wizard/:step?', {
  name: 'setup-wizard',
  action: function () {
    appLayout.render( /*#__PURE__*/React.createElement(SetupWizardRoute, null));
  }
});
FlowRouter.route('/mailer/unsubscribe/:_id/:createdAt', {
  name: 'mailer-unsubscribe',
  action: function () {
    appLayout.render( /*#__PURE__*/React.createElement(MailerUnsubscriptionPage, null));
  }
});
FlowRouter.route('/login-token/:token', {
  name: 'tokenLogin',
  action: function (params) {
    Accounts.callLoginMethod({
      methodArguments: [{
        loginToken: params === null || params === void 0 ? void 0 : params.token
      }],
      userCallback: function (error) {
        console.error(error);
        FlowRouter.go('/');
      }
    });
  }
});
FlowRouter.route('/reset-password/:token', {
  name: 'resetPassword',
  action: function () {
    appLayout.render( /*#__PURE__*/React.createElement(ResetPasswordPage, null));
  }
});
FlowRouter.route('/snippet/:snippetId/:snippetName', {
  name: 'snippetView',
  action: function () {
    appLayout.renderMainLayout({
      center: 'snippetPage'
    });
  }
});
FlowRouter.route('/oauth/authorize', {
  name: 'oauth/authorize',
  action: function (_params, queryParams) {
    appLayout.renderMainLayout({
      center: 'authorize',
      modal: true,
      // eslint-disable-next-line @typescript-eslint/camelcase
      client_id: queryParams === null || queryParams === void 0 ? void 0 : queryParams.client_id,
      // eslint-disable-next-line @typescript-eslint/camelcase
      redirect_uri: queryParams === null || queryParams === void 0 ? void 0 : queryParams.redirect_uri,
      // eslint-disable-next-line @typescript-eslint/camelcase
      response_type: queryParams === null || queryParams === void 0 ? void 0 : queryParams.response_type,
      state: queryParams === null || queryParams === void 0 ? void 0 : queryParams.state
    });
  }
});
FlowRouter.route('/oauth/error/:error', {
  name: 'oauth/error',
  action: function (params) {
    appLayout.renderMainLayout({
      center: 'oauth404',
      modal: true,
      error: params === null || params === void 0 ? void 0 : params.error
    });
  }
});
FlowRouter.notFound = {
  action: function () {
    appLayout.render( /*#__PURE__*/React.createElement(NotFoundPage, null));
  }
};
Meteor.startup(function () {
  FlowRouter.initialize();
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"setupWizard.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/setupWizard.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var FlowRouter;
module.link("meteor/kadira:flow-router", {
  FlowRouter: function (v) {
    FlowRouter = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var hasRole;
module.link("../../app/authorization/client", {
  hasRole: function (v) {
    hasRole = v;
  }
}, 3);
var settings;
module.link("../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 4);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var userId = Meteor.userId();
    var setupWizardState = settings.get('Show_Setup_Wizard');
    var mustRedirect = !userId && setupWizardState === 'pending' || !!userId && !!hasRole(userId, 'admin') && setupWizardState === 'in_progress';

    if (mustRedirect) {
      FlowRouter.go('setup-wizard');
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"slashCommands.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/slashCommands.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var slashCommands, APIClient;
module.link("../../app/utils/client", {
  slashCommands: function (v) {
    slashCommands = v;
  },
  APIClient: function (v) {
    APIClient = v;
  }
}, 2);
var oldUserId = null;
Tracker.autorun(function () {
  var newUserId = Meteor.userId();

  if (oldUserId === null && newUserId) {
    APIClient.v1.get('commands.list').then(function (result) {
      result.commands.forEach(function (command) {
        slashCommands.commands[command.command] = command;
      });
    });
  }

  oldUserId = Meteor.userId();
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"startup.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/startup.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var Accounts;
module.link("meteor/accounts-base", {
  Accounts: function (v) {
    Accounts = v;
  }
}, 0);
var UserPresence;
module.link("meteor/konecty:user-presence", {
  UserPresence: function (v) {
    UserPresence = v;
  }
}, 1);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 2);
var TimeSync;
module.link("meteor/mizzao:timesync", {
  TimeSync: function (v) {
    TimeSync = v;
  }
}, 3);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 4);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 5);
var toastr;
module.link("toastr", {
  "default": function (v) {
    toastr = v;
  }
}, 6);
var hasPermission;
module.link("../../app/authorization/client", {
  hasPermission: function (v) {
    hasPermission = v;
  }
}, 7);
var register;
module.link("../../app/markdown/lib/hljs", {
  register: function (v) {
    register = v;
  }
}, 8);
var settings;
module.link("../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 9);
var getUserPreference, t;
module.link("../../app/utils/client", {
  getUserPreference: function (v) {
    getUserPreference = v;
  },
  t: function (v) {
    t = v;
  }
}, 10);
module.link("highlight.js/styles/github.css");
var banners;
module.link("../lib/banners", {
  "*": function (v) {
    banners = v;
  }
}, 11);
var synchronizeUserData, removeLocalUserData;
module.link("../lib/userData", {
  synchronizeUserData: function (v) {
    synchronizeUserData = v;
  },
  removeLocalUserData: function (v) {
    removeLocalUserData = v;
  }
}, 12);
var fireGlobalEvent;
module.link("../lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 13);

if (window.DISABLE_ANIMATION) {
  toastr.options.timeOut = 1;
  toastr.options.showDuration = 0;
  toastr.options.hideDuration = 0;
  toastr.options.extendedTimeOut = 0;
}

Meteor.startup(function () {
  fireGlobalEvent('startup', true);
  Accounts.onLogout(function () {
    return Session.set('openedRoom', null);
  });
  TimeSync.loggingEnabled = false;
  Session.setDefault('AvatarRandom', 0);
  window.lastMessageWindow = {};
  window.lastMessageWindowHistory = {};
  var status = undefined;
  Tracker.autorun(function () {
    function _callee() {
      var uid, user, idleTimeLimit;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                uid = Meteor.userId();

                if (uid) {
                  _context.next = 4;
                  break;
                }

                removeLocalUserData();
                return _context.abrupt("return");

              case 4:
                if (Meteor.status().connected) {
                  _context.next = 6;
                  break;
                }

                return _context.abrupt("return");

              case 6:
                _context.next = 8;
                return _regeneratorRuntime.awrap(synchronizeUserData(uid));

              case 8:
                user = _context.sent;

                if (user) {
                  _context.next = 11;
                  break;
                }

                return _context.abrupt("return");

              case 11:
                if (getUserPreference(user, 'enableAutoAway')) {
                  idleTimeLimit = getUserPreference(user, 'idleTimeLimit') || 300;
                  UserPresence.awayTime = idleTimeLimit * 1000;
                } else {
                  delete UserPresence.awayTime;
                  UserPresence.stopTimer();
                }

                UserPresence.start();

                if (user.status !== status) {
                  status = user.status;
                  fireGlobalEvent('status-changed', status);
                }

              case 14:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, null, Promise);
    }

    return _callee;
  }());
  Tracker.autorun(function () {
    function _callee2(c) {
      var uid;
      return _regeneratorRuntime.async(function () {
        function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                uid = Meteor.userId();

                if (uid) {
                  _context2.next = 3;
                  break;
                }

                return _context2.abrupt("return");

              case 3:
                if (hasPermission('manage-cloud')) {
                  _context2.next = 5;
                  break;
                }

                return _context2.abrupt("return");

              case 5:
                Meteor.call('cloud:checkRegisterStatus', function (err, data) {
                  if (err) {
                    console.log(err);
                    return;
                  }

                  c.stop();
                  var _data$connectToCloud = data.connectToCloud,
                      connectToCloud = _data$connectToCloud === void 0 ? false : _data$connectToCloud,
                      _data$workspaceRegist = data.workspaceRegistered,
                      workspaceRegistered = _data$workspaceRegist === void 0 ? false : _data$workspaceRegist;

                  if (connectToCloud === true && workspaceRegistered !== true) {
                    banners.open({
                      id: 'cloud-registration',
                      title: t('Cloud_registration_pending_title'),
                      html: t('Cloud_registration_pending_html'),
                      modifiers: ['large', 'danger']
                    });
                  }
                });

              case 6:
              case "end":
                return _context2.stop();
            }
          }
        }

        return _callee2$;
      }(), null, null, null, Promise);
    }

    return _callee2;
  }());
});
Meteor.startup(function () {
  Tracker.autorun(function () {
    var code = settings.get('Message_Code_highlight');
    code === null || code === void 0 ? void 0 : code.split(',').forEach(function (language) {
      language.trim() && register(language.trim());
    });
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"theme.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/theme.ts                                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 1);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 2);
var createLess;
module.link("less/browser", {
  "default": function (v) {
    createLess = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 1);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 2);
var settings;
module.link("../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 3);
var variables = new Map();
var lessExpressions = new Map([['default-action-color', 'darken(@secondary-background-color, 15%)'], ['default-action-contrast', 'contrast(@default-action-color, #444444)'], ['primary-background-contrast', 'contrast(@primary-background-color, #444444)'], ['primary-action-contrast', 'contrast(@primary-action-color, #444444)'], ['secondary-background-contrast', 'contrast(@secondary-background-color, #444444)'], ['secondary-action-contrast', 'contrast(@secondary-action-color, #444444)'], ['selection-background', 'lighten(@selection-color, 30%)'], ['success-background', 'lighten(@success-color, 45%)'], ['success-border', 'lighten(@success-color, 30%)'], ['error-background', 'lighten(@error-color, 45%)'], ['error-border', 'lighten(@error-color, 30%)'], ['error-contrast', 'contrast(@error-color)'], ['pending-background', 'lighten(@pending-color, 45%)'], ['pending-border', 'lighten(@pending-color, 30%)'], ['transparent-darkest', 'rgba(17, 12, 12, 0.5)'], ['transparent-darker', 'rgba(0, 0, 0, 0.15)'], ['transparent-dark', 'rgba(15, 34, 0, 0.05)'], ['transparent-light', 'rgba(255, 255, 255, 0.1)'], ['transparent-lighter', 'rgba(255, 255, 255, 0.3)'], ['transparent-lightest', 'rgba(255, 255, 255, 0.6)']]);
var less = createLess(window, {});

var compileLess = function () {
  function _callee() {
    var lessCode, _await$less$render, css;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              if (!(lessExpressions.size === 0)) {
                _context.next = 2;
                break;
              }

              return _context.abrupt("return", '');

            case 2:
              lessCode = [].concat(_toConsumableArray(Array.from(variables.entries(), function (_ref) {
                var _ref2 = _slicedToArray(_ref, 2),
                    name = _ref2[0],
                    value = _ref2[1];

                return "@" + name + ": " + value + ";";
              })), _toConsumableArray(Array.from(lessExpressions.entries(), function (_ref3) {
                var _ref4 = _slicedToArray(_ref3, 2),
                    name = _ref4[0],
                    expression = _ref4[1];

                return "@" + name + ": " + expression + ";";
              })), [':root {'], _toConsumableArray(Array.from(lessExpressions.entries(), function (_ref5) {
                var _ref6 = _slicedToArray(_ref5, 1),
                    name = _ref6[0];

                return "--" + name + ": @" + name + ";";
              })), ['}']).join('\n');
              _context.prev = 3;
              _context.next = 6;
              return _regeneratorRuntime.awrap(less.render(lessCode));

            case 6:
              _await$less$render = _context.sent;
              css = _await$less$render.css;
              return _context.abrupt("return", css);

            case 11:
              _context.prev = 11;
              _context.t0 = _context["catch"](3);
              console.error(_context.t0);
              return _context.abrupt("return", '');

            case 15:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, [[3, 11]], Promise);
  }

  return _callee;
}();

var cssVariablesElement = null;

var updateCssVariables = _.debounce(function () {
  function _callee2() {
    return _regeneratorRuntime.async(function () {
      function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              if (!cssVariablesElement) {
                cssVariablesElement = document.querySelector('#css-variables');
              }

              if (cssVariablesElement) {
                _context2.next = 3;
                break;
              }

              return _context2.abrupt("return");

            case 3:
              _context2.t0 = [':root {'];
              _context2.t1 = _toConsumableArray(Array.from(variables.entries(), function (_ref7) {
                var _ref8 = _slicedToArray(_ref7, 2),
                    name = _ref8[0],
                    value = _ref8[1];

                return "--" + name + ": " + value + ";";
              }));
              _context2.next = 7;
              return _regeneratorRuntime.awrap(compileLess());

            case 7:
              _context2.t2 = _context2.sent;
              _context2.t3 = ['}', _context2.t2];
              cssVariablesElement.innerHTML = _context2.t0.concat.call(_context2.t0, _context2.t1, _context2.t3).join('\n');

            case 10:
            case "end":
              return _context2.stop();
          }
        }
      }

      return _callee2$;
    }(), null, null, null, Promise);
  }

  return _callee2;
}(), 50);

var handleThemeColorChanged = function (_ref9) {
  var _id = _ref9._id,
      value = _ref9.value,
      editor = _ref9.editor;

  if (typeof value !== 'string') {
    return;
  }

  try {
    var _$exec;

    var name = (_$exec = /^theme-color-(.*)$/.exec(_id)) === null || _$exec === void 0 ? void 0 : _$exec[1];

    if (!name) {
      return;
    }

    var legacy = name.slice(0, 3) !== 'rc-';

    if (editor === 'color') {
      variables.set(name, value);
      return;
    }

    if (legacy) {
      lessExpressions.set(name, value);
      return;
    }

    variables.set(name, "var(--" + value + ")");
  } finally {
    updateCssVariables();
  }
};

var handleThemeFontChanged = function (_ref10) {
  var _id = _ref10._id,
      value = _ref10.value;

  try {
    var _$exec2;

    var name = (_$exec2 = /^theme-font-(.*)$/.exec(_id)) === null || _$exec2 === void 0 ? void 0 : _$exec2[1];

    if (!name) {
      return;
    }

    variables.set(name, value);
  } finally {
    updateCssVariables();
  }
};

Meteor.startup(function () {
  settings.collection.find({
    _id: /^theme-color-/i
  }, {
    fields: {
      value: 1,
      editor: 1
    }
  }).observe({
    added: handleThemeColorChanged,
    changed: handleThemeColorChanged
  });
  settings.collection.find({
    _id: /^theme-font-/i
  }, {
    fields: {
      value: 1
    }
  }).observe({
    added: handleThemeFontChanged,
    changed: handleThemeFontChanged
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"unread.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/unread.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var Favico;
module.link("../../app/favico/client", {
  Favico: function (v) {
    Favico = v;
  }
}, 3);
var ChatSubscription, ChatRoom;
module.link("../../app/models/client", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  },
  ChatRoom: function (v) {
    ChatRoom = v;
  }
}, 4);
var settings;
module.link("../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 5);
var menu;
module.link("../../app/ui-utils/client", {
  menu: function (v) {
    menu = v;
  }
}, 6);
var getUserPreference;
module.link("../../app/utils/client", {
  getUserPreference: function (v) {
    getUserPreference = v;
  }
}, 7);
var fireGlobalEvent;
module.link("../lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 8);

var fetchSubscriptions = function () {
  return ChatSubscription.find({
    open: true,
    hideUnreadStatus: {
      $ne: true
    },
    archived: {
      $ne: true
    }
  }, {
    fields: {
      unread: 1,
      alert: 1,
      rid: 1,
      t: 1,
      name: 1,
      ls: 1,
      unreadAlert: 1,
      fname: 1,
      prid: 1
    }
  }).fetch();
};

Meteor.startup(function () {
  Tracker.autorun(function () {
    var userUnreadAlert = getUserPreference(Meteor.userId(), 'unreadAlert');
    var unreadAlert = false;
    var unreadCount = fetchSubscriptions().reduce(function (ret, subscription) {
      return Tracker.nonreactive(function () {
        var room = ChatRoom.findOne({
          _id: subscription.rid
        }, {
          fields: {
            usersCount: 1
          }
        });
        fireGlobalEvent('unread-changed-by-subscription', _objectSpread(_objectSpread({}, subscription), {}, {
          usersCount: room === null || room === void 0 ? void 0 : room.usersCount
        }));

        if (subscription.alert || subscription.unread > 0) {
          // Increment the total unread count.
          if (subscription.alert === true && subscription.unreadAlert !== 'nothing') {
            if (subscription.unreadAlert === 'all' || userUnreadAlert !== false) {
              unreadAlert = '•';
            }
          }

          return ret + subscription.unread;
        }

        return ret;
      });
    }, 0);
    menu.updateUnreadBars();

    if (unreadCount > 0) {
      if (unreadCount > 999) {
        Session.set('unread', '999+');
      } else {
        Session.set('unread', unreadCount);
      }
    } else if (unreadAlert !== false) {
      Session.set('unread', unreadAlert);
    } else {
      Session.set('unread', '');
    }
  });
});
Meteor.startup(function () {
  var favicon = new Favico({
    position: 'up',
    animation: 'none'
  });
  window.favico = favicon;
  Tracker.autorun(function () {
    var _settings$get;

    var siteName = (_settings$get = settings.get('Site_Name')) !== null && _settings$get !== void 0 ? _settings$get : '';
    var unread = Session.get('unread');
    fireGlobalEvent('unread-changed', unread);

    if (favicon) {
      favicon.badge(unread, {
        bgColor: typeof unread !== 'number' ? '#3d8a3a' : '#ac1b1b'
      });
    }

    document.title = unread === '' ? siteName : "(" + unread + ") " + siteName;
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userRoles.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/userRoles.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 0);
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var UserRoles, RoomRoles, ChatMessage;
module.link("../../app/models/client", {
  UserRoles: function (v) {
    UserRoles = v;
  },
  RoomRoles: function (v) {
    RoomRoles = v;
  },
  ChatMessage: function (v) {
    ChatMessage = v;
  }
}, 2);
var Notifications;
module.link("../../app/notifications/client", {
  Notifications: function (v) {
    Notifications = v;
  }
}, 3);
var handleError;
module.link("../lib/utils/handleError", {
  handleError: function (v) {
    handleError = v;
  }
}, 4);
Meteor.startup(function () {
  Tracker.autorun(function () {
    if (Meteor.userId()) {
      Meteor.call('getUserRoles', function (error, results) {
        if (error) {
          return handleError(error);
        }

        for (var _iterator = _createForOfIteratorHelperLoose(results), _step; !(_step = _iterator()).done;) {
          var record = _step.value;
          UserRoles.upsert({
            _id: record._id
          }, record);
        }
      });
      Notifications.onLogged('roles-change', function (role) {
        if (role.type === 'added') {
          if (role.scope) {
            RoomRoles.upsert({
              'rid': role.scope,
              'u._id': role.u._id
            }, {
              $setOnInsert: {
                u: role.u
              },
              $addToSet: {
                roles: role._id
              }
            });
          } else {
            UserRoles.upsert({
              _id: role.u._id
            }, {
              $addToSet: {
                roles: role._id
              },
              $set: {
                username: role.u.username
              }
            });
            ChatMessage.update({
              'u._id': role.u._id
            }, {
              $addToSet: {
                roles: role._id
              }
            }, {
              multi: true
            });
          }

          return;
        }

        if (role.type === 'removed') {
          if (role.scope) {
            RoomRoles.update({
              'rid': role.scope,
              'u._id': role.u._id
            }, {
              $pull: {
                roles: role._id
              }
            });
          } else {
            UserRoles.update({
              _id: role.u._id
            }, {
              $pull: {
                roles: role._id
              }
            });
            ChatMessage.update({
              'u._id': role.u._id
            }, {
              $pull: {
                roles: role._id
              }
            }, {
              multi: true
            });
          }

          return;
        }

        if (role.type === 'changed') {
          ChatMessage.update({
            roles: role._id
          }, {
            $inc: {
              rerender: 1
            }
          }, {
            multi: true
          });
        }
      });
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userSetUtcOffset.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/userSetUtcOffset.ts                                                                                  //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 1);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 2);
var Users;
module.link("../../app/models/client", {
  Users: function (v) {
    Users = v;
  }
}, 3);
Meteor.startup(function () {
  Tracker.autorun(function () {
    var user = Users.findOne({
      _id: Meteor.userId()
    }, {
      fields: {
        statusConnection: 1,
        utcOffset: 1
      }
    });

    if (user && user.statusConnection === 'online') {
      var utcOffset = moment().utcOffset() / 60;

      if (user.utcOffset !== utcOffset) {
        Meteor.call('userSetUtcOffset', utcOffset);
      }
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userStatusManuallySet.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/userStatusManuallySet.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var callbacks;
module.link("../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 1);
var fireGlobalEvent;
module.link("../lib/utils/fireGlobalEvent", {
  fireGlobalEvent: function (v) {
    fireGlobalEvent = v;
  }
}, 2);

/* fire user state change globally, to listen on desktop electron client */
Meteor.startup(function () {
  callbacks.add('userStatusManuallySet', function (status) {
    fireGlobalEvent('user-status-manually-set', status);
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"usersObserve.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/startup/usersObserve.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var Session;
module.link("meteor/session", {
  Session: function (v) {
    Session = v;
  }
}, 1);
var RoomManager;
module.link("../../app/ui-utils/client", {
  RoomManager: function (v) {
    RoomManager = v;
  }
}, 2);
Meteor.startup(function () {
  Meteor.users.find({}, {
    fields: {
      name: 1,
      username: 1,
      status: 1,
      utcOffset: 1,
      statusText: 1
    }
  }).observe({
    added: function (user) {
      Session.set("user_" + user.username + "_status", user.status);
      Session.set("user_" + user.username + "_status_text", user.statusText);
      RoomManager.updateUserStatus(user, user.status, user.utcOffset);
    },
    changed: function (user) {
      Session.set("user_" + user.username + "_status", user.status);

      if (user.statusText !== undefined) {
        Session.set("user_" + user.username + "_status_text", user.statusText);
      }

      RoomManager.updateUserStatus(user, user.status, user.utcOffset);
    },
    removed: function (user) {
      Session.set("user_" + user.username + "_status", null);
      Session.set("user_" + user.username + "_status_text", null);
      RoomManager.updateUserStatus(user, 'offline', null);
    }
  });
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"methods":{"deleteMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/deleteMessage.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ChatMessage;
module.link("../../app/models/client", {
  ChatMessage: function (v) {
    ChatMessage = v;
  }
}, 1);
var canDeleteMessage;
module.link("../lib/utils/canDeleteMessage", {
  canDeleteMessage: function (v) {
    canDeleteMessage = v;
  }
}, 2);
Meteor.methods({
  deleteMessage: function (msg) {
    if (!Meteor.userId()) {
      return false;
    } // We're now only passed in the `_id` property to lower the amount of data sent to the server


    var message = ChatMessage.findOne({
      _id: msg._id
    });

    if (!canDeleteMessage({
      rid: message.rid,
      ts: message.ts,
      uid: message.u._id
    })) {
      return false;
    }

    ChatMessage.remove({
      '_id': message._id,
      'u._id': Meteor.userId()
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hideRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/hideRoom.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ChatSubscription;
module.link("../../app/models/client", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 1);
Meteor.methods({
  hideRoom: function (rid) {
    if (!Meteor.userId()) {
      return false;
    }

    ChatSubscription.update({
      rid: rid,
      'u._id': Meteor.userId()
    }, {
      $set: {
        alert: false,
        open: false
      }
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"openRoom.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/openRoom.js                                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ChatSubscription;
module.link("../../app/models/client", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 1);
Meteor.methods({
  openRoom: function (rid) {
    if (!Meteor.userId()) {
      return false;
    }

    ChatSubscription.update({
      rid: rid,
      'u._id': Meteor.userId()
    }, {
      $set: {
        open: true
      }
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"setUserActiveStatus.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/setUserActiveStatus.js                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
Meteor.methods({
  setUserActiveStatus: function (userId, active) {
    Meteor.users.update(userId, {
      $set: {
        active: active
      }
    });
    return true;
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"toggleFavorite.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/toggleFavorite.js                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var ChatSubscription;
module.link("../../app/models/client", {
  ChatSubscription: function (v) {
    ChatSubscription = v;
  }
}, 1);
Meteor.methods({
  toggleFavorite: function (rid, f) {
    if (!Meteor.userId()) {
      return false;
    }

    ChatSubscription.update({
      rid: rid,
      'u._id': Meteor.userId()
    }, {
      $set: {
        f: f
      }
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"updateMessage.js":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/methods/updateMessage.js                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var TimeSync;
module.link("meteor/mizzao:timesync", {
  TimeSync: function (v) {
    TimeSync = v;
  }
}, 1);
var Tracker;
module.link("meteor/tracker", {
  Tracker: function (v) {
    Tracker = v;
  }
}, 2);
var moment;
module.link("moment", {
  "default": function (v) {
    moment = v;
  }
}, 3);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 4);
var hasAtLeastOnePermission;
module.link("../../app/authorization/client", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 5);
var ChatMessage;
module.link("../../app/models/client", {
  ChatMessage: function (v) {
    ChatMessage = v;
  }
}, 6);
var settings;
module.link("../../app/settings/client", {
  settings: function (v) {
    settings = v;
  }
}, 7);
var t;
module.link("../../app/utils/client", {
  t: function (v) {
    t = v;
  }
}, 8);
var callbacks;
module.link("../../lib/callbacks", {
  callbacks: function (v) {
    callbacks = v;
  }
}, 9);
var dispatchToastMessage;
module.link("../lib/toast", {
  dispatchToastMessage: function (v) {
    dispatchToastMessage = v;
  }
}, 10);
Meteor.methods({
  updateMessage: function (message) {
    if (!Meteor.userId()) {
      return false;
    }

    var originalMessage = ChatMessage.findOne(message._id);
    var hasPermission = hasAtLeastOnePermission('edit-message', message.rid);
    var editAllowed = settings.get('Message_AllowEditing');
    var editOwn = false;

    if (originalMessage.msg === message.msg) {
      return;
    }

    if (originalMessage && originalMessage.u && originalMessage.u._id) {
      editOwn = originalMessage.u._id === Meteor.userId();
    }

    var me = Meteor.users.findOne(Meteor.userId());

    if (!(hasPermission || editAllowed && editOwn)) {
      dispatchToastMessage({
        type: 'error',
        message: t('error-action-not-allowed', {
          action: t('Message_editing')
        })
      });
      return false;
    }

    var blockEditInMinutes = settings.get('Message_AllowEditing_BlockEditInMinutes');

    if (_.isNumber(blockEditInMinutes) && blockEditInMinutes !== 0) {
      if (originalMessage.ts) {
        var msgTs = moment(originalMessage.ts);

        if (msgTs) {
          var currentTsDiff = moment().diff(msgTs, 'minutes');

          if (currentTsDiff > blockEditInMinutes) {
            dispatchToastMessage({
              type: 'error',
              message: t('error-message-editing-blocked')
            });
            return false;
          }
        }
      }
    }

    Tracker.nonreactive(function () {
      if (isNaN(TimeSync.serverOffset())) {
        message.editedAt = new Date();
      } else {
        message.editedAt = new Date(Date.now() + TimeSync.serverOffset());
      }

      message.editedBy = {
        _id: Meteor.userId(),
        username: me.username
      };
      message = callbacks.run('beforeSaveMessage', message);
      var messageObject = {
        editedAt: message.editedAt,
        editedBy: message.editedBy,
        msg: message.msg
      };

      if (originalMessage.attachments) {
        if (originalMessage.attachments[0].description !== undefined) {
          delete messageObject.msg;
        }
      }

      ChatMessage.update({
        '_id': message._id,
        'u._id': Meteor.userId()
      }, {
        $set: messageObject
      });
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"polyfills":{"childNodeRemove.ts":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/childNodeRemove.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
(function (arr) {
  arr.forEach(function (item) {
    if (item.hasOwnProperty('remove')) {
      return;
    }

    Object.defineProperty(item, 'remove', {
      configurable: true,
      enumerable: true,
      writable: true,
      value: function () {
        function remove() {
          this.parentNode.removeChild(this);
        }

        return remove;
      }()
    });
  });
})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"cssVars.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/cssVars.ts                                                                                         //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);

var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 1);

var _slicedToArray;

module.link("@babel/runtime/helpers/slicedToArray", {
  default: function (v) {
    _slicedToArray = v;
  }
}, 2);

var _;

module.link("underscore", {
  "default": function (v) {
    _ = v;
  }
}, 0);

var findDeclarations = function (code) {
  var _code$match;

  return ((_code$match = code.match(/(--[^:; ]+:..*?;)/g)) !== null && _code$match !== void 0 ? _code$match : []).map(function (declaration) {
    var matches = /(.*?):\s*(.*?)\s*;/.exec(declaration);

    if (matches === null) {
      throw new Error();
    }

    var _matches = _slicedToArray(matches, 3),
        name = _matches[1],
        value = _matches[2];

    return [name, value.indexOf('var(') >= 0 ? function (variables) {
      return value.replace(/var\((--.*?)\)/gm, function (_, name) {
        var _variables$name;

        return (_variables$name = variables[name]) === null || _variables$name === void 0 ? void 0 : _variables$name.call(null, variables);
      });
    } : function () {
      return value;
    }];
  });
};

var replaceReferences = function (code, variables) {
  return code.replace(/var\((--.*?)\)/gm, function (_, name) {
    var _variables$name2;

    return (_variables$name2 = variables[name]) === null || _variables$name2 === void 0 ? void 0 : _variables$name2.call(null, variables);
  });
};

var cssVariablesElement;
var originalCodes = new Map();

var update = _.debounce(function () {
  var _ref;

  var declarations = (_ref = []).concat.apply(_ref, _toConsumableArray(Array.from(originalCodes.values(), findDeclarations)).concat([findDeclarations(cssVariablesElement.innerHTML)]));

  var variables = Object.fromEntries(declarations);
  originalCodes.forEach(function (originalCode, element) {
    var patchedCode = replaceReferences(originalCode, variables);
    var patchedElement = element.nextElementSibling;

    if (!patchedElement || !patchedElement.classList.contains('patched-css-variables')) {
      patchedElement = document.createElement('style');
      patchedElement.type = 'text/css';
      patchedElement.classList.add('patched-css-variables');
      element.insertAdjacentElement('afterend', patchedElement);
    }

    var _patchedElement = patchedElement,
        sheet = _patchedElement.sheet;

    while (sheet.cssRules.length > 0) {
      sheet.deleteRule(0);
    }

    sheet.insertRule("@media all {" + patchedCode + "}", 0);
  });
}, 100);

var findAndPatchFromLinkElements = function () {
  Array.from(document.querySelectorAll('link[type="text/css"].__meteor-css__')).forEach(function () {
    function _callee(linkElement) {
      var url, response, code;
      return _regeneratorRuntime.async(function () {
        function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                url = linkElement.getAttribute('href');

                if (!(url === null)) {
                  _context.next = 3;
                  break;
                }

                return _context.abrupt("return");

              case 3:
                _context.prev = 3;
                _context.next = 6;
                return _regeneratorRuntime.awrap(fetch(url));

              case 6:
                response = _context.sent;
                _context.next = 9;
                return _regeneratorRuntime.awrap(response.text());

              case 9:
                code = _context.sent;
                originalCodes.set(linkElement, code);
                _context.next = 16;
                break;

              case 13:
                _context.prev = 13;
                _context.t0 = _context["catch"](3);
                console.warn(_context.t0);

              case 16:
                _context.prev = 16;
                update();
                return _context.finish(16);

              case 19:
              case "end":
                return _context.stop();
            }
          }
        }

        return _callee$;
      }(), null, null, [[3, 13, 16, 19]], Promise);
    }

    return _callee;
  }());
};

var waitAndInitialize = function () {
  if (document.readyState !== 'complete') {
    requestAnimationFrame(waitAndInitialize);
    return;
  }

  var element = document.getElementById('css-variables');

  if (element === null) {
    requestAnimationFrame(waitAndInitialize);
    return;
  }

  cssVariablesElement = element;
  var cssVariablesElementObserver = new MutationObserver(function () {
    update();
  });
  cssVariablesElementObserver.observe(cssVariablesElement, {
    childList: true
  });
  findAndPatchFromLinkElements();
};

(function () {
  if (window.CSS && window.CSS.supports && window.CSS.supports('(--foo: red)')) {
    return;
  }

  waitAndInitialize();
})();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"customEventPolyfill.ts":function module(){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/customEventPolyfill.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
(function () {
  if (typeof window.CustomEvent === 'function') {
    return;
  }

  var CustomEvent = function (type) {
    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
        _ref$bubbles = _ref.bubbles,
        bubbles = _ref$bubbles === void 0 ? false : _ref$bubbles,
        _ref$cancelable = _ref.cancelable,
        cancelable = _ref$cancelable === void 0 ? false : _ref$cancelable,
        _ref$detail = _ref.detail,
        detail = _ref$detail === void 0 ? null : _ref$detail;

    var evt = document.createEvent('CustomEvent');
    evt.initCustomEvent(type, bubbles, cancelable, detail);
    return evt;
  };

  window.CustomEvent = CustomEvent;
})();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hoverTouchClick.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/hoverTouchClick.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var domEvents;
module.link("../lib/utils/domEvents", {
  "*": function (v) {
    domEvents = v;
  }
}, 0);
var isIOsDevice;
module.link("../lib/utils/isIOsDevice", {
  isIOsDevice: function (v) {
    isIOsDevice = v;
  }
}, 1);

(function () {
  if (!isIOsDevice || !window.matchMedia('(hover: none)').matches) {
    return;
  }

  domEvents.delegate({
    parent: document.body,
    eventName: 'touchend',
    elementSelector: 'a:hover',
    listener: function (_, element) {
      domEvents.triggerClick(element);
    }
  });
})();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/index.ts                                                                                           //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("@rocket.chat/fuselage-polyfills");
module.link("url-polyfill");
module.link("./childNodeRemove");
module.link("./cssVars");
module.link("./customEventPolyfill");
module.link("./hoverTouchClick");
module.link("./objectFromEntries");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"objectFromEntries.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/polyfills/objectFromEntries.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _toConsumableArray;

module.link("@babel/runtime/helpers/toConsumableArray", {
  default: function (v) {
    _toConsumableArray = v;
  }
}, 0);

Object.fromEntries = Object.fromEntries || function () {
  function fromEntries(entries) {
    return _toConsumableArray(entries).reduce(function (obj, _ref) {
      var _Object$assign;

      var key = _ref[0],
          val = _ref[1];
      return Object.assign(obj, (_Object$assign = {}, _Object$assign[key] = val, _Object$assign));
    }, {});
  }

  return fromEntries;
}();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"providers":{"AuthorizationProvider.tsx":[
  "meteor/meteor",
  "react",
  "../../app/authorization/client",
  "../../app/models/client/models/Roles",
  "../contexts/AuthorizationContext",
  "../hooks/useReactiveValue",
  "./createReactiveSubscriptionFactory"
],"AvatarUrlProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "react",
  "../../app/utils/client",
  "../../app/utils/lib/getURL",
  "../contexts/AvatarUrlContext",
  "../contexts/SettingsContext"
],"ConnectionStatusProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "meteor/meteor",
  "react",
  "../contexts/ConnectionStatusContext",
  "../hooks/useReactiveValue"
],"CustomSoundProvider.tsx":[
  "react",
  "../../app/custom-sounds/client/lib/CustomSounds",
  "../contexts/CustomSoundContext"
],"EditableSettingsProvider.tsx":[
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/createForOfIteratorHelperLoose",
  "@rocket.chat/fuselage-hooks",
  "meteor/mongo",
  "meteor/tracker",
  "react",
  "../contexts/EditableSettingsContext",
  "../contexts/SettingsContext",
  "./createReactiveSubscriptionFactory"
],"LayoutProvider.tsx":[
  "@rocket.chat/fuselage-hooks",
  "react",
  "../../app/ui-utils/client",
  "../contexts/LayoutContext",
  "../contexts/RouterContext",
  "../contexts/SettingsContext"
],"MeteorProvider.tsx":[
  "react",
  "../components/Message/Attachments/providers/AttachmentProvider",
  "./AuthorizationProvider",
  "./AvatarUrlProvider",
  "./ConnectionStatusProvider",
  "./CustomSoundProvider",
  "./LayoutProvider",
  "./ModalProvider",
  "./OmnichannelProvider",
  "./RouterProvider",
  "./ServerProvider",
  "./SessionProvider",
  "./SettingsProvider",
  "./SidebarProvider",
  "./ToastMessagesProvider",
  "./TranslationProvider",
  "./UserProvider"
],"ModalProvider.tsx":[
  "@babel/runtime/helpers/slicedToArray",
  "@rocket.chat/fuselage",
  "react",
  "../../app/ui-utils/client/lib/modal",
  "../components/ModalPortal",
  "../contexts/ModalContext",
  "../views/hooks/useImperativeModal"
],"OmnichannelProvider.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "react",
  "../../app/livechat/client/collections/LivechatInquiry",
  "../../app/livechat/client/lib/stream/queueManager",
  "../../app/notifications/client",
  "../contexts/AuthorizationContext",
  "../contexts/OmnichannelContext",
  "../contexts/ServerContext",
  "../contexts/SettingsContext",
  "../contexts/UserContext",
  "../hooks/useReactiveValue"
],"RouterProvider.tsx":[
  "meteor/kadira:flow-router",
  "meteor/tracker",
  "react",
  "../contexts/RouterContext"
],"ServerProvider.tsx":[
  "meteor/meteor",
  "react",
  "../../app/utils/client",
  "../contexts/ServerContext"
],"SessionProvider.tsx":[
  "meteor/session",
  "react",
  "../contexts/SessionContext",
  "./createReactiveSubscriptionFactory"
],"SettingsProvider.tsx":[
  "@babel/runtime/regenerator",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/slicedToArray",
  "meteor/tracker",
  "react",
  "../contexts/AuthorizationContext",
  "../contexts/ServerContext",
  "../contexts/SettingsContext",
  "../lib/settings/PrivateSettingsCachedCollection",
  "../lib/settings/PublicSettingsCachedCollection",
  "./createReactiveSubscriptionFactory"
],"SidebarProvider.tsx":[
  "react",
  "../../app/ui-utils/client",
  "../contexts/SidebarContext",
  "../hooks/useReactiveValue"
],"ToastMessagesProvider.tsx":[
  "@babel/runtime/helpers/typeof",
  "react",
  "toastr",
  "../contexts/ToastMessagesContext",
  "../lib/toast",
  "../lib/utils/handleError"
],"TranslationProvider.js":[
  "@babel/runtime/helpers/slicedToArray",
  "@babel/runtime/helpers/objectWithoutProperties",
  "@babel/runtime/helpers/objectSpread2",
  "@babel/runtime/helpers/typeof",
  "meteor/rocketchat:tap-i18n",
  "react",
  "../contexts/TranslationContext",
  "../hooks/useReactiveValue"
],"UserProvider.tsx":[
  "meteor/meteor",
  "react",
  "../../app/models/client",
  "../../app/utils/client",
  "../../lib/callbacks",
  "../contexts/UserContext",
  "../hooks/useReactiveValue",
  "./createReactiveSubscriptionFactory"
],"createReactiveSubscriptionFactory.ts":[
  "meteor/tracker"
]},"templateHelpers":{"avatarUrlFromUsername.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/avatarUrlFromUsername.ts                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var getUserAvatarURL;
module.link("../../app/utils/lib/getUserAvatarURL", {
  getUserAvatarURL: function (v) {
    getUserAvatarURL = v;
  }
}, 1);
Template.registerHelper('avatarUrlFromUsername', getUserAvatarURL);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emojiUrlFromName.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/emojiUrlFromName.ts                                                                          //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var getEmojiUrlFromName;
module.link("../../app/emoji-custom/client/lib/emojiCustom", {
  getEmojiUrlFromName: function (v) {
    getEmojiUrlFromName = v;
  }
}, 1);
Template.registerHelper('emojiUrlFromName', getEmojiUrlFromName);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"hasPermission.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/hasPermission.ts                                                                             //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var hasAtLeastOnePermission;
module.link("../../app/authorization/client", {
  hasAtLeastOnePermission: function (v) {
    hasAtLeastOnePermission = v;
  }
}, 1);
Template.registerHelper('hasPermission', hasAtLeastOnePermission);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"index.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/index.ts                                                                                     //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("./log");
module.link("./renderEmoji");
module.link("./avatarUrlFromUsername");
module.link("./emojiUrlFromName");
module.link("./nrrargs");
module.link("./hasPermission");
module.link("./userHasAllPermission");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"log.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/log.ts                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
Template.registerHelper('log', function () {
  var _console;

  (_console = console).log.apply(_console, arguments);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"nrrargs.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/nrrargs.ts                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
Template.registerHelper('nrrargs', function () {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  return {
    _arguments: args
  };
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"renderEmoji.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/renderEmoji.ts                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var renderEmoji;
module.link("../lib/utils/renderEmoji", {
  renderEmoji: function (v) {
    renderEmoji = v;
  }
}, 1);
Template.registerHelper('renderEmoji', renderEmoji);
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"userHasAllPermission.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templateHelpers/userHasAllPermission.ts                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var Template;
module.link("meteor/templating", {
  Template: function (v) {
    Template = v;
  }
}, 0);
var userHasAllPermission;
module.link("../../app/authorization/client", {
  userHasAllPermission: function (v) {
    userHasAllPermission = v;
  }
}, 1);
Template.registerHelper('userHasAllPermission', function (userId, permission, scope) {
  return userHasAllPermission(permission, scope, userId);
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"importPackages.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/importPackages.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../app/cors/client");
module.link("../app/2fa/client");
module.link("../app/analytics/client");
module.link("../app/authorization");
module.link("../app/autotranslate/client");
module.link("../app/cas/client");
module.link("../app/channel-settings");
module.link("../app/crowd/client");
module.link("../app/custom-oauth");
module.link("../app/custom-sounds/client");
module.link("../app/dolphin/client");
module.link("../app/drupal/client");
module.link("../app/emoji/client");
module.link("../app/emoji-emojione/client");
module.link("../app/emoji-custom/client");
module.link("../app/favico");
module.link("../app/file-upload");
module.link("../app/github-enterprise/client");
module.link("../app/gitlab/client");
module.link("../app/iframe-login/client");
module.link("../app/importer/client");
module.link("../app/importer-csv/client");
module.link("../app/importer-hipchat-enterprise/client");
module.link("../app/importer-slack/client");
module.link("../app/importer-slack-users/client");
module.link("../app/integrations/client/startup");
module.link("../app/lib/client");
module.link("../app/livestream/client");
module.link("../app/logger/client");
module.link("../app/markdown/client");
module.link("../app/mentions-flextab/client");
module.link("../app/message-attachments/client");
module.link("../app/message-mark-as-unread/client");
module.link("../app/message-pin/client");
module.link("../app/message-snippet/client");
module.link("../app/message-star/client");
module.link("../app/nextcloud/client");
module.link("../app/oauth2-server-config/client");
module.link("../app/oembed/client");
module.link("../app/otr/client");
module.link("../app/push-notifications/client");
module.link("../app/apps/client");
module.link("../app/slackbridge/client");
module.link("../app/slashcommands-archiveroom/client");
module.link("../app/slashcommand-asciiarts/client");
module.link("../app/slashcommands-create/client");
module.link("../app/slashcommands-hide/client");
module.link("../app/slashcommands-invite/client");
module.link("../app/slashcommands-inviteall/client");
module.link("../app/slashcommands-join/client");
module.link("../app/slashcommands-kick/client");
module.link("../app/slashcommands-open/client");
module.link("../app/slashcommands-topic/client");
module.link("../app/slashcommands-unarchiveroom/client");
module.link("../app/tokenpass/client");
module.link("../app/ui/client");
module.link("../app/ui-account/client");
module.link("../app/ui-clean-history/client");
module.link("../app/ui-login/client");
module.link("../app/ui-master/client");
module.link("../app/ui-message/client");
module.link("../app/ui-sidenav/client");
module.link("../app/ui-vrecord/client");
module.link("../app/videobridge/client");
module.link("../app/webdav/client");
module.link("../app/webrtc/client");
module.link("../app/wordpress/client");
module.link("../app/nrr/client");
module.link("../app/meteor-accounts-saml/client");
module.link("../app/e2e/client");
module.link("../app/blockstack/client");
module.link("../app/version-check/client");
module.link("../app/search/client");
module.link("../app/chatpal-search/client");
module.link("../app/lazy-load/client");
module.link("../app/discussion/client");
module.link("../app/threads/client");
module.link("../app/mail-messages/client");
module.link("../app/user-status/client");
module.link("../app/utils/client");
module.link("../app/settings/client");
module.link("../app/models/client");
module.link("../app/notifications/client");
module.link("../app/ui-utils/client");
module.link("../app/ui-cached-collection/client");
module.link("../app/action-links/client");
module.link("../app/reactions/client");
module.link("../app/livechat/client");
module.link("../app/meteor-autocomplete/client");
module.link("../app/theme/client");
module.link("../app/custom/client");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"templates.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/templates.ts                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _regeneratorRuntime;

module.link("@babel/runtime/regenerator", {
  default: function (v) {
    _regeneratorRuntime = v;
  }
}, 0);
var HTML;
module.link("meteor/htmljs", {
  HTML: function (v) {
    HTML = v;
  }
}, 0);
var createTemplateForComponent;
module.link("./lib/portals/createTemplateForComponent", {
  createTemplateForComponent: function (v) {
    createTemplateForComponent = v;
  }
}, 1);
createTemplateForComponent('MessageActions', function () {
  return module.dynamicImport('./components/Message/Actions');
});
createTemplateForComponent('reactAttachments', function () {
  return module.dynamicImport('./components/Message/Attachments');
});
createTemplateForComponent('ThreadMetric', function () {
  return module.dynamicImport('./components/Message/Metrics/Thread');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      style: 'min-height: 36px;'
    });
  }
});
createTemplateForComponent('DiscussionMetric', function () {
  return module.dynamicImport('./components/Message/Metrics/Discussion');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      style: 'min-height: 36px;'
    });
  }
});
createTemplateForComponent('MessageBody', function () {
  return module.dynamicImport('./components/Message/Body');
});
createTemplateForComponent('BroadCastMetric', function () {
  return module.dynamicImport('./components/Message/Metrics/Broadcast');
});
createTemplateForComponent('Checkbox', function () {
  function _callee() {
    var _await$module$dynamic, CheckBox;

    return _regeneratorRuntime.async(function () {
      function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return _regeneratorRuntime.awrap(module.dynamicImport('@rocket.chat/fuselage'));

            case 2:
              _await$module$dynamic = _context.sent;
              CheckBox = _await$module$dynamic.CheckBox;
              return _context.abrupt("return", {
                "default": CheckBox
              });

            case 5:
            case "end":
              return _context.stop();
          }
        }
      }

      return _callee$;
    }(), null, null, null, Promise);
  }

  return _callee;
}(), {
  attachment: 'at-parent'
});
createTemplateForComponent('RoomForeword', function () {
  return module.dynamicImport('./components/RoomForeword');
}, {
  attachment: 'at-parent'
});
createTemplateForComponent('messageLocation', function () {
  return module.dynamicImport('./views/location/MessageLocation');
});
createTemplateForComponent('sidebarHeader', function () {
  return module.dynamicImport('./sidebar/header');
});
createTemplateForComponent('sidebarChats', function () {
  return module.dynamicImport('./sidebar/RoomList/index');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      style: 'display: flex; flex: 1 1 100%;'
    });
  }
});
createTemplateForComponent('omnichannelFlex', function () {
  return module.dynamicImport('./views/omnichannel/sidebar/OmnichannelSidebar');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      style: 'height: 100%; position: relative;'
    });
  }
});
createTemplateForComponent('auditPage', function () {
  return module.dynamicImport('../ee/client/audit/AuditPage');
}, {
  attachment: 'at-parent'
});
createTemplateForComponent('auditLogPage', function () {
  return module.dynamicImport('../ee/client/audit/AuditLogPage');
}, {
  attachment: 'at-parent'
});
createTemplateForComponent('DiscussionMessageList', function () {
  return module.dynamicImport('./views/room/contextualBar/Discussions');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('ThreadsList', function () {
  return module.dynamicImport('./views/room/contextualBar/Threads');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('ExportMessages', function () {
  return module.dynamicImport('./views/room/contextualBar/ExportMessages');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('KeyboardShortcuts', function () {
  return module.dynamicImport('./views/room/contextualBar/KeyboardShortcuts');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('room', function () {
  return module.dynamicImport('./views/room/Room');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      style: 'height: 100%; position: relative;'
    });
  }
});
createTemplateForComponent('AutoTranslate', function () {
  return module.dynamicImport('./views/room/contextualBar/AutoTranslate');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('NotificationsPreferences', function () {
  return module.dynamicImport('./views/room/contextualBar/NotificationPreferences');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('InviteUsers', function () {
  return module.dynamicImport('./views/room/contextualBar/RoomMembers/InviteUsers');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('EditInvite', function () {
  return module.dynamicImport('./views/room/contextualBar/RoomMembers/EditInvite');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('AddUsers', function () {
  return module.dynamicImport('./views/room/contextualBar/RoomMembers/AddUsers');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('membersList', function () {
  return module.dynamicImport('./views/room/contextualBar/RoomMembers');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('OTR', function () {
  return module.dynamicImport('./views/room/contextualBar/OTR');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('EditRoomInfo', function () {
  return module.dynamicImport('./views/room/contextualBar/Info/EditRoomInfo');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('RoomInfo', function () {
  return module.dynamicImport('./views/room/contextualBar/Info/RoomInfo');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('UserInfoWithData', function () {
  return module.dynamicImport('./views/room/contextualBar/UserInfo');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('channelFilesList', function () {
  return module.dynamicImport('./views/room/contextualBar/RoomFiles');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('RoomAnnouncement', function () {
  return module.dynamicImport('./views/room/Announcement');
});
createTemplateForComponent('PruneMessages', function () {
  return module.dynamicImport('./views/room/contextualBar/PruneMessages');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      "class": 'contextual-bar'
    });
  }
});
createTemplateForComponent('Burger', function () {
  return module.dynamicImport('./components/BurgerMenu');
});
createTemplateForComponent('loginLayoutHeader', function () {
  return module.dynamicImport('./views/login/LoginLayout/Header');
});
createTemplateForComponent('loginLayoutFooter', function () {
  return module.dynamicImport('./views/login/LoginLayout/Footer');
});
createTemplateForComponent('ModalBlock', function () {
  return module.dynamicImport('./views/blocks/ConnectedModalBlock');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      style: 'display: flex; width: 100%; height: 100%;'
    });
  }
});
createTemplateForComponent('Blocks', function () {
  return module.dynamicImport('./views/blocks/MessageBlock');
});
createTemplateForComponent('adminFlex', function () {
  return module.dynamicImport('./views/admin/sidebar/AdminSidebar');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      style: 'height: 100%; position: relative;'
    });
  }
});
createTemplateForComponent('accountFlex', function () {
  return module.dynamicImport('./views/account/AccountSidebar');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      style: 'height: 100%; position: relative;'
    });
  }
});
createTemplateForComponent('SortList', function () {
  return module.dynamicImport('./components/SortList');
});
createTemplateForComponent('CreateRoomList', function () {
  return module.dynamicImport('./sidebar/header/actions/CreateRoomList');
});
createTemplateForComponent('AppleOauthButton', function () {
  return module.dynamicImport('./views/login/AppleOauth/AppleOauthButton');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      style: 'display: flex; justify-content: center;'
    });
  }
});
createTemplateForComponent('UserDropdown', function () {
  return module.dynamicImport('./sidebar/header/UserDropdown');
});
createTemplateForComponent('sidebarFooter', function () {
  return module.dynamicImport('./sidebar/footer');
});
createTemplateForComponent('roomNotFound', function () {
  return module.dynamicImport('./views/room/Room/RoomNotFound');
}, {
  renderContainerView: function () {
    return HTML.DIV({
      style: 'height: 100%;'
    });
  }
});
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"main.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// client/main.ts                                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.link("../ee/client/ecdh");
module.link("./polyfills");
module.link("./lib/meteorCallWrapper");
module.link("./importPackages");
module.link("../ee/client");
module.link("./templateHelpers");
module.link("./methods/deleteMessage");
module.link("./methods/hideRoom");
module.link("./methods/openRoom");
module.link("./methods/setUserActiveStatus");
module.link("./methods/toggleFavorite");
module.link("./methods/updateMessage");
module.link("./startup");
module.link("./views/admin");
module.link("./views/teams");
module.link("./templates");
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"imports":{"client":{"sodium-plus":{"lib":{"backend":{"libsodium-wrappers.js":"/node_modules/sodium-plus/lib/backend/libsodium-wrappers.js","sodiumnative.js":"/node_modules/sodium-plus/lib/backend/sodiumnative.js"},"keytypes":{"ed25519pk.js":"/node_modules/sodium-plus/lib/keytypes/ed25519pk.js","ed25519sk.js":"/node_modules/sodium-plus/lib/keytypes/ed25519sk.js","x25519pk.js":"/node_modules/sodium-plus/lib/keytypes/x25519pk.js","x25519sk.js":"/node_modules/sodium-plus/lib/keytypes/x25519sk.js"},"backend.js":"/node_modules/sodium-plus/lib/backend.js","cryptography-key.js":"/node_modules/sodium-plus/lib/cryptography-key.js","polyfill.js":"/node_modules/sodium-plus/lib/polyfill.js","sodium-error.js":"/node_modules/sodium-plus/lib/sodium-error.js","sodiumplus.js":"/node_modules/sodium-plus/lib/sodiumplus.js","util.js":"/node_modules/sodium-plus/lib/util.js"},"index.js":"/node_modules/sodium-plus/index.js"},"poly1305-js":{"lib":{"poly1305.js":"/node_modules/poly1305-js/lib/poly1305.js","util.js":"/node_modules/poly1305-js/lib/util.js"},"index.js":"/node_modules/poly1305-js/index.js"},"@rocket.chat":{"apps-engine":{"definition":{"uikit":{"blocks":{"BlockBuilder.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/blocks/BlockBuilder.js","Blocks.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/blocks/Blocks.js","Elements.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/blocks/Elements.js","Objects.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/blocks/Objects.js","index.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/blocks/index.js"},"livechat":{"IUIKitLivechatActionHandler.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/livechat/IUIKitLivechatActionHandler.js","IUIKitLivechatIncomingInteraction.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/livechat/IUIKitLivechatIncomingInteraction.js","UIKitLivechatIncomingInteractionType.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/livechat/UIKitLivechatIncomingInteractionType.js","UIKitLivechatInteractionContext.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/livechat/UIKitLivechatInteractionContext.js","index.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/livechat/index.js"},"IUIKitActionHandler.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/IUIKitActionHandler.js","IUIKitIncomingInteraction.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/IUIKitIncomingInteraction.js","IUIKitInteractionType.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/IUIKitInteractionType.js","IUIKitSurface.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/IUIKitSurface.js","UIKitIncomingInteractionContainer.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/UIKitIncomingInteractionContainer.js","UIKitInteractionContext.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/UIKitInteractionContext.js","UIKitInteractionPayloadFormatter.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/UIKitInteractionPayloadFormatter.js","UIKitInteractionResponder.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/UIKitInteractionResponder.js","index.js":"/node_modules/@rocket.chat/apps-engine/definition/uikit/index.js"},"metadata":{"AppInterface.js":"/node_modules/@rocket.chat/apps-engine/definition/metadata/AppInterface.js","AppMethod.js":"/node_modules/@rocket.chat/apps-engine/definition/metadata/AppMethod.js","RocketChatAssociations.js":"/node_modules/@rocket.chat/apps-engine/definition/metadata/RocketChatAssociations.js","index.js":"/node_modules/@rocket.chat/apps-engine/definition/metadata/index.js"},"ui":{"IUIActionButtonDescriptor.js":"/node_modules/@rocket.chat/apps-engine/definition/ui/IUIActionButtonDescriptor.js","UIActionButtonContext.js":"/node_modules/@rocket.chat/apps-engine/definition/ui/UIActionButtonContext.js","index.js":"/node_modules/@rocket.chat/apps-engine/definition/ui/index.js"},"AppStatus.js":"/node_modules/@rocket.chat/apps-engine/definition/AppStatus.js"},"client":{"constants":{"index.js":"/node_modules/@rocket.chat/apps-engine/client/constants/index.js"},"definition":{"AppsEngineUIMethods.js":"/node_modules/@rocket.chat/apps-engine/client/definition/AppsEngineUIMethods.js","IAppsEngineUIResponse.js":"/node_modules/@rocket.chat/apps-engine/client/definition/IAppsEngineUIResponse.js","IExternalComponentRoomInfo.js":"/node_modules/@rocket.chat/apps-engine/client/definition/IExternalComponentRoomInfo.js","IExternalComponentUserInfo.js":"/node_modules/@rocket.chat/apps-engine/client/definition/IExternalComponentUserInfo.js","index.js":"/node_modules/@rocket.chat/apps-engine/client/definition/index.js"},"AppClientManager.js":"/node_modules/@rocket.chat/apps-engine/client/AppClientManager.js","AppServerCommunicator.js":"/node_modules/@rocket.chat/apps-engine/client/AppServerCommunicator.js","AppsEngineUIHost.js":"/node_modules/@rocket.chat/apps-engine/client/AppsEngineUIHost.js"}}},"map-age-cleaner":{"dist":{"index.js":"/node_modules/map-age-cleaner/dist/index.js"}},"mem":{"dist":{"index.js":"/node_modules/mem/dist/index.js"}},"scheduler":{"cjs":{"scheduler-tracing.development.js":"/node_modules/scheduler/cjs/scheduler-tracing.development.js","scheduler-tracing.production.min.js":"/node_modules/scheduler/cjs/scheduler-tracing.production.min.js","scheduler.development.js":"/node_modules/scheduler/cjs/scheduler.development.js","scheduler.production.min.js":"/node_modules/scheduler/cjs/scheduler.production.min.js"},"index.js":"/node_modules/scheduler/index.js","tracing.js":"/node_modules/scheduler/tracing.js"},"mimic-fn":{"index.js":"/node_modules/mem/node_modules/mimic-fn/index.js"},"p-defer":{"index.js":"/node_modules/p-defer/index.js"},"sodium-native":{"index.js":"/node_modules/sodium-native/index.js"}}},"lib":{"utils":{"isJSON.ts":[]},"callbacks.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// lib/callbacks.ts                                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _createForOfIteratorHelperLoose;

module.link("@babel/runtime/helpers/createForOfIteratorHelperLoose", {
  default: function (v) {
    _createForOfIteratorHelperLoose = v;
  }
}, 0);
module.export({
  callbacks: function () {
    return callbacks;
  }
});
var Meteor;
module.link("meteor/meteor", {
  Meteor: function (v) {
    Meteor = v;
  }
}, 0);
var getRandomId;
module.link("./random", {
  getRandomId: function (v) {
    getRandomId = v;
  }
}, 1);
var CallbackPriority;

(function (CallbackPriority) {
  CallbackPriority[CallbackPriority["HIGH"] = -1000] = "HIGH";
  CallbackPriority[CallbackPriority["MEDIUM"] = 0] = "MEDIUM";
  CallbackPriority[CallbackPriority["LOW"] = 1000] = "LOW";
})(CallbackPriority || (CallbackPriority = {}));

var Callbacks = /*#__PURE__*/function () {
  function Callbacks() {
    this.logger = undefined;
    this.trackCallback = undefined;
    this.trackHook = undefined;
    this.callbacks = new Map();
    this.sequentialRunners = new Map();
    this.asyncRunners = new Map();
    this.priority = CallbackPriority;
  }

  var _proto = Callbacks.prototype;

  _proto.setLogger = function () {
    function setLogger(logger) {
      this.logger = logger;
    }

    return setLogger;
  }();

  _proto.setMetricsTrackers = function () {
    function setMetricsTrackers(_ref) {
      var trackCallback = _ref.trackCallback,
          trackHook = _ref.trackHook;
      this.trackCallback = trackCallback;
      this.trackHook = trackHook;
    }

    return setMetricsTrackers;
  }();

  _proto.runOne = function () {
    function runOne(callback, item, constant) {
      var _this$trackCallback;

      var stopTracking = (_this$trackCallback = this.trackCallback) === null || _this$trackCallback === void 0 ? void 0 : _this$trackCallback.call(this, callback);

      try {
        return callback(item, constant);
      } finally {
        stopTracking === null || stopTracking === void 0 ? void 0 : stopTracking();
      }
    }

    return runOne;
  }();

  _proto.createSequentialRunner = function () {
    function createSequentialRunner(hook, callbacks) {
      var _this = this;

      var wrapCallback = function (callback) {
        return function (item, constant) {
          var _this$logger, _this$runOne;

          (_this$logger = _this.logger) === null || _this$logger === void 0 ? void 0 : _this$logger.debug("Executing callback with id " + callback.id + " for hook " + callback.hook);
          return (_this$runOne = _this.runOne(callback, item, constant)) !== null && _this$runOne !== void 0 ? _this$runOne : item;
        };
      };

      var identity = function (item) {
        return item;
      };

      var pipe = function (curr, next) {
        return function (item, constant) {
          return next(curr(item, constant), constant);
        };
      };

      var fn = callbacks.map(wrapCallback).reduce(pipe, identity);
      return function (item, constant) {
        var _this$trackHook;

        var stopTracking = (_this$trackHook = _this.trackHook) === null || _this$trackHook === void 0 ? void 0 : _this$trackHook.call(_this, {
          hook: hook,
          length: callbacks.length
        });

        try {
          return fn(item, constant);
        } finally {
          stopTracking === null || stopTracking === void 0 ? void 0 : stopTracking();
        }
      };
    }

    return createSequentialRunner;
  }();

  _proto.createAsyncRunner = function () {
    function createAsyncRunner(_, callbacks) {
      var _this2 = this;

      return function (item, constant) {
        if (typeof window !== 'undefined') {
          throw new Error('callbacks.runAsync on client server not allowed');
        }

        var _loop = function (callback) {
          Meteor.defer(function () {
            _this2.runOne(callback, item, constant);
          });
        };

        for (var _iterator = _createForOfIteratorHelperLoose(callbacks), _step; !(_step = _iterator()).done;) {
          var callback = _step.value;

          _loop(callback);
        }

        return item;
      };
    }

    return createAsyncRunner;
  }();

  _proto.getCallbacks = function () {
    function getCallbacks(hook) {
      var _this$callbacks$get;

      return (_this$callbacks$get = this.callbacks.get(hook)) !== null && _this$callbacks$get !== void 0 ? _this$callbacks$get : [];
    }

    return getCallbacks;
  }();

  _proto.setCallbacks = function () {
    function setCallbacks(hook, callbacks) {
      this.callbacks.set(hook, callbacks);
      this.sequentialRunners.set(hook, this.createSequentialRunner(hook, callbacks));
      this.asyncRunners.set(hook, this.createAsyncRunner(hook, callbacks));
    }

    return setCallbacks;
  }();

  _proto.add = function () {
    function add(hook, callback) {
      var _this3 = this;

      var priority = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.priority.MEDIUM;
      var id = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : getRandomId();
      var callbacks = this.getCallbacks(hook);

      if (callbacks.some(function (cb) {
        return cb.id === id;
      })) {
        return;
      }

      callbacks.push(Object.assign(callback, {
        hook: hook,
        priority: priority,
        id: id,
        stack: new Error().stack
      }));

      var rank = function (callback) {
        var _callback$priority;

        return (_callback$priority = callback.priority) !== null && _callback$priority !== void 0 ? _callback$priority : _this3.priority.MEDIUM;
      };

      callbacks.sort(function (a, b) {
        return rank(a) - rank(b);
      });
      this.setCallbacks(hook, callbacks);
    }

    return add;
  }()
  /**
   * Remove a callback from a hook
   *
   * @param hook the name of the hook
   * @param id the callback's id
   */
  ;

  _proto.remove = function () {
    function remove(hook, id) {
      var hooks = this.getCallbacks(hook).filter(function (callback) {
        return callback.id !== id;
      });
      this.setCallbacks(hook, hooks);
    }

    return remove;
  }();

  _proto.run = function () {
    function run(hook, item, constant) {
      var _this$sequentialRunne;

      var runner = (_this$sequentialRunne = this.sequentialRunners.get(hook)) !== null && _this$sequentialRunne !== void 0 ? _this$sequentialRunne : function (item, _constant) {
        return item;
      };
      return runner(item, constant);
    }

    return run;
  }();

  _proto.runAsync = function () {
    function runAsync(hook, item, constant) {
      var _this$asyncRunners$ge;

      var runner = (_this$asyncRunners$ge = this.asyncRunners.get(hook)) !== null && _this$asyncRunners$ge !== void 0 ? _this$asyncRunners$ge : function (item, _constant) {
        return item;
      };
      return runner(item, constant);
    }

    return runAsync;
  }();

  return Callbacks;
}();
/**
 * Callback hooks provide an easy way to add extra steps to common operations.
 * @deprecated
 */


var callbacks = new Callbacks();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"emailValidator.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// lib/emailValidator.ts                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  validateEmail: function () {
    return validateEmail;
  }
});

var validateEmail = function (email) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
    style: 'basic'
  };
  var basicEmailRegex = /^[^@]+@[^@]+$/;
  var rfcEmailRegex = /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;

  switch (options.style) {
    case 'rfc':
      return rfcEmailRegex.test(email);

    case 'basic':
    default:
      return basicEmailRegex.test(email);
  }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getImageExtensionFromMime.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// lib/getImageExtensionFromMime.ts                                                                                    //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getImageExtensionFromMime: function () {
    return getImageExtensionFromMime;
  }
});
var extensionsMap = {
  'image/apng': 'apng',
  'image/avif': 'avif',
  'image/gif': 'gif',
  'image/jpeg': 'jpg',
  'image/png': 'png',
  'image/svg+xml': 'svg',
  'image/webp': 'webp',
  'image/bmp': 'bmp',
  'image/x-icon': 'ico',
  'image/tiff': 'tif'
};

var getImageExtensionFromMime = function (mime) {
  return extensionsMap[mime];
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"getUserEmailAddress.ts":[],"random.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// lib/random.ts                                                                                                       //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  getRandomId: function () {
    return getRandomId;
  }
});
var Random;
module.link("meteor/random", {
  Random: function (v) {
    Random = v;
  }
}, 0);

var getRandomId = function (length) {
  return Random.id(length);
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"transforms.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// lib/transforms.ts                                                                                                   //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  createTransformChain: function () {
    return createTransformChain;
  },
  createAsyncTransformChain: function () {
    return createAsyncTransformChain;
  }
});

var createTransformChain = function () {
  for (var _len = arguments.length, transforms = new Array(_len), _key = 0; _key < _len; _key++) {
    transforms[_key] = arguments[_key];
  }

  var chain = transforms;

  var call = function (x) {
    return chain.reduce(function (x, transform) {
      return transform(x);
    }, x);
  };

  var use = function (transform) {
    chain.push(transform);
    return function () {
      chain = chain.filter(function (t) {
        return t !== transform;
      });
    };
  };

  return Object.assign(call, {
    use: use
  });
};

var createAsyncTransformChain = function () {
  for (var _len2 = arguments.length, transforms = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
    transforms[_key2] = arguments[_key2];
  }

  var chain = transforms;

  var call = function (x) {
    return chain.reduce(function (x, transform) {
      return x.then(transform);
    }, Promise.resolve(x));
  };

  var use = function (transform) {
    chain.push(transform);
    return function () {
      chain = chain.filter(function (t) {
        return t !== transform;
      });
    };
  };

  return Object.assign(call, {
    use: use
  });
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}},"definition":{"IMessage":{"MessageAttachment":{"Files":{"AudioAttachmentProps.ts":[],"FileAttachmentProps.ts":[],"ImageAttachmentProps.ts":[],"VideoAttachmentProps.ts":[]},"MessageAttachmentAction.ts":[],"MessageQuoteAttachment.ts":[]}},"rest":{"v1":{"settings.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/rest/v1/settings.ts                                                                                      //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isOauthCustomConfiguration: function () {
    return isOauthCustomConfiguration;
  },
  isSettingsUpdatePropsActions: function () {
    return isSettingsUpdatePropsActions;
  },
  isSettingsUpdatePropsColor: function () {
    return isSettingsUpdatePropsColor;
  },
  isSettingsUpdatePropDefault: function () {
    return isSettingsUpdatePropDefault;
  }
});

var isOauthCustomConfiguration = function (config) {
  return Boolean(config);
};

var isSettingsUpdatePropsActions = function (props) {
  return 'execute' in props;
};

var isSettingsUpdatePropsColor = function (props) {
  return 'editor' in props && 'value' in props;
};

var isSettingsUpdatePropDefault = function (props) {
  return 'value' in props;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},"IBanner.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/IBanner.ts                                                                                               //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  BannerPlatform: function () {
    return BannerPlatform;
  },
  isInactiveBanner: function () {
    return isInactiveBanner;
  }
});
var BannerPlatform;

(function (BannerPlatform) {
  BannerPlatform["Web"] = "web";
  BannerPlatform["Mobile"] = "mobile";
})(BannerPlatform || module.runSetters(BannerPlatform = {}, ["BannerPlatform"]));

var isInactiveBanner = function (banner) {
  return banner.active === false;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ILivechatBusinessHour.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/ILivechatBusinessHour.ts                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  LivechatBusinessHourTypes: function () {
    return LivechatBusinessHourTypes;
  },
  LivechatBusinessHourBehaviors: function () {
    return LivechatBusinessHourBehaviors;
  }
});
var LivechatBusinessHourTypes;

(function (LivechatBusinessHourTypes) {
  LivechatBusinessHourTypes["DEFAULT"] = "default";
  LivechatBusinessHourTypes["CUSTOM"] = "custom";
})(LivechatBusinessHourTypes || module.runSetters(LivechatBusinessHourTypes = {}, ["LivechatBusinessHourTypes"]));

var LivechatBusinessHourBehaviors;

(function (LivechatBusinessHourBehaviors) {
  LivechatBusinessHourBehaviors["SINGLE"] = "Single";
  LivechatBusinessHourBehaviors["MULTIPLE"] = "Multiple";
})(LivechatBusinessHourBehaviors || module.runSetters(LivechatBusinessHourBehaviors = {}, ["LivechatBusinessHourBehaviors"]));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"IRoom.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/IRoom.ts                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  isTeamRoom: function () {
    return isTeamRoom;
  },
  isPrivateTeamRoom: function () {
    return isPrivateTeamRoom;
  },
  isPublicTeamRoom: function () {
    return isPublicTeamRoom;
  },
  isDiscussion: function () {
    return isDiscussion;
  },
  isPrivateDiscussion: function () {
    return isPrivateDiscussion;
  },
  isPublicDiscussion: function () {
    return isPublicDiscussion;
  },
  isDirectMessageRoom: function () {
    return isDirectMessageRoom;
  },
  isMultipleDirectMessageRoom: function () {
    return isMultipleDirectMessageRoom;
  },
  OmnichannelSourceType: function () {
    return OmnichannelSourceType;
  },
  isOmnichannelRoom: function () {
    return isOmnichannelRoom;
  },
  isOmnichannelRoomFromAppSource: function () {
    return isOmnichannelRoomFromAppSource;
  }
});

var isTeamRoom = function (room) {
  return !!room.teamMain;
};

var isPrivateTeamRoom = function (room) {
  return isTeamRoom(room) && room.t === 'p';
};

var isPublicTeamRoom = function (room) {
  return isTeamRoom(room) && room.t === 'c';
};

var isDiscussion = function (room) {
  return !!room.prid;
};

var isPrivateDiscussion = function (room) {
  return isDiscussion(room) && room.t === 'p';
};

var isPublicDiscussion = function (room) {
  return isDiscussion(room) && room.t === 'c';
};

var isDirectMessageRoom = function (room) {
  return room.t === 'd';
};

var isMultipleDirectMessageRoom = function (room) {
  return isDirectMessageRoom(room) && room.uids.length > 2;
};

var OmnichannelSourceType;

(function (OmnichannelSourceType) {
  OmnichannelSourceType["WIDGET"] = "widget";
  OmnichannelSourceType["EMAIL"] = "email";
  OmnichannelSourceType["SMS"] = "sms";
  OmnichannelSourceType["APP"] = "app";
  OmnichannelSourceType["API"] = "api";
  OmnichannelSourceType["OTHER"] = "other";
})(OmnichannelSourceType || module.runSetters(OmnichannelSourceType = {}, ["OmnichannelSourceType"]));

var isOmnichannelRoom = function (room) {
  return room.t === 'l';
};

var isOmnichannelRoomFromAppSource = function (room) {
  var _room$source;

  if (!isOmnichannelRoom(room)) {
    return false;
  }

  return ((_room$source = room.source) === null || _room$source === void 0 ? void 0 : _room$source.type) === OmnichannelSourceType.APP;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"ITeam.ts":[],"UIKit.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/UIKit.ts                                                                                                 //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
var _objectSpread;

module.link("@babel/runtime/helpers/objectSpread2", {
  default: function (v) {
    _objectSpread = v;
  }
}, 0);
module.export({
  UIKitInteractionTypes: function () {
    return UIKitInteractionTypes;
  },
  isErrorType: function () {
    return isErrorType;
  }
});
var UIKitInteractionTypeApi;
module.link("@rocket.chat/apps-engine/definition/uikit", {
  UIKitInteractionType: function (v) {
    UIKitInteractionTypeApi = v;
  }
}, 0);
var UIKitInteractionTypeExtended;

(function (UIKitInteractionTypeExtended) {
  UIKitInteractionTypeExtended["BANNER_OPEN"] = "banner.open";
  UIKitInteractionTypeExtended["BANNER_UPDATE"] = "banner.update";
  UIKitInteractionTypeExtended["BANNER_CLOSE"] = "banner.close";
})(UIKitInteractionTypeExtended || (UIKitInteractionTypeExtended = {}));

var UIKitInteractionTypes = _objectSpread(_objectSpread({}, UIKitInteractionTypeApi), UIKitInteractionTypeExtended);

var isErrorType = function (result) {
  return result.type === UIKitInteractionTypeApi.ERRORS;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

},"UserStatus.ts":function module(require,exports,module){

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                     //
// definition/UserStatus.ts                                                                                            //
//                                                                                                                     //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                                       //
module.export({
  UserStatus: function () {
    return UserStatus;
  }
});
var UserStatus;

(function (UserStatus) {
  UserStatus["ONLINE"] = "online";
  UserStatus["AWAY"] = "away";
  UserStatus["OFFLINE"] = "offline";
  UserStatus["BUSY"] = "busy";
})(UserStatus || module.runSetters(UserStatus = {}, ["UserStatus"]));
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}}},{
  "extensions": [
    ".js",
    ".json",
    ".html",
    ".ts",
    ".mjs",
    ".css",
    ".tsx",
    ".less",
    ".info"
  ]
});

var exports = require("/client/main.ts");