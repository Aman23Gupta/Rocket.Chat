{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/ee/app/teams-mention/server/EESpotlight.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"ee/app/teams-mention/server/EESpotlight.js","filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/ee/app/teams-mention/server/EESpotlight.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","root":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/ee/app/teams-mention/server/EESpotlight.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"ee/app/teams-mention/server/EESpotlight.js"}},"code":"let _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n\n}, 0);\nmodule.export({\n  SpotlightEnterprise: () => SpotlightEnterprise\n});\nlet Team;\nmodule.link(\"../../../../server/sdk\", {\n  Team(v) {\n    Team = v;\n  }\n\n}, 0);\nconst SpotlightEnterprise = {\n  mapTeams(_, teams) {\n    return teams.map(t => {\n      t.isTeam = true;\n      t.username = t.name;\n      t.status = 'online';\n      return t;\n    });\n  },\n\n  _searchTeams(_, userId, _ref) {\n    let {\n      text,\n      options,\n      users,\n      mentions\n    } = _ref;\n\n    if (!mentions) {\n      return users;\n    }\n\n    options.limit -= users.length;\n\n    if (options.limit <= 0) {\n      return users;\n    }\n\n    const teamOptions = _objectSpread(_objectSpread({}, options), {}, {\n      projection: {\n        name: 1,\n        type: 1\n      }\n    });\n\n    const teams = Promise.await(Team.search(userId, text, teamOptions));\n    users.push(...this.mapTeams(teams));\n    return users;\n  },\n\n  _performExtraUserSearches(_, userId, searchParams) {\n    return this._searchTeams(userId, searchParams);\n  }\n\n};","map":{"version":3,"sources":["ee/app/teams-mention/server/EESpotlight.js"],"names":["_objectSpread","module","link","default","v","export","SpotlightEnterprise","Team","mapTeams","_","teams","map","t","isTeam","username","name","status","_searchTeams","userId","text","options","users","mentions","limit","length","teamOptions","projection","type","Promise","await","search","push","_performExtraUserSearches","searchParams"],"mappings":"AAAA,IAAIA,aAAJ;;AAAkBC,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,EAAAA,OAAO,CAACC,CAAD,EAAG;AAACJ,IAAAA,aAAa,GAACI,CAAd;AAAgB;;AAA5B,CAAnD,EAAiF,CAAjF;AAAlBH,MAAM,CAACI,MAAP,CAAc;AAACC,EAAAA,mBAAmB,EAAC,MAAIA;AAAzB,CAAd;AAA6D,IAAIC,IAAJ;AAASN,MAAM,CAACC,IAAP,CAAY,wBAAZ,EAAqC;AAACK,EAAAA,IAAI,CAACH,CAAD,EAAG;AAACG,IAAAA,IAAI,GAACH,CAAL;AAAO;;AAAhB,CAArC,EAAuD,CAAvD;AAE/D,MAAME,mBAAmB,GAAG;AAClCE,EAAAA,QAAQ,CAACC,CAAD,EAAIC,KAAJ,EAAW;AAClB,WAAOA,KAAK,CAACC,GAAN,CAAWC,CAAD,IAAO;AACvBA,MAAAA,CAAC,CAACC,MAAF,GAAW,IAAX;AACAD,MAAAA,CAAC,CAACE,QAAF,GAAaF,CAAC,CAACG,IAAf;AACAH,MAAAA,CAAC,CAACI,MAAF,GAAW,QAAX;AACA,aAAOJ,CAAP;AACA,KALM,CAAP;AAMA,GARiC;;AAUlCK,EAAAA,YAAY,CAACR,CAAD,EAAIS,MAAJ,QAAgD;AAAA,QAApC;AAAEC,MAAAA,IAAF;AAAQC,MAAAA,OAAR;AAAiBC,MAAAA,KAAjB;AAAwBC,MAAAA;AAAxB,KAAoC;;AAC3D,QAAI,CAACA,QAAL,EAAe;AACd,aAAOD,KAAP;AACA;;AAEDD,IAAAA,OAAO,CAACG,KAAR,IAAiBF,KAAK,CAACG,MAAvB;;AAEA,QAAIJ,OAAO,CAACG,KAAR,IAAiB,CAArB,EAAwB;AACvB,aAAOF,KAAP;AACA;;AAED,UAAMI,WAAW,mCAAQL,OAAR;AAAiBM,MAAAA,UAAU,EAAE;AAAEX,QAAAA,IAAI,EAAE,CAAR;AAAWY,QAAAA,IAAI,EAAE;AAAjB;AAA7B,MAAjB;;AACA,UAAMjB,KAAK,GAAGkB,OAAO,CAACC,KAAR,CAActB,IAAI,CAACuB,MAAL,CAAYZ,MAAZ,EAAoBC,IAApB,EAA0BM,WAA1B,CAAd,CAAd;AACAJ,IAAAA,KAAK,CAACU,IAAN,CAAW,GAAG,KAAKvB,QAAL,CAAcE,KAAd,CAAd;AAEA,WAAOW,KAAP;AACA,GA1BiC;;AA4BlCW,EAAAA,yBAAyB,CAACvB,CAAD,EAAIS,MAAJ,EAAYe,YAAZ,EAA0B;AAClD,WAAO,KAAKhB,YAAL,CAAkBC,MAAlB,EAA0Be,YAA1B,CAAP;AACA;;AA9BiC,CAA5B","sourcesContent":["import { Team } from '../../../../server/sdk';\n\nexport const SpotlightEnterprise = {\n\tmapTeams(_, teams) {\n\t\treturn teams.map((t) => {\n\t\t\tt.isTeam = true;\n\t\t\tt.username = t.name;\n\t\t\tt.status = 'online';\n\t\t\treturn t;\n\t\t});\n\t},\n\n\t_searchTeams(_, userId, { text, options, users, mentions }) {\n\t\tif (!mentions) {\n\t\t\treturn users;\n\t\t}\n\n\t\toptions.limit -= users.length;\n\n\t\tif (options.limit <= 0) {\n\t\t\treturn users;\n\t\t}\n\n\t\tconst teamOptions = { ...options, projection: { name: 1, type: 1 } };\n\t\tconst teams = Promise.await(Team.search(userId, text, teamOptions));\n\t\tusers.push(...this.mapTeams(teams));\n\n\t\treturn users;\n\t},\n\n\t_performExtraUserSearches(_, userId, searchParams) {\n\t\treturn this._searchTeams(userId, searchParams);\n\t},\n};\n"]},"sourceType":"module","hash":"dc95664dfe108224f85b886d840f0e12041bf763"}
