{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/ui-utils/client/lib/menu.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/ui-utils/client/lib/menu.js","filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/ui-utils/client/lib/menu.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","root":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/ui-utils/client/lib/menu.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/ui-utils/client/lib/menu.js"}},"code":"var _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 0);\n\nvar _createClass;\n\nmodule.link(\"@babel/runtime/helpers/createClass\", {\n  default: function (v) {\n    _createClass = v;\n  }\n}, 1);\n\nvar _inheritsLoose;\n\nmodule.link(\"@babel/runtime/helpers/inheritsLoose\", {\n  default: function (v) {\n    _inheritsLoose = v;\n  }\n}, 2);\nmodule.export({\n  menu: function () {\n    return menu;\n  }\n});\nvar Session;\nmodule.link(\"meteor/session\", {\n  Session: function (v) {\n    Session = v;\n  }\n}, 0);\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 1);\n\nvar _;\n\nmodule.link(\"underscore\", {\n  \"default\": function (v) {\n    _ = v;\n  }\n}, 2);\nvar Emitter;\nmodule.link(\"@rocket.chat/emitter\", {\n  Emitter: function (v) {\n    Emitter = v;\n  }\n}, 3);\nvar isRtl;\nmodule.link(\"../../../utils\", {\n  isRtl: function (v) {\n    isRtl = v;\n  }\n}, 4);\nvar sideNavW = 280;\n\nvar map = function (x, in_min, in_max, out_min, out_max) {\n  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n};\n\nvar menu = new ( /*#__PURE__*/function (_Emitter) {\n  _inheritsLoose(_class, _Emitter);\n\n  function _class() {\n    var _this;\n\n    _this = _Emitter.call(this) || this;\n    _this._open = false;\n    _this.updateUnreadBars = _.throttle(function () {\n      if (_this.list == null) {\n        return;\n      }\n\n      var listOffset = _this.list.offset();\n\n      var listHeight = _this.list.height();\n\n      var showTop = false;\n      var showBottom = false;\n      $('li.sidebar-item--unread').each(function () {\n        if ($(this).offset().top < listOffset.top - $(this).height()) {\n          showTop = true;\n        }\n\n        if ($(this).offset().top > listOffset.top + listHeight) {\n          showBottom = true;\n        }\n      });\n\n      if (showTop === true) {\n        $('.top-unread-rooms').removeClass('hidden');\n      } else {\n        $('.top-unread-rooms').addClass('hidden');\n      }\n\n      if (showBottom === true) {\n        return $('.bottom-unread-rooms').removeClass('hidden');\n      }\n\n      return $('.bottom-unread-rooms').addClass('hidden');\n    }, 200);\n    _this.sideNavW = sideNavW;\n    return _this;\n  }\n\n  var _proto = _class.prototype;\n\n  _proto.touchstart = function () {\n    function touchstart(e) {\n      this.movestarted = false;\n      this.blockmove = false;\n      this.touchstartX = undefined;\n      this.touchstartY = undefined;\n      this.diff = 0;\n\n      if (e.target === this.sidebarWrap[0] || $(e.target).closest('.main-content').length > 0) {\n        this.closePopover();\n        this.touchstartX = e.touches[0].clientX;\n        this.touchstartY = e.touches[0].clientY;\n        this.mainContent = $('.main-content');\n      }\n    }\n\n    return touchstart;\n  }();\n\n  _proto.touchmove = function () {\n    function touchmove(e) {\n      if (this.touchstartX == null) {\n        return;\n      }\n\n      var _e$touches = _slicedToArray(e.touches, 1),\n          touch = _e$touches[0];\n\n      var diffX = touch.clientX - this.touchstartX;\n      var diffY = touch.clientY - this.touchstartY;\n      var absX = Math.abs(diffX);\n      var absY = Math.abs(diffY);\n\n      if (!this.movestarted && absY > 5) {\n        this.blockmove = true;\n      }\n\n      if (this.blockmove) {\n        return;\n      }\n\n      this.sidebar.css('transition', 'none');\n      this.sidebarWrap.css('transition', 'none');\n\n      if (this.movestarted === true || absX > 5) {\n        this.movestarted = true;\n\n        if (this.isRtl) {\n          if (this.isOpen()) {\n            this.diff = -sideNavW + diffX;\n          } else {\n            this.diff = diffX;\n          }\n\n          if (this.diff < -sideNavW) {\n            this.diff = -sideNavW;\n          }\n\n          if (this.diff > 0) {\n            this.diff = 0;\n          }\n        } else {\n          if (this.isOpen()) {\n            this.diff = sideNavW + diffX;\n          } else {\n            this.diff = diffX;\n          }\n\n          if (this.diff > sideNavW) {\n            this.diff = sideNavW;\n          }\n\n          if (this.diff < 0) {\n            this.diff = 0;\n          }\n        } // if (map((this.diff / sideNavW), 0, 1, -.1, .8) > 0) {\n\n\n        this.sidebar.css('box-shadow', '0 0 15px 1px rgba(0,0,0,.3)'); // this.sidebarWrap.css('z-index', '9998');\n\n        this.translate(this.diff); // }\n      }\n    }\n\n    return touchmove;\n  }();\n\n  _proto.translate = function () {\n    function translate(diff) {\n      var width = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : sideNavW;\n\n      if (diff === undefined) {\n        diff = this.isRtl ? -1 * sideNavW : sideNavW;\n      }\n\n      this.sidebarWrap.css('width', '100%');\n      this.wrapper.css('overflow', 'hidden');\n      this.sidebarWrap.css('background-color', '#000');\n      this.sidebarWrap.css('opacity', map(Math.abs(diff) / width, 0, 1, -0.1, 0.8).toFixed(2));\n      this.isRtl ? this.sidebar.css('transform', \"translate3d(\" + (sideNavW + diff).toFixed(3) + \"px, 0 , 0)\") : this.sidebar.css('transform', \"translate3d(\" + (diff - sideNavW).toFixed(3) + \"px, 0 , 0)\");\n    }\n\n    return translate;\n  }();\n\n  _proto.touchend = function () {\n    function touchend() {\n      var max = sideNavW * 0.76,\n          min = sideNavW * 0.24;\n\n      if (this.movestarted !== true) {\n        return;\n      }\n\n      this.movestarted = false;\n\n      if (this.isRtl) {\n        if (this.isOpen()) {\n          return this.diff >= -max ? this.close() : this.open();\n        }\n\n        if (this.diff <= -min) {\n          return this.open();\n        }\n\n        return this.close();\n      }\n\n      if (this.isOpen()) {\n        if (this.diff >= max) {\n          return this.open();\n        }\n\n        return this.close();\n      }\n\n      if (this.diff >= min) {\n        return this.open();\n      }\n\n      return this.close();\n    }\n\n    return touchend;\n  }();\n\n  _proto.init = function () {\n    function init() {\n      var _this2 = this;\n\n      this.menu = $('.sidebar');\n      this.sidebar = this.menu;\n      this.sidebarWrap = $('.sidebar-wrap');\n      this.wrapper = $('.messages-box > .wrapper');\n\n      var ignore = function (fn) {\n        return function (event) {\n          return document.body.clientWidth <= 780 && fn(event);\n        };\n      };\n\n      document.body.addEventListener('touchstart', ignore(function (e) {\n        return _this2.touchstart(e);\n      }));\n      document.body.addEventListener('touchmove', ignore(function (e) {\n        return _this2.touchmove(e);\n      }));\n      document.body.addEventListener('touchend', ignore(function (e) {\n        return _this2.touchend(e);\n      }));\n      this.sidebarWrap.on('click', ignore(function (e) {\n        e.target === _this2.sidebarWrap[0] && _this2.isOpen() && _this2.emit('clickOut', e);\n      }));\n      this.on('close', function () {\n        _this2.sidebarWrap.css('width', ''); // this.sidebarWrap.css('z-index', '');\n\n\n        _this2.sidebarWrap.css('background-color', '');\n\n        _this2.sidebar.css('transform', '');\n\n        _this2.sidebar.css('box-shadow', '');\n\n        _this2.sidebar.css('transition', '');\n\n        _this2.sidebarWrap.css('transition', '');\n\n        _this2.wrapper && _this2.wrapper.css('overflow', '');\n      });\n      this.on('open', ignore(function () {\n        _this2.sidebar.css('box-shadow', '0 0 15px 1px rgba(0,0,0,.3)'); // this.sidebarWrap.css('z-index', '9998');\n\n\n        _this2.translate();\n      }));\n      this.mainContent = $('.main-content');\n      this.list = $('.rooms-list');\n      this._open = false;\n      Session.set('isMenuOpen', this._open);\n    }\n\n    return init;\n  }();\n\n  _proto.closePopover = function () {\n    function closePopover() {\n      return this.menu.find('[data-popover=\"anchor\"]:checked').prop('checked', false).length > 0;\n    }\n\n    return closePopover;\n  }();\n\n  _proto.isOpen = function () {\n    function isOpen() {\n      return Session.get('isMenuOpen');\n    }\n\n    return isOpen;\n  }();\n\n  _proto.open = function () {\n    function open() {\n      this._open = true;\n      Session.set('isMenuOpen', this._open);\n      this.emit('open');\n    }\n\n    return open;\n  }();\n\n  _proto.close = function () {\n    function close() {\n      this._open = false;\n      Session.set('isMenuOpen', this._open);\n      this.emit('close');\n    }\n\n    return close;\n  }();\n\n  _proto.toggle = function () {\n    function toggle() {\n      return this.isOpen() ? this.close() : this.open();\n    }\n\n    return toggle;\n  }();\n\n  _createClass(_class, [{\n    key: \"isRtl\",\n    get: function () {\n      return isRtl(Meteor._localStorage.getItem('userLanguage'));\n    }\n  }]);\n\n  return _class;\n}(Emitter))();\nvar passClosePopover = false;\nmenu.on('clickOut', function () {\n  if (!menu.closePopover()) {\n    passClosePopover = true;\n    menu.close();\n  }\n});\nmenu.on('close', function () {\n  if (!menu.sidebar) {\n    return;\n  }\n\n  menu.sidebar.css('transition', '');\n  menu.sidebarWrap.css('transition', '');\n\n  if (passClosePopover) {\n    passClosePopover = false;\n    return;\n  }\n\n  menu.closePopover();\n});","map":{"version":3,"sources":["app/ui-utils/client/lib/menu.js"],"names":["_slicedToArray","module","link","default","v","_createClass","_inheritsLoose","export","menu","Session","Meteor","_","Emitter","isRtl","sideNavW","map","x","in_min","in_max","out_min","out_max","_open","updateUnreadBars","throttle","list","listOffset","offset","listHeight","height","showTop","showBottom","$","each","top","removeClass","addClass","touchstart","e","movestarted","blockmove","touchstartX","undefined","touchstartY","diff","target","sidebarWrap","closest","length","closePopover","touches","clientX","clientY","mainContent","touchmove","touch","diffX","diffY","absX","Math","abs","absY","sidebar","css","isOpen","translate","width","wrapper","toFixed","touchend","max","min","close","open","init","ignore","fn","event","document","body","clientWidth","addEventListener","on","emit","set","find","prop","get","toggle","_localStorage","getItem","passClosePopover"],"mappings":"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","sourcesContent":["import { Session } from 'meteor/session';\nimport { Meteor } from 'meteor/meteor';\nimport _ from 'underscore';\nimport { Emitter } from '@rocket.chat/emitter';\n\nimport { isRtl } from '../../../utils';\n\nconst sideNavW = 280;\nconst map = (x, in_min, in_max, out_min, out_max) => ((x - in_min) * (out_max - out_min)) / (in_max - in_min) + out_min;\n\nexport const menu = new (class extends Emitter {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._open = false;\n\t\tthis.updateUnreadBars = _.throttle(() => {\n\t\t\tif (this.list == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst listOffset = this.list.offset();\n\t\t\tconst listHeight = this.list.height();\n\t\t\tlet showTop = false;\n\t\t\tlet showBottom = false;\n\t\t\t$('li.sidebar-item--unread').each(function () {\n\t\t\t\tif ($(this).offset().top < listOffset.top - $(this).height()) {\n\t\t\t\t\tshowTop = true;\n\t\t\t\t}\n\t\t\t\tif ($(this).offset().top > listOffset.top + listHeight) {\n\t\t\t\t\tshowBottom = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (showTop === true) {\n\t\t\t\t$('.top-unread-rooms').removeClass('hidden');\n\t\t\t} else {\n\t\t\t\t$('.top-unread-rooms').addClass('hidden');\n\t\t\t}\n\t\t\tif (showBottom === true) {\n\t\t\t\treturn $('.bottom-unread-rooms').removeClass('hidden');\n\t\t\t}\n\t\t\treturn $('.bottom-unread-rooms').addClass('hidden');\n\t\t}, 200);\n\t\tthis.sideNavW = sideNavW;\n\t}\n\n\tget isRtl() {\n\t\treturn isRtl(Meteor._localStorage.getItem('userLanguage'));\n\t}\n\n\ttouchstart(e) {\n\t\tthis.movestarted = false;\n\t\tthis.blockmove = false;\n\t\tthis.touchstartX = undefined;\n\t\tthis.touchstartY = undefined;\n\t\tthis.diff = 0;\n\t\tif (e.target === this.sidebarWrap[0] || $(e.target).closest('.main-content').length > 0) {\n\t\t\tthis.closePopover();\n\t\t\tthis.touchstartX = e.touches[0].clientX;\n\t\t\tthis.touchstartY = e.touches[0].clientY;\n\t\t\tthis.mainContent = $('.main-content');\n\t\t}\n\t}\n\n\ttouchmove(e) {\n\t\tif (this.touchstartX == null) {\n\t\t\treturn;\n\t\t}\n\t\tconst [touch] = e.touches;\n\t\tconst diffX = touch.clientX - this.touchstartX;\n\t\tconst diffY = touch.clientY - this.touchstartY;\n\t\tconst absX = Math.abs(diffX);\n\t\tconst absY = Math.abs(diffY);\n\n\t\tif (!this.movestarted && absY > 5) {\n\t\t\tthis.blockmove = true;\n\t\t}\n\t\tif (this.blockmove) {\n\t\t\treturn;\n\t\t}\n\t\tthis.sidebar.css('transition', 'none');\n\t\tthis.sidebarWrap.css('transition', 'none');\n\t\tif (this.movestarted === true || absX > 5) {\n\t\t\tthis.movestarted = true;\n\t\t\tif (this.isRtl) {\n\t\t\t\tif (this.isOpen()) {\n\t\t\t\t\tthis.diff = -sideNavW + diffX;\n\t\t\t\t} else {\n\t\t\t\t\tthis.diff = diffX;\n\t\t\t\t}\n\t\t\t\tif (this.diff < -sideNavW) {\n\t\t\t\t\tthis.diff = -sideNavW;\n\t\t\t\t}\n\t\t\t\tif (this.diff > 0) {\n\t\t\t\t\tthis.diff = 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.isOpen()) {\n\t\t\t\t\tthis.diff = sideNavW + diffX;\n\t\t\t\t} else {\n\t\t\t\t\tthis.diff = diffX;\n\t\t\t\t}\n\t\t\t\tif (this.diff > sideNavW) {\n\t\t\t\t\tthis.diff = sideNavW;\n\t\t\t\t}\n\t\t\t\tif (this.diff < 0) {\n\t\t\t\t\tthis.diff = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// if (map((this.diff / sideNavW), 0, 1, -.1, .8) > 0) {\n\t\t\tthis.sidebar.css('box-shadow', '0 0 15px 1px rgba(0,0,0,.3)');\n\t\t\t// this.sidebarWrap.css('z-index', '9998');\n\t\t\tthis.translate(this.diff);\n\t\t\t// }\n\t\t}\n\t}\n\n\ttranslate(diff, width = sideNavW) {\n\t\tif (diff === undefined) {\n\t\t\tdiff = this.isRtl ? -1 * sideNavW : sideNavW;\n\t\t}\n\t\tthis.sidebarWrap.css('width', '100%');\n\t\tthis.wrapper.css('overflow', 'hidden');\n\t\tthis.sidebarWrap.css('background-color', '#000');\n\t\tthis.sidebarWrap.css('opacity', map(Math.abs(diff) / width, 0, 1, -0.1, 0.8).toFixed(2));\n\t\tthis.isRtl\n\t\t\t? this.sidebar.css('transform', `translate3d(${(sideNavW + diff).toFixed(3)}px, 0 , 0)`)\n\t\t\t: this.sidebar.css('transform', `translate3d(${(diff - sideNavW).toFixed(3)}px, 0 , 0)`);\n\t}\n\n\ttouchend() {\n\t\tconst [max, min] = [sideNavW * 0.76, sideNavW * 0.24];\n\t\tif (this.movestarted !== true) {\n\t\t\treturn;\n\t\t}\n\t\tthis.movestarted = false;\n\t\tif (this.isRtl) {\n\t\t\tif (this.isOpen()) {\n\t\t\t\treturn this.diff >= -max ? this.close() : this.open();\n\t\t\t}\n\t\t\tif (this.diff <= -min) {\n\t\t\t\treturn this.open();\n\t\t\t}\n\t\t\treturn this.close();\n\t\t}\n\t\tif (this.isOpen()) {\n\t\t\tif (this.diff >= max) {\n\t\t\t\treturn this.open();\n\t\t\t}\n\t\t\treturn this.close();\n\t\t}\n\t\tif (this.diff >= min) {\n\t\t\treturn this.open();\n\t\t}\n\t\treturn this.close();\n\t}\n\n\tinit() {\n\t\tthis.menu = $('.sidebar');\n\t\tthis.sidebar = this.menu;\n\t\tthis.sidebarWrap = $('.sidebar-wrap');\n\t\tthis.wrapper = $('.messages-box > .wrapper');\n\t\tconst ignore = (fn) => (event) => document.body.clientWidth <= 780 && fn(event);\n\n\t\tdocument.body.addEventListener(\n\t\t\t'touchstart',\n\t\t\tignore((e) => this.touchstart(e)),\n\t\t);\n\t\tdocument.body.addEventListener(\n\t\t\t'touchmove',\n\t\t\tignore((e) => this.touchmove(e)),\n\t\t);\n\t\tdocument.body.addEventListener(\n\t\t\t'touchend',\n\t\t\tignore((e) => this.touchend(e)),\n\t\t);\n\t\tthis.sidebarWrap.on(\n\t\t\t'click',\n\t\t\tignore((e) => {\n\t\t\t\te.target === this.sidebarWrap[0] && this.isOpen() && this.emit('clickOut', e);\n\t\t\t}),\n\t\t);\n\t\tthis.on('close', () => {\n\t\t\tthis.sidebarWrap.css('width', '');\n\t\t\t// this.sidebarWrap.css('z-index', '');\n\t\t\tthis.sidebarWrap.css('background-color', '');\n\t\t\tthis.sidebar.css('transform', '');\n\t\t\tthis.sidebar.css('box-shadow', '');\n\t\t\tthis.sidebar.css('transition', '');\n\t\t\tthis.sidebarWrap.css('transition', '');\n\t\t\tthis.wrapper && this.wrapper.css('overflow', '');\n\t\t});\n\t\tthis.on(\n\t\t\t'open',\n\t\t\tignore(() => {\n\t\t\t\tthis.sidebar.css('box-shadow', '0 0 15px 1px rgba(0,0,0,.3)');\n\t\t\t\t// this.sidebarWrap.css('z-index', '9998');\n\t\t\t\tthis.translate();\n\t\t\t}),\n\t\t);\n\t\tthis.mainContent = $('.main-content');\n\n\t\tthis.list = $('.rooms-list');\n\t\tthis._open = false;\n\t\tSession.set('isMenuOpen', this._open);\n\t}\n\n\tclosePopover() {\n\t\treturn this.menu.find('[data-popover=\"anchor\"]:checked').prop('checked', false).length > 0;\n\t}\n\n\tisOpen() {\n\t\treturn Session.get('isMenuOpen');\n\t}\n\n\topen() {\n\t\tthis._open = true;\n\t\tSession.set('isMenuOpen', this._open);\n\t\tthis.emit('open');\n\t}\n\n\tclose() {\n\t\tthis._open = false;\n\t\tSession.set('isMenuOpen', this._open);\n\t\tthis.emit('close');\n\t}\n\n\ttoggle() {\n\t\treturn this.isOpen() ? this.close() : this.open();\n\t}\n})();\n\nlet passClosePopover = false;\n\nmenu.on('clickOut', function () {\n\tif (!menu.closePopover()) {\n\t\tpassClosePopover = true;\n\t\tmenu.close();\n\t}\n});\n\nmenu.on('close', function () {\n\tif (!menu.sidebar) {\n\t\treturn;\n\t}\n\n\tmenu.sidebar.css('transition', '');\n\tmenu.sidebarWrap.css('transition', '');\n\tif (passClosePopover) {\n\t\tpassClosePopover = false;\n\t\treturn;\n\t}\n\tmenu.closePopover();\n});\n"]},"sourceType":"module","hash":"58887741106fff267740751df5911306797c1897"}
