{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/version-check/server/functions/checkVersionUpdate.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"app/version-check/server/functions/checkVersionUpdate.js","filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/version-check/server/functions/checkVersionUpdate.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","root":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/version-check/server/functions/checkVersionUpdate.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/version-check/server/functions/checkVersionUpdate.js"}},"code":"let TAPi18n;\nmodule.link(\"meteor/rocketchat:tap-i18n\", {\n  TAPi18n(v) {\n    TAPi18n = v;\n  }\n\n}, 0);\nlet semver;\nmodule.link(\"semver\", {\n  default(v) {\n    semver = v;\n  }\n\n}, 1);\nlet getNewUpdates;\nmodule.link(\"./getNewUpdates\", {\n  default(v) {\n    getNewUpdates = v;\n  }\n\n}, 2);\nlet settings;\nmodule.link(\"../../../settings\", {\n  settings(v) {\n    settings = v;\n  }\n\n}, 3);\nlet Info;\nmodule.link(\"../../../utils\", {\n  Info(v) {\n    Info = v;\n  }\n\n}, 4);\nlet Users;\nmodule.link(\"../../../models\", {\n  Users(v) {\n    Users = v;\n  }\n\n}, 5);\nlet logger;\nmodule.link(\"../logger\", {\n  default(v) {\n    logger = v;\n  }\n\n}, 6);\nlet sendMessagesToAdmins;\nmodule.link(\"../../../../server/lib/sendMessagesToAdmins\", {\n  sendMessagesToAdmins(v) {\n    sendMessagesToAdmins = v;\n  }\n\n}, 7);\nlet Settings;\nmodule.link(\"../../../models/server\", {\n  Settings(v) {\n    Settings = v;\n  }\n\n}, 8);\nmodule.exportDefault(() => {\n  logger.info('Checking for version updates');\n  const {\n    versions,\n    alerts\n  } = getNewUpdates();\n  const update = {\n    exists: false,\n    lastestVersion: null,\n    security: false\n  };\n  const lastCheckedVersion = settings.get('Update_LatestAvailableVersion');\n  versions.forEach(version => {\n    if (semver.lte(version.version, lastCheckedVersion)) {\n      return;\n    }\n\n    if (semver.lte(version.version, Info.version)) {\n      return;\n    }\n\n    update.exists = true;\n    update.lastestVersion = version;\n\n    if (version.security === true) {\n      update.security = true;\n    }\n  });\n\n  if (update.exists) {\n    Settings.updateValueById('Update_LatestAvailableVersion', update.lastestVersion.version);\n    Promise.await(sendMessagesToAdmins({\n      msgs: _ref => {\n        let {\n          adminUser\n        } = _ref;\n        return [{\n          msg: \"*\".concat(TAPi18n.__('Update_your_RocketChat', adminUser.language), \"*\\n\").concat(TAPi18n.__('New_version_available_(s)', update.lastestVersion.version, adminUser.language), \"\\n\").concat(update.lastestVersion.infoUrl)\n        }];\n      },\n      banners: [{\n        id: \"versionUpdate-\".concat(update.lastestVersion.version).replace(/\\./g, '_'),\n        priority: 10,\n        title: 'Update_your_RocketChat',\n        text: 'New_version_available_(s)',\n        textArguments: [update.lastestVersion.version],\n        link: update.lastestVersion.infoUrl\n      }]\n    }));\n  }\n\n  if (alerts && alerts.length) {\n    Promise.await(sendMessagesToAdmins({\n      msgs: _ref2 => {\n        let {\n          adminUser\n        } = _ref2;\n        return alerts.filter(alert => !Users.bannerExistsById(adminUser._id, \"alert-\".concat(alert.id))).map(alert => ({\n          msg: \"*\".concat(TAPi18n.__('Rocket_Chat_Alert', adminUser.language), \":*\\n\\n*\").concat(TAPi18n.__(alert.title, adminUser.language), \"*\\n\").concat(TAPi18n.__(alert.text, ...(alert.textArguments || []), adminUser.language), \"\\n\").concat(alert.infoUrl)\n        }));\n      },\n      banners: alerts.map(alert => ({\n        id: \"alert-\".concat(alert.id).replace(/\\./g, '_'),\n        priority: 10,\n        title: alert.title,\n        text: alert.text,\n        textArguments: alert.textArguments,\n        modifiers: alert.modifiers,\n        link: alert.infoUrl\n      }))\n    }));\n  }\n});","map":{"version":3,"sources":["app/version-check/server/functions/checkVersionUpdate.js"],"names":["TAPi18n","module","link","v","semver","default","getNewUpdates","settings","Info","Users","logger","sendMessagesToAdmins","Settings","exportDefault","info","versions","alerts","update","exists","lastestVersion","security","lastCheckedVersion","get","forEach","version","lte","updateValueById","Promise","await","msgs","adminUser","msg","__","language","infoUrl","banners","id","replace","priority","title","text","textArguments","length","filter","alert","bannerExistsById","_id","map","modifiers"],"mappings":"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","sourcesContent":["import { TAPi18n } from 'meteor/rocketchat:tap-i18n';\nimport semver from 'semver';\n\nimport getNewUpdates from './getNewUpdates';\nimport { settings } from '../../../settings';\nimport { Info } from '../../../utils';\nimport { Users } from '../../../models';\nimport logger from '../logger';\nimport { sendMessagesToAdmins } from '../../../../server/lib/sendMessagesToAdmins';\nimport { Settings } from '../../../models/server';\n// import getNewUpdates from '../sampleUpdateData';\n\nexport default () => {\n\tlogger.info('Checking for version updates');\n\n\tconst { versions, alerts } = getNewUpdates();\n\n\tconst update = {\n\t\texists: false,\n\t\tlastestVersion: null,\n\t\tsecurity: false,\n\t};\n\n\tconst lastCheckedVersion = settings.get('Update_LatestAvailableVersion');\n\tversions.forEach((version) => {\n\t\tif (semver.lte(version.version, lastCheckedVersion)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (semver.lte(version.version, Info.version)) {\n\t\t\treturn;\n\t\t}\n\n\t\tupdate.exists = true;\n\t\tupdate.lastestVersion = version;\n\n\t\tif (version.security === true) {\n\t\t\tupdate.security = true;\n\t\t}\n\t});\n\n\tif (update.exists) {\n\t\tSettings.updateValueById('Update_LatestAvailableVersion', update.lastestVersion.version);\n\n\t\tPromise.await(\n\t\t\tsendMessagesToAdmins({\n\t\t\t\tmsgs: ({ adminUser }) => [\n\t\t\t\t\t{\n\t\t\t\t\t\tmsg: `*${TAPi18n.__('Update_your_RocketChat', adminUser.language)}*\\n${TAPi18n.__(\n\t\t\t\t\t\t\t'New_version_available_(s)',\n\t\t\t\t\t\t\tupdate.lastestVersion.version,\n\t\t\t\t\t\t\tadminUser.language,\n\t\t\t\t\t\t)}\\n${update.lastestVersion.infoUrl}`,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tbanners: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: `versionUpdate-${update.lastestVersion.version}`.replace(/\\./g, '_'),\n\t\t\t\t\t\tpriority: 10,\n\t\t\t\t\t\ttitle: 'Update_your_RocketChat',\n\t\t\t\t\t\ttext: 'New_version_available_(s)',\n\t\t\t\t\t\ttextArguments: [update.lastestVersion.version],\n\t\t\t\t\t\tlink: update.lastestVersion.infoUrl,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t}),\n\t\t);\n\t}\n\n\tif (alerts && alerts.length) {\n\t\tPromise.await(\n\t\t\tsendMessagesToAdmins({\n\t\t\t\tmsgs: ({ adminUser }) =>\n\t\t\t\t\talerts\n\t\t\t\t\t\t.filter((alert) => !Users.bannerExistsById(adminUser._id, `alert-${alert.id}`))\n\t\t\t\t\t\t.map((alert) => ({\n\t\t\t\t\t\t\tmsg: `*${TAPi18n.__('Rocket_Chat_Alert', adminUser.language)}:*\\n\\n*${TAPi18n.__(\n\t\t\t\t\t\t\t\talert.title,\n\t\t\t\t\t\t\t\tadminUser.language,\n\t\t\t\t\t\t\t)}*\\n${TAPi18n.__(alert.text, ...(alert.textArguments || []), adminUser.language)}\\n${alert.infoUrl}`,\n\t\t\t\t\t\t})),\n\t\t\t\tbanners: alerts.map((alert) => ({\n\t\t\t\t\tid: `alert-${alert.id}`.replace(/\\./g, '_'),\n\t\t\t\t\tpriority: 10,\n\t\t\t\t\ttitle: alert.title,\n\t\t\t\t\ttext: alert.text,\n\t\t\t\t\ttextArguments: alert.textArguments,\n\t\t\t\t\tmodifiers: alert.modifiers,\n\t\t\t\t\tlink: alert.infoUrl,\n\t\t\t\t})),\n\t\t\t}),\n\t\t);\n\t}\n};\n"]},"sourceType":"module","hash":"b618c928699c447760ad082c6515d38cf77c85e7"}
