{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/bigbluebutton/server/bigbluebutton-api.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"app/bigbluebutton/server/bigbluebutton-api.js","filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/bigbluebutton/server/bigbluebutton-api.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","root":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/bigbluebutton/server/bigbluebutton-api.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/bigbluebutton/server/bigbluebutton-api.js"}},"code":"let crypto;\nmodule.link(\"crypto\", {\n  default(v) {\n    crypto = v;\n  }\n\n}, 0);\nlet SystemLogger;\nmodule.link(\"../../../server/lib/logger/system\", {\n  SystemLogger(v) {\n    SystemLogger = v;\n  }\n\n}, 1);\n\nvar BigBlueButtonApi,\n    filterCustomParameters,\n    include,\n    noChecksumMethods,\n    __indexOf = [].indexOf || function (item) {\n  for (var i = 0, l = this.length; i < l; i++) {\n    if (i in this && this[i] === item) return i;\n  }\n\n  return -1;\n};\n\nBigBlueButtonApi = function () {\n  function BigBlueButtonApi(url, salt, debug, opts) {\n    var _base;\n\n    if (opts == null) {\n      opts = {};\n    }\n\n    this.url = url;\n    this.salt = salt;\n    this.opts = opts;\n\n    if ((_base = this.opts).shaType == null) {\n      _base.shaType = 'sha1';\n    }\n  }\n\n  BigBlueButtonApi.prototype.availableApiCalls = function () {\n    return ['/', 'create', 'join', 'isMeetingRunning', 'getMeetingInfo', 'end', 'getMeetings', 'getDefaultConfigXML', 'setConfigXML', 'enter', 'configXML', 'signOut', 'getRecordings', 'publishRecordings', 'deleteRecordings', 'updateRecordings', 'hooks/create'];\n  };\n\n  BigBlueButtonApi.prototype.urlParamsFor = function (param) {\n    switch (param) {\n      case \"create\":\n        return [[\"meetingID\", true], [\"name\", true], [\"attendeePW\", false], [\"moderatorPW\", false], [\"welcome\", false], [\"dialNumber\", false], [\"voiceBridge\", false], [\"webVoice\", false], [\"logoutURL\", false], [\"maxParticipants\", false], [\"record\", false], [\"duration\", false], [\"moderatorOnlyMessage\", false], [\"autoStartRecording\", false], [\"allowStartStopRecording\", false], [/meta_\\w+/, false]];\n\n      case \"join\":\n        return [[\"fullName\", true], [\"meetingID\", true], [\"password\", true], [\"createTime\", false], [\"userID\", false], [\"webVoiceConf\", false], [\"configToken\", false], [\"avatarURL\", false], [\"redirect\", false], [\"clientURL\", false]];\n\n      case \"isMeetingRunning\":\n        return [[\"meetingID\", true]];\n\n      case \"end\":\n        return [[\"meetingID\", true], [\"password\", true]];\n\n      case \"getMeetingInfo\":\n        return [[\"meetingID\", true], [\"password\", true]];\n\n      case \"getRecordings\":\n        return [[\"meetingID\", false], [\"recordID\", false], [\"state\", false], [/meta_\\w+/, false]];\n\n      case \"publishRecordings\":\n        return [[\"recordID\", true], [\"publish\", true]];\n\n      case \"deleteRecordings\":\n        return [[\"recordID\", true]];\n\n      case \"updateRecordings\":\n        return [[\"recordID\", true], [/meta_\\w+/, false]];\n\n      case \"hooks/create\":\n        return [[\"callbackURL\", false], [\"meetingID\", false]];\n    }\n  };\n\n  BigBlueButtonApi.prototype.filterParams = function (params, method) {\n    var filters, r;\n    filters = this.urlParamsFor(method);\n\n    if (filters == null || filters.length === 0) {\n      ({});\n    } else {\n      r = include(params, function (key, value) {\n        var filter, _i, _len;\n\n        for (_i = 0, _len = filters.length; _i < _len; _i++) {\n          filter = filters[_i];\n\n          if (filter[0] instanceof RegExp) {\n            if (key.match(filter[0]) || key.match(/^custom_/)) {\n              return true;\n            }\n          } else {\n            if (key.match(\"^\" + filter[0] + \"$\") || key.match(/^custom_/)) {\n              return true;\n            }\n          }\n        }\n\n        return false;\n      });\n    }\n\n    return filterCustomParameters(r);\n  };\n\n  BigBlueButtonApi.prototype.urlFor = function (method, params, filter) {\n    var checksum, key, keys, param, paramList, property, query, sep, url, _i, _len;\n\n    if (filter == null) {\n      filter = true;\n    }\n\n    SystemLogger.debug(\"Generating URL for\", method);\n\n    if (filter) {\n      params = this.filterParams(params, method);\n    } else {\n      params = filterCustomParameters(params);\n    }\n\n    url = this.url;\n    paramList = [];\n\n    if (params != null) {\n      keys = [];\n\n      for (property in params) {\n        keys.push(property);\n      }\n\n      keys = keys.sort();\n\n      for (_i = 0, _len = keys.length; _i < _len; _i++) {\n        key = keys[_i];\n\n        if (key != null) {\n          param = params[key];\n        }\n\n        if (param != null) {\n          paramList.push(\"\" + this.encodeForUrl(key) + \"=\" + this.encodeForUrl(param));\n        }\n      }\n\n      if (paramList.length > 0) {\n        query = paramList.join(\"&\");\n      }\n    } else {\n      query = '';\n    }\n\n    checksum = this.checksum(method, query);\n\n    if (paramList.length > 0) {\n      query = \"\" + method + \"?\" + query;\n      sep = '&';\n    } else {\n      if (method !== '/') {\n        query = method;\n      }\n\n      sep = '?';\n    }\n\n    if (__indexOf.call(noChecksumMethods(), method) < 0) {\n      query = \"\" + query + sep + \"checksum=\" + checksum;\n    }\n\n    return \"\" + url + \"/\" + query;\n  };\n\n  BigBlueButtonApi.prototype.checksum = function (method, query) {\n    var c, shaObj, str;\n    query || (query = \"\");\n    SystemLogger.debug(\"- Calculating the checksum using: '\" + method + \"', '\" + query + \"', '\" + this.salt + \"'\");\n    str = method + query + this.salt;\n\n    if (this.opts.shaType === 'sha256') {\n      shaObj = crypto.createHash('sha256', \"TEXT\");\n    } else {\n      shaObj = crypto.createHash('sha1', \"TEXT\");\n    }\n\n    shaObj.update(str);\n    c = shaObj.digest('hex');\n    SystemLogger.debug(\"- Checksum calculated:\", c);\n    return c;\n  };\n\n  BigBlueButtonApi.prototype.encodeForUrl = function (value) {\n    return encodeURIComponent(value).replace(/%20/g, '+').replace(/[!'()]/g, escape).replace(/\\*/g, \"%2A\");\n  };\n\n  BigBlueButtonApi.prototype.setMobileProtocol = function (url) {\n    return url.replace(/http[s]?\\:\\/\\//, \"bigbluebutton://\");\n  };\n\n  return BigBlueButtonApi;\n}();\n\ninclude = function (input, _function) {\n  var key, value, _match, _obj;\n\n  _obj = new Object();\n  _match = null;\n\n  for (key in input) {\n    value = input[key];\n\n    if (_function.call(input, key, value)) {\n      _obj[key] = value;\n    }\n  }\n\n  return _obj;\n};\n\nmodule.exportDefault(BigBlueButtonApi);\n\nfilterCustomParameters = function (params) {\n  var key, v;\n\n  for (key in params) {\n    v = params[key];\n\n    if (key.match(/^custom_/)) {\n      params[key.replace(/^custom_/, \"\")] = v;\n    }\n  }\n\n  for (key in params) {\n    if (key.match(/^custom_/)) {\n      delete params[key];\n    }\n  }\n\n  return params;\n};\n\nnoChecksumMethods = function () {\n  return ['setConfigXML', '/', 'enter', 'configXML', 'signOut'];\n};","map":{"version":3,"sources":["app/bigbluebutton/server/bigbluebutton-api.js"],"names":["crypto","module","link","default","v","SystemLogger","BigBlueButtonApi","filterCustomParameters","include","noChecksumMethods","__indexOf","indexOf","item","i","l","length","url","salt","debug","opts","_base","shaType","prototype","availableApiCalls","urlParamsFor","param","filterParams","params","method","filters","r","key","value","filter","_i","_len","RegExp","match","urlFor","checksum","keys","paramList","property","query","sep","push","sort","encodeForUrl","join","call","c","shaObj","str","createHash","update","digest","encodeURIComponent","replace","escape","setMobileProtocol","input","_function","_match","_obj","Object","exportDefault"],"mappings":"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","sourcesContent":["/* eslint-disable */\nimport crypto from 'crypto';\nimport { SystemLogger } from '../../../server/lib/logger/system';\n\nvar BigBlueButtonApi, filterCustomParameters, include, noChecksumMethods,\n\t__indexOf = [].indexOf || function (item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nBigBlueButtonApi = (function () {\n\tfunction BigBlueButtonApi(url, salt, debug, opts) {\n\t\tvar _base;\n\t\tif (opts == null) {\n\t\t\topts = {};\n\t\t}\n\t\tthis.url = url;\n\t\tthis.salt = salt;\n\t\tthis.opts = opts;\n\t\tif ((_base = this.opts).shaType == null) {\n\t\t\t_base.shaType = 'sha1';\n\t\t}\n\t}\n\n\tBigBlueButtonApi.prototype.availableApiCalls = function () {\n\t\treturn ['/', 'create', 'join', 'isMeetingRunning', 'getMeetingInfo', 'end', 'getMeetings', 'getDefaultConfigXML', 'setConfigXML', 'enter', 'configXML', 'signOut', 'getRecordings', 'publishRecordings', 'deleteRecordings', 'updateRecordings', 'hooks/create'];\n\t};\n\n\tBigBlueButtonApi.prototype.urlParamsFor = function (param) {\n\t\tswitch (param) {\n\t\t\tcase \"create\":\n\t\t\t\treturn [[\"meetingID\", true], [\"name\", true], [\"attendeePW\", false], [\"moderatorPW\", false], [\"welcome\", false], [\"dialNumber\", false], [\"voiceBridge\", false], [\"webVoice\", false], [\"logoutURL\", false], [\"maxParticipants\", false], [\"record\", false], [\"duration\", false], [\"moderatorOnlyMessage\", false], [\"autoStartRecording\", false], [\"allowStartStopRecording\", false], [/meta_\\w+/, false]];\n\t\t\tcase \"join\":\n\t\t\t\treturn [[\"fullName\", true], [\"meetingID\", true], [\"password\", true], [\"createTime\", false], [\"userID\", false], [\"webVoiceConf\", false], [\"configToken\", false], [\"avatarURL\", false], [\"redirect\", false], [\"clientURL\", false]];\n\t\t\tcase \"isMeetingRunning\":\n\t\t\t\treturn [[\"meetingID\", true]];\n\t\t\tcase \"end\":\n\t\t\t\treturn [[\"meetingID\", true], [\"password\", true]];\n\t\t\tcase \"getMeetingInfo\":\n\t\t\t\treturn [[\"meetingID\", true], [\"password\", true]];\n\t\t\tcase \"getRecordings\":\n\t\t\t\treturn [[\"meetingID\", false], [\"recordID\", false], [\"state\", false], [/meta_\\w+/, false]];\n\t\t\tcase \"publishRecordings\":\n\t\t\t\treturn [[\"recordID\", true], [\"publish\", true]];\n\t\t\tcase \"deleteRecordings\":\n\t\t\t\treturn [[\"recordID\", true]];\n\t\t\tcase \"updateRecordings\":\n\t\t\t\treturn [[\"recordID\", true], [/meta_\\w+/, false]];\n\t\t\tcase \"hooks/create\":\n\t\t\t\treturn [[\"callbackURL\", false], [\"meetingID\", false]];\n\t\t}\n\t};\n\n\tBigBlueButtonApi.prototype.filterParams = function (params, method) {\n\t\tvar filters, r;\n\t\tfilters = this.urlParamsFor(method);\n\t\tif ((filters == null) || filters.length === 0) {\n\t\t\t({});\n\t\t} else {\n\t\t\tr = include(params, function (key, value) {\n\t\t\t\tvar filter, _i, _len;\n\t\t\t\tfor (_i = 0, _len = filters.length; _i < _len; _i++) {\n\t\t\t\t\tfilter = filters[_i];\n\t\t\t\t\tif (filter[0] instanceof RegExp) {\n\t\t\t\t\t\tif (key.match(filter[0]) || key.match(/^custom_/)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (key.match(\"^\" + filter[0] + \"$\") || key.match(/^custom_/)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\treturn filterCustomParameters(r);\n\t};\n\n\tBigBlueButtonApi.prototype.urlFor = function (method, params, filter) {\n\t\tvar checksum, key, keys, param, paramList, property, query, sep, url, _i, _len;\n\t\tif (filter == null) {\n\t\t\tfilter = true;\n\t\t}\n\t\tSystemLogger.debug(\"Generating URL for\", method);\n\t\tif (filter) {\n\t\t\tparams = this.filterParams(params, method);\n\t\t} else {\n\t\t\tparams = filterCustomParameters(params);\n\t\t}\n\t\turl = this.url;\n\t\tparamList = [];\n\t\tif (params != null) {\n\t\t\tkeys = [];\n\t\t\tfor (property in params) {\n\t\t\t\tkeys.push(property);\n\t\t\t}\n\t\t\tkeys = keys.sort();\n\t\t\tfor (_i = 0, _len = keys.length; _i < _len; _i++) {\n\t\t\t\tkey = keys[_i];\n\t\t\t\tif (key != null) {\n\t\t\t\t\tparam = params[key];\n\t\t\t\t}\n\t\t\t\tif (param != null) {\n\t\t\t\t\tparamList.push(\"\" + (this.encodeForUrl(key)) + \"=\" + (this.encodeForUrl(param)));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (paramList.length > 0) {\n\t\t\t\tquery = paramList.join(\"&\");\n\t\t\t}\n\t\t} else {\n\t\t\tquery = '';\n\t\t}\n\t\tchecksum = this.checksum(method, query);\n\t\tif (paramList.length > 0) {\n\t\t\tquery = \"\" + method + \"?\" + query;\n\t\t\tsep = '&';\n\t\t} else {\n\t\t\tif (method !== '/') {\n\t\t\t\tquery = method;\n\t\t\t}\n\t\t\tsep = '?';\n\t\t}\n\t\tif (__indexOf.call(noChecksumMethods(), method) < 0) {\n\t\t\tquery = \"\" + query + sep + \"checksum=\" + checksum;\n\t\t}\n\t\treturn \"\" + url + \"/\" + query;\n\t};\n\n\tBigBlueButtonApi.prototype.checksum = function (method, query) {\n\t\tvar c, shaObj, str;\n\t\tquery || (query = \"\");\n\t\tSystemLogger.debug(\"- Calculating the checksum using: '\" + method + \"', '\" + query + \"', '\" + this.salt + \"'\");\n\t\tstr = method + query + this.salt;\n\t\tif (this.opts.shaType === 'sha256') {\n\t\t\tshaObj = crypto.createHash('sha256', \"TEXT\")\n\t\t} else {\n\t\t\tshaObj = crypto.createHash('sha1', \"TEXT\")\n\t\t}\n\t\tshaObj.update(str);\n\t\tc = shaObj.digest('hex');\n\t\tSystemLogger.debug(\"- Checksum calculated:\", c);\n\t\treturn c;\n\t};\n\n\tBigBlueButtonApi.prototype.encodeForUrl = function (value) {\n\t\treturn encodeURIComponent(value).replace(/%20/g, '+').replace(/[!'()]/g, escape).replace(/\\*/g, \"%2A\");\n\t};\n\n\tBigBlueButtonApi.prototype.setMobileProtocol = function (url) {\n\t\treturn url.replace(/http[s]?\\:\\/\\//, \"bigbluebutton://\");\n\t};\n\n\treturn BigBlueButtonApi;\n\n})();\n\ninclude = function (input, _function) {\n\tvar key, value, _match, _obj;\n\t_obj = new Object;\n\t_match = null;\n\tfor (key in input) {\n\t\tvalue = input[key];\n\t\tif (_function.call(input, key, value)) {\n\t\t\t_obj[key] = value;\n\t\t}\n\t}\n\treturn _obj;\n};\n\nexport default BigBlueButtonApi;\n\nfilterCustomParameters = function (params) {\n\tvar key, v;\n\tfor (key in params) {\n\t\tv = params[key];\n\t\tif (key.match(/^custom_/)) {\n\t\t\tparams[key.replace(/^custom_/, \"\")] = v;\n\t\t}\n\t}\n\tfor (key in params) {\n\t\tif (key.match(/^custom_/)) {\n\t\t\tdelete params[key];\n\t\t}\n\t}\n\treturn params;\n};\n\nnoChecksumMethods = function () {\n\treturn ['setConfigXML', '/', 'enter', 'configXML', 'signOut'];\n};\n"]},"sourceType":"module","hash":"6bb8a4b51ea72995fdf18a003d00289105d03d55"}
