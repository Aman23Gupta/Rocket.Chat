{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/lib/lib/roomTypes/public.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/lib/lib/roomTypes/public.js","filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/lib/lib/roomTypes/public.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","root":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/lib/lib/roomTypes/public.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/lib/lib/roomTypes/public.js"}},"code":"var _inheritsLoose;\n\nmodule.link(\"@babel/runtime/helpers/inheritsLoose\", {\n  default: function (v) {\n    _inheritsLoose = v;\n  }\n}, 0);\nmodule.export({\n  PublicRoomRoute: function () {\n    return PublicRoomRoute;\n  },\n  PublicRoomType: function () {\n    return PublicRoomType;\n  }\n});\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar openRoom;\nmodule.link(\"../../../ui-utils\", {\n  openRoom: function (v) {\n    openRoom = v;\n  }\n}, 1);\nvar ChatRoom, ChatSubscription;\nmodule.link(\"../../../models\", {\n  ChatRoom: function (v) {\n    ChatRoom = v;\n  },\n  ChatSubscription: function (v) {\n    ChatSubscription = v;\n  }\n}, 2);\nvar settings;\nmodule.link(\"../../../settings\", {\n  settings: function (v) {\n    settings = v;\n  }\n}, 3);\nvar hasAtLeastOnePermission;\nmodule.link(\"../../../authorization\", {\n  hasAtLeastOnePermission: function (v) {\n    hasAtLeastOnePermission = v;\n  }\n}, 4);\nvar getUserPreference, RoomTypeConfig, RoomTypeRouteConfig, RoomSettingsEnum, UiTextContext, RoomMemberActions;\nmodule.link(\"../../../utils\", {\n  getUserPreference: function (v) {\n    getUserPreference = v;\n  },\n  RoomTypeConfig: function (v) {\n    RoomTypeConfig = v;\n  },\n  RoomTypeRouteConfig: function (v) {\n    RoomTypeRouteConfig = v;\n  },\n  RoomSettingsEnum: function (v) {\n    RoomSettingsEnum = v;\n  },\n  UiTextContext: function (v) {\n    UiTextContext = v;\n  },\n  RoomMemberActions: function (v) {\n    RoomMemberActions = v;\n  }\n}, 5);\nvar getAvatarURL;\nmodule.link(\"../../../utils/lib/getAvatarURL\", {\n  getAvatarURL: function (v) {\n    getAvatarURL = v;\n  }\n}, 6);\n\nvar PublicRoomRoute = /*#__PURE__*/function (_RoomTypeRouteConfig) {\n  _inheritsLoose(PublicRoomRoute, _RoomTypeRouteConfig);\n\n  function PublicRoomRoute() {\n    return _RoomTypeRouteConfig.call(this, {\n      name: 'channel',\n      path: '/channel/:name/:tab?/:context?'\n    }) || this;\n  }\n\n  var _proto = PublicRoomRoute.prototype;\n\n  _proto.action = function () {\n    function action(params) {\n      return openRoom('c', params.name);\n    }\n\n    return action;\n  }();\n\n  return PublicRoomRoute;\n}(RoomTypeRouteConfig);\n\nvar PublicRoomType = /*#__PURE__*/function (_RoomTypeConfig) {\n  _inheritsLoose(PublicRoomType, _RoomTypeConfig);\n\n  function PublicRoomType() {\n    return _RoomTypeConfig.call(this, {\n      identifier: 'c',\n      order: 30,\n      icon: 'hashtag',\n      label: 'Channels',\n      route: new PublicRoomRoute()\n    }) || this;\n  }\n\n  var _proto2 = PublicRoomType.prototype;\n\n  _proto2.getIcon = function () {\n    function getIcon(roomData) {\n      if (roomData.prid) {\n        return 'discussion';\n      }\n\n      if (roomData.teamMain) {\n        return 'team';\n      }\n\n      return this.icon;\n    }\n\n    return getIcon;\n  }();\n\n  _proto2.findRoom = function () {\n    function findRoom(identifier) {\n      var query = {\n        t: 'c',\n        name: identifier\n      };\n      return ChatRoom.findOne(query);\n    }\n\n    return findRoom;\n  }();\n\n  _proto2.roomName = function () {\n    function roomName(roomData) {\n      if (roomData.prid) {\n        return roomData.fname;\n      }\n\n      if (settings.get('UI_Allow_room_names_with_special_chars')) {\n        return roomData.fname || roomData.name;\n      }\n\n      return roomData.name;\n    }\n\n    return roomName;\n  }();\n\n  _proto2.condition = function () {\n    function condition() {\n      var groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n      return groupByType && (hasAtLeastOnePermission(['view-c-room', 'view-joined-room']) || settings.get('Accounts_AllowAnonymousRead') === true);\n    }\n\n    return condition;\n  }();\n\n  _proto2.showJoinLink = function () {\n    function showJoinLink(roomId) {\n      return !!ChatRoom.findOne({\n        _id: roomId,\n        t: 'c'\n      });\n    }\n\n    return showJoinLink;\n  }();\n\n  _proto2.includeInRoomSearch = function () {\n    function includeInRoomSearch() {\n      return true;\n    }\n\n    return includeInRoomSearch;\n  }();\n\n  _proto2.isGroupChat = function () {\n    function isGroupChat() {\n      return true;\n    }\n\n    return isGroupChat;\n  }();\n\n  _proto2.includeInDashboard = function () {\n    function includeInDashboard() {\n      return true;\n    }\n\n    return includeInDashboard;\n  }();\n\n  _proto2.canAddUser = function () {\n    function canAddUser(room) {\n      return hasAtLeastOnePermission(['add-user-to-any-c-room', 'add-user-to-joined-room'], room._id);\n    }\n\n    return canAddUser;\n  }();\n\n  _proto2.canSendMessage = function () {\n    function canSendMessage(roomId) {\n      var room = ChatRoom.findOne({\n        _id: roomId,\n        t: 'c'\n      }, {\n        fields: {\n          prid: 1\n        }\n      });\n\n      if (room.prid) {\n        return true;\n      } // TODO: remove duplicated code\n\n\n      return ChatSubscription.find({\n        rid: roomId\n      }).count() > 0;\n    }\n\n    return canSendMessage;\n  }();\n\n  _proto2.enableMembersListProfile = function () {\n    function enableMembersListProfile() {\n      return true;\n    }\n\n    return enableMembersListProfile;\n  }();\n\n  _proto2.allowRoomSettingChange = function () {\n    function allowRoomSettingChange(room, setting) {\n      switch (setting) {\n        case RoomSettingsEnum.BROADCAST:\n          return room.broadcast;\n\n        case RoomSettingsEnum.READ_ONLY:\n          return !room.broadcast;\n\n        case RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n          return !room.broadcast && room.ro;\n\n        case RoomSettingsEnum.E2E:\n          return false;\n\n        case RoomSettingsEnum.SYSTEM_MESSAGES:\n        default:\n          return true;\n      }\n    }\n\n    return allowRoomSettingChange;\n  }();\n\n  _proto2.allowMemberAction = function () {\n    function allowMemberAction(room, action) {\n      switch (action) {\n        case RoomMemberActions.BLOCK:\n          return false;\n\n        default:\n          return true;\n      }\n    }\n\n    return allowMemberAction;\n  }();\n\n  _proto2.getUiText = function () {\n    function getUiText(context) {\n      switch (context) {\n        case UiTextContext.HIDE_WARNING:\n          return 'Hide_Room_Warning';\n\n        case UiTextContext.LEAVE_WARNING:\n          return 'Leave_Room_Warning';\n\n        default:\n          return '';\n      }\n    }\n\n    return getUiText;\n  }();\n\n  _proto2.getAvatarPath = function () {\n    function getAvatarPath(roomData) {\n      return getAvatarURL({\n        roomId: roomData._id,\n        cache: roomData.avatarETag\n      });\n    }\n\n    return getAvatarPath;\n  }();\n\n  _proto2.getDiscussionType = function () {\n    function getDiscussionType() {\n      return 'c';\n    }\n\n    return getDiscussionType;\n  }();\n\n  return PublicRoomType;\n}(RoomTypeConfig);","map":{"version":3,"sources":["app/lib/lib/roomTypes/public.js"],"names":["_inheritsLoose","module","link","default","v","export","PublicRoomRoute","PublicRoomType","Meteor","openRoom","ChatRoom","ChatSubscription","settings","hasAtLeastOnePermission","getUserPreference","RoomTypeConfig","RoomTypeRouteConfig","RoomSettingsEnum","UiTextContext","RoomMemberActions","getAvatarURL","name","path","action","params","identifier","order","icon","label","route","getIcon","roomData","prid","teamMain","findRoom","query","t","findOne","roomName","fname","get","condition","groupByType","userId","showJoinLink","roomId","_id","includeInRoomSearch","isGroupChat","includeInDashboard","canAddUser","room","canSendMessage","fields","find","rid","count","enableMembersListProfile","allowRoomSettingChange","setting","BROADCAST","broadcast","READ_ONLY","REACT_WHEN_READ_ONLY","ro","E2E","SYSTEM_MESSAGES","allowMemberAction","BLOCK","getUiText","context","HIDE_WARNING","LEAVE_WARNING","getAvatarPath","cache","avatarETag","getDiscussionType"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nimport { openRoom } from '../../../ui-utils';\nimport { ChatRoom, ChatSubscription } from '../../../models';\nimport { settings } from '../../../settings';\nimport { hasAtLeastOnePermission } from '../../../authorization';\nimport { getUserPreference, RoomTypeConfig, RoomTypeRouteConfig, RoomSettingsEnum, UiTextContext, RoomMemberActions } from '../../../utils';\nimport { getAvatarURL } from '../../../utils/lib/getAvatarURL';\n\nexport class PublicRoomRoute extends RoomTypeRouteConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tname: 'channel',\n\t\t\tpath: '/channel/:name/:tab?/:context?',\n\t\t});\n\t}\n\n\taction(params) {\n\t\treturn openRoom('c', params.name);\n\t}\n}\n\nexport class PublicRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'c',\n\t\t\torder: 30,\n\t\t\ticon: 'hashtag',\n\t\t\tlabel: 'Channels',\n\t\t\troute: new PublicRoomRoute(),\n\t\t});\n\t}\n\n\tgetIcon(roomData) {\n\t\tif (roomData.prid) {\n\t\t\treturn 'discussion';\n\t\t}\n\t\tif (roomData.teamMain) {\n\t\t\treturn 'team';\n\t\t}\n\t\treturn this.icon;\n\t}\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'c',\n\t\t\tname: identifier,\n\t\t};\n\t\treturn ChatRoom.findOne(query);\n\t}\n\n\troomName(roomData) {\n\t\tif (roomData.prid) {\n\t\t\treturn roomData.fname;\n\t\t}\n\t\tif (settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\t\treturn roomData.fname || roomData.name;\n\t\t}\n\t\treturn roomData.name;\n\t}\n\n\tcondition() {\n\t\tconst groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\treturn (\n\t\t\tgroupByType && (hasAtLeastOnePermission(['view-c-room', 'view-joined-room']) || settings.get('Accounts_AllowAnonymousRead') === true)\n\t\t);\n\t}\n\n\tshowJoinLink(roomId) {\n\t\treturn !!ChatRoom.findOne({ _id: roomId, t: 'c' });\n\t}\n\n\tincludeInRoomSearch() {\n\t\treturn true;\n\t}\n\n\tisGroupChat() {\n\t\treturn true;\n\t}\n\n\tincludeInDashboard() {\n\t\treturn true;\n\t}\n\n\tcanAddUser(room) {\n\t\treturn hasAtLeastOnePermission(['add-user-to-any-c-room', 'add-user-to-joined-room'], room._id);\n\t}\n\n\tcanSendMessage(roomId) {\n\t\tconst room = ChatRoom.findOne({ _id: roomId, t: 'c' }, { fields: { prid: 1 } });\n\t\tif (room.prid) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// TODO: remove duplicated code\n\t\treturn (\n\t\t\tChatSubscription.find({\n\t\t\t\trid: roomId,\n\t\t\t}).count() > 0\n\t\t);\n\t}\n\n\tenableMembersListProfile() {\n\t\treturn true;\n\t}\n\n\tallowRoomSettingChange(room, setting) {\n\t\tswitch (setting) {\n\t\t\tcase RoomSettingsEnum.BROADCAST:\n\t\t\t\treturn room.broadcast;\n\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\t\treturn !room.broadcast;\n\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\t\treturn !room.broadcast && room.ro;\n\t\t\tcase RoomSettingsEnum.E2E:\n\t\t\t\treturn false;\n\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tallowMemberAction(room, action) {\n\t\tswitch (action) {\n\t\t\tcase RoomMemberActions.BLOCK:\n\t\t\t\treturn false;\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tgetUiText(context) {\n\t\tswitch (context) {\n\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\treturn 'Hide_Room_Warning';\n\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\treturn 'Leave_Room_Warning';\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n\n\tgetAvatarPath(roomData) {\n\t\treturn getAvatarURL({ roomId: roomData._id, cache: roomData.avatarETag });\n\t}\n\n\tgetDiscussionType() {\n\t\treturn 'c';\n\t}\n}\n"]},"sourceType":"module","hash":"c1384a7b2598aa225a3393585de21f5239cc3147"}
