{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/utils/server/lib/JWTHelper.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"app/utils/server/lib/JWTHelper.js","filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/utils/server/lib/JWTHelper.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","root":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/utils/server/lib/JWTHelper.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/utils/server/lib/JWTHelper.js"}},"code":"module.export({\n  generateJWT: () => generateJWT,\n  isValidJWT: () => isValidJWT\n});\nlet jws;\nmodule.link(\"jsrsasign\", {\n  jws(v) {\n    jws = v;\n  }\n\n}, 0);\nconst HEADER = {\n  typ: 'JWT',\n  alg: 'HS256'\n};\n\nconst generateJWT = (payload, secret) => {\n  const tokenPayload = {\n    iat: jws.IntDate.get('now'),\n    nbf: jws.IntDate.get('now'),\n    exp: jws.IntDate.get('now + 1hour'),\n    aud: 'RocketChat',\n    context: payload\n  };\n  const header = JSON.stringify(HEADER);\n  return jws.JWS.sign(HEADER.alg, header, JSON.stringify(tokenPayload), {\n    rstr: secret\n  });\n};\n\nconst isValidJWT = (jwt, secret) => {\n  try {\n    return jws.JWS.verify(jwt, secret, HEADER);\n  } catch (error) {\n    return false;\n  }\n};","map":{"version":3,"sources":["app/utils/server/lib/JWTHelper.js"],"names":["module","export","generateJWT","isValidJWT","jws","link","v","HEADER","typ","alg","payload","secret","tokenPayload","iat","IntDate","get","nbf","exp","aud","context","header","JSON","stringify","JWS","sign","rstr","jwt","verify","error"],"mappings":"AAAAA,MAAM,CAACC,MAAP,CAAc;AAACC,EAAAA,WAAW,EAAC,MAAIA,WAAjB;AAA6BC,EAAAA,UAAU,EAAC,MAAIA;AAA5C,CAAd;AAAuE,IAAIC,GAAJ;AAAQJ,MAAM,CAACK,IAAP,CAAY,WAAZ,EAAwB;AAACD,EAAAA,GAAG,CAACE,CAAD,EAAG;AAACF,IAAAA,GAAG,GAACE,CAAJ;AAAM;;AAAd,CAAxB,EAAwC,CAAxC;AAE/E,MAAMC,MAAM,GAAG;AACdC,EAAAA,GAAG,EAAE,KADS;AAEdC,EAAAA,GAAG,EAAE;AAFS,CAAf;;AAKO,MAAMP,WAAW,GAAG,CAACQ,OAAD,EAAUC,MAAV,KAAqB;AAC/C,QAAMC,YAAY,GAAG;AACpBC,IAAAA,GAAG,EAAET,GAAG,CAACU,OAAJ,CAAYC,GAAZ,CAAgB,KAAhB,CADe;AAEpBC,IAAAA,GAAG,EAAEZ,GAAG,CAACU,OAAJ,CAAYC,GAAZ,CAAgB,KAAhB,CAFe;AAGpBE,IAAAA,GAAG,EAAEb,GAAG,CAACU,OAAJ,CAAYC,GAAZ,CAAgB,aAAhB,CAHe;AAIpBG,IAAAA,GAAG,EAAE,YAJe;AAKpBC,IAAAA,OAAO,EAAET;AALW,GAArB;AAQA,QAAMU,MAAM,GAAGC,IAAI,CAACC,SAAL,CAAef,MAAf,CAAf;AAEA,SAAOH,GAAG,CAACmB,GAAJ,CAAQC,IAAR,CAAajB,MAAM,CAACE,GAApB,EAAyBW,MAAzB,EAAiCC,IAAI,CAACC,SAAL,CAAeV,YAAf,CAAjC,EAA+D;AAAEa,IAAAA,IAAI,EAAEd;AAAR,GAA/D,CAAP;AACA,CAZM;;AAcA,MAAMR,UAAU,GAAG,CAACuB,GAAD,EAAMf,MAAN,KAAiB;AAC1C,MAAI;AACH,WAAOP,GAAG,CAACmB,GAAJ,CAAQI,MAAR,CAAeD,GAAf,EAAoBf,MAApB,EAA4BJ,MAA5B,CAAP;AACA,GAFD,CAEE,OAAOqB,KAAP,EAAc;AACf,WAAO,KAAP;AACA;AACD,CANM","sourcesContent":["import { jws } from 'jsrsasign';\n\nconst HEADER = {\n\ttyp: 'JWT',\n\talg: 'HS256',\n};\n\nexport const generateJWT = (payload, secret) => {\n\tconst tokenPayload = {\n\t\tiat: jws.IntDate.get('now'),\n\t\tnbf: jws.IntDate.get('now'),\n\t\texp: jws.IntDate.get('now + 1hour'),\n\t\taud: 'RocketChat',\n\t\tcontext: payload,\n\t};\n\n\tconst header = JSON.stringify(HEADER);\n\n\treturn jws.JWS.sign(HEADER.alg, header, JSON.stringify(tokenPayload), { rstr: secret });\n};\n\nexport const isValidJWT = (jwt, secret) => {\n\ttry {\n\t\treturn jws.JWS.verify(jwt, secret, HEADER);\n\t} catch (error) {\n\t\treturn false;\n\t}\n};\n"]},"sourceType":"module","hash":"f4ee4f161f3b0b6115d503638907127fcf7c5a82"}
