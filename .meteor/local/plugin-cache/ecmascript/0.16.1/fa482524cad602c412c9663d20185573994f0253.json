{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/reactions/client/init.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/reactions/client/init.js","filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/reactions/client/init.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","root":"/Users/amangupta/Documents/Open-Source/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/amangupta/Documents/Open-Source/Rocket.Chat/app/reactions/client/init.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/reactions/client/init.js"}},"code":"module.export({\n  EmojiEvents: function () {\n    return EmojiEvents;\n  }\n});\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar Blaze;\nmodule.link(\"meteor/blaze\", {\n  Blaze: function (v) {\n    Blaze = v;\n  }\n}, 1);\nvar roomTypes;\nmodule.link(\"../../utils/client\", {\n  roomTypes: function (v) {\n    roomTypes = v;\n  }\n}, 2);\nvar Rooms, Subscriptions;\nmodule.link(\"../../models\", {\n  Rooms: function (v) {\n    Rooms = v;\n  },\n  Subscriptions: function (v) {\n    Subscriptions = v;\n  }\n}, 3);\nvar MessageAction;\nmodule.link(\"../../ui-utils\", {\n  MessageAction: function (v) {\n    MessageAction = v;\n  }\n}, 4);\nvar messageArgs;\nmodule.link(\"../../ui-utils/client/lib/messageArgs\", {\n  messageArgs: function (v) {\n    messageArgs = v;\n  }\n}, 5);\nvar EmojiPicker;\nmodule.link(\"../../emoji\", {\n  EmojiPicker: function (v) {\n    EmojiPicker = v;\n  }\n}, 6);\nvar tooltip;\nmodule.link(\"../../ui/client/components/tooltip\", {\n  tooltip: function (v) {\n    tooltip = v;\n  }\n}, 7);\nvar EmojiEvents = {\n  'click .add-reaction': function (event) {\n    event.preventDefault();\n    event.stopPropagation();\n    var data = Blaze.getData(event.currentTarget);\n\n    var _messageArgs = messageArgs(data),\n        _messageArgs$msg = _messageArgs.msg,\n        rid = _messageArgs$msg.rid,\n        mid = _messageArgs$msg._id,\n        isPrivate = _messageArgs$msg.private;\n\n    var user = Meteor.user();\n    var room = Rooms.findOne({\n      _id: rid\n    });\n\n    if (!room) {\n      return false;\n    }\n\n    if (!Subscriptions.findOne({\n      rid: rid\n    })) {\n      return false;\n    }\n\n    if (isPrivate) {\n      return false;\n    }\n\n    if (roomTypes.readOnly(room._id, user._id) && !room.reactWhenReadOnly) {\n      return false;\n    }\n\n    EmojiPicker.open(event.currentTarget, function (emoji) {\n      Meteor.call('setReaction', \":\" + emoji + \":\", mid);\n    });\n  },\n  'click .reactions > li:not(.add-reaction)': function (event) {\n    event.preventDefault();\n    var data = Blaze.getData(event.currentTarget);\n\n    var _messageArgs2 = messageArgs(data),\n        mid = _messageArgs2.msg._id;\n\n    Meteor.call('setReaction', $(event.currentTarget).attr('data-emoji'), mid, function () {\n      tooltip.hide();\n    });\n  },\n  'mouseenter .reactions > li:not(.add-reaction)': function (event) {\n    event.stopPropagation();\n    tooltip.showElement($(event.currentTarget).find('.people').get(0), event.currentTarget);\n  },\n  'mouseleave .reactions > li:not(.add-reaction)': function (event) {\n    event.stopPropagation();\n    tooltip.hide();\n  }\n};\nMeteor.startup(function () {\n  MessageAction.addButton({\n    id: 'reaction-message',\n    icon: 'add-reaction',\n    label: 'Add_Reaction',\n    context: ['message', 'message-mobile', 'threads'],\n    action: function (event) {\n      event.stopPropagation();\n\n      var _messageArgs3 = messageArgs(this),\n          msg = _messageArgs3.msg;\n\n      EmojiPicker.open(event.currentTarget, function (emoji) {\n        return Meteor.call('setReaction', \":\" + emoji + \":\", msg._id);\n      });\n    },\n    condition: function (_ref) {\n      var message = _ref.msg,\n          user = _ref.u,\n          room = _ref.room,\n          subscription = _ref.subscription;\n\n      if (!room) {\n        return false;\n      }\n\n      if (!subscription) {\n        return false;\n      }\n\n      if (message.private) {\n        return false;\n      }\n\n      if (roomTypes.readOnly(room._id, user._id) && !room.reactWhenReadOnly) {\n        return false;\n      }\n\n      var isLivechatRoom = roomTypes.isLivechatRoom(room.t);\n\n      if (isLivechatRoom) {\n        return false;\n      }\n\n      return true;\n    },\n    order: -2,\n    group: ['message', 'menu']\n  });\n});","map":{"version":3,"sources":["app/reactions/client/init.js"],"names":["module","export","EmojiEvents","Meteor","link","v","Blaze","roomTypes","Rooms","Subscriptions","MessageAction","messageArgs","EmojiPicker","tooltip","event","preventDefault","stopPropagation","data","getData","currentTarget","msg","rid","mid","_id","isPrivate","private","user","room","findOne","readOnly","reactWhenReadOnly","open","emoji","call","$","attr","hide","showElement","find","get","startup","addButton","id","icon","label","context","action","condition","message","u","subscription","isLivechatRoom","t","order","group"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Blaze } from 'meteor/blaze';\n\nimport { roomTypes } from '../../utils/client';\nimport { Rooms, Subscriptions } from '../../models';\nimport { MessageAction } from '../../ui-utils';\nimport { messageArgs } from '../../ui-utils/client/lib/messageArgs';\nimport { EmojiPicker } from '../../emoji';\nimport { tooltip } from '../../ui/client/components/tooltip';\n\nexport const EmojiEvents = {\n\t'click .add-reaction'(event) {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tconst data = Blaze.getData(event.currentTarget);\n\t\tconst {\n\t\t\tmsg: { rid, _id: mid, private: isPrivate },\n\t\t} = messageArgs(data);\n\t\tconst user = Meteor.user();\n\t\tconst room = Rooms.findOne({ _id: rid });\n\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!Subscriptions.findOne({ rid })) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (isPrivate) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (roomTypes.readOnly(room._id, user._id) && !room.reactWhenReadOnly) {\n\t\t\treturn false;\n\t\t}\n\n\t\tEmojiPicker.open(event.currentTarget, (emoji) => {\n\t\t\tMeteor.call('setReaction', `:${emoji}:`, mid);\n\t\t});\n\t},\n\n\t'click .reactions > li:not(.add-reaction)'(event) {\n\t\tevent.preventDefault();\n\n\t\tconst data = Blaze.getData(event.currentTarget);\n\t\tconst {\n\t\t\tmsg: { _id: mid },\n\t\t} = messageArgs(data);\n\t\tMeteor.call('setReaction', $(event.currentTarget).attr('data-emoji'), mid, () => {\n\t\t\ttooltip.hide();\n\t\t});\n\t},\n\n\t'mouseenter .reactions > li:not(.add-reaction)'(event) {\n\t\tevent.stopPropagation();\n\t\ttooltip.showElement($(event.currentTarget).find('.people').get(0), event.currentTarget);\n\t},\n\n\t'mouseleave .reactions > li:not(.add-reaction)'(event) {\n\t\tevent.stopPropagation();\n\t\ttooltip.hide();\n\t},\n};\n\nMeteor.startup(function () {\n\tMessageAction.addButton({\n\t\tid: 'reaction-message',\n\t\ticon: 'add-reaction',\n\t\tlabel: 'Add_Reaction',\n\t\tcontext: ['message', 'message-mobile', 'threads'],\n\t\taction(event) {\n\t\t\tevent.stopPropagation();\n\t\t\tconst { msg } = messageArgs(this);\n\t\t\tEmojiPicker.open(event.currentTarget, (emoji) => Meteor.call('setReaction', `:${emoji}:`, msg._id));\n\t\t},\n\t\tcondition({ msg: message, u: user, room, subscription }) {\n\t\t\tif (!room) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!subscription) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (message.private) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (roomTypes.readOnly(room._id, user._id) && !room.reactWhenReadOnly) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst isLivechatRoom = roomTypes.isLivechatRoom(room.t);\n\t\t\tif (isLivechatRoom) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\torder: -2,\n\t\tgroup: ['message', 'menu'],\n\t});\n});\n"]},"sourceType":"module","hash":"fa482524cad602c412c9663d20185573994f0253"}
